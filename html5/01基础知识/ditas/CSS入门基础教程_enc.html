<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"f76f68df3a0def28f3de53db259ea8cbe6ab738a3238c10d6fffaccdb4c3b47a7dc516e973e0cc2504b475f892bf7d063635396f54f51e0e15725863ba4e5d9f70d36c277db95ddd3848c1f8b8938bfc5c6adc5c65fbd27f67e720c661d9f655373e458350b65433d8ea7e402eb261a2346d4a425638d91f52006cda1ae6ead9a2341b44abeed783b9a02b5322ac4d094494e3daca0df3c08727f28e75ef1eff8f14d7397d92be63f4eaee55122d661a253a4fcbf5df6e0a17ae12eeb952717acde490e3e2f61f981f05b2270e3a4c940a6bf848cb3db69402ff49b9b80eb29d1314ab4251bf01a1a3857ba080efa593abdd98458f663f0dabedd602cfbe4b11cf5eab0ec87ec53791aa924eec0e36fee5e6084c280372f5010bd471dcbdbfe257b128176d44da5369333c397d7434557808e523e1f77a6602a74e0f61a61de6c94b20287ce7a1461f75caef91e6f3abb76abaec115f2a2e70bbbc70fa7622106f334c99825d5d603d7d6dc4faa16f266e742d5bd2ff2a411e88f0a5fde09c9bd7023bc171086e4ea4e8c923b432c6aa7fdab4096567728f569d4e5a9573a177bf833f58aeb4e250eea478115580293b2ba47eb99c95c769de7e876ea6c1938c9c8c0e430738c314c69706670ce66bc478084b37c9f37fceb918dd2c13610f2b00856efe90e962895bd4a9ff034145dc08836fed6a0bce8df833ef2403d8db933bec8d9bd8c88f4939952f9e8de8dbf3f2b30d1cbb3fef658e5dd1bd4145d26894be711cecea2a88543ed58623c351e88528e8d1ab1c17538bff0a4e8e44b9b9384dd1a2e2d10768d6f38c1379dcfd28c575a28c2cfea799f0eb61bf8b2bb01339dc9e972018d93d543c1f30030f02937845123c1fb21964661ffffa23a14b8f40ff981c3c3191e9c3c63a2e7d425e33f7410b353a5a22cb9f5ca4c7584d16a664203eb4bdcce160e45853329d3cb1779035bd94e761c8e0a7e919a934f519b334eb605a8202a9e0f7bde5ab933b4a818e63d8f9cffb397e6004409059bdb92a1867c6c6f28444a917f43929cdf83b3c7577b1e0658d28378665e2976b43d497811e1b7d804b1dfba354aeac41d5a14dc854f1cb91ac49ca3ce73195357b50a369e1e35e1ba6e467aab665ecf310e85ff15e2aff23eac228794a169823a328006571142d1198415d7adc6126abfce2c90b12266e2435d1605aaed756bad884b89ab7f2169e30d6be3fd73b19bd1ac072b379249b5469f1c3820854f82e4ed78347a9e8569f84466bd2cf56bf3bc495ac9cbe22e52daf918a44984c1260194fafd40758fc47416d63944e0881d5a7501ef15aa3edbfe4443a44149f2a6a081d91343ae9715508be0841450f180cbae40df54a8707724a091cfe00e9d2560acc01f6c0733aff21e657c7174def6f9a96ee8c640837e630b9e246d33b2a8282eb9bd3fa73e7830f4889229e1bd2362dd7f4c441a0689bdcdf7281f22c175669fbd455679ee02b18d9376929a247a70a768cc55c897858ae99fdc511786bc976ba527426580c8ae75edfc2820cb0a0ccf2a1ee9aeb1b2e778aede9921222a00ab20eb9e3170fcb902c54612312fb91d15b2a832ac95bf2cbc800e91a89bbca9f309380de13aeb7b85c6dfdc498a5418c1ef8f44bcc4aea6bba6dbaeae5b488f127900d3bdd51c8cd588c6ee0514dbc037c1837df4b5cdab5a9ef76ffa3d6b7bdc4987d4c804d094638e64d3ab2778d5f1c35f92d04a98b51b01a19c1735f2bac248a42af9065e1e0292255871086dc4e051f23da5259a05a0af4320a2f6d9ffc36675067d5a1882f157c6186749db20e0412b809db9b0dd38159cfcecb0b1598fc1e393f8f7bc146adf8982705853f21e4d29918a361ece71ca3f57754ae3719400ec380c78e3a2ca506a7f59caa928411d48da896fd968edf2ae8a06074301c63bac245aef2d5a5af53d1be8f696e06eb8557e8d223fb22b301bb702ddcfc0baa8276def4f375c215ddbaab67a7744c28fb7d4a4274917484364919bac39985c814af5d22aaf8b68aee6884ad00165d157ec6ea0d84097e8694aa425868a3831f512ae44e845d96dda3ec752b4501ca4800c3d2d5619a4f5b9b26532dedeb3d0e832c47ecb5600f3a673a917668b9e3367a41a9aada8021e44020a702fac136f78b81371e382357b9590d9e74aa0a6a340fa4f59967a7dd8e385850088c66aacaec51e81ca0c83609086b5e134a802ab2bbb316a4eae28963e47e2759a7d20fde0becab5841451161b6afa639e6a890797e65cd56b3fa8a50688f627ca4428a32d70c49631359f9ac131a29a75c9bdb29b7b088b3197256f663c9eadc902e59af1890c3ceee2a809d4a8e77de823198988d67ee9c68cbedbd314992e71c7a64de95972bb515303907ae16c38dfdc9e332b4483e8624c775091371969eec6c58e4c09e0f0944e0ee4ead67ed6e2c6884a66c955f9a8253ae9ed6c1be4a111d3997fe800a551dc552f37cf4ca33a27f012b778937b6702ad78d9a73e020bdca776fc501254e75b3b59ecd825cc97594d8ca8bde328757a28d225a8ae6cfb6b139eca051dffe8014daf366d207ef927ec943741b704607f518bd0e2348e3d53b7117b005849c51d38849e60f9828ea1bde7e2ed214d1aa7ccc630c7223a2fee0de0281422a83ab041872c3e7889c17d1eb20fcb3ab88dc6f7b1c146c26a645fb962e5496d05e4e46b3492036aab86e04dd4b2e6572d5213783f712e7a4c776db19911db25088f06c53fa4b25ab8643ff0aef1fcad8f3285b4871e775449fc7d3ba1cfa1719808f0cae5e9ef22483cd831f6668feb920283316c5b01094f46b4613f8441f1ddc95666bb4d339773607a403a38b61ec2c8d6cd00f543185c7cd9f35b7155e5fb24d48b4d63da3a20215ac387a4e4f660ce919017a6a9ccccd40197505b6933298cc851a6ea92051220522d10b93622049142d31ae82f9a44dc5be83e9467ef6f2d2b3082b51bdcbb1e0d4a81e24016d9a50f251d87e41260753169b1af8cf66c4c56e82eca8552fea1fb9a9146786947a645e9580470d45e5372c8650b2ba2a057d0bf61c2ea60cc157a8775939c0df5f45884ac89fd0f15f150ffb261d89cf0179360059bdd4c47423e5abfa87978b5433fbaef242532b0f924164ac1ff7392059ab80328e1bec0685b8d8ff28610240dae310882768653d5cd06953be5460b21328f6234fcef762cb666eef52e2c0c7db6ad7e9542fe4e39d85eea089616475924ceef232c5a3e6558cf0bb4d56e234adb7b7f34026ca641498ecf2238b4904d8f6c753322bcc4428ec9cf7ea49be32ea6bda0b81adbef1a7ff34e7eb05aace61167fea89c927e43ef0d9b85f2ae1f3c84085345b6c05bb595f59aace62404ea6b1fd2a2495b172d02e9323c07ba5ead04c9416231ca3b16e11a2f40e8907f48bf08d14c43803e508ba3dabc3fc18337e3e0af55908c5e09240a69e28e20b2aea5b46015b7b39e6e5407eb2827c9eeae5c8e44666f568c53fc169fceb1233341b0e5d0d88352554c3883647fe2c01d329889b36dc68815ea1c84ccc4c2eaf52ba899c33b5be64362b071412810a16792fef2f00b3b58c4425b81f2684792611a959ab29202d3f4d66d52614b9efb9784cbb20f85b23d5b8a53c8297e52b6bb16bbc4265feeef0711c8a5c9c910a91f2988b92dc72faa0a3bebdf7c57c578953fb9beba6cc82b417336e7ceed1fdaa10710227406b1fea06012e257fd7b161ec4bf54ccedf5c171edeb6d627609be75744d1ff95c1c07880f6a172a65153144f5e3505b5179230e5e8b650001f9b0464e0fa31ba9ce4d4ccd8c1ff1f1d555edd3e27cbaaaf96b30ea6f9fad7def15f5ba0a11bb8908fe75b89a98efc85b25ae648137f899b379317e76eac50caa6869e5481d5c7f70334821cd1d0d8aae97c9e4e67a3b6934ba3e69b63838d8c3169d44d7cc683f08db023b38c603bd4c1e6fa5dbd3bee69136aeae764a68a80a63a9e456a799328656e072eb5d043e94c9c2a9e04cc190dccd9cac67abf4a307ce7535f5079e318545cec8cbb8aa5604faae600efc096b5dec3f2a82c6b24b0f4f8d8b3d703807dcbe3a966938eaa0e35ca9d28ef99d0d8e95a59aa514bd39c3dd09f87e9365162e87452e5234ab8e7cf3071703137be80fdca718c0200f307a586386cf85fa426cfe853e81df8eb305501633cccee5e9771b1330532cb09f90e7aa48d2a72ccf4f8f59ecdec5138660febcd7d1edbb3fecd1150201005eb9977dc0f41cedb12be3294347dc8f14fbe787768519f73200d1950da0698e7d9cfe11ac0325093c80d3fbe22213edd254b8e4dc354d2338f1ee13ae91d2ecbe842bfd34a57afa272bba70f9066db3d3da44efba1e585cc01528882ff8e561fa56a32c26b32dfa677e7a6106b1fb95cedd280a47d0745406e779753e540bad335892a036daea3dc52fc3a04aa805f2e62960702102783aed614625eaf42a7f62622fa95d984dd8abf5404b2f4c46b384a38d48a7dd81a8aefa31bfabf435674703fea6371f39f1cd18dda0cada59b1ab8f56de8c369329b9a844681484be5518d8f3a25d5cc4641a7963d36df4e0e301533433bc4bec707d393c7e7f03456e16e4a0d01cbfa686f505ffa1e6715bade08ce45f6a25aec57bd480390aac53ba5fc07949a7270abeab1581da607a0eaeb6f28c02957bc1a35af23673456b5ca6fce8c76275f47cad2197a423a6fc631fe875e3bd8797a2d1a3bd431ed95893d4cfff2bdf54498bf7ed0fbdb1ccf068a76c2edac58f6583fe03d64b538a10d142e00af90f6320e95484e59db11816bbe0cf893b6dc710a01a143316536f8ea4811f6e02f7182fe2c5be6a9a50352d0120d1b4d615bce387ad8f4fb79cd52a666c5197df970983256f0f103034db3ce90679255ce38bfff5886af97e9c8e4512e7f2ceaad20060a792eaac8ce5d8a68ca9d26ef32b6d6064a650ce57c6eedb19fdebfe374288d3f6ce626e291774e6e33436cba6fb2a3cbd4889a95fdae1f6fe3088525a7aa111e0d7481c4fccc086286d9389e75127041da401b869afb088a774e623b1bfffb7a64cfa5cbbd53549cbf60f4cb169c9f2696714d212100f7e73cdd5d752ec104f62dba28739973d762110ec804a8ca479f7f10c3467935edbffe352d6d5b8ad333db0635732fccae79c95cbc4125400fd299221b2ac4ac753c94c4f401677d451716ea8d6634caf6930d7260201a7ac642fc25d829c81cce2b15023cbd10edfbcd7004da60697d291c297c67d0f5b596d9a0c368e8f6e65a1d7a20831c9c4209f9c3618042bd7208600486919db9f894e83cd40ef23192f705cc06feab1c05b9067f23a03895c972ba9221e68f1a7c621c85150c78e6c2125f39fa5ad28fe2346fe026487bc47e7263e7178074215324f828bf620d144b46ed53047feeaa6a2137745c49e0a6202fa48ced31e47e9a9e4e3bd7119c8e0ff5eeb72962b36bdc775d0772d2e06676605e101624e9f110942429d8f7849d959e7fb0ca34355d8279cbf663727530af0844b06308e4b8fbb2f89fb4f982b0b7f6807abb3b6c1d14548058cd78d558788ac37fd7f8d3942dfb58c1a63713a0c56e15dd9b97a144f3a9d4d60c8e5d5d37cf94ec0a25afdc9a39cbe15006e82af9a2c233cf6887689cdc892c9830a8f9959808ed3731c58596b1dd0e79fce47b052bb9360ae8546ac5138eb12f37cd059921dd9d2f7bd39f9d6075511d571518a0e4786e3d644c3c8aafd0327fea08ec7660651d9c543eade5df50516890e2264672aaab4a52562b7309dc375c9709420423c695280a88153cc651c585169d7d7d462b6d8ae5c522e9ae5bb9fb3d0668a35aac3102ad09ba02c289c19b9abfa4961032e9da0b3ec262d5007eb24ad1f3fb24629f90d313264412b88d0afcc286fedaf5bf08aac5f515f265c5282ac7813a18c24b03985deca2756964f58f6f198f87b134bb1fc0c521d724344011fb7837e7e14eac0d077638cb28ccc3ffbbdd7e8faf9fedaf40ce78cef858b0e960e8394df18cd8759712d7c9c8796d45aae6dc4079a9c41a418e31db4cbdf70f83c14448ce0c0fd46801a98e30b812cc0eb028d9f2f7e0313b577c3d0cb02eb201d358869d44e0048a3186d544c7d04e4f4def034dceab6a75a35c572ddeed46f4d5d742cca0f722bcbfa2a0169eb850843103294e803cf576eab0023de2ea030781ad1df19086d8d767a03abc5a94b07f3fa944635a566f3d1a26e47e92dc1200c87bf1fc78b1535f3a4ad428879b0bbca9163c951507710f3566e5f25945924f6a34ef4c2e793a6d2477ebc9e29f26bf78101bb46cdbe374d9b7cc515df0997a43f8ea975cd2832861331100fc9b04aa64ac584c928b61c7537cc397ce1c3aaa2d43ed225ce53ea338e95919534cf9539f04547ecb3778298fa78a2cdb864c535fbea671d6b61293a27735604678eb98ec495630725e8b8e467047dc43ba20606e75aaa346b8a78a51da9da86922e9ffa9e806a55632d56d3331abe9efd45b1f15cdb7c57774c8153918d1041cb5e8f6d6611153325c58c29f8360cee96c7300b91e6b1cb363d60f65c0aa709922326aff5fc610b68c029839f49b7a4978752b47771d0a494d0e1c30a11aaf638395078eed27db6f1988e2b5355a1d51a587314b83cd89d7b59b231c61d8fe856bc8657af96e1bf4addc33bcb84b0ba372950ece51f73824d63fd9480b2cf793e3653826846053e6c0d1bba0e5a0608f4200416dd3145d8612761c8d463515ccae9a61d6b30b2f31d77f533861fd3855bf86774ca5166d76fdf1c2d697705512d58aa44662da81dad50b3b1680274742673710e278c172dcc7c5d77ee1d87fde58bdb7329d98e0246ce306fa64ef9810cac5f379fe054ba1fdf40055f96ec7f719fd824af0b5d05d0ce6b3fdc37045f7e5512cb3566514424d33985f54eeac2d2addd631dcd8ba96271a06753ccb9e52ffad7fc3494a31602b3790ccfcf3ed3f5d0ddf55c0ab5eee99cea99a34b3dcf1a8c783bd0745ad9c31e88b440bbf03909f2f7315a62ca99b5109a6c8028ffdbabc8a9a72869a01206478802bd45acd3a1dcb478924d31dd83ec633c9caa575fcb30adea1a433293ec7d40c2627d3c34c381358788e466e136088cb7d5c8f674c766ef96707c6d926ac8c4384db2882d2cdc064508bd6a563b12193f82d0771875101539a26e92e72c473cbfeb398b9eadbbcb302f9e3cc052b7ea27e2310f3d19279f11fcd28408737ac5da30e654951f516b6b0784940c2d6b23f21de04e3c3a2c23b8a4f7d0c3b34ee15bf129b4f1089d20d731e1fb71b85293b68e73e96fa36d72bb67f1afbe8dbf6f71171b113e46c70c61e1c03160de0e4c01eebf1eb4db0c4eda259222d14e1609e1cb043114106a6b5a8574a61bac6b53f5d7d9fb6d0e23754d7961824a76d7b9410c74d3a86f1b438464b19da3c4d339b575969a178b1e73dc5f4068fa03b62d9ba831800059feff19b96daa83366d1c24614a1408a637b8c6500c63591fac0b358025201576ce7e6921e1f10726c9d9f47449aea140689d6822972c071a271a507e0720ca6896c8b5b00f1c56d97dbdc79eefef5197c1b558719a9404f968c4fc2c338c186209b30b03c60d729ba55e6b22f7ec534aab8b6cca928572b6c452cd8e1faefee25389a6edac5bddefcf69054cffe5c655b8645d5a449f74e6fb267162d755651875d998b4558ce60781f8e5528c713956acf1e8d04a6555721d7abae02df1f617c1818ba70166199d26d9608d210da1274b91df711a418a7bcbd7bfa525cdfb2e455b8b6a20191b29f081dec43b5abb46306006c6b8654041f310a72d4f8835910d1097b417ffaeda67ccc072ca0a097dd7ff9d9ccd0bf98a3a4662d098f650acb3158af305fc2c2ce0a857f095cb1257cee217501c358ceaf423f26f14c14cb06260d1f8e3a8f7df742783757e7e4081d883846ec016ce1cd3eea6ece46c8cd1f0b26b5c25d79a0251971122658eed78b5ba2040e96466458af05301812d77e7f3a65f648a8d3eaed20d24f383623c6e531c6fa361b5f2f7774ce8f48362c6e580e54aba5947fcba5612902705cc071f8a1be5a5b6e36d73df278ee8cd408b978345fc6c8f6acee1b840e43acc60f16b9e2c06124407f93dcbde07c55f98ec2bc170aa6fa5085a8d5dc5af52b797147024fd8e8665cd607c639ff2827e69cb253879d9f988df4779553b57595a4c1986e678f984a0cec7b898b150542cc8bebe0e991a6fb967f188b4c827503c634ac28fa84f6cf572f156046db935c3536c9696744b6055a4e1a46abd079de557243f7c0e02dec225a709cef60a983fad881271a4cdb3a89c885e3d48be60f8ad49d204db2831ba4f046588ad1184d07d1190dd04ce467f926589671d41f065c41c54d3dfd49b5316d7a069224059690f2b6e7caaede44f1eeffbad98648c4885ad5b0cbff70d360aab21dd28a4348d5fb754f295d93fad2e264ccccee14bbe54530f5850a5b8da9851aaeb411d6417515f8de61e98635ffd3411641d0b95eb6a5f89177db4efa3857e8e4c6e3eec4aef83b230cb6236946223199e4191386666f679c84a0da8f91d3d170f8b68d748968cbe3adedbe30d8339b8d44fa03f0d2ebadf1613364715d138c0c9eb4c2410b5865ad256185c9209337f83ae32357de6cd135bf5dc600fa0f544500b8b88a8e5246cd02c143be774bef16a40d998b34d19061b240d29eb7956e56e9c556cc5a237a711ff819459de4cbe040da238c00b177fcd2cb94c3ba9b635bb60664d3af0a10b704a5f68688c12bac3f5180b22ee89ab494e5cddd24c3b8950a0c62e09775ce088436fc64d145cdfa8ab991ac7183a5e5a1ce2100fe8c914bf3a8aba10e2218d7b2c7bd3803670e8e1710ac03424482aeaca26aa5318faa5f244e329637dc639346612f249a95adf1fe988927e096bb4c9cfcc5e942832fedb96f566b68e82b261f22f82c3216f05d473407dccece687324b79f7b34ab73d5c73f989d4b1376938d3ea9136b29735452c7ab50a34ea885545b49d5c7767b9d83a3d2621b24568be7fb00e342cd6988f31056a3d822d418bb14b4dd9b83d9e788d179f1bb9df49aa4e1b85193fea20e83ba5bb11484b64f7560fa5220bf5e77ce3453cc07a245fc5ad8f6eee9b851f6d9485e4d08d1f311c8caaf2e564c4d697ea5b869a08ebb89c72e6f70ce0939bd134bfc4e9b9a9ca44c1509d6fe54eea342462aceb6e430e1e0361846a3b837a6bd2bf531b3a65134b415d60c7d614f069591b9db093197e1765fe3b2dbce250e6c80010672e94c46b7dcbb5d8556d9131b7789f0ea15a03b7d31107b54ac6b5571a28ed8aa760a93e988ea1731e3c54a71f96be0c510b45aa80dccbc69931e1decda82d386c2f086a884360e391eefe7c1078e742b13d072ccdd7522c15d938f55ce2f4906c46831a0c1f8ff326b23f689fbbf18ffe39cb3753b0681ac8bb052d190990a6e23e8b74b660d3bee33f154ef43c0676d579fe33d0a6f4e985cd9b9f39930af8c5b624087bad38134506b1af64add8f6f3c29d125842963dc80cb6986ccd269870f7e1f4006ba4de19a37d544d93b8d2370dfb1ea6e3527b89258d8e2ba7773cdfc30cc97c7bdcfe3dd00cb22c96fbe158098fd0b0aed2766467b93ddae55d2999de9320d579be6bc1205d6d2641863de163893a0e1902b993ecc4affcaa508a669c703215a17faed462ee8b521f25cfde83f6a6e30576c4592801f8a63f5db1db52aa8901f3eb6675e9cb52f6d9f7ea256d4745696cefcb30a09f8a69098ce481579810d4dfea32ac321a998bb072155ba936c21096e27265ed67a1258529ebb909eed52c9e3d7b66c03ddc6ec02136b941f29e2f5c31a9c58f7d94c66efe2144a0b94d8c264a00148135f3a2bd4d70e9944070faced534a7fb0188cca801c27c1fda18186f1edf505f7e497601809b469debb7e7c6928301246ff50ebd6acae0942a747e087a1a04958e1b1327bef23663b160ba35c61c40d0d0668429663d11bda584d3bca81a1e47169316f809ee00f9880042dc1676847c90887bb300f80f8f15f744b2a06089bccac78641a5fda56c964f08a1a2dfa7cd3c77cfe48573be754e71770d5fa1bf4e24d6496f91f91a45c9f3f2fd2c03c91491f212520e539e115eef02dfe7290da8cb283b915c4cab6d209d0a803811be74d0763eb8a5350c7ed784c352adf62a5c4c1846bbb46d9881340f72b6f4f7caf4bc743f47394e850ec6b0060e070b8bcb78ded27d867e861c1d1bec4c2396e738fb37b50a0db9d09241964c9d3d727355748c2b099585ebc8162f2a238204fa46fbff0b99e9d203beb514d3ceb9f3866939613c56f4aafb9c5b2dd0265713e7ed2512ce6082aaf82c4d029b48dfe8d1d4e86b27543c437b603952f3ff157d974f31a5d34c3efb8348f4f79acd966e07a2e1bb9005fa21f9235324c57a450ea6a8710020f3801bb06dd9acc252356cd2ba8cef5b2f369cdfe6fe17ef7e7d8250f24952e1ba9ee41d3a403cc825f15bbce583ff80c1842f05264cde21ce619fbc7c6dd1e6a87d8153b3c6edfce2681ee64cc2cb1cfd6fbedf443378b6c2bed1def0cc1a62c06caddd35e2ca4e150787b8b4655f74cf85d744b57e046ab482aa065edd9f19995de9d84c0d5401364fc64688e74a9aebcd240dd4f436241da7c8a37fd5b1d03088c5e73fc8e451eca2f53230daa1f97eb6c2d813f06296f3768f24509fedc7c33b948b52fbba8217b5d63c1815e3c0facd2fb93bda7f5dc4f14aa131b263ab9b76398d989a0c527aadcb37dd935a9ba41e31e74c572fa19ad49eea589958a111dc56d439e412ffca3adf2f765cc9b90c090418f6df8afaa6e2f8420d10bb359565d5dff3f602f80f26bcd3f20f8f35b02df66c82a663e7396c7379740c3345cb56af87027ba0326644b0e02f62f4e63a5152b622c1cd061a85bb6304c8aaa98f46ee0739f0386055d2b8c9dee21518b2dc46a32a56b4d3a53b423cc0cb0f8e82029eed59b07e28cc1cab4e365f117a829895b0c5e4f1542ca946d0aa9ef7a25f2ff2c6c1e02b484e2bdc031b96bd34e4af003910b74bf3b53c505ba8fcc9b2b1d44eb7f3c9322c76bae7fe780384d3f23cc235c764b7339a1fd76c13206e128e66e9a1a55950b89e4816df01b5c104df3613859ce1c8ce0b4e5d2b520d66cdb2afbce38f1079143b4e3bd2f92421e91e215520109fb95845927e6729dc6b5d6e70eb925d06f007e1bdab1816fc9f105ceb067e87fb7776d792d38bdd39bfd7951303f720074d224de1ddd95314c9fe0264391f3cb7ab082313f1c7ea2c1b2bf8067a86cf047390beda7a77f548ed270f84dc82e48497dbc83a69139b96999239f4ea6c11a8b8a228ea75166dc3e4dfff1d80fa2b4113343e684832b329c8f7ea8caaddddf73f7aadeade0f4cd05f4b022fad10870f9e527ff2a3f9eefb5a81416c7f8ac0550011bdd95fbe11293a38cc81e3bb7c5ca28bed82dbab35b3bd1a7d4e2a99b1a3c7d34e4f4ed236c0fc7877cffcd650b8334243da97cc2a9f385022d64937b8c6463aeba43a03fb4f6492c562075d7e540aa4f32539c96610f9324d455a92afbe6ee81a60d0c83b6ff12882b6b880f771ad29217110399f1547504f086c48e942342e2bd0dcb35231e2676ea720a6d8e56717fd969ecde60ba36bbb7ef7906a315ec09dbcd47bc69f835b428ab972444b6100289055de13aa1398df5a15889de019917601dcb61adb8b618201e2c3a9bfe1d07646f15b79cc0794f42c76f6849a7ecb855a89e4acea17c09e927db376bc36d9787b5fc00c975cbaa728ff1e6823325d4123d0be5d237199e86f60c20ae417b6124e82b5e0216afab9e1e155b94a86fa1160c3b88119eec17291bfb9e5711dc96336d5a9be3678bc3764de190ae479bfd47727144543a52570f075aabebc948ae21ae1da9fae0cf6c8920870555e18ce95775595ec38de8fc44babef7d9287839a1db10e64544695b28a697233c7fba14c7c54ee5abc45ad00e05ef5237a8fd2a230a904f8bee38b0abad3c974189bedaf539fdffeb683abd50eedebf19ba0ddae8b4c4e23c8898f1539a256d485531e82184b424048b0f9151b755c746778ed48e6ee02e3360901b19bdf106e8df59a84302bc3e87fc963b09c50664bea35fc7a4604ab4dbdf7df12a6473f438402964f179077e99c97eb4da6f8203a899038f2a89f1eabc9bed11b54d95f41dab16dbb292111bbe98acf718b39025b68b95343a59ff04276289a316a41b7d8b6f52c22db99ef5cc57c8b7887d30a8b32385367248e92a225c4fd2064f9ad2ac9a7241c3c890e4c46b55f9fa739d4b54bd3e6472847350f6839cff5e6cf613f81b25067ac7187a5574f5126bfd58ab6b2303d549d9817ada7c79558e4c2e402bf2981879552db60cb19cb113881d5312fb494fd500c2d459fcda12785ac33490abb6a2b4190897a242cf703033e983ec20492b1cc1668c052d35a8cda40f498bfb664514228b57decf18df156374baf4772cf1b9a5afdd639cacf40160abfa4bd201ac586f7e0a2910ee14015d9cf502b6f1a1ed86469a05ad69e72c3d9351941086a587ef9823c01fcf8c4ab927dbd5a3cd39c7794e5506186278ff011d2f2e61ba6941713eb05fe13f829cd3bec5a8daea7b8bacf38be72c9ea12d1847699279133acfc68c6c36877684d87282e862a67582a99e8d9fac98b60e564525c6fc300ebf653fc7f8086d6efe4f2f2c120f911c26106d90c4cfb00ff27adf70c7b52fcad2e737a13d079a7864688bdb14ab04ad8e3f33b158efb31cc442c8f561f592bfc11da9ce758c7341c87a56dc8a35b3d8a9f3958ee415b0949f0eb9346a88d29e5fad1e40992fd49c523f7c16ca023d60876a8cf02482df13bd46347f444a44bf5c5bfd04c38d92d944caa02e6e6db16e623857304df2f253ee56dc6227d46ed32cad6c9e0967d25e562ed560d3fa375c21ffc533fb2c7e72a50db1b9199f4c6046c64fe941cd342a77b7135e485d6441183d3b5ee57235505d72475fa0ba4ca508f5af25c85f98bbf8d459449e4e1a99850caa4fd0822dc3464856f3f8a3bd26dae976aa9c11eb4264eafafe6adcb7b24e097ce94f5e09fa4bdec6308cfbbbd3a2d18d2af8cecedc82ac19be9ad665bcc7cf5a409cbd6722e01efe10e6081000564b4c177ef047eb6dad4003a4adc4c176f70516c53bfb4fc6fe926183a5c89becf62694846990fe924f7fffa6f06e91ff9ccc443ef866348be9d5842b65b6001079632b5902a110754ce0bed1755f69728535495fe9966371bd5918268ae96d9925b1ac15480d7c5e01bdd5fbc240e52ff77ba36ec1e20fc0d3fe5cf27ac3c367ab66ad32f6562abd51c512edb1a866d04e21ae885790680884a14d47617d952bb6fd9970282563bb6643cc9ad90dcd2e8986329dcba54b8ddf238d2bcf9d7c2b6f739def4858f43b86fa9d51ee8e6de424783a3b7e149d612324a9ffddecc467bd9b1ead1e01125e6172c3e67fa4d4a6557e5a1fbdce26fbc2128ea74b97e6068c515dadd0579c03595bdddcb4440ba821322484426effcc7f3c47f251eb1ae3062684c18297dd96e95ccdfda14ba30b1ff6c29f11515618f355823ba040bd2b50606161bf07cbac40359761a09e95e6439e124641b0e3325077d2bd9429cf52cf17a0c26c2effe2dc4721710900383036cf6018c9399a6effd9ba5810fd9e6044e5a6407a201b4b7ffc60fb1dde5f211465b3e3927c9e1e6ce2cabfeb0bcffa2d2426b0b75c81b732fffcb7d1b077ed35a13b48fc42bb72e20ed3b709c3e5812f88618a5e220d8524baf6d5bb6c7c13ffd136069e271a11fc85aab268ad0c73dcf8c1079af1f2e3cc531d004b934c5415771ccd21e25d6e787fac04a887baebaa4d5c6ee39f8796c62f5fa0b4d5c0a70c160eb6b509ce5e8ab304959c27d46d32e88d243eab84195b4c3c85cc6c9b988eb0643262a6315d1f1818a1e7fe46155563c95fecb34c4c5738641051e3223ca9e9be2552df8f27934e5cf0f9b408c92ddb86b1b834639822c338b53906daf5c95e3c07eed6e6c544b909242752cb5ec448464905b58dbe775c822a575c1b0081884d4e06ede9201ae47debbdd602663305bdb77e0ea625675ec29440f1c87eb67f379abf04cb186dc3710ac66322ce529925e172dceb8201e9640ba261447b02f736edb6280f4e8d25992f8501f4d31543217a695db28745dfe3f60898598194dc815fb619589d10350b90f84ada6dad78541f5f822c27993dfbbc1205c2663ee8d2020913fdea12f928e6e13a5c24c288119ad6331d7cb6a93138de043a99e85294f9946fda0e451d90c19b2b1a74423fdca60fac801ec6511ebb78cc3d41bf543e335860ac01c8521adeebed83214c5f818474a2bd37c3392d0eda2173a69acea68b8633f454603deba72572598cbca7239b20df822d7f10066e26dd6662c26e4ebca21261f7c0f6c1656a88ff9dce30273e1262c5ecd453c84e56d05c774d721fc8b51910281545d0d5908b914c1a685bd51328bdcbbbf698118299cb64381b62f44ab1f6941ed7e4d517551c0bf96d6cecee60361d47453a819929ca416e326854accf58500f31708789105b6ba9a0bbe7110395d2d6363d2d764a435dc502e60ce53a28a4f8998d6944b4a9bb7655f858731fcc9b6d0b2a510f0600d36684d759310eb1c78694612b7c43414e829b75f437ee8f7a01c865f17bb7eca7cb1514f1ae6e0855f4b06d0eb6a21bab49b8de031815efd83ad32be210f29c78e2499e5ad3583c9b2ae7d9dfa2e86fd915feec44c45cca470e24bf05e99923647c3f11b67e007bb00e2c38c721c940def8228949a409ef5838db7d96b4f878e410a77f63505a16936b873ef092edb0cfd89b902291dad76af66953bcc1c4bd8c7d8806d8b12435accd6588919f3c857cae067b32464bff47d75026189ca8ab8df6e65d243ab7e7a408e9713d2578934f7f6b5810e8748a575eb08d0cce447536da5d33a7e33d30f3b81c20d855605c4edd029ef66da391eb8c794f3d5b5a242d1d50a8d074480279","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"cb4dac17dd2d3b658155eb3f63bb6c40"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
