<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="zh-cn"><head><meta charset="UTF-8"><meta name="copyright" content="(C) 版权 2024"><meta name="generator" content="DITA-OT"><meta name="description" content=""><title>串口编程</title><link rel="stylesheet" type="text/css" href="../../commonltr.css">
<link rel="stylesheet" type="text/css" href="../../common-extended.css"></head><body id="串口编程-BF93465A"><main role="main"><article role="article" aria-labelledby="ariaid-title1">
<h1 class="title topictitle1" id="ariaid-title1">串口编程</h1>


<div class="body conbody"><p class="shortdesc"></p>
<p class="p"></p>
<section class="section"><h2 class="title sectiontitle">API Hook钩子监控</h2><p class="p">可以用HookAPI钩子函数监听 windows API来实现，你可以Hook
WriteFile ReadFile就可以看到所有串口的数据了。还有IRP Hook也可以。优点是不用自己编写驱动，相对比较简单，缺点是非常占系统资源的。</p></section>
<section class="section"><h2 class="title sectiontitle">过滤型驱动</h2><p class="p">优点是占用资源很少。缺点是要写一个过滤驱动，相对比较复杂。</p><p class="p">最关键的是IoAttachDeviceToDeviceStack，过滤驱动都会调用这个 </p><p class="p">用钩子函数监听Windows底层驱动，过滤串口操作事件</p></section>
<section class="section"><h2 class="title sectiontitle">虚拟串口型驱动</h2><p class="p">将一个串口映射为两个或多个的问题，这样可以同时让很多个个程序都可以共享这个串口。</p></section>
<section class="section"><h2 class="title sectiontitle">参考</h2><ol class="ol">
<li class="li"><p class="p"><a class="xref" href="https://stackoverflow.com/questions/1605721/faking-an-rs232-serial-port" target="_blank" rel="external noopener">Faking an RS232 Serial Port</a>，现成的COM仿真器推荐</p></li>
<li class="li">在wince平台和windows平台上通用的比较著名的有两个软件。<ol class="ol" type="a">
<li class="li"><p class="p">GPSGATE，是用钩子实现的</p></li>
<li class="li"><p class="p">虚拟串口VSPD(前身是SERIALSPLITTER已停止开发，另外SERIALSPLITTER有破解版的dll文件，主要就是其中那个vspd.dll文件是串口驱动。另外动态加载驱动要使用activatedevice
API函数)，是通过驱动的方式来实现的。</p><p class="p">- Eterlogic http://www.eterlogic.com/Products.VSPE.html
(商业的）</p><p class="p">- Eltima http://www.eltima.com/products/vspdxp/&nbsp;
（商业的）</p></li>
</ol></li>
<li class="li"><p class="p"><a class="xref" href="https://github.com/paulakg4" target="_blank" rel="external noopener">paulakg4</a>/<a class="xref" href="https://github.com/paulakg4/com0com" target="_blank" rel="external noopener"><strong class="ph b">com0com</strong></a>，Com0com http://com0com.sourceforge.net/ (具有已签名的驱动程序可获得）http://code.google.com/p/powersdr-iq/downloads/list
http://pete.akeo.ie/2011/07/com0com-signed-drivers.html</p></li>
<li class="li"><p class="p"><a class="xref" href="https://github.com/Microsoft/Windows-driver-samples" target="_blank" rel="external noopener">Windows-driver-samples</a>/<a class="xref" href="https://github.com/Microsoft/Windows-driver-samples/tree/master/serial" target="_blank" rel="external noopener"><strong class="ph b">serial</strong></a>/<strong class="ph b">VirtualSerial</strong>/， 这个VirtualSerial只会提供示例数据给COM端口，
不会读出编写的数据， 所以要自己实现逻辑。</p></li>
<li class="li"><p class="p"><a class="xref" href="https://bbs.csdn.net/topics/300140208" target="_blank" rel="external noopener">c#串口钩子</a></p></li>
<li class="li"><p class="p">C#串口操作系列：</p><p class="p">http://blog.csdn.net/wuyazhe/article/category/695097
（精品，5个系列都有，感谢wuyazhe博主）</p><p class="p">两个完整例子：</p><p class="p">http://dldx.csdn.net/fd.php?i=35144030363803&amp;s=210244c0411405405a6adaa4d8818c02</p><p class="p">http://bbs.csu.edu.cn/bbs/forum.php?mod=attachment&amp;aid=MjcyNDJ8YWYyNDFmNDd8MTMxNjg5Mzk2NXww</p><p class="p">一篇经典论文：《基于C#环境的单片机（89C51）与PC的串行通信》（其它网站的考完都要收费，这个勉强可以看完）</p><p class="p">http://www.doc88.com/p-78747714418.html</p><p class="p">一些其它博客或空间的相关案例：</p><p class="p">&nbsp;http://blog.csdn.net/johnpher/article/details/7003886（C#与51单片机串口通信）</p><p class="p">&nbsp;</p><p class="p">http://www.cnblogs.com/wuhuacong/archive/2011/07/19/2111055.html</p><p class="p">&nbsp;</p><p class="p">UDP协议的单片机通信实例： http://www.cnblogs.com/dongdonghuihui/archive/2009/09/25/1573782.html</p><p class="p">FROM:http://www.verydemo.com/demo_c92_i47530.html</p></li>
<li class="li"><p class="p"><a class="xref" href="https://blog.csdn.net/sxslyy/article/details/3869082" target="_blank" rel="external noopener">个人VC串口通信经验及相关知识总结(原) - CSDN博客</a></p></li>
<li class="li"><p class="p"><a class="xref" href="https://blog.csdn.net/itas109/article/details/84282860" target="_blank" rel="external noopener">CSerialPort跨平台串口类库</a></p></li>
</ol></section>
</div>
<nav role="navigation" class="related-links"><ul class="ullinks"><li class="link ulchildlink"><strong><a href="%E9%A9%B1%E5%8A%A8%E8%BF%87%E6%BB%A4%E5%9E%8B%E4%B8%B2%E5%8F%A3%E7%9B%91%E6%8E%A7%E5%BC%80%E5%8F%91.html">驱动过滤型串口监控开发</a></strong><br></li><li class="link ulchildlink"><strong><a href="%E4%B8%B2%E5%8F%A3%E6%B5%81%E6%8E%A7%E5%BC%80%E5%8F%91.html">串口流控开发</a></strong><br></li><li class="link ulchildlink"><strong><a href="%E9%80%9A%E4%BF%A1%E6%96%B9%E5%BC%8F.html">通信方式</a></strong><br></li><li class="link ulchildlink"><strong><a href="%E4%B8%B2%E5%8F%A3%E9%80%9A%E4%BF%A1.html">串口通信</a></strong><br></li><li class="link ulchildlink"><strong><a href="%E4%B8%B2%E5%8F%A3%E8%B0%83%E8%AF%95%E5%B7%A5%E5%85%B7.html">串口调试工具</a></strong><br></li><li class="link ulchildlink"><strong><a href="%E4%B8%B2%E5%8F%A3%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7.html">串口监控工具</a></strong><br></li><li class="link ulchildlink"><strong><a href="Pcomm%E4%B8%B2%E5%8F%A3%E5%BA%93.html">Pcomm串口库</a></strong><br></li></ul><div class="familylinks"><div class="parentlink"><strong>父主题：</strong> <a class="link" href="%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html">驱动开发</a></div></div></nav></article></main></body></html>