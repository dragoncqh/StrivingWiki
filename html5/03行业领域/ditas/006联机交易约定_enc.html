<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"4aa8e87d3817312579a6abeeefb94b251cf99b76407833f909d67488dfa2c64fe8c6adee6fba3a3c40203af21e7719ab3b759bef168eab600c61e7651b60aa48c90223f00b20289aedcc5e55408b971b0f897004f9e197d67d9092dedc3d7a5bb7d8484f8be1bac0a07326da7d0ede033ca9947bde3f11963525382d29274cf1d0dde20fd32ed1931282ca78bc9dc9844ab97b1197a4e66027509ed4f7f678cb74b0a1b33736a97a56ac834b25020761e37caa6cf311be0d91db1aad685666c24209fc509b20342db2c204a21403d1ec8aa0479bed22574afcf283c6de4ca89fc7ed4ba8bb3ed0a485e8cdca685fd31878d3e216b3070c06c0857b2639b55b364edd87972afad6d5c6c877650bfbf387d256a7e651cbd6c9e48e6f84184c48a48686b8fd865e5db1ac32639ac49a070c3200687ef82cc201f9b4c9132491da2cc142ed0a2e553e546db139dd541713ef8d1c0861dbf628b75b4ed40f2d368af7b0ea91add8c2dcdebf7bd169257f670c7be86d7921152907888dcd29608632701da99625f0cce709b08887c5e9914f648d3fc1e129a3436b3d6d2115cc03d742428d1670e5c3cd7a394c148e9287978c4ca0567f34b0a8b9ef6b0c55f73eb002d8d347039e41f11975ba68fac76949475746bbd304ba3e988fbfc01fa795784d4dbffd2d71c2b40ec6d50b0d71c93675d009b558f4c06c127cfbc392e8454b41f395a0d6d985f49d7b5955703cd975c3cf05441369c5fa0e1ebc85e57ff24898e79f7b7e704c50c41511ac004353f5544110f60e0f78e3fae02e5f88bb6a52796b78f9b9ad003f3c7d7b0b3c539aecc0c37def478ad0582e963a6038f586edd168a4bec5c8795e680a98a6e3dbf952a6409a0620bdc8aa0e187ef9ae9587c51e8d7cfa6e7347e9a95777189707ce9105e24b3d2fbc1d5cc4c8fd7ede74b15c46d5ea145aa86575379dddccadefeb86457be7c8825082c997d716f23c812ff932aa2dde6fe45346e036b9ac4f954dae6fc87515648bbc9176120faf820ef422dc25084082566456541f5614b726849e80f40ec24f36925b88f9582a7a204c6cab02e5b06a0690754bba95521ac154c9128a0bf7c37222f23ff5e462231a30d46fefb29df305d8bb5e3b4f8b639fdba553039b3fd000bc14b47e2b27424b3151e27d05b832d7e9949ca14cf089f0a53268ab7a86766ef8de78739a419cd08cac81f045d5e22ca3b45b184ce05478455656481b57de320dd70640ac09e76eeeccad1cd34fa6757b517c4ed22dd56641a6a3f29eb345c5bad09f7cd0cd2571d7658e61dd8c385af2c39f401a1819b36951586db255f7ad753423087f82771059a6baeac3f1686eb349664dc89780ab576368ff743ca6ada48c1507d828cb02c79612120e86ac9d666760fef3aa05455a96cf4f59d136c3d5de7b5b825900eabdf24911265c11398100ee838eb05af1385d726b600bd21db0b4a3a61ffcd55675041668ea7d5e610b59f39a7e7fd7ec1a725574d6462fc6ec7a625aad84091adddf319f46ae0ae347515a70ba354d60a82affa18b84b1ec5817694be4088ced748a8afbf6dc830513ed87fd2aacda1c82d9c7cc27723254c32689767ddc3a3ee4ef110a2c444b8858a48cbe86cc6c4510042ae00c447fe70e29d1f85e08f66204faac7fbc006ba19f8b16580ebaac493fb322811dfa1f95ab91b91e93738057edd79287152fcc0490af276502ecb3a4faabf2f54d5fe1819c892de319ac5fcc8f3c9d8d04195b1a0fbe8a782189fb3c6e9298f370241ef889c3319f573a53f244c73522d1b9b8277882bccbf634594caac050aaf419e5a7065f75fdc051f93a0843271760aae384f0d83e405a92e34f75ced7da4407e197c69e9dd2df9d49f78b59b934e0c9d5a32a591b62e3aeb774eb50f9e9d026a090fda8d7e6b1454e5d37d42ebfc74e4f94c0370975bd4c74d9f54f750a3778b2ca83bb55403948f35eb97d3c5ceb4c97463fb2cc42039857f692bc3b81ab1ddb0ff2cb9f56f84b38f1a3dcea1e664c0dbf734e04651f37722fd8c12d1a75afbfa646cf77a2b2e8f55ba274d6d756fb602a80b61b21aa36da83c80cb473db2334a2d2e4d4f72b1b44f48063a13af040921318206805338757fc19cded76f72c77bcd57dda73a45a1184e96bbbd91c5cb9bf5122eddc8438308850ea1716af9de06339da4f383b257d56e67a3610ca819fcf7215bee32cc5c8b0bf2d4f77c7c8faa39ede60dac3c528686ddf288124c59548757ef7ea20771dbb43c70b9974237781448f1cb2c6052e3d865ea51ca3c235a728843c1038a75784762b373e87699b76599a11bf153f7471b71187c2ccfa19d79280b983f960badeb50780bb9beab08ee13d544a228a5d0f301eaa426dfeb0892b463d3443db31b1fcdf50b53500d419b412fdecd8aeab64837f7f61ced777f01a3ae92f8147a3f9280d61d81604970121434cb9444a9388e2b52a8066d54421b7bf4b6ee348631328fd29e3bbbdc42147758966e66e34b8c2a87f995f83bada58c3c6729dfe7df55b6d9d29b263983fb697073a59697b8a70147bc2d3b76ba923f8a5b1502fb8402c80b5098af349e29a401bb31ecc18d1ec41334ac3546df687ba0a9609dab35e60fcc61b45bfe9b4d0bf1527f9eab9f32bab14cbdb80059b11b1214fcc9bfedf2f22ea2088e2c4c041e4fe64c54b215cc7d81c0771cb1e89e7844c689dd86594c4d1a97029f8f44010c84132245c840df18eefbef637bbbe49369ff475c05f87b1ab6c96ef248cead789495a7be923beca0e6592874d063a56ad8f0e8a3690b88318d61caf0db4c0d1bd6e84c55f695fb18a91011fb69f2399026c257dfc5389e98dda505861ab429000f1bab16db84890841585b5fb5f81217698b717b79a2aeb030f70332103f031dd599a3fca5b8795e9af535f052d14fddc29dbf1e44443a2ec87805fdabd95b780995b0dcb6002dceecd0476b29d54acca66f09c519a1cf95905c95830a0f734f419058c4ff0067d1f725ebea5e1a0fb37ab5b3b126a1c18a980983764150d051fd0dcc722663828da1f37057032d422d04b5f69a176733327d94b519b30723eb98a1c078ee4d432ac63015c68cb9ebcfcca7696335a7aa1ea04e7c218e35f265bd417bcd3a7dc11cec057f3c9dbea36e80175de6939b681621f73c2b6e46f72d8bbf0ae81404135bce1d9e41fd4f59c60958b05e57cfb6c3926a838371f7255e91366465132259aef7089cb674a88667b4318fc16b041e85bce4548a6a759cddb8b48c2140052c1301ecf9ed9e6adc7efdb503a18df708e76168c1fa73086ece939f736ffaca9a77a2949e7a9e7bfdaeafd5a2a80b278e5bfcc89a988f6faf59477a16955a217de69653f215cbbd93dd5c201f892261ce2ae2a6b4326b1af7e1a07fb38b787f155d55d78d7ca06ea9e27a4a1b4ae9e29ee56eb52e71cb34cc6551ba5da44e6d2376a2d45439242c20c8657ef454d9b79a4de811a899a5a2331a6eb285846f8d90903b0aec1d616af4c214c0b46c3870f7dfa0cf7c3181f84088af3717733238df0de664a41cc7214d9bd5e80c8db5cbef70068a14fd567d6f00a28cc4d8e22d2c453b4a9914bdc7295d5718cb5166e7d6d9fcfcf521a20903979adb1f03bfaf73f281246df71903ed7553b55d6f242af456f9047a32fc98139c8e7e01638065f9d28570b071cd300fd5f759c661d25d99bb663f495a6c32f8f3e5a111ff4d43a572bd6fcdff12c2ede8f594ad0b9b79addcdf945bbf1511af4e25753d949dea901046c31910be5385c8706a95be82f3c18f020e4cf915edd0759ed007dc60bbcdc5267414cda670a0715256cccc414f732b477869ad037a6284bbc11980e02820ed20303436dd6fc6ebcaebe4528dee6365a062a74e209ff2fd44c756655279371d017a35398d93ddf374f0aa5c3a5f9d36a711cddc78bbeaf886db50dfba40e5208771ac505a67102ed11e0a02e89add8d57898258f1bf2184ac2d15a8b1c7a823ba9b3bf901dfdadf288d78ba500231f6a6afd85de42f064ee6a9f64738ac5b1c13bee7160c2781479abd801f84ed7a46263e485a06758366525b40fc6e6be33b3cc3a18304efc37a3434d5a0527d265e599e26774f376b91e4255838bdc14e2d3d6619f758e6c9a3af77e750564d77c0bc84c68a0319b23cadca4cdbac89b657e4d239ff2e5f3de31b58b1e0ead5e49d703ed4637e6b306cc85b13935dad3ec00bb887c5ff79d613382558c7ed479b07c7fb6430e570fb3d67108dcb6b6058656f2552bc7b5c35f8d5787daf257e4652ab6bc9e2bdd4a0261375eba7cec8f0ad697ad90edee9ccca5e1eb2356d9dade2e0d55e78a430ebad897b29a607f39b4c2f91234f274372da805035eba54147d1d04e3aa89069eeb7a826355b09c8c110dc2851b38aeab90c18dabd1bbb42772712476bb4e5eaa97e0c14e5a32fed959896d82a9c3c9721b8a57960535feb21d851cd26bb6676cbbbde5e5ee074c9bc8cc04df8252dbec19243ed4534705f44145fb57ce1f60d8c5868877c42bfc67d364db008447ef60458c183193b12ea0301f0a11f555afc45bc90f9b564e563d31ba226c18816b424217e9504ca26c924fbf82bbf1863999582748c614688dfbaa6f0d79ffe23503a20cef3c0f35fd659de1ca44832d486f8f496d839f83d8165a75e3427c88447ebc2e289594ae4d21afd3dbdde4f01dcf16bbbf53a97cd7d76cc64f490a9958bee6fca5065d02b44189a2d2e14cb5a387349e1c785426cc5ce92b2344bc595d1eb26407e0e52f626352aad103e4ad16ae21902aec4d80fec977066ec0cab5e146ac1603788d803c545e440b0524f52591fd70521ec91a8de8a29588ddcc956598b52d7ff7317540cd4b8bb5f862e33f5f23c6ff66c362f25ff43d5853571d093f5bcedc6b3f899b8d2e4f5c1a75e976dd2123e663ea6867503f5726e3844dc7d3d26ae21eb0ec9025661fc8e72cb02a667084eff3bf7680841cecda383f6248b4016580f1b9f8cbbd54a1386f6940e64a63654e074f7f4a32217eed628f2aa9d28c610cfb4688f16dfa62144e8f4c42b013fe7911fb63dffebb9b8ef7aeae85f72122da8a7504757dad39a899e72f2e8db226d0642b88ca967d066f4196aaf2055edce130e356d35dfdddbbe0df13cb8bd4d3824f091b731a741b0d77b9aef890c77db06df4e02f8162a794feee3120dc98f9745a3725f60b82461239fc8c76b450cf87e7802f45f6cff23922526be347292a80006f57015b525c21acf248b81bc5bc0e42156b485e99ec5e2eeee0c1964d4ddc37bacb7b05332fc569e04fb8ac614bb2db5f91ef6fb55e5784f1be57b001096f57f7f08bde247eaf54c6d4b50aace7db5061246c5d7a9980595f2d3d8231f171da24189ae6de957be0a40fe08abbac455846c5d5aadbc920add2e369b66a536e2704faf5a22c9d89ad011c61ec52d2de607bb64d7654437d546f5f07a3840a27ec615f9ffce1a5584ed035a9b87dc3b4eaf097549003cfb5f324d8c35f7bae45337b7ed42c4bab49ff759bfad7cb9ad77f932b223d2e13000622f83a5e1d21269bb440c8a89bdb587a6f98e2c951aa9777e83b23fa7458a895a372b15a1abaf4a4b8229749e7af508cbdc4405493bb2b3982d0027d354cfe60eb0093865962a645d770f84cc02126e19216fed94554d638d479addf2eae146e5713d584c8b979cd93ecd8c5b8de9e19a9752be364d1f8522d8a786802cb2fe0d955e1df60f0938e97067792a17fef63fedbb4bac3601d54f94fab22c24d0fab0e09a5cfae17650c9ccde89f8c99fb7c0ba7b4adc6a6442fd8fb7621dde399d5f388b8d86032399f4f3e4af089925b1316ef36185f0ab28863344c00b6f69fb56dda5a69bc17ba6af470532d130307d3e2ef7f4c48cce2de45238fca18ab731d4e17a6f9adede134d5805c6cbb15f782a26af3dd8956e54d5c6ebfd6dcf8cbed8f937cfb57cc9e313ac70d24a4d722f607570a0dfad00a4b2c6dcb9afed854fc10659bcecb87ffce2d37659e2c8ee11056003691cf102e7e9fc6d8a53b33bb5cbe1fcabdff53207d7f5cc3ad4e4ef5b279d3ceded0f13eb3f8a1b803f603db94aea25ad24e2f0d5c24c4cdaaffeca44285bdbdaf3387b9b3d112a5f2ed75ff9f4f04eb1c79b43426d725ce09cb1f105135adc19be2cdf4a2e95f0c8706904628145e59cddea43dae95e71d323773625528b834c1f913321bc0819eb0801feae206a7fc2840728cfa7a0a08ecb907452f7face0b85fbe9564f2a6727c35efbf32d800e09f598e811e35cc378001444680e1917df30172a264e2424c85a3a606ca434f16b9a3c41e43def7019b85cff03928cfd0cb2416ec359a6df41189bd1c623f7b3cd12d8afd94093b2646db1b0f8e07b64c28df822dcdbf5149bcaedc5ba4a039f29adc49ea5546e0c5c111f174813af5c57824814c97f18b26a4557eef12b1f560b03cd377a3b6b8affffacad6cd012befc4933f070d360a41835932272c02ad361b938185151403d08f7ca9ae28cc61dcee2b56ae04b4e12b8befbcb8a940a81c90cfb92c0922e70409ebc554574c75e3057940bce07fefc89a11b533673998093880df84aa399f6f871f925f335b67d828ccc40bfeedfbb5c971ddb524ac0865185ba85f7d84bb629d1d83d83e3403e6108686a17c13a156eaf47076a12cc1e346228641a26629576019b47d2942cbd425f9d0741bb4d919f6abe40ac397e4b6b3ce0868fe68af9631ba512f0243d28fc116e36c3238ae986bec7c94d9ef08df2100240e4d72660dee55b6d924db07c8d20e750e5dc45470539cda9c088e48ba09a12c8721d083cb8de419f9e6000c8feec23303f1fd25f075c0dfc1ec838d2901265bfda3c68e55a069b58e9ba2f7aa301e4b9f14cd419af6b9179d75f9967e057e38ef00f87d28583409ebf1aeb76e5a75f14361436b9efcf4094df77b5cb27269177922ec2661715c4106bc5191c4aa9c29e1e19c75eea280b995c52fb7a4ada57cc8bbdd2d033dd21c4b1d1bc7ce64fb47b0ed9eb5d6950f0fadf2dceda8a9bbbcf806427fef91d050bcaac84747ace636403b5fbe99e6f5b1edfe66ebbe4a375ba0ddfdeafc4d1262c48788685d24909a5c80dd568a8efc2a73106418c5330a1a53078a645021e8fe92d1f46a9d749601dbb7a2028d6eba552b9367fe4a072c2faaaedab6c9f6ffe37673f889dd94519e443d37c5778d80ea3a394d73afffd5e6ca23d745d52ee399464f44dabf0dbb4dbd8ef048f2a4861d6c2d8c9eeca7a6be137c55d36a5e25f5df6d82da0470bca041fe7f0dcfddde0d01e80657cf2c628bd5f67511f00471f46afa333fc5184e5e5f72d8be2c71e2a03519ccb1e429861982a3a7f455c58b2b05582cf3a407dd559cbb408e30c56b4e286041c87d836cdbd6020dcd9878ccaaf81e9dd8133a9ccfa74f544392cf1fc4055cb5d4bdc4ef9d14f90328c86bf4754364b1caba4146b973d7bd0daf85196a134efee8246027fa71bda5387aca6c7e49a7b449dd633770e81a612532e5e4067c2bd1763cf5e0ff4f554bcb6a6b64fce92fb96f3663d59507a8252428b8bdd2f6f9ba82272254230d1c0f4234d1682bafe64545c360dda37b18bc21cb670d6936565ee1a21c8d33be128131c83e505f336418986c96365135d823925f0211344f7775dd4de09cbddfb785b936c45bcb17fcf006bb07be3af9a2961da1a3b80ae732f834f9be1770c6ed2507ffbba98706c9bb441d595b1ba9e4dc4e84e9f561d5120e94026e3615acdcdf244f11aa0b452c43b0cd3dfbae1433468d729dfcb20f375ae958fab1a6d7b66348a06cbd0416649157cb1f571ab81b1b65789cea2168cb0314f9884a93bbed345e0207c8d3b43159a7b36752f57c73fe1b1302a727e215f7dd1104b8d8301a9340e2b7e16c3f0958bedb4a32bf26cd4bef042afd0900af50db020a208c6333a1ef091fcc9b5b27f9bfcfea5c45ff538080eebf10b8b9f99530bcfda2cf5110d212858ae2fc2c6f5a61a1625eec767582da8ce0c01c979adcc6784eb88bf8eff98d23181da7569cd835cc2217a8f4ef2b1cda3795f2f7e35c81acec07c9443fceaa827129ada61a38a817fccfea0f4357330ade94d56f331275ca41f23b860a26b752b21cf85d178452de574ffc74060a4fc652e462e1b3dc53b4781ee69da950d6acdcc157126b178f14ae0fa915f07f7970fe24afdb2c7c4d5d24d27eb2ef084d9050e7f122fa11a64a4364d6ad37c4971349d06f31a9954baf4626bdcc91b56f242de8117103d6d47814926843bad843ac940d4db16b0c71e32be8dde0de3a65e29b9c627edc77c4bb5b611b981de5912b549c5b4eeded76995268dcd1b040db13b79db53fc08bfb09d8d9d534878554ec59d8057cf59bb41e55296776d83fffb12e5b52cb51baec2d9e181bd353435115dece37c01a2ed16e20e777c6fa8fa8358d6d23a62d4c748efaf6d4f036854b2c1c8d6ac66cffddce83a69834811b393a5a058bcfdf3b7d1c97844d3876a31e376ce32b6c69cfec3ded9ab26366cff481ffc40cddf6cfca5de6911ff4911cd4e6bfa1ad61ef55343178b12a22d869ebf361ffcb87222b624621a367cb493597818c607afd5a1b4a0d8a7f77139f1ed73e583367c9f479ddd2761f29d5c59f94a973b59d96fb96a234ce6b9834a503ba59189685abbd8be87537b0d0cd09672f2281fdc9cb6ce9d807703d8644c4a979eed299be4df245ef4c14ba77bac4f9aaf5c84e355d5168f517de8a6917c6486762e0e378a3f579de8e1ee2cd171594fa6cf69c12b7aa9e423622e610db4bc8c50d7b84cec06f2cddda9b2089f40578a648fa245b0afbf9f942779142eaf27f9993a933815a07cf9dc689ddab18d3e8c4459ea1f652de81de051c022a9f8afe7c98badfe372ba997f0dac233832030e09b07f1d9c6c95792e9bd4107ba97d6423b28a846798ef1b7f8f973ec06a8f36b73c155b3ea85eb0b6a19a1a0784b80701beb06c191cd3ac731875a551a1e61b04c2ec4757af1bd11614e2fcd5d135c780c079b80e9ec9be4878956cc243f7f8ccf72df21dfddacf503d53c94d7ce69e1baff8206dd360f549bbb2f799d489e0f50b4d317deca441b7074e0d601e9d83326c29a99cc1b19472bde696a4c5f52844e235d16b9f9abb2ed83ebacd1382dd118e6699f4cbf7d7726021d9af00ef678edb42c6cf32337c8de0248415a529ed2b0ea10f25c0a65b0d717d51c0682c65c99462807e28b961d9285232fbfadab9d739f3a165eaae251c378f16073496476a87b547eb58ef5fa15ae015e495bd208bc9b3ce3499b968199dd77b9ffef3ad9e058f37c12b7939ff1f5973c27de5975c11b8e5bc4d1ca040f13b0dafdd5d4ebe0c6dc93b1b8391357e427143b2978799b62378cabcf73310a0a0d127d486829a5d937d5a709bf6ef852ff0208853ae749130891900bca7a896b84a006d47e60a733ea4080bb7a455c391106de22ba408c6f79899192a9c835567fe9b3c2377b4bbc52ed6c47e4046d790e0f230b6b584b44ba9fd6179aa91e647846fc9ff1e4a9d5da9a5c23c812b81303a2316c07136dbcaf0e961e102f7c400e9bc2f5ff2cfa321cda952636571be6a91cc5c925fcf3fd36a2381a7db0380377975c57cdfdb427a3396a15ddaa9206291a2fd20d70928f9c15cf3547ab5beed9e039132827fcac42d5bab4a8e02faf93b15f95353f51dad5eacfbfd60908bc853c232e35943cafc15e6aa12ef62653169369bf4307e2e638479d5e66ffd0676c809707ce7a8236f064f7d0251c251e5f9a2aadfba0976aeeb22f729c29020e8b4059b54ece29a79963a2bab6663d593350161fbdf183c1d234bfc709bb8631e4f6a033025b4fe28839430f5101aac1357ae53ac5080414343ab3e3beec0b602503865d85dd9d411878d7cc0b4e2bb5db8eea4daddfb3cdcdf5a76be297a998b1597247075b3847ef891fa467e99a1ac906733dba172f199045d97c316603d6fc43cebba7676b679b9f6be38eed0ea795f15b383f2574694a172321d1020d0f651016c779380fa6b82fca7b4216abc6c4d2a4bc9c03b69950bbb28e8638d48fdd5e95d2ebad598fa9b1f7d81d5af104e4e815d626d5573d6ce9f04c760bce7add3ed5a0c5900b4c2d6cbefd4f999f6dda69745ce19c3144ec3c3700cef53b4641eb09db3845a35bf7700978d89da637d05cc3c5c4a462c134757f6d24470f62225a649d688296c1b724cb33223899b19d132da0d9e846e5d78510b7e47339c8a6f4031d254b45293ae3c2a4386e490654aedab3a6041326fe65dff7d20020320a2ceea2759ffd48843bbe2ced52afa9986444751795a18747fe552a534235aaee57b2fffa37cfd94554b63b9f96ffbed5a49495a03de71935f89e6108d5de2feb142d282b2884b4e9d90b87cac5091a8d7b179e2b61e16cf350116306990b25e2272a5af54ee79d360ce99dc0ff6b5404384e92fdeec2093c556a21ce9f8e202f772f8984f44354961bd78dcc8367631b56312c3b681a8e262e7bad705d1197e9efab563e3076b63afc6a903c82224063aa899171ec848a032b4498e99a7ff2fafe0aa0a569b412c3ea26cc8534463b1027c2f224d5b36b0ad941383759a8fb2f8bf8a7e95a9e301ee88acc56d76a71083b3a39ceb4f1e01ef7e6c753ed33978b8fbd64f703a11d651be2d93924f6ac3497bc93a27fbcff2c7ab68fbefa966c28d72214005dbdae5bc3e857f4cf8a6c8cf95f4e84185032a131dc7f6696704f7075a2c60a0f9282b8fb8e53bc7647900512d0d03296b50ea521d4663bb503039d628d2e80d6e4db68eb2daaab09996ad3ae5981aa295261d57968d70589d802a4687a777acc3c3dbc7e546da70bf3daa3c926625ca41f6a0bb57a72f3ec74475ddc423e95894ad47c6d33ee0f1204bd98119a4c637fa3e08fd94ff79c9d0b59cc3d3da423f1df78aa240ff1e69422df476890aa3aa8b8f885c4982334fd50d41a64e862f7e0097e833d4138837459fc6f8e991d115b87c7a8b7f6fc47089bcef1b201f7f5b02ee4637d064e685c8ce8f48e886aea63cf1f87eb6ccbe98352e9376e6b3e229c8ede9f54d50502732071e5f30d27a7b52cc63a9913e6cf24be9873e7f99f90cdf6d760ddb0453335d009e79ade185c77dad8bce89ae4a989d2c9492bb0b762463b090e164e799d194250bcf39d4fdd79ef750684c1d7724934e3208ebe2426567f3450a6d7a842a28a41c3fa8c96662db50df22b0616e6222c446794fa6e1f170b263a62cafc1e074b435ffb0e504ec058168d1776b555f8a2a8130fb503354b074b85e72584185a71a73e41ae3bb9ceed7f58a5b53ec03b96ba5efd9d19adb322620d1afb82c4bfa33af64ef2c74e53b9068f18a36206e68a8cee2e376f3a67df5ca22b24e3033d34cafe7e502fa3b54f94854b15079de1a2193ed1107ef531b3cd56f875714918afc34108edc2cdf5d9a33d5e1b95e903d71e50ea229826d4f1b1c17a71676fa98b1031dd591b9793a5f70a2c618462a167662ed91a70b6f5477ffabb5712c1355f6e96059a596c70107c155e975dc54f800352ef0a39de7239f7dd5675cf30b68850b842ab493fc0f413a6a163368e05846e620f17f23ab89c90035bceff67d559df7cb378f124bab6501f5507e45353cf156b5fd6ae0a1ae5faeaed57da61b577b0c817fc6fbc3454bff4ce0778829d109e39028bf860041ddf9ef0fb742c08303da1db774a02b78dc5785de0585b529ba8bb20a024143d87864a0b8c12287be4a0c1c9019cc1b652ae51e10f9416cffab0ccb89505bd37777e5acf268f62235ca27d9eb0fd4585971c3c2530169456e0a9c6dd63dfb95d313c3853c3e1613fa34e7fdaa0824404e9cd2d321affaab8fb9b3d2a4da94a98ad21d3c76b54e716ee6b3d21c99162a33eddf141618549a8f16f2c750328d79617455ae081ce5e5572b78e07a46471d5f442846b6244bf3f5d92be946cd96f315796c0b6272492aaaf1352bf4cde182bc393be1554acd4cdd74f9e193c3ee2bf06fc4caae305729c2bd363e0d6ff0ceb83f5b0bf869f360f4eb29c40d55e208d009bda90f206396a3c21c4fdf677cbe06b2d1d5268cf3db8ba73fae3fd2a2b2bc3a0f56d887dcab15d431750107d64b0229250fa766138c4ea95f8930d690321914c451a32a6ec1a1622f9c40f69a9916a1ecabb3dd3d952e354fb9eba045e3ab6b4af9eef6007e9b14ad72798dce66482031e2ba14c2824f4ed4c1b713acc176547e12a9c4cf8f82299f17b18eaaf50294f7599bb28e359d474a3de5bc549a24054a9bc1245ddb9de167b8f45e9032b6d12f2243536c6aa2f5e59d0dc33ca4238017ea644255d85e7fc77c0b262ded6755b7ddefb560751d69911fbb86a57c70624c143dd462c45a72a5206a79e23ea5ff022f2ebe9903ace11c802c12e86af7db986b2943a53b301d4ebcfd1a98e228db8ec85adf41c6701a673f26c2d8486be046c48d4aa52f895c7bbf2fe677a548143dffe109e0a9d5191b9060d2a63f20d8ab12d575a09864dd4577d64824fb5103f0d4e4eb04262feca493d40808303862987dfa0d7e38becc1127df9331e7a1a970403c341116d1cbf454a14854a16afd64003653cb2c04f42d54caa7cde48ae676f3fa3196d5db1726225164afda5b20eca090f941569b8c61417edccd8f5a8176c027b1231b8f4959902b4891f614580d42b1d6c6ca2ff02e816b598085fffb14c19f3cd81ffa26d6ec8e513719f7d71461333bda6190f4c0516c55b64b13bf51541d49197445d8375328eb9b5bd7d8575890f12cca5f251fdecffe3ade18c17da70c6a78c77165a3f4a25f953498a7529e44650e8a1a7712a2e15b0a6be00ea0d01fac7999959f41d3ac7863a274bebb7dfd4f4afe7c64ae68c40f89177efb860dab1cb18e5d45eedb45270715cda89edf7737b56b579778223d77ee6a726faae00cfc166149477a2c404c009abbb22d55ec1a5b25af1cd0ac2a7feeb72d0e8dcb634ff984799d00007e6a7e83cd4484ab6c1a24fe4c1e69883d75cc3a177c1fe1fd6417fe9b15ae050890fcfdf37bfaaf7252662127d3e1f1fbde99f7e655f20b34ae2fa05857073d112850cbf95b269279bc99def2a668869289e689a6edcf23fb314d3097b782cee73670e712fe065d079e2472be9fe4e2b9a5cc5932c908c46b10cce273a97ba9cc76fbe64451480896af1f302f2ef462bb36db22abc857ae13f0553280c413f327613d257850d07977871548ceedc01b17d9cca3d69bb41c2ae43fa0544bb5ff3b705577c7a797e27dd480d0fc0ad95a75fa1ae6ebea72d0c54f7725a9fd7a2b4c4095974c08baf57757c5fa633a10a1563c5f8393ace49549ac21f77876c66675b490ac3732b7550db9f708a7d54ddd4653f3d754aceab967335f3a4aad2e12fb4fe4771b1a6a18861d8306affb8292aec492a3be23f1362fafffbd723434d40edddd292a2244d5f459b6ddfd6ebb920eb9ee394ed5db18fcee655e7e46f6c45729057f07bed1eddbed9a452150c5118dcc25519c97c33acffa63ae2740a29ef43b407fa8a894bbb85012dfe8a6171081eb2a84e59eda750e1284d497c0f5e6c4c39c81661a1ac849f69274f625de88f1a396def10fe3c25fbe064a70d2399cc774a96d800ee804f4be8c47b877098f9a173a93ff0ce6e64341f37d3c611906cdbb46bbf51c6b55ff034feda08f772cbad1b4f073b93ab8fd9c9b3568653998b9af8c0bb7cb1105cf0b8947a63269b9c914a9d4cb8c6f3c5e72349ae070ff26af823d320490d8c28038a2b4b829cff96deb7e52c66f02a7c37bb52e7a6bc71502222c5203f8466a43fd32c0c90bbdcde38913b6599d8ff0bac6ea4d513c531164ee2cf59692f2ba23405f17ba48dfb4356b8c81361d17e26126e18bba535fab660594d98195e7d8b84ce607e358af3013a2e93bddd586d356dcf1f5baecb41b9931ec6e604fd30a3c30aefd6666568914d324988e775d3acd21e565c026e78850630e57038db346ac90323e6f91a21810d1f5dcd6aaccf1a83df3cdb550f6fb481b64bcfa65607ed75a72ea0059b6e0ef1f9ed566bde21ad3108fafb4dd1398b6c18416b8905d03e0752f743f41f9077cce168fdac897cc855b10779e02b6e691d1f698074febba822dd5e0722f68f3ee731658174ec7d485b80389d7108a31c42bfd6a1597c0d0f47b48c134841563385df4865bcdcbc537c4ce79ef722634e647484f68c75d2ec629d37c393a047af2d72fdbe6d3fcfd4531b7c86a539bd32ebc6195a16038de64d1a751024d81696cd95edf0bb82aa7de2f21d18abba9511b6f1e9998e0609e3472c0b2146144240e21fdb075a4af947728af6a82ebdc6ef3ee2e5425223cb9e00d128ffffef063f4a5cec20f2c19cd18bce9e22660ed3c04b93382037f9ed03584e08927b7bb39aa1a0fdc6dac8c5d22b6a8f6a10f9f57ddf09460ce2a3b08892225117469d56aec17817bc7559ce09e0d5aeea3f66b7f6b84e24fe848e012132ced464279835f5a588749063f3d63dd987ad83015e3c702df0e443736c3683b5eb5babe7d8d5dc4bda64b18a060b687d02cfe32016ed747d5f823a1dcc0649ffa84decd26d3e4c76d3c2bc8ba0543041ee58bfbd9df2982ffe1455740b37fd7d238329edb6df223e0fb1b11d09d9d172ccad54c31c478d5d6c368e838a1b02ec40c56f2fef8d0f8d9c19662c0c2d662f8ea750b630a2263c1fd2a8981b387f84e6ce090a54fd4463a3c126d246b041fc0fd424a3df5fcded691f8fb17c44079e4b011350518df4e4c1d4d6eae55f8682101f4e6727c857c36afcdaf1afc14ee466f6255b54d796b9d1e9ad4b000b42437379eff2157bb5313ceab0558a67bc1b8308de0ecd039a7aecae19e3d76ae4e7aad251dd3b95447f36476a60fbeb83664d154e78a8d53d8aeea416489806df281513d922a3556d0015a9752858bc4ed578bd8965f225480331a288c71166d79f036378dc4413f5af12e68f558b039733e26f87dd4b010651141cd86f9b37019446cb8252b31e0c5b44852d31619618e0abe8e51a05b9e66f9fdcc5ff76cce3d334ced3b345d7d195a576c2fd70451b95fc2065ff2ecc451344ee673d58b4de0b08facbdaf65fb2b87300df07635e7db5b03119e8b6ab5f1c0a827e768c699293593891d8d66466f6c07ef218b0ee86fbd49f39505d38bde3c710b9e9210258dc8f2c7ecf1470c71d8e69e784c6703b102776a1925bb85da5e2bfaa4590fa42f56b7fe5c3afc4856ef9c2a9dd0a67ecbe20b3acced3d9caac15ef579fec042e49a0a927f1db4235754383a66200f64990ef0c27f578396d25592526f8096dbc644d0de7f92274bf62c5315f414e0bcd20791b6d22be8184ee99afe6769be6b71d1c7f22bfaa5b73cad4625462c326d91cd994c01634b4c6e0d8dc2ff2b5af89537e80fbe28eaf1992e8222cfa409d3595eb423571074c1e1b1db3e7ac953a3ed5997548d4bf5689e57e8542ed197e8c8ae9e20015ee3b23cfb7377575eae3fa22d0e1be8729eb3c722de9a34e7473809e43dfce4c074787c2a999301d202f170d59683787cf9d112984d4dbe5bc2df0ebb9cc938fec2901294bacdee3d9c1097c68e7c37f08d848d67d8e036daef3366ac19139cf5d3dd009ca7fff2586da67f5140ea336554cd85abf46ac365f6a4b297e2efceee78074926d5a24eb4366fa91e20fb9f7b228d115be822e1647a7156e18e558e928eb0ccbad4c080e178eb79c4d46781543b08ba24e4d5c8c7bb4334a4a4ecf094f0899c59f0f2959ccedd8502a9bf80c9f89f56a77520bd2ed336483a613ed09e850d7d47191dfb18ddc3e05faea12098a2fa8fefe54170bb40c84084a43131669b9c6e692797c5bdfa80acf923cde078bf1f39dd13f79535f607035c2f3f341ba7c1e16317e18e59887e685250c9d6dc3f031e9f9b97f79213919fb3e4ef5c6ff4fe40a937c5987c520ccf5196da6382b0c46c7c06ea6eb1ae9c3026f3117556e7f8f9b684a41ac370b530f27eff942a1da9f01ae1b19117b07fecb6741829f940478f6a87f55aa70aef2a32630af4379265a2745ee83c6d93f4511580f3244832249d47b5b6f93985ce9e08300de1c30e08598eb11cf9f51f3473045f397438508c1c99f9599427881f1a8e29bd20283c6560eeb0632ccbc5d45d48a3303dec6838dae5767b73351670a5972f47efd78c2c9305f7b16e204421d3a044adafb9ee7ea8c4465a5b5259dfe6c0bcaea2a9cb4188115dd8e4c24dd9c3b61551ffa7eae0128935e2a0a9d1f94dd53ad042152cc833fc0bef285e7c6682808b79c48d14d0005ca6c022000035cc7e4badb0d3ae88b5fdf381b0ca8f0ffcee2a8544318eb50f01bba9ed6e424574295c189e382d4720426a60286975380fbdee77fc09f24b8a15133a315425cfe9d0889819760e0cf4ed638d7180ccbb08bd5a5d22cdce883a422510c0b11b624d61bd041140d28e2564f499d95c4a1bbb50b3234e10f48f11dccc7e0eda6649ffc2dae819c9c64b4101fbe5c780f0fda5ae077a95d3e567250cfc21e6f80f9880ee","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"db2470865aa068691185dcd60d0115ec"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
