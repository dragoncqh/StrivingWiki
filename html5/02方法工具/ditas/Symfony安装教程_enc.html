<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"d216f1b7f12c7d8d04a78752e00190ef8a5d649652ec9391e34e857a2671dde28b1b0606a705df01e330d0fe1eb61b2570a603ad312cba3869c4b874507850530e4e6a3a5ca39b760005bb29f8fa0643f35d7d194429c303855e7b96d30738aecb68e79fc3e956bce34060f3ff6fa97db651944a998deb74d63c51eede5f71547c87161449dea60b10566be2338fd75da766aaa8f246a9fe52f8bcd449bacbb90dad6220e28b7bcedc2d1466fcb1d6795341fd699a728021317913cea98a6a55116ca3819761b5752830411121a8813e6de610ecbaeb8126e90519b68e61355fdf44d3f2a261349d404ca227397a7b88a09677b1664e6fa0b71563d2b8c6decbdcf499a763de891acfc06023d1e46fcfab13916efadcf1a816c9af9053d7ab4e241517af28dade6f6aa1c09822700c26c2a294d999c3b639179417f8b1c21ed7421798a508e08f8b583c922fe9ca3d2194e16fae9b0dfcc3ca4959321e733618f29126f92cd90eb1d1019cc1d15e4e92038ca03e7d0f6c46e8dd5df3b32c73c9e52616213e9e5c2b4695bd3e2a864f672021a3d6d4aeb6d44682b131d1e4b558bfc50ec16901ec49358d51390439f7b4f0689cc57cadd93a8d0992c9d1b4488bd03e47cb7bba5d577916c3f1c0c11748b963c9b44b88cc339a0eefc71f9445546267498d7d32d987b05b2c19605d8475125ebc599d99f9044411d330581ccbb5f717a2e26caee320bcccb9ebe9edd48d18387cbdbd3a7b3eb359f956ed642c60dc84b0d8081718c8c5b79fe3d29a3449a80fa8b993f7a2d1b9189dd5a9b6ff68b0ca0ac1a9c37643afdafcfc906b573f46fc821d490a473cbb730d7079544ac23d5669c1a9c8578a66ad8f469244d185318383a9d94f4fa9f3c4f16d43ccef8f10cb0d10c1a6319f9f711862a77bc33566c4dc7a1e9377146c9d2e7db51ee3ea7857f60002efd0b27f5920357ffa4b8f329632e92a66728be99819451250c3419eb9b7da344ed5bdc46aba90a2604b06c81b158dd369ce0132f6cabcddb521b062450d092e06efd01ef15b01b3be1e18c1ab8d6ec0a4dba033cc9f2f639e0d1c85d510f7fae68ab524f7c83f885f2473de4a8d40b2af803d355203fdc32eed05bc280f5ddd1cc066607a6a87d9a1d47ec6176f2a6222f4107596266fb4d9cb7b239e64201a3e1d8d7ad4d0a39922775b390721296b8e6fcb253e8530dd198108d108cc20954c03be12f85a1b55b565f02d9b04aee0349ec400d337d5823ff59b5902e3b4c6cb0f05c631375590deeb441b8dfc96d53a7d45b388fea957c324abfb6a86154dfaaa69f9e6f06f7ca726f385fae2ae12e1da614787241db2992e98bdd057e8fb34f93527290df672857539e56e77fe002cf9de80c2c11da0987639d4677d7a2c3e82869f057bb46bbf14b211222ee6032bab8e3e5ab2fe153f436b2f17617269914a9a486f529576dbf927b0174c126d3048978e8a99cc5c58e81f7f7805431659a4acfb4241ba2d210a5945c840b82f34a5d79610a22aa8f760863377ec00bc3525d423ba4a7bb94cb6d7a86d187cf2a5af64cb8e6da0f70b86a02c91e4a734534a83500c14541a6505520dcd8c0c1a9a755cfbc248df96e84b294fd50b8eb328fb9af75ce8acbc3b85e89c672810ab97b1547248b25f6b447cc092f35b137ff3bd76af8cac1acc222d6c97aeb9f8a61e6b1db0fcc22c962bfdf6cb51c1f778551634808d991f48caf69beb7caf5a739325f9af2d739a9053ba117b5e57fca20bcdfff236e6516e228e2ca139dcddf0469ff267de90cebb3593e39c3b5c9dd5e47874fe72eeeb69f2d537c5d3e584c85cd71d39e521cd8c09dfee4af25696348d0f5ecccf9ccd1a8db20410471d864a23a00d98e2cd1ff51201d2ea856ee10ec310a089812c5384643363512b5f2dce8a700ba4ddfa4b84a593da224f2da08252f3c3ac8ba65513c157fefdb2d449896ce651cd3d0fda09e95dbe32e154936bc7fac42359c4d594b2de6af3de9c2092bae3afdc0a05f7d9954756eb37bb6169587257a61bf9385a58a6d31b5230cf0ec67ff70fa96a6e157e63fc0c8cb8e5dbb62d053b64c5873d2df17eaa1ff11f7a2f7ed285c9439a4e2db6b84802e71600814737b58e78fdeab37087ecffe900eee834c739bf527d24e358aa0b2b4906bd35f1fcabc14fab330704d96863c1c0d3199c464b85665560400fcc18a29c9a3151f241bccac26b66b5b6d3b04c180c738d452347362da372cf74e6bcdf943784990d4aa4f0a994e0717f000f986ddfa2c34c8f50c11324ca50785a47629fdb90e000811d622a0351eb1fec23682b7c6053900bb8e72d268d739238115f1526eea753521ea567132819e3ea589c564b59fe32586d003d32aa3b86d3acb8dbd2b7c8e7f910396131e3dd14b8f46fe5151585e5c5a3524ab083a21cc94b4893c19fe75fcf67c444eeb94a73365572a8375110d178f540d39576509c53acf966a147882b4208704605db95738ff4ac9a30a82abf43edcd0c2d77571c442883b463dff4f4e449767d96a5f6e1e92aa4879b64fb025f1dda014ffa902eac8122ace3fd02031649937af9635fd3dc461f2a6c115538eec4e4301532a81374f59337da27b0cd74cf2800c356a12d4615b7bcd6a8fdcae2e26648acdd84132c3e31a62e513c8490e0644cf3c85af7ed294a06a6120035824cedb812d8e2fcf960bcbb85cb2b93439fc0a390c3bffb9d86508cfbba1f61723677ff8dc77fd5ca7cc448c3d5c708e9c8fdf19e7fb4b78097d09dc86c14b13e66417ba1127ac2327e2c3585aba8d1969f62ab52dc21545208d69c7c5760ff5d4ff94e59eb1dff7de204192336b3fa44224ed986118561f1537e6b78286d6f214e122ed2c2e2c1a885a41d59f2f3e53703118168292b30c47ec37284ff95d45b7d1985b3871e072ba7c2588db84a9f7d1748eb250ff27fa7f0384efc88c7f8d313bfabc6f45db77b3567d634b55019671be461fb718cd9dfcab2f06c1e596a582d6a42fb2f60e45b9afe7466902947b5548d54ba7a7986a450be9b1ea6ba57bf7a5b00b4ac53e00692c457f19ecf1857cd5c5c7d6159b6d62c4d75e525e9f07165a5ae8217070349f7e490131bbc5f8f505e25c8f92ad9f4fb0053b18b1a8fc0d5d504288a9dc2013d1d6d47f24a2543b57180b01f7b9abf1cdd48946584d446c725d289afcfd49e5fa86ef03b2113c1aa96e45818d4f2075aa244ab0da1cf2a2d896bcbd5e929b624e2b60d1e0dadc142ed0eb8820ef69e87f79fcf873b884269110a54b047667fac0a27353053cfc43969abcb3471e19161ddd8b8c1d2d0e514f9b6b0886309dd59b821fb0aa057bdbfe4b51f7bb111e80f0671915037e93648f9bb77fc3d02ff8092bf776fefc1f7599e64eb4c14fc855da95bd2b8d749b032476e1a0748b25d527f8d5e6d7a440abf87c3d33021d0513aa2918131212bd61f3277611e0dc3b0a7aa9db029fae27cc1653ae9e076d0298f9d69225470729e7ed67b264c995b3a88120eaafb02a74b55f5591a00eedb027dc674101c5943674cc71a4bc15875187d2518f599e8eb7956ea99c7748a638752ad568a86f93caf5caff6f583aac6e34f408d08d90643e41d00c006247358f8d2a3bcf6081f0abdd1506ccfed98bcf60a11bb4230e7c993a47b9464a4e6da553824a37b77543d1915de5aa59153bb20ebdd65275f1144fd894409cfb41bf3cbf5ca07dd0cd097722d98ba3f92976b70a0f3d819daaf429765b5b852abb6c86acda3166d1f1604d9e6e3960a82956ab21ec71ae9d2fe938c29605ba7141a857244eda0708ee84e079a25ca4274b80b0e26427638d1dc2ea1a6d10d4ec5b32e3ce63fa1f327960bd5ca0c4210b8337ee34587f2ab236a0a70a29feb5be57fd39013caacd7106a06c724ad40023751c875bba6fcaacec95d7ea64b8e4cc7bb441a59231d438b9255a6e0b3b75745a9aefdfb20a29a6de512f5ce7a5754300fd15d62438cb532a5df0712a167d1afc4c3cd67c21a70d7b0ad9e4761d1593026eaa8496de37266764d7e86c2b8e1c504dac9135b5799f9a3486552bd519e4c6777aade40be606636efb818c02511d0810dba8da32742460720dec231c6889718cca3377a6fd59ceffaffb288a9db3fe1dfc2ca656203b4fcf2a1a5295679c96640b134465f1e9a5653a56dbeb5f734017f22030f75dbcc5b132108f09864d1b8ecca5d1c0f217915478b17134ca527c346c6b9ff5e73be18e816ea4992e4c14f45a86c2258bec73d78a8112e47c980752f3c0599cb928bd9189d2beea0be24f6da43cecafe9da564e6db04cd1566a5938330f3e906891096986224e84e3720bee6317db829f2e89cdd1ee20c187047f80de0362735a1f746d2bf7ddb74679b6ad08c9eeb92795c785d8a979facbf90fc7899f934305764cc504d33b9dfc62d8d545559402f5c1e12c805807c408c3fd072bb602105df2a3daa02389805ad2f891b5197fcf9b9715e4654ac04e2a351bfc245fbfd04ec152524fb3ab5d9b44c9f116c0d6db4c3cae7d6d59244bf82b42da86292daeca31a2da1270f1cf3a88eed4c9a782120aee12907de784e4ff5bcf8d75029088bde0348d3c573a1d489ae994c641cfe9c41e549ebf1b8d459502a800fd9a038aca661853973ef687b4b47b152d9170129f3f4ef904169afb65d2c9b592fc340d31eab07f4e2b95b0d0f05c33143e45d7fdf2729e96c1429663b2ceb547bca5befe5c7b3d97d7a44da0d3b8847e59a3eccc28d3bc9dfef24fd04f19d7f2d56c9b7f6568d3d35ac7f7e17b4c24eb9681329ad108d66a7b60759e0d01a40cdd8bfe3aee3b77fd446dd62c922b2c48fe8b8d221e21b6157c30368eae1b413162cf98dd251c62ef03f58d77468551bbf265923febda373eb0b57222c5881fab61e646e8eccbad76e6e078f4296e5d1dc68c046bd70891dffe765fc4c81a0e3c14fa7a2c3026937852f7facf4c4333100634def7773f1db348bc907ae929cac0674089bacf27ec2169422c1c7c9117ce181220763ef2d1120752ef129634c4411d9bc48760080c66400f8fffce738af4c426e433becab7dfc4217082a6a47c2ce634fa6105f42aad60f04b5d2d03a5e95e110a0d6eb03990e8af89bf68ccb02804741f508eb3ffb8703752f65df2e00538599f8331e6b90da17a55a8827ba9838dfe09a22645ad1fd1c5923deeceed0f217e2cfc074e1cd57951d23d43513b3873d35d2d94fef61ed335bfe78639382504ab3006e12d1a675feed4e99ca6bc2a46590b1562b8ab2c2c8a8c52ff38c0846b4ea05264606cb5fd9a28106067d3b64b8594771eb8ceca9479179522d12f2f9792d5758127dbf60b0507114e61e7dd88efed3db04bd72cf2189aaba2aca12f74f0e67068a18974366f8443f680d570936e293aaa5cc3d7214eaf2af9bbc9a81fed6d15468bc077003e05d69248e9e40c70dc8295ed631711d2f3957654c5370c728f17c4cabfe7456ffeceb50967ee47bcdd2afbb320d6b6ffb3a8cedde2eee748f478510f179ad6c62acf73049f534094778318eafd0f6d43b570c9ce233e1caaa57cc6d2319383115d00543a045a3b60f6e021029c180fa1e96184a617c53274f53b18fa83abfcf48427dcd487b26830ea13d126dce7d59a86e931c402871f181af819ac5f8a7046dbefd155782e6cd5e653ae0abb2a5a3ba5b3a06bf77d21884f5c29edc08edf3674fbdb49e07b18f702669936ac5946cf8b091cc148e783ba83e9d6febbffaef5a999b726e2785a6cd9aa1926fca6c802c08bf687bc150414656c9a1985bd3526d2dbd7a8e5ed70c69738cede9676e9d7ea22500adc12f3ce7c22d2624417b482b56beda4a052ad6545f664af16b055fe243e625627ddcb5fb236dde93951b878da160307d34684af2cafb1cf611c1a9ecda00c4c7a95db586b162ec7892a25d56ab0fcdc010b2d7162bff950dfada78874f9a78d33943f56a229009553b16c14926654b79fd02b549a067c115c9cd6653fab2219bff78cd715bde4c6c59b1338c33c79d8f3bccc6918093c739b2f802a89dca9f299893ff8e3d0a36014012a9acbbcc9590872a3a320f46584c9512cfe7731058ccdde4c8cf6ac593e1297341e54255939420eab9e8c78fb185ece6c8e17e4179892e3a0f3a973e8c2ca6a79cb88dc93e6fc2c09e3e1971af8f7499105a22d6126cd405cc1697533ec644a5c8622b93400191efafecd24d18eac730e8426f889932844a7e1de62807ad9d15eab5da2c7a6b91558dac096f3721ee85aeb9a11f915c27aa1d4d78a48f98abe1548075a18f70413d55c96cef56fc03355cfd31fa40d6ce1c60f8a110b879fa3af5db550ec96927f66ba1b43a6ae5cb2d245ff25a4f2b37557130df165c32a7273416025301fdfb484bb36ea0a937d2e4cbe1d4cc81819b891c0239174d192dc153db89f01e3af39af1f64bd128d91953d989f5b186e2486e34aca9f805180d27a2e876307767fdb093660edbe8a86a068c22b105ef795802670a78c2968db7693af9b809d5520b101af92a13ded5b5b0f1858a364a289462f20e821b0c9bc5e0f318df7aabd51db359c787899978f98b72df8678d2f7db6ad5da77bf6c8945b394f0f6b2108baf086ccafb355b053933213e5ca8752cf2cf252c6b71fd346cc1fd1753bde37f61316885bf6cfd443a5d5c2368fe42920805aa2d81cd73b9ea9c708d820fd78feb6919a9baece0e2e690935a39c274b5e970a14b8e0a05c284cab69df965ca33bb195ee32d75188056969e60207eb35b78f57f31711034c270caa376475eee6c438f2b0d729562623b7ba8217319b76f0fa65d54c0c094478bfc4861ee7a8863f163532a8df4f7cdb60b0fe342d19160bec9a82c3f39cf75a8ce3c92b5b7044e088012e24f199b14b733c4e7691555cda1fb4e65c42d0394182bf0010937bf27ccd0cd990b24b03700cc04a848538a3f48dcaaaf1ed2da8e21faca31450b7c64e16604a88fda8c00120cb778cdaaba95cbc25d2298503cf2b01b8b71f4e84957c711ff21d68a0274069e735e48b350fa66c64939e2af017e3b25f801016ecbfda2c772b83116eea0c56f42d7aaaa0e4118013086cfe35c0d83f941ddf4f30e89914bb94b6f50293671b4b873d8301bc426977ada3368a0fa7b46d8ca7a1f717bcc336d1580616ffa2cafab3fb4725d1dd4ac9ffa2eb6a524f1b2cd93170244874b3c7a1ecc428f532f42a04e2d30ccf1531424c1e0345b110b7e4f5bf3983c3ee039aad91e2419a65dbe0f9b2a3058497547b29542c23f0eeb8e8ced80c2a937720f90c5af348b3566cfee0b43ed79db5c1a0c6c33f9a683c89c1434ce383d9869f55e09bf8ed7b3a92b199e15d7c4efc8ebf1b46138a1b93fc9b113c2784561a38053bade2fb32c00ae9b4274b92f9c2b6e0d3772af1d8c84b1c8f57853ebea6e258afa84e4e2452e186d8670f8c61ca0df559296d3b63dfebc46fe738adfc1559d2bbb0b15542e1951977b7075fbadc04d081c5fef5437fd01ff89f5f97b6a2ae4ec3249a48c9f43ebea5f7127b55abc929a9c425ef86360620833ca6573f7e1431fd17b5f848d1e9d557c8aadf12d26351c4276303acc71df5b796ab96b5c22ee0ed568d1d53c561b9fb28d7dd25c3b78745cdb1d3974b2dfe928fd423c21c4b31d9d50d42956e225c1c1b459fc4bee8e0520209faee6d4b8cacf3c641d606a85135ee706673a82195ba161bbf6ed19f84d046c047277745e4b7ab0bdf0925ea3ed7db8ad1dbce92eea0d574069a2e1ae58f6407d985b217f4b5cc24f654406f4400e56202fe994018eac49c705051bc4ad4796799c9281fcf70429ec6b96cb24ca081991d1875c73c79557d4878b4a532551038f7803c36c3def920d4af99f08d14d21480f2d28f732db15ebd124cd85f88479d24a00c5e80a87ec6fdc759f043b01bf95818a64dd1c2c3d09bf96704f9f385f319e78ee73457b367dbf5ed8d26c8b9272a21f95dcedd80f2a6ac6ffce21143d5c9ae7fc9a5b74cb911ef187a66ca3baf276a77f9a3aced497af8b532f8527fa293ec4b9da807bf4809c9142074a87734f7e8648bcb29d33291798fe8476037ca997af831d217bfe81ea9328d0ddbff5d73fb0c35e18d8869f8dbb028c26397554354bcd5c6bf2435cea86d9114b5df71a171a03d0c42f3d84a4720c9a00e3c98c1f91d7e5cef9eed09973630726b490b62a42b63402c9d84bc543c983e0e97c69a2672efad4e1690932e0faf906ca844f68b00945d1bdd128a5bfb8d3819815e2007811bdbdcfa1e4081c52bd162b2136145352338e3037a2df62781319195540116cd9c7e4b1e7393bf0e919a4fe26cabb3ae4d2e3de7f67dee6a5bbf0336d0d94205f4d76d05907f61b775706de9adf15fc9b57950d93f5181a37ec1f6d891d989123c24c4d90b8ff1c993b2a828c5349632e21bbc73f14b1c47611052a6cc6384987d5cee5ecc73b306b4cbab9b27eb4dfb57857f2eeb30bfa4f25391ba30f30160173688eb917208b1329a2daaf7d42af3a55194bea868b40897d44167d92c57b3830cd78cedd74e144eb63547f0bdb80501fb9bafc52007834420153d12a5f5b3b626b75c4c268e8301e5e69a71a9cd67cc41ec30354eea8a435c27ba334183fd3070e23e6406718a8923a1ad5ded3ea033755f0b4ec45f2c63d347c26e5adc98eda8ee94b9694521c1078253c9c65a9604dd6cc4b85ebec0c0eaf10ebe515c9a6f41901ccfa5defd2a76bf97640d57dd44148d22079edf9830249b88328d937713202de2c69dd70b2955411ef28169a7e5356c482bee31fefd8068678a5039c93bda059edc719a8bb03eda955c018582fa1e327d1513c433ed20a6bceff953ccee83cc0dcd4ef0d67f958365ac1a0b26c2d5a321ba5df39f30b6e58f0327f4a9a5bee1c0ab4d2e8971bbe42b5884ce60b9587cebd6214065723c7791e891a5e4a4a65278813cf27f94335470c0038712cf5cd86a49c652da1a47898978b83c76862c35c0e586c3655411bf079a876674faeb995a0db6c580ce2d3fc1c8865b7f06b6b68d26427692bac9520e772cf7b37a75d4fbe4d7dd6866747aae2ed01c41834c2bdace85488ff119453027b1d9f2aee1773220e9bd4d454f30c5e0bf071d1ea292e5337aacc37b41d9c00d9edf57edf7d78463e936aad00bfe044077b62a53565258c832f266737db3633253beeb10bdf7f215668e9b4eaa0a1f2576e9db6c8c38006ba02653c6609bc7737f442bc895f706217cfbb47e2da316e6005e8ea61f66115e21620d7a1b6b1b4423c7c8aaacac3a684d385bed566350ebabf51d5744300b35decdc503f663a0872240d432924ae164f8137486972a262059ad8d25915494ade1afab43c067fa115fddb4cf4d08158ddc78c2a5a2775aac972bd80baf107757502bd2afc5fb5cb50e54102a9b6fd59644f0458231f729b091827df8621a8cfbbb95a7c93be744540956a5e2249906499bf7e2161cb0d7345445d396c962a5e72e2765c871b85dbcd9b26b8e392ee59124fc82c7a5c487d2750b91dc9e1e255239e51eebbf5aed03fd09ae91fd05dfd392061da25f4dbc75c38ef98dfb58c21f2a2c72b03e12e8049c8599f0622c31b676f50247782c7487ed137580e83fb4c6e22edf37027cbec74536730b092ab10df9a243c9071dc1fac0f993b6459e483baf7fc3dce760df220a39330f404f261779b8fd5bbdf446489f5687b4d4de1ee79d3df76c39fbb6f5d6644214356d30379cfaf5d0d28ce9d6ed8f41fd524ba74e9f6a57bd8e8bfe7374773eacf560a972739ff0add7f56f4e877ee1dbfd28faa2c7ad5181af0c5a4be3de6d5c50b235200dc8058cb3a75ebeecbcea49b92dbeae8fdd2196580fa07be441913bc212831752510c817a9bf4c47d3e0e92c4a5a551fa368c40b791c3d337eca5a0eff5b7d8bf5e577cf1ab2bffdb034cff172d24daa451e9d986546ba4b1877c6a3be80c82e30d056c55ac65ed6e8beae24581c5c6b1689647acb098ca00d047f2d5959b1f8c668f1ba5ae83f5e3a02816d714095c6854f4f53cb9fa5f6b8e4be43217e58dc391b57f2cee8aacd047c42fac6241796eaf6b1d5f7a983ff6c6baa009c3556be11a54300603ebedec7431dd37b9b5dfa90d05604dae8a1d69ecabf1dd5285d29326d704d082174ea47e4758f0e4d7af45359a7e64a8e30fe678c1da0662d1c234a7e4e114ef2a3609bc0ec4b00941db1899f074718832cc2d910981e0c6542f18e38b9342df5f7597edd97e5aaeb453e9015092499a28cca80dcb714b1cc37ee57eaab1795aeaf6433c6f6013e638ed56583c8237740da90444c2155999d3c48564ffacad297918b81331c5b99f34cbe4ef807e625f18ff88516b00fe6852f114c68a810617274c86971d95eff2ff5f7b9b64412aa84ebec60137771aee731f0a41bc1f9368b7c93b7c59457edfee51c3c27f870b24147bb2ad47fb5c3636ad74d2cba48ab717b9d7462f7f5e0043ff8dde8873e5aa340377b79ba1cdbc705288b90d8268dbd07c9c427da2826bc4011a7deda2b0fcc864f1fb5e3ae2f9f8a8cb317c03caf20304f6c0adddb7c1337eded438c12b7c526dd86b66f05b8c8118a86195839dc480577e96810185e1cff696bbf98fa8b2c0999743c3299ae34f8bdad423d2e99b2ce42446059ffec179758f35dc1971ddabbcb558b49d62efe773198d24eb68ed4aff60810f9f76e2b0e51903711e506e3f181e3403d09d8d66b3f9bbb6e9a231b0f1f2e71234539709763ef0de7b90ddbfbbced5508e790b8dad36671f6d871dba5e6138038fa9e31132340043e216ad7fc5c01a7b0abb204b7a8493ad30a8a79a63ab1017e00a40dd26304cba9ffe86baf5bd0c16eb4b5cfd8ed2684551d3e67074fd36583000fbf0eca411a41413953bd47e42afdca80e8f1a8ddd7d5385e2001a95f679c91ffb0871810a30ae141d82cb5251a28f1eeba743f73964575cf814d168e46eb520cb7b82cdd7671ea100d3511410f6af3f06edd1fe9c64e356bc1831b2c34dc32cca9a44c32006bff85823f1049c836e113017789e3feb8a0874d0461703d71f98e4c07c0b4e7a0b9df5f4639a1d18c5113bed75acf799fea69ecaaf7c02416b25e5541b97a072c6924ed8d5a80ba7c2a006590bdb5fc799ca737f7603b1ba7367928d7460d6e32ee1b5bc6cfc5ff406cc13fb43753fc97358807a32be90718765a8cc10d59bd6db361f9e4301a4e76e5db694134e438a5c0bd48fe324a40d0605cd8c562033a6b84d8bcf3bd3fadbfbf0ce8c7e0d2ba691b136026b92451d44a522d14de2ce08148741b0e9661d4f9e2e915121a6ef8be3951392c8c758cbeda104e103be8896b0cb2a4d6d7d87b58b4849a77559d9ce92dfee4d9d5903b6bcbfc478e3c3afa3655e8ffbf0ee40b74af9266b68ee0e0a027c43e885d3c63b8d8b80faa357f989900d91f537412b9cb9fecc1aeca4b3ac2f70c023d7cfefc7e47270751389892454d3dd92896df1e25609a6b2fa1d88de6e567f950f02d2a4d264686d7542485918e0aa98d096ed465176822f3bc56fa457ecfb41297861580841023e10541c35d5f81b11eef1e403385a1731f011e9224a69d819b340fda61031d2fab45d6bbc2df7355f132f42abab6e2c2167fce8cc0ee3a542228ed4686d5a00ac76cae48978fc084d515d2ede49c15ca52910e979c4f2c552d086415cf5fae28909fa5e915407ee267a72745967ef38f70ed4c6d749e002b55bed9a7bc9e1fb4671f81a40ecc504686e5840043228a15b8b9f31de825415392bcab867ec0e5b20dcc78058c2355c75aa27c9f4807d8b1120b47c33f400591b35edf0bb3e15a5fe6c6c371c3284631947ad2f51ef533e8e12b9041383f5cfa64dde1d392fbcc8cdf963445da8750d501fe8ee9d0b9744c2b487d6deb549f75e5a59453526b3acce420d2b4638f1c2d5e137ad497e469e889437fb4d148ea18057ca68c3971461c695b536104a7ccd26b04b6ee990fcb8e37b914645fc894161b597fcd4725f0b66c2da058e50d6eecaf39cb143e4718d15e3b06ccfe56964a82208011fcbfc3be775269ee0b74fff88de597bdf6f1c47293f0e1ce12a8f4a57c2937744b2b5246e839d325db8b69a7391d1bea1e8f2f5686130ffd68e619dc61f1e9ee0dbf4d093f1f73a9647561f930204eb2d0358c5a20d6483b2260c30f5b1f3eb8ed0263865ac5f7fd26540ef468dc3902b4d493bb533a5732f27162243a97d0cc38fb087b7e109ad822a611de9645fa43cfb561674a940f18ef57beb325ba55ddc3f2c69bf8de331968c0d1506da95ea1ef79a98fa4a3e571509d36cdf26620f7fc756e193e6349f8139e8536838b46e7f32c0eb423b8c513c88346dee1ab88f33351503bd3569c3bdcc2751e68da9a2e469ec00488f07fb11ec4f40aeb5f2029cc483e60495b4610058e23987816011a9290a866f6157ebc1421ca052b22d5dc62454bd8ab1fb1e8dd9bf86a9aee62befcbc6f09c3d05254f64f172a134a4a8bf76d55f87fd6c812292a5cdb9cda7783d10ad35aa021054abb0f1bc2c634e6650b9a770cd335acc1de0d1135999de88d7497ca55ced958fea738e55561edd584ce5cc0327bb826e85ebab9600f4f1ef8e6806e547c224b6cc44645be5ccd23694474bd74d0c8e6ba32edcf23ca95149fc6c724e4ce92d016be8dbaaee85b8140f83e0f80f340270f10c5a3f4b061a788ec8918990a02f8c60cd6ffef9fd6830c9741827f731af58333b0374b1c0421304d11a6aa4ec741e5798487f4ca81c00eedece08d256fdeebe49902bd30cf0f3b802b282bd18b6c9244bb87805970ca3ac27b4ef9bf9d133206e78609555a69b4639f759ba5fe649588fe053423f2ef07563e9710ff5b411c1056694d9210c07e72a5dba54897c4da44e4a18b8ae01ed27f0eae8f86a90f720f50147e1d9e38e37f0284376aeb3282b0de750440669c0b431a10353b1463f2a5d819ceebb73ce1b67a7c570390402fd0f510951414766670d339fc2c409c3d0bd5c5af5f7180e58d3113b794a192df8a1f0ef4b7097b14e587ef1c2ea81b5abf87df65f17f33bc2f4d5f919cd1c94f607b422ebed605be68d6b6cfee193bcc491af2421561702156bacf434965daf8a784abf6af02f786453e2c94d7e7cd1edc6dc794963cf1fbc67840e893d0c13df78e5def17028e198829484f24287e341754e15b096f63fd885c0e2e8c8734176cb4de8b37038b885410b6abea0c9696c02b4383067626f928a0f4eb1f0dc8faf99db04f78e5b0961cec8a4defd9ebd198a30568cffe66033ae13fca6045b78d963bdde82d93650e39bfaa9fd5fbe8282f10e723b3b80654c1907fdcaa46aacb418a7bd8c1ac5b27383f46bac01a9fb548c5ab6c0612e2407ffcdd120cac273fb9d218d45c334da765a05727400ae97abed57589f02e42d3c28b9ab302a49b3910b50ffaae8091b96f625279701ae7fd593d8a99be81ad05cfd88f4feb54f1c903a5db68768022756fdec542f6119337254b8039973a289154cd400d456e2ac8168933e11df5a15cc86040431e1e6eb57bd8561d6ad92ab11ac66bd5a98b4dc4df0e4ce1b56ac37e809f472b64a4d546c0febb0ea13bd474b61c6141dd51fbafdc21c91b630bd04e8ace5b2b4c35b06c56107563ce56afa1c385de93ec5b81b5217fdf239c3a7af748c323b522e9044ecf184ff4575df88d17c73e6c4f36c6ea54fb4d74caf5a52c3ed907c0d778ddf49d1ec10bc70fa38c6b4bb770d1c37f7023c552770a050dbf99e6d40b3d386efc0efdb5d6b76be8fd01742bfd5ee91dbed11cabbb712fcd75e5914adb4c15ae24d9d5b348c305b7239e032c3d94330beb6919c0eafdb8a6bffad9fcc5ced744b0d27f47b9854940fea2bd7f5f8f552f52afbb04a33b3b112163b1ed7d0c7e40d638e08d759fd66e6aa0d33b9df0034fa48a8825208d929ea0ec83b14574e3bee5856d2c1d71157ffaf477ee4946df2640bc2f2bebd48aded734edb0b46317e24281e877468f16b503802c535150098ab5ecc9cd8597ae4c523af737fe6cfa86cc1febd76047d03cf23e411eb735b9891fed2386e5216ed95045c088e4b4ee5287f6fd51b400f885cd6c84fa72133ce480e07efcb9accb3e9e3eb84ac0a33f8281d323aba51d9ee6329ee62765e994de5da4e3af5faea9a2d0fd5294381d41a06f7bc1b8574e992ffa1ff2c5c7bdcaa5b364da99d2295c667d9b1fa7bf19b7e13f974ef15acc66409817409e1442d1f9c8ef29aeda60a0b5c3a19284d1f35d594ae724790ff7e56d69d42f57c0e22c772014e292a2f03a5b2229d8499dabec1986ae9c82d07f8eb6a3ba314c1aa8d2f42340715cb57619416e61770611aeba8e0aeef226bc3cd8f53921eb0262a4fcfd6d6a5281a9bfacce48a4fc65b5eea78c4ef30e473ab8be9ac4a169c2860fa28ba7ecf1869ee1d900cf40b049e9f885030b250a0fea364547ee8ecbcddf255c75858f9625b64af8ac3078a71c2ae1467f3fa229b94fb807bbdf2a750fc4f667c65798c580f607996d6925b707d06a0d769203ac936afffae2e7287e0917da83385f5280ab8eb10fb60ce20e53074eb1b54f28cca8f9e939f6409065deb6c270a6cdb718279dee8d2ab3d89ba16a2375cbeaeaa911f9369e96b926a7efab0f378e89f5745311172ab36af576c0d8e2b4bc34f81c465e3a6cd7afbacbf3467609bd5fee91255f0d4bf0847877c8f33c64b127db86c048cda80dfd8080f4e8c88dd13766d40a98f375336458ab0c30a7805db457295dcba4f3a22cbe79a324fb2c53bc39f27a2ee8527e42355f6118f7b6d45ce1ae21cb70f5dd87a2f0631b742832502b644bf27cbeea8b75b74e15a3abc1491279","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"a04e2aebb4f065114c065b7fbf49759e"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
