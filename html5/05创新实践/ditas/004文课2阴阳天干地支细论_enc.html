<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"b4f6462007ee083e6e2f675d44c8e2a56f7fd7b4c04f71dad6106ca53ebe41c167d4f3fb935ed3a42dec64f8c0ccca1e548d43cf6cd2899a2f0ff1311c2518418a3e0c445620b711d8ad6bcd91d68021356eb8273093a709410227d4fcc9d4ab79654acc29ce66fd216d63d478ff77f058553a5f40f4e189159566b2f75482fccacb0c162133944e652e4f95addfb1db2d68dbf5f58d08d3703d83e41182dc122bbb56d13a264a82bb55981d274812d2959e15acd35e7a5ed2a5b4b1c37d1a247522d49c72c4ce9230bc06825284d5e0db8baa6337254b47fe9f565017a9fc6295dc1cef687bb51b62d2211e5178799ef69670f386a7be9c21f2ffa9f69457fdad3bad2f1c48eb1f3990b9a97f0303f4c2981fcee76f6ede1730180dced8e6978203bb8009d4d98f8951eba051de3e5fbbcac915069cb9705a7d7cfd43b9149bfa63bda15c5c00b08c57e9541633047b935bb625ac595a6bf45dc88830d9c2adf51deec7c8dd81eddd83a34ce333527e23f810a7f9ea090c07c7d904bec4f022941c68d6b466107f6a168a608624a6bf9629b68266298dd4ab678af0f61aec4d3294e410e4b5f312df334d038dbfaba705db454e423bfc031f5b94214276dbb1f3b1f2f23644b48440c1ae1bba95b1a2ed66e8589ffa1b1037ef1d9238eda3da5ee49303ed3cf6d436fd2f5253b4edc46f82529522a7de598312220feac59e374931de9b8764262762f4cf3f0fb5a846a094533798de4321c3dd3e6ffa11b423ad37f36e9edf89d2f56a57760083717db55ac0fec30d555cf2b35a3a7cd1ff868b508bd5c730fd0460e4ace9bd3426a710775408edabe33a130bfae96ff7446c1a9d7e4bb3290abb257d5c7ecbbb4d715d5c52ae542c1600a72f162eb4075f79a6da1307c661c20ed800d12dab51287a79043b3626824a54b29b6ee01f36e1623bb22fd69fb9a1aa305468489e31d2b5ef7c0888113d59eacb8f2a817dcb509f997c181983a61668ba40faf43ab840d60697cb0e8dd5d93c4f52ea5ece4a5194da9326c4d59ed1d9b16031e00307f18c3e501cae07cfa711586afc803c95bee5ce90205fe9c7564c9bf7bb558c9bb080494050c98a1c37c3fdc13e891d5e063937b2d89f3787f79388179fece68971061f58aeea748b816041af3733e9c7f2b1d4b04a900136e8b038d1c2038179669243a1b5b645e92dfc7654076d32154cfc2fcc91fd906abbcc8782230f097815359945566cc9cff0f0ff0af0096f66ce104ad47e1f3415ebb1cb114364a3d6593935883808f80d299faf8575c87eb4bd4f14af483cbe256790584c85541d8104b1fe557314e499aa36187ef3ae6125669701d85ae5297b4c548f8ea77d414db16e3e1a59afeae1d2f29181c13b1799c0f7edf80a5e8b71f797cd008c88cf6a44a7e61479f2df368a25f2ac6817a30900f1a84ed34ebf1e2ea623cd4fe8defcd00dc74aff9b9d81b8a302c2993941dab00493f3d62979583a25ebe05046b92b2b65d0bf10fd3cbedd960b62633dab76f1740eb20e748d55c1563d84243915eb9f4cac461bd77464134219e7845e5de32217ae640015c9a6c901b7dcade6f385582ad8ad4a697b10f00c0e078d6d239386ddf0817f8ffea4af8a1edd51a8321f6dd31680cd919a85630f366b8995e9b0dbdd5d45d5c960f50332975bb641ae56f0847ad42efe808bda3c93389e6e0c6f50674eb29dde086e539c4173dcb46c3674c39b7cd95ee2492f1e8f567a5df24e7fe1e90e2cfa45c2cc07577f095385e930896035a12c7e05941510309b920fcc1cf4a94fba9982dbf732b1b81a236b49784c7f88429058e31a0df5ef2438fa86f53d75b9bf35f6f97a462ed9926ed602de1e0173130bbf9ba9fe75a91b8b6c10e0a85c467e53d34e0d5cfb9601a35003648d0612d8f94f83f27c75b3af695466820bfa5a00d5c77539a9488223fde22f8bd2bf49b450cb3db820a86930a275fd825b150b2b3e75b1f3e50e6a2211b51f8e5c46ef06c670fdbda3ea77283c63f5d41071182dfd20fca8c54fdfc9c09e34f1ca6284ac2ff3c6588f67870a4db26c60e2e76f831cbb38d09a89e631e00dd90ce10c0936c2c04e12e2597e54f42f17659e72a7a0901b05516f4b6c7acb583f3fa7a5520026eaadff815ea24243e134b1f95de10db5e84699da205c935f1ab27f4ec34e04486db58de8c5caec5c3c29cbbc44ec687acdf794e85d6a8682a02dad9d54bb6c4d75ebc03e50c4a2d9600006c48a36e0773842f87ff3264722be09ec9aec86abe159ada33cc67d0bd1a2385e209ec74eb6178a225913448f3cc869aa07da6cc099930f2698ad8cd670947936ba7dc4603b1bed2ff3c55bd056c9fa7383de328a4f7d0bc390c140d16664eecb5bbade8111a62c536a19f07febacd7e1b854192e56b1a6515c91cf83fa1955cc23912cbfba782a1227edb948480999006dc62f0adf7aa5e16aba76a4222cb6dff4cae336f6fda58b693273d47e001e4ec5e3fb49137374533c4f2df13bb738f21e1843504d7ee10367a209ba211440970049bcbbaecd83f3c3a8da35001dafe1384c531621b0dc90493cefd70b98e3dd605c19488ff4c2d6410ffe03c0f8f3d709bca0e0abcfed0bdcda1e03b53bd0dcc0f3480b931c402566a31d402d49f03d072e243f038dfcd6c1dd80be05755460db2a724b89982ff88d24733b8ed98a309035a3d344a11006dcc0b3ff988d4de36bf7b278a3a753a4858b9f82d159590e30d3dfda255766ca4b1e221d3a88f9bd0d6688030a184ffd7ed3a1b94948144efbf28a11a4ca2cfafb2080d8c98b77c97fc4aa24429632f69233644ad784fd90762f8cec1b02208eaf0193b8548727fe70759c2580fbf4d300d899694842fe6180b6a634f5c98542c0288b2bfd970841fe780d65b77d2677dfd5fb37c61854712264f44d01b8a4b188be4ed29b56fb8861a5f262d82d4d763efb33896739eea247c436d943744e12162f5548caa7978785fdbc4540ffced7ebdeb8f459284f235f409d6e46bfad9c0395abe697cc580b6a0d738eaf5302c97166c2e9e6e500b0b5bc3e7505d709b8ca1fdda26c125cd7beac352331753800d476d7e18a00b190f654d816a5dd1ad89085fa86897c52c52dd1940467a47dc80add101ec9ee71126d7af97afd99fa2906de55f7b360ec7f70e0cc1b89fb2453e831dcfc32d049cb85a80391c125357e546ff168ba4b42bb5884e8469d1d596499f8c5277bfc00097a25eebd372bfae3e69cb8f18e524a3dd1beb3644579fc2a7b2675cb23f69b1fa3d84dd7bc100570ec79ddba5b20a8fcbc6d23ebcfd2a939531caee8245e157b6c0cf4b03797c7373d172b913674eba7e3f2b7b0ad53a151ec83555cf49b956cfc4ce922ccdffb8cc830ea779f9ffe49a243c562340df534bd8c581f45a7ab651cdc2a887a61e8a91508134603adfc580510d11f2efbbb2bf87878ab0a89ad3db3556a3a5d8aa49ef86326f3edec6b8cbd92abf6236b842a507f2753dc464853b1292b645a35a22204052d5d2c6204008fbd97d7dd5eee9fe1999e970155913ca18a0fa85736f911eb13fde220e9fb1e3e8c5cd2fa5993c3511f06f840c4342cc69969d16ca9bba1ca96872c5210369f9a82fbebcadd54afba38b664d2156b37de1e54a68a31665e1b551057ca87fc77dad2c96efb8bcf66b272cdec9305ef0506f5cac5598f0f79d7cd040b6b1314113f42e56696129a9353a0f4f2d6053a4ea782ee810fb672572587e6c0ec1fbfa5cfbfc8e86954bdd7a5d8915293eb0e4fd007e40dd8ad866acdbd907bbf1de55604c4ece74f0e5ecf17236cd01b89aa046f836aa7f4ff113e15d2903fc1a968ef796f24c31a8d17d24f00d7178115f5487a3b421bcc6d211e3585d6e11c8c8ba9f8814366ba9a72e71a780fe563235bf8735f96713b998d9e4c8b0186ab6bd7141c9c7ef8c3f3ac90b75ea24de0625a94ace35b694a784d1812624cbe7fd159ffb4ed44ef7037c2e9f7d48cb5dafb3ad2e1987205f9b2d91aece32742a41dd4522388146b1e4da9692b09029ccc82f73c9bb2e495aede34728486ad16181e5eaf546792caee1ef47c137f7e47ca1f3c13069423a83f9979c7c306f9165ec4cadb62e49c67586c8ac08718cc59c3f36e7d5e8e78fc59b3cefabfafe386242f63281b6c110398c3cd4d5b7ab1ea51c4142fdce64797292ba9170e19ccc7eab7e64b8cfac4dade9ea0f48ddbbb4e92d49098bf5fa0c384ba89a19f2e0c890ce1ad3b810b9c6453410dfc7c71329bb2bf0db83a54617e8177047bbdf3c5f4f998c2b34695b646ba894d0074d65751c37af971af2c3c00af848daa0b5946b40a47a4f581daa71936836da679efeadab27cfcaa035ad82cecc3e78e3da888dcb0cb85723b38a5bc4137a86bfbf4076cafcdcac7f6440294702be77c94d029e9ae29b46e4755fa3b7a0f1ee2b5c014e7aca8136193b35bac56828e78c1ab1bf3610eb5c53811de1551d1b95fd3ec64815d61481c78784cc25bee14c24e7ec932a12c93a5039351c7f48ea277695932c38bc887e689417a5b2da828136ca32facd255b9dcd06abcf08733b340829d49b673adff8ef4928c833af4bbaf9f47ab1f1a18172591ff5ff8e2af26767d84fd275f5ba4145540bb3aa2024779782f649554c7f5af845612976e32c80e64229ec6494858f875c33cd71ef08420eceede7ac5d144f47e1c8cb0df358249cd31e147d76167654b0b65bcdf739a101c52a36ea953380d9b8c08ad6e8d7887526566ad34b965ce5c3aafa2de9c6a5734e2a67cf8f146911b4907e59ae9aa433c106a68dd132f005438d6492aae357129dde43e96fe286380fdf4e98871bb7a85942d36a845eec5f7ebe86432b21afe8d131471aedf8806d69fc3750db3c220828349d4832bba8027e07a8182b4a0447b9b228bc9dbd3319a67003fd8621ad91e33a2d6fe41c3e14bdc3db679939ed2aaad4133772ff9dada40c0284849861cb0e2d56906ccc374078a1d2143a519bcb7213e43e170b84986948ef11da5b6d95772c84bc90db7618d00a23a719fa787e416aea8bbd177b804017380be69804ea8cfb26298c67eb85c04777122c909a2f79f43cd602ae360a754c395f0625115a7eda33f9878e9e7da2603ccc1da00a50ebc419e523aa02157472094195734a9933d187b19664709c25b04ddb6f88c0e9728775338eb0252a543f0e19337d6bf3c2a450486c346e811cfbe195b2ebf5eba8b323a77991ed406cd379fe66f7d73ff94c8585ae243fbdb2df6b68bfb1d1c3c9872cc605e4a7f0da3b8e174be08881c6992e53dbc70e771b55314e92a6833d30077de463aea9c7bc6d2ec8ce151894a0f6520e53334a83ae2ac4ee2ae24fbe4928e7794d40ae576f69fd548a7df2380ecaa676cba2aa56be8fae70ea79df05d450f6752e2bfa66c27f5d16d0a64a05bafe6accc985c32948ae40abed9e7d47ae0a2bfb7c58a3e5d239ac4d4965587d792a7d3050a8df1a79f54be381fec6cf533644f836c54c99eaf41d371e810cae0109caebd0d88b1beefb85ffaf930f5260947de86191056516ff2dd79e0231b7adbe34aee3456dfd33a57a5fb022eb00a84763c480bed101b9f98cd4e5244a4cd32b382579283da78fed9f9cce5625ef9af64a3c02264f9c7e2598143c3a7d54c4885dd9f6f44a97267a7503ba66932d94d781cd6c913c130f7c08fa57a3f007300d8369480130208b5d1f2398abd13d628a7bf47d86669de12fb2c157c277fe773d75bf19ed719fe972252b84e5368222af0f46978b3cca75ee91a1d0158633bf4005ea9223c54240c783f7bf59e82760b9cba0fc4134b5c0f57dfa1949d42c96fa807cf7bbf6532083232ad2a23a716ae1e4ce640c88a05462294bc6a3b6ad1b35ba3032c9477990ecaf90811009afe93778db876caa1b442b1ed09bf875866750a2251931f3f8288e05d21e5f7c7fccc73e1fa51a3e7e6efceee6f3e7e5dfe59446a0f5d5622ae5bbbdc34521d8b99bd65e95cd6aba3e0e2c1bc890bd8c8bca1c68d291eb3564494e8b9ec4ff9968f90cc4668f903965dd01bdd0fbdff6d3ba00f4796f507407429b76fe1fdfb0fb59d939e30ffd4bfbb2a5209fa9229595c58d26c19523d18e25bb20f2698fbb70266ab45b64975387bc0554ece94b8dd483c8d12027a8fbf34fc72881149c08304d3a9f42c733f84bd2bbb0c07a55ef827cb6c9ea7f85ffecdf154568a82002aafb2f326c9eb5abe9ca4ccf9b34330ca6a3e532cb635894631c84b21ffc4919ff8dd78b939ec7d46e9ae7f0f9498f851ca772e2574731ecef901332dd48a4a2a2f8513b0d5c47da8616635550f0f37d26f139f3b659cbccf190b4f3a98dc709f6600941e60b9704b742cd2d3e886c3f2e2a49ce38b671682d993e27892a31ea1c7e410a607364ce16d58ddd2f1167babb396608bb53fe00774cb3f3a6d902a70380cbaee8a1d0d3c5451bcd4f0c7a8c98e845ee9bd6bc685ab1105b97bb983538f09709579242ff6829776e9392fca02eb587010fb586c5f82fa1800ce5b6cf582f33afc1cf937239dbc1db4d1d36a5228bf0aab1bfe3e13354d321dfb7becf68c910d55035ca5ac4daf8f844edbc4c3f7202a2b19ffeb5660bcbdc622c267837b80a0116dae5191031045adf584dcb86b6256942bb6c685b9a67111eb5ca18977baf39793ff22c1dc881e05b2cc9b7712987a05a4564db7793ed924c5a3f99a385731643e3d7048928bb21af7b36c771263dba0a058b44e30e096f0ddd4662dc526715509a669a8e473ac6319103e0d8860b54417230465c353376b6292d35eab56047dc3c28038354b8c9063a9fa3b9102fb84d11d70ee97c01882f6f2a01c4e5e9e9dcdcd5906ac9ad417c08bbc3d170457691a4f9f19575d12383a8023604fafaf20df3df842a4c7815085dce33d0c5b72113471e783344dd73e84625663ddd8c8e9689b7b899e2fd460941e6d98d08b841f175f5d80be67bfe7aa059ed078c8daf563b0fc6057f5ba21bbec1e91ce2bbbc03739843c46faba4637ccd860f79c7092559c66ab8e1142febd4ace96c351f8ce14dc4dc95d3d40ef0f361eb15bc324781c3456b1dd89315ed9a414ee6523b34b152efc355db5df972b90961c8eca299db070e4058def7749a551135145acf7ca16b0108f1da1aa732189ddb68008c95eec7303e4d2dc3fca7f066370ee096fcdf7adc724a5adb24b6fde5eec1b873982888b8c58a9ed71cf7f253681dcc62c706a018db24ea9f17b9ea736346763131e8e6f3adf575d7c9772f31e69972d0eb2a68a35151b3549282d8e99b9fae5e072ee62763bf2610c5b140ae7712b86bc4c63041f8b101798c16b27a60edcb51ed9e6afb68f55e19cafbf317271e877bbc0266273b5587a1c7f5f4dc00168032b95dcd0db87f33ece81ae97d3b6802a5e2095412f3b8f4f374e397051a1458e0883567ba06daad63c6f136b6ec26aa97f73a45a2f1a16b54a36a91a902ef9a7f4a1d34247df66a6d042dd06104712eb24147946f7e16d45f2e33f0e00dab4fd3f4e1fec17d7cad874cbad633bf5aa17bbd322df4dcf2b10ce43373880c2411a24047261e95c4574ab0c7e6a7d55754ae5ff7b0e57373d10084a8e1c8792c291afce14178feaacb8d3e9d133f12f02d551fe107475a7233e5941263267b0ab240aee28b5a1498d4e1b2d7729a6e863999c5ec0578cbcffb359805bd113223d0d3ad4c8ea64ddec95b53ce0608f04c1d52717aee35cbd5b40e0ac5329596b39eeeb30e92266497e774d141d26c651f31a66466c726dca83eb9c3b7f79c9f7132baff0999aa5c84ae4d520218c7779926d785fb2b9d5692584c2232dc1074938ae32726a6fbb4e420739ac34323fa5a79813c996f1935a1ba49a0039e1cc7bf6406e21414d8cf0990bd0bb8c1358594975f71e99f28a72585f6b9878ab519b685939e102e15beba34ae05e46da2f670691672f92a4fd70c770560cf7b0cdf8183a78d869a0edf66f013404ed36126bc4e95521ce1c8a3b71ade79d3f42eb90a2d7caae0624254487a9282c03be381b7586735e6233a7545a0e200a5b08e58fb743848eb3a82ccb372468c76379f468e44fa97f80b623671490c7700043844a35dabd774bf27755defd18a8d29677720fc7e3784281dba8d4c51b3d5d8baacb198d70114cbe5840a3cc9f7a2cc4f7193d54f1f311adac4db0654d28b20e336b54f0be79becfb3f7d4408ee862e36d1cd61d7471032723c3d7289978f1ded84025d7248fb0a72db6fa2e9826a410e415ee99bc485ab414a50dadfcfe7d1b2b0eddec675d19044003765614bf1d7590afb562cd0667ac9054a6550d044415e0f22359d525c57d7de0007d14f788fffd80e320349a94e744dc4cee1ada6ffb43a70d720cf7239f007531a103781c52346f9c193288934dcf107c2b117277cd58065623a91142f466608a225d54b8e74d42679063c0c8459426bdf56d7606c02456b3885aa0a3c14739a039faaa47e3c94df4ed90d44fc56e6cf80420a4423e3f33dfa0d341a8b4a1d54e4497792ededd6ded1d207c0b4fe6d98fab0b3bba366070df679fd5444f9b8b36a275feeb9d01e5e24dac98a5cfed59a366a10a9db5f98a27f9f0a3a4d2dbc99453a4be8729a9bf1d0cc8429ec57ab74a39d3d7eb56c43706e2b9e0c4d292072ad7892a0664f639ce6564c78ab7e9039b0bf6a4e2ec4f54ba9f1d2aafaaa7b75326b9b9ede214c0e868ccd4fb97bb5a11f42b3c8af6914df166d0e04331bd9915d5c6053acec3fd65b763b165e7960a8ccec3006d6693d7bfb0a00b9570cee95cdab41ad55c331e2a73ee1a1319f4e1b3432f153e26aba1455b5a04063e2fb724151e73512c9b38320425a290bf22c3c5aa17f006c8af5dd25acaeae125129ad2ee3e2cff8010179c422c628e9db45ddef5e65cda989f595392ceb0637e339e3faf45110e257b7bb229e6868f29788dbb2c79c0375a1ab3484c0c401ac0665e89288baddc0cf7ff4a027655aac74453ee1d10bfc7e5c41b45ec697f8a6d552d3aec4b42de90522ebf993708bac8e04cc707f3b06df07b95f9c3550f0b46e795c0d11eb2a35413b6050e57e7cfc98eb509d0d4ddca01ef29833a5812c76795334d91116a28b7b4f530381dbb8a6207cdedda09125f63dc4cd5712953ee16bbfc403a5b1722ab1226942639997e91aa5561e26307dd7cdf9b0428f3ddd71bb1604308c1b124a6a31e5561c4f3681a4c571c5e1d2d4e5958664c576b46013c1662729726388af9c278594b317141109d95e3daf48d74fde49f0ebe7394a85f2b3f285e3dc25c3bff4a2da65404574de5b0836fd7c31c7ace941edae69ff7947e29506393be0d83a7769ed8e3521084a47288a6ba77798d078d83e40932bf1d129bc0725deb55faadae6b2394c36e9d59dbe6a99aa5104c7c2e948c05d972c0a734ea4d5233ea12ea2caf233286ac2d19daffe8719f2d18ae80bd9f333e650fe67e33f7d8e96bf90fd8badf664f693c19e7e16d218b577b9d7b95ec0e40be9d19b23f9f179f432c951599535fa05e91ff7af8498383d4f4cd52516fff5460011d0cdc74834e30f72bb68137e6ed9e86cbb295b1a26f54d5295cf62c9f475207818ea611c43518a2a8e22eee3167b50f7fec1d95bafe91187c4b1ffcee3ea73ebca88d7bf79d2ea6111a7fce53f5c3fb8c98638bafa4ccaebac8bc3addb62c296825d40b8fb110d8d2cc7f331e944136bfddae407a93fdfa01d2222d1f250af22d428e49d36534b3e809d1a769c26038494f5c56f215654c274999acdbf80da7ee50a0625d749bc5c19619ba8b5022b9479a52d5a8dc7210760ffb01a5c0ad3aec8ab1793ece358d2587cb1db71c44ebf3eab569e448503824aa653f9c535d0cf77c21a2ed786b4fa31620eb6285a51d19d29d7c636572f011a47f2422e463546998c8ec7c1912d6e66ca68899509fc8c4122e0b52afeffcc1b924299568b695e72ef96679d7eab99f1b7a62e062d4c32454c530e26144c535ea0852b980b092ec21b9215a6770328b803813c4c5b8364269ec7436fa02d34dd8f9e95eb04141dd187235c46b15cb75f4e2ae9bd1a3d35c806c2f78513ddbc5655b2795d6b98d55b95c23f64730f0692ce3148c7fad705c3f927f006c3aa9727c80be5be96b1c5db47bdf25b37abe2d896bd5ba8cdcee93d139a6087e23f8e1da17461a46890327ac3748bfba7c9cc90d56e4e6134ebf7cdcfba1fd412d5b46ed17979a7b082c4ef22e22c14b0b636902789a3bf7039fed3b2971732a4ae35fc6aae18ad304e791395eea1f8feb59578e24e79be07fc99089c03a5204933d88df3b9da2a694e146bacd389c6b0d5fa4722841088f97f7649f64ec17068d8d4b4fb38f1613b5a10421ad0409a4219e20e21957c780f3ff1521bc77a29fca7479d7c1fbd50992112f9445eaea305b54b6d68cb11b1504f73232c46d2f59387ac3642156aa8aff1af019bf05a0bfc18017909dc85795685e1a06da8753582da011b68dc62c47093c3fb78fc12232360d3f098f32b5375a49b0c1b657b751697b6ec3d91415d815a2967d3b837bd7919d16e39f34c920c6c895941973b3073fd13982b7f18a40d2fd5688e564c978ef57a3ce16b7d465ef16046711f0c77591bb2ca4ccf0fe4bb8fec22c7e0931026eb0a275b2dd1187f42589de62abeba47857cf13260a61180f54bf5956bf700943dbe55b037a5289a97032bae017ed562a99d1051f817d519eb9111103299a44b6211700b0c045b7502401ab110ffc659214e428f3fceb202d1f1bf488cf494bda400e871a22bbd3874cca06fdff9246584b0eac9a4067d448c39e9db1cdc96bd395607b005c8780191c009e99989db91363d36d229a8d0b3411f2059795e2baf7864879494509ffa04963ac5312f029a74f639b7236314257c36e97d1f81c221970b96e8ff2be84b82f7eab8557b7fbce5ac137a22282fca6e225f25b2635f70d8e93ded5cb9f72adf6f3e1c93863e744ab058fcd5f917d79c5d0c3bcff50fb764efeb0d103a60ff9c00fe0cdd7227ef7854460eb538ed41b5c09716a987eaf628ce77815b86e392dab627589dfed2f660c937537d0382ea6421032c36dcb1b0b36930d9b8cc1cab45559826c392b1268bc2f04e895e61b47cd7cf8b01f570b5f1e055102de7d96c2470a9c5154c10ff7a2b80f0c872ed8d92f944f2ccd115a017d94d3fedc299f9cf49c90d7f4819068b9977dac3f0cfc5cb52ca6b78975157ef1800eda8f12532cab50304d717010e64e90497a40544ccc622c16afb1002ba5ec07e1edcc8e6b1a1b0db610311009f1fcd83ff358c9c3ed4093613f44fa93b740dec9cbd0c2c53c501e8c1f308d4f72b420da6408871f2a01eeff1e560275275dcd12a1ddd5b7fa4cfe462db07b1f52acf33f638031e29a1848c160430faf71019442e870bd08afcfb04bf41683e3e2ebd7b6e54455f01ba219ffa7721d48971c8e71e2f34ae3863f8f556c2ae1c502d797f0c5f6407f76ce686d60dc6f58ad74b30e0217cc98bc5137b344ed170a1f0412529f8062ae5cc381a9ca6a5b3556c222ccb455882cf51eb86874d962b45711bb0ca1a3e5ea973fa9408c23eb9d9241ca49a254780db4d57bfe2e2cf8fb8eb6518f4b7b7ba30c6da227d00f874a185d8638f39650c3813c8ebff4431ae4b19d2f8d2011abb6f4e13f9d532e9b11e27da1be8cd6c2db2eb844496a4bbc8765b5120ca7d8784e51d1f656b306c1df3f5cfee0aeaa5bca34a4176d0e75bb0d9bf6d3e7ac6dcb119530456c6d0948161fc637ec75c9bc226c28ae7abef6efd86794ba025cb5e62f703570034ff7b3806a163a097c6ca214e07a034e4d27541487e70efe0bea71df7ca219de9ee3db07d4b107397ccc499b5f0598aa3a49c16b208d39323e0a18e78447a0da14f84e55da82e07b0d3ae2a5970bc00efedf7b3aef4c43f48add243de1d3ff8be8d529df7617b7a95ecf9f9e8915d1da88ccccdf5d98e37964c8b88c1a5ca207180624900e92a2ec53f0c96eb555cb8279cd27c9dfd34d16044f543f992d2c7465a5c3107e31d0de8e7851c5fdb016aa7513c0e13fd5c31c9b206b065ffecf9e9db92cb84f95c01e88749077fafc86adefa11c2644a61d046251e05b269df7092cf228c2faa79009ca522a92053c5e7ce1bf5338315e00c955347e04f5714f4560ef815580695b0ae012f1f83a231d2c180f0d8da24ecafd2d67a901b7378afa90157aeebd6619a8337b54e1723e0759b64c0e01516e4ce65e743b9baa44062cfaf32b76c6157369ffbf17dfb7b9373c66c48623d643e2faf75b222acf8ae5d99be81a6aebb0a419e2e83a29d0ab1d0715c8b636c90f67f2af4cadb694d12e7da633e0e8524d9a2fbbc0dbe780ae415e5cd38050401f93228be5b8329fada7be1541ba85ca05e9ef88eec2fc17bb22f9f8bb5d91f1b668439c4fadc326dc6f413df117a6a285a68f9e7e64b4ab0569de57de14bf1ad982dccca7d66e33274dcf566adb8c6be664e521dce1748b014d483291fadf1e5fa346b8fe6d529faec6c1f57cd4bc8b88ea5d7965d989204530ef8d6f6850e5328889c76a3ed8a37de86572fcc1ac230f4993f8605e2ab507cedfc5c3eb633043b14265069e9c613c2afc83a67cfabf2a16e753edc58faf59c8a705cd92aa56e9da60e39f9ce91cf6d0a80f13fcdfd6543d0ba72de6c3e52cdcf1a9dbf039ee041b967d452059b225578dd1a968ca53f272ce483ec54004654aa1db11c81ada86548fd046c5e4eb32928a8a83443fe783885d8a6f20d56b8466f580f3c011fa4628ccade355765383127ac1b047467b3159cba8b970e41b2c441ecf48c1c58d6a41020b36e4e4b8ba7260611ae857ae0e7d49424f81a607b536b4f511371813d071d989033af176a0ff88bf2fc69b4c63e286bb335724219b5d6867a3f7d926b83c1d1f0ad82c4e6f8637e29a607e36dde4ed7ba18c754e75c00d6d719818e1c185a8a2117498ca3773c012dfda2e226512ea18fda614d10d2629d6056e55c6ec73cdbe29b2e979f8b23f7478c5329c01d786b7b22d88b514c5ba9faa4d7e8ed9a5a692484a901d69b755d5e18f0c4b1c71d5134883a97519084016fbbfe78160999dfad5e832fa023705f6f09812a0103fe0541c59cf2ea064317016637fa87aac3f43e5628c87de614dbe37f0c3b3eb132aba19c5fdaef9571a7ea5e8f4dbcacd9d4bbd9fadb5ed40358b17d6f2cbf49e88557d3dad6910050d5459f24c332a1bb3cfed3247d0f28722bfa97fc51562044177d7347861ca7347704d5a0a1c82484d9b33a529b95128806168a291c28c58faa86c0dcd274726a9f1e5d0a4248bf6604a9a75677c0c1ec2a09d430affe87abe5b2f71c762bff06e534b6fba8e5f8faa4dea71aaff7d392a072f8906d47099db6aa6bdd793382abbb4de432f0ac08ffb1388510c299d90c413bbf857067499476920334ac9133ab0f043c1f4b5acd93922dac1dced70037dd94ecc7caa7c7d05dbaec02a282531e8dc9cad601f5490bef0018a184a9e30092ad1611d96af1e16201ac7b6b634cd5a3194738a3bf0fe10f963d8dee9935c57eb5a321f6283730871bb8cf128b5080cede4dbd6ee7c14ce936ae7c2e7b05dbbfbbd87e3174b4861c13204acb8337dc4e227cdf2803fdd9b7f4af65a63af8051bd3307c876e8d9e131e391c195fc3a1e6f9bac715cd5c89ae1a2f54eb7fb2a21a418076c5626a220a31d60c0f7cdac2644f7ef7051a94d63b552ab801b411e7ce6535a2db0aec217254ba8773ecd063cf6568c2800257793b24267bb1c84852d4411fa7772a6f03c56b1dd84a42e0a924882ec56397cc3610165699dabdedd4bd72b69809239189cac26b4c34a2327b068ec77a418be0bc0512e99ae8d906781fb2da459a52c8aa6edc9fcd82be752616447edc8d34b2d53c2d5b36e7c4ad1e7c524ab5bc1387dc5ed6b22d968118dc0efeac227622c0d22428120e24dedee36194ed835c99ba0b584707e3ef3311627fcf4f8ab240c8a3498d5cd609aa7b7b330da9534b5240f2eed8b26be4dd1689e7adb9d31b13c353d50099689b156c4c3ad1dbfa8a3b9baafe62c53086bd2b1d29b72783b11322fc717e04a43ed198ad714d5afbb5676634c402596de72df4874efe8f2b4366326b435dd352f7d3fd89686828ae77b7c5ec55347a46916364a8ec17cd3dead140e09f51d7eec99e431e6fd113e9647934483b8342da8b14f876425907d28d4e89c8f66fe087c1df4ff9f791d86b70b610985bf3cbe1a19ccfee352be72892a5280775b5a6fa0ff2faecec55fa0635404f7fbb4f34e5b89faa6a97c57d00cc45e47f4880bcc1fd535018d81c9f7e1593a201ddbc9e8b31d9cf11fe3937aac33d3f181fc90b6320dfe64b61f98bfed4f560e97d0fdf827553829739a0bbc0bf20ecb71333008ca04509a5ca9403a80feee21a87da8d97e778b09b93c1a00f3059ede2ceabc4c0919592227f1d42760565f99c852b7f656230d6ad1722a497102e280c24a72575c8c64dcb3dd9178c1a81c923aa9882f5b7f7dd028442659520c16b576949b3f627b5f6eef27c44819d45d5c8ae23ec60e0281c31d96aa42e6c297b2ab6e42d12cce9914ad44779f6348625b6c7408336c470b538bf3f32f9c2293c4bd8322aafe423944d16645df8c20e324fbaef5a2c60e789e18ba047a143568f68f3b53a3b61233a3c4b0ece70ab9e442a45d9061069f4ec1e22abe194d8e5a521b46164754a4b211e2323bc7539462a392f39707b51297c69e36826fc43a61eb18cee0c78edf6135bcee15a7cf09a86217d85ac9ad67e4e421c829b6da892e85b4e344f4d3e409b7cea2f843233351063ecda9379c0329f54942232510c346e912180570c8d054f0ae46caf2e43a31124e70f2c6c61968916305a3c4c4019c14aff75b9ad78222e7ff371667e852a8ee24e7664816458090f64b55659c320e83917ba83df70d79f5ba9b0ac1c45f4db529a09cfc31b7e7df2abc41fec72d01e869df80bd54a83400bdbb9d5a6edcaa0aea79b1aee2cb2f2fdd31c7dbc232f752a70151405ed599c79b2081512aa86adc4fcdcc1a5eaf7d56d5977ad21f01a618438b1710fe61f9453e7b4405296b3b2cd39ef0a23b9bc98f7f1aac1272781cd7159de93c3767058677333f1af302083ba0287d4a162d1e54ac7f037922091ad58d0386c7397ed8c24d8ec0d9177e54bca50bad86e741bea164ce1a45186950bf0d53b4ab2aba8a3f83cc91559360927948e7a86bf31ea5e7d695a46224b95f690e0c754b5deb7badbde431988155ef7070841fc88197a3d34e0b4f3feb7cb34adf10b6fa187578302a42a836890a94cec89cfc85b318b6bbfbd6ff1e1e0026606e835f4e0e18f87562508f3a745252191feb9f2521785cd26a07cdb6996a2018ee8ea5c2933a904ab79ec2bcdf734f5b542f0791ab98f024dba84dbeebf0d43785d1d3ef99f6c1d2521c248ed345e4e83ef0ac9ba2c0ce9fd543e3d7827eaa2960ad179ff2d08a5aff86e8e24d7417b295798af8d26adf417b2b88f77f17d03e398d7b3c74eed1310e59bc9aab9ce34508f3bb20712c0afcda0ffdcf2182105ab46b6094a1da293dfb0f2036aa0e944ba68d910d4a67b6fb2a3fc38f4042246b04adfde845bb3f732fc33e3cd4bc3501ccb2db56b12cf14e8bab1b1dfc9afa455792f879ed26a28ec93637013b4237b63c71dfde3c5282ccdc4e68307950bc368d7e8f926953dfe82b441850211423f2627538a1726bd8a52e8cafcc721647f79df6750e4ad86f575fe7e9471a3c5d37d6a8908b9bb259a339b03ce6176a4cfbfce50e0ad241be00995e43fde9c16968ce0aa4d13d1fcc2d41d227ddf5dd0f0f6c7ae9af7c32043c5c84f0311f5cc3728eab206a58601b4594ab16b7fad0ecae607eebb923fe365254f7414c965994e9f15e874631279d2b559a01369753671eb460f3ce7fb1616d0615d5ce3bef1dff8cb17cd013098df68eb60c69c8297e77ad8a461b85881b2708bcaabc920a141c0525ec3c58aa7f037fc95c303708f8096030bc8fcf3a7d2528c0583af4038038dce135ebbcd68916b1e8af32c193c509601d6172e4a8708405635f92e0528fe71b45873b3aefd3a8d9391efdd262ccd614340c23674846a431686f741ad79d6cd28f7f0f397cac3413ccde7bd9c570740d3fc8bf8a99eeabea638b2f340321a1df7b81f8887f11714bbadbd4b8e794f7e82f3985b72d1d71d807e01f74514a64024d018f6208977fdb4b9f197d245f0bff9347eef151ddd2952306812b14a38aa647e20ffce676a3c60aff29227a4d4fc01ee217df292725243446f707d6c53acf30a6701a2c8ac240fe95a5c6fa94e9d4c7c9e6fe850d617bd0c703e73a615e0478b17f16d4bb411737b6e48f1f3945bdf81e111c9111c3d6b878841dfac92023c48de45dd14e341076c1991043db13dbddbfd49e6f0c8da0c41e75127967fe85dd6e8ceb02ea2bbfbba0365b2e92ec8c7b75bade5285945d812b0f67b0e3b85bb2ef1021ff86d4dc4d8c945e57fa5c0a1efb96b2ecd36b373f4e8df28e748cd038a57e26d24ce0534bd203ec2a3cf1eda152bef24cfa9f7b8efd569ab39bdb2d163f879b4293b8f5dc801780407113763f88909f041f2fc7e659127c81cf321cf21b8063782afb914a107b16deb530df71b53deed0fd54b2c786d4e490f2307d25400e4762e6c5d56366001b6182daad49b4e6b6596b9868b76325eaec19ff1284f13672196521ec0ca44c041139c6e946bad395e9578388c75db20fde07c436e2462f5b87fcd0643c2040f31bb0b1c19268c7e5e88c8a74bf10dc08650b2cab87276f30a165b2b8563339d903ab37f08970596cee93d94cb7a020ce0806d06a6c00a70f37d7ea540c875cce9c1081e533b68e7a7af3295745ba9f161f92df16888bc43fa8cf9a74d544a700d8f67be498eadac00dd532059e622129ae8db9779e52dfa4c7b1b66f9a646b9361b5f7ad9f381f0094b650bee7e6afef5cf65ba8f56ad8fdf3865bdc5c303876c5da6d64c0ac053d9e5b2789a52149d4cf14a9f96358c4a5cf13ee42d32436ef21df78de09eeddf164b4ffa4ae9ed7467c50a38dddfd677ab9cd0c1180e6cc659e1ea73e3407d7c6b45d477661fea7a6f88c48827be7db7d2b9b0472a776ddcd531d89c1b55d33c3d6b596828ed7d49868ff132943ab9e155989aa04bd79de4acd914f38cbf6583e570d32f7851e4bbd48305366e43563bf634b933893728c09710ab08663e3eb4c2df2253e89c52591da0e1a2dff7629e16d55cf7e8bb9a2bb6785a7be9ff8f7768a0ce176cf","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"db2470865aa068691185dcd60d0115ec"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
