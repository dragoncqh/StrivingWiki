<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"f7495112e87f2c78ff073fe9b22c3a5864022c6be4533ea2adb3bcd8595606c01cfd51e3d872f90c1921407802d1cae3e82dc1002b17d5831b825a0049c3b4e850be6f65ac7979ca6e5558202c881d21851e1be7020759b590d3969194c84c0b361883ba602b1ed2f06640e54aea01a387ea0ef3c610c2e54a667138c9678aec4bb98e10c3941fb78f45a60827a9387b9fc64f57f11c656cdc5be343d5873d3e614db28cf25dd66e3150eaa12dde77cf41ec9f28d3d017cd77a63480211fa939e87d0ad9b45c6f8d14b2f7b1c75f3eb2a2346219d0c0c667838e110c26cf3069897276b904255ecba7b5b6e3acc18018f07649368b40b5dbf878aee133d6ee3556f74eb2bd0d72aca9ca0f4b2bed9be45eefafc464e6652cfff5303baecd16db47c8f495d98cfc052c6149a0c483d1cd0a2e97f385454119ad77805674d9f13960ff338dae68926e7b5dcbfd70b6f8210d091e5b8021065df7dd055a0e1097a62fcb35e8614b983e04dcee1ded74d167db736518744ef6340ac9899e78c9352af6f8fb155dc9b4605d0cf52e88669105e9eb42a7d38b2a8dc3c26c6f3a54a0c89f315f7fabd3f37c85be7d2c0a7a936833d8b9d7b731a6612dbcfa4704e7e4ffc9d40f5e9f2cdf0584809e8e06e6e1c7853b371905dd4f09f5e4398dc5b04962a2f5b6fd96b8f7ca9df6b3d947eee938db2f31afd6c2a03a8895087449f2760117bb80c3c79695563ac8bdca969d26803545def0d64fb88e0e8cd3d90fde469415845d30d67d55d40748f8ec9b64dee709fc67690491bf02161ff7c0ca800f14bb6e9f85c98dc4875a1adf02a93c972948243fced064057dc977612f3f0940e65892ecb2f3994ebeac77c5d5e13dd260a9e04e43b5e98bbd791e7008e9f0d96f9522bc05982dc9411aad54ab4d090be2d63f214a58ccd8a10e0becfcc71dd8db9c6e4a621640577aa5431f0a748643098ed47fbf4261153441c324d0bd58a891c5aa9ec47bcb68dbe6db211c961a844ffc519bda82d7640344e2efef966b43ab2b865943b786d2a5ae79a52cdb11db14d0067befc2f7dd0f3d7f2a216c63d64071b6be83fafc723e58ebf3f07e904969464a42cf2115cf653a92eb3b8e7bd62cbdef0a8f3306ea99c336358de0474d4faca5fd85e5a5c5461d7b01869a06acf0b88594b24e65429f3f1d7fd2c28210d01481e0be91ed4bd55e9c56c894560c46802662fc36982e7e2319c5dcc1ecf9125d2a7f819cf68ecad955e505e29a9c159f892523728790be39d5d75b296606ae13a4ea1bd5ed957af2b9cc9cbc98cf482f99257dd84c4c738132d5e5f20ef94708c291298e35c123d1595390c6852bcd9f836ea4ef50730f146a2a12ac8149e1dd9f46a474f944fe2322a16d00bdd9a386260ab8e42c879c90a4988ba5f4c3f0d106c1fae30abba68022323eaa6bc1a5b1a6ce8eb55af966986ad5badd618baaa33f66fc3dd413daa3e34a7ff1c4a6bfcedc67c9e64c3c9b4dfafd4f34a5b857c40ae4df5ea30fde4984c3d4ecc0d9090286e87e76f672acf8f6504de667f1256f598697bcf82430a7bc330e70923ca68d7da8dbe1a45b456c242d39d2e16c5b7a8bc93cc826aa6a9ac5aea259fbc0f5476f483c49b3446957dc7aca091e205bc0b6afb2a3537bd44425db092f3dd24408f172ac1312350ecc3cb5ff1eee196038858572fcad3f542e59157e4f41fc55442f71b211f3a545162001c129422f86a3f96a59bfb2e3d2c6d1514b8f1253430edcf5887433ce9ab954798d22f7c67eea1a2da840d41e3a1bfa9e7b1fea549e0e80ee2bc56c5f2070e60368f6a01d416ca118042952d288ef059db09b6068a5b3544d7cfbcd51e4f70b36b6fea49635a130a9eefe63fee07ab45a4390bf25491a789065eea8aece1d178ab1ec57bece744f8719e97cb0cbe50abba0877b81e6ed06f22073f21ea9373a3fe1470a36a268b78bc4587cdc71b84d38107c06f8f280a5e5c75c80c84b455507b18c170f3bf6e7e6746dfbe85448db613bb28c4bb8877db5092f49134593fc2758161badf3e773ae071c73deb6983a950e93d25916f0a36fa2df7249b9cc912e75d08060247b004a43e6ac990b04ae8203a0e0f5a0bc65d24c92504c65a61cdd5b91787b15cff7b6b6371c1ce315ba463de79643613b4259d880df8232553a01c7320aaa5c9bfe3eb0efbc3b42e16748b0497cd65076e4cdbb98c484318f82e105bbae7edd674b507dad1598a8b6e9fa931eda46b6ccda3655d83eefb0e0029b27d2e85f5a0da9e5d9d566a3a69bf1a2b140b0a0516d742dffe9c7a790d6ebc8fa86036ab38dcebbd1b5f26bf68871385ffb01b47e2ea1b2d216ce561b4b94c383ac34d76c1ce02056f8ac46c479623c56282f1aa8471900d7d60dc8e2115ea860d901130747d8ea6ef2ca7e35e9f67f5ee8f722b02b51c8b24e21cc16a8744a591218cdfaefa5413554149a366d07d9468d5f4f9e86dac98fda30439581cac20db76d5ac56f6c2696b82eee3f341e8059909a36e65d77c7ca9b847bbeef2fa5f6931df01aa01eff2f72de6bfbde52318221c1c45a630c6495d19a1d2ddf0522d815f950755ce78fc21a67f9ca4177168551f7207aa5291fc71d1738266ded6d8b8aa12dc9ef710fbe2fb31c973a407fa2b7d9919c5d0ebbc55f0488bcd68ce786bfd881b1c34bd43365cbf7d54b58889cf898ca1fb71f86ffaa46bc8fb684f692ab3d3172c75a183240eb253fe9abd46d33de1bc77dd4c51085aebee736313dfd71c562ad1002d93905ffaf296f25d819bc79a93d55af292f12c902846b332daa608180215f2a701cafdb2760ac05c5f783061734bda00a4b47c3586ecb5c5ccc7cf989ac2570d407bb2e8d36f1bb6fcb7afbd873fdf6f4724c966e7b8afb3cc13f68527573ac1c3532458d0c546c2ed6708c63745e124593a964fdd7f49d11b5df54ede9467fd50a1e44bad75aff865a5623d57a6dd56284ba1f55bc80dacce2c1fc5087fc99008f8bc8f2a890c48d9420f57101504428de7356be683f78e0e9d4f0d427d6060b844a95e79b8166417da3958172e82ff8faaaf634c8888ccf76e833f9a9cb46567d7d48122cb6dcd4d2f4c78002274a0db8011f9d097b0fe0909d764cfa3a112608c0a9a9da145d2c712c4c0152689dd4be40799c76f91bac8f6d8c7f61fd5fd2fd26c159031681fb1e2b50f034e62ef68cdfdde78a25818c08f35b3bc3edee4ccdd126d344dd2ac57b224c18482b89c3ab9892372670b62d49dd41a33fee44ff84a2c508ba36ff9f43951690398c343c7455c3658ae3d3b7a7a54f4cab29bb9baa22f58e1545c3ebf93fd19bc93ca59a4fdc680eb2cfe8ff9acdb5f26ae39328aaf965aeb41d073c96dc5431907e801ffc3bcc80505c1d2d9b160647eaa4a66f7fab8d16d315beb20cb2d2e0f0544f19ed79869563780bc378663a1a033b909ab68e64a59899cf7f2524da175930a26b6b872f5e5987db0694beb9e4a7d1eb23ab68915fb0e0048cb695c948d7cf20e91d9b9871382863fe3d1bb385f971591ed32c388f1eae617cbe159125d51573ab2fbe378e242f5638a62c8d01a78401375d310350217e8cc95d360ff3385ac0d4f16199985aa10a446a8717de62b66900a40d0b74f737c688dda2d2016107bcab099260990724338abb71d79a5f4a098a619dc80a3ae095604ecd72bedd1f1b792729cd8f4e3a8e8e714719a925bd1d39b61d6ab7635803fd4bee7ee69dbfe4d18f7035583405f4a5fc2893ce6f6a2b7e21a7878021f83ec4d090de2f10948ffbdcbb42422bf2d16d0f0dd43520a786d2bca0f2c3adee0fe54e43e13e2e4b49cee235e1ea1fb4042a9d1f433c41d210a1e36360b4bdb3df95f904e093c456a1653cf1047d4237c67132bba1408461f630c46fd209af8f72720b55d03c3b662dd5f5ec34ab7dee0df3cdb6be4400abf4f5b09bdfd91dc4f2204d347f63437188ec7f811dc6fc0746ebc5ff2d1440c649386c345c6a5222cd9f969fa02bef556a75b2fbc5301dba1b8b7e90998f96bf62fc3bc881e514cacba7fbbe24cec6e04ad9782009f7eba2815859b8bc6e425d1abeafdfd095d780bd843cdeee37faf5324667cac3da9d21271a42fb4733c61553d62981c4687a4810706c6e04583a5d8eddcc7a0de1c9724d742932e2f8815aae036f05a59310d83b27a22d6e1db4450893df0aed59cdaddffb180a3e06badb9a6484dcc5325d9a6b2fc007be335ed961e8c1c2c6577e187357f62502017cc368aed67678404eda5bc3d166793415423f2917c8005dbf5443655468beb4b105f2696d5fc6cc0b36dcf8635cba21fc4e4d19ee47516c23bc7615bf7cce6b0e58af1ca4ecb7c7d4f3a02046ae756e5766162c7670a8df882ee9367c06b6507a2c9364024ea320eabef1cbe029f6fc237a8a89063b2b4a0030e1264aba3f75f88eb9951055be6f81f1e99f34ffe3d83f70e7eef64748dfb3833836cb193a7a69d0419e83ae19c26cb8fa8ac4431ce77383a6dcfc92b8a4db4e2316812192e1b81094d3eb7e73faeb0a345541b4122b24efcb21796ce444273691d51b9056a0268c58830da58e1b95c563cb92515fbb9c54c494a6bdff7f7da9bf4bb47ec9fb3ac6b957bf6a3c05081ddbb4489e834b845d8cd6a4c8c0eaa0f84395c998e2c6706fa25c74d7ec41f3b641bf9bf94fcd5114654591618a9812e9bed00d845af191d7aca678267ad3770caf65122a2b93d87d46d21b27be7d14b60aa93c92a57de921af600703d57fef3fb95537aa644d7ee4b3e8439907195d1078fbb4f1a083fc40f884a7d9d82facec2993eb57d0fc97dbd4acca1d14c6b48473ee11831d2e2c4532cc5a85faf11697c250e45f8697f046cf2af8ebe4e33e217b0bd125e3ca178b3ea68695a06a21b04b13f63952f54bcd214f1c594c23b0d7ad4ef97846e25bf6df27e2d2d03dafdc8da64250e1c96486e7fc48a6c94322b3ce41beaabca5843aa301552526b2b0bf9e14e9bce6f51c13fd4122cfaa0e4be1f082447714a3db4323dd283f68a6afca1ed841d2bcd3b91298744da0114bba6bab99753e7db2123760b6fd7268d6bc4bf2e94037b307daf227a597e5416cf0e49ef73634b4328354872a88e28f69d3b416b8ead3173e965adfefd1c237548ad7dafb98675b811b96916b08239e59ed0db9e08a7236d60e9de5536ced343a2280f7cf5e9d7dc099da58ffb4ffa34948ba63e22ad89c0e34bb776103158aa7cd9d0f7e309ca55172cf225258d9f91df040950ea19b686f9ac96e27bbc2c4f128da65870bd4b885887fba71073e9f3b4b63757ec9e87ac7cba6afbdd7c2280bc32165e8e66a25f78c44c134650ecd301938e9199e2f970d772474af12f0e5f1f163b49ca2813c388800363b937b83ed088adf1fdcb9f480a92e6d1e7cce9c614027c84e9b01feaf2e313686511a4972556ad637f95a405b3372d547b84f9ed79f9a10c317466d5654e5e65a9dbd554879c52599ce89d733693368978d5daa54e5d290ca2f77069b646e7b77fecaab77bed60a70c94d312848034a7b2003db7ec3f28a2360df41d4f405f30d5fc9debb2cdc1de08299c29e61b401f99589bcf5f87360401fca439467c27091d47368ddeb1fdbbd087f3c229367d8087f70e511b147fba6eec5a336cdccef8ee9920d5d974089ae03575e36fdce3c94742cbf07117d1d1a024df96416fb7eeb9f85182beb39d046bec22034a8fdc29e380b5a859102da0f7d1a9f785591243f8fac95027ecbd22801e1cbc234e82ef68bb75b90584fd4f2b2527050ccc3c76ae2957ed7dd57f6842e0640871cd5f383732f587d20b5e3f70e7d3193a1557773320b71a41277c4f1cad3067a11d50f3672c67c81a837a622b58a55d47fc7312f156cb228b47f124f839128de0033bee354cc92d8871879454303f22724f64da503ae0315b62e7ffb73b3c272053efe77255a4dc435cd5eec018d17e7c2aee98825b72dc3c814039bdec3dab596f1c7aca71fc2d1e0f3df752eea97dfc2da9a892af72b9190590e7a587f2dacd7de503acee72d5845f1abef421c78cde5ec752e59b45c397e84cb48589b14cfb8ad734fb2b49b948db1c2a18f6e01246c4d2923eaac561bcc8806e275fc652779ec8dec10127b6dc937d77b21e71ab59944c6508af84eb8b4472fa4448d97015ee9503d41c462c11997aaf3093aa0d0b14488717c85134287fc943bae01791fd4e00fb92be8eddb75cd6eb193467325d6ec51f2f154dccf9972dfeae98d622c2a80404af62749ce4ee443a7f694f5d8869201ca48b5aa3839e1fbc045e307914353ea317c0d5d17d60f809148e0c520ebb55302aae516d505029fa10453bac3b05022ff495eaa374ac7f55cd64bb3336bf1064b9451774e734556e8f60f6e271e67274619ede10e3c8e9e543c14194f970f0bb346bb745d1c4fdae1d69e6964a6872e497469febcc699d765fee8ac7d77eb58de9eef3be2b46dc889d25a20da33325a4ef0ce738c9eccc1c674f1eab54bc8d92effb2e1477e08071eaf01618183436c5b96db13292949349cef17df3cc35dca3f07ecf952cb465bee278a963eaaa0b48396623f1d957c0e8ac3c7260faddcb011172566b6fec27210bdc0e055c982d36510211ed5f835cf36f65fbba2cd41339569746d06e34776321481e14d3168b1fc58b963aa73f70f8a26de6c5eb182d80ddc1571968314e3063d0230de895dc7177d5958d50a067e2b6909235e115ff8f44725f6ca90c5170fde742beed1bb475f053499ec1babbfd8a1e9d068615e44521a6f75771ce7532908aab271b5282e970424dc7d84b5fdbfb73e98e21fb69cad0059875b8f68e90d8d884456b4896c8e9b1b5f4485094fbf2dc02ad98b5ff511918c9479c98da23989832436e5e8740981355f8d8fc0bb4aa0ec4e2860bad2b8596b6cd870e9f4dee04751479e05ce7a13a531f4c92e0f6542c893b36b5cdeb2c1341b6a23a6d0334cb9adacd4c853b7d064bc94724b03e9c91fa4ee63d3d36580092fb72ab3db38de5dee1b878798c306ecf5cc017bdcfeb60efa35d18f704dfb4f2bbb2f6e2202b6c5386733fa3fb9cbfb2cc5b613579d66ad5190baf3eddcf23f5b55bab0942fa2fa866719415d1f82ff12d4bb9f5a260995cdc7c8a537b91c365eb953f0d376572732f4a9f814a771cbd4b3b25933b94e42253cc3ab0a700dc2553f6412fd16dcf310cee705ba8d12fd5a022522fa8bb9b17ac521c6922ea25619df3c7db98c8c5d2d421516ac9ef20c8135b141944fdf9cf2d66bec457afb74e968ba2e79e06b7bd18f197111b3aba5e27a57d4c58f3059de2125979d1569dd0cc5f5992493c6e39b62ab8ee345ca1a20930655a51ca67874a853dfeeb62dd35dc4361ebf2ed18fa2b611d7b08491d15893291845c89820b06b14ba18ef3c6144879c98928b7f983caf96afad970e9ccf3eba37703afec366d92ffa94d426e9b3b76aae817cbbaad38bd2869646dc02a76f8180482ebb5f891b1f53aefe952f82f9498514929d3b8f1f8a8fa74583dd3a4965d90f863adb2c56cea9423840e116e1f3628eddf7e172e7e66d110a7aca7a52b330592850c85dc7a95ecdea68f4bd41b57b931af6100acbc614df43e2cf34004da3096dbf8cf106e9733d09a6981ce5d15b8d048d7cd7a2e584036b135ceff7ef02156182b502b46c029ca17f6362fcd3bcd215732e4b8727324e085b22b3f97a1dcec3f54e621fcc9057aa19e281bf4a31ab917994989fc65fe7703a14b090b89f65a7bde3a1c83cd55506413c7cce5bc5419a73a6d2a7e9578ac98662c794228377ce02017e6c0ced7033237b9b05b6a7c20591d0a8c615452d06be0ca997b3f9e2bec8d64b45789d1c7b880048041d51e2d6ac6196dabcfed212b19edb0139cc769061f78c931c0d984221bd91a5a33f4c1b2b1dde35c8def6a6c939da11afaddbb31f8ab421fc67cd6d01ecfd55991171687ec1548ef6292df9eaee40ce7816ff247b19fa73bf8e2a05b4b014029f03e580aef83bdff42df43e25ac70e8ca9f189a18b913ec2a46b802e9562cf624ebc8a2d1dd87cf533168fe77550e6319a5fb9d26883cf48168e270c1578f78eeba77d09cc0d66dcd40fc59f1b08931aab68205ad1b17a3391062d43f3a69c1ea1ed239fe4b3efcd263844a9f21f022d1afa2a54e012d6b65a629ff3c5956993a24fa5dd6e84df2814eaa68e3dc6880801b3bf9dab5d9edac7aef449b3d7cbd18ed48b7298c3840c58cdcab97e60cc2ad923f7739f814267b6987231a10aecd366b96b175b8ee67c1198fbf47327f471eeb93404ee7a92492d156deb9f549186c55792a29e73a8636c3059c5dff75998c9d92128b4dd8d8fdc259ed3db4b1287fa52ed3c40167f50d6a07d5e56282962b035282128120b149a7c9caa126e156fa177270e05268987af26a11b4458af4c964711d2336ab9ba78c66f7ee43b78c14295ce68e4fffca25c11f09512a56f61a497cbc4a477ed97941dc6b0bb618e2ffe455ca8b84bab1513c94aea00687b2e3609ffb1c26642d4c216c29477f1b46e3ce908f87340f8790257839b80db4dd850addd47fd277f1b6f3ace89551845b51befb59b22a6e2b4df81a412ad6977c7e703973abfe922e856a94c7f7186e41dbd1f7dd2cda5043cfa83adc65bda543f9282334b312e27b47c0c7f51d3a8c20f165123e05c7bfe86b0e2191cf464d366cc1c83e360cf5a3e8588a12c714edd3b2bcb5027e041c184088ef3b1f445ed3f0a1a11b575be515e8b628c1ec38cff5be2913c0b1800dce5e9afaf385a95e0a60d3c4fe64af50013878ab4969eb0e8a55f6024a7a2d4ee01e083d80f893d4bb96e71c398ee6e02dc0504663c32bc95a0c839c5b501da91d51339bc69a7692d2090d7811b026f48112937b00bbc8d426fee4381d3f05245a51934c520fb1e68fadee83c1d0193fd63dcb34154e8112fb5d52988d4a56f1a4e39191319f241ddc896bc39802158ed393ecdbc71316f87fbb482427910a892a1b16fcf9f024e7f68101c3de1d35edfe2d60af8dc99742d0374706dcc5c902fb41aff3e5a3552802949f4d05362c26d37d365e0ff67de0a2bc51bd97e3dd1d2b9aa9f8b0b9bda8a24dfd738cdf23490e5fbb3f0b9fe3cf39cfa1a85801461d4ad7f2e798245628b135d4dada947dcc22babb94365c0c61d072ca75e5374e4e4d389b6e9c08bef5b8713b1d5a493030d72011a1465d7f0e13f2b51944f7a20045a48b708940eecceb96cdf5ef16908faf9e1edf5fae3040c32fa4d7c6b4b73a39e5f4b3b32df6a865f80a2da5d332c5884600191b1277bbd0b3af9749c783600fa8114bb345647e422f05645d57a7f58585b46e01c340943f014bd6ec993dc5d06d56cee5086e4659947df0660f387db98881488bd9dbdccb0bc9e339951417c9039ad33efc7b89d72c16e0457245288886015e1606423ee6a87c09c352a553b9cbea22f6387c31e4f071204f17c930fd3cfe3dc271a05ced0afc49add0785dba4eb06461abe22466e24e05ec535b26d6cd19a0b820094a92cebef150bc9319937ebb5846d21f8e2175884b7469a406ac1fd9ebb91245ac602dd9fd26138a61a82280e7df4d58ac7452fb57fbce279332cd8c515dc93bdcaef9f9cf6ada9fa296fff90dd82281d99556df7fde75fda7b715548fa90f4962e1230c00915da34156a12580168292e34fb1df84c1cb50e5f489d1fc9109393ab2fd40c9423e43ac1f85e1e558309ca4aa24f7cc6923e4c4e1347a5d5434e0effb0c74d1766c9170f8324d11ba281a05a5900aafe524ea630c010c9b05b9e0968b3c8b01a5e8886ec1247ec89221f947f8fa9f0d7f58c9379f6a63ff957edf55073022f5152c3fe4f6046d86b1efaaeedea1fc075a952f81da670afa553f33d7be6ce4a2c64ca8e20da17c5a19df23686510d5ec2807d9abf07e3e98f33ed2b774334566896e84285466040d9331d829cc9a64ca9b68631dfc2e9a9bcd26a5f909cba466225582e5c7381e7a00020a7bb181e2f626aac196814ad195a1c31b7978d84d5ab3d1fdd25f640ce85121a79c6ac086fb3226471124dfbacdc203401c91e0817660745aa0b4a62faa5842fb9b0e4d61947a82a002875a0752ce9855c8ab03a576626c7a52d9113d37b1efc7c7348c5166c0be04e2277074f35b82537e9d20df8308168b4b303c0a7f2c6e6c29d465dc31d09ba5093448db4a62b864beef6a776c71b0499e7463877f1b636418b0bb5f8904b193067643861054101b87c91280ef19ac5f03aca20d2944eca9a3a37db56423e040b4852f736c63eae80482b39c8c741058d5117b3d3737a09b5bdbe9a49044292957e3cc470ddc0d7b87ffd556f8b1b1174c82627f81625c4e3b38f0637047577247ab51b9d853f995a6d9f59fd7371f0afecdb5e33330717ad590b3dfccc142fbe79bb44a21b400c661f6ba699ebbad81a1b9804db5f875a01556093d498572bc92fe607a543ed591026a372cb47641eb3b1a01ec150a5d42c8385581972e13178f8cc85448d22079816f690245de1f435d5645adf39bdf6eadfa50c9445f293ec02f0addef905b658f876ab216a386eb34578f33cafa53071c4c3357b90924120a72cd010b4cd25bd710b0f335c00376e9f589fafc1332944ecacabd085f1d3fab7b2a320436e5227da06b7f310d7637338fc6c0d0e1bda29e4b1f90fece613c7ff855463dda21c2c8de409df4df74fe1971372fd400227c9b97476be60a795de0d7e543fa71d8b511f1b30628004846b4325fa3366aee5ef47a9d0e25350ab7faa07319343390dbd3c5fb151e6f112d18cb37a8282b6f3e0e583fb781c8bd026794eec515e4d877053714ce2442295aa4801557acfa4763e4fe0dbebbf084d4170313c0fddf4af2d67608471206dd6c48d8d33c17da1319fef7b9f22981837381cbe2ee77dd35ab14389bf2dfb9c8f243c85c59d7882f4cf2559f522511d0d81c2794afa47c9f97065364047b20c770110e0f6f59c11b5b0d99e9df9f40d26fb9e93808b22bbf675fc76736d69b1374dd174f655ab948a60a613febfe96f43b383477e35f4dd315ed450996a0eeb41d23c6d99d9997738df9e4a9147519fe2cc0084866db67ddc081e3dd3132e3c4c4414c3a17758c31caff52ab74dd9bacdfce68e2f90bcfda655154b764b63652c27707d05c3b44f2bd0861115c8f69fedbe7ad0401163c7de3d3fa2be1ce813e22a5d45750824b8f7b34266584f1df57917b270782b4bc839665f5707a0e6292e3cd7b7c5331c4d26a9ecf235a2b12565ce526400aee4ecdc03caf6063313c011a4b8164a20540b4322bc85ca05bc307430a19d41ed30c14d670c02b8f4dad64564682026b923960916f94e119b204140333e5aec94dba403a54e523264850f8af72883d3d4ed91082d4b6f28885cba0f6f49637f20919d28642ec137c3e368aa16962af5d3a152e59b2c02f54222e4b938d9b4467c1a2e2d084d4e50931d2b6296939d0888f2aa3ceabec22c92cf281663f7dc60da90a14e7596a5517e3d2043028fde055c01cf69e2f5b8c69a4ce3948bed28d123f404ae81ca8ec78de4c19093c67fd23b0ee4aab0cec5bd141983968b114aa748580d01810b33d1707a64b466d2bd8f6c14945a492ea22969d707866403478bf889ef669d010e7c09f8dd21aadc1631acace5e0f5923be2ceb72026e1ba26fd73b99f7ff6e3756c8db065b88b52ee4259d717a5b3fe9884a3373657ffd08fdcdd044966ba61e3cb4bc0527f8abbfcefccf30938717fa68ca405f52a5089500f92b5796291fcf42097a47720e72bb2dd0d4ce93755ca23f27bdda23506cca4ba69a125a4303e097d973fdcc659eaca03aaa6cd701d92dcb2ddee56397b668e9144be3e3397fac1d072c32d09f74fada59178b584faf0ecebb7855c2c92bb3f8431d474c9895825307b65971fcc0e6313c365acd3dd3bfcfb50617949246aa3fc4153e9199ddafe9064c0df096a99d8591e5499a6f9dd60fbb319dcbcfca53f2e4d1bcf8f75d0342c076d8287d9a94b7f0caf1cff1fb980dfb2febe7dacaab0336479929eade8115abf64ca32a88fa26ab63ac9a92f863a683caefe47dd2c13b49fc627f40c4f9ae20f99bb392d97ded08984309e8204b6b37ec68f92e051fca8843d6448a3f7a43abd03dc93ce43edb7fc5157d2cbed9d1c12848c68c847dc5270163c5026876f52f27b9a64e5ce8e3a9a50eba28f741b5aaabab206f0c7245971c43c146ee526c22f35f7c6174af806e60ff173bf2acf390f0c93d5c35313865614349fc079bf74f0b9dbb88f83cd8f29edc2ceef3467913fc7c2b95176b084968cd2d1cf0e27d3de3c194e7cd14a1c0a9d603f3afedc451477d561903f7e727932d3d4718ba8a50cbf35c4ccb4b22932731436788c8f676a1d3bf7bd780e6341809e4e0c7c7773b68c8b4afdbd80d5043ada8a5fbe7e20af6ee61a5718b98c41d9666aaef8496e2e354bf717c074ce9f53267e7cbf24783d19df15f30cf9d8f196e7e84b3400777b96911d537a6102bd176f2277b9d48a34affd71b0751467f2e7a843bdde72750c18b68eac8ab8ff07d920a6db446e48b28a42ac6a0c19f121e1b2fc310921e4d870e3565fab26eb438be78b93a0f87925989e46256beaada565b54b8649c59dd1086c513aa10ed4d642d04c7cda85da894eed158dc9ddba60f03b4b6fc7689c009aec9614430e4c0e40ed85fcc6a7bc7258796c79a76ff5e7153f45684b083e6998e8665dbb03bfdfbb3092cbdba814cec10e3da14620da539306111c8e72d194666cb4e6218c614db4dc8e418b23e1f3bc2e6fce744e58f2801980f7fba848c74e4e32e6f07832a572a2d3a4bd9d527c4ea618134b24a4d59a9159dada9f7060810aa648d9ba6b92968c258a85a56b0745d0f1fd1d85d0a381ac72daef2308a33b8de0d24c531bc781d6eab3e7ddf0efb863ed43e65a9cd2c4d14627217d9e75e119edcb5b6c424152ccb963cec98207d8e491bda44173b7a5e3045f6071a796f84463c20e77c387875480dbb90a77db9a80847e599cefdae5aec58a934581faa8fa6ebaacb27867a69a4195425f8187af7febe4e20ee417efb77218c8426c669a30a26abe30ad42eb132edfe891356fe9237c15d8640615f547c47ac4b9e2b8893918b73372ea6fd105eac22804cf84ff6bf601f3f1128c0993202d682621402e77c71b9402a5675dd5a10d610081a935fb6a1a0e7e251393b13b614af612ff23f1acaeedbc051c760e77d079dbe1a7e1e9de25e32ec448f6c8d8bb56f14ae9cfa06cb8d692a24ba63a57e975be21390b38387580179f484f3fbd6b8cd3084de3d38a1561537478bb1bc9bfd36b6d2ab00dd230c57cea83830b18873cc3d3f97f56e61e8b09daf47baa62f0593beb1fcbcb075af8cec56ca127f0841c6367e387c8b289d6f7d00fe64c56fae15cd22823815ff06d0f1c969410afe75fcb127856476fd321d2a2acd80675ce5b270f7abd97a3f3748d15a65f533bdaecfafe8ed874f553fc043051600cc69c488e0f77cea26eb1a9dcf4c945c09b47db64a2956c93169c4778ab64d8de847c37e34aca311e039cd87da24340abe2eb6a09880aab72fe464f9d7db0bb4882b17010fb9437b792dab1b4a5f3c08aa93835589386b7530a8cddfb56301f4b57309d2a91f6135690420b5deab5fae9375aeb9d243cb16b6a13902b6b96249b6b317d0217a089dfb417274b74ce5c4508075242c1b216c8d3907007d957e655598fd86a463b4c7b2358abb586e9900fd0a6af1c4eed818ea31089a8a41075cd75a588d2334c5b2a5652da618cca8733bcc102bc780fbad05b63d3a06eb341cf8ed93c8f4e84ece0ad93f8b6162880161267e0b3cb153c7234502b680b5e7ddb27dab61445e01277670f2db515bfc856792c32ffe4c3a3a7e211be08384ce22d6019bf6c285bd454273bcc1d62e7b50298604bbdd2b75198c843485b19c2fb525d2abf26d84bf0f339b9c8f7367880b2e52b9a9a1c0fc893e37f2d258f09fa878311a9d61bb1c0f469d9e641199b72e1fc90800acc69b2e78a20f8633a2bc8f7e53d9406cae41d803fff5fdb779c2683bf93285569eded24ef962a0d7d58e6078fcdac9322b022fe741da99809a4186d3ac0edeb869b17488b0946e2141b22b6f9039bee1be9a25f9d4fb4145fe3cf70790ad7d7785ca82819ba62e468e7c8e8235135dd170459e8084e53d70d500e7657508a1dfb1e369dc9a16d9cc909da3bdb616d94fb8b58dd9564f41c1a2c1706ab275f87234c8a7db3791554198bff6fb0dca71010ceb58610435bda75a545d80c75527644ef7cb2d0f7a48af549c0acc35109276f5bd2a19fbdd6ace3e8693ff6aa4701cc6366a36bd5631084d8fc2025d6acbf0dcaee8f720661c5fb4303bc9b292576e60310bd57b3fc6f7cab8560bf3e34b08fd6c36b5844af1f5a944dbb47e3d3e6f0fe863cb63a95bcc3a47dfc6477496fd5fed73b74e76e48e0076a4a87f3f58827a9ed783476109c86d04ed88cd7c318769e0bdca166afbd0bf0bb11aa6989d1766e7abe8254cf939ae69240f486b8697c680c94ffc93b09b4e477e50893b6d40ad90638354ed4629afdbdd41184d8fc43521816b272bc99915af15a2614c59df7e79c4761f2480453b62527967c5afe7f24356a4f34bdb8b4c8e57039ddf4b3e414e087bb97a4b3c2ece10725eb68cc64f341879392f16d9a79244a5bceb13ae0cd7d10856ac9ceb58ccff9c9be3c1f924eacc18eb8901750c34c63f97140b8442a9705bb1f9849f1421f271b5a8e511fd8d166532f371deeec202fbf50c51965f772e93e3a38410112eed179f7459053a0f70c50399f25feebf64920cab5584c6f6b2ea698ef845842732bc8cdd41281c84b0b0c3f7ea0124e1829256d218a4c29aa47a79a1b77898f89cb2f21b835b34e3abcb79b288ecbc6ce65dadb05fbacce3c04b9ade1107","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"3b65e88fb4aad2a4dfb95b4861d2091a"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
