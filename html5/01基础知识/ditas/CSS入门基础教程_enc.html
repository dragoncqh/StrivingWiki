<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"2943e6fb40b8ca68d0800c9f22b8ee12c2a0a24ff577679c9b91d036fc9d7640256c499df6fb1a57eac11a8100fdc6f009d89f7b78e06485ac4cbf5391884a043bc0669df045c11566a2db8bc9894cc9a8b56eb881fed9afdf9d68dfc456cb10f6ad55e057242ea03c7ebe6bc2817088fdd2188ff990b5084faa79214f1c32ce150ac12b2c3ae8a7dd7ab0a8611cb3e176764ba9d624b8d41ed90ddc78b4978b24370824ac4bc7e2d3b5f9f0ecc66bc060986d831b60b5fc522e71148acb0b0d95ae727597c0b9d9d9f96165263085a9e6a249b20348196533175f141cfedf2ddcef1e948bdb6c7d5005ce4b140cd516989fd4d091c865c1005a857352da76eaa643db1f847e22500c9627113e6f1aba05a57c5424229971f5e7ce5a45056bb33d819488f694cb762512d529077e34d1709f9360d0267934d9cf75cc7a131ed802f76706b878be409ad0ec3ce37db4c043bc2865c49391b899912a597687754a4bcc2bd3dd764161031787a8d7e97d8c49749ac6d1953bfa64a036540fafe11e7e0ffadd0cc27a25ae491ee01e8c307036a6b166cad0f78faa505ac614de6e7dd2b424afde66d117deb8dd2d0db6d3cb141595847656534e5d2ffcbf56b849959a0380790ba0a382f804ddab252fb4a93caf005fe0590651109ab07e2e313382e6d5278da263fe09e9003675032e6e716a644d79530684773394ce098f49c71df7b8c74824f8d9054a4e156ac989d66bef4ccbc6765149cc68b41cc6bd53b8648c78a1ecd69335fece84d23b25e9ea86ab53e59630cc2fb01d2808f9f2ed54ebc07c7dccf95e616d98b4e2ce50a3387d98f324d22666fb58fdc5ab4227134d270767e13694e5e9e971d830bcf3617c62ffcc9787fa7d9f29adf48bdd1c74dce40f8bf4c7ce842fac31657a8c2a0885b802b6298ba9c52b7dc459a77264db448aba36155dc25493cdb399c21b65e4b0d5d858ec1dc2ce6da2db75429ae5db5c6b4c300e314da9c019d962086594973d9880b518e70e80046b461776b3480443ca575a70c56c2eb9649e29bd2cdadada0ffa316cbe5cd405ee5629c5b9fe6cc11199b27e3a8a2bcde3c0bde31891c2c1ffe0d26bb8a6e4adace4fa3500186e3730b631a8df8822c5e40b44ad0daa3d0eba1962bc8456ed0479b1142d95132495e7b62f4ea0be70068e9276e48cd19cd11d1d295712f61bcc3f2c6f29b41532cd6a7edded3f659780ddb7116444b10b4395f89dee4b7d941f6c46da83d1a9bca31b5cd69e8a27a440b9773b95fef37db103214c114c84c9b5c3a79b0b2cedb85fa64db0942d36d75be5d272976af9dd2bd8acce426831034dc143bfbd6a4a94e2e7850bacc1ce87a899d04eba36d80f7a4f0f56a551a8b6ec999732e190f857887c605cf439dce4ae7eeaaecd4a68595897ebada6a35dfba3b6547b35b8a9e9eed01670cbafb1a01c8a08b9c87b2661cb477d4ff59c471cbf8492ea7cec4b78c1c8ca97912f7f4786162b43b897e87dbeac3974938e4545a47ddd75a698539b85dda7c12a48a4a94bea09e196187f8570d26a3f978f57d82076e23914face9d2f3296a0042bfc5ec529badaadb0d25414f526ec3ead8516f470b0e19591fface24891aab2fb3918e155bb0c1ec60940a97177a5fd38d93d314d84a8bb634b366edeca49f9c20440847e64106fc92d36057b341c7d5716a185005921c180f9362bb71e0a66192920d44458481bb70ce2271366bc0b5b994ff8f42d694ee3e317503ab56b4f0f331a581399d042a2a57d8daf3ba2435f287e08859eaaefe0eb35d21856a312c1ae7ce3a22aa4807baea03c5ccaf0de717a73dc77ba5397a5aec46ff519a10119a62a9e8ea6ecd79e4591fc81c04e2fefb25d7848d8a21ba565e2b6b46bd60ef942917410dc148205b1b08da7ee443f4e7f1c6bb402f00643e031d526528e9a9b5ac6858c18012fed1a9730d8558978ff86196d235e3e3e10177ce91a35ecf9c5c38009c917fe14f28b4eab1bcd30271eb71b6338a45ab9105b45b984770cd7f357775ffe218cb4acf4da2e05c5a7cab7dbb804dc17514704ff4fe423c2222214a07ad6f69fa0537eb91204fa406d0cebcaea769cf7f1b71fec03fd6d4410727971c00160a4067e101c75ffec6ed881abb97a9a0334fb2dadca88ee66a10970314720124d535d36e558cb32601a9cc72e4225dd238db1989a04e0896a2fff5c5de3a369de387170d8fcb620afdccd149bdd0b2cd2c6327847d6ab63957fea6d0118a5f6f4277db9021ebb997a32e983fb6c40e711a69dd71a1d9286502e6e592b13cee894822da2b8f712c079533910740deda88f1c26c92a3fba0092176e58aa4474708f3f4c7def5ce69d333ae8570108ec63b1e00799d02a0ae05a20d826b17aeffb16646a4c2b41da5392e3ed240351973866d4aee84faf2fd73bf7ba73d0df79eb79d836673279892c9ca478d09bca8967a271de91b73c290ad4c339efc3bb01ba63f6e93a9cd5f260a4a88e74723d9e1df1d77f364b37bd87b29e5d7f8267866d795f571dd03cbc0b79421f590253bce48bce6d10579caf05396841365ff522135c760ee1fef87d01221fb0559d3f4a55945bd8f816a76e0af1220e3b8729e06c15a4a070998213d065ebe58af554687b447088cc3cd3b1d01dd408efa5e47390433c2eea0f38068c769f639d63b792f418636df32d9fe49ceeccb64f02a468af0d5214f2228e65912e4bd44746194b5c433f462fcd5fbeab1e26f6aaa4fd7c5060073f999b03cbcf72376221172c260bb26b64050097cd233ebe4168641da6d32d59c161f4908a6e568df09b097d7dd7afd74b8bd34764b05a6cbf0e211648d1aadd0b97b2021cd935af1d1b50abdad0199b9dcfb88a3f4533b6b8cc2bca7eb99454f402f03e336f2c8da730765900c7c88d40d8c839f1bdb035bfc83a5d85d1e46faffea53a9764cb1185ddef352d553a6091fe051c88dc85808fdcd1f4b4591d2696d3150a1e7e91e782a9362079b9875723f46ab0fcbff29c1d7f1d4d6cc7262527c4f544bf91a6630ee94e9131062bfccd72558b19ae8da83c54a5d458e836cae91d128b79a3f9c7f0bf2b6d8645b7e36f4d8810db6470b390f9287cb93a23a7913b5262747ae866811a73841b1ed8950a095281a41ed5a81209e21dabf065743d70e015acaab9991bcbf79fb3c8b47115f6b11df15d8ca9a8e2fa3b443668392ac05e31fe2791957f6ba79ab40fc23eb9f0653dc284d0658dcb2c2a4b625ba245e63b1752f0dbbabf243e83f86d3505d3837ec57a0cdadad6bc976000cd37624dbf41f2897eade14ce837487c18bbe74e019d567d5ee45e63aa0421cb7d66cae9249ba28c5338ec48be425be1d73904782e263dd1ee28935fd09a83ebcd658b1aad9f8d0b94f8603bd67c8e0ced59c0fa50a6661e1573141dfe0a75f38ae67fb1b1acdf5a63a53bc7785336197a42ea7871ad04cff48f5e358973a9851c4ba35831885999e29f080a680b8a90c021f8b497136078d1e49c59662a80a6499377a19078e3544d38cc95c03c0c09fa608be0da28f51556a97661ce257f5b93570e95f84225534bbca66619fde7a5d3392caaac8dfd4fab036ce7d95cd72d2edaff020478beabcae493f0c6278013b4158d3262e0d49b38a5b290afe35b9e52c0611636b17672d3ac896b63f174b6c0b4be0c2447e1afb0f5cb679ab4baa6b3f1706655c1a6cba640ea98687b26f9a9a4549d612b350a27ae847ff59018d4e54834ea36a36807121e73ee088885eb53d5d36499747ce6643a36082daa0765520a6d77203a9af5b7fb1b0cf0892c444ac7f967ec7a73db7ddce391ba54a162d186dca0261692eea1907fc00f652e29cb4ffc6fc6c27492ff58a756c8c78a207cedc69d87df757554ad041a9b2ff15deb85b980c5fe99fb74ac97c2e6c01b55140c7bee3417c50ee35b2a96836e3a059095e67d399c068899a7831e9a894f9858985b96f02808ecc46eaecc096eb5c2a6c37af579c5300117658e3207fc38c1dededd18ccbc038bcf21bdbd29b13035e99b95fe555ab31ab78123c5c9aaf1fd94506f62f9a4abe7f378d0a673b815ab761b5ee59094506e699f08f10e8837d6887644059fba7cf323b5266edd46c1e2b18c4f733f88ce7850075957d730ddb624589b9746fa29bc1e13fc885be7bd7653155c5a431de905cf13f42d9007489ef935825e2d69dce03754b6bf4c956b407bc50e9dbf8ccbe75ce82ad386ab7100d7e370d97635a9dcd500c67ad9e07f86fa485677050a37aa80611cab520a42e7cb0d5c180c55c1b5d74118fa23e130ae6dacfcb2eca923e0876510c27c8f472fea261a1a60a720c7df42802ead713057326e6f950161136440d83d68674b96081742aba7c65f2d729430676c9dc8a5be214acc270b97853acfdccf60631393204092a6d76ffa342934e09a287805257963487d47cf7d7eec703e9a01e0934f4118c4a193de107177635668d487b0d9e100b3d638c27edf3948df9c5153a36658ae96f96b532bf6ad07bcd8bfb85db7c62996b8dfc635706613b9cbfd9d8fe036957cca1d5f6d7498c8c695f06c688bc4f8ef0eb8b4e3311dd192ea8da99313fd81f7b8530a5df34ec376cb59c036e7d88b8b9f97210cef73c1bfb0771d5f84d96d53bb2a8d4cf0175a9365433e93ce528621fc804fdb3fa98b702665a4c411a44ba652bc1f4d5b787e668253bdf5bac0bb03e9a111dbc19369e1192ff3b597bb02fdbb38c34629727c79399a1fcc24494d0545caf3426ba5e3f3bb9e42fa2da6ab9c7108787e18c636c9ab047e822260c97dae2b3f6a96849cbbec2e754f30b987e093a41e539345da390a61bbc5ab11640d2f35c82d16a3a502bcd2dab5b9c13dd27b52ca199511b72959d6475a8f56fe6abf5eba5056f82b4de8ff5c0f92aa42f989e40c42731fc9a448d7b4ab3a1249fc16f5ee4c03d27307b5795f7450a18d5ad930c18e79f387933ef171d12bbf25ab58625937fa4634a42eab4b974f24f758590549c45df2052dd9f260783e1b4312708c342ddcc6cafaf71f626a03938b8537715df2efc7f5b88f3d418ee9d66638fee192026971a8a19d40d4fbe92c512dbad9cfc3ee0639ba1deb98309d7b3bba8e85cc4f60e2dcb0add86be4ede56c36800b1a36904d4816f5d5c44b6dabe44207f0d44af746e6c3418299aedffc620e682d5bdccc936aa686ec63f93e7dbcc5678e34be18909d01a372f932ea4c185d5d64f5db23d96cac3a45c7b6b867f48db27c4efad7891914cf26934963c475e448a37d44a70c0668a2446b4888584713b2779e7d49b7b39c0c55913baedc86d4a0e37788b2b597a5f47eff301dc88b9f7159ca40360370891978c6288356efbf27e0d64d8605e13d03f1a1e32148512c773c72e78053ea16b3529beb5806b75722e99643e0d4dbb07a0a76586ef1dc224b6c93b11a456bc215b620df0b5b22f9fd36c4887e134d43e04629aec85fe9476dc7539753a012ac67eebee9c32b35f7931eee5530a1e463629edea4985799a4e594e81dd6a8f8d1e3bac7c9534ceaa4a8b1e3483c9c785275a9b9eee749d0b64905c0a072e8dc587e23dfa288d24066896366316ddcab139a409b1f06143e7e4aa0ce7e0f24d53f44a3cade30896f94ed97831f1fcab47bdfbe8c942d16af8925d3f5cc4f8deb4970b7ab3d0e24812918d5560330419c206b1a86679e77255ea35039b8e19a8180d1fb7bae9eb91eadcf6fdcfb7143845d9a01d870f477393bdfa444c6a7b50c77cf4f71290d4ace10f0ec44f3a543183cf563fb93aa7b7ba0b578c0731dbf8e01dce91b00146f35ce95fc339cf683f35d5969cd3c401aee61648f42c33c52e3c38691d080112f953de596bbe7ddf796f49e1d60df34aeae26a3746428db0a8f998ddbbee98c6d12713c13d1d266d3c7049d256e57b67c04853bd2cf98ceee6a05bcc66da563cec9bd4727a88d7e4f064b0a7dd0e102d4376cf445bdb54304c8d68e2fb9d00a73ea0509fb9f30c3714e609f6c4ad11c1affa175605e4c0f3d9e2e07177bc88242e886eeb03ddeabae6e37534fe923034221647ac7e3914c98e769187d23af8f885c478a668dde14ca277aabffaab653b4a6bed5b35e389a8092326335bd8634f1b4cda0eaf42bad9cd2237800618f171656812d33d091a59dc50dac4be6b9a558de21f0e056702c4a0e6016284b9f130548596a19d81f29cebe27ef401a9a0efc328c41055fb6cbc0f628b0e547607566d3b10c366b3a4f4dcf659ad2ecce03dddd929ed8795f43a86a46f7eaef10494a324b67cace17b40c12d974aa4c149c05601639d3a1bca7f8113099a3434ac52bac1e1d2baadfb59be6017c3a3dc57a7a765a5e65e1355beca2ef43e2f1e601321c920fddec60c56a0bdf46b9772563e9cd16dd1931f4545ae303721bb9091b13cd5f4affdf48f0c87a449b1b11bd84e8508c0bc4260529f5904d744383d2d3f9cba1aaec610a925beca3440605cef4d2b3c0897294b3379e11beae8cdddf95d71d066fbb539e4d6a07fd34cf94d5b969090d308e27efe01be529c3857beef38a4c03f1fe7adba89e2505560611d43136724e19534655e53bf98c03d8055adfc18088d49c055fc20454e4fede35f02a1afc61825d6c9ffe57f7a6789d30d7a674d5d6f5d0f849768da08a4346247239857cb3ac43a77475ef2eaf38de4f9a0d16d693285537a385f8f889408f7a60ad2557b63cc9e9857b7dd9fec05d2c9d1bceae3fe6c972d5b40df02a160f37d91d75305ecc53805b0e7402e3f0160d4e3db7541b5bfa386913b7691c34fbd58e1e80652c2a96099ba47394154a4616319c0fe2ee20f02024f16430799a26848f1320667c518b091c0d1fc65b665f3aae8fc92bf76b520a5367ccfe8abcf9b659a535ece03f576611504e87898e043be86961cbbe0b3dc80a382696fd842454d0f6596914049909cd90feaa62a2ed4181b7e849063d955f2563f0a44e0658f31a5c2f1c8dca7b3610b59d35212c9cbc6074dce876f448307adc3ce901c692753b972d11bdd7b8b301e1fdf00b852c70c952ed0644587c02e1c3a7c2dce7003819d7efc2b5bb59cef0512104c0974a5b70711e7a4435e170c43e5f985055626c1826750d7422667a19ba0b3879f968bb86c4940ea92cacc91d95e37cf646f43470a816bb41542ee9615be69e7161b9aa314136f4fbedac7ff6395b7cc3fd5b1d364214f159746cfb29fd9201aa357b9f813b0eb65de2bcd20a2d565ae5aed28c53c403bec58ca9e0f8a920960d3a1ed53ab740f61489df98166fe792fd8f0740fd3ae61109240a4c878fc10054ef73e6a9e056d334a8d242c9eaa4c768e84f95d7e1d2e98ddeff88f9d21ee31673a8c90ed7025b95cbe8b1fafba0a4979768c2da94eb6ceae75970dd4921e6a62c17c4f774020afefb83d852cc72df2a80fc05f2924eb923b8dc1027f61df2258fd0d87f295246638c78fd056445cae4e4fd919df7c9cc3024e0486acf928e06ea8f01130779f01c1a8c035d5c26d26c5ac866019ddf76e9884bc355d125fb7c1f39aacbcd9ea94585a712645895882819f025df3118b3dfff33f05f1140d8ffed00797ec3beda2e2db312744af6abecc13fc0d8178a25369ffa9ce1a66ef0ace7c86568855fd5d1ed473193e2f645add38cc2951efdae186e831ac30944ddc7e068bee52e8d6d7d6cb1d8bd1537dc61f4215106859fe50b5f7f14652714eb99d5ca7b84e891d3784cf50ff28e27f95f3058fc4dca72d444290b3e4a80f9c4e6b51a5d540dad3cb02f9f84be9ee05a58d1666e9b9efabf071827ddb40e76b456ab2df461ce4e9e8323a2ec817149872197735cd04b5bc76d1b2094be316b3fa512064e634fc3197496bbabc4f1def76006aad65a73c362027971f20ffc634da53b178ef90149f49fca25fa0ac831f9c33651ba7df4915e342568188b0a669b4c1ddaf31eebf2c516967713bac62d2d5feafb51ef57bb97ac8a50213668005240989421da54b79e2cf49fca31ebd938a2564398099df5fd9a0de039593489e93bb3fdf4fd231ef6926a0b5f1d0bf83a54c58d2f6141ebfc4d5a9dbf850d6c74d4e83ded02fca816a32438681fb3a3c5d1a8c5de1d10407f3a9b738c970d8676956767057f176804aaf2f01e7eb9be4e670308cb4217197cc310601edf2cdd89df389452d049a9a9e1e2ca3f5ed7166b9b4a8a23da322b03c376c87cb3106605127a2792aa6e9d77a945569692a29c8d11303ca6c23d87efd6e8f5bb936496e3dfe457aa109af45a716f1cbf8077506312e5e7b4b9001409974d0feeca819cc69c6d2ac22cca167cdb0fddc95d89829cfe85c7bdec2c92a0f6c9f882088c86fe9eca7120cff9ac8c5e7c5d0b1a0fac760bb33ec5066ed5a9bcd3c5951d42c297940b26c1659287551ed249f2982da9270f48920c47bb45db0f02cce540d26cba91f94d24f46d057cc5019a3f6f878164b462fdc34d7bba1a18d806e4d2b9085b1462321cf466c21b8e259ac1717a3d9b3bcf1561881de5c59f82e4040e5a519846765b8e6625bd5e67f31776866f483930b61711586b122d6ad9d340adf82916c6f4f1b3a41b99c10f24b31d1259aee526f4a9331c51e56b50fba09fa252583a978fa6dc72cde6b931480e24a04ed2211729d47595958d9fadc047497c61878e3a7a12e00b663a4d08ebdf17cbb18a9deec025240acbc6378df909a18f846ae4438521e28695c9823b51cb07401f17afc26e2ed9295d6dcc556ff796343ec5f82af3d61cd0a38f9bf39d55cbf109c017e708b8c6f424caff339e18b0e35e4a5d09263e1967be840469aea4555bff0a7351759e9a3d264ee18a06c26dae5619674e93e7423a8b4543b2255e61863db825e96b46cf6b0830cd892c966d3f15e5d2b8a31849f5eae798de213f0b3a0979847c5118269e8cabe7d1c271cab7e24819855cbb66a4510ddac4c228358843e363a1bc3725e6897f429ff3a9dae2caa663910c700d21aa5e8c0450b606e3da31e0194aba4db2f6cfc9dab737bf186dad247a3308d7e4ffefb8d0b12fc0a4f976a25404a6818cc97e848f872e971bd66fdfad39bf325d125c0e8d9d1355a7b80f4365eb268024e3405cd7d8130dcc2c34c406b33eb455ef96c2127bb9dd7133cf0cd87cb76005a50800fbb53df387902ee9ebe939b8db2c077c198cc8e8a29dbd3e3d1512b65233ac5286cbcb29e903ba71a976a4c04e8a9b53680ee3ff9de6a94c332e46701f93f4020d02209800701effa516b787039c3860ec2311ca951f6ddd73391fb7ff7a0af4df6e7dbd9931542b6cea0f991d3aae8dcf7633a95566ba05c601893282bb565f12e80cb62a89e249776e16497780a958686d78a05f2f6be8cc55323d1116d69cb1644215e94c40acb95458583af96b4db97c46cc1697bd1fab63b283482aa897b653321c6bcdbe6d661d5bce688bba9a6a86d58916e04045c213ebea351f9588ae1766e0a50fdbad85ab2cc9e81b38e8c791f2cb9d4dbc66420e586869fe7a075885f62cac4e19899ac990a09db4b530235fba266e2bf6248cc2903e255148f7246bef4d2f64285483ac4e6879d23e38936b394da91eeaf794af2862af893dc7fb495e0a150093e10320842241331668422934b4ef99b7d3f2c9d37328c149377898af6e3ae27779cae6b16096a48a214d20b6d650e8f10dfa5c0a2e79cd79b87ae05be3e240cd2e15e0545d3d5608d666e64db77cdd9c1a2d416547b080736cc14260f0b68b188b1354d912f13d76f1f40f5d3081aa0fdd73431bc95bdcb1ed854220d1c1cd7e886e5590ced6ebf6af0009fe7b74e96aad8207b93b6624e6c66b751ca616cda09078a97d2095cba4920c6239b08fef496384957d28a0e3b1c664e8ca7f0dc7704b9874b157d41089a4d41cea76457f6b6ed5899a4f5f95e74d2b788929d2ca871c2fed8aebd852e60f90d859ec3c743eb085441a98034fc1a670d0247c27f9d5991d6e93f07e2248df3b3697a3693e8e3abe20cdd1e0db46e32903af6ab4bd0f57daa2faa35a0ec5fb4bfcd3c049e1416d3b2890225d5d2ababc65642866e3f8190f346050f84fb710ff2a18110da2b89f6b0735f12bdac0879200b0e9a8aa8be32cd3f0b35437a844bf03a2f1bb1c0cdaa80063d67ca9485ad44d832b37f84cc103830115768ba61db779ef36a0f00db37a6f3936b259b05a737c01d557dcf1d349eedcd8253b11d5d95725ebed8853c92c0e23fe7f6ca087370cfededb2d2a81f90e39590759356aea983789f7c3eac049e183c7a2961251cd5db7501aacb1a5db6e46bb2692a1f394b0f8a52990be7ba1273bbd2a7fda93c098e5a3829eb97566d2294e1fc503b6ce9a5f3d7b74d259dab495d3ef463da97b6566986ba79f062aa95fe5d29657ea9d0b6d7399fb4708bd0055b18389e70076ac87b8e22ee03e2164e098769e36639a4e83d45de81829e1f04cefbbb3a5f86478bcc300d7f77e5a99283ea7bff98dadf915f4e87f70c899cc94d78fa02dffd01c18863614f20b4181386dade8c35c4e492f7057888171c9d8de38a83e4bd70710c74bd83ebe575e7272136d1d59d9b2ed1be0c3a1c19fc6159a400e38c86271bab50bb273c3aa8cfd43a24056ce37d99c847c455f866b7a60083c35f0a38a4de927c9e66d4d01fea5587d0617a5e55a59614d8b0494593f146d3154316d0e8bc62d92a791879a2e4eb854392f980d232a22840e03a80d9171766fc9459574b3399f0fdf681550e1af6814fb8d3fc87e9d245db82c89ddc5d4fa6b53c59d4d4d5a310e715be96ec97f59a530a578554dbc63d566cc707f6d2ffe39df5d454f0521c72ea8afd1ea9e73cbf5ec05da15230c19f3264a0a2307a7de52f879d515ae2eedde8ea29772642754329549d90153ce9f9430eb0dbbc89be97c16e2d1354d8e42f4494531f218c896d0208a76ba7b89f13c8c758da72d2d8639fc5fb615e6140aafbf009d998058a020528dc4445f4d1368fa17b8d427ab9cd99e01d33913f81e3775fd015ed0302dd4415ee202d8563974afe1269a80025cadc02e745a50871f60cae45615bd5683b2317579444c8afd78a5ff7a0893c9bdd8bb12c6a8ec3870f4e99a8490a7606ae800a179a75a586331f2eda2b3cbcb5c34e48df61d836275b7455d4fdaab6c1503db82c2be3963cf3f0091d98d0a833e0ed4785efb32c1247eec9dec343681860fe31f81cbfd341ec4bc1625a079f4b86f964c4fab9780a80c30f015c35190111a391f34b0ffff25b09068d3deca845e7a0566449ea642ddacdde10081ad3501a9123fe97033867720de0d5166da454af9d4b85492c46ec074eda884ff6bc9bdfc2779bf1e12f46dea83c4b2f4bf7f5bbb40086f2126d19f5e1e2c9e8f68c7d805aae19026a88940bbdb4235c43436ffc810230e9d52e49a73dd1dbf12784b906693870789280824cb545e6f782f486afafaa53300c5ced06ac8d5f1f9a836527d34c9e7a1f3f9ceb4c7873c9ec42af113e0cc6d3cc8f08c5394d8edd1b073e3a1b6fa8b79a649105a71d72e8824e7c48934ebb50b8278599356643f552848b8660636518a41f94f2c332d658c6abca2e73057f64179fc38e4dc7bbbd598bf12423164e2829af449abc4b161ce4bd4aaa8732802ef8897fd3a811188f0660db60f5f8bc2962b1a70645db4403c834c6b4db0e4827ab8856c6d1cd7017a42895c9b61960cc976f158613d4fe83009bc3d843f77bcba4ee67bf8816fea2bd2c3fec1dbe0d15b63b2e28e70b05c5be82ce82a7dfb0e57ee7ab6880e8672ebf82d669d997961c86252f974d36e72cc780a6474179dcee5c061507735493953b8fa397f87478f0b975a3702aa63d80ad6b1306f81e99717881dc138eaa255cbc8038f2e5370d62dec16e191fa43350e9184140707b3c3dfec019178210cb93ea76eeb3684fcbbaedde048ae5ff2cdc0d7e2751316d6e8a9b0bb6e92487921b89e4e2e5bed5df14f9ad26a1b399583f6deceda1f7511714dc6eae814914b676a2667919e748eb2736fd0d95bd6851501b6f7712574a05624e753bd991abeb5753033e7f89a49cf09e759b07ba099af006932d96b046248a17821a56fd015867b1eb0db7d7ea050c4f341ff166e667c8d3d44ec73589ffc9c53b2d63d692362006472bae5556a41cc18ca72ae63b2eb7679e004ab061b19a7c0f16b2bbbe6b515c15908d7fb4170faaa74c5106de3b66b5ef9d3d9c06fffbd272e6269a49f8c9944fedffb68b5bc9387cfd3f8e66a888e8137c132eac69f30ae0aa766e8e011a5ed7fec48dc057607861d2a55160d853887010edc34682934cb77fdc4b234bacdd8aafc5298308928d6a24dad1b700c82a8ad5479b81ee08e3e9ef5722503c01b793fc7e890d80c4bdce276d97451344ec02aac1733b317727b7507153215fa6d78dd56eafcd776a9b19a8cf7746d4df1ee370ecd2eff6b47296b122816bcc656bc714d8071ceeb9f411154538eee07f6794b13777c71d3fa2e83d838f3abb6f8a52fbbb44ffaec38faf46fa226384220bcc2c45f2b23e0379e3f9aca96a6920b082f66a8348f484f622945bc54c2754c6cf95ada87ac13192fd16d377fa81bd25a7348a0d972e46ee0b7179a3261a231c97eeb2c5ebb2e4b03a3485d9590938d11723b6f37a5032511c065c65f56de9dd602cf4a184b6ddcf0c24ea93373cd80bda7893e89d47c8b4e96aef5d6a85aa415541d0ed2c9c42dbce408ac5d8ab74eda94904465075e79a5512ba3b29bd1fd13f7f1445b222b988adfcd333111fa9f0800bb0e35333b7349f871c8e38f9f6069fce2da5d6f0fdf51a476214b7e1f9cad6d2283a89c4866761c22ac63c96e734ed38e14bf717d6bed84f6f773e5ba0636508f41c0ac81332825cb209ae24604cf91ec3e07a8078087e2fe9316795c4cd7b56952d8976a9ab80fe8b36445af54a7d46580fbc63df42ff6351675b20b82100e0d066ab06fa894bb71ca26a93843c3a0ba0b74341208d0120c555b1c65b5caf3a09c1a20cba169139b32aeab0c748ee277e7bebc94833fef707a6d1170f113c848ee630315f1a40906c29f31c92e30046d910ab3948533051527cfe87ad9167b4c3f6cadc9f8fd7b5a89ea41a0c8ca884ecf248bdcb5f0bb9d54ef65681f06b70ee779ee3806adca6aa4a0b73f929ef0171e154481761e149f8ee0a2e75f8b5f12ec2f0eba58961a2f053f641fd32d0937a7806966e737ce6b977d3c2855438adc4dac5fda5a5a48edc71330f7a1b12b1e45dc2b0f1ad1f724d0e1c0861539b4855bf764f65721042b59914db303436ab36e38f3c54886eaebe17e4d21e9ec18a28797e1ec951f54817726dd485b9182eb1d39f54feb5cd70c5be8128ab726d9a0b4562faab032953295154aac9cba4fd2edf02032dc861642e3c08109bb4e673a563a5ffd477f56c8059f73afe389072fdde6fb5fa63d85b0a7f1a214201f3bec0adb86db02189510c82868c0b680b81f0fd6dc4fd4c09d0c2a5a32be632008dddbcdb153b8b2b743807801aadc958e2bef28f859991310fa0c907fdfd339aafa86b05885f0e0bc3447453667fffe8c05895681e9a4d3e4a839f346c2516b4e2f64b04654fd54b11408deab736ba64484018322f695ed9e14ea227aa1a2814a2b236fb069108d7daaa1c06a89226129d35ad0a66be3fee3a7e11cf4f60ce4f49873bdfffc3a0580083c62bc491cd7f661ce726646c733f7feb4db5045b1ab221cd5d052f90b1b8fc4c720224feae48001c2557bccadcba143521997980dc099e5e269dfd142d8cc00b2b69bb4647bb1f77e79a8ccc295d5f01cd340e99bbfcb84eb15f76513e592c9a3ce502b2ca48f044a0542848601ecac3f9c62bea9e2bf04bc90fc180771d8e8d0df028bd2b605e341035a5b119d3aadfb6ee7cb7f6e6552e8ce68f8884d9935f5df9e8ffa62101d1cae3e24549e7d32f32a9d5d01a433265ad0b39fe085778c2cf603f8dd4b1c5e2bdcc1632bd7dfb8c58f5e636984ac2a16d6859a6b3c0f2b41fb49e3f7c59dfa58786a2e7727533f42b855fe0a0eae9c197d230934f10bdcd80a6015d7c593658c8e3bb4aadc182dbc5cf8fd547d94d36fa56bbd80e4f64cdfc26967328679a4e607403596ab002ac63b56d6a3cd88f68406a0ce8c3efc0a142067ddcf5178a9e586ffbb786ca13fd0b901d5c0677869627756829aa55f3f6058c3e84df064dc16731709b70454ae3646a89a33aa8f424ad6650689fae694f28ba8ef1fa69d576c80304392c034b86893ce781a9e1cab5a6a838389185401661b71bcde94b626bcd5262406b8ee3274470844aa0acf80dcc11eb0fee3dcde8da2b55ee4a35b1d8d5591113a7adc00853c092889ad3be10e474cddc493821ec02b551f98fac80d5e9068c1eebaf76a8a710ea6ef9702dd71036cea779e9a435f1fb741b1d8aeb81898adb0cf89360a2ecac4f58375c7821ac41c68aa62c79bf659d7b5348b972d93afd6e1f3a768d2306ef62c1b0b13208cf37a7f3e92d8a8c14e9d0580a1e62e67ee8b06cbac6ad476516d3714fd8083ad33ba58b51d763019f4c6a7f801f57212be3dbd8d79670575f868245bef80a848c26625140cd514897237264552bea0a50b3c8d3452ceb2c022b3f306c85171e61ce1d0a925e407612f8fffa67f7eaba905246ba402f5f925e7282c568b285f161f619253892ff8f6876a01ad836971c8901730ca11f78c7ef9e672fe9b84774a5535b58c2b9708659eab738be4d8b97cfe6ae2f6956ec87377b30c9e72b1355dc2a011ecc0f61e133a7cebe9c5ea83cb56941583d9ca0cd19e3e6c5e0802e7111fe03b8348bd1fbb3869ed0290ab72a9cf6572f2af455069c784e72e9f14d1410e3966481b1dc7cc64133985e9f32c784364833e5518cd6aa56a6fe2450a62796727f9ae4466d363a4c98efafb9287dfae0c50238dada19272cc6757bd86ba4d800e46583f736669161458d29b6ba45fd74a79a6ee0388ebfba24bbbfc62fcaaf30b8d81d49acc1b4114c9051119d2603eec7e14c25d41a82fdd8c230d0522eed3822934e571b0e94bf21cf3fb1154dbb2ca0956fbc2c6663ef8f346f8","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"fe727b3ec2446f3e9140a7a09442f679"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
