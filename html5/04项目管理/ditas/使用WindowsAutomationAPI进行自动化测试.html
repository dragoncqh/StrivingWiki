<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="zh-cn"><head><meta charset="UTF-8"><meta name="copyright" content="(C) 版权 2024"><meta name="generator" content="DITA-OT"><meta name="description" content=""><title>使用Windows Automation API进行自动化测试</title><link rel="stylesheet" type="text/css" href="../../commonltr.css">
<link rel="stylesheet" type="text/css" href="../../common-extended.css"></head><body id="使用WindowsAutomationAPI进行自动化测试-E66DDBC6"><main role="main"><article role="article" aria-labelledby="ariaid-title1">
<h1 class="title topictitle1" id="ariaid-title1">使用Windows Automation API进行自动化测试</h1>


<div class="body taskbody"><p class="shortdesc"></p>
<section class="section prereq"></section>
<section class="section context"></section>
<section><ol class="ol steps"><li class="li step stepexpand"><span class="ph cmd"></span><br></li><li class="li step stepexpand"><span class="ph cmd"></span><br></li><li class="li step stepexpand"><span class="ph cmd"></span><br></li><li class="li step stepexpand"><span class="ph cmd"></span><br></li><li class="li step stepexpand"><span class="ph cmd"></span><br></li><li class="li step stepexpand"><span class="ph cmd"></span><br></li><li class="li step stepexpand"><span class="ph cmd"></span><br></li><li class="li step stepexpand"><span class="ph cmd"></span><br></li><li class="li step stepexpand"><span class="ph cmd">FAQ：</span>
<div class="itemgroup info"> <ol class="ol" type="a">
<li class="li"><p class="p">Q：如果出现一些控件枚举不完整的异常。如<a class="xref" href="https://stackoverflow.com/questions/25351277/using-iaccessible-with-google-chrome-returns-incomplete-tree" target="_blank" rel="external noopener">Using IAccessible with Google Chrome returns incomplete
tree</a> </p><p class="p">A：查看是否忘了使用CoInitialize()导致工作异常。</p></li>
</ol></div>
</li></ol></section>
<section class="section result"></section>
<section class="example"><h2 class="title sectiontitle">参见</h2><ol class="ol">
<li class="li"><p class="p"><a class="xref" href="http://www.vckbase.com/module/articleContent.php?id=651" target="_blank" rel="external noopener">MS Active Accessibility 接口技术编程尝试</a> </p></li>
<li class="li"><p class="p"><a class="xref" href="https://www.cnblogs.com/GnagWang/archive/2010/04/20/1716006.html" target="_blank" rel="external noopener">MSAA简介</a>，<a class="xref" href="https://www.cnblogs.com/GnagWang/archive/2010/04/20/1716440.html" target="_blank" rel="external noopener">IAccessible ( 一 )</a>，<a class="xref" href="https://www.cnblogs.com/GnagWang/archive/2010/04/20/1716449.html" target="_blank" rel="external noopener">IAccessible ( 二 )</a>，<a class="xref" href="https://www.cnblogs.com/GnagWang/archive/2010/06/05/1752174.html" target="_blank" rel="external noopener">试玩C++ 操作页面控件</a></p></li>
<li class="li"><a class="xref" href="https://www.codemag.com/Article/0810112/Writing-a-UI-Automation-Provider-for-a-Win32-based-Custom-Control" target="_blank" rel="external noopener">Writing a UI Automation Provider for a Win32-based
Custom Control</a></li>
<li class="li"><p class="p"><a class="xref" href="https://www.codeproject.com/Articles/34998/MS-Office-OLE-Automation-Using-C" target="_blank" rel="external noopener">MS Office OLE Automation Using C++ - CodeProject</a></p></li>
<li class="li"><p class="p"><a class="xref" href="https://www.codeproject.com/Articles/10886/How-to-use-Managed-C-to-Automate-Excel" target="_blank" rel="external noopener">How to use Managed C++ to Automate Excel - CodeProject</a></p></li>
<li class="li"><p class="p"><a class="xref" href="https://www.codeproject.com/articles/141842/automate-your-ui-using-microsoft-automation-framew" target="_blank" rel="external noopener">Automate your UI using Microsoft Automation Framework</a></p></li>
<li class="li"><p class="p"><a class="xref" href="https://www.codeproject.com/articles/38906/ui-automation-using-microsoft-active-accessibility" target="_blank" rel="external noopener">UI Automation Using Microsoft Active Accessibility
(MSAA)</a></p></li>
<li class="li"><p class="p">Search Results</p><p class="p">Web results</p><p class="p"><a class="xref" href="https://www.codemag.com/article/0810122/Creating-UI-Automation-Client-Applications" target="_blank" rel="external noopener">Creating UI Automation Client Applications</a> </p></li>
<li class="li"><p class="p"><a class="xref" href="https://www.cnblogs.com/baihuitestsoftware/articles/9047705.html" target="_blank" rel="external noopener">c# UI Automation零基础入门 - 1</a></p></li>
<li class="li"><p class="p"><a class="xref" href="https://www.cnblogs.com/Yinkaisheng/p/3444132.html" target="_blank" rel="external noopener">开源自己用python封装的一个Windows GUI(UI Automation)自动化工具，支持MFC,Windows
Forms,WPF,Metro,Qt</a>：<a class="xref" href="https://github.com/yinkaisheng" target="_blank" rel="external noopener">yinkaisheng</a>/<a class="xref" href="https://github.com/yinkaisheng/UIAutomationClient" target="_blank" rel="external noopener"><strong class="ph b">UIAutomationClient</strong></a></p></li>
<li class="li"><p class="p"><a class="xref" href="https://www.cnblogs.com/SadlyCodes/p/3472406.html" target="_blank" rel="external noopener">基于IAccessible接口的QQ窗口信息获取的实现</a></p></li>
<li class="li"><p class="p"><a class="xref" href="https://github.com/billagee/test-polyglot" target="_blank" rel="external noopener">test-polyglot</a>/<a class="xref" href="https://github.com/billagee/test-polyglot/tree/master/printDesktopUiaElementName" target="_blank" rel="external noopener">printDesktopUiaElementName</a>：<a class="xref" href="http://www.guihelper.com/download/" target="_blank" rel="external noopener">有爱UI助手.net
DLL库下载</a></p></li>
<li class="li"><p class="p"><a class="xref" href="https://www.cnblogs.com/wxxweb/archive/2012/01/09/2317094.html" target="_blank" rel="external noopener">从FireFox中抓取当前网页内容</a>：</p><p class="p">《<a class="xref" href="https://developer.mozilla.org/en/Accessibility/AT-APIs/MSAA/Interfaces" target="_blank" rel="external noopener">Supported MSAA Interfaces</a>》：讲了对Gecko做了映射，以支持MSAA接口。</p><p class="p">《<a class="xref" href="https://developer.mozilla.org/en/Accessibility/AT-APIs/ImplementationFeatures/MSAA" target="_blank" rel="external noopener">MSAA Implementation Features</a>》：讲如何如何获取网页文档信息，但不全是我们想要的，我们要做的是通过HWND的到当前标签页的网页文档信息。</p><p class="p">《<a class="xref" href="https://developer.mozilla.org/en/Accessibility/AT-APIs/MSAA/FindWindow" target="_blank" rel="external noopener">Find the Window and Load the Document</a>》：告诉我们FireFox将变成一个单窗口的应用程序。最终查找顶层UI窗口并加载网页文档（ISimpleDOMDocument）的唯一方法是使用“accessible
relation&nbsp;<a class="xref" href="https://developer.mozilla.org/en/Accessibility/AT-APIs/MSAA/FindWindow#Accessible_Relations_are_Supported" target="_blank" rel="external noopener">NAVRELATION_EMBEDS</a>”。我使用SPY++查看FireFox9的窗口时确实如此，只有主界面一个窗口，窗口类为MozillaWindowClass。这篇文章修改日期是“<a class="xref" href="https://developer.mozilla.org/index.php?title=en/Accessibility/AT-APIs/MSAA/FindWindow&amp;action=history" target="_blank" rel="external noopener">20:42, 4 Mar 2008</a>”，因此这个方法在很早的版本中就已经采用了，可是文中资料却鲜有提及。</p><p class="p">《<a class="xref" href="https://developer.mozilla.org/en/Accessibility/AT-APIs/MSAA/Relations" target="_blank" rel="external noopener">MSAA Relations</a>》：定义了上面提到的<a class="xref" href="https://developer.mozilla.org/en/Accessibility/AT-APIs/MSAA/FindWindow#Accessible_Relations_are_Supported" target="_blank" rel="external noopener">NAVRELATION_EMBEDS</a>的值。</p></li>
<li class="li"><p class="p"><a class="xref" href="https://blog.csdn.net/gzlaiyonghao/article/details/816515" target="_blank" rel="external noopener">获取IE和Gecko内核的浏览器的网页内容的demo</a>：<a class="xref" href="http://www.360doc.com/content/12/1224/15/9200790_256030004.shtml" target="_blank" rel="external noopener">基于IE和Gecko内核的网页内容获取与分析研究</a></p></li>
<li class="li"><p class="p"><a class="xref" href="https://stackoverflow.com/questions/27323110/msaa-finds-controls-ui-automation-doesnt" target="_blank" rel="external noopener">MSAA finds controls UI Automation doesn't</a> </p></li>
</ol></section>
<section class="section postreq"></section>
</div>
<nav role="navigation" class="related-links"><ul class="ullinks"><li class="link ulchildlink"><strong><a href="WindowsAutomationAPI%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95.html">Windows Automation API自动化测试</a></strong><br></li></ul><div class="familylinks"><div class="parentlink"><strong>父主题：</strong> <a class="link" href="%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95.html">软件测试</a></div></div></nav></article></main></body></html>