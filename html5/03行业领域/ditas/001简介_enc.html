<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"c5efb340fa41708a4c67dac1bc4bbe75b907e1fbbd38586cbc1fdad9f1c12bbd77784af5984a22f1beee52c727cbdc7940fafc927c1a7afb70187744ff3d587d56af26b35a32afc3f482154352327d0026a104e20256c42ad7bb4389a7061697a8cec7153d4857185601f820de708429115e4d572650f45e40f66b841d5790d2c0ded2fb9a7b4374ccce59b1f8eba536fdc8050076555f88a7bbb5ec2e653519519255bbb16b3ea1e5cb0add932d4af3b2d4540e8e3dfb61c399b520f914956870770d237cd87b1ae4444cffb078a4d71841c929144ee115ea2209deabf4ae8043e5eff305e8618b431be930d2e7f3450d00fa7370e1d7471009f693aeac89a2db7ecbab51f75455fb116579fd57ea40c179d83b57b160a28bb6440631c760fe0e8ca7d6b52dbdab3f7f9dd50e023811280e53d1c87c11e18b9b480a449cc58f51af0cf160d1896e778520fc5eb636716a95ac66316b5a1df4949280c76cb4a1840656aff242e95385cc97ceaedd07d76527c1f679f9a49408349dbf1025bf57324824d99dd0b89078bb6bce8a8bd98c706423e11a788171fedd7d420230cfff5f32649c20a57570bc12ad36e34b10daaa7d9980a0baffd8330f1734e0f9aed1e4af985001abb1268ee7b1a9d38fe6555df42c4f0445dd0e6201fb2d3b0401c0a475e4bfe7dadeea245d30b453f60fa3fc0864dd02b1fa997f47d5ba12ce9f292c2da7d3bf30b4c27197c0e9a1ef7cf4e1255236e4c66042adad3f7a0c8138384d2bfcd4cf6dec203c1167595fb197321d7aa26bf90af94e38b1bc3fd64ded0776600015efc659dd343c5cf710de8ca079dead164fe93211e15f345c923c163669c9049d0702e8a4667a0c31490edcf204fec273831e08b132a2da9962ba4ebf4ce4412aeee834e739308d7455cd639086eb4292af9b596dd638a6072f7881b5b8a9a6a1269078bdc021abc349b807ba6cce51f4d3b255db38683af04e0fe4ab27bad8549d57149f4da371d741eb7b55e5f6d95dd0220102419e2b82df2c185d42d84418530a9ce7fc27736cb8ec78f93c0006a92e8b8a4bacf03c1a4d237aeb582495db08d39a83093e9c6339fe582e995597575d60bbc1d17a0f8fa179bf04d8c39d09d1243b22db3fa482201599e2ea3a85e15b9e8c12723df47768ba54464936192f012f6a393bcc2e98a62cd0ccd43636c329597e7b86eee97c47ad60d13233918fb4c49763d528a314b21fed1a5ceb9ccacceb867dfa7ec027250e1ddc93491de0da3e6802dc0d160d138e3009e550ab5a44f2a6e8a7ce19a230aa59f1b0f0eddc7c8e81edfe2a420a631e1d154d2fa25d3290f91ac7b00bbec41d54724c89acc24f91094a55e630df66b7167eb6dec7b21df000ff11e99bc2cbd65d99d113339d4384f8957a39f9ea5762cc54d320a495479ea3f71ade89c588806621609628c5a4570fe203fe5c566fa37fbf794fabd04ddf4a717485d73b3904534d15aecc067f4ea0bcf4d6b2088276f6a0ce23093dcb7f0f743f9ea840db616bad6c6a21190f5f6466f2d7f202a1abccc000f1cdfea98e69a82e4a81c22dd2bb5829308591c4d4e5cb9054923744612759d65f8392ef4a620976ef83d828d6e6eb04571887bc67095cc6a440e5cd3293385326558975c2bcf7f78efe77b071b48834fb82b20db76450573cb3d4d111ec4115b9458e360e67a62e9e732ebdbeba9a6da9bf8bc6a4102b840642987b9a6987e75c1380193fe7408cf3e8a9a08ab707760df7e82fc94d5aed49430b7bbe6bf6db07bb89b4e9b34cefb51bcd9659973cc8a0d34a58fb8b9502bd0f47e6032587c90157985f92498bf01b8838a445302364f4842fca17bb34076828d70001cfbc5f7120716f9fb1fdeca08a83f497ec94ddefe98b975ee53dc19740afa4580246448ebb3e23a9139ab711dadcfae8129a9a097e41cb13deb26d613dfc84c74b50d6ba531372126a1cee42a5b6571b1ca67332e0e64664c7c2488ab8386312b1e24ab17422fb0c7ab8c341805e73ea3b07e0c1ccb4081c7ecab07f0d08a1362da7692087ff6cf722e86005507e63f9cb44406fcec7d4102f60d5d2b4a8d62bbd46fab889e183bc706dc437e167717cd1dee016e57e81398c2b627ad9d0f3d8be83641cc76c6388d664f7a11c443571c901104dbdbeb7f89e526f7d09560e7c53b7ecee2b0f8361e4dadd5d7c508a9425a8469540032e45a954e05fff07d8e0ab55f8e35f43f4bfb3217531adf4758106a4a56a706c2e93a29bc7a6c336895c047b87001657bdd24ad9cfe78e840b92d51c1f0f966347a9d08a93986b49678ee0a8e2072d148319bbd3f23b8bf9cf8ce91f27f99144a613277156c9152b490e59e16e1c251d0d065be14573cdd9b8ea79e260c1f303c97afbabd5d79049f5fa1a3cb1078671b86f723da8ffcc20804aedc65d33df810cbf6148c1b63fc6b09c0b6977e6bd2038f0439060ea93110a751f17d002c200a443ca0874c290d601b89faa3cb059dd43a5c45fad56449276ef3bb66b81fc6ca70f37a55ca092825bb383c4b442b58165b6074da1e373b9946d8641b9b92437de9a4a76cffc7b8030d74bb996dd1fe50366e02749c66b6b4e7d0d2923f68c70c7595875426a5b3177dd15e05b0f3b56ad298a5eff20afedf4f5dd7837d3c242d71819f0023813e87d260f6a94c13b5c3081225e5d88996c9aa2053481222879b12c2028e9632a9431ac56546304028c5996a441a50c9384e51ecd1847a3743a5c11147666f85df6826d6faa27c6e01b25f1fed27eee05a144d0d0578123523be2812ad603f2df853d5c36923ede047105aab48aca3f4966f487df85214f7cb3e0675d3ae7f8c0897df192ec7a71740a4e8221dca0e67e06269b77efddd64a0d093c1a8eff26364338b956b6f7e22e6fd92675f9cf039cd2f20528dc15ed86a340c4b6886067f09413d5f26d7c41fb777d3e8d47aa41caa9600377efae420e453276aa6f41b7ce35d23c075e00cda7a7191419f352c5a7c080522123f56c0910fd4592e2a05b302b67b789826c3d65bfa73b02e6980c2479c4c0509a54f3dfe6c1d8e2fa0b5bc92cb85c1cecf6327655d365459f095de9f1fedfe60b4c129e37015bed80002f97b26d9b2dc1d6baa475425b61de2b92d7cb33b381434fb045e1116e7d8ed362b544e01487671596af8476a256460f25ac97c1a9f16e9b43222e0ee64ea530467d33d6e8b6bcfb43fe74773b67a19ece3176b7055fb83055d8649119cb5f320c19b7a6f33d797b24e4f0509707b4d43c6b1a8f514c5945fb3a11e4cb337d8e46e0d2fc78eb864c7770b06ff733f30c3b30e61a3c9274f3e8d5de1bd40dcf674067e27f22ac97c072ccc64b1308b91dc4a01d99280b3f4773edabfb61f1a3d94ffd613a538886afeb43ef2768ef32d9f4eddb26f90da5d64034d66645f61ed90b0cdef5582df0932f028953511615623efeb68622b87db5a9029ed2093100a77d7002b56cc618014408ef9d3e7b5d92a53bd2eeb23f8671b4d433c2e12aa63a626ea7e9a0483a1d976fefe65e189a0d91d14c719f81e199c5767d4c898b4f268c61bf2ef875b1c2246ffef292488e1eafe85fb3cd5071c73bb77a23de1aa98703596f855f2c2711e37d020352ccd1806f660d9c6deaf0bafe7f50e33e29c481c7e0cf421101fabbd7d182d3314ad510dac1390eeafa5d8c7f251faa94335dde6398727ee76f865da3addc76fb509fc9eb8639831480caa66090d9e35db99563cc1d73e48643dc2896e48c2c97426d9be4ce3063bf0ff5965282cc6b48fd3cd66c88b018c6f7109a3470352c72c43cba6434c5eec11b05cd25729bc17a593277e42550ac9c48e0eb841f5bf97e9c9aee5f110f6107ca8dff26f9f877dc90f49cc162272b6a462ed9c8fd59a94d61643bb0bfe0c8936d7ecc114fbb93ead9db99e597f216b9d9ce927bae514ecc99399264f94bf8249b7df6cb44d7f426608af0129e29e375441cdf3bae45f1e06ece60f137abfea1ca6b788706d49e59e1ecb55e9dd0728706a1b0296be2dc0b7fd1c0477d6d8b268f0ba7cae8d650a81a0ae448675f57aaaa90de4fbf14d975bf3a50e710f4de7224e7c50dc775a754b49fe75f86ad51460778db680a3b775d775678369303e833a28ee6450d70ccb3e488edb094c33c23cec1922e70023964dd856f09da30875564d15b607ffae1b6575300027d64b5322a35b3268413e41e40ca03f5aa44aeaf103215369d77643f473c9d14a237d303ff08d567f0e944bcd2eedde275c6c4e5cb76fc249d6134ee85f91fc029ccd9801d1f3e6df57c7f5d075643cf770bc05a94574e0d120e5ae63bd9245c1dd99c2114f1830d89c379e0eb191f6e1dec09a10548f70b9c087010c3c1a2abdf4c604069bfb8fb4c0a4c2c9a87e43d437fdf148a8f6e28e26af43419fa47edecf525b24fa6266ba355578aea0e6d3fa31c07e65a8db941f8408d9c1269bd77a25b68e7225c694619a0778f6a2ce1c4c68bf420217d2b0baaacc1611af2fa86b9627c77f4dd59befa741514453d7a20946e12ac95a8011798825de065ee89424812c5d12898a42c50f4a84e0d0963635b507db32467149eb6810a2bac728947c2857efefed233f12448e793994171205a2a5110da0a322297add7232bde3776866c7cdf86f0c2ef6c77c5c2d61d741c70d86c5f1fa7ca4a7b401e9b5e873daaf0b8c52dd18a859cc286b11eccdfbd8756566efb56d3681ce981e768ada197a12ab9ab6298129ca578d7ef4dfc3aec151f7e3c49ff890eed71ad8472ab939b14bb7442e5a04338c31c35056eb65346d02da9017b4d9fa71c9ab626031bad581351cbd2ebe566af65d6d253719ed2930c323eaca197fbc6f5823a129e00639163e4d2d4bfc190e43c6c0f406b7a4c3844e58641f8207d8a07534f6962c9bef7b8d2608183a0146d92b3277fce3652704fd987e3be9d36af08870346790505437dd3ab136d7041d6e60a6586e0198c27ec367861c645b559ee4890dfdcf9fcad6df8fca68feabb5da988aa2670dc1dba3c137fe4997f7659d55f9731f1d66875e56a35773652be33a87cd5043554b2cc016ceb6e477c511c1c0fc0a06d27a16b5f64fc0c43505e0433d66a5b7447a5b9177165b6e8d69fcabbc52c15783501b1453a19db88b9127baba9259f0d64b073771f9311869423605ed094ce8221514ae250756d6dc72d7a5330bddbfb4853ad97a099448a41012f9e62867ee4a0dd607c8d3fb48bb500ac5e5422b90605b2fa9aba10e7c7225446b5e54079bcbf025b20cdf50cc9255006e328635b2ebdf40515649e1600422327aed9b3d46cbf7af35f01e8ebbe6dd7e6dde02506f506cc3159416d880613a79262c53253280b8445231cb8f47e75b96b0f2d42155766cc047658154b406e9a591e95319bcdde78d036a71d98d6ff102a1c1b972803b6e373e0bde394ad9e1be2e22e110a01a225d40b24d158531b41274853b38a1264f32e4acf02d838a9a8624b719a913ad3222d6d8c7327827242e9a9088f91768d923398392bf3479308756f980104a64031dcf0bc97e59db66f57cd2e5ed5fce42ac63ab710493701994174d3e249f18128e991d190a45d3bc046193659b9fa6838e57477ab86a1c995dfd93a26fa87d03cd30a7d3f5abf9be564686498ada16a49b608661d705a22f4949876b117425e43b728ff701deb29112dd310c4734454e95ff5b9ac9db21cb8a79ecabc9e38939c5bc41b63bbb5162d03c867dd0f061fdddcf9b79a96a4c818bd52f37ce6783cc887a87f27c1fd40148363b7f2fc08b3d69127ebf51e58e98c7ce2af2cbca17656b5d88f7f35776affe45552a26bf0c29445f07d81d9d099342e41c8df0ec1c6a78d9f6d9f58dcb6f316552ba2bd518037ce59970b75a25639bfde32ade09d4327deefa14326adab6b2586cdd0c24b1afa967446ad5f7a51eb5b01a7fc9201475a5e19ff10f045a59c31316dedc4089d0fb3932c4d0947bcdb9fcd54d57da2b5c55a2d277f083566cdef671fedef77792b79927fddcd321804c1b73b6c0407ad9ba5ed55fae8656ff1cf9a311d0952d7a1adf0e4b0b80173305c1ea1d8d5d3b372d1ca0c5eb5512c7e5145d8489aba0cf58bfbabb35feaccf95a80b1c47511714427bbe3fc2db6fea8b13db7f0a6a0d5fe1e315d8349a99cb59f3abf6a29923623d1f7a4258c89848622324a97e22d51b4a9204cae28f177d87587baa36b75633d83eaa0ad39f4c121b0479df29d1fef6c73418f14ba1b486ef2bf651fc82f1ed0dff4aeea2a871f3a478a2e672b79cacf3d0df677dc699f65de2b448658da3bf13d88c1008e3a730154375d1dc4f7d4206f6e88638cef5c1cba977b1c34ba8d564e0eb89e177c124d7341fd23d80557c2cec16435cbc748d8808a0ff182ee9e8edfbc62bc020addeff0995f190812bfab4ccbe3d9a95cbf53afd6161b61f28820678065c358b87766544f25385d085b70ce7342139c765f8f568cc291a68a1760199378aceea04e418fd997a724d62128e886b76ffe0f505d1d050c6aafbad1f1283f027b3d17f7fd1327bc3b78c2c1c99e30231b915add8376bad7b7967529ff3c892bb46962eb3431b8905ce69399ea6cbe0d5975e6d3414fb38c91d3747a2e4983fe8da2109c956e300f983ebc932ecc723308668144bdbc0c3b1b50cb2ce18294033e54c8cc00d521e6909343e067e6ef148f0c24396ee64b4844d1480204bc23898413a4273ae53f3232df9680ada8de351941bef3751ec84aad79c9b2e963555884132696d7371e1a3af865e7b6bf46ab80783188797e1a57bbadcc26f070dac941618b5349226ab56539660f1ec1e6a3b4bd7585990d71892db6de863af5ec3b2cdea798b67a2c581d53d98f4c07b2c0e821e6db002b5b778eec43448d298b60b0b46d9d6da2ae3f21c23453b03cad6c0d85d77e3d792bafd6124f775bf2da32fc8c31a6b8948574edc59dd7b5f73d03c639e67526b04e3b646589f22ce8e3492d9a311be70f095b433ccc43967cf3aa85ccfe7548b4bb405e8f143c7b0ad610ccc6753aba9e1b64859585f75c32effe4dba6ffc8277eba3f9e73c9df9e02be9a94b4be12db5f5c4c6f779c8b0c1d15c51b1e3967d5240d7714eb9a523fa41bf7e987636f60d04db84ac92c7b85430d25428c1cb92d8317b8c60d5302805da9818d1e9d26f1ab5a58eedf5bd18d70f49eb21a24779e9183c293c20e6e39a2cefeb4a171f7b00ea070b3ac0230bf25d87cf751ca46678e7a905140b82c602440967ac0a5515b42308e49f7b4e9e7c716d76c20b01ebb17e4e54a8655b46e776b2a794b26265c058f68d6b36f463269d1a428a6edce33e58fdcfcd97edfe5232fc30a77f51665fb7b21df9c41e0802f20782e61c67e318d0228993337b903057fd2e13e1e4676cbef7af11870002ef0857739b9d91c1a1f3187be66d64d29a4ac2ab8ab0a2006b736ed18a4bfe4e1cbe7a57e5f50430bfbb2514f508578cf596730d5c6081811207a5c1433fd5d23cf7d2217ad7e9f90a6786bb80136b83ac035d325ed566afd5458d1d28bd4518fbe9d6edd8dee4cbee7d0055d65a054aefc66521e54553c41fdbcf1cff4678f50a8bbbcb330f5b13ff79061b7f434238f242f66c4bce466d26d3850265ec635cca7c4da5cf86416e831d0aca5052872bb047688eafddf996edac86a95319afbd796ed66378ed64a7fcf64f3ee1a2519a982d58a990958b44c4d50826c249427fee3b0f7c182937daf484ff669faf14743ee0198359cab7f28f5a538b7ffbbf58ba1c27cafa1a86648e7f6ebd6dcccc75213e63ae42d98e7bb933b825ff7cf1d6dc4e6c5a31f7878283efe06fd5a7dfc150c1e7cb41ecbded0b026257444814273202f075e1e2127b4b22e997140070802e3d50f7830521dd2f95b9c863fe27b48f52adcb085afa457031f61f65515283bd7e5859d0f6a0a54632c2c357692ac40890dbe36fb54a4c75c86aad99020b75000dc104810e2aae829d43b024ccb4f7f39097b2bc2b87d08549222cb28609a040ccaecb4d9026cb10a51dbfe53b99231227a1c3e4cbe01d37cce31959c11e4e66b8a90f88bdc5014fa72724cd01fb2245fec606ecbd2f744937ccb429dc0b5258b1cf5fe81fe2a81cfd3df036739183ba023d5e1e589a8f49e6479bc61cd7b48bb7cf4818126b74c0d081bf944fc25bfa81c9c0a0d90a861c206c13e170c7c73ec52a3e6707561aeb4a2500e872710595ba81fbee15c55c5984f68972fee65c260b09e978ee377477a56e6e0c34f42febe018a86a6bda274ba712b239b70153a77d79876b3693585257257cd787093fa0000835be041091fa408a8068eb1ee78c2b43f8bf1adde02cdb8cc164cd9c13335d44f6c393ff082e8eb4a939df06300322f7707af067ce25dd334bfaa34774c71d11024000d5a11f29d668635c36658bef72ca49c52977f02938d7131308479a55c638c5b2ab0fbd3fc5b76b6ed484758d4c11342590c52ba7362e9313330df461e2ec5e78891f37c93fc5ff7b225c77e346942d47068bc94cf63263afce9925a82f7f98eea70065d3480dd45e7289ad865b940c874a5e602c215656e0e05bfecb7be1baa666383cd1d74df60b9d0eb5c7911b1ded728e38c22247016e46c62e9bd146098bf3f73074a009cc22744a0465f12a5a5c35e1ea592c16b6850e07c10d9703f6046d2485aa3612310a039020bfda9b2714479396ac14a5e01f763a81fde84d2b63c8493b0a868e6d2a2e8e9901753b19f50c6bf6ccaed5a584612d511f3634b5dcb51db69ee65c9640c314c5d27fe37d9003a6fe114e08dacce03fbe5fc37442d5833296e2e699587d3ce40f52be07581fbc2ae715148f6eabfa24c029af44cf918329e2fd5ad7b37f95eafb5d79b582a819fe6ee9ec791efb2f270258763eaa9fdc773a6b3269e7ae0073c532f8bd5d5cf54259e177a79fb7116dd634994ccaf0041d262f54d4cdd15d6a91c498fd40c6356524051bc490b5c3ec7b0a81622f3cb94ccc51adf1f3e2b3afa3dbfe452f8049de957fa3cdfbee64aaf168fed31546fd4204eaf3ede967a89867668a5ecc053e8382f76dc1dbdfb41b76bff350525a37ce82fddc262545b802134b751873488161976833df6268fd674dd865024455f7fb5c87ce654ce8b357a96a60c64c48c89f33c53a851d89f8f65cc6b359526a0ea771bf2a14ff2426f062418d24930f1cf3134c310df0b442f3fc5a0f6325ad573291515f3b2602cf45f266ca66cd04626cb94b5cbaab43ff58cc0eb5ffb28e61acdecd6960522c54f7e81442ebe861a754b2de3b0467283a056dd431dfacc7794d4de3e4fda0a289590dbfaf2824ca105f0bd35eeaf53f3dea29ac7a64c65e85e45ccbd5928b8fdf412e11033b63e101118c957a7fec9745dc242bafc832bc9a2b5f28f322e1c9f0255a42932a9edcc03df8a50dccaed3db33a923e194fbe6fee353d2b94dcd99ce7b6cd2c44f84173270ddb72f76fe821e38bac49274db7ba25f8fb5895530a1bbc70671f13b8fd8e09ce28497a3dd4c69af4822ede2f624e7db66767a70b3a3f25d63a63d633f6a3d62881f9e4e0061c882d3c3226ac6b1d9501cbc123dd6b99fffc8209da4aa97328f7dbece557df139be66e9cd508816f707f38a229cca55e51d08bbca2f6738449f75a83a788e917078ab6cf359f5504ad8b5bd4b361480abdc0d519d781c7839e62a50b287e746dfe0aa9ebb2a33167d5579b6d47f599ee0855617e6c0a6ac07b3c613114952461e33ade48d1aa9543ac650126b797e163b7ba19a632edcd1ad80342fb5df1ad91e461fe4ccf3ffe0a97963a7fc79a7d3d157773c58bae959ebf280f04834ff1bd6d6afb1ef56afb7fc1a6f30b420de0c0b12fffad73b5c6a42061675ba66a0e5aec45a9feb89502789c45c0fbc560cccb6e6b8fd88ec81d30c53b33cf9e9183af01252c58caaae3d9a1fc68fae16f5b295789a1677a50c0f61e4d9f1d3aee55091e4dd43a2173dcaf67d065fe418b3b9318ea5a289a970f3fbfacaf377ce5e56a2609c38e551a824ac7acc559618e947f666ef761ff05c7baa9770e723e8c3e7ca78365d26605f19c4c982fb0f79bb5392b1c81cd7d53ecca8ec269bfb41fd920f09f5fb276e1bc6504e0d89604f7b1077cada2592fe6658ed8870eb14f2da0cd66449e39ea271a0036d987f52086ec31da39a90fd4bd504d9e324fab0865a587e50ed3ace74674abe2e107a62f3014657b89b35e6e83b266bdd5b485899948c0d9e56571588d7dc0d594057475c9b7e1ec860e0b53c36c9c6ea88b192a6f6f213a677b176037dd596b4b2fd4959e8ada19fbf4d092d3c454ea8657aba82c3a7658b2776140053a5061ddeebed6a1dd43a3bd0528fb0745b56b12def501639fa1a44795564cd509f99c328be4093b7dd644f4d15d4673bf8815bd50126d31d41972199296ee420f2f898234ff7df8bf1d495d72a6fef6aaf3f4ba60d62e3e21f01704e3189d69b1c75c887e5006d35d42616fe2a63383d5d47f01f9f2acb3dcf4b1fd4aa1329783bfb8b4b38efbedf5b029a87f591ff996d1c6eb06b057099485d809af923e44f915631d005657aba3f74fcc470f7f33e7b30a0aa2b015993461c0a1e6ce60703ca6172f688521a049bd44a20a02c71fe8eefe96101af8fe03b0ea89a850b8b7385d75e868923072cd8bda2597ed42b93624604731b2aa7e5de829f60d3b678fa9cccf47193d65fcaeb8a41b039f36cfab6c5290a5bf978ff2c576181dcaa20cb732f9b3210a2a12fe8b5a2096e4895dfb2664fc082e27aeaf8eab2d506a4b634407dbb89b24be52227d1d6174830a35c223141694426013172f58dd714f45a4ad32f79b35578203b40e728706d26e9a78f3d26beb1bd10d9c3d31e2ec93dd087c061f3f535b7abb20b6b7947370c266ce3e882951c9cfea284404aed4d44e1c3f7a6287cfe0e4975b039f6de725d5e5c04291d29d4c81f66ca08975245608fc0326aeed326f33886a9b9c117fe2ed32c4c178970ababb7da2f85f9d55e51ab58dccbed177ef69ce99816f63c2f34e44856e604e1ff91b51db7b9337c999a5da2700635ec27d3fa6f9166e9af331e170c2685fe5f0294b24a3dccb3a47f30949d83cd995d22e4c78cb8c95fa913d185c70b9f7619534e605fba524a36935d789ce323f40829d91f9713bd39f5d37d68cea241b67a96bebbaacb46b4193fb1d75bd5618306862a475d7bc7395b0092be0dc21d4c321e9c2768ae35aa69145f7ec0d1a130fb49fe6ab891a930b7b29823c5883635b4a04f00c565f7e201b9b208d1a0fd8fc8df1562362212a332b882e7b038689faf303f61bed109d5fa636183286c1d2efd352a8eb5484e97b01226690b0e2cdbe77579d7308d3b2932ab164f8163530175cd0e1353612160553599fd054c58412867c57c88b032203d4c771900ab6f38e9cf55b7e4da01eb4d7a861400b38c69b976341ea8ea23fa6aaaa75de7fe2ae8121f38456c20b506f49ad1a4d0a1dd4c3c86acf31868aaa66b37ab8d46401ac4b7aaaa6d13236d302718249c6e6ce42fbee48f98234499e4f6b5315b5c58138ac1821f765b824e29457578b045bc1e96bddb149cef7bb6071c62b8079b09e3272dd496fee8005e5fe78400e8ff2dcb2233bb14a29be511c1120559e5ab98615e66b01eff5ac010d9b0e46cffb46094568b839cdd21546ea76668b05f477e5763e4b7fdcb7059c808cd641a16e5397597f9b26dbddf2de3e7672d6cb26fb2194464d64dd55f922a1a0cb4e9807cf302193753a7df023ada3d4af822b545b36daeb85924d00e3469a3cda870040b7b17c59e67a90f6abf356afa1948ceb28d21c40fcbaf883158b66656c1f0e8b26ac53796db60eec0476cddcd4fce1661eef36241c3403f0bc5e7713ad05333967f60587021e704b9f90d31934d80124c2c45c2ce6eb9fb31744953f0bac3c5171303bc5a2790fe87a4166a302bb463461f3425fd2657ddb5e7faa5a1084869dd8334d4b62f3444b08889583b9b11bb45c017fe33f049d7e527b8331937ed4bb0bb44135b4287c06b885e0d9d11b8a09bd697ae3690a6268b28d0f18118e99008ee7133a09568a129df9aa90227bf5837e6e6bc236f643a828208e2465d7584c173948621d6b7cd9b5e2738651c84a023e920c7fa6abfb0cc92a72dc7a298bd58d4ae72fa66c2f8349adbe2862a95b67b400e69193ef2998def9a4bc6f1cdd6ac8d8dcfdfc08ee914478aa7deadc03a65bfbaba0707d7517883825609cb647723f5f54a3ea3f75260f6c230911a05b43e77917b45f7a6ab1fd52b306009fd528a7446f49c04ec651ebea2754de74b23a24057aa608358d45442b08608bfafc6663ab5ccf1d568290abc83db1b41c1655de4fbda351c842c318f51f2172770f5d618a9d4a59ebed95160bb9914fd45061ade689cab5077ca92408715ddf8af41dded4a3641deba26df5fe96a7a53907e22be715a1c88a28017ec124897e75685ecab61b5db0e81ce43d18cc89388b9577b391cb5ed3e8aea2894ca5a67549045f3d061c4f850129191e3d612e12566bf5986f3076b3c66a0fd1202334afdd245463c2ec3fc2311a73aea12d7a23ab0619b113609e32355f7794f9da07448dc034359243e589b587c21928d9c7f639f19f7ce1ec1f94f6af39919b6cbe6f5d55a3291aa098e2ed619f7e5c7d184246075bc0a433a464c32e8935678ec30fe1ef6b89afc1a657f96e80423dd8858443eeb023968f85e6881feac2afe1e162025716ca04be212e3d04dfd2f7125afc689a86fddf1a9993db933c1eaa1d7b3ddfcfc3c9f8cb1f3b36914061128caa26500a390b1a329efb5cf2546c784999630d433e21449013a9134a0472062d94a45490b4bf458816384929b9078554f084b4ee4b11aef366529e0c67e0ebc43482bd16290766bb9569762d484cd1931b5a1c189d5beea20e87a642408048cf5bb21589f27760ba65a190c556495337ab9c0800bc017891cddcdf41811cc24ddab7513161872b19c0c98bdac0748771a8d9d6ba961250e290a40b5ca9e06a8ef732830481430e1b67347ec174674a31b739daaf60551860ecf8e46291c8b0e232bf22469034db72aae8c6a74d2112adc0c6975b58ddfdbba7e30fb539ec314f785ad6c967ad5f0e7ce5a6d1f2616aec681b3201a5d0c9fe66c92ce4bf27952e992711f9c489b82e9e9f5ebfc2d681c5977dbef811fb682886db18f0624a056c59f87f365c240ad9b1dc97223de5bc2b56a325c85997747dd4cfee15782f479e956bcf83ff173d4994030241cfe0fac8f6a628ea645c6f1eec22cd072f056e2305f64bfc0422e2572c1b3e26a2879fa228254962cde35b8f3fee9890e0c728975393aa817cf5bad52ba07ad6f9f89f377f6113514ea8f714d748d443b8ca3daf9ce469f9fb2f4d8240218f819954951b2b9eaa6a04c8472bb4e7b1010b2bf031c6cdacaa60f64e331bd66546b97111c6c04671a0d4e5bcdc013565e9fc96899a999d6044ac6a07aadf77a2bbc94d618bae708ef0b778618f8ec6ab4cd397b1cb73e32be9bf3fb8f3bf1e0ff2ac20cea8e78ff49b98f80165999b516339d086af4a7c2033ce9ba437b13fe74b3c2cd9082b74ad0582217e0bb74ff9751d8f340db6164c52f114ea6a92efb9f8752c2fcc0b31117beb0d755d00aba69252787049e2a9b329d1b0eb1e0b6789c5c787306ba448b66fb27912751c301f5647e220bbbcdece3cb84a49eb66abc87d25f5d657d4308e6c8aed4fb41e96e2a905386952d2d461292937b4b45697075790a08ae4f90dfeec3fccae7dad505c39aff2e3d514600ffd7d16f7361308832343a58a0552d8dcee8f263695ed6d45bad55c92b9638570000090f141823973f12e2656ec4e0f56ac11a9608beedcb5ab046bfbb20f195d7afac70a4111bed655c14bb19e88eed8af325616b60b08e1761d87661b2244dc66dc5848669b31ef866f50ac6808f39a93010c16bb80398fdc48cf1c75e20a4280ee38f6b5288f728606506d7bafe01be6d2e980198079f375a915ea9991985be4e6a496bcb06a0f4b56eeaaca36ffe97fd540562e5234c93a2ca90d4690f4027e73cd3d6cc5f51a8925565136de8dccbea22ab2217a0db43a4bbd2b9253b0797660fb9dfde4d54b8cedb8f9785f5657c5cf3578ce9f560939d3690d54a829d4f7609d7ab830d4b147654a77fbad9553d3724623d275619a5860d97d484594713116e5b15e5575ef508199432c2b61a03b31cd3bf06852216b41265a883462ce03be2511f7f8990ebac3048de0254a1e55b07832dea471b8a52b0f1a131ccada582330cd9616e8f8962d26ff6e3a03ea835ea46fd4e2310f4011ea04e3ccfed6c41fbd49cb5d07ee912f621594af6d58f08c50b16afb9bc3bfa363af4a5aad3e6fc5f72a3f8159eb9c41dd348c9f44b50c1dc6913408860af378f12ea8bec8b3d66a99e45ded06fe046c82005a9874c44773b8df1d782c3e7f6f729bcfe13faad7908581cef41918e0842203d458505f3ad1bae9d5ac4fe1a04d032c94e29093d8edf437d3888dea0ba8ce5ae6ea2a6b853978465dd066976c4c08ba1817c5f8f61048f0674042294c3a64ef0ee5290b209a0ad39b88737c847c2e78fafea53befc06fdf242c98306f41c743f58183d89814f28ad7e2981dffd123859df53f05d1271674ae59fc72bd93d03e5f4f682fe5ca2cee51b013d462821b6e59e205cb5739316c1cd0686bc51b68b1be2d66f2f91f3269440081a1d192a943156d8778609b8677f078dea33e8fc3733cee49c6d8cbe0a39d5bdde9f018ebb3ba74da63d1d3b74cac5c4bae19cdd764f22430ae7101ffc145a4099d1b67edadbf4aaa2abca07e7dceb913a0a97d19379b9b8e06b28333f91076ff89115490ebae47872af8cbd53ba220673dccb1c18532d914ebfbf5ebfab2b4825bbe48f777bfed243f633a2196e501ddba6998910f904f07069955636389b19428fdcfda81dbba46e26ad8ecf023da8bfa6dfe59bc5f7ac3fbea4ce4d217aff897e60dd2a8980b041dec5cbb72d5db6a322860c9a2d643c8f7ba42255fd5e785289acccc3dfb7809f1b77013266b25e299df9c8dc5c42ec57ed0131effedd26b57c5225157882eb7e60ae7a30d373c75a60d791c5275d80ed98ab86c9ddb65f64262771d5bdaeaf478c776d9db6359d96166d9034afb82ce6ad8e9152e365d32285f524d1796c2fe6e01b35147c1dd1b7fdce68bd80af4c379d965ab85303c888cf98c4316a5784f3a1fa2587c08bf0d4a986ccf121ea1b64ba15a20d2f7ebcfdc5bbc35f819747b5e2a966ff2a223d074b747b1c073e26f37337a8908e18b4c56cdc5de164127aa70ce4af93c6f5c855320bcd72239ea1737d3c941bde5b143c93acdf07cc0217ada6896808995237b2e081dfa1d9ca2ee5bb3342955cfc767d39cb9705502b816f4a0652988b349e53588377ce6328df17788e39cde3eb8d7e1d40d6b945ef633cdb3eb379e7866b7f92ef55e949bd76535ee8ba3f06ef40ee96e8956228393869ea728566e0fe7b3937bb794bb987bd76337572d5b17e9344385812f329b5f1545e5872485bb1d9b51f9d5443c872cb7f4c549ba20d427440e815b29a3f16a9eb7586f3b5973c84d3a939c28efcc7dfb1c1d906912586926d5f2a306491900b300a34df8a171db2d2185f154531609eea83cd1bd62c83718a7a8e31b850e52cd066609fc2aca09938cb8d63e9f78a14a711c84965ea3b65754395b318269665cb446ff96adb42be6ce41b6cc17cacd24fd4d6ecb56a4e4411c80e782482200424e01e5f540e7468a1bbe69a4baac15513495aff6cd56ff1ddd40bb131f5dd33eb5819b1dcf19485e2a9bb5e2a4f8a1bad4628c08e3f42ddc641b78363ed9ee804c52909c78d373cf476567352493bcfffe020cb6eab01e5f16d3681c94b88327412b876c2b01a74fd0b6c03dd17a2a7b152d9091d581751bead883890d27c686b64da41af3355018cf7c9719f749cb9ae6ab90ca3c3a626e305e86d108bccf23541b344e871f37f943415e1768f97ebd8c2c1384773a771316f90478a35d18ca606a00082f72cf44d5eb302d81a17611503faa092522e10dc9edd2aef5ed6e08056f06a3bdd47d4142aecab10905c2168a64e098697070a1202e2e973757e53ea140d8129725b3f6d33a6de4f2f9b203e348e2dd453fc1ef2d4f14b71a7a6da0daa806703a2a328f38cecef096d6554e606aebe4c155ef6bef803f5679e694105f832cd7661c7d2608d4067d87a83697af21567733e1484b78e65247227a5b31dd6d4094ebb09dd5423361609432fa68ddd3fd850c58ba8560f6acafae7a20dfdb7edb29d6e86135ab15e08abafaf29c1f16a300b71bd9fd0d89a51a812210d3f8b62bc298e98db3a9bdaec1e6bff5b15fb76a82dcd5f3f23a8b57643f9f983285bf138f85ba853c0328cd922323c2be96ce52118dfce294952c291bc2f9f1e5ef63b6dde93e02b629741ddfa44666a4c2c911764d23c5e8936ae3ea58d4774fb54cdd8e8af4957254aa601f94d51f60a1bc3d24dc71d","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"fe727b3ec2446f3e9140a7a09442f679"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
