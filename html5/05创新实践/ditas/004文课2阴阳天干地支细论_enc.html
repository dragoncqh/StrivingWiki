<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"0c8fdc15b7d3a9a5f91c409ceb393a4f9b4a175c1afe20662ffdfbebb4c4d1ab7295f2365ee21f8095b5b0dc427c9c26223e402fcd6497ad8f3a6cf145e615a6e3950727341b3f9b3f9f8d5f4208f6d07050c1dc07de004f5f7d495b10abe6cbce64b918e314621cf407196af56c34304b4f10962baa1af2b239cd60cd18e4842aa011a8d0ba6a0f09690a0272cfcc87bda44b426488d388631a3901771e150d7221549622bcbfdd56f1eea7cf32e3203c1369c7e0f285a961036eff1216d5d53dda79de054774ceb277a50c8a9559d77a6e7578f9cfc013ebe3ebb8052970e78eeb3d54fb430d1d0038e594ff38135f332dcaaf8d86703d6a0f4f92285be5a22a5900799b9b9113c982de8e45dbd426c9dc3aacd0b139e6a1e494e2fd724b1347b4ace5342fc161b02ab814fde93eaa3859c881b5cd3dbe79d9908d024e570af978886e375377cf09480b7774cde417867f783325d39c7eb3df2ff706538e9905f39a4944028b6c8f08407ea41b04284c0d49634801bf261cf61edd0f49eb655b0b997f9fa7b964a53325e6c4eba0396c4a79987ab3bc74e475cfb354ba9d8109cd4f4116b1cfefe25321a65716fcee5e553852880c913c6fb72c8707d225ef34129f6b664abc186aa7e514143c499804d8c334fb56ff408c01ef93260e247cbbee285a084b5c886089a1073a4b1201c39f10b6b8f2f607513ea9f1b67e71ad99cedb5b61bc5d4ca9b3d64a497b5d2c474c1b33076c6954b624670d25c98cec71b48fc3858bba427032859f9ca3efefd6d1b0a2c2d4aef5f50150cc76ecf265ed931bf17a0778f0efcd7478e060a7eb8208a1f4c0a89291c709b23477313b9de75a91ea351283872e438233b165a43c5ee1f81f7da520b7e8fbc8571e14373511e382db48385642820d4501101c8176b9d06a19b5fcddba4047eeb475dc9d9479afb5e1faf9e7acb784f57b3b5df104d05c2cb3a471e360fb0cb8424e2f32f802f32123d0c6e69e85fa5d889173091551bd195a9cfb8acc44a14f17b7cc888231fffe5098b27810e97e2b974f36c1cba7a1a05abcdfd67cfd3c7375285e887ae952a016a77707c47f266fa3500df35e54fc3133b1c2a856d73c607f4dcd4430e2c6d859be10edac066b33b1a6a61f919454848faae307accbba795868e48e2793fe4172bc9e98ac5e0e12155805c67d91550b6bd08e87d492806c1eae7dd2fec19ab625dd26ec89be6594363b11fbf904fd86501c8b50f6181980d652e0f462b4493f410d760b77c7530c5f5c02f56cef5398651bcf14a29911abdc98a1fba28955ae22617c8286fbec4d75e64352b4ad7acbeccd6004162d100715e2c28a2804d05021afd03a72660e49e5d2d0916ea078cec2249e0a5efd343f3ffa668ef1c5c406f1046a86b6366bdd8d54df0f8f963dbb43b010a687d03a21928c3bbdd7b6c01bd8c07a254fffb25a4769e128520b9ec4bef46869052e31016024852368918ae1ecdc6ca5b4a11422643636aa0f5c465d924e9fefc0c336fd4acaf7eb281029d6e4142a51c506d355f09b56cb3ef21ecea232dd30c64b09bca36d5bf50c6af26219a976ef6e0b44bdf1022c72d028120e3daacce11c8fccbcc8ed24eea42bb702f8903c4230f08c8af263be364b1d0ffa24f39a4539b9e04e1dcd0cb09212ab40800efa2f96095f5af4d2ff66799e577945347fdeda163b07bfc4bd7c407b58d7afe7b7228899d596b02668e2dd55189e584be80f4ea4d9ec45a67527f830b8af792616ccddd41aa4c95b12e85d8ca89acc2b1fd3961eab569910229762d0dc11d6247f96b7db501251323ff09c04b48edff2c496f694c9eb9cc1bd84e1cbb30691780e28722e8cdcc3d0a623b2c1f2db7dc897a2e408c023813c7561513d683a2fc5135cbd75eb5540f9bc1f5611f97cf9b00275f331c3ac91aacbe23d713d4401070926929ab962a66bfc35dc575562f7f3a731b5322b7427e719e51d023f559911c9775e9dfef7268b151b8c31b368bc885e39c249163531fabf4c6ed32cb67ee194bf60743359f62f0cd5f3bf489e67c103e8041d271c823f0fd2546b001beccd0290363a3bbea66571b0864b89ea1025a59db122868eab0da3fa9659580737ed8a051d952da3662d67d29f07a623ea46b2f61246cfaf27af024a9c039884cac666f6ecc2dd8d576d330e0c331a1dba3bdc2f2a48a8b7d71a3fa79c289276d75605150f5cc645c732fc1cee8e061529abbdf9ec8bbeae58f429305dea1e2fd35fac476bb93c2617b70d2951ce47c36a48e4a1af386e87e76044a8bd62167256d696477d4a76c776ac66961091593a75c810b04284275e54b1ca8f7b71a52e730128f16fbad3165cfb8dcfea802652205662f078eae54f0ef8a597cf6cdbf9adecec67efe5d04eb561be94015a7c388bd8731ea87d7c88cd64bbaf1728affa5703f61dbc9c2d1371b1088404c338a2bd64154b10310c9d8c11ccbabff335963aef7174c7388516286450bafc5d5c79b7f4c224292a7988bad0c15b0d215286da3badd2b091e2989e29e49c6d39c0fa9f817facb073a8c4a16938c90e110c8ed2751de6f8d8c640c52d8635411d9b87927bed6d3b9697c7ba678d212e2ef6aa1ac372ef0b50a9d4384fb34dfb2db75c1752ecfba698a14b4a95402d643244e81420d0a6657daa74785ac269bcaf7dbcf6e04140f12a4ab6a8267c6a563fbdc54e63a0c2ae35402b62b68d5ed6969072a60ecd03290e8d18e8f259205bfce8ca81a1b8f5899f36c8626b657158627654d7b09b36abcaeaab8dab9258fb9afba532c342441e9d40182c5d9b5f9f35e9402a576f86f6b1bdf8e6aadb7eee0d7347600ac7a75fa319ffccb42211bce2eea07957d37fbe35e64b4ab6c9e4f9f426231f39f0e1c6e00024d70ca49d0a7bb45b0ded8b9b4f875ad561252e11370a66655a41227738125534377f04eda5e674ff1e5ec4a6b9d60bda1ac1063293929c9ed7ec5be0d01008d8e55919d8c36fedbf69a3d901a83344e77e85fec5ab3caa737f68198f2688130380beb3fe146539e69788c749d3b0c4d645368f5339d8814a335059c9e54c6e0a93f6089f3611022c86fe93835adc75078807944b241f5be2f016461c708a1ca89413e364c706696432d12fe3d0309fcaa56c40857925cbc6f86535ae368dbb631b34857742e57ff953c1d433817e763a158ecaa0957f9d2a4f68f7a9ffa3f48ffdf1e04d9cc07d604cc6f2d5875f12248c4c6c85954720bdf47b7af6b044e13677665b8c4101e8fa86bf7195986033b31ae4fd1899d2006d7757aeaf609ef0de290a7240341faebc7933ad5c8c5decc6b43dc3989cb84a10161a262203a34572e2f40eb19b05b005cebf9c6fe830271bce05f65242500fc94c176cd7514a14eae5bf86b77094e7ba607093ba89910a66e18d68dd056a7b5e78381287c430d26e1af223762124d3aef66de558c519d1ff90eaadcaa002d0ba96b84321b5f9ca5b563d53aa1e1da7116e37cb67e5ccc0c1aa8b6cbfdef9dbf2d60dd68628691a1046e9e19af4cf4d1cdc9450366feb1feca115d49cf4e23cdcaf13d9eba260fa6bd07714a0cc397a041e9c3c0b4c39747f3b5895736bc6ab639101c3b3a72b1853950e76809eb8332fb260cca6983db890c5adaeffca022326fa3c63f18a150a1e345f8508be10e15b8d8b4fb6a9816066c56feeaccb957277b0ab646b9a72ccca134a27ec87a0c0006d661806e3490391ef4e1d3061699fef3ea5ac4c2bb9088769e5a04026f3a002f8e5628ce3684b6ded1f278e5a092773457a9be0d837a7582b26a2c57a2932447a4b6e3335e0bb8d63f1c3f865138472be519af87e63c5ac2fc257933ebf432bd00f7099ab53a785b4af8f8d33331b996b03ef7ff6a6c78c4deeabf8f27173ac6c84e92ec20bcfabcfceff2ebb47b922907c0e006e45559b638e287481720d0245cd27766ab93a5598e22122b94452ee186e389e8edacbe7c4f29271179628089255dae04fc02b13467e7402d1ea2a63d10a0248929e03e4c64005fc63b1cc533150a1f0524bf48f37b104734887dba1327f98b3a190d1c3ec627b100c002342c1a80ce6508b6ceed59813bd387c434874a57d0a5d3c090614283c927a2d3cf94304b640f05712a575f1423d33df3369ab97d1b29eb0a10f3f0c77e7ab8b01dbe9065bfde1d2d8fa012517d001f4ead792de79fee165d3616ae6bf7f7bab96dd5bdf9879d95dc214778aaf1b35fd772279c8406915e7e6669262d5d12711e54e9c98ae3dc0095d2a5945d682581f0119a3a868ffb5988a8032299c9e66f61df37bdcf8e73c0af2de560b4c888eff36d7dce21567283ff0906c6622fe156f59367d0806be40268ac6275f2524b33cc9cca2ae868239ff924071f4fc79992fcfac0325475290201c446fd5bfc765af36d60a5152709d057e88dd1e5f1c9787242a4827f31b1a350baf8bff8fdcce19fef20f0f037a7f8d6e8c41092d71c8b294114eeb9f9ec33f6c9b6a4a6c8c31acd356bf224a1f10587e63055ffcaadd383d4fe7c149928fe25bc20c0e82b85298a9c00284c57da627c880e8e2f5647d81ad34abc389d7119db6725b46fcf599cd71306f49e2ffaf20910104dc09b6dfc5947563dd7be4bc36a0f5128da97c93141121aa778f225241ccb8924b8a09cdb91d5a45350de27a9af6e113707f0b6b1c7599044dacedadd155c4eeb6e43f8d99510ddc8818251336f3e8199e7f49b1d149f49811c2ada7c5b540fb7632c114ab711d2dde9e7f0016d5631a1082867d789abf052afdc88c15e4b813a5517271890371cb9601d06df962da65cb30fc58fd9e072637dda7f5eece5dfe0686f8b4c54bc934ea67c1774aa9c2756b85bf202c09a13f39ea89daa51c2bf0cdbc218d5268da267ce7062b571bc1e379b97bc78bd8b7f16ca50032b59aba6e43bec174e82e7e4a2a6575f5b401470e1082efebeb930bd0a300496dab03f86ef9bedfbdad25f31c420966a3ed4a1095ca933f1eda3a5a37dd3738761e8c232d21e123ea47b7636f68387acbc77559bebb3de45445b538fc8fcbf9e35d47ad6b8b03c2db43d792412b41578ad33f99e81839c7896b97f2ab167dabbf846da3c25f4739ca7658fb69e932fba45f76010a0a286f909888f143940a405d081abe3f437ca3d1176c2416d35e94f34763b20707964a2ab4a57b36ed2a5342e2fa2a031499ea9c2d71e40f091f648ef736a59fe6fc496a4e8d67411482e18bc7b61f355e6304d393404cbb47dcf1fdebac86a8a0154e9b196587eef57ec7906f30613ce63144eece8951e609d20bcb8328fb0af156ca24b95b26293223001bdbc499509f352f189731fc02422625d20147d34ed3776e9810fe077a0a6f559da019627a237a1bbc598f14293abb13186ce49ab7ff2b93ddad7af96f1d11bbabe0d5a8f8416009762371a744fb35234403994e5a144ef7295de23c5ce915dc359add08139af383e57d4286b6a44e24876b1f1fdb359dcd5ebae34d5fd75198947f55621a2332149e80cf6e4f6cb63147bb8161bd7f60e51de97afb3818407ec63cb1b6581085e4a95cea2f7e0a93292300d18cc332620ef3ff121ef70d924a374a33d5546dc187347c098583d880a257894076b6415dee3f32205da38c4924b8d9e41f4c591b22f9a2ca19d259cead1931a69364bd95453d8e32864d56a53da80f7d7aeab7176fac34aeed5c7f7e690c73b73e412b122aaf2a062f23e8a698adbe346004a993323fdb5eb66c197b394737ce9e2cd9ef3797c83a096502a717338850e4b39f80cbc8b612d398c57eaff5ff3c2f00027330007f72f0e7e36271414e04c989fa1454c55e56c7f21c011f5e6fa4964178bd42739c5c7f18b6ca8987a35f0dcf5537221e7c37d5d3796dc54940c7ccfbd7ff425d9b6f73726119d10682f3dcac641d37c1686f061a72627684d77b60cd6a7d518075aeab43eb78ad15f85a2ae9c48fddf47a10bc9c479602591184fbc6153d28398eeffd37e597c8f1fb82249dc7ec4b0191bf8a17efc42905c6a5cacb86208e6738c9881003a59234dcba4d896f56452a0b29d7314c7d9d1e5d5a70761bf67df4fbb447b997231bb98c950f17ce1ffc9675f4833c51a6fa4604c017e99fbabb12d033ae2a0a9428566ed0f1f790228c183fb3773d509dcab5d87ae1b514633fec343db3196859a42c904cc05cbb0bc3bb0173d60335468149dd3c55dcb42e6b5df755d642872f9b83cc51fb60c6e5f068529cc5a2897425dc359bfdbc95c75f626b7075794649195c7ba192b789da69d03a6d7ec32be0ff4015926b301a0700f1885e3bf92df53eb9ed1b38f0fc1c4882f8e884fae5df07f3b36e41b8e6d9b3d3a0fdc9d483394e6948a78e18d084b3626f12668bec3258bb5c6ec4efe48169f66425fa1554c0560a58e1b4d4ac660feee718c5db5ae1082e406f595a678f1336cfd90ba206cac8eaba32191ebac43ba996de961e91d5633aa035bb1f4b116c6ae1630e693e35019d3261379261dde40751c9131ab69c2bf126b5993df8e28fc5626d75a7bfbcc3dbd4243d732ed7891d42559ea4d56341e1e9c421e1bfe91aea1125c91059d3e950d952b39d5ee5e25765d45cdabe218e717a37a6c871c9105c8a60bc2c8d0b09e152c92e5d99c584278fa7416f18bd4037e09ada5c7d41680f1b387e15c8815dc5f20b8ef7de6bbe20cb99645f0b88a2efa82ffb1f91d11d888da189f4dd498bf9a31856683cbc45044c8f3958fc4c1d653c23ffa5c06dbe82b7e93cdc80735236ebae2dcaa7c6e7b0a7e8b9718b5b6471547b1f2f5406f9dfdc90eadbb0405717e0a43018dfb7884ee3fae9eeae2736c2959f90b7eb547d163f78a227c314007157e7cfe550952e761969a37f1dc49688fd1722aa63b38f6d60459d6223edb22c6c4a7671a4ddbb5cdc2d8bfc50209d3e33886fe47713391befed0914ca60d006b2bd91e7463a9234ec6af0c2631077418d9c667c1cbe8d596ee62505c97c541660e65f87cbdacff7f33e5de754d8b6411cc6c7f159ecde9e9e3ae44ac343e6bb6eed6086936d08d2762781df7e223d68418458c5eec600079a249978f89f0ee52d695a2749db209b65c526919a41a232d7d9317dfb98acf99656ded58075f0290f72378155e356c1974aaf695b97df7b1f729ccbe124de8c451138a2b03aa94cab904b7fed6135a4dc323b81fb036313241df14c06f78461622923889a7743a0c3efff9258b7a30458083d96860729b53c58aac2784a70abe04243138b4c7f76b804eb72efd4d18e15fa977687ef13d249c4ee0854a3e779ee4fe78cfebf2dda56208655b0315dba78d27bc47ced9959a1df790f96447b0b2f13171d393d08e89a74e897f2b2c5e83a4e7f1e94dfb231a9c17bc90558615d6baa20a08109c6b2f658dd8c3b17a9afd5766b4ab6aa3201b6426360b5a07d084c1701cb3fcfc2eabc0187a6953343742f82bd28f1daaa1d32643f3cfb3f98fa31f3959fc50e574d67f5282c056f1002237dc03a448524101b0d378ce74505b34d20a0b15d9258a071dbf5631aafe3c2fcb8b050b674db41345b232895f9f062c0345b7e45314e52174885516405c80f4a75868063bf1ba838c96179bc05510e88ab3dd47aac4a7e36495be0111cac75b1a6d9a20b15ea02c1fc0a17a0e28a90a57ebe8bf536146dc9c03d5a799a2fb49dc14a5189565a39fe80cc0be9cbc7f4b7624a6cccc807de3ebdf868742b4bdc1a7f8b5e7f4e4021ec2d746916b8652cb99fcc484e41fe6bb688a2949a332a4dd0c1f9330f3737125277d381097069c1b725ed49f2f7fa07ef7232be1d5591fc49fee9c9d4907e82be4fb2391d2f073e69e04df0cf60cd88a2c36edb2a640344a433a9f33be79e2beaad51495dbb658f1af555159bbd67cd8a256e180193c9336fded0a3afffcbe280cf4f81adc9823d53459f3ddec5d1fd9e54e7b622153f9ac37bb7ace614dec4c93540bc3027caa226e1b2c45d9a3f40f995b4336ae06ae8531d55f2bc573ab305c67cec88d8fbca2fadb13f66754e4f8b9348d593fd7b866a0a19f311c88106926d1aab828fba0d917810a3d1c1704381dc2c7d59a033c0caff2429f8d7ba01239f7d139970ccf7be38697ec6ae417a01a0c488cf57642f901970a4e1e4eb7d08051b4acb7cc238fd2b0282a30f7f38d1b5b401ae0280f0a3b9ac0272ca9748d834723da418f0e85f8998a3613b511d40326941c4b0a778a29223383ada74b412fa9fa566cf8d78666b593ee57f1b9904e8440169045eb4a9cce01b498aafeae0b508a945b233ad4819e9172aae5d00b654c5921fa0a5ea968a58768dad43428f85c9763c7bcdf9b6a9b0041d192f0f8207d4554fda1ef08e8a06afd660ce66d736eff54849280b561da29a67cc30bc27bd7c2d84ed996efd8424def67d00cc4781e006d75d8b76b07d7fa086331e9f7b32b402984ef7c76965bd24f7cbc1cd4eb05a4aeb2f009c021f6868f1b7545f74f6a02d36807487673113847b38862fe8f306c4ca346aa42af2feabe0a985233bfbcc01af5300f98d0de65a067c1ecd268efab35be24b1ab387176099677a5aeb74550c5f0973ee0f8d3096d510103aac8ff3725a075bd1cd1a101af8b772e24c5702af484455f6faab1d1962ebc0202247d81dd2b5db9a838df3091e95c6a17e23e23714b3276cdeec92b26c869b9b70853881c00e190c1ecdf50d4b3fab31fac6e65d84055f2b4a8a2dc68dc55f46426f599afae9c85ff5113565b5f7ee40f0dde0b50a2ba395ec544992927f5f7d83a1c5e62c333a2eea6786b68a8442000e4148d897b5feb229fef7cfe0bedb779b13ecac48ff8ff4bafb96f5d6c929c6f9b8d3dceb7337ed39765fcc1cfe390f9f6f749ebb14a277e5617d0bbfc07a9a90673d124a43844e9fd27cdfc1e46fa558dc4206531e831c30dc0bef6416ed2a8a1c761aca461694b7fb3045139c9de867976a357fb85523718389d0dfd9dfaa5b4cd25d0de7072c62ffd371ff0adc636f9a1ff67decc1abce7d4101d839443d9d57681f01728d25177b4cc5de25705f71ed75ad90094c1083e37f057cc30eec5b0d1fde79c0f87aceedceaa191f809562ab53e91d9d82afb3a431da952d48cce7d2d4995c4dec3d73ea8f3b1763ed6265d6c4d581e95a6edc5df5edee5aa4d20b758f0f5bee3827b1a2899a06d7ca814de58d19a64481198bedc0d15ede087b7ab22fd7f8dd77362f4a42f41944324812dfcddbb2977029015a09298aa918a5d5395987f37a6a972e3ff93160900d742c4879cab43d9e65e3674d7c8617e4373513b43175b2edbc11d45f3ebadcac4bde4681698e995bc53d435b29849649221ee43d59973e29f32dd90e63ffa32a6ccb9c6ed9f9643b55897cb105a8265c088226aec77881effeabcc6f0bea2df867921caf1995a935ea6dc99d117deacca3bcdf73f19ee1e6c9eb19bf91cdb887f16c61029ad4c723667e1c57c18d0e4442491e1e686259e6181b7c9de92ecd37027c52b9487aa61c2b1d307e083d97bcd74e84141ae7ae7f658a306e2757d86f7c3e0998dda2e94ad50a22bc7b703e431d743ac0c04567affec419f41946496ad87b82d07021b586d654b0af11ac70aaaa14a5621e809fe2c9002ca26e87a8e41d596d56b11c09a31754ca5e4d54c13b9f2cf4c0100002027c8e7a5d2ec011c07f9d05947f669a7ee1c0d1c96cd5055b0ba5709b6859994de22aa79f1f4f76639160e768868a01e789f6461c408235e15b68a788514162a0520895858e86c5adb4544e01ba165b10493f1abb7c5e03cbda12eae4e74a5d8430fe9df1be9cd6f9deaffe3fd5fd9db256777a1d5d99dc6c6d8e420ae240fa444978bafde126bd6f09966e14f375b85a19c8b41c885342639ef180a1402f9db7044353cbea28c44c709cfed06906fe7fc42a54bc82b670c990ddfbab093735b1a7e81cbd6a0925d9e495e540dda3902c6bcf3e16334816da1b630dbc27d04bae8cb0ee2255fe6bbaae1d814a2a8a579e03e11a6e42d6f265f996230f789d53d58ffb7b58abc51e98b08112ef3de0a85ae91ebefcd5898869bad3e557016571c1ddceef4488b132cf619b7abb204c8c5a18417674a80e803af00580fa8992940829fc24296f3a9f2626d638f4370f32e0ba88a8cc46576d4db687ddac0d023e187c23fa2938645cbc8ef0c242cffe1ca9f78aa0011534718553a6ca38b47490af489a9965a1ba75410939daad17f90e9d577aab75fdba76f504da0df661284a7fff4dd5cd8120ddab0c943a50c6a6be6ae316ccd3ca9bf942336916c4e9a1995c2bb36a160f0dd95e930b6d63d43c1d5e8f770302f78433c4bff9e86579cb6ed82cd8ff17d0a245f4b7f937ae358744bc1f338311140179cce0fbaa80fb3ed5f81ee19c8bccea23133408553a512a192a254e01f641bc21ba9a8356acb37cad11c7cb5d23e4ca143c41a72f01ffb73dd48e743dbe31873bda7806f9eb18b2cebfa5ac91b0fc4be879be772f0169f0ca09885a9c928881eee823c1b04b3b29caceee5c146f31c31a4d48f003197fddeeac9dcb267349d0423db72834f0b0a6f9d231fb1e51e9cb9ff69d203b2153cb6540c08e4745272831e6c0ad7be1cf1d516ff48888869aa1869128652e61b9cde58161323175228f466f3efc04c348ce7ce5e32d786290b6b244365c9867ac21d6db731d87b9fe7a458c2eef53c07fb943cfa586dbced05478339ef48e776e38d0003d65c893b6170e28c141c207e962d53f3281a52eadc560c9c66fff3307a7f527faf670a4b353cfd1cb086a4dd491699ffcab48efbe2177f5054bb79545ec7df511077bb48c55e17761878999f033e32c2c04a2511f1859e569ba3b57af5c7e96558eba113477029d46b5dcdadcddb886d229a152e97d66711d9c25ff2ef13774c12cadab4f6c2dad810a6c505d3adca3b87a1780b7f4d7bb8ba1113d81e3735ce7785cda30dc12920b30f07292f3ced7000ebeb50344393a3dc0aa1ba615fdba027ee45c1ae6a9309b02cd198ef7e905c7d83e31fbc7981327efe12214a1dbb1013846beb2fbf27d41349e66a5ef9a081741ec95a6188bda7607c9f754aa0af494a55ed9b91ca2c25e86279c1b427e138d4c3be979d22b5013d1391ca4de6479481af49075fdd6585946b23743ffd5a0f2b2be5ce38e550c2d5d0c5038b13679522b31103c8f9d2b6b8215b13eb5ddf71d07b18f856874d9a5317afc1e4b9d7b837565fc16e5176938e4e1e272db3aa91f035c2aa56607e990e6dc8b62b95eb8037e7fa4cb4aae00498504b853cf6d1fc9721157e5ffb1a486ca07d2a3c6c5b991629641f9b6970295ae51f7026cd1b1461718eb740da85b12ce1248757141e66632ee9e9bc90267b8e9540630fc44dba157935734246cda1765bb8a63b074382065d030d25f20e352b012ddfe87cf1f9d0b845999eb0de816eca61dc78df31f27c1687784aa02f622f6d91dde0771217ce94e78ef43a222b2ca8e5a4a699eb6c4406b0ca05b06bfb5fa5b60ee3888bd6579993b0da60fabe5bf09251f0475f883bd9d9b92eea057c1cd3821fa644216b789539c7c9d7e94eea275e1997e37ce19ffe8c57737391efec9a347f1d0193250f475296a96a52a809b5aa89494574e61176785c98cf63a08da31a737d8b633b47e95ddfdb2ca56065653bea1756c7bd93b548f53df8afcca699f58e3b7c58dc55b215208f0447e853751c692d57538936f9d46a4e6ed13a9045132229f7bb985e59da014d9805cc2c7af12bc85f22c6f979095499d199e6e9ce59a402494719e5ecdf9b2c25aa1d91c1a2b42401fbaba1717b366fb6d236c4d7c70286bfa3aeba5860e4613eb358a381a167fdb4609e1f18c9accecd1dd21aed3a9cc0bfe8d49e92a546a7eca17b7ab9b0c0af5242f7a1f1bd31a215e7aef0c8d1b563125ba5f881531668d4565bdf5d0f5ff49c0b135aee0461561d6c93b98d4a097488e87b0ea0e3a88ec1b8aa8ddcc98d2428b86fe16a69d6511102c0ad6e8f2118cbbf946116d1ee01c71f43185fbfd052ae14c08164d81b48a7985cb468516a55c2e1791ea0d9eae93b932668740557434679e5d5d1adf708e8977ebbcd174728f6acf86dfbec807db7e29694220a61749790b1199c60b9e76860e1e9021f1a6bbdabf01f653bd3a6e1e29840ef14a5fe8121a9869368c4099181fe4278b3b8321672a8e886c77c4cf0d975c8799faeefc5f52823bb11e2bcd57c273df969278ce478099dec485df2dabad55b6bd144ee984ceff77ff7aee12d48b1ba9400da4d0d74038a58f185e4c73334357121f9217bd145d00b0d735e0883ee37d9365aed90b6d2f8d6f1f88c8e167a5399f0c8e297188c189995518e915d1bedf075b6960238c4a6ddbc061bd5bb2acb9b1260fd43556f9cb53c0f8a937908cce3711f9ac49cc25ea38a32def71cad61fd7d6adb854c65782a3e8e12bacd3afde73a2dec2f84c9419fd788731c982986d12951804c155742bf0bc3f5579420a0d2ff19a928c335a971540c3ec920340f38866781ca41ede66c90258bd26e39a454397310e9ba1bf5097a170069c9c46cb6e584243f89a73849c9f7ea085a4af9dce255f4a974df8e71e67f7ad46f9134715f602907ef1dc2e37ebedfba660029c3e81d804f5223b6412b519f9b69f068f94754ae62922bcf513051cccbb3839d8df47bfa56fa3aa1604ac681464f65932771878c34124aa067ba38030bae4e5f7d23ac357478a2ad2b428ec2b0f7fce61e02134c26f5a42480e9d6437b50e027ab180ae27f1fa0aa7161a2d60f439f84d79e7350a8da7ef4b580c16829a3091d1970a0b1cf2f89047fae867a214bfea076bf1191236da3ce714e1bf2440a98604b0ea8390bdcd07b9eb6c3e36f205d4828210e1d7a55433eee5a340767cd639b9ea94779823fce04ec546e37a6250271ce66912759b7726cba7b5651c407a0f3b1cd3949c8f5904281f76e7e862618d5236e91a4a4b71c2167d2e702b87a80e794d8cafdd0bf5906a95ec4dde15188853d9130773373d0ced80b87279e5110724b1faee3511a7efc097305b86ff5984abb21209758149237902a668f4891d8e434534b727d7e50b9497545cce4756b147314c180128200904eeecf770881ca8324323a0c1241abf95696b2269881be4f9e89b87f2e3ecfd7df8858e74677562e7c22d81551a9a85424159d989a02717447f50c36afbf2e145a6e3416d298cc46a1261f6ded053c94a568ccf0324f7ca72c2a6f7afea7502f1554645541c3ca1f5407554b394213a235fdddfdf3e6684bbd9d639793490d6b87ad594c150f48987b8e7c09a34454ff78011f0a448f52c8e5c7e66897537b28b0facc8a983d6da273e03647ea36002dfaba580d7eb7935438c3b064817a97c34535d5ce74c4893edb9449b386fe7b1588ad370b50e766109cef84dc3991804b2fe40b6e3d5c47e7194f7465867615fcd41f9dd59b0a4d9cb98d2d7cb0481cdc17c11519c60cb0585d4b4a2215bdcdcc0155003af2e05fc62f1b20fa41ef2364ce6e4c2449c8441b7da993e68757117efc314f94704ea500ec48801550229169613fb3deeab97ef3cab9131e14a15e577afdc72462c81d8773295e23572d5d1f498077d1b27997c69525e8234ab18ae0153c4ebce9ee970fb048903b79cfeff1e3b955c43f1697ad317aac565767846013fe026ab43e2070f8b1200a423c1b21abb97d00c8314645c62917a6041b32f69364b7bfe5bf4957dcf8d23a9bc2e31d198f1d58e794bc18cfd48690d837028699795397335e94da83ca5fe60cd41261d5c573e31af9da78c8f047de8e15fca3bf391955f4594e6a18f8a51b268af8e24534a089a24728e34ce8e921b751eda52f15389d4f447940c43d07c034018ef5077b61301e3400a62c96a2ddec4465a399e4d5659bbeb636c913325e108463a3130a19bd6fdfd885dce9f7e56e301db9069b7f8164d19c62ba3044ee4f133956aa931e818514a440c33638580ae5bcfc59bbd1a84f287408b0a9f42fe8e0dee2f6e3f6515a742901720110d776f98ddff56d89e05bff5acd3ffba5dae66437260c32a8b74de46fbe89be343021d526c34c1eb89be7b488247d2fd1cd493f048318b217bde8dc6a2ab93ea3d572ffa3f1f5cb37e341fe492728b89652563378ed05e7b6cf0d8fc5557f37c9bfad22db5ed829f01c5c77a2cea09588aa19726b6c6a7476a8ee0b40d76b18b67c921175031037524608fb2903edead08898bce82ea8fa12aacc6adb15c4d0b2cdcc78df2d9adb51feb37bbdf641805a8fef8ba8697c5797cb2933261a8f614fc554449a6dd8adb2603ca36f305c72872897567b4cccd45850341e7ef6e2810b1a39a2c4ee30ff1a7ee59dd037e8343e85a05c53b1f61efef0f1f8f99e3f9a0bacd02c6168bfe1710e2c7fb4a2621d9654bc7f233edeca73099088625a09afdfebc9670ff3377e4c35a0398b395f1f82d7672f96f401bb7419291687e4002cd502146d2490e103ba3596020b06829cbff20e269971b010f85cd071b259491b8d6a6b16ee6d42d3aa11dc621cb31650c95ae1f16c240246a08b24eecc62530677a0f33f70d618ca8d22da66ed8424c9aebb96c5198ab5a127240427fdbcbfdb350c75555575d54f38ffb6a7757e0c7cac2fceb281eb44c9cdab88a3a5c9bd9c5e9a56a55d05179cfedc48a3ef1245fc5e43cf67138efeea4c34dc5e90b6cea8c28e47ae62eaaeb8e21d83a5200c6898a0a0a0db88d957c38581659c297778c50c3561f6adbadc9d762f663c43ad01bb6de7f9103d6a3c6efdc5e98e5d682cd4217ffbbbdb4f01413f6aeff39caa4d5727392b0ccfadf54bf2004bf08d193e3be8406757c954f47de6b4840234c1b8ea27a7d33a0bfd11a8106a190253beef7cc6ec3829f84a4136506bf320eb2820fd20b7ab0deab604be24186dbdea077900f6efb97350b7c23be82d07450537497ef126f4fabeb32536e547e073be6ac76ab2ae30d57fb472c0fe52497be1b8d24feff31587a0291344e703cb65744e01f2164fe72a3f3a9ac987ec68d9d6831024a605100a2981f4f5afea2a9af6ed54a0e279b43037c78af71db065fe08c35057e490a0b1b555f3f781379ae0b4b2516e2a18d523ad52f1fc0bdd08df46016750f6114c6572d7f86280c288a14f685d49d87413e951b03141d7efe1d54140490208c8958a902fb1885a0ccdf3eb7f58517522e97e45d8d40f8988d40fc1cb2295d2b6b9bacb48e91fe4a8e4e5c316827ce0d7091e930571dfaa66e4de570ce026efb3f70fef45688cb8a6fb00f83f0414fca4425a61127f2ce4d75bd18745249e129b1cf99143630f804eedfc4f791aeca904611956a6b6324ed05bb3ed51b038ac8f386b0c4b06eb5344fdded97374634e65f057fa849f70a2395d0dbf894e4fa18f1e1131d3d4ffda1227c8257e03061b91b56f658258d1f2aee8590743e3a58346953ee478fcbcd153af5d45a9976fc950d04bdb2869b7a6a0b7055858f51787cea3cab4c4b04b8d553eca3997d32e9c7489d33074fd3f46a4cac72fdadbe85894b03ac4532873475300d0231addf5d5e77517126ca7b42f39bceaff09f654f50e942fa3a4fcb8101d71942299d79a4487b0e2aaaa018ea9489c5329fe727bdac76cbffbf76e0a6fc3428003e3292866812a8afcdf8fa7a27a1ba54f9f526c07ca55e22d49cf32ff9208f18049c009b38e48528ec78aa11ca29df30393ec219b2c50b3c945f694493ba695d3ca87d70e53ea2be0aeddd78c6745fb150e20d679161725f121a75959becf7130426559be4e231f67b92b300ea392f31f86c42d6746d53eef0a3d3c3c97a42dfb6fe1775e8ab4ef8a754e4b4912fc8516132ce68354972bdc704202966edeefc027f9395d86a41fd0ecf76776c381e05cbddc5eb106d4998cc57769d32a60a2dce3494c5b32275e64dc8a0a271c9506c22428efa779ef987a97af88a677a427fab940f61a9fe5d9c496dc49cdec7eb2fbcff89a430e2222d16295b1d6ac52371c49d08d89e7256db1c4f2dbfe60df53abbfe1feae7a1f634d922542b6dbb32218b5347bb33eca5523984a10ebc3ec4a779fb9c774ba3275cea315c690877cfe43d72bc098f175985ab1f6b62254b27296ad9a5fbdb5592b57bb06674b8bd2167b00cd6cb0e32293d89e0c3b16ea4da4548b7c71c9f4e95e3f1512d8cb9970b4811a4574d466c6cc947cfbabbbd7d27cafd4a8aad8f7951a2733cdf5cf9931ec9fd770910671f7e995c060ced36f22d261b2d5c3b909de71a5860c82173a67b58c7513c6a51e2f96b189b7ab70ad472043f263f8e58f0cfadeffd63a58299499afa4b1b0f546259c0b3d3da44ec45a33f5dca8929fbf518afbb8a7325df1ecc9ba8b83fe5b46c4ce9b4cc76b92ebd8732fad9dd322e184ecb01c90be48c710dbddbf1ad0de7ca08ff5e87a8dbd2397b72bce701b4d4031949f9e8acfbe51653ae0b3572d08d4fd99145a6b622ddaa3caa02831a382dcc08648f8d61adb96bffa72bf8c7d6b30383204ec0bc561722f9055a7c90126c26811dd8002d6dc7a3c91eb709c664029fa4750044068f541670f826fd2be576f9a9710d5aaef2541464b155e9f3dd245abe9ed0d867b434cd3d7cb3ee6871c530e454c511dd44c2157b874c5892e12b53c0a00a91f915a549957909c8c74f8965d4febada49f15a1aed4b10dee6db8b7347d1dd64d5fa5a6dc2007e63d121f23c22eccfde3cf956df4294e7214f5ac981badcf0034c7920ebd799e1c45e6ec6e2dc9781842aab26f8f228b507d370c7f30f4177ddedc6a022c90e5b011c9aae9b30a9ffca7d3bcf0974863b7c674298231f103b176cbbebf2248ef9937653d3ac6908b5b95e582f5c6caac61953213c2f40ca7e25b2d1546f4cabeae00da8747fa5601811972838a88647c1c750fc37b7865b4cd41b3a3d47550d0029ddfa058ea66c1a53345ebdc73abd916632cb800718f2fa5428e4cc0d4be755b2f4fec2306c0d76a9ca2b825f328fecfa8bf78eb43c0337bddf9f39efb51f5852db8447dc890e8e1355f76ede0ab2690b87c3fb20e1bc832b5c97bd44a7ec1e89d9ec70db33242029e146851b1f8e851b618d9a7b30e9c0833404472b2c0c642714f817bd82567b1bfc009f7d168cf1eab00895fe843cdfe91f155987e5faba7ee8cd5ad4eeed6be0e2dcc0cfa3442209dbcc91145da1f2bebafec72fea743bdada969092b453936acd9c58003b16694b0484d900dd194572b150074a0d4183b5bb5327f83b9828ccf89622e842ea6b9e5f77331b52977c60867b89fdba374df8e0954f4b4e8f230b3e7423a4132331595089fbd702c0c3","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"e51cb6d05ed027db058edc159e71b81e"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
