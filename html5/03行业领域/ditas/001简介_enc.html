<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"ec770d123da2a41d6fc38a7948004286c9acf03d6690e66c23b26e99c630eb437c497bda809b50204fd7e55dbb6e7bfd270f4c65860bfb05d80c4014c964bfcd4c88f4d67aa46de9852b6d2e60f702277ad3e3b87e32faee9b2b838210dd68cd0f0ed87296818972880cdb6012885d4ec21f594823a81444d341ebfbc3d8d3718621721e166b2090a8092d60ff7409a71fc5034cd289998bdcd25fbe1d98b56fef3cedff0d211b8713bc34920199813df7733486d95c6870cd4fc989b71698f56f91b83143ae77f5929ffb3a8f61eb01c3950b022de513fbf78a095e37285719e96172bb481c626800389ce15da92036587b7aacc88c77c41ba6461851f42b6413f085a4727c44a6edd979f30ef0e80c6cbcf552d15c0e9f3f425ab13699e8bd18b7be6c552c711c68a3405b514e0cfccbb171c6a7a2276afb5c66b63810d8a016dd4efab9d450909a26b736fc6b055a0df91354e415862d2633211ca76c515af821cefdf5a89e111d29c4b8f86cb42aeb5e53b5ba811d41e3c2cab7bc4d44fcdb06249b9c71d984bab360682639b76a66d155ecd3f8a378fd3aee1387fcf39bbbeadd0b573aded2db6ebae1017ae65d923010b9fbf4be1c077fe214765edf77d985607e543476b67fbc08f9ceeaba3f563d640b4adab72e951f2bb9f2a6a564a9e8286e920cca9795305af3d8dac1f26e8df077f7c19df8f0fd9beeb2a47cf1d45d6046a1b2e6acd9bea82495ded018b6688bcb76e468aa6c63c6e46268534ed9da91b82f5dddbf7766f29960d65824a7384f74636469cf3567b63404a6672731b3c5366b985dec8dc06674e716ba2e1573c4cc152414ea9db617979898c67a8337d224efb1ca5c5d322e59d084499deb4b8ccb4ab3aa560482bac20c9d40a542493f09c9eb709fc450d57d0a7ea81fdb18b0c6011aa8390a62edda75f1fe4306e19f64135179e8935bf1a750607f9ea834ffbf60a58a464eb3fd2f92c8894acd19bd66098c3531641d2a0f19dc930b807531bc06612f4a3eb9ca846ad16eb81429b449736cfb6ee971fb6a2422f6388b034786d400a7f922c444dbbd5bdf9cee2adc3a980f5a6df55cf83acd99db474d93f28493946544f41b8fdbdc14bca771a3bbee021b1505d5b395401fee384f19c8747a971f7d2e8802369dbfe16ae6711401f74e4f8d0443b8d160cb7febc18f7db40fbfa66fb0d3a19f731fe286ffdbd1da534a3e01e3a0b2572a449e4cc8a84ca84f984d7274e146da6f6590c47c877e655a8d100131d31bb14afd1213db55c8f163008daf7be55a01e7d2be2dc24244be7ca63d9a407ed868fbd6ef5327c9c2464bdd349feb52dfb930cf28a1daa8d049128e3366d0daac0eaa23d6a10f335cd27821b22ffab8cb0d1eaa4c39f3b46f1c4e9a456c2ae668d90c09bc7abdc89fdfae90c98f912762edc0e66b35765953cea4f7223ff26a01001d15e2f428c84a70b73ed6d8dbca67b6c3db666a733c1189ae1b1331c23239efff4f20131c6cff19ba46360c8aa91ab98044c6d2781f616cbbee349582bffbc5647a0e7e3a253d1a9803452646b8d91212f317d154834ec769dae5029b54be2e1244407e1a44abdd3de30e29947e1acdc97889567181c6865a45484080eeb91343c6fb94894b1a6f5bc43864546955055d57d4315c62f7015a83e52a152195d14d1a6fe6a6884fa1cdd50d4b09edd68667d15a233c01924f7d9d6edd7d8fe22f573fe9b2af8c009a9eaf9ca404a7eee55eca18717e4c355beb6dc03c883fd7beda4760aae99e9a05c21ba7472e903b7b94fbfda1798366c5309cc71268115ce115a04df12a54d9b8b0b553042180efb4529f37cc755b5756e536601d0e754e984cabacf67e28bbbcd505fb81a2d01e5505c7abcba07762f9ce64e84bc5076bf3bb9ce3b3e1fef8859285f6adb3f59964bdc10d70e3d9c6015725e2fbe7286e2707a71ec6425f152aa195e02d7b02341e1a47c7d7047498105dea0f972804677ee3ab61ffe6c437b113b1177724535b0d68559fd97857cb63663d2b8a91901d2109177157bed1595a2e2189491bcbe02a8b2e348c6fa3493ea5a401757d8a0a3c27de60201cc5b3c6dc73692f8bb54f3861da8c7f7a9424de4d58ba77175f8c669501d3bf55dad457034f6db6fb85def4717f22028afb8de8fde239f569dc7e0fbaef95c3670531e208801fc4870e05e6079f4f51626b15b7d9b85e7d59593becaca45382038f8cf014ab82cec7d29264555a87f84558748f237479dcbf0afea530a9c7baeed9ea6e2a4df91953dede443564da0832c4c5cdc4ee9c467481441d33fc2ed59b30d81557aa9580478e11a3ee8784bc01c19d431b160b0f3d4330e26066ed3af656793c7a9d8eaa170b6598c48ba1084638d87df100dd5cbcf062e8dfe6a7b0c6811a43a2b9ccf44616caad5be14423bc42b026852507a15a730d634f98730b2064d7b96c3cc7935a8b800fb4b3ea801848dc72758e1dd2cb4e565b69c5198585b8e59a0d0215bc53e519f4dc6d82db16604a5265f72d89631b48f29d1da6b5c28f01799208a6e1b0254e9b8ff5e28e1635571a715b0aa9bdef7a2065117cb8eea4ac9a3655e3e5d9de4cc03c1c553aed51024b0ec5ede69d632202660b18f01124afe1a108322a50a0319233e577ade05ae780117b720e4f180600ea40eb4d4d568487e2a91ece6f410d2ef88b659c1422ee843143f727366083c1fc77915c06eaf8b4aad1479669cfe2690601d46397c2b3a3a57f0b7ca5729bf7d2ef7c08d2254d3590f283b9ae19edd215a7e4bf5767eb0636b8acd2a55ae013fa5224c3795228d9145dea476a818a1dae2dc4b4c618bfaaecb6a803d27cf9fdee2669ce46eda29fcbd2bfdb9c9d4575b44b46ef39e6307c195377a7e1349121154fceda823c4dec69c0313d02a2967ed890693bd31d5295addd2e8cb807b1f619e6ec02abf9ca9e918999b445c98acea47a2398560c95c9bd33790d1fe98e200ad3cf82774a2e1f26098c08ebda1ba332be33594385bdcf631cb68f042adda22f3fc68d31eb9c6154a845ec5d13834e314feb67bfd498b99abc635d998f469954d80843cae18e87ac3927d672699e94817655ddc0c8ab66a5effb7546caa79ebc9b20aa03e0eca7c6aa9795dabefb4938dc86643422b86f9087da6777c3dc7bcda4287ec9bc5749fe837acc542f323798c0683a74bbb88eff3633e68788bcc1333c8730b1ba5f7e6137d364b0e2e85fb7153210c420bf8ca2e4605b8188123bce5f5dee45bd8fb7b1af447ccb2e57e6dbdd646a203a0b6ed2cc760322c8b28449bd1bdece6fe2322abedb54bb0445313d990894effbad2b9ef7ae7e2009f5096f1034c25ecc503ae1cdac7593486c4e9b477c0005c2a8070ab712653ccdcb1eea00bae653168357c99562acce7d33f3223851a0c5a2424124d82d019b497fef239bdebc984a4f895777b8050245a88953ea40b475a454665af25edef5915bca61a009524a5f127afd44a771645595d0864edad1b2c02ce6c814cbbab20faf82b15037232bcaebfa4babb89af523face14033304a258cc5659aedc2a770cea40246e01a8474ea453fbf06f1b9db88eea683a6757cdda14bc3db8b57a26bec632aedaefd3d0a2b38ecc0678c098cf3a64e63e67d864b3fb6f51f054017b7d272fb110160cc409f49c8f55f2f30bfcf8734e18a7f8427e1b6f6bb46bb505ef24296669bc33d8f4b9a8d7f671f304142f2312dca51bd475c22ffa851b07b61e2f1e608e03f0f9bbdb78fcad90e21a1bc08867850812b107583aa672a958136329d92c9c4463daa645e6cc8b729ed94723a9fd8f6314e7067f10c5d3031ebf0787470d4cefd2280f3c1f982025142777cea48f9e56a31b5e0a633ac069c8e9f104e2c6673a1ec11004bf0fc41da48b00eccad86203f88489a249f70e392fa5aa2ff0766bdbddd0be474a18b5597d60d20705ee6ccbd57c88732babeb2eb5627a4345589013e2d3076f4c5d824b8b33896f2a00980540123ab64207a124cf2e64afbd9c614e1e649de8ea14045aa632b7ecfc024ab42f3fec4cdf7cf706feb10a186b9b74bba6eec50e4e9b0fda38c446cba168a7cc8974bb21f6a6cce0d6f18e57447cd1f3beda4880b0df954cbed26d0841fcddf7926dd24f3082c6b12bb74e84b7ff20463704085af1e06c92f50330df2403e077cfbd2febf1c57f6411f8a2440c4ae2a5906b644e18f9d98d74d4f939d9a01aaecf4b66c5217292106b2507c56a57ad7ab1b58e70bf89b464ed2ed5f38cff99a11e8e96c61c3e3eab972d906a573359d7af78b26bdc4962b15586d29da25bb27bac5ac79d7bba7fa9430b67c404e561af466477e7545be95f7aa4c7ca8dba76e8e2eba1730e0706f12bdee655134fce11ec7f4717c957ea6c608e2f3aac3b3ed002f4f28c58fbccc1c6b9c72b065010308df32c7390299d01d8536669461a77cfe59fd34bd1ffb88b8830ea246cb0710817397dde765a30f101bc3e45607c41c189d537d652e05bbe9a2d1afdc4ff07e33422f06be4431365f4a3fc1c35c5c1a31592702ed3ead9a5c231634343c27d9e68b4cd8910c9d61d6200a198b78a204fe60956ee929be84d07a06fbf24221515d29efad525e7645d5ca795263422d18357c7735981352f6ca930e71380a5913f08499c35931ee952e97bd570f3f7b20c1f47ad28af88d1f5d12f7d11b5ff8ede448af5601eccca7380600f13e40b2e61bfecc0da1936fa181dcffb20d530ee9e7ca7bd5b04408668b8dedd70e45bbb68b430e9560246ad9fe22243f5fabaccacfe15ab0922453c795b292572b8e87c60c92aa2609c1887aaa7f7c7fdfa11371ee836ce1c99e58e99f492aa9841a590e6196b9cbb2cb47d33798214223095c5720060c191fc0792308ebfea974e6faf6a84884769650f5077b22be44c2a4a6ab611ee23a5b4506638d79b5152255e0a4e42f59f46550d80b69a8fc336c755003197db374339fb637f095f56bc8a6cfb107ec57028e3a0a1bd88b6213701b718254f1befb64a9d329cea5f9b5c4d48ba3bd23cdf4a8c98d79b0c7bd693626800fd124f5dce0495122f2c703824e6b7816eca19fa0d3f3a866a6d2869d7e8747af0b3c43d1912c4ea450bb70c7f9685724920af9e208f6aa406e3b7d907d3b67f475c870ba61c73f51616c5627bea4039f7336ea175b20cb4de1a8b42b2fe875c30492322ebcf25b8225ffa6eb14f3e26ca47ae2909ad9eb052b30bbac49d166098ea76372a557473fc1a5d21a4aff5adb3894797acd8dded0daf65c2d5500aa9e50a4acad250f23c6d4f6c91b88d9e61fc0a6582392eb01eba3562818194517617c4880a836d11c2ba81c3b029c602cb3dfb363d334c687e24f939b881a8e97341b604ae4fd213eaf2a6f42ce41ea1972403aa47a17b0dec01712ec2d91f234f0dfa88a7081528c12340e210000286f098a1e50d235a3759c416d6a2a50b496b6f9acd701f0fd32c0ecb33ec30c13db85b3327d9bf5a90e7904fcd6341cb378bcb66d0f1db241d432227c53e4d9199394a822769615462355f491f20b8eba824df1679da9ccca7c5b59763d4bec2e3dadf0e0ca420e58e00b82f6573e5873b1fca5fc0b75347dbbcfb07aa7c724358e4e95f2b53a2068c15982ed30c7f1f38a084683469d8da231dffa4b48e7a5fdb743d1c1e5739499f92a6ffaef06a8abb5442f07558beda521d67cd349de33ccc0f28058793f0758ededaba6b90cffa60f37ce8ee64f332622248a21ec2b0169025d825c2a1aad4049599e9b156dc1d1caff9ae2aaf7bd94908414b05c78afd0d0e6b74e3f002920f35afe1d1670638fa52fc7e918dea12f22e5ae02625e4c5826b51aa4815b81b7b6c90fe2f2cd0d985261222df81c43a02fd827c22a51b592f5ce64e3c82606eb0e407f00c09379b15c8d753dc22ed1d9f2a600866109db9db0a932179491dd1635000fc80b8565c560896ab8c4eb30bf2b08332285ba1851779b1b81493bd25ec214f1419030b7ab333c00295ef8ef708c4c81839fca58a6ceccb95af26745155204048fc929c400cad4cea8041275adb603d12372129296e01fbdf12eae893f2676f96eebcc458e7397c75655b596e8da305ecfa67d0df0a8b5550657a767f11bd0dc7d4c7fe16062647a3d5b3b61432ed6b0b63f3bcba421fcd6e95c553dfdecfdf234b4a1d044e8be86a28c6ae89920fcbdf08683af4b12c6018320d053b1af776a4ae4fcc900a8b2e9a8ab96be98d239a52ede072d0e8539d92c94b23898b776b487371d1de6954020896d21c799f26515e50ec5c52d3511e2a82f1bc44eed9ee586636ab562ca158a906487e9bba9a66aa84d28d73e2bbe8fb11b6bdf6913e0b1b9b9ae04804debbd8cb2834a03eaec84cd438eef627cf99662a7ef0469f0e354861fba4fcd75e7c60eb743c61a3dbb3d5dc7b7eeb7412fafa75fc545a1296fd5f942d16f6bcd0486a342828e1fd92c64180f1d8a5eea47dfebd5848c13604110ba7bfc88dccfc74176608a9d58ad93116cd0ec0bec8caf3c3e6530e95c9b68769fc16c17cd23f2b0d17b529f91299cc30b321fd6b8dfac6b983a34a8f631c5277c121a4d56932ba5ce9999477b74f58322204d5e935c4949ef4d1fe2344be0b1b048f184ce1a96abdc94bbd1280e0403f189d225251eaac8ba76de60a21074bd723317970737ef462ba0ab3579a39cf4bb920208a5da453de0e2d434607d3a2cb667a711dfebe2a1041a058104a7c07cc7c0f7c61972bc37c94b78cbd9e1bf8ff848c714144810a12dbb6495bd197783a53f4fc50b1c82db0ffa72712df4c26405f71c138145880eeda6a03e99aeef1f60ac243f226711d038d35540f8894c5372b898a281a7ef1a60339fe13040f24831d1191489d8c46cd4a9e5eb894bbff184b114352cbc03b873caab7bf41f92c7106b06ec05670600827a1c73f2f5f1158d821686c343ca1fb7c16d667b4503724d5e1b20f3bbf8d877a88ae13a03c2f08f123722654694959dfaa386d089ae44e216ba2b1b10c0418130038e3ef4985886247243a4c0c0c37441ab7433dada9f25fdbc99bb6f1bd538d2b9ba6c1002de912819a1626629b910da9d2dd80f84bf03eb7babdd9af8639ef89791677a99f338c553341a2f708f0fea5fa49f9347fac17459ba1e8dce02c3b51e82aa15dd7418d1521a3df0f6f8633b8770c531470a03656a38e0486435f3fa4096c3b3029d9092637b08e7311dcdb4387640c374f0fb1fe80190b2a4316e510107ba96035382815e98bf13336781a177b9f261c7e993a10dae5d0e1d2a9f53fb13a9e799c1548be7bb98ddb7c41c969eb436d7f5a18fa390ff63a61051eb431e1548acb783e22f8ace552325571aa54dd147048ba74e890beb05be65362446bbb3fb0ad99878a6eddb563e28fd88e69317c7c5880e335c1d517c032db494e8c499c4aaf3ffbfb4ae78947f248c032e886d37ee624c97324b8f231ab3c7fca20b598327df4c2f81a6eaaf41155d8a231978a56c2a0b4916e285b437f422b468fe8b9772349065ada2c9d03b37ee659732d3b09f359e32d2cd43e43da9a9f3a7b6ddb8f84378b15ea8ff9bbe2f7afbfcd8226678fb952ba8eab5b9c581a935b58852b085976acf31bd86979ce7f91312da6dbb58a6726949c4e62c468b4354d57a14766e6119347de3cec14adede84b551cf8c2a18c915d80dc5604bebf7aad70c70f9909e334fe73ca37e2a577cdab863e5352ea4dd0173812147e0fe0c5d4849b4be6397a254552e86d7b967f78ad512fa41248c63d21c3993322f1e68856f89c9aa1f2678017bdc0f7b8a3560cf25249e143bae223693eb541076a944235e35988655079a739c1840d4368d8d6bbc290d0ace2094882f83e9e15fa428537c773d452fcbea594c8488c842dbac5b1b1d8fb71ecff04e0e62117181e6e59a9462c86fb2b38a2f24fde4a015d9d81713e14e6d1ac7f76ead2790d7f11ee616725c586e130e81ec6155dff97af7266035999abd2f9e38e1504213449d5b4145b3c6ce87c6fede917da8b5c470a6aa1a9b2e2fec9100b21d4ea8a491d18644be6f0e05d7a89cb28c8e58b547b8b60e1b69f04288a32096c76853ced9a6d93afdbc522cc7418cee5f3d7528a90b2878ed8d70f966a7466902b92ace594c6da39b9de7b2f029f95ec402627c0fe226db533378fa3a94f85d2e58c65646c236cf5f355a82a41adcdd0c868bd7fb45b614c6be5b855937b814b11d78afa2f6315c67ac482cdd06b266d3f31c820f8c3f0db797d2b391ca58a35b6e58f4073672bbc8e8c61b4f2b2d5792cf5647e29c34f6ea401abea17656a4d9582f525df9cc5998839701eea3012c07c26e48e162662d4662a6368c9fdb7eb7a31753ec51a2e3deec580565848d9186c6d58bf7d33cf207477d44e4d017f22c06a879a86084259f7a6d7a1ce757e6fa67395a84ac72f0a49cec5bcba9afe2a4875bb85b52c2b71eb92e7c87854cce3276027f934dff131275479ab9b3ebf56fec249d5f36b6667c65fe53bfa24d8974d374954a54a33e6c3e370dfa3729d80aab272179bc4fa6255390ee001ffd6340e4dc7d2bd3857ee987eb9d3c4a8be6890db1ea4913d1e7a023494a9a4526a3351b12e11b0ab5be8be407f7f2b4110b8ab98791c4aaa95385dc94c5ca315fadc30d328fa4fb602be0b8b90082435d2b365c02931dc283594d0fae2db626f6b5e602648461fd089e4385c6a12d0b7e5795b05401cdfecebc73e7b5686eb323a88aa04113382bad5382d1bc89a956c3487edbadf9cbda4fdf7c4fff159adee63b52e5ffed03945d0365d03929daa8332da63d18aacfdec77c101006eaf166dc09ca4dd3462136a8bcf9f38e2506e389491d4dd72b26437dca7562ab319118c063835283bf4f8642596199c3f243f4409f580db4c56012e9510e6e546892a03faed57896f0012c5d7d517c27e36b1aaeb9234beb31b92ad3f8c001fa145eeb93a5d1c9db0645cd26ab323f88ea9985d68e9958839910a2baab93c43857d53c0578b539d3b89e24cf26cc1e7366a30fc25dab5591fa83bddb999f4cb0a11615ac1909b5778537f7cff9ac9ca874c7d4c9955fa4e22ab10330409ceecfc1fe10eb15e7397481c96ad3cd0457cdfee5706fd60f3b48f6bbb059f6c07b2726c7867bfaf9db6bfdd0ceef21ab938f71d4fab8e37c03820624d165f35af6b36014ee3623bfa9074fdb193479fcd9bfa28cfddd606b7c72a2d512518c08f811ab40b48a4c811df9be552dad86aa16aa7de69385458e1a0c8fba3c3727a4fa529e6c1e8b3c1df28b1920bc643a8353109480359551572bc3de8af7646a2c17d75b49a2e7cfe1dccea868839e056351609b5ec311e07854af4b04c189d26cc9239109f960bdf1718c11c815d8af41928173a7cde7444bc47b49fc1bc59cd52111de25aaac9d35327d744fc137a2ebc3598d3df219157d7350f0b6a9247ee78ab57f646ac468e324528e6580d17cee28c88f4ea5ced16f4bd37d5db5352c2c97f5925c2a0838bc1f7c237af091e0dfd4f81365389bfb9d67c9ee06c1d137320fe480d5a3fe79c26bef481b4ed3f33fac4c8ca38263a2f41639a2885eb2734e052d3a28c32da16ca273e36545bd4514c9ab52fb21bd0be93e0b038d474903b8eced650cfe950de7d47eb997da443be81ff530c40a4b1ac6943d09a067f1e92b5e38aa5a2fa99e29eeae5a7368e5c7b17a9b97c20f3dd1748b037c64994935eeab844c89f7eccdd10bd8227cfcdc51c12fc32edded7519549c3bbd07c77541c77778afe7a16cd277e0ba441ee2b5a1103b96a55e314385411cfbfcf97d837e6b7d619aa9212765821b8079259ead14d18812cda91f1e0af7030cbc2fc917e04eb25e93db71d693226f5fe48cc29759b8b62b525fd9af61b2cafa2e9e7bf49b08561a44f2eb6b754899a22ae5e12370f13eb86b57b780f3f2c403ead3a5550796c705df2654c261583dbcbd65c0f1be46ddb4b683553fd56b66684dbc2ed1f1f029aeff2d21d095826ea495bdda4abb59051bab8d2965bed8739e16fed3b57548c0beaf02d707d5e120d16458cb2c7d8a0fe08863e07fab2c7cd810b87caab913daec59b4f00028e08330f76eaf535c586761d81ce513619686076f6321fc8dbbc4e2482f905fea410947fe8f0aedb76a51ef0354f0263b1ad515601f66efb3b300b01f976e5b3ecf055bdb5fed654a928d7dd69bee0aa7e85b0566925bf78a9c686bc2376acfa497112caafd4cb65c5a0ad31a24737f7c3950bc7c5b98ee4b30228146b666c422e6d35a0b3fd6ceaeeb8b830313dd45d8c554d41bf281377b0f833b8b6d1bc8855c3092dfe1b2572678f037309f49fbd4834be33b3c40d9f50ccba43748d97ee420fc1139d01f8fbd1237f69bb58eb4207b7bd7107a85b803e56b648a9ec26b04f55c71e11db3e344168d866c20bab24dd5c9a22a0b8a8e133f2773ffd13f75f213426620e7bd77c32d0cfbfad5fc7122725802c1e89f3710a818c3fc1784841a3c7b954fb22c70340e3818855840bba7d3f61e3a86adf4f7b0df371d11db5b68f137a6c21e8f1265441302790b2a1b1e58656bfacc89de7a7256439b43d8d324f310d6f53ef70553af07a8ed74da72797fe99a503f77d4df9629fde3edac2553cf11d1341e5aec7c149033cd760a08219cfe230b73d62079b79728de135d84a4fe1d42cb021f5fab569525f8a359ce5235cdb73ae0b416db7d86a6bf17ec1007c3546e7e175f89d2242e4a0029fdc1db4a2f381c01bcba98c2178ddda433ce347b4197b6a38332e617d58f6d3bbfa36063b024daed891f11103284ee5007e7bf482d50514f59791723bbd1e86c6c9c2ff4fc7bb5a02a66dc48c3c6bf2d553d3bac83468585ff62b518527b3845c78babb09f4bcb08f938f4e9b1b5167e8b0c66a79092c428bf8acd19a4bc223515ee201dca60b52aecf610290b443bc842f769501029b8e200337d7c829731ffe491d9d49d001980284005b2dfdaec82361a2cd230a825ef56efff41d30bb8fdf324e2f0227bbecd5021c391d4359a642813995a6dc12eacb3697c71cbab7caee47c91c3062f3317f3c44626af8cdbb4b7080c58330906bafa2135437725c4e74d1428bdb16d351c33c94b99b703f60b099c0570c2b15d4058ed7f7d34e014fbbd73391573c9145601d49ae2da6c61baeebceda74144a2ce7598ff89d16b12491ba5cc6718331cd4fcdb0d032a0ff14224cda7a5756cc1ffcd215e5cf7707ee25c4c4396db13ea16c9df9f6d065bd39f5d4a751e5ad6a94032585331d29d199feadaeea635f85a1849281aaa7e217dbe846bb471eb43d974517a1c957c0ba9474e45e9e623416579af66b3fe66291435d0bb553dc2603e878fbf17797db4e3d7cfdff56cb38ef11d566f7922eb822e9e4f9194955c5ee2b5c3e99bc90a4c9d60c7bcec39757d006aade8ebe5b1eb2b91542eafa07fc4143f52aff2230db469dedcbf2f467d05b1375d1bf1ae5a80de0645035d6edabea4d0a70cd6f3a0dda225183534cdf2c1bbda1c6345e3e4baf888816fac63809420715c61d9c0c7d09bc2882962207d202a41463cc289a45c0dcb14378056c99078ef3a41c2ae568020b9475821c708fc2676bfe55225f3cd6ecbb89c9c386261eb149a52b2a8e8207b63adee6a56d0a3eb15cd110f978e0aa49c994a5d932e350ae4de14a70f499e9d2058c66dcce7839b6e949e343aa5caa5723ca9637796fd5bd6645a2dfeab293ceceb96ba41704e164b95e01d3a34e87cd8be9033c5d89c0d79166098916cf09ef370961657388881473f17cfcbcf1332f04a218f104e2ea7c1f418ff5f00dfff346abde820ac94bed3501b0c9315c9f23ef6ee9257e9229214c538e247d725e84395026f740b7c3134baa7f60a2531c96cff49442911beb2b1c5d66b9214214be774e2a2523a98c85be81b45ce091a0101916ba03795cf004f8e0b9f580b8fb43ff342e419a109af65ced3ed6ac23e0f89cfedc893922f6bd0125202f0ece81f1b3cf2df8b94ba8533822a6d5fc6a8d630afacd13366029de8341c3631251cb504c9e7440ae592cc7a182c8a4f35023191371b827d3a395ab4793bb128bb970c1f854339968918703f7ec0ae78b6eeff53784fc1f9a5e628fd4da77f32a76ed9dd8c8bbda3a70455248901fbf6cee7b12a7d33283f1e0aaa4a4fdf9c02b6241b767582433309fb896fd5696852a3dfec36953c0a737868c51ff79fa6ec997fae2a02adfb6e571b99269b17312594f512a93b5164f52ce6a7f677b325245667ed0e6ad8f511758c00af080519740ce66b242ef92abfecf4622a0536ff0659b6775c85a06ec5623ae345690c299bb5e7057d8ba00714edabf2d3cae1b99b02d1167e46f75085c141b98265856155a9dc2a028c5dbf80c7b31aa068b6818954db26416e0f6b290a4778035e62ee1ff109651b44e10774bfcebd4627dca5ce48096ad8c177e81c5a2104edc8e58667a33bcb67fd3744bdbcf5cf021242253d4faf40747b4046b660fca9d6e34bc30caae6b6c8e8afb78b31b45cf293d10320cb8940599885f243c3ae973a6857dbd1c18b20abd7e6473fbae750aabfd0a705a3cf6626317bbbf5eca390f6c86ea4099d8ebe89909927aa9507d2bfa775ec9a2762d33ee62c7cd31eefe4b0909fede202b66bfa678b163e5478da898d06a54103e23867b832860b61b8aebcef488ec2ab09c3869ed0ad90461af4e324c26475232d2aab264d60f9f3c324190d258ace8e82ad7b7944aeac1ea323de06cf6d810836359b49b411b308013aaf320fcca5304ae4734896a93a5a66213a1990f942ae3b9d6a7bedc917c9ef0c04f9bd3ae76c15cdeb515621bc7b8179ba1ebfd7c6a954a070b0718bc60f33c51509d1d73005581d4420b82a350120f3910388ce36a79efe76cdab45c59ede91191e46ed8c411f3c1cdd9ee5f2943dda135aa55f405b6c63150598563f766c60a0efd5d69813e20b1fff02d154b999070df23cb096702d255f45271267b859afbf36639556605f19aa12dab0e391915ea2b9be79cb688736ae4110574bd25675bca2f46269042fde11adf1a4f6add4a79ae610c30dd3414c73e9c531604c52eaeddacb82f366d2cf6265a38c598e30b662f8f81294ccf3c4b39da6198d2e36eabd14d571671668b8fc132e492cb3203c32c44d66f7930a1827a6dc53614e885187b90e1e8b075fcaacec01c71e48a254a0f443bbbf1226d0c0da7250f143ab6deb6644218cbaaaffb8f81772f543824c84db86826ffebd2221b1588fc545b213e7385b76914442e616c67daa050a8bf35d96b5159d9ef7b7d2a393f7488b30c70365802ff235ac349fa41b2d27e936951e67f264d2526bce6f122234a24b45c6b0c7bfc446212c3a5ea69cea0dab3e8684beaaa46c31aa473b47588b725a6e477fa3a1bb89cc86ae6af40412058a42f3a6f72a3c195d511032e6cf80abbf88d06b46f7ce39912d36deb8b0861ab5f39b7bacc11b68ac6cca6a5cce85aa946663216e977f2993b8745986a3baeee975310d51cbb4f0ef228eca00620fad05b80fc155e0d614a438bc95e3e4076bff0a8a4d03c80971fd8630cc51191d9eb9e37be873a86683aecaab760b4364586b2f2b35e2f3fe1d67a00a664102e42e90bf500a07c26fd860eb971a91b5d83bca44c3559aee2f905f727ed31ce1fccc5ae6283ad10981b20c146a2b4d1f29cc0c575b4e8fd4b06409bf5b31f1f80e10f6b2ef4cdfc1abd3f4d096f6e7660d7728d64b145d131889c80c84dd988587f43803a823840138735f4072695518fcb1bbc480d84fe2dd46ea377c7691af5c97a1596ae5b0b4a8e609c2489ba385fab9faff80254c7be70a263dcf887f292eea422fbe9081a64a5bb292d8a4d0dcf18cc554a1ddc62d5286a8e55d4bb4b1d281ec29047a56378b3faf76b445224d72e7390c3ede67c55b45da64fb798a988692123f4f43d10e9cebf71bc019a81bb3b84dc2a8d78cdd14a85c56ae8a24424435e2e8573c705742285b13a7f064fe7422fcdbea40ac74196888afe57f162c31c7824f94ca029a9b0db3ceda9085abb589210c468e6664a7690db3bf755dd6c33d69373dbd8bb3548854a408ebce574ad88341ba61ea5c0bb5a695bf40ad40c51a2c47ccd4b2fc4d606b39542e9911f357af8da95faaf6a29e5709f19bb5a2c37237d11f7257a199f6f104038067c316bc132751eadbee12bb83bf76c2f6a5b18f93998c968c86cd91a98d3c27111834c767ac3480d43d1814426856b4c73e5a38cfc6a75671bccfabec18f18c865a6fc6cf67fdc80fdbdbaa0f49c1bebc0274866d4b4bd3e8375f6dd2c31a205ae93615126be238b473bd4fca7c591d9f5d9d88fe2ae658cda70042ca01b897f38526ccf69b10029df1e6a92bfe1c56f0bd275f4bc84e24117e6f33b0ad19b5c927fe896d1180c9a21b2ced12daa9a2208e13d1d33f6285ff3bad69af4a8e90e13f448c3569a150700b1e54ced1e6936374c5fce87cbac9a7c89f62bd86a0df3ddc943d53558aedd2daa19f5744eb157d433a64e674890806710f2f7647988549dd4dadc0da5deb4f584ffb9dfcbe8bc4388fa141c1ac6be6acadaa9641f556f7f2172880c7fb8b9d73356824e402ffd61d6780e4ce40a678f4d29dca6c5093fe27bf1b8873637006eca606bcc4abe3c5b53cd5aabf7fc358d83e9d7cf918046f42a655d34ee7c5a05527338da355baa62cbef0d07f32ff50546d7cb4361f1d2afcb5597b46b961dc3395456bf77d107cf46ae61c38e4eceee7f4cbf7c5d53d4e4736e5035833fc8c9154ea6af4f2e10656899ea8bc53cfa38685c390fcd48d79baa41194ececbfac865e472df3a791c32c57bea8edecea96d8ee1c55e0d7d5aae17642dceb001eb9f79031313704c5ef371a8182d424b72da574667eb39432654eb3f7714161f1d5c3388523901468238c4ce7216c47fca3a315bcd572c1d93cc95593bd56b2b093b454a62e0789e8aee338e29fbf7556baa96f8fcb26f3f7c1e172fb03e0c8390f737f301760a9d3b2f5dcb7ce1ac22c2c6954fe20a48b466488db070f1a538987a00e8aa92b9badee0470390ce6ee88e41e5816ee1bb0094a5520f9a2fb20bc6952d7fd2b70b2776f0c0b5b8f4023d5308c03114a68411bc71ea59801c1270b6ef376de5e6405b7a592d198f527996c96c601ea5b8c9bd2b1948b1b25a167eb2c05c4c1dfb22c60302785b924cb6651421bae57e91a7bf5d5ac9ab3e76f48d2ece1d34c747621ad652bd9bc9467813c2b308c48e8840c82a2a442236f0a945cf86a7327a1d4f022fbea0806257deaec7ffedabf15e37faa6ad644acb7ff47367dba197a6db335f47a8eaf60ec9f89ad0875acbb2526399d64c91b56a5c8a22aa60d2a050c6f0646e6fc496910901c7fdc2483058237a1b729f4a8c04fcce79e44a5a4d4fa3e63be78fbb88d99d867b2d37e48ecf9ffc7764bfcb166fc990670ed7f75d87d49e31ef59dc54bee66538f6550e845c5841df9973493ff18016d7518131b44f67ebc3ad4405cba067ed395601c7e2c9b67050c2b5fe115dc624386edd464e67c82a090ae03b8524ee3b8db5d82a5733e3c211a8631c8b899492ccefa2c54f0e60eef3f606dbd3cef18d183cc4a1997551757efcf7fadb9627384fcc1138b33846e8f0f2f5a52afa930cd375c45cd5fd8cd2c4190d0a2574a9673aab45c6fd4a02a86d6652fb6c6c34feb6633ca5afdc739d5f086903436da6101074b82377be4bbe07c9a50b1b633de440d5e8718dfe09937afc8bb916f59fdff0f48e9349971287704dfef9f95368bda32974f3c17da26d9fd2a96cda944cbb7b41e578ada7586cbc2cca606769d53475998cea43bb08082421ebde5fe3bb2eac42cda001e2de6bd39368f8db8ea15e6e9358d3a54d5045577748ee48a579caab13600a9f2ab9ab5a08bde88cfa51ba1961cc13d8ee80c9121c8fc9566006bcc3bd757a30be9beacec6260db84e65e0e3fa029164d955f1ed290d511953d2584fedd7fac2a07ccf0f55908410091bfba738664a0ea6b0bbf4e4813d119fa2b433a57a20c3756057450b72c1f507a583a41f47fccaaab4cf27a9fc554a7645ea70322cf8c6afeb2a37aaec9b69fc476d29f0b214f11191c8cbf48e87a65acacfe3327b6220cbe98e14ef2844a82ea8e51cae404075355b91148f6148d515638fd5598ab0ab9ba99371aa7abb9c321e49f82067911645144157ce6b55705b8e19113e14d4b2f0d1b208fba7b5e6233d3e508ff2ec67dbebcd46dc49d7f4048bb37c9ae1061cebb547c60c608bdb53bb867ead0a472c40d3222d8bbd2d02a58e5c5e42ce845d30419f1b483271c86109f5223a61c4c1e07eaa5b63cbdcd324b619c245a9ab918a0bff8973e9de66c50c3ecadb5276e7b87357e70a61f4abd32ce1b3f5a2adfbe2623d2f93ab2ff7eb6a36e9b9441d8e3cef0f806cacc20cd6e7e1be9d41aab4723548706cac86a456046f08443a119bfb9016ee2ee292981c061a8bbe477d4dd07863e133c8b2bfac1e1bf05caddfbc663a08d5242adf6cd8ea280da8f9a35184","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"a04e2aebb4f065114c065b7fbf49759e"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
