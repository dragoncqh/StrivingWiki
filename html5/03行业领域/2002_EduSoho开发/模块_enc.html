<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"07879740a6d99455c823e2bee3cc948c4dd59be771d4c5b5bdc7111c0bedc458c327506df0a3b7a69892a36652aa320a5a448bc64f0a20063fd7b507fb84b60899deb2337e1deb0ed6fb7b25cea542f11563c683978280785f728873b3e15c1575677219e1580c5b44604124751e47dd4d1f8ed8267f6e4b81656abdbdd5120da322e2568185769303a4ecb2f5664bb8dfe541e35b016c5b108b3dd0d43c39dbf1ad9f06db1de41c02a2403787910723404adfde601c29b4d0a37fc208e2f7da2213aac09a7d35de723b9f3ed530f04d2a2dad2d213e17351d6ffcf462320b8f45c4fc6201688cb264518c3c2559fc492cf8187007535a896cac97c543c306397411c2ae837340661a6438f987037860e92d6c6e82b0672be98b6e47be26bde4abfa0e5f4ed43386dd002ffb03525ca050d72e2e7e9f3a7f77de2dbb4ec9ea5c2dd6553bab19aac7ed200149b3d516114728412360682db254911700390d0275a275467381b09bc40cc5d266e853ddff1e7f8b07992a7194869c9fcfa7095a1e6cdb1577efdb0842696cbf5f4193a81ac0667062e942035c4a44b9c0887fd6271a23e862e61dc180679ac60dc8359c94db4fb243d076ec8f7af877110b756a2ca60585353fc10c3d0844f78d2cfe28300686cf1bff314801b4cf190d6b8bb71a7fc875ca9409a429dae439ee709bc7e166769a210259a813a6378005e64ea2dcdb381fce6d3ebc0f044bfbfe582ff5d5e38462027751491c0dbed0c79b8eedfc800c107a48c0b28750a27586cfb68f61933025e08ebe44bc3f60fe10c65a4d4263ebbf313e7e28da690bcdbc1bd2c90b6032219e5ee48ec260910d2260dc889e41ec8b6616a1fc838da19b8d1ba2a6631b974642b05ab43e83602e8c89786b46e9496e2d2912d9d212519e713e57c2dad4e6a19f16b2db1a26cf9542fc95ea639c00f5bc2658f0c9ffd8b3430d1afaf92c95f57607974f5b6788a92189697e49dda84f4271e50724288634820208d9b3efa752634e1bd461bc0e108ff37645295b9d7e1814376c6982608270c735f4c787c49c6359e852e16b064bf8bb922869a7dfcfb510543f49469a33b6bd9ea503c4f6fd027a515e32f4b47f425e04ba9647bd86f408dbf7487c21d99e26edd9aacf1bdf799726c49a86a2cf6064b7b3aa4e2a96c3e9569d9d6cd4ecdae7099376f48b609caa5569728a1a04c2c597d4630fa146393ffa8f8d03c8a9648bc2269524af9c3a51a80d0b75e6f4d29976f8cc4acea4f0128083f07eab5abd27e860faa3a07bbe2555e5302124a4e524e35e25cb2de0a20e282f345ddb4ec69dd29f1d0f9f46feb6fe34a55d76763fe365e686c543834820b159c18a505a7a3d5c2f8c6f3e68ec17b3ff25024a9d053f1f9207ba3c7eaa0bbbb2e28df81f2fdd5d85fc1a43a54f1a587cd1fe6c47d721878903017874b060055629443ad4578e251dd3b3c19ad22390696dcecb3aad66469f39201140ca9c9da73c9deead53594c2a45663ad14936f8397af76615a14a2c995b0d15658cb8c755ac6111d0ea708babc8bd1eb6ceeab055e1a9cf4d7863fdc29c59fdddf75de0df1fa9aba649a9a7a686c085d05f8770b218583ff1e03d770915c7ddd542eb3e388911dfa603de12867344019baf23dd74afd707805c0d18a8f9ea78a5f0a978cc84193217e1eb7472856bea311d6190380a77c92240cc6fc292a69e2f8e5a6d5dbc1eb9af8bd2d28d9ffa7a2aa0ea8f6782648fdd3b40ce4d95ce0ef6e4dd6b942949add26e7563dd212f8f3b5f88699fe3b6445ba7d0420fe3774f0906542ff5b40bb83e899b4fbd2bf2eae045fdcd518ba21f50594797636daee8fda4f48c1ac58e3c969a304f5d20c8396f40ba2deb20a90e5c0efedb58f8f8404c5123ba547b6ad911a42c144a39cb101768a6857cea7bf913caf0a01c5a4bcba8fa29e8a5be04addfbac5d19ba143ce044796543ff94c05d5a88ba7ef984d8e5e4d4ee1c8aad145a6f063113e90a9ba3fe443b850aefc8990ad5d3534b1f7de88da729df62cf73189772752ca59361372a10b35ad80366c151884bbac2cae49cca388b1256f4bc7c750fad40cfb54614003d5fc55a64c09953f32bc7767308012e02132875aede763ccf97546a4c800c268a8a8f7871d6462e940a194b8c309eddea403e0af215cbf3f95477792468595aed13626bbdde4bc6a31ce28c0256b87aad3df9749b886d5cafd23738bbb780c25a537fdfae5e945437f130a2a302c0f7adeb479f625ebd2e6cfca63297cccd80c376d0eb2db6998d51aaf23df4329ee1bd91e8f30e374079b3884a48367fae4b4d5cab6b23fba417f731cb9bc6b4431cc51ca521d221e94d0aef8529318eddfdbc293080634405afab9e701bbf046cb860010de5a8cfeeed1e2f0239e9740f04a4b09498ed72cefd0d624702385efc03ac0852a3b10abaad5b6db66dbba1a0dc33faa23e4b2f1390da889593d4fdfc696c0400acae6e6341d8cb416caae8dd989a7dc662483ca9c08a1dea077a1f4a572f4ea1e6461f3c405d67d3a2fad1dc61beb5ca3f1c65995463bf712d1f6d248fe889e72d1a63bea1b2b73361d83b19a4a6d790303dd917ad3d8bc50d17602de00cc3878a89149a4c0c29d558ecbe278dfdca5fed1c49374c3da9b2b100685661a9545e690b5d9ea30dd170f27f1c9c2d065c44923a662693557771f9a1cec1861b38db57c56fb1c455b9b9680f551a842fe71dca46259d9f3fba55b4ca4e81ee0e6fb5c591cef262af660cc117ade0838bf36fbb435f57a8c6de2cd57f627e2b6775e51e33bcefaf26fb5ded1a269583f08099e7b438f55e3053d403046ee89d6f0bfaf14905537bd2179818c2de84050fedbf0e9861668494b139af364a8c4d1e02aa5cebdfabd898986c70d83362c655ae89dc37f0bbc268165ddbc5a4de48f0cc69764bc95939e92469b809d2453292530eb1a8068ccdfaf42e4a60234a39a7539c6a1d84b7abef7805b7fd5d26266b1e375aa7ec7edc7a1fb057ceab16db941bdfbe5c099f37925aed436ed3b336ea98677f3df85415661639d2f92e814b0ae8df82a92e3b426873dc702572249310feac29fdead2363a02980e386491ce75b4dfea5a04cd4cb6004ac79f0c222c3d9ad3bb45c4552cb30e74a60c4bd01d7097606e07a0e6923ffff794f82bff7e8948b63903268144833c083e11af438019fbbfcc859858aad220e9051cd487db2bb857d1ea85eab33ec2b40266c878e6c82c3f3adf97f7ba90b0d80d34ff34211d0555d6f4430e18892cad9c080c70798cbfe15765e64ff7e67f5f1b0e519a6662f5f64012734c53c13325af4808e1a3dd5bb9fa724405d660d57904e2b45e907dafafe7219c6745e29b0e12210188936d249852dff9f6c74b57211a91c1cf31b77e5caa9dcc615348df4d8b23d08f0b3b179ccbcd6ba6aa01aa6cfea685ca8ea98b865b6987e316cc6ea5fbd3afabeafcdff7d1603e333451736a0ddc99c20d269c609699136a9d4bebcebfee84ad54999c4d2f7df0ea5b0f8973568f966b58293203c0bf29e81eacd166248d80e9227b52bd539b1b6eb30921f4e72cf478d2f8f5cd669812e749fc541a6c1c17fdd57b6dff8e0750bb0a3476849e8b20823a1221a26b77b4760528b52bf62c5134c9e7fb0321e747fe40c81d285bea4f705d6ab9a2e67afe92a17bfbd139be4c8b8d8b3221fd6bdbfae9e4a85afd83f25cc4657a1af2440b34dd767fafc3381f94ecd38aa8a4e9cc450a11228ed2e1f03ed2c18ead870b35ae4db39592489a8ecd6b58d8ec2dde39967c28851cd74143f8851caad6c94e5807fc180faad2783953586edfb252ea9d76ed3438fa7b6120e367893aacb3d734662648daeb8f1f3a153edc0ed2ddee8b778f4dfcc9cf3c64db37741fe832f3189b00872e451103438de881ed3b5bb206038411d52afe17187d930734db10e69e24e14f2b457b2bd67f1b21340acf06e1e5b4d897d5b608943b60b87a763677501c3af31a888f43f06d609700408119897e63c4c03c227a80084b515d32c6dd98de92383190e56bf9b97df1df21e545847df2373164f5dae74fd3688fd655676fe95d0cb09f8dae57e37f700fdbeba4b77d774b631cae7c1a8323f1a7cd013cbe8ac0ba861e904b81810662643fe69579c50fd0825d365e375ec34d16ee35492c5b31f5f74f2c500d56e94c8f4ab50c33eeb6753a7e8a02ffc347ee23ff3e062d378b498bcfe84a01fe33dc75591f456f08a8c5a2c1c4921f39031590de7ce5944b3115f208d2f84a51f9c201515d30500b8b54d1fbb9d4c3dd1dd955dee3910818ee07f95fde1046b6bf0644cb3b1fd151d87bfb3947b3ef4385e38b9f9b8c55d5c2839e54cf88663e3d93427e39d03e83af800ebbfb3908c783964181d94536351e95de33fe1af08f49c0619fabbc8ceb9b69185f904351e0e7b6e99cca028c818e15cc5a6d4849b6a7754a168106d42dba740b1b8439140a960de672bfbe3170d4781424d98119ffaf77b20a1dbec34e68eb4667e5a4405035f435794a845a4c1d5d8f91cdfa0eccfbbf72e3a684db96075f2d2b78938ad56a467f270c3614a7289cbd59e9d88ae01d41e88292c35169cbac968fa972d4bf9806393815c855b503dce7d0da96feff068a34bde02032f6d5ef25eebec2fa1b30b875b79461d0743380162f7de617311db1053f32731e3956b833e085f08eb844b6f01c93cd1365e1b0552dbe2d3a59d30c6667272685fac1bb1768ff8c560f1f4d297491a5f1b7ff16fc7f03acbd1eba7224dbb00cd67bac907ca8e4b114b0492751dfa60cb52e412f03ab717e6deda624b5538e99e1ae5c3317ef5af0d15ef0c49d1b5406499a7e51a9f7dea8a5b8cd2f249a2dd8110ff582a70dd60bbb2af85659cf3958e1fd452be630c8fcd0f2cad9c07b78c51a7c82b22f5aa9626e4fb80986effe6c9319a0eb76819e1c09983c31f698d4f3ab2fdcc33186b342c641b481e167d368651b9585c104fa5853f7cf346609335790b9f830db25775eb43d0064bd18324a6a58184ce2e3199c127e35a5451d2f5e4a4316fa56e75e4d20139d48d8560a92eee162326e7b8de2a7a438ae320ea76a6146120ad2299db351eda58eb179e88db081a602bc81883934af3c5eea0af7cd18e6f3776af43c90cac6a6d5541336431e92d0130a3248009adb77d2a247569c2509ebbe36cc989706499cdbc5c495b85b85bebe7a6dd1e85a29e4600aff1052a2ef2163f656221c84d342df3eafb18c94899aab4dc3134411b404c4f71206135b3807da7a51854d85ae97f6c3d0ee38d417d035c23bdf9c224ff96846118f92f4d8e40da890d8b86fd103ca26abfc0a9e4ca83f27a4c9f69f60ba498d79d011edbef4b16b10fa4345d058b4df005e1cbf2bd20de75289f8a1d5c16b2679a1a77b0c054561a862d8f7902f2405aca899d1a01916b5e7f05420f1b4b4f21a806fab0f40ec2c02f943a865496e6674b06396f341b40cbed282de83d6612ad3511530aea281700b5f5800fa8c8b656feac52d7f2d8acf07dc4cd93216ad54679b90cf2295534874ee78ac1ed14eafefe7056c0f5d99db39787bd030040a6ba597bc3329ac241bfa5ff4a9ad9aab5a3a4bb7c05a5f0bcf62b1db3dd6aa4d868f18315045b3717bcbaaca65941dfdcf69e7319fb8c04c6183adcc550b4cb710627a5fdcf54e901f627a648f996557459caf419bbe515d6e3b1e9c620d0efed4aeb2d426eee3fa6cd0dc748d6caa7f8ed5df8ecab2d7747ebd81aeca7cb21d660a9623f639452ffa798a09d3d18c3966443e62b77506a06fd2d20ccc71c9998e4bb1c0e90583da5eeca3e1fecdc27c12c10cb8946042d37cbc58a3e9ef09a709c9e2ec51c6c319781df30636b0ac5fcfb62f7137558727f2286453dd72d9783225fd467464e9c77e863c4d23b4719478c1ef83f47b21f5b24520192e8bd77ff382321e1ced39391997a703058a8a09a11e467d2aad6170eabd1d4501fb3af8f5781564809b7280ebeeefe127eb6ed02d20ecaeb7175ae9a57b5138027eb6a86fa6a47f89992a8028359ecbba5bc90dcd0f7a02893e932a83d113508110f7f98e18167e74e4c243f092abe504553949d58c74a3d916f0f79437ea86a9a24d08685ac2db36bf119b077bd299e63eaac6151ee42386bdefb4a72922a692b37a1b28b82f0b7a719b6f8f0abe8f070868179807a1958687ac5b4eaee0fefafada6c7f1818d0a934adca06d556e88e76855f6e700738da824143103fbb4d649665d3229352904545ffb8dc890df7792867d1d9f51602e8ce8ea19b03f8f56c3cd818fb218b5bee4a2fb44df3e203488cbd00421017d49c0ee462ce6affc9bb6c025fdb29fca34ad29c3219e62b905ebdcffa7defb4cb25578f424edbe9b93a08d90dc2411b2b02736e9556a96e3b89e637219b8eb8fad1e41ede24631babcc4e130a678b445d11167831d2299df50ba278f5cf2812b49f6c8aeabc478f16b138974cea9aceec1a51301d45a73bd9293d233010f7a63001ffba8d9d4ebd929fdd07690a9ea188ccd3aead8a37be02138b694e9a3465fe5132714ef520bce8616c5409717f5e65ff0e0cf2906d9c7d79b5c07fc1983eeb6178bbe6fb78a67d774b8e50803463c3690d4cf7512a51ab624884d0728708b42f46a11eba4591262972ba635a247b864197dd2345ea342906a2364b97de6a8717b6b5914ec7e974aa2f3e1c7a371e7a183a598dc0491795bdcc33b3878c05e8a07734b2599d97fbfd3591e21315f8b1252643365223610e3015ca3ea31d72218fc10e106c6ac10636a0978b133a4057ac1de6190a1b309c860b0704711528f1e07b9b96539379925568ad779f1bde0206dcba35b294552552ccfde3a2445308b070d38d87a6467799b3ebc1f6b789abd2688b031e201e41f5c9c8779b4af0ee1eb3f969b748f927ad564636cdec5957316bb3c422b719fff0327bee053459caab3a99ffcfd11f3a6f9a75af7a92db3b77f43edce1eaec4106701cbb1d105eb60bca9e8d70c79b9bfdf5c752b67529ec29234b74ecc9bf1ff0d44cfe9739960d0906a7487fc48eca41d7bf3b3b9158332d7f2a31f245765f7226a3fec15633c600079bb907411d6b6e16658771b25ebb782c95e566832952110e712855efa889de12428a87f47f5b77545c02bfefba3dca7e68719a48c1d6671f30a43470a6a8e798167f926dfa7140486f6bde1da32ff34a7ba1b611f9f20caac64b55dfb8fd3d1a30624fed059f61a1e511c98302f5906b3bd569eeebd556e182a2615710e9e8542ddc5114d7ac70458b83d7562a34c9fac7ebfbdd177bf4fe94842cbbced39726dbac9796fc2d021b14108652910882f2d143ca884f253f46e32244f0a611b3257c5afbaf13c943d4e715bf0bcaffc02be093bd12deae004c648970349e12b1be2cd5bbbe3136f9ad003665670ec9ed586abc3aca833900f22bb1b63bd92353813164af295dd12441a9742805f46636f322b217fc2a39e5d2ced39ad18e3953ea0a0b14738fc1d672157b57c0bc3415f61181814dae674d4a3288f53fafddb4253946df25a7b7f600ec6e188c10c5c1ffdb32c1c22790ab4a436ec37ee013a1b57a47b8495fac6161dbe754ebcb29ab83309321c35786cd433a6796b8760dd8bdbff014a1e669c89b6eca4bb512eeae05dd7837cae077691e5ad3de9adac0c3a10924d5bda93388a4578b6765d9916a52505e607e1f744540c33b4ab990b21df581446e243d8bd2603a6aedd9f6dcdaac0e5dcc82da9a5b1727b9d3f07b38e908695f3802b7598919030c16ffcf888104f68c38575c7db2616767c494bb55a9a5a1db32beee961e9fe03a05c7b009712a2138d1ee7a2fb8da2ed555215d786c75c0c429efe866fc940d8cdb98bb758b26b24d73c1b66cac215a3bdc24a6de736a433371c8484391e97a033c89f95b46f41ed4331be1924ebb69a84fa5bc374692d2b91abc38d142bdbdb3c06a410f5ce19459c283496a9999afdaf32395367939315b6afcc33533f9dfe8a3d8597a96a779f9e541986225a6e733700d136c8d80445bfc62d8c7e1561693c8e8364769fe0e37b037444d8ab64473450c4263e8a759240f35fe56e0d556c2f50d8ee6191a94242dd2d58075b81bbe8254381fe2a13f8ff3d6396fdbcf551396566fb4363635d8d377db2928325a0221b25926556702b192f893f750851f180c130c4a43cd50c260e6a258c2efdbef91b54058706ae131453815f137e2b242a68c33fe0370da78c161cfeeaa87ae7052f218679a0bbefd108c8947ab2fac747630baf79ecd6d5898d0d4f295bae9b83c069caa5fa71129873a7493bfc82db4f7387d630e95c3a3ccc58437eb78335ccc989eaa8e53eb133a6e3f3ccd46e7135f6c56fec67c1479a6dce882369013533ab6c0bf37e036a89f5d9afbadde0789d387e0effc3776e9143159f505ba1b32d6fdf3230cf7f99eccd0c9e12824258cb85cd216a3e02af110222c126f140801f9daaca29300a21599dc49385e085d170dc0da347e197e4c77f7c8b384b9c40b91157ac38011e559667d6b7a725e20e8e5d36b4893411438860185d5152d27e298c3e379f2bbdd8bdbb6dbe29642a591c2b50e10f4438c12c03a32c2a345891261eb1e1858b0a8f223da54587d9c1531c2507690d0c53799014263d99c48109b8c00b42858a29f56384a3d2f02fcf9b8adb339651316ddd1899807f5fb8c60ecbeb1a82e90d924e99b64a57d0b1076881cad5fe5b56aab5bb0a9f735ed5da2efe464a701147f26b1d938d324a18bc279f39dcc971af34e2f71d79b678874c4e1be0717d7d26550db514767c401dc00e38fd9edaff8f78442a96dcc73f8b0f45ab8610f79ec3414e28ac0204c816192d5b1897b31f17e6e8d9f10ba136d9192d2805ece450c91b56edfe399812444686d649fb3485378e2b4d469d738cb6a961e10f931777ed95c15aea97ae78f742396689982646b42e0ffcd23240d915beb043bc5872eb5726174eaacfdcea7c01f29c24a24711bf6903f35455194f992530a3d6a7987bee3edd7d5421505cf4d4cece99a7b39f4583288d57a6365c4fbde0818b2f3d9128a6d8ef7ee4a96a135e2035c05e66feeccba1949abfc2d2089f841b424e0809420864ed3105bd80cb872c17330b7832fd23b14f34a00731d27f0a98dbc615811a39fb1d29330cb9f8abd56ab2e456e9911d8a49fac9596d44ea3e9154bdbcd2a54f68034b7f6402d80ca4424fc1bd3e829a3587517aac6efc06d256ff28bdf3cc5be61b97070c96b09849da4bf841c61a32f86d79755c145f279669d0760d48f4c1b0147d2728ed6cb33c41ed143f49e5bb9c13f2489d6e7dff4723769f27fcbcfdcf2c6f7d21e7c010483dd7d3213a88bf8745474920cc64d1b31cbacf0e446a5d2a3f1ba080fff39a076e1160ddadccac09fdf8ffbc4d896e86a67f12dbdee080b15746338b65b709ccc29bcdc1ba3908004b2052041c3ea6ea7d2b995a3c8789c43807548a8f9d5512aebe994bd0305b84f6cb29a1bdae16856a14d1f87461a092a104982e667c7db0e568fb87737ecd0a6dca68932be9d3ed50d9538441384d54021006216e1d2b1d35974afffe798c998e6313f0100e272f4aacae62f73b017acdf75bf18215d404bc1d40fa5998dec69ed082c8e4b0a0da3042166fe0f850ca1cb0ed67dcc0337fb5638d17a70041a217d3f2046259b243e04770e73eef568f134ffa67513128bc876321ad5c51f6aefc06a5b2e1fc7219bc1302e567e938c434fbf323a84447d353cb78e8a7a82ccc0f319f687bce477d464172553f8c9ad620dd87126d317eb74b0ad5cc5b0754adb6ef1d2e5fab11fb22d3329e6cc56726d669ebb13d9b5dd0f24244326f3960158550c8c348477a305ef309194a391d2b4677cf8946bb1690781254be93a912b55bd0bf806a7bd0cc05945412b93e5956dd4db664c78fc33d249ba910a9c4c51425f8471fab080fca8b9d65cd444e6c7f51265129fd8a760850deeef968fc1be1af02b86b1b9f4a5115922587a84cc6445c6e21c580968eaf5e5a23cb5015bcc61ab19a4371a7fd9ec7cc549490957c5ba3b8e2138019e35cacb14d80b1963f8d7fd598aa5d26f2072362d62f0b472885a0257b48a212aa847fd3458e81d3fc8b9e7ee927b9cfd281c95ef41acde4498c668cdd917c481c01eda7593bf4d79d33272ab96bd7a39bf4bd14a5935edab6e409184e57a19416fef428a54a811d7f9210b3079b7aee35ded4de071401f28c317f9a01693aec5369227443a3bfda35b45f43bcf233e792c37a33deba7c34a42e9b62d2478f2d52a55e7955ce604f655a54a601888489b85285b63338a24d8f1255c14ce067f375727a52408821c957185495c4d92ea14c208a43bf7cfa286829b69673a65d1865655a9cf105764cdf3a097211fafddd23cbc8b0d96b1cdd8cce8cc9b60add6271acdc9c3101b7b896eeff619aa9eb34fe8ae6b0eb1a6e6adc76e86190f8bf35a191b615cdb520219f3d9a2990a0792eafc19da905b63cc21a393a4d209312c5dce0b9cb3f4d3edac27cf508d45dc29b18db4b4f4a920a4eb16d7c133b782c521d263f0da61668d079b0c377598308534a2117d3c7b4e0fc4381b95fcf1bc0640e52ea00f2e0a39de54dbac71e9deacc2443d4a50f44fbb69e78cf6e806263f2406a98166ecac47d3358063bc7c60bff8e56fe66bb50da21952328eb84a9d2dcd114b86b3f90f52b987e4da3abbb495ba5e9e4d9827bbe2bf146a997eda3b3dafbba6651c597e4fb032088958fc257f381af940dc76002071b38889090b7feff0a3c4609e871ff4a4f465d1b7aee54d8d86303bbf310af183a77b9e093020b5f8a57988af2b7e35ed51a2f3e927f879fb7e1eb9277077bc415fd68bdca4a047e5976f7b7cc7fa83e39e10d4a484bb30c2cb818f92b6a9e11db02351dafe520d61a30d889130e8157c797e760c8be9281de60fb236623094a59e368cdb48e23c529143292b33287de7ad4f77cd39eb7ee8c2ac1056610a7d44309e8f40ec0a9edc2ab7228dff79874becd59bacdd42047490d4d5f44cf2ebad9aff5193d42607030ee4152fe0a885476bbe6acb301004a1c189716ed041ebe20ce6e9419f225293310280dbca35d330aa4d1be5230b8d02283d8d52b12197111892f7c266c152c9e302e7f8106ac5a67d8fc8a3b5eba10e3ee9cabafc6d93415637f085f80344d370055afa6d5574c67fb61ac49d273a2ceb08391aab2b989ce712e40b67bc4d1017213862a531e4a63c0b4876d83b5b63888246640c756cbc7dceba65fd28b1562767f08c3cf85577cad700089cdd891ad291001473ea664e6f5898b5431d704f37a1cb47f8530d7c40f6f622e04ab7e4f05d5984eac664136390d62d6f4f961dc145568c732852ce5e9bb83eba078b93278747796a5c1fd6ffcee3346d184c4cfbecd0d4c3185dafa511b70dba1b904769e2f9a5297a6fd049ae041d402ca3aa6be0442f830fbce9d6b3fd8a9c3b5e86e5f005009dcfbbad7059d9ea7686da05a9f1422f502d23f305ee2cbbe1519e07106a2524f432d88ac9cc16ceaa95e736d68622d9b16ba51c853c077917271902cbb4501653d944d896407e5d23bc887f8957f11ef52699678b5df8ab32c49ce79e4ef449f7654fc8f35690768eddb9c73943f94693895bcd39d15878e5b702ee32dec534783236f643149038639baf3332bc68917600cf091e59cbdc9821d73423c44fb12896c224f70ad17b7d5367b1d03f478f89eb26ef8069e7ed21a7d8f60511772056965e1746a08d94cf055528a4310918c2c4170448fd36612328c47673e344e57647622c4df4c7a430585269f13c3031c26abc60fc2461f4807c2262eeb74b9a13600eeec2bebe5505d061dc4b19588b28ee2063aeb2a44a430041753f622cf889681cfd4daf93191c7a72f6abfd76ea28efaab65f31b49b0767262fc54a07d491ec686aeee1113d1b63c21a079d1a4573e831567ed534c7f0db05d43c08d3d91f10f885a887416030a9c1be4dcfb86e9b4f3fb785935021e0e7ca92da85844a30554580ea417414f066c214ba2916e65f8a7d45d7d7a3801ca8079a3f29d2073029c1c369b2e57008c7e6d88f257bf4035a333af27f0e03ae6ef1da8003d16baa5455a1cd6bb92495763169925ebcfab160c146efc4a36ccfc38f812479c3af6dba3d82fef32e574e88d4fc4a0cff563fb65906fe80045281053507f668e0f723e0b9a8c04a4bc849e8253eb0b6c3c0b1eddc5070963f165525f34b39dc0e50658426b009652dd022b4af54b2077d5bf57d7fb0d368dacef0a08a3a124dec652827e7c540861a76026444eca56797a2c7b49ae0437a2aa37a6a5095581da0227d13b5bc305772101d552f4cbd08a3d5e58f1f6e3810711847bd465462be16a63ff7fbdb8861380d6c5867ccf2edac230031984fcf4168119273078a14ff4151b6dc43ab2d85c19eb71f5df8a891db447c5a96e6a201b07e1de94168c9f6d7586a312892ac6b5024fdeeaa85ea550f4c0a5247a0af774ddc0b24d312c44b357d0076480dbee6c67676fe399c8edafda0c47d8b75ef6cf03f87f4237e329efd1ce07907cf4c224be49311b799fbc3dd5f8bba8c27e3bc8bc93c1ec6153510254900fbe989151f3cc84f453a198c9a0aaebbe07f8ac95e953f9c87d3af934d3a31af42178342cd7b26912dcdf12621cbefb5aa1cb7b60657f241080a2124d549936de86a539ad7b082c692f9e7c94eaff6d7710b928d8b14ad7d196dde620931623fe43c2640d215631c23715a8e84368d463cd05d17270499c46dba22476eccca723e7efe3fd54b7ce994ae938e9e37c69ba6376a7ab37e262159c69f4f485a69193e0320e5b3a2638824ac259fda590cf164ed313b6b7f820e586d95ef6e23c94505244cab6783064863ec83fbbd2d5ace096f2ff9d660a3b2e23878c0fb4c006a283acde16a14b4aa92136e9d69fbc012faafc03e2c3af01f92ff4062ecf299cb3965b03523feca08e0159cec4f7b069da498f0b0a35bed97c229d314d6b5082f7372fb4bc5ba785249485bfaef8469c80e40e1f0329c283feea3d3d2a83fefe50a6d9a8a8787b2080c06ac0d8fe291d8a30dabe0fcd350990c45048d6496bf2060fa82780f9244c4d8ed300869772a3e9c9195f12903c5daacff3a75c54da9136644dd8f2d50f0fd118f830cbf314ecfab6b5f39e4f41a9f7f9c30f71b9c88d9aff297ded73cf8e551af76e36ebd0188067aab1a64c3e1dbcc30525ba3b70d0dd9dfdd31f5a2a73d577b4eff1de8f29bcc279f606d51e0ee1bcc7517320ad24985886228767947fbfb954d66b2353c72716b7160846aad84059e54b90364ffa674201ae41c4fa6ede963c9f3b973f7e45ccf4c352c45bfee686c43d375b98a81e9291bcf8ce446e33ee1bc3939321ab5b5972280947648e05b5acecddc49eb2942a5841b7c2e387d743978d8584b3446d7d3fee39a421e74016b8560ec8326eae62e4bda85a2585358b07ce34a1a3480d6eac08436c6a3ceb60fb27a3940b430ab57eaa7624baffdc87fb9334eca1ddd1498a6eeda68877e3f2d6aee118057b8b99a7d35ce9e99fd5c30ec80dc5651809f84dcfcb2def0a42c1bef82c133db32ad174c57474a5a9e7897819405fa5de25234a2d930b84105122f48cd4e5239b6b6c7041a5427166cbc464d8dcd3e77512b5e126ead814736a1c4d51b5fbf22f09f612bed7ac161b15863351eff8dcb9d64d4d533c6cdc66182dbca37db76bd617c092111988d5eb3b1118cc7c5bc071290cdfebeab5423151cc8c42fc8488d8166b05f55c592f1f40fbe3ce54b076c6de2bb2c2fff4eb647545cb2c0e7c496456aeef4324055cc0c6e003aa1b7af20e486436c92bba9a018336c147a5261a67dfe81f9bdd592a74c74e1a91d04bc11957af3015d8c2fc659df872274b09cce4d04a0b9fbc473a697fec75c07622bd3d9d6e544b65f9ff5045d88eca20d391342e4544b3f9fd1462b66248cc7ff5e410ab7962e02307cd21998e51b694c705249d2b465eb1719fa416c7438af5b2acbe7f2e1a92e839d33599c940ab54ffa04e01132bc3bae849308161a570783c601afb646b8b1718d5a8bb4e93ff486c9de4471231f068419afe10d19eae7ca2ea6dc4164b1f80f939525f65504b9a430ef13febb3120ab2c130f7c018cb639167203453ae8abc9ba745296bded4430f9f9f138f183f93cae9443bcafde1c091081c3895ffec2ce24713fac09e6777de21df08c296a83b9d0315f5974d8e7145a0457f6ef49a125a21cddbff64aaf9bbcbd9703878e48123a3ca71025b1f4eaf4df18b1eb2e9eb13f38df183e8cbd328aa8fabc96d9a5b84efbf295144097ed812ec20150d1d85c6d452d9de58fd0da52a3b2903f06851f6ed1d0ac5c6d0f20193816783ec60d53faded9f3071ba889877dc1b44ec62d815fe4739ba4b70da5eea79d2ffe742291256c0984cb5856433c99ac443b78198f8e819afd18624f1de0e4faccffc5cb78b0da8f9b37865c74c347a4b15e1c1df9256cbbc3f96ccaaab82fb95126ac43ee5b317e08238f512b1a9e36fb7e9713f5b317ff05266b2ba07c2f1582b01fed1d77c968b81256c66f7a02aee27b3eeb66c250d526e36abd8431393420d2b373446f6b73a5016a0af93be57520b0a28b20958a84d56b3f9de40bc2ac3e8aa0915f472ff57a14a9bbc4d49e82f234f21fd75442cf8cf891811295f91c63109147f8f3cadd21654027fbcdc5eb2205f85c95d70c401ee11efa7f724ab52277945c7e784cc71b623de4c42ec904e81e523bcda5595a74a19c53a21335a5dbcbfce5fef9ca45abe6c68d6ca7eb2b3757ef57da757d104baf80b147ee8f8d540b90401d13d979d2e810b5b08c6a7f87e788c941e4759a91c267d3239ac11c961fa9744a7e86e7cfc193097bc7af82562bb127893c70fd89f70042a396cbca93e991d1fe122805607ebd8b70e0e1ff24492c11c6609c7141ba45842e7f9e8c1160c244632d30f3ff85235d4cc009e1ff1433ff0465b22742cf27337342f688142402edc489d22e02fad342b30a0ed0047bfed4ca19f1788523ed957f5df9d0eb213f60013adf97055e3f4ed0b83e2d945962682db628ae5592d99a4e41e8044e5c1de0c4203221e52951b8bc6029ec0ba9c1e0d6c4aa19deb5923d35e32e26e11a22d666525afda0ec01d66cf69c78b99150242e03fbdaf128b84385276c36046f9857d1be0c65613aa312bd9b5ddbfdfa3753cbca704d4fa0b4bbaef27b2147d26d1ffb7752d14e729542b246dec48abceabc5106d4cfc830664a6ddca5a2cfdc42846887beca99e40e27c437fedf7542b7ce0426bed423366f64e4fc942a1c430baf6bbe4c5c3217f1ff47ab8a8abeea77caac196f63382a0da0810d99da081a5155dbc5b21d63f084048f7c8840c089bea72df3f9a75a7e2ac9f826540a56cf60d811d392636651fdc77dcbaad0f72774f1a507021233f6f4b25eba2f8c201cca45478e5a65bfad04bf7181b01427aa648eb1c1d94c4dabc852c9ae6b01f5a232ec6f0972c00aee8968b99490f238449d135178fe5818e96537334ea99e442109f02448c57bd2356873dcbd0c0fb646a3eaff27d143a0a254577b37564e623fbd0afa346e4982b1a20ef8afcb876e0dd3f8463811091f1d2a8f7dc08862bc5570836ef19a3d2b8bb5d7658733d103f6185533d85d6af1429a8ab423046e8a60b1adbd0f5184dc9920a00e3aad0ac2c4f70e2697a38526bc0f008c0319557873f302d96cd7cb3bc78a88d4774cb9018087b1332d6c5c3ac16cb41a32d98b5e19377c3d009b716c7c22da56075e1e93cada6da102cdcfb12015586b73da492ee0a511cf2fb888676eaedbf621324c118d28e75370dc019ba91570b21c043e32ed05bd950bccdd28b93b0d95d1e3c8227fefbc535fa5e84cd30a41327fb0c2df35dcd054fc43e8d460b34ef589165876bba64dc090ee24a03878dafb443202482d7243bcb8173b0ae72bb219875e500f46050c45b14521087b30fd918215c474c3acb3925c6ab1724309ca10fd905346dc7d25a3b458f338aef93bcc58d315220212125f654004b0e496b0501e1d3dbba44372d57a3ba8f","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"cb4dac17dd2d3b658155eb3f63bb6c40"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
