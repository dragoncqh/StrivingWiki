<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="zh-cn"><head><meta charset="UTF-8"><meta name="copyright" content="(C) 版权 2024"><meta name="generator" content="DITA-OT"><meta name="description" content=""><title>VBA</title><link rel="stylesheet" type="text/css" href="../../commonltr.css">
<link rel="stylesheet" type="text/css" href="../../common-extended.css"></head><body id="VBA-35733B84"><main role="main"><article role="article" aria-labelledby="ariaid-title1">
<h1 class="title topictitle1" id="ariaid-title1">VBA</h1>


<div class="body conbody"><p class="shortdesc"></p>
<p class="p">一，概述</p>
<p class="p">VBA(Visual Basic For Applications)是微软开发出来在其桌面应用程序中执行通用的自动化(OLE)任务的编程语言。VBA是Visual
Basic的一个子集,VBA不同于VB，原因是VBA要求有一个宿主应用程序才能远行，而且不能用于创建独立应用程序。而VB可用于创建独立的应用程序。VBA可使常用的过程或者进程自动化，可以创建自定义的解决方案，最适用于来定制已有的桌面应用程序。</p>
<p class="p">通常意义上的VBA就是在Office中包含着的一种加强Office功能的Basic语言。经过发展，在Office中，Word、Excel、Access、PowerPoint四个软件都有了自己的程序设计语言，分别称为WordBasic、ExcelBasic、AccessBasic、PowerPointBasic(在Outlook中的开发语言为Visual
Basic Scripting Edition)。通常统一称为VBA（VB for Application）。</p>
<p class="p">二, 宏</p>
<p class="p">宏是能够自动完成某个任务的一组指令，这些指令放在一起就如同一个命令一样。宏与Dos中的批处理文件一样。批处理文件用于自动化用户完成的一组任务。VBA把需要重复进行的任务创建宏，并编写其它涉及决策的任务的代码以完成任务自动化，最后可以把这个过程保存成文件并发布。</p>
<p class="p">录制宏比从头开始编写代码要快得多。在实际开发中，为节省时间可以先录制尽可能多的宏，用它来建立应用程序的基础,然后再对录制下来的代码进行修改。</p>
<p class="p">1，录制宏：在VBA中，可以采用宏录制器或编程的方式自动处理任务。不必了解宏录制器使用的编程语言，便可以在VBE编辑宏。通过记录完成任务的步骤，或者在VBA中编程，都可以创建宏。Office应用程序，例如word、Excel、PowerPoint、Access和Outlook都支持宏。Office应用程序提供的创建宏的工具是Macro
Recorder(宏录制器)和VB编辑器。宏录制器用于自动化重复的任务，而VB编辑器自动化那些涉及决策的任务。可以给宏指定符号(工具栏上的图标)、键(键盘上的键)或名字，用于表示一列命令、活动或击键。</p>
<p class="p">录制宏有两种方式，一是双击状态栏中的”录制”命令,或者鼠标单击工具\宏\录制新宏命</p>
<p class="p">令,WORD等将记录下您的操作并转换为VBA语言。</p>
<p class="p">www.deepcast.net_deepcast_userfiles_2006-7_5_20067513259758.jpg</p>
<p class="p">2，修改宏：</p>
<p class="p">A, 指定快捷键:</p>
<p class="p">B, 指定宏的保存位置:Excel可保存宏到个人宏工作簿中</p>
<p class="p">C, Excel可将宏指定给按钮(视图|工具栏|窗体|点选按钮到页面|指定宏)/图片(插入|图片|右击图片|指定宏)/工具栏按钮(工具|自定义|命令|宏|自定义…|拖动自定义按钮到工具栏|右击按钮可编辑图标和指定宏|关闭自定义…)</p>
<p class="p">三，使用控件设计用户界面</p>
<p class="p">首先要进行需求分析：应用程序的客户是谁，使用的数据的来源，数据保存在哪，对数据怎么操作，输出结果是什么?然后根据用户需求来添加控件(标签,按钮,复选框,选项按钮，列表框,组合框,滚动条控件,微调控件。)使用工作表还是用户窗体完全取决于个人的爱好和应用程序的用户。熟练Excel用户适合以工作表的形式工作。初级用户适合使用用户窗体。</p>
<p class="p">1, 向工作表添加控件: 视图|工具栏|窗体|点选控件到工作表|右击工作表上的控件选设置控件格式。通过使用控件、设置格式和公式，可以执行一些简单的自动化任务（至少对你的用户来说是这样）。</p>
<p class="p">2, 向用户窗体添加控件:</p>
<p class="p">(1)添加用户窗体: 打开一个新的工作簿|工具|宏|VBE|VBE的工具栏上的“插入用户窗体”按钮(或者选择“插入|用户窗体”，显示出新添加的用户窗体)</p>
<p class="p">(2)设置用户窗体的Name(一般前缀推荐取frm),Caption等属性</p>
<p class="p">(3)添加控件到用户窗体上:只要从工具箱中选择想要使用的控件，然后使用鼠标把控件拖到窗体上就可以了。</p>
<p class="p">(4)设置控件的Name,Caption和其它相关属性:控件Name命名前缀规范：复选框chk,组合框cbo,命令按钮cmd或者btn,分组框grp或者fra,图像img,标签lbl,列表框lst,多页（MultiPage）mul,选项按钮opt,引用编辑（RefEdit）ref,滚动条hsb或者vsb(取决于是水平的还是垂直的),微调项spn,选项卡条（TabStrip）tab,文本框txt,切换按钮tog</p>
<p class="p">A, 命令按钮Default属性：一个窗体上只有一个命令按钮的Default属性可以设置为True。把Save（保存）/Cancel（取消）按钮的Default属性设置为True。在窗体上当按下回车键时，窗体将执行保存/取消操作。</p>
<p class="p">B,控件的尺寸调整为一致并对齐:同时选中两个控件|点工具栏上“宽度相同”按钮旁边的向下箭头|选'两者都相同'|点“对齐”工具栏按钮旁边的向下箭头|选'左对齐'，</p>
<p class="p">C,禁用控件:把Enabled（启用）属性设置为False就可以禁用控件。</p>
<p class="p">D,为控件分配Tab键切换顺序:设置TabIndex属性值，可以从第一个控件起设置其TabIndex为0,1,2..，也可以从最后一个控件起逆序设置每个TabIndex为0(原理：当把某个控件的TabIndex属性值设置为0时，其他所有控件的TabIndex属性值都会加1)</p>
<p class="p">E,为控件分配加速键(键盘访问键）:在控件的标题字母中找出一个作为该控件的加速键，把该字母赋值给控件的Accelerator属性，当设置完成以后，控件标题中该字母下会有下划线</p>
<p class="p">(5)运行用户窗体: 按F5键</p>
<p class="p">四，使用VB编辑器</p>
<p class="p">VBE（Microsoft Visual Basic Editor,Visual Basic 编辑器,VB编辑器）就是我们设计\调试VBA代码的编辑器,它是捆绑在Application(如WORD)应用程序中的一个程序。进入VBE的方式:ALT+F11；工具/宏/Visual
Basic 编辑器命令；工具/宏/宏对话框,创建或者编辑命令,也可以进入Visual Basic 编辑器</p>
<p class="p">www.deepcast.net_deepcast_userfiles_2006-7_4_200674215440623.jpg</p>
<p class="p">1, 使用工具栏</p>
<p class="p">2, 浏览代码功能:编辑|查找或替换；书签标注需要查错，添加代码，更新或升级的代码区域。</p>
<p class="p">3, 使用在线帮助：帮助|Microsoft Visual Basic帮助</p>
<p class="p">4, 使用对象浏览器：单击标准工具栏上的“对象浏览器”按钮。/选视图|对象浏览器/按F2键。</p>
<p class="p">5, 设置编辑器选项:工具|选项|编辑器选项卡|自动显示快速信息,自动语法检测等</p>
<p class="p">五，VBA语法基础</p>
<p class="p"><a class="xref" href="http://www.deepcast.net/wiki/vba%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80" target="_blank" rel="external noopener">VBA语法基础</a></p>
<p class="p">六，VBA对象模型</p>
<p class="p"><a class="xref" href="http://www.deepcast.net/wiki/vba%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%9E%8B" target="_blank" rel="external noopener">VBA对象模型</a></p>
<p class="p">七，模块</p>
<p class="p">作为一个单元保存在一起的定义、过程、函数和事件处理程序的集合称为模块。每个应用程序都是模块的集合。模块充当了项目的基本构件。它们是存储代码的容器。如果统筹安排模块内的代码,将有利于维护、调试和重复使用代码。如下共有三种类型的模块：</p>
<p class="p">1,用户窗体: 是用于为应用程序提供用户界面,采用．frm扩展名存储的用户窗体。窗体模块包含窗体中的所有控件及其属性。也可以为窗体和控件指定常量和变量声明、过程以及事件过程。窗体模块中的所有声明都默认是Private(私有)，不能在窗体外访问。</p>
<p class="p">2,标准模块: 是用于存储通用过程，以便其他模块中的过程可以调用，采用．bas扩展名存储的代码模块。它们包含常量、类型、变量、过程和函数的声明。标准模块中所有声明都默认是Public(公共的)，可以在模块外全局访问。当录制宏时，如果不存在该模块，Excel会自动为你创建。如果愿意，也可以添加附加的模块。Excel和VBA并不关心过程位于哪个模块中，只要过程位于打开的工作簿中即可。</p>
<p class="p">3,类模块: 类模块的使用方式与窗体模块相似。两者之间惟一差别是类模块中不包含可见组件。</p>
<p class="p">使用类模块可以创建自己的对象。类是对某个对象的定义。它包含有关对象动作方式的信息，包括它的名称、方法、属性和事件。要为每个类编写代码，必须使用类模块。窗体是类模块的示例。窗体是指包含属性(如字体、名称和标题)、方法(如单击)、预定义行为的对象。当创建窗体时，它会成为代码的独立模块。同样，所有控件，例如命令按钮和文本框，都是它们各自类的对象。</p>
<p class="p">变量命名前缀规范：</p>
<table class="table"><caption></caption><colgroup><col><col><col></colgroup><tbody class="tbody">
<tr class="row">
<td class="entry" rowspan="1" colspan="1"><p class="p">数据类型</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">短前缀</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">长前缀</p></td>
</tr>
<tr class="row">
<td class="entry" rowspan="1" colspan="1"><p class="p">Array</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">a</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">ary</p></td>
</tr>
<tr class="row">
<td class="entry" rowspan="1" colspan="1"><p class="p">Boolean</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">f</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">bin</p></td>
</tr>
<tr class="row">
<td class="entry" rowspan="1" colspan="1"><p class="p">Byte</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">b</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">bit</p></td>
</tr>
<tr class="row">
<td class="entry" rowspan="1" colspan="1"><p class="p">Currency</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">c</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">cur</p></td>
</tr>
<tr class="row">
<td class="entry" rowspan="1" colspan="1"><p class="p">Date/Time</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">dt</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">dtm/dat</p></td>
</tr>
<tr class="row">
<td class="entry" rowspan="1" colspan="1"><p class="p">Double</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">d</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">dbl</p></td>
</tr>
<tr class="row">
<td class="entry" rowspan="1" colspan="1"><p class="p">Integer</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">I</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">int</p></td>
</tr>
<tr class="row">
<td class="entry" rowspan="1" colspan="1"><p class="p">Long</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">l</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">lng</p></td>
</tr>
<tr class="row">
<td class="entry" rowspan="1" colspan="1"><p class="p">Object</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">o</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">obj</p></td>
</tr>
<tr class="row">
<td class="entry" rowspan="1" colspan="1"><p class="p">Single</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">-</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">sng</p></td>
</tr>
<tr class="row">
<td class="entry" rowspan="1" colspan="1"><p class="p">String</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">s</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">str</p></td>
</tr>
<tr class="row">
<td class="entry" rowspan="1" colspan="1"><p class="p">Variant</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">v</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">var</p></td>
</tr>
</tbody></table>
<p class="p">八，测试与错误处理</p>
<p class="p">1,测试:</p>
<p class="p">(1)测试代码，检查它是否正确。为确保代码能够正常作用，必须在指定时间周期内采用不同的样本数据运行它。</p>
<p class="p">(2)如果代码没有按照预想方式正常作用，就需要调试它。可以用VBA提供的调试工具调试代码。</p>
<p class="p">(3)尽力模拟代码运行的不同环境，并检查其正确性。重点是检查代码的可移植性。</p>
<p class="p">(4)在成功地测试了代码之后，可以对观察到的现象进行存档，例如代码末正常运行的</p>
<p class="p">环境。</p>
<p class="p">2,错误类型：Error(错误，可捕获并用代码处理)并非Bug(程序错误，无法捕获)</p>
<p class="p">A, 语法错误(如输入时关键字或标点符号拼写错误)</p>
<p class="p">B, 编译错误(如使用对象的方法时，该对象并不支持这个方法)</p>
<p class="p">C, 运行期间错误(如除0、打开或关闭并不存在的文档、关闭未打开的文档)</p>
<p class="p">D, 逻辑错误(逻辑锗误是最难查找的错误类型，它们是由程序中使用的逻辑引起的。它们并不显示任何错误消息，所以不能提供错误线索及发生的位置。然而，有时，它们会产生运行期间错误，以便确定已经产生锗误的语句。如果编写了模块代码，而且该代码包含很多函数，而且一个函数调用另一个函数，那么不得不调查所有过程，以识别错误位置。)</p>
<p class="p">3,调试工具：要确保代码中的变量和表达式按照预想的方式运行，可以使用VBA中的各种调试工具跟踪它们。VBE有如下不同的调试工具。</p>
<p class="p">(1) 中断模式:</p>
<p class="p">A, 进入中断模式方法：在过程的开始位置按下F8键。/使用断点(F9键或者单击当前空白指示器栏)。/使用Stop语句。/当过程运行时，按下Ctrl+Break键。/使用运行期间错误MsgBox对话框
。</p>
<p class="p">B, 退出中断模式方法：从Run(运行)菜单中选择”Run Sub|Userform”〔运行子过程/用户窗体)；或者按下F5键，或者单击Debug工具栏上的”Run
Sub|Userform”按钮。/从Run菜单中选择Reset(重新设置)选项，或者单击Debug工具栏上的Reset按钮</p>
<p class="p">(2) 单步执行过程:</p>
<p class="p">A, 单步执行过程:从Debug菜申中选择StepInto(逐语句)选项/单击Debug工具栏上的StepInto按钮</p>
<p class="p">按下F8键</p>
<p class="p">B, 跳过过程(跳过已测试无误的过程节省时间):从Debug菜单中选择Step 0ver选项/按下Shint+F8键/单击Debug工具栏上的Step
Over按钮</p>
<p class="p">C, 跳出过程(跳过程剩余部份):从Debug菜单中选择stepOut选项/按下Ctrl十shift十F8键/单击Debug工具栏上的StepOut按钮</p>
<p class="p">D, 运行到光标处(跳过一组语句):从Debug菜单中选择RugToCursor选项/按下Ctrl+F8键</p>
<p class="p">E, 设置下一条语句为光标所指语句(要警惕会忽略不执行中间的语句):从Debug菜单中选择Set Next Statement/或者按下Ctrl十F9键。</p>
<p class="p">F, Sbow Next Statement选项指明下一个将要执行的语句是什么。当需要在Code窗口中监视很多过程、却丢失了跟踪时，这个特征就显得非常有用。</p>
<p class="p">(3) 监视过程。</p>
<p class="p">A, Locals(本地)窗口(显示当前过程中使用所有变量及其值，还会显示当前加载窗体和控件的属性。):从V1ew (视图)菜单中选LocalsWindow选项/单击Debug工具栏上的localswindow按钮</p>
<p class="p">B, CallStack对话框(查看所有活动的过程调用):从View菜单中选CallStack选项/按下Ctrl+L键/</p>
<p class="p">单击Debug工具栏上的CallStack按钮</p>
<p class="p">C, Immediate(立即)窗口（可查询并设置变量值,创建或撤销对象,执行单行命令如Debug.print [outputlist]）:从View菜单中选择ImmediateWindow选项/按下Ctrl+G键/单击Debug工具栏上的ImmediateWindow按钮</p>
<p class="p">D, Watches窗口(是一个调试工具，在中断模式下可使用它更改变量和表达式的值,以查看不同的值如何影响代码):从View菜单中选择WatchWindow选项/单击Debug工具栏上的WatchWindow按钮</p>
<p class="p">参考：</p>
<p class="p">E, Auto Data Tips(自动显示数据提示)工具:Too1s(工具)菜单中选择Options(选项)Editor(编辑器)选项卡中的Auto
Data Tips选项。就可以激活变量值自动显示(即在中断模式期间，只需把光标放在code窗口中的变量之上，该变量的值会自动以提示的方式显示出来。)</p>
<p class="p">4,预防错误</p>
<p class="p">A, 使用注释</p>
<p class="p">B, 缩进代码：Tab键或启用Too1s(工具)菜单选Options(选项)Editor(编辑器)选项卡中的Auto Indent(自动缩进)</p>
<p class="p">C, 使代码模块化</p>
<p class="p">D, 显式声明变量:使用Option Explicit语句，或启用Too1s(工具)菜单选Options(选项)Editor(编辑器)选项卡中的Require
variable Declaration(需声明变量)复选框。</p>
<p class="p">E, 避免使用变体Variant(当某变量可能包含NULL值时就只能惟一指定Variant类型了)</p>
<p class="p">F，打开语法检查：启用Too1s(工具)菜单选Options(选项)Editor(编辑器)选项卡中Auto Syntax Check(自动语法检测)</p>
<p class="p">G，谨防Dim陷阱：Dim mystr1, mystr2 As String '并未声明mystr1变量</p>
<p class="p">5, 错误处理：调试只能够发现可以预测的错误，要处理不可预测的和不可避免的错误时，就必须使用错误处理。通过启用错误处理，捕获并提示错误处理，可以使程序更健壮。就可以使应用程序更稳定、更健壮。如果应用程序中包含了好几个过程，那么可以考虑采用集中式错误处理程序。</p>
<p class="p">(1) 捕获错误：On Error Goto line (On Error Goto 0会在当前过程禁用错误处理程序)</p>
<p class="p">在这个语法中，line指定了发生运行期间错误时控制将跳转到的代码行</p>
<p class="p">Private  sub  calcuLate()  0n  error  goto  validate_error  iresult
 ＝  inuml/inum2  Print  iresult  Exit Sub  validate_error:  Msgbox
"Runtime  error - division by zero"  End  Sub</p>
<p class="p">(2) 编写错误处理程序：给用户显示错误信息；提示补救方法；允许继续或取消操作。使用Err对象：</p>
<table class="table"><caption></caption><colgroup><col><col></colgroup><tbody class="tbody">
<tr class="row">
<td class="entry" rowspan="1" colspan="1"><p class="p">属性</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">说明</p></td>
</tr>
<tr class="row">
<td class="entry" rowspan="1" colspan="1"><p class="p">Number</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">存储最后一个错误的数字ID。这是默认属性</p></td>
</tr>
<tr class="row">
<td class="entry" rowspan="1" colspan="1"><p class="p">Description</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">存储说明错误的有关信息</p></td>
</tr>
<tr class="row">
<td class="entry" rowspan="1" colspan="1"><p class="p">Source</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">包含发生了错误的对象名或应用程序名</p></td>
</tr>
<tr class="row">
<td class="entry" rowspan="1" colspan="1"><p class="p">HelpFile</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">包含帮助文件的名字</p></td>
</tr>
<tr class="row">
<td class="entry" rowspan="1" colspan="1"><p class="p">HelpContextID</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">包含错误号对应的帮助上下文ID</p></td>
</tr>
<tr class="row">
<td class="entry" rowspan="1" colspan="1"><p class="p">LastDLLError</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">包含最后一次调用DLL的系统错误代码</p></td>
</tr>
</tbody></table>
<p class="p">Raise方法可以让用户自定义错误处理信息，还可把错误处理信息传回调用过程:</p>
<p class="p">Err.Raise number[, source, description, helpFile, helpContext]</p>
<p class="p">Clear方法清除Err对象的所有属性值：Err.Clear (当调用On Error, Exit Sub, Exit Function,
Exit Property, Resume 等语句时，会自动调用Err.Clear方法。)</p>
<p class="p">(3) 退出错误处理程序:</p>
<p class="p">A, 0n error Resume:当错误处理程序已经修复错误后，可以用它来返回控制给引起错误的语句。但注意如果错误还在的话，会引起无限循环。</p>
<p class="p">B, 0n error Resume Next:忽略错误语句，继续下一句</p>
<p class="p">C, Resume [LineLabel]: 把控制传递给行标号(必须和Resume语句处在同一个过程中)所在点的语句</p>
<p class="p">D，也可使用Exit Sub或者Exit Function甚至End语句退出已产生错误的过程，但这些语句应放在错误处理程序之前，这样当未产生错误时就不会执行错误处理程序。</p>
<p class="p">(4), 创建集中式错误处理函数程序:只需创建一次，就可反复使用</p>
<p class="p">'添加一个模块创建一个函数，命名为HandleErrors  Function HandleErrors(iErrNum) As
Integer  Select Case iAction  Case 5  'Invalid procedure call  MsgBox
Error(iErrNum) &amp; " Contact Help Desk."  iAction = 2  Case 7  'Out
of memory  MsBox "Close all unnecessary applications. "  iAction =
1  Case 11  'Division by zero  MsgBox "Zero is not a valid value.
"  iAction = 1  Case 48, 49,51  'Error in loading DLL  MsgBox iErrNum
&amp; "Contact Help Desk. "  iAction = 5  Case 57  'Device I/O error
 MsgBox "Insert Disk in Drive A."  iAction = 1  Case Else  MsgBox
"Unrecoverable Error. "  iAction = 5  End Select  ErrorHandler = iAction
 End Function</p>
<p class="p">'在另一模块的ErrorExample过程中使用HandleErrors函数  Private Sub ErrorExample
()  Dim sngValue As Single, sngDivideBy As Single, sngAnswer As Single
 Dim iResponse As Integer  On Error GoTo ErrorZone  s n g Value =
InputBox("Enter the number you wish to divide: ")  sngDivideBy = InputBox("Enter
the number you wish to divide by: ")  sngAnswer = sngValue / sngDivideBy
 MsgBox "The answer is " &amp; sngAnswer  Exit Sub  E r r o r Z o
n e :  'This Select statement uses the value returned  'from the HandleErrors
function for its condition.  Select Case HandleErrors(Err)   '对应于五种处理方法:Resume/Resume
Next/Resume “行”/退出该过程/结束整个应用程序。  Case 1  Resume  Case 2  Resume Next
 'This procedure doesn't need case 3 which is resuming to a line.
 Case 4  Exit Sub  Case 5  End  End Select  End Sub</p>
<p class="p">九，VBA的安全性和保护工具</p>
<p class="p"><a class="xref" href="http://www.deepcast.net/wiki/draft:vba%E7%A0%B4%E8%A7%A3%E5%8F%8D%E7%BC%96%E8%AF%91" target="_blank" rel="external noopener">VBA破解反编译</a></p>
<p class="p">1, 数字签名:保护在VBA中编写的宏、过程、窗件或代码。也可以把它应用于文档、模板和内插附件。把数字签名添加到宏项目中的步骤如下：打开VBE–&gt;Tools菜单上的Digital
Signture(数字签名)命令–&gt;单击Choose(选择)指定数字证书。</p>
<p class="p">www.deepcast.net_deepcast_userfiles_2006-7_5_200675223231365.jpg2,
指定安全级别：Tools工具–&gt;Macro宏–&gt;Security安全性。可以指定Security LeveI(安全级别)和Trusted
Source(信任源)</p>
<p class="p">3, 代码的密码保护:打开VBE–&gt;Tools–&gt;Project 属性，写人密码锁定代码查看</p>
<p class="p">www.deepcast.net_deepcast_userfiles_2006-7_5_20067522413404.jpg</p>
<p class="p">十，VBA程序的部署</p>
<p class="p">不管是加载宏程序还是一般的电子表格程序，其部署都很简单，我们可以直接拷贝这个文件到目标机，对于加载宏，需要在Excel 中将其加载，对于后者，可以直接双击使用Excel打开运行。</p>
<p class="p">而对于应用VSTO 开发的Office 应用，其程序的存储位置位于独立的文件和DLL。另外，如前文所述，我们也可以将一些算法、代码通过COM
对象封装在独立的DLL 内，在Excel 内通过VBA 调用。对于此类代码，需要在部署前安装和注册相应的（COM）对象。</p>
<p class="p">如果在VBA 代码里使用了其他文件中的资源，如数据、配置信息等，在发布和部署时需要一起发布，对于这些文件资源的位置，可以通过Application
对象获取当前文件或加载宏的所在目录，然后通过目录的相对路径来调用。</p>
<p class="p">例如，当前文件的路径为：Application.ActiveWorkbook.Path；加载宏的路径则通过以下方法来获取：Application.AddIns.Item([加载宏名称]).Path</p>
<p class="p">对于有多个文件的程序包，可以使用安装工具制作安装包，也可以通过直接Copy 的方式来部署。</p>
<p class="p">十一，VBA高级应用</p>
<p class="p"><a class="xref" href="http://www.deepcast.net/wiki/vba%E9%AB%98%E7%BA%A7%E5%BA%94%E7%94%A8" target="_blank" rel="external noopener">VBA高级应用</a></p>
<p class="p">* VBA病毒：VBA是众多臭名昭着的宏病毒和基于Outlook的邮件病毒的主要技术！宏病毒是一种寄存在文档或模板的宏中的计算机病毒。一旦打开这样的文档，其中的宏就会被执行，宏病毒就会被激活。从此以后，所有自动保存的文档都会“感染”上这种宏病毒，而且如果其他用户打开了感染病毒的文档，病毒又会转移到他的计算机上。</p>
<p class="p"><a class="xref" href="http://www.deepcast.net/wiki/excel%E5%AD%97%E6%AE%B5%E6%88%AA%E6%96%AD%E9%97%AE%E9%A2%98" target="_blank" rel="external noopener">Excel字段截断问题</a></p>
<p class="p">十二，VBA第三方软件工具</p>
<p class="p">1998年流行的MIS和MIS生成工具有CAPMS、BMIS、CMRP2、JWMRP-2、雅奇MIS工具、 DBPRO、VISUAE
MIS、QUICKMAIS及QUICKPRO等 王特MIS(1995大连王特公司Foxpro写的MIS系统生成器)，但只能解决一点简单的问题，稍多弄一点就会出各种各样的问题，不能真正达到应用水平。参见:<a class="xref" href="http://zhidao.baidu.com/question/41889375.html" target="_blank" rel="external noopener"><strong class="ph b">软件开发工具的现状和发展|</strong></a></p>
<p class="p"><a class="xref" href="http://www.yqmis.com/" target="_blank" rel="external noopener">雅奇 MIS|</a>从DOS走到Foxpro，2009尚存但前途不明</p>
<p class="p"><a class="xref" href="http://www.accessoft.com/training.asp" target="_blank" rel="external noopener">ACCESS UMV开发平台</a></p>
<p class="p"><a class="xref" href="http://www.magicflu.com/frame.aspx" target="_blank" rel="external noopener">magicflu构建你的知识管理平台</a></p>
<p class="p"><a class="xref" href="http://www.msaccessonline.com/post/100.html" target="_blank" rel="external noopener">Access开发通用界面百变加强版|</a></p>
<p class="p"><a class="xref" href="http://www.gnoysoft.com/" target="_blank" rel="external noopener">歌逸ACCESS开发平台|</a></p>
<p class="p">参见</p>
<p class="p"><a class="xref" href="http://accesshome.5d6d.com/" target="_blank" rel="external noopener">AccessHome Access之家|</a>&nbsp;<a class="xref" href="http://accesshome.5d6d.com/viewthread.php?tid=1260&amp;extra=&amp;highlight=%B3%AC%CA%D0%B9%DC%C0%ED&amp;page=1" target="_blank" rel="external noopener">超市管理2000|</a></p>
<p class="p"><a class="xref" href="http://bytes.com/topic/access/answers/580962-error-after-importing-forms-backup-copy-project" target="_blank" rel="external noopener">Error after importing forms from backup copy of project|</a>：Access VBA窗体与其代码是独立的，不会关联删除更新，所以在导入或者复制窗体后，需要进行手动关联，可以把当面全CUT，然后再设计视图下PASTE，再测试看看。</p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VBA/ACCESS_VBA%E7%BC%96%E7%A8%8B.doc?attredirects=0" target="_blank" rel="external noopener">ACCESS_VBA编程.doc</a>&nbsp;1240k</p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VBA/ACCESS%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0101.rar?attredirects=0" target="_blank" rel="external noopener">ACCESS开发平台101.rar</a>&nbsp;1239k</p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VBA/ACCESS%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91%E8%B5%84%E6%96%99%E7%AE%A1%E7%90%86.doc?attredirects=0" target="_blank" rel="external noopener">ACCESS编程开发资料管理.doc</a>&nbsp;20k</p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VBA/Access%202000%20%E5%B8%AE%E5%8A%A9.CHM?attredirects=0" target="_blank" rel="external noopener">Access 2000 帮助.CHM</a>&nbsp;3563k</p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VBA/Access2000VBA%E4%B8%80%E5%86%8C%E9%80%9A.pdf?attredirects=0" target="_blank" rel="external noopener">Access2000VBA一册通.pdf</a>&nbsp;5978k</p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VBA/Access%E4%B8%AD%E6%96%87%E7%89%88%E5%AE%9E%E4%BE%8B%E4%B8%8E%E7%96%91%E9%9A%BE%E8%A7%A3%E7%AD%94.zip?attredirects=0" target="_blank" rel="external noopener">Access中文版实例与疑难解答.zip</a>&nbsp;591k</p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VBA/Access%E6%95%99%E6%9D%90%E5%92%8C%E8%8C%83%E4%BE%8B.zip?attredirects=0" target="_blank" rel="external noopener">Access教材和范例.zip</a>&nbsp;103k</p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VBA/Access%E6%95%B0%E6%8D%AE%E5%BA%93%E9%80%9A%E7%94%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F.rar?attredirects=0" target="_blank" rel="external noopener">Access数据库通用管理系统.rar</a>&nbsp;5141k</p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VBA/AdvancedVBAPasswordRecovery.zip?attredirects=0" target="_blank" rel="external noopener">AdvancedVBAPasswordRecovery.zip</a>&nbsp;983k</p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VBA/Excel%E4%B8%8EVBA%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%28mini%29.pdf?attredirects=0" target="_blank" rel="external noopener">Excel与VBA程序设计(mini).pdf</a>&nbsp;779k</p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VBA/Excel%E4%B8%8EVBA%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1.pdf?attredirects=0" target="_blank" rel="external noopener">Excel与VBA程序设计.pdf</a>&nbsp;1077k</p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VBA/Excel%E4%B8%8EVBA%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1_new.pdf?attredirects=0" target="_blank" rel="external noopener">Excel与VBA程序设计_new.pdf</a>&nbsp;1077k</p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VBA/VBA%20For%20Access%202000%20%E8%B5%84%E6%96%99.CHM?attredirects=0" target="_blank" rel="external noopener">VBA For Access 2000 资料.CHM</a>&nbsp;1634k</p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VBA/VBA%20For%20Excel%202000%20%E8%B5%84%E6%96%99.CHM?attredirects=0" target="_blank" rel="external noopener">VBA For Excel 2000 资料.CHM</a>&nbsp;1625k</p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VBA/VBA%20For%20Excel%202002%20%E8%B5%84%E6%96%99.CHM?attredirects=0" target="_blank" rel="external noopener">VBA For Excel 2002 资料.CHM</a>&nbsp;1831k</p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VBA/VBA%20For%20Outlook%202000%20%E8%B5%84%E6%96%99.CHM?attredirects=0" target="_blank" rel="external noopener">VBA For Outlook 2000 资料.CHM</a>&nbsp;778k</p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VBA/VBA%20For%20Outlook%202002%20%E8%B5%84%E6%96%99.CHM?attredirects=0" target="_blank" rel="external noopener">VBA For Outlook 2002 资料.CHM</a>&nbsp;601k</p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VBA/VBA%20For%20Word%202000%20%E8%B5%84%E6%96%99.CHM?attredirects=0" target="_blank" rel="external noopener">VBA For Word 2000 资料.CHM</a>&nbsp;2065k</p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VBA/VBA%20For%20Word%202002%20%E8%B5%84%E6%96%99.CHM?attredirects=0" target="_blank" rel="external noopener">VBA For Word 2002 资料.CHM</a>&nbsp;2413k</p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VBA/VBA%E4%B8%80%E5%86%8C%E9%80%9AAccess2000.pdf?attredirects=0" target="_blank" rel="external noopener">VBA一册通Access2000.pdf</a>&nbsp;5978k</p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VBA/VBA%E4%B8%80%E5%86%8C%E9%80%9AExcel2000_PDF.rar?attredirects=0" target="_blank" rel="external noopener">VBA一册通Excel2000_PDF.rar</a>&nbsp;6631k</p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VBA/VBA%E4%B8%80%E5%86%8C%E9%80%9AWord2000.pdf?attredirects=0" target="_blank" rel="external noopener">VBA一册通Word2000.pdf</a>&nbsp;4303k</p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VBA/VBA%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80.doc?attredirects=0" target="_blank" rel="external noopener">VBA语言基础.doc</a>&nbsp;65k</p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VBA/Word%20VBA%E5%AD%A6%E4%B9%A0.rar?attredirects=0" target="_blank" rel="external noopener">Word VBA学习.rar</a>&nbsp;665k</p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VBA/excel%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0_%E6%89%93%E5%8D%B0%E7%89%88_doc.rar?attredirects=0" target="_blank" rel="external noopener">excel学习笔记_打印版_doc.rar</a>&nbsp;177k</p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VBA/%E5%AE%88%E6%9F%94wordvba%E8%AE%B2%E5%BA%A7.rar?attredirects=0" target="_blank" rel="external noopener">守柔wordvba讲座.rar</a>&nbsp;2250k</p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VBA/%E6%96%B0%E5%AE%9D%E7%9A%84ACCESS%E5%9F%B9%E8%AE%AD%E6%95%99%E7%A8%8B%20.zip?attredirects=0" target="_blank" rel="external noopener">新宝的ACCESS培训教程 .zip</a>&nbsp;142k</p>
<p class="p"><a class="xref" href="http://www.mvps.org/access/modules/mdl0057.htm" target="_blank" rel="external noopener">VBA读TXT文件的类</a></p>
<p class="p"><a class="xref" href="http://blog.csdn.net/zhudier/archive/2004/06/28/28339.aspx" target="_blank" rel="external noopener">Access学习方法总结</a></p>
<p class="p"><a class="xref" href="http://www.officefans.net/cdb/viewthread.php?tid=15210&amp;amp%3Bextra=&amp;amp%3Bpage=2" target="_blank" rel="external noopener">银企对帐系统！ (Excel)</a></p>
<p class="p"><a class="xref" href="http://www.excelfans.cn/Blog/default.asp" target="_blank" rel="external noopener">飞鸿工作室</a></p>
<p class="p"><a class="xref" href="http://www.office-cn.net/" target="_blank" rel="external noopener">ACCESS中国</a></p>
<p class="p"><a class="xref" href="http://www.microsoft.com/china/msdn/library/office/office/BusinessApps0608.mspx?mfr=true" target="_blank" rel="external noopener">以 Office 为开发平台时所需掌握的知识</a></p>
<p class="p"><a class="xref" href="http://www.excelhome.net/" target="_blank" rel="external noopener">excelhome-excel教程下载和软件下载中心</a></p>
<p class="p"><a class="xref" href="http://www.officefans.net/,http://www.officeren.cn/" target="_blank" rel="external noopener">http://www.officefans.net/,http://www.officeren.cn/</a>已废弃</p>
</div>
<nav role="navigation" class="related-links"><ul class="ullinks"><li class="link ulchildlink"><strong><a href="Vba%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80.html">vba语法基础</a></strong><br></li><li class="link ulchildlink"><strong><a href="Vba%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%9E%8B.html">vba对象模型</a></strong><br></li><li class="link ulchildlink"><strong><a href="Vba%E7%A0%B4%E8%A7%A3%E5%8F%8D%E7%BC%96%E8%AF%91.html">vba破解反编译</a></strong><br></li><li class="link ulchildlink"><strong><a href="Vba%E9%AB%98%E7%BA%A7%E5%BA%94%E7%94%A8.html">vba高级应用</a></strong><br></li><li class="link ulchildlink"><strong><a href="Excel%E5%AD%97%E6%AE%B5%E6%88%AA%E6%96%AD%E9%97%AE%E9%A2%98.html">excel字段截断问题</a></strong><br></li></ul><div class="familylinks"><div class="parentlink"><strong>父主题：</strong> <a class="link" href="%E7%A8%8B%E5%BA%8F%E8%AF%AD%E8%A8%80.html">程序语言</a></div></div></nav></article></main></body></html>