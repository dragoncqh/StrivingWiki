<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"120ccb595510ff3e1eecec95e7e998a72c6b04608e5d768d61d2a80e4679bffde97d058ec9aa1962bfab34c2d8b01c46fc7c8f32a3febfda8f0664115a55c27d6e00444ad3327600450b26e9fb54eea58657aa8e8357456451e6e3ac0d4fc26b10b1623cc5aba3b8c488ccb8882e4eafd9c090c027f38da17d815e0c30f93a8f65f126444cb8455db0cf3b1062b1b69747ff61efbb8ac0485fc3d9fa8c44b63ef743da59e5fd7789914cca761c78bdd0e4b8c497239be834f3d2e4f7a70df6f6443824d6f92de4d55b777fcc8dfdc2a1fd1234cf4e73c93cfed4e5701ecc0ee54d04b1426399bc1761eb980628b30d5b54ad74851e93cd4f0b27bdfcfaebe7061872c669b3ee76487bc30c58e8fe6e09724afa039d9da0829309260cd4eadb8a059d602d0af50d1b35ee8c08dc2fbb87d890afc70ba8d57976dd469dfbdd96d7ebe2fa452ef627b8b7dc5d225d742e0809cc3b78e59fec106ad69291da1b0de2b08f4d59644f384dc5cd3bc3077544f671ebcc833e3c60097c41b58c44619f81cbfeb9c966bbf88020a74a282defbd20f8dac709b341213192c6bba58ca9a9a9f78a3a232722f0350c02aa29047367e15855dcc4c9ef8fbc8800bcd7557f5d3442155d88d117380c3fd0cc830c4d0904682b8419d334287691be4b0829818eee5161cd45755aa665f6250241d6a739e74e2e59a546870416df2cc6a967d2f72d3018d4b299bf8636f2178cd2c0309ec7a4d2fd057681c08b39b95e62fe9f17cf3d3196770c5b608df06922e4e97b8e2ce7bbc5e65fca36728449d1e4077b7f213915cedb7030a041b384af68aba6d7659347ae1723f3cc929d6e511a2f01b0d95a9e277ff0843e995265218e3bc76becf014abeb39193deed562f31db75fd03c2b673a0e7cf138ede50e3d3fd81b06ae6224a2f987673d4e16383c7479cb726245b686e5692ab37e77fd743aa5afd70fdf763b3525f2dff47d5583b85f79300e5f6f153c31d84781284ec6a29eeaf59362c36306aeafb390f65dec5643dd5279bcd6438d71e043e20859c121069b0ba83dca24354446770fa45538c4fe45382601410b670af57e9ea5eaa0ee8caa6772779721f09a8e146021916ed7f840de7d255be9bdb80f24264956cb30f83b94d72492a2d146737b218a8c63bd9d5098087cfe666762836027a25620016f790023bdf2cc9354fcfd69c5ffff7e4d14880e946cec0c4c21660abe878b385dc88a34f236c05e462435b974ccef0ae206edca4d2a2eb62b7b7499e0ea3b333aa1f7e351d9226f4de6f68a9f0a0da979a8d0ced280f9b19834319d34fc28822c18a1e9757c50a8df9d68d42ece4b43427e462720e8e2768cd88f860d0676f5de7eaab626f2061f4c076dee1abb6d24b2a6f013060ba67493c3f57abbd116761dac412976addcf2424279315d7f7ba4f7cac539d4be73c6b890d8c55e0c348885a8fc301a0aff009e6dff003a8ed03b4c691f9faed45cef98828c5499c0ee6475ebd0816bfd8cb9fe90203f46d1df2cbac25f4cec0eaa41bdb111004947ec0da3dd321ff657618b528c41254b83213b775027d65fed315ee1ddf523a6c789c9e16a04513f0cdfdffb0e84922675034c12d42c719b7ec8a61a9dcd311d8738e329c0efca273b0e207d91e2969f2d8d1f6c1fe1230f520f6b246ecfa31cc493b320cc2d2cfb14f163bdfd0ebc7c2d1ece395dfffe0d9936b49f3f7268bcf93d490f925b12abfc6a1af5351200adc2eaa7ffd5880108f0d3b0746b2a3aca64740191e316fff09911b53a2cac1f43e42c34aea16e5021f0542a6630126e76c1038650c69e255c5ee2a533aedac77a748836704a53f100d8913f8102f8f9c02b74888ba2065f66631c0f76a06028a8a8f161920857a1f37f3856405ba15605afba4443b3046b2b7e44de1637edcfa40840310799297874c2c98402221fb35f1469c597fde9c3890d9fbeba5afdfc6b66366f0be29bdbe58b58865feef80873b3f22529a395ce9455434bea6bd2fb0682b90930b5fa081176362f893c1d18950632857390910c80eac76c25849b9933db504e8a835aa8fa986eeb2ec7bec1ff61cc50be28b0956d8635a52906d65da0c072a082cc41a16493acb8b03535e576a53a078eaa2d4f52b8f16c3b16b9692620a67c51504689a0f6d0285abb1429fba862629b452b1d298c08ee585916b611088c0875c78a6c20d8b9b69e653aa7b494e59bdaed98a969e7d2cad1aa7c391538379fa48b50334e3ecd961a28d3c8aacc5be69af3d4094878e2859b426781dbb90c1024ade9a59eede60b26e3ef42a3b10ccf3be18c6c0d89ce0f0b1c65663145ecb681ac8fdc15ffa901e9f19302400bfb00d5ba1dd0d29831ca5951444a19f297e9f1186248bf244d40b8cd3c3f166cbd4c30f8014418cc0881bfae05376229e698c3ee1b8d33cc0c762c7c9cfde11d77cffe3b26ad9fdcdf839f674ae2e060f7f6ae43ad3185e1317a6bc1036840369d5dfded37b225ea8c97f693bffc841c08111f1026ff44bf8399fb23a9880de9a86ec58da993268de425ab82b0c68407db6a539c7d3143779bf02a6e42d66d0ff3d0f630bc80022c00399a73db5e67c33842beeb1093ed3be3456bf094ed55fbd7316474c04bce2a3de1cde24afa7efdde6ad7a53615bcdaaa04940c4a7a9fae9b633939187f94d054e78ee6b806996a0c50e386071794a086cb3b058b0125a66fc16d2564d9c01b9c4f1056b45d0aa325fed0ec1a3094c84984a01dd40f49a720534eb0652dcec47c23c9f8ef6214ab8cfc6811b530b11999f7bfc3595e14998ffa9f0dfe4396469662c701008f88ace8eebd184ac7e845db71231223b2eaacc1aaa9c68d980637c9d5250dee69a164ce96037fef142876e6fa575e3ef5794d76eeebdab694899b994a6efa3bf8e0389e03d0fafec746efab03eebbe9e147746f55ba14cacebd46e1387ff64ccc6dac32e2dee3f6397ffa2099f95e8d1e4c595296464a1a247953a54be2ea55a6b7e0b25f6b0740c45149b7d4f9ac85bd55565345c8b66d0ed79e7ea24000c748eb83f006699bf473ddf49ac645c2205664516a876a5e025dec158f0a04b3ccaf369f8d90d0db232920e064ddcf0666fe6aabab8b97c2bf8dbc195ce0897482935ac9607d29e0d1fcf4b088407aa27e1228cd8b491a474a30dc3986845791061bfdb1bb16bede0686e969573cebb31a4514656adf066b897d728551a06b50d8206dc5cef9b425e0ff309dc0c7948a199f1cec5dafb4f994ca10ac1df33fd3ff059375873c9704f1c8fc4d50939bad10e6dfb80c4cecb0b656630df190ffdfb89110b74a5b70c0dd0808e15a663ea9da81f92c268dadd85f1458f41d98c2fb477e7648fb6a309ad19ece0af805dd47cd04d33890fd42ac3c5b4bd3384701b4d6f1b250989fd2b922a01f5a0e3d7a829af61663d01c8dd6ccb31982af9c17903457a4579029686200f7876087e57af186c8d3ba7c157576abb923745e665913b957cb34f4aee4e581c4b8f406442e207e4bfbce11e23a095cd805fd698ffad828aaeecc3c62bf0dac0b9a4ade442cb386b2dac7781e64101ef529147a3a9c71ac231c405e3df804b1b11be1968c019fb1b528382df2fa657fc6b32c5b8ec606daefd5d9676a328b61be90a3e0ab3d18e1fea96d69a4f6058d3abddf943d7ddae739152a115c9c243052c39697dbe3fdab2699de48029cb8d52d9379b9edee88378995dd0b057240abf42de772cbfd6657e4ebd059915e2a58ad07e1db4a92969a63244cbd37f7ed8bd699ebfee2069caf84f7f005a362728855556095f6c8a6ee7a0ab0e696dd97fa2c92d0f2de68baf3acbc367ba7297110b55d0f0c3cf98e4ec45aa07530a74f0e946d1951d5790a31fe521985732092b64efaf8c5847f963d68b71569dd6c6d23fd27fcfd9bc7ce88e5e95c3b6c9762ff3fb9e4aa500635a2d74cb1223a9796338be2c96ac64662974f3db19102c4be96feef341c3d9f3da74585b9d661fd86803686bc19a3448679c8cff154336645f0d3b83f8130c00f96f5fe3035751f9d4298358b4f1f6277edc21ab9f5d3a8a6f0a7fb2bc23699179e52873a988119b1c2beee91c3ef8727e6584d1db52760b4404e135e8566a04b7ce7d0f41dd2ae10085eac941c9e7ce36275ce8d3e922eccad57604bbe5c3c2ba1d7cce9a6f6d383304091ce384c1a0d6cf6b6213ba21e366aa741b773f3bd387cca59c975811cbfa4364bf37416a7f9fad87dd446069da5c37a0e1453c1f8cfe4d82c96262e696891f1e3dd8b47b4b7537067d7f0827973f257b772208569465fa19109cc15bf706191e79e067f0802aca084fbcf449b8a2866ebfbfe0eec8540d5e3427ac644aa54a48ab0fbe1ae1a83380f93d505695b10511293209359e6ec827aa4e1e68c28c89f66dc6c4603fda722521813650be009dd8ec17926d542cb0ae6a3a8cfbdb472d74b00a56e2c90aaff8d356f25c579ba09ef603451b8d859cea0b4a01886b2d90210fddd8fdcba52607f30979e61afd999e6115bfe6134e3aa6e588019b300c9af7b211f8c9924bcb66c96f90e4cb29df5ca1d5aff697a0d4aa957269742902bd17f0282a9141d2e30dca671fdc642aa2e8872ef3b19d02f01f738a91d0a44618d61702e9919e7d19dff67b661bff3c637fccd9f29fbb8ef79f257eaffbeb0760a0ff14e55437fde135cc4173ffdcbebacab4cbaf6c07a1a17c2db0c8c24229bc148f56bb0a6f2b72f19553e26e576fe4d16d9f59285b0f027bea71a4a0d5a341d19b4c9165e62c934e03084beb292dbea6b5fbcc4ee44dbc51bbd2c5a34bf834a52518c350ab0457a9f7dde63246a245c7a6d875c7547f3d38083191e1f10fef2fa06ccc1e3df712326304a351362707a6ecda296421f6e8187a1ed13e0a1b4241d38a234a609185ff8055e823791add6e599e948d87f1a063cd787b8941959222484b4429653cd267fee434e1afe05c3f7523b9cfc55441b9c40d5cd449b397dde7e548bb6c72097857312a2bbf83c98ba2b1c888e7ce1fa33fbce8b9d43c7cddd080e51ed9815f3e3cb8e9f3da59183313ff3d21fce7221cfb78b61d3e34a2615afb5e24e2a0b5afbc3e0273ad84ff549c475fee68cfde03209fa712110702064574a8bece2c39ca58d8ae0ec176734806486188d4dc0ac32cb56c1a5f3fce09dccab48faeb3b527e3af49e0f880ea0e4139923683e08b8bda1b1306a162851cb0fe57e01c90eab3901bc44f4504bb3ab1b35c2053315f9a78f4a5074a60249862052efeaa0a7a2f9d586f73cc0ac087fa345a268d2f0aa3f8b97caf36a59e0a7ddc223c18c69f327454a8b6b4d3907fac78b2671cf5e7b8de69ae8c86fbae6f2f204ad7653002b6ebf32ac339aca9afad5916eb2e6a1e2fd185ed0002adf46e91d88fc194ce70c57a84237c10fa8177f1ffb3e67659d46718e0aa1427574d0688149cb6994812f516b4520b7f4f030813e10d89dc53457e6a8bd5c680059aa6e8bf0dbd7743767307a983c4c95dd1d4f8f41e9f4ccf17202b6fe688911badfba5db3b48989b5eecd74cd7d055838d8efef9f48f65999667df56925ce7bfcdb1b4cfb42fc5213ae21f252b8a985c2e622b967678de206db0ec6aa3b7ae27fe744113b86d1482f5528ae9fc90da6cc730f92625d760af56df39f431a8cc34612c0be9a1392ed320e9298f345f6d6c693577b914a7a61b4d6b751d4d76735359fa5be80b252fb9dbadfd44291e1bdd1facb92e4a217c0b429e4ae84e448b5a0d9c5faba4d8fb23d142981622471550e437145698ed03ada13561e67e2395afb7cee91949f85ad80158b0b6f6efc31f13c3c1ba2fdc45e9319b73e850007a4a02a3989ed7ab1fdc538a6196d03660dd6d4c2ec659e9289e02912cbfa0ae8bab582249098ce9cfefabbbd7d8b47d1bd5a8efd029ddc0341438d2a96d08dbdc68f09b77ca6d85b4c8206cfcd9a0901fd069de14e004554bad93e026698fdc0616a037106d12bc975cbbf353113c506738109a88378dfa1ff854086c73d95007414d5dc40b52b2b733e454213fca799af7d4b686991e9886e53d84b6b642a83ed93e173a2eba8eb6b47a47748e8cdfd82312a080364d70776c685159af4ef928e7650ee2b21c036d84d24ece7d221bf86dab27a6b0e4121427efb76a31caf5f8f3976062541555101dbf33f9bef70d89994505917bdf1741fe6d738b4ad2eccfbf2a667dff5bd3c2c2ddf149296b943b6a7c16c2ed50c6a270579eee11640d1204af5e38dbc60343ea8903cab52f527b3c16a58e8b7ea9a85c82bc15dc026db54b336c906fa937df7d860dbf29bc722111498680e1ab30f7d4f6165bac5ef4933ed90e7f834e8e7d8473945e906c7c2402e08490272de05e8284d0e7ee3c61a910aaa87bd754a73d459448200059ec2b1d90beeec79be07cb8ff73a7c680e20829fdeedab8e27a9613bffffee318dd23d74c36ad19d7fb7d227d53df1e6115bd2661fb14d4af1c461e0572cfdd4f8620f4e1c738d9cbfda6b71dbcbdb44d6e8a5052c0bd9c0d23fe97d21f73aef76435f743b4c35bd59ff56c7caff197624464cc021526441b47f1a697357769efc4e138ad483d14f1b87c2d286212b23f434be3b99bbb152bbc05fb1497ac5c818a0922e77350bc9cab86247d2b7544092882acdb3a2f3fba55fb9c6354b18db66150e7dbc4eb394621e5adc81185cfc6152dd1cc3f74dcaccef099608d72bd3a9f146a5dabe46368a740b1b6a778c672b75bb8670dbaba3b2a7d96dc3181737862fbc4d5bf6c760f04a5152486fd0b8a621eab7155e1266bb435a13a35264bca46777761fdb080624a6a9d5fbbff6de06eaf43aa1a887788dffd00b5a9b2b1eeb13a83c5dce514065929c321682b406514431464721c55ad893f1ee8d05a61c24e7272f4513b7a0d2c1784db82d52108515e38cf33c74378794a08f9f28098d3963da2f4a6aabf796b20429fd3411034355f8aa79c600748977b7351ab1849f069b547260a88c4800cea13a0e49872b588214af8f93d8c6f1db69142aed2a4c0e43d566c525fbb561058563e57a0dea05b77c86b800f8fa643937d001fe73fab61b5ae6541013e52999e2497bc7f1d3e6d5e1634672572526949f711f4a055bcdc31e683110c4d038fc871d894884c00e8fb323c6e62e4b6c71c664db056406872cd3097a61c116c67ce4d630201c25f2c81c96804f50de5286d1f2af9c9041b30c50c817f80e4a2eaf3f9cbfa5521a640045c1d4a9fe2d3cc8b407798cf561a4b1ba812df60f0529ebc4fd15af5925a96b170fb795f65b0db91bb85fd8bc05d07ebad13c47a8e744663aad03789366ebc5e25748b9473791f5534b3e63f7e0ad655ff2e7c060fff3b44d77c8335b32386213ce45be835f04c4b08ab15c2bed1644831a2ddb44813a829d25f6624daddeccd19f438538dfa41fb3f807e1abc66623510026614be5eb7674f9efaccd4b884a213372ed2a33dd3470dff85795fb4ec71e1142ba846f7e6a92d118cd0362818c23fac19a989755eee7986df8cb7248ceabb9258b5188351599cb2a5fe10565311b6d48093e1d68806682a4e52ae22611684dff2df6dc27d8cba1c280faf39194b9da7b889c1c9693ccfe7ca185bfb269e7fa8b84db0e4c5c7bdb01c8c102012dc67bd4ee64f20952c51f1ae3c0c8fd987dd490f2171a13226c85302229688a404d04357e10d8259a0a51ffb65d52a92d67ac9440fed277550a8d093683ad98d54753761a502ab941d7d0ffa6654736ab096116cbba539ee84f0adba4b9dcc20c517b7b40a618e561b6df11ac89ec80af5f90212a31850ae8138b083ef5c97bcb622a5738b907a21b36ac0a068853bf171369489c7dbadffae46611db3f03540566f372e39061449564ab81b55e17c9e9fa255658589f2d174b1094e4fce872a0560a515e8f36adaffef5af933a5421d0b88b65a9a84961b22b2970e3e3632bb59010df15ad9fbdbbeb12115523c0c907a7ad13b1e3c4ca64c911a27b140ae3e837b7900b53edee3bb22d0eb54401804277528c5e95d098d1b074bfb0d892a3b8089d7a83847dbc22807540c2726557baa8e953b5362b340b7235b7cd6087ab29ba4d929818ede182f1cb2610f7e9a0ecca9373d6cddb22862aea05a18e71f155b6c6a47685360ef492099f63cba49d49962e27bb5d10b9a433b7a9537dee7235c38c47828d2e492339c7e77d78be2713a08c50c35cb5857a067a6f7abae1b9dd6f433da940b3b12c5a8a3b3da9c7d2bdd09429bb242126b2423d11658517d9ce7453df215ab9621605c09d887229a93e1d2ebbcaf5eed0f743e28391162fde876eda1042a4d18119832feba731cb373e41e383efb1bbc9e5044f5fa9e50f576d038affc2f807cbfae47e4cbd624731db598bf754168f18c1c45c8f06e9e0f32dd1d0c5ea204d5d98ea4708bc1eb422a2498e2b814b401437deaebcff77937fa3d15576e35a85a5a2576c848c3ed172b10e4424598923c2be57405d0a1cdd65954756a11e7b79dce36c7511e5e3e23fa991dd31357e3075d9704f0ce037acbdee504e36721a75d7b82b21aa2d54ac3256b128073dff3b2317cf5a721d7f68d3eccd5427e2eeb41302514fd9425fa8f1cecdd538d2efced6d4f0bd10ab79b92c7ce67ad0a4c1cb180ee2799d4465fd6cf3be1ec7b2d90d7bb989f55137c5ed1db08aafbd55ef0cf5f78f4c7d54efa986305f1ebae88b9e2f15f3e7cdede65c60efa422dd4cf8b89bac626a85ed856a4b1a85030ae20f2bf42f7c79668e9b7f3a4e1c238ace3119f3b2d0e3873b394aa1dabe8e24b479cd05b0bc81b3db3fa38c7e406267f307935348f5b0f9793dbdb00ba01d53228dbe6ab9d28b09fb7419052d6859746d0292efedfe3dfd1aead95e127077d1bf91727ced5cdac56cfa6cea72fb0da5bd458f3a3c503250c8ef41644d5006c6345945feb79532ff6dc19da9aa586c7af1bd3b96af3a184db0a3b8b8dbd240cffb6911d5e99eff44ac04b969d60a19322957583b3863989d3270372bac7bb3dddfe0da5261ccf24948dac5a2e73375834f56eee2a7e309a8371851df9570df6e21f73d5d83f89914e23c79e305dfad4d3c79760020d8e86c18e37657d35069d8b4921f10f473e4de68ba801d0d779d8dbae96be758f1545be63f53d6bde18754437eb74b5676a497bb6e4e0bdab2b36ee5596b5759669e65fb250072619f2085ce2c7ce7a0a921da0ea7cbc5d5138955d3496e81d29717ed3e1d50634f76b3bbc1eccad07b176e797d4c5b602e4a6fea68bd63f53ab26ac322dc226d72549fdc1d9878fa910144076f5bb8fe141fed749922bbe9ae030e177ee3b631fa0375f5247bbc70fb11a338b0eae85621a3a6f9cd907ccf7a625072957127e60ed4fe8e6c62addb1c2b46b0860780b5d20fc481a9c716c45fc8021ca297f926e20693f8b9b6df6dd686a877db1382df9b5a7c1ceb8bf769681cd59f308bfbdb9528af016804ea48de5549c9d13fc7e574d9f30e072fcb74a531c436a6aa062b0625178eea9f1e284a44d0b073a0de4f22d764540c47f7a17eb87658c760eafb693d0ad69bb773105f28602235f681befaa9cd5dd23305ce9da10c4a223b7ed3442051c3be3b8e07bc1562181cb2be779c3c45622c87032be5228cfb5ce8de9782898b160dcc81ea47b27a83692986714d501d4e130d57639661bc80b0be923f9f1afbc2ef9960234e51d86c1a6fd9f8d481d16f47aa1c94065ad74eb0a54a37bc3de4242edaaedd0ba761c34e76db38c8c299e539a43d844f3185dde4ec4a75ca81497ebcc126363def9a1fb40018413b67a5c59edf97a468f55d67d5521f4953b4f8c219e6308c0b52fc502faf7e2e4045223b4d2cebd455113e803a157ba316a4bfd515b2fd4a7f6fb444b702a9cf1ac73460388b06dce9a1a0dbfad4fc1d2ebe6cf69cdd639f1a31d9e06371c6f05fc4196df241dbb591ab124bb226b5b4f60f4aaadbecff99a18de965856fc8c606adb7c3700516a294f012932104e21c4a525afc223e465d7a01e6a9bd08c66e38ca87a65eba900582c90a24aea7d9d32111ea1f1c196423a36d6cb57c3f4b1f1bf38c8702a63719a3c2b249b8bd124b466102db5e23cee663f86a4f162101c28291cb188dfa41bb94af9f54577d085a312471134c0e8b7ca59f9b8816b31caa653627956fd59ce3d44ee66a3b1fef19ea9bd7939f356cad7163c19ec069df35a65f4483699894ac0fdcc8a1866b25c4c280c6cc06190957527452100c7ff7f13917334a612a3f61eeebff018dd48a2221844271efd2e205fe65945f8d3edb17150fe7b9da45da5fe3fee8259ec378768129d88a93842f252e17f6d9006af3d9e9198e126d19a0b7d0005b55a76f78bcb0d54412b8329cf8faa288e11a84de7923764087aca5a9f85cbdac0561a685e618fafdbfcdcca6ba3ad8bcca66ebc9f45265a17772b40f7c52ee48dd35f6281a9ee4e1c37fb7911cf66298b6b9d481fe777a5c717fde67c9d22e86f58fa9be8e531de9664f003be14e74493dbd5c725c63613a2352419aff1cbbe73408760da72396fc2a5d2b6aaaf6383ddd2d187345bb40c15bb65129629655792c958713230d21e3f7068fa9e808b62cfca1124d0dd4f4aa9790f0dd7d1defa4c2db6e19c266441d5845b8315bf69e858d91e5fc7a95e06c9f575e6e1bbaaf7a39e98361ae215269b2c973e7528bf7f344cf5d7ac365b5c509004c9e0897b0779be2e672faf357f30b63c81fd3cb6ea227db3a24062ea736aa1dec7691d02b9be2494f8eeb58a81612c716e449c2236999cc379a857773b96b05aca4723452e6a03bc60f5343990e7db578a6b3870a1df20e7d6870a61329753ba601e0f4ce1baa03262009d5d52ec5b17d4fd863b99726c12fa7b8f99579aa299f507f2937ee9983c7330bcec4296d912fe72a59947c2d9f4b5077a3956ff1a9cc2e69921879679253b98afa67ce69b5277823515006f08aa080d3bdb3f3f6883b40b839d11ecdfcee8be1a920f8315503bfed6587855979f57d8e6efa47be5f7eb384a12ae452338be14c8928877241e90abcc118ef0c0c579e2ba04e2856dbef45c634c27554a32ba5695051c9906917dda37505db99a8ab443a32ac5a212439896e617245ca40b325677fa9a02231cf792b8704229f1d1bc0cfad341b345107f3e04f2205956b701e5973632063db59cb1f3423050973419911b24a1ee6b40d4a9cdafb17ca2e4d6c38e798284bdff075aff9eb4abd4a341de4d88f927db3444f767547cf43fce67931f3ee4516d3ddfdf958521cca0b1ae24bcc8d361c8c92379a618c73811c64091b45957840deeb3050da7d8f481dfac57048456c4ff99e92463fca7af533e69fb3ab19fa468371d39bb2c151f585d510aff73258c8c6bdd82056842cc5ef71f81ecdfaa1c1fd7a263bac2a50a5ec42ebdbdbc292d8f44527eec6f0d65fd75e60a47b9054ceaccb4aaf2280517d1aeb5a09b6e4263b50496a6daa41b2e19a388e2496e4e033a653c98786a5751292f84ac9faa85dc6682ab83819c59301be94324e30049eb07519a4bcb8794b565d06e9a1dfc25bcd1a695e02b8ae135801c9efea3b1f3c200514db10c959689df84fc59a83fa24f0fe286dccae04939233e3a5cc1eef69129e54c672b5959812af49b7190664931a3fe0c0ab39ef5117e7463d503e1fca17b5d2ff0bf4b1c9df6a9d48fe8f193bcea0ad4d71bf3f83ef3acd46a473a1aa4e68d1ed1c50ccfd4a35a7a57dcc90640d63ffafeb481857de412de6f7623420a58f09936ffce92b0c42763b2e18860ae37ef262d5ca4a0fb7cf5ef14edcb776cf76362ae4713e413f37602476ef52dbbba397226e69b88c2b6ff5325a9d814ebb0d8a9bfaaa94cf5df4cc1e444c33c0f05cf2e097eb7f622c8e62d281bea1880acdf63d32afb833a3c49c6b6195a34533eda8571e85cd16cd83bda57c366ff6a4dacfb887f53e3a7ed6a417e35f430b1906ffa2b180fba43a0c1252d940076373035c3dae97fb38b3fb781f51bce878446cdf0fa6d5abcc5a7ccc153047f82f732baa4d06f554100b41534fa2cd6a620a0b8caad557a8d3a326ba0af41c4e71b69225d4f1764e35bf19269f2b68dbbc257afa110d45b444223815f50d3d66c8a2f2cbd289914583ecfcd0791e101c71ecbf67b877f5065f4450d1701cab464eda566a1d843bb3aa447c19a9119a28eea73474d4f32333b9a22261fadccd3b71edd5e0acad6d0ed6d1025c3704ae07104a21957e49f0e81fed784cee45fc5af3b5010f759d8e678354ff888d5273c6c3762b0dd6441eb9d6eb1dc3506a8eb1c1e184ccfa6cbe0272d6661e7581bed71ed133444f1f41206f85e4e30b9e413f812b3ed8d769f8c4a5ac79876df1665c9c828100d664f1c23dbff03881178ef436f69ab0b1cc75494b5bb28aeaa8868be94ef60f55110b83d4cbcd2db7411e6175b309f5ee3f782d797e94d9e570ad19c465c4592b4ee8a2c68ad6aeecbd880bb2c9da05a142ef91ab36ae14e42c0e6da4ceccda83a9c8db0e790a815033bd6a6b7cbcc445501155b91ff638e6603e379cf7d1b28e4b0bac0eb07519bbf3c05cf6802f4100001f1b7fc75fbcf716f02f282aae1ca4981138de7960810280a96ce9dc3dc982da872a39d4dace3a1018e0d13cfd2e8c64ffef057148041763fd9d240d40a71c5eef03af2678469b9153c890e31fb9ac3a8fbd2dce2b2432b6a3b68cc5ec0dc9ec21ee8b3ef309cff87567437ea8fe0dc834265caa3bfb552a971c1f73100f7e7a53716fc68e8cc843854b741d366bd9683e8626e8b489e331c8a3748ba70ebcd6250e1aa6bf955f1615c3742c7cd71c20f0f32f5484255b6e21a57830cad6ed1689383eed76f53eff2272fc1250469c7a537c9c3a4586678fe44c625fa416d893502ca589aa0bff765133317b7a79c58fe2360a3b8d2a4b47a3f36936f7cd56469343937b2d60b388b67c894166854a2e9c66c3b79025a4365bf3afb60637d57a715bb1dd87b582587befbb63cc8a77a8b61d9dd02d68a0b1d5d0a2c3109b1b189b1d972179576ab634d339da646b3eff5cfba37e564b74a2ec698f48af8294368dd19e167a32cd288d9253877a3bb215c7c72f423cbabf01917261b1d53c41faf8f93d0ec73989b149e6cc906a7a7ace0578adf236b7fa852dff56d297627cf9bdfe9a99c779242157042af5bb56e982a82bba883dbe880917cf9fddaf36d303dc27b56ae8b62a240bf409d647e8bb6a2d2dc489fe39aa12742a0608ed57f3c0b23430835583e7a6a6c4af512df1ad7a525977a80aee4f0221d3484d8ed3f6a9f23899ca5946f2484b5403accf689b1b1dd02e2c85e7ab27961222a094ce3e14d1ffc1a7fd8177a566dca30e019e46f8b6e3c797218989b9960cfa72ad58991220a87a0b164312896237dc60d6423d8bdb44200b26d862869462239880cc71d8f682c5d27435330123629b90ad89221bb8bac6bc70631b0ee9c978f439eaa41a8f92f256dc2da04f4236c5b46c93264c5d649be5a30a8850995ac89d1d1e551c3967d4e2039317578bc8fa8bdabac41ee180410ceedee466d45f70b7165143b2b2fdd9ba8d5de14b2e90c120703f59113bd19d5a938ba2d1f685671ec3daf2624a647a03207c0463eae455be4186bffe5a3223b71301cef3c1556ca3afb12b16b56e568020906a8968d43378454fb909aa5005f64df10dfeab7db01d9407767dad6100040fc9d46b955698ea1cca6f61b0f6a85919a2f035d3c11f1592376e7717d8be9cdac94c411174623643301cdebfa234f621c0e6ea539a08f48ca40b6f1a8d49ced5da34a66184bf5d785e303874da75d9ca4868047609c80ee6876a1f63c86ec242c061a24176f974c6c109c54fa816ef2e2a08d50f3b88ce4707bb27c8a78e189851ebff333070c8fde641a4f3184eabd3979293fd57a5462482ad8b73655422ddb398b983a1b3b91995318c3e71a91f84bbc9a973c786bf8282490be5cafaf5684a5e3d6c470104cea07ccc306873b3f4c434e63f618deb8c6c2f5b39e0c9cba70d530a9f222f364bd7364b5a1bf2838771bd42b0af9a464f2a4fd425e13d3dafad21f9ac19309bf3ba7a17cc8b0f64b5a2512516d361cddf17c91d8757a8f9a96d33221cf7837ef20c57a7ed3738457f15d4b37a6597169722b5bd7be6da11fd3b7a74e14d97429d955833a627cc887e16917da105179139d43b4fa0e54ceabc5ee7d3fc8ae5cbdd16ab594379a366452831f02f2d6478fe27ca0ed0efd0058780accb0759f663144293a8538834a3ca0fe084f791edc3362fa06df434374f7ebab0fdb4770acf69d4895c66539b903c88b007c65faebae8e2fe01a865011143513af5237de42af65819f7f449b61a1330670afe0bb69bdf17dd58e395985c28838773a45cb81a0bdea8444905c2c44c7db7a62d9f5f4bfcdda3bb06380171b9035dc2dd5b21df1c4cc325644838c6509ef40017f2cf67e1cd891bbc28e5ab77ef8c776c47c3e4830796dc5fa3182a9710e526686854ac96955af3aa29d1a07e7583d4e58c418619d4e9c888ab21eb9001d472374a367027d6cf756eaa620c8f97834613ed99a0268ff36d64e87e36f15512b87139f04f671d66d04259cca1dd9bf970e392e2cb3fd3d5ca9a22390c4e31a4c63fb46af834cb8ed63c4f4ea2debb866e4e10aed0519ab3e3f6c468e98b2593bf5b91b0ede86603ae18e88df6af3d88f8f8a18d779a2e86a30d02679c5fd5f03a63bb49a2ad550b32b71f7222a69c4000a010dcd13c1ccab8a9b58a88105ba2a40f458d9682c22a8d0cf5cb683ae7bcd3053a405e0dbcb726818cd36094f127ef29b1f9650fbc6978c8aeebd72302deb1c060d9818fd5651f238470b18b5ff32c63f3495b7bc7c4736ff38b63591cd9d3dff88ddcd9a22009fc9d85e3d3415e452f51a6478ddd02045eb3129ddd32f48e79eb968190a58da2b13bc981317141ee063675e00ebeb5f96d305a6abe4ee02fa6d8aa5d141386d4d765ce032531cf9f7f3c27c76337065451732b9259cb20fe1042068e89653399ebcfe84061330826f10248b25dcea40c8aed441fcfade2323c65f677f5acc61b657279528cbf289a53853781d1ddb5a2c01353d74e11846bbcd602dc8852faa14e11d74727a1a96a919b7affe3c51b2bb92a1ddc213a03016296d1a7e91705ad8fcf2640fd566c40eaaf0ab5453f2aae17ae0f411b0fd7ff6b338d6812ae9fd9693d865bd364a1d3267f54f36c168716b9e629c8be55749fb994de8e34c8f12d7ce339663341c070b65f69ebdc5928ad671a9137c6fbd0eb1250f844e287d333ce7a19e8a399972b7ccb2251b4439a9f260b1a9fe81c6a56c87725efe84de3f27dcbeaeaeb85a0d1a231495e76a2c6a07467d7baa9b34c311323985c50648c9bba1e6845a4a03ab76f445e92f956ea610ff1ad1cad1db9fc19dc7e170f19ebd77eb7e4ad1f87b62cc90bd579c7a194b7a52b254b666613be05fbe93d956dcbda85e165bc39c345e5c73b99411c6f7b57b4968c035dc3e3da183cc04099a946e10528b6c515d345e741421e8459847a62ab99de22eb28965b476ec0e91be4ce19467caaad223946553c2bf8e10b385c3eda6a1394520e151f74189f9afd6cfbc3203319e28a6dd927f17a13d904a411d57e330fc4ad5b99880dac100fde02495572a916fd981962ea19008a2ef900592dca092f05fe8d2970f792ac44f6e625bf52abd38c24b185951e6d6b6d5f3b14fce6e2906b9eb09ff551bb6ec50bfed305525d3f04f0c28f2426cb70714a9f8e4d1f7d7c869fc0c0db8d6450d658689f9c9f9fead0d2b93f68da3e0504a1a48ce7912cbfb27286afa2b3c7e0e06c49d95daf94e2d367d3acf58c72ae83aaf9c7d42ada733385b15b21637746cc24de0510c9e6928fc858c64d21ff6c3712dbf37e908befa03a9f41840935580b697adaea48257aed03f8ec9e7d8cdf9ff6d1969ae2e2463a6d7dd6b86d18a2ed8f884c79ae1e5c6a8b5db8fa056fa53046bcee2519beb6a51da104250de59141e4d4105918d4831fb7b64cb2dbd3f36de099f8eaca04a667c797daf22b68b8557c5f1a36c20c3d18b4d9be864f4fa28716a0f7ec05e5871c77813bd245186c78e5d5df26d3c909421f4d2ebafc1334f598bfce3b0ef963ebe0ac47065274f83a8f0c0a74080f2cd74871669231f17cc87eb55ffe06a489bbbffe13f5e659e951a5de0661cf83325f8fc76feca6ff778de0979a7ce1728b6d154f2be32ade7fc0e45209813bdfc32a6419c9cc13cd081cbcb3e28ba86180f17971825e04f3b83d2828fede3824fcecb492933f7167e38ac938d04ab5fd1469f28af101e1ba09969401f4d931e35fe88bff1f02c7f9902cad956a3bd415598555a354448c29f7962e3730159f703cf017ccb8485bf36934eb54e88ac1565b94672ec9d8afe24db5d8b952cab5eecfca28530cc5a1b9a424dae32d2983416593f971f16eb815aa1bbb2585f0c3e4d3b85ea391f367ee6649028c2ed7d15c5a423dca57f257e689ab796693b7e98622f9c6d586b022b4bdc841ff330b3635fd35079eb03b06a6a136d59180abb63d068f77c2bd46c630d0c7a6061047185efb6048a54319b2fd77f7152f8bfa9d7e62cc2d88f7e71a0ffe1322de2940438680ba19acf6acc92dfaa1e1aaac61f01399c2b578ea7846df64fed962a24ab12b2e5b3204a8589d69f7b5a62d6ee1c1902b6b42802c92cfc3234f3d29e9acc1aa507710aa9d38c3d9486f8ee155e1829f62be54b10b64d9cd7468b5af012bb746ba18917ae7f73f46f5d62dfaa88af1495664bce4a5ba6c1b6471c85b1fffc818f326369154e4c0dd627b","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"fe727b3ec2446f3e9140a7a09442f679"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
