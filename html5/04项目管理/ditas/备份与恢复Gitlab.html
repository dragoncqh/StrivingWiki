<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="zh-cn"><head><meta charset="UTF-8"><meta name="copyright" content="(C) 版权 2024"><meta name="generator" content="DITA-OT"><meta name="description" content=""><title>备份与恢复Gitlab</title><link rel="stylesheet" type="text/css" href="../../commonltr.css">
<link rel="stylesheet" type="text/css" href="../../common-extended.css"></head><body id="备份与恢复Gitlab-2E953107"><main role="main"><article role="article" aria-labelledby="ariaid-title1">
<h1 class="title topictitle1" id="ariaid-title1">备份与恢复Gitlab</h1>


<div class="body taskbody"><p class="shortdesc"></p>
<section class="section prereq"></section>
<section class="section context"> 1.Gitlab 创建备份  [plain] view plain copy 在CODE上查看代码片派生到我的代码片
     gitlab-rake gitlab:backup:create           执行上面的命令进行备份，备份过程如下图。
         执行完备份命令后会在/var/opt/gitlab/backups目录下生成备份后的文件，如1419413225_gitlab_backup.tar。1419413225是一个时间戳，从1970年1月1日0时到当前时间的秒数。这个压缩包包含Gitlab所有数据。
  Gitlab 修改备份文件默认目录         你也可以通过修改/etc/gitlab/gitlab.rb来修改默认存放备份文件的目录：
 [plain] view plain copy 在CODE上查看代码片派生到我的代码片      gitlab_rails['backup_path']
= '/home/backup'        /home/backup修改为你想存放备份的目录即可, 修改完成之后使用gitlab-ctl
reconfigure命令重载配置文件即可。    2.Gitlab数据恢复           将备份文件拷贝到/var/opt/gitlab/backups下。如果backups目录下有多个备份文件，需要指定备份文件，如下所示。(备份和恢复的gitlab版本尽量保持一致)。
 [plain] view plain copy 在CODE上查看代码片派生到我的代码片      gitlab-rake gitlab:backup:restore
BACKUP=1419413225 #从1419413225备份的文件恢复       gitlab-rake gitlab:backup:restore
                  #backups目录下只有一个备份文件时使用           /var/opt/gitlab/backups/1493817565_gitlab_backup.tar
 /opt/gitlab/embedded/service/gitlab-rails/public  http://git.eduhe.com/1493817565_gitlab_backup.tar</section>
<section><div class="ol steps"><div class="li step p"><span class="ph cmd"></span><br></div></div></section>
<section class="section result"> /var/opt/gitlab/backups/1493817565_gitlab_backup.tar<p class="p">网站根目录：/opt/gitlab/embedded/service/gitlab-rails/public</p>   http://git.eduhe.com/1493817565_gitlab_backup.tar</section>
<section class="example"></section>
<section class="section postreq"></section>
</div>
<nav role="navigation" class="related-links"><div class="familylinks"><div class="parentlink"><strong>父主题：</strong> <a class="link" href="Git.html">Git</a></div></div></nav></article></main></body></html>