<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"cf4df5d763ce48806c6677f7aa546f85bae37d41f2833c517381900d4c62a4d9ad7ff790f4fd4b48eb00445d044ae9e64c861c2b1f0dc5864afb0fd2bbe3f1ada413b1d5b9aab8870a59d5e0ab840393cd74bdee00cc3cf3050afb42881be4d1c2c74acb37ecd37c2bda7a0a1d558701498dbee1e2772336acbd906184b6bc4648658fc3cf8545a62574d9cd57481207bdb4576f36fc07df117070821e5bc00abb978b218ea5b79873cd07052f8823934c5ece4fcff3feafc717b13c90bddd83cd553dafe50ba5f42029f118f16b44bc5a68bbff96cf01425757d3f1d1de850a878f2afb2ee5dce95b02dba7e252fd59a187ddde6c26780c4bc4586633759dc80dbff9af594f1c935806c4bd852619f012f7fa53bed70431b24c2bc3583d387d49a2ec3dc73009ccbc526c7716e679a6f3fa981f5ef9be1feb567bafca9976e7d4453643a0357b75b502efc9abe95c8e420ebc66dd373821f02ff78dc1bdf6cf01a59739a9d532ff53e6b0949212427c2d061cd50858bf701ef26cdc94801eb792e222ef2d05d555f6e491fddfcf43f73284927d613302915d09c0267e20d520df581fcd7edc544a7b39aa3c08bb7e9886d74f873aef80698d02d400da03b427ebc01ad2cd47de8a59c5056f51420e6ecc261d1d5ef1b30a99af0285ae9770ada9b2ff88d5f2bed0f876032999531c89c0f19bfe004d8f247cb00c45df73d6e6a404943007f9de072521affeee9636cf113519d7250fd86eac86b472143b6ab47b5bd59b39477a53ff86fee2bd7335ed353cb6e55ede563587a31bd28d7aae818745bed2506b2120394571e80b230f368cdee5fc31460e0a3866fafba9da59b9eba1aac0003b0a33e38b9d1d41bbbe050d37249ee43ceefe43c3f3db006e424884c0d3cf8ae5a5c4d4f1faa0ea0500e5f28d3f069a4f5b31dea1498999334b4e6c9399cd651070b2bbcbf6189dd6012660ce5d3c3f3ae9258faba5c5ecfa7e87c67ab870d98eac5c3fde5bef70a1a3617997ad6559364ff3ccabcec3bd499720b193eb0df74728806ec2eb095f3ed292adc519804d701740d48066b99628cc7e218a884a957242267dff51ac6d71ccc80a013fbf74dcf6af63c3625230e3e13c814d22b9bb257318796ac86abbe30c51616ada49c78a1f289df315dc41c3506f762cceb57efa67a8bc0ebfa134d0b397fc5583b845c0bd44fb891054663b9ce3133f45835c4750a9603f43d60981cd6f7bb94e541c0c8f688f2e12adbb0d52305c5cabf61dabce5b78b5f804e6d96ed2518b9eaef3582731da7a77b9c8bc2c920f90041aaf1e91bfcf7fb4ee2ebbfcd9e2988f667f6a52f56c01f4f2c440b04253db4d8ba62f7a5aa5bad93cd6931aac6bc70d08cc5f0050cf46f3a9bb0d50e0542504ac3ba82e8d5913c2843ed365270793fe56e020b65be39d0f4544911815fbd17fd7a046d5cbc3101f5714078b8a15c21d501e2059141cd9d87579b1608619edda9bcb14b6305fb84455207c8fa52d3b6a618a0ce8537475968898d286fafd5236d10ec12d76cf6aaeb728a1044693a7970c3b45aab588ccdb605865ea054b13090666996f5f471746e49abc55ae0162a9083e06467f5ca0ba7ed55d09d1ba48bbca40b926892ebfd900f5e7912b98cc1b6238f640fa4a3955ca5d1c8f8f0a1f487072fbe9cf0c28440cff8b4ba1020140ea998b028533b3b0365a7558371f25cc5c826d2e7e73eccd3f0a44377584c9a94ad06f5753033491293164a5976d16a35315ff0a7f7bb149cf152348f4b31b5f2513ace0b961c432aa66c365d5e4a1262176513d033015e6c514d276ac877a523eef04380dfab83e28fcdc0a231c8132b2ec9d22f44b3f5ffa6f8a4671ae13d293c7b0f100e9c7be0cad38c252e547a763054d3bf8f40f0ce4c69769e387aaecfd5309e042003ced4cfc8f99322a00abcd4da59aea9f25744bc451ce843b617cdd5f933bd8587ac1afecc66b2050b29149caf63701590de62c509d2f1eb03f7f9f0c6f34f404cb9144d619bfb9ca14073b793604568d54275578bfc2b48c31e455d35805d60ccb72172f7467f18e8eb2e82dd960e853ef6e4383c5b4636b250081f0d01ae9439558e5040448ce627877a2420faf3bdc7891df068f467585a656d3c52dcd05a6011ebf0aec5e2502bca94c57b32ceb08637a74c868fb45a441dc1c0e3f51185d3fee7ef5cf1872fefc2488df2c3762b3e5969d79eb1afd64c7ce04de235f96b8ace396fd93a630dc2d3307d236e0a9c4d1460930bc05b834b7e382481affd74815b9edf36f4835fc08ff3e5668fd461e7d1f9b60204c750f8e2b2ba4569a960e1da3d1bb0bbfb2f755fda0375962186f720a4d05ad942e1d46dc1e952c740be5191b5b5319bef3ae9a35e6dc11651a329bb12eed2f55334723a3feaab4f3ce0997d1099299b730e4338725690d7af7475e1e3f3f7b70d6ece2835dbd4e0a266840fc7953908f24f43c3c184956814a4be3a9f2e296e590e4cadb373d95190ba3304106ea133c072804eacfea8646e0d74664cc751771897244af4797cb6eeb693ca1beecd0396123d48fca1d277431b4621c77eeb9e60d9032db432cd1425f7d243d9de6647f2aa35d7460beaaced3fd8d2a7eec53106bd90ce8a0f7c16fd012d8fae2030bf8c7c73be239796ab33b16bab0e4950268e09cc649e14f7cf7e26c874563f1daa023ed73849cdb4067ce1c6781d7550af041f0e70b0edd00bd8ad8c39daeaf3bcb6d77a65f2a422d50a3cf014c22ebc9f2e314e52bc75520676e10c1139b004ffb0ba832015a7132a5391a64f7ccc9fe206f255e8d1bd6de77b7a7b6a011144ed4597bf85c01f542ea27f6a204e8a6620943ca053142b8471da930e357256ae1a2985bdfc3b474311ea1490096292d74bc60374a39c2f293943e78dcdfda4f8e73203827cf0459347f17d00d1743093c16392512c222837948aadb42d945fc85807ac5f70cba4b4a42daf4278f3518fd5bd35716d2a89177e8e7d77205398771a0a492b582b03563678ebcda1b81105651bb470704256a8f107244ee0e5155d90eb3cefdace636b4a6e83b012f0003bbb08e03d369dba9383c730d4131b14141af5d632b2ccd351d46a72449fede35fa101772f1b6356861cad8f5d6fbee4de818a259a7adcdc65b3f90c2aa3efed0f75999dca6e703995c81ddcf51b6436eb9a9ab011b44380710d5cb31951101a1360eb0d430cbb3aef32354f30f75d3eb106904221506a2e9b8119a735d5fbfc5b98e82f6cbeba9cee28c71dfa9ae9ebc2b3d0f15197a371403f602f3169940c11f651c9d1973293066b8ae44c9414c59e765b87f1b71679fba007479b60f14a12f75c18f5b66859f01f7d4847e9afe6aa34f0a968f058e5299f926b5c88973d55481ddd278e18088c9b0ed2c0dc1f1fee2b99308ebc1b6a584341f9d2127b1d49f288408fd8158145316d443cb14a731f165692ab60841dc76c41054280c927b0848c238b73a967ef24541c775fabe599d01a2b02a35b72d5d06151a1590f62381bcde1846c930de1ce54c6cc6cbd616145b36df56924bfa5dace4b36ce5432e964214177f7d900d78a1ce288a4c29ac86510963eb28f46460af33d140b3bb177732954f60a3511436b031308122b06eab65831507e694ea8e769e8646d441b228d2e1c120f8b0ac6b6e5af360cba4d3b94fb06973767f7c2460f79463c3e329394f21dee0280610819d2f668831dd8371e71d09ab66574fa4af232d374a9259e9df552e9b19830c252fc3f42207760070801cbcac8070280abae0df74700b1928b315e531bdca89c3fd3e36850ffb1d5af5aba2a7f86375facc9c041079e65c0bbfe84370430d30287cf648ff1f911f0b440c015fb827a421d2f2f0c3f209c06e078adfa0947cb22e9c835a0764b428be8dca5faee44944edc416309bfb556fea2d2a4e91b05d1ae7f8f77ba6c911c26f463fa2f12d9b7e773cf7ae7b94163cda6ff419d6a3e7db35ba126f3ab99423e29855f696ba8e9c201efe9cf12c9bb11c127685a6fd5017022312c36196c4e1f8af6db991a103f664b676ce52ce2c92f422b799fe013371a80f7fd9f8f8eda4856c55058d52a9d27e849a956aa93c4b34e8112a5247bf9bc29fd793117e87d6e996083d36e0a54b312873076721100d0287070ba976537c296276135a64fd8944d7e502d49feeaa4be7eeec5e745bb08d993555a5449935a938681ac8ceaa62705552fd8623d40146f2b539b070edae4ce07c54df1c3a5b7d67bea1bf35db6e71216a8f0119ec4c8f768f7592835b5861f306b910f2121077ba10f1e0ea6cb56a314f6023ff668c587f05b735200bb5f1f966225a566ba6cacfdd50816b91011106dec62ef743ce37a1f4c13911a8872e70bce6872341f5eb2a2e232e16f6612bbc7018abf8eb65b09c9a6bbb8645e5a9ed67cb03a98f1dbdc66ccabd443bc4469b1a6a84162e60798c697527d03269ab9d82721f2a6f3595c2aa67eb58d56bbc8fc35b67a18b3c3c74d85ecb154afa917293739b15ecd856c67282fe30d90a2d2ba27c70de23392e028ed0045f693181e24c9ff807e2519d3db3bcefa70039ca415eced5797b9e29bfeb34ceacfa83ae45487360e80f00c0a7359abcee1cc9ee63516f8935853a1001abf488da1373e58b72c19ab7797c37e23df5365e72751c2686fdca6c158ae5d248fd179ad50035c8110d71225064f08ed7b0c81f035aefcfcbfabcd194961484aab8109b368bb65ab0a3c006a393b16bb714af411e12a5fb22266847fc441654b8677832ba5edccd526c476133a49223ff950775651f1141c5dc7c9b7bd3040bfda15e1ec7a1c5c9ff5f396f38d51d9a9aa45f7ac8ed36071e4c8ada0f6925ee922cae307cce0f9078368cb4dfa25409db1e1a6bacaead5b1cef78a48b3a84f8b909b2d2ac65524646f6d4288407c2a71ea08af2d1458a56547f786ae8d12f059d8eb25b4417b27d2308f778fa6dca55f5495793a34c0c2c1cb830b16086424590f49dcad78e71b4bcefd049f6b3d840153eb52e7394e291ce95205f27d994a139c1f6ae9a86fda4e6b84b0b176437b04c5933fbad4817068462449c66441315d6a8309af38786c9109cfeca3804aaf66effdd0fa6ea5426f895f6c4a84a75b98f7c73742e892666541eb1dccd2000066238dbd8595a221c00ce4c721b00824911205a7ec092112f2650e5843a039f3a57985280ce0c2db1f600a433e16597da3a2115ec6a238bf19c009d1f85e8d31ea0df1d2e1d0c1ead889d50562cbbadb198bf6ac62a25489e4ac7f1a6b09aa06ce6c2be7597042d750ca5599d0f05b90076b247cd886ccfdd24c25b233c88aa3b19d45c210bd79d452074d544516df740ce3e849518e32a7cd9a685b1e408b481654712a580fd9ec3ce4a9bfe8eb418ff5064637b2c35ca177ec2047ffd7cd547e3a1a21400dec92d5326f08e6a62412a9446861a85e717fb0b84c3e5943f1b0dd69e211d9f70673f355da066dcd561f7aa212376719b8fe98d6e649127927fdccfab1a11416e2b33daed051e0b626eee65e83e36ce7ccd5d6d21f945daa3b57777a1d402d13cc77a719219fcb91c6e2a01eb48593ef6e92c857223f4e8eec7ea2e7137163a66f2d8e94bfef4add10cadf8aba0610a7292852f1ea39c11ebe808a17edda4d08d051591b3b64be1a4988c8e85f160fb0db8fe2e86310833b07cea2699a2151b68686c92c85702d4372c0ce742f357cb200ed16eef701870242cee37cd37e0231128f3f0a879edc67726b903cde0920a6ea67bfc80c01f60873718474e45182bafc990f8c7faed2d1c7d1da5e23aef4c4afc4f4e15bd626877f6a307180ed557037b3866a33488ce9c627481adb9bf342c0c298dd1990f89d8cd62b15ed6c4aef93eaf1b92f5e4b51e184dd391c30fc4a29462a24fb457f1eaec72331d8587ae771a349c85ec3f1593a799dcc4e63afdc021fe015849ccd802adb1e6d0c71032dd2ad021c3b5f372b77439cc2c73992e96b30745a23cbd0bf361904389753508c828e70fb50294abea628d143210fc369c9930a3e799559bcd3970c0f423ce95f1496d25651785f976cf95362fa560fbba5720648d889517d13738714a12281b2e4e4370e8c247b2726eecc43d9f1ad76e4925c0f7c4935226b64c443c0dec1dbd35874289ebaaea69b5a7134ff0bd8e92e0e45eb3bf28a86296a8e92177150c7059095d46109eb8611033923ab72352fc4ea274c3b35def7b1db5fe5966bd40fee3598c091b147affdabba97bcc8742b1d0cdf22873baedc8e246029430f8f7e108acece06276be03312792da54f04cd84c0d4044dbc15fe4cced3474ab3e95d5c240729a40db722c1942607a54a82c1ddd9a2a582bb6049c7daa5268e2ca5159995c54e7c5733b19f605102c9349f675e835922347810b69fc4f3c43eaeccda9017accec43e434ba74b10bc2bf1f58a4b580287271e65ed1d742072abaff6627d7459a72492e1bf1f6ec9bc8be587288e6d31efc49a5d71638f27ad574f68badbdb6079e16391a62bab354675636d95990f5013f57ce5aa4c7e4dceab1c54c7addc7e423f8df0ddcf5af212925014930e9587b63fbb37805e77c3287cd9231fc317b4ac03dc1e7de9433af370ab2ee0db2e76f1cc5eeda9f181a9873779f4272eef7dda27f09e8d425230c9dbe741da4aa657f947d018fb9752d9ca19eb8b3ca96a9afd0adf023688a67e7c5f1e47fc6db87cba493511837228023e30ef33a05c7d351abe61e15f02e09114c28b4037c57a6187364c32f9648205acb4d7aa8bf0dbe56a43228dcb7ee6b5cf92d6293792756fb3b94e2ce799aa9855a16bc35a75c0105e0b34bc230c1997172962c062b749a64462053da2f2905bf729f3c943022b2a43123e74d6d0a6ac3aeb0467c421c8265bd201531b1d6ed417124f5daaa003203f3faa2248c8af094409d07191094de52d179281d802685dfc870cb9e778ef6fb4be00c53ede28aa4c1ea322c93ca487b4d6d5932b65487ed0c794dfcd062f09be4d0b844c7cde6565879b5695e1ab46f27813e6702416b04eb00b97e864d79dda3055496a5a471b19c5d2830fbfd81c23283eb65ff3d091baff85cbc39cf084d955f5a58efb790f063651039945b39f9639e9ec7b566db64f0adbd83a3ceae2a165a7da2fc48d2f8316773aad1b9e60b4c96c41d5fd1e38f1b7c87b052c8fffa3d892ff54a9bb1d4bf09250610d5d6e05fb8ea78a91735b3f1f13669f16a172b7336e4701917b9a02dcdfb98970f07b8b07699bea9028e86fe790611a02fd496efb5db3bb266304ffed4a73d07cb946ad69a1f5e526306fd15664a50c75b61705d4d86d57a23ce6c36bc2eefdc61094676174ab7e8d82332cccf5a0c5086341bb330ac2f5492266d16764d0ca87c6d5d8c6b391f9ab0b97cc9041ec46ab4a2804dd38f4e41bcb4d3ef9ca67864bb1fb6fe90f968a8687f35cacfaf457f8258622d6f621950ef3681f1fbc3cfd346213f5ce4ba38b6a47b1d11ffa553887e7c61904c0f310471b2af50466cb7796cd05e9a1fa236a9ea5bb46fe537c1f265e634605b106771ab2096a09045209df06d554764af79f592b810589343e01252591a541ccfefc8de8b6a04774c83481d1e77b5620930519e261563c2126442e1ef8d6784e6f5a95419c08916580ae1e17400b6fbc361ae9f28b522287a5f7acb73d69adaedeebddd6b31aec1ff2dcff60554790b4bfb7780fd2f91dd57df4bf25df859302e523aaf408890e87df66cb594bc0d7ec9e5ba58dad1b457b812f4936ddd3248f52973e27ca1eb121b25d34e4eaace4cc83abad64f837c8696c6de756c8e735ac04d5620d8d353c810f200f9815392ffcf96f2250dc2946f489fce9e0728b1096324dcc1a5baeb3632764689eb70fb1330e8726ba6ebb9f0985b4fa00969d97d5b54c753cdeab44a2e57f2370630c2ca0763edc105aa6c48b12beb8bb73704900ab976b8bd69b5c7099bea4b92a49101012d5e57bf098f7603f928cb7ea52cdc674a61f948a7da6eb4a624c1db1d2bd6009c0b832be7a85ea9824dce78797998d84ed20d8cd3dd6b87736003a0631e7942adbd10fc060a4ace232224d18686caf427a04ab78137514ca78a3dcc2e0e91944899b2aea93b4f9bb5b3eb6767103f4c301b5a90ab5aae85d9e784da76751749633e1962e33f3382caf9fa969ece41538e92f73eaecd8102fd416cd33f6e74660c53036ab9e9331de2107b25b80ea231626c3b2beab1c73491d8dd124b830ce90aa8cd14c59d3ee5cadddf28b6d37474e7bd68476a8ab6e603f29082e2564a7fcec11f78df00e40e7127ad1f64022d9150a9edc2aa4f472654aacd41c82cafa16fa5539942e99e6eefa0eee79b40671b729ac7547695dce7dbf9493e6460a9f1706ccdd5c9b0da096476d4d92369ca1f14bbfb39de83d98003b205a49ae4a1972dd5d1ee6dea410b24756a66d0495dd613add4d59ce2bbff4b5f4ebc6677c27d90e2fb0565e6dccad0b50a985f9dd1d821a01206276cf545519380c6dcbedbf00d2d952c766f8aec1afae575d78e0733ad94a150fce55abc0b5ac0806a1e8f64dc1b307f4e286409a87ec0b617e4724dbe60d740999aa143d04530469da996f0bd1e605dec330b804f5da4b5c4ae90b8876549912742ac7fcebb0c1a599e8f422a264b1e27df0443942fbe5078b8893bcf635146b5e3d16116cb6e80e4ead60a3eaba504db46f28a9d8091e9109fb8aedff5dfc8e01d1e4227ab2651f0c9bbd10c5be53e0ba0221982b947bcab0b72ca98ca512be721e64d01a4f2a33e671a75b864037440c8de0b7d8cf032072d07c993421ce73390f4508bfb3b8e4410ea0c133bc714e7d99212a45c4c57a8c7f340297ee9dd8e92e6bc74315de96854d3fd3604614807e054c350e4262d0a54d99ac0f8d15a6138cc8bf6fcd707f3217a37ef11357fbbcb47872507943e99473418e68f5f2592c8813757faf74df52f9a3dc5802513fc991980c208d502a6e4f8634e42a7d3f5a15be41133110ea7e42a94154c79e00e409202953ecaa6cb116d3d44ae8caabc2df626af29c006af1cad6fe910c68d94591ca1e70cd551c9348156118b63be871e912c5c484ab4a8e1f80cd5aeb3db6452f7016e77fcb8deb34ebbdbd5092fd1a15483dc65a2e4eb43295a135ff35a7e30e1036ee7c6b42995ffa3f790a93b3c50a386aa9c759eb1d24f82e44990ec85beb51b13e07e4facd23065a65021d439840f300d979cb15aefda20c55b1978928af30009f1c89d9b6529e37bcec324028e0869a7db9d40a35bca16d74e3bc55544ab4daaed0b78b8204efd8f08b86a20d224ea5ffa23e56ad8a065dcd8bfd13601b78a915ae04b055e1421685e532f64a5edbf3d9c18ea367e57d600af197a813e222766e2d4de8312543d0fac24f93cb84dee9b9fa2dab9b21a713f54eea4a84b43dcf7cccfaaefdeafa10f062cf191347be4f0548064ac2c0e83fb1ab5369abb5f173e0f046953b64a93559900c2591c1e070e35dbb4c28de0df6113f1a92502feb0645d11501ab480107d3b3474d0e1cf65ad6ba3b48cf8de04548f8b2e651c44ec205760eaa7008b3f88a758a614397a43dbf46b6888a21d5f51a11420531e5aeef31b6258d4be22a56ec57f6ff34be824d853978c7cbd7a5af9b1f1328be6111f3220c579ac885ad8f326fc304c36ade91d8a2591726b95140ba109470bb2341ca7cb03331a5965cbb7210bfb89f3c0a303b061cc4fc1fa8d0994772b554579964f7d3a16718871eb4298658afb999eda7d41a89c05934cad57bbc001bab60b1e962703522e8bccbaf4b80f2ebbc33ec79c4ad1205cb9833af0764a8a31db3d6cb2b95873d2ff2cae4f5f9a7a73f4ad66160a86f21a61885d9c56f518b2d7825d300d05b16c63c4023bdb5078e8160e295fbee1893e31ae22e468d72851aa68185b2beeec6eb7ea12f599c85cbbfc7e5fc30f5da6b5c38e4d2e42bb934ca5ca17bcdc22fb7f4897611310c325e48a04c4856191e8012cb19b9bfb6f5f990c3658b880cd766a7c6d3ab31a58c13b4386e0170aaae61066f8120958cef9e1ab3e426470a59d3d4d7ceadbd11a17509a39c68c34c6a94cb3e37487f9eeab67ec7e5468e339683aff56e26a6bd218785fe31b1c8709cb8460f8ce31337c5eac95e5a2187a83cc1b3af50e6e3d5414c6378b6bfaccb4b07baacdc5e8a861ab2f280c2a322ec8eb2798e094d7d1e13e4297ea9a5eb28fcd5bca74dfe62b88cd9e6607b218acf56a70171bae7483bca38e923b169b5b2b9b248816e72457699cf43fbcb820fc09a3b9f6fc2360589dce64b155d5b6cc024f9ef63ee6b9832bfdcfdd3f356e930c8401a8b19cabca03b7ca39114dd7d955b9b8bd806f858d3b402669433730710d9792e30f8b88c205fdd45efb8bd5998eecde471fb1e8d76bbcdf7b6c666cf02d25990dc0aa2052346a91d8dfec66a3c63fbd5b74016d4d501d33e0be155ec840f51420b8c7ea761056a14b88eb25197ea8122084b649d48c94bae485dd27f10bb9961af4ff0761f91222b9b9d11c09c9d671b9a7ba57b39ef13f4188d6405e7338634fc6927f587916635ad48333d6a3d452e39df4d324c12c87ef73791e2646fc343d9cd57dba8cab08544891fd90d7376946978b9ec6e69c4e6c857d40292ed84edf49c5acc06f7b84002c5ed3a6eac1bbf56806ba09acff192ead41147be8ba6a5c253e0b1d21a5cae406f2528e1c174a74003ae6a0bd0cddb1f1840a7d151d2db2bfc0cf72086d881966ac3acc4e1b4c9186a1e5582db239b44e851860f62005c3f79a225d95ec5ef7b299bcdc41e9265c8cae3823eb1d23fd9e819626bda7dbe8ed7b033dc35e0a435697b2a21005bd0d7de8d16e57d7b6caaaa77c79e35fb7fe6c5df04b448ec6e7b0380af4e5e87b9ab47258ddab472655d6f53a304db7af1338c394b09dade16dc037b790690126f5428e4845031d2096d9c9dd11de38f944665b6f15765dd37bebf7769ce826c5ff3369016ecda12579b1aede891a4390cf608f4faa1ed8ce6c4fcaf2da524143384f43ba14e56536f562583f32800dd0c0a99db73ac8ccc9bab52e5824f8f4af94e73575d38ef2ca1fb18a6ef30348fd60224c461138e3cfd3ba1bc9ac4e655a5e943aea1056fba2dfe7e8794fbf29f5d119675bc3cde1deb417b91348e733ac4706978a02878c9c87a48dfda6f5a7e3615364df1e2b6c8aa673a518eb2bb4534086c9083e152a8380e45f3f95261474a71e594ed05215728f77732bbdb7a64561a98fe9aa50b30689fa84910c36a0b96be8cca44c6835a62568ad8aa952ccc9d702cd349e02d390bbf9c3e9aab5ff9b94398b057bfcc3f64e44f0d09aad237c687bfd4492d8b5f552547eb7bb7b6b0b99cb64ab6469ec7dcaa757562dae1b9e52c4d08699990607630cbf4720db4ecd7447de7ac132205dcf01c8b4fae003ad57bb9ac18157fb32a38b3225d6b25d2e220988d7f7bf1965192d1e569e8adc486bc175a41c82e2652cf72d5b352b41cb0f5966cc946af92361bbb5de7fe082102a34ca70f00464d73b16b2211d05d6b6d6787d415f3537a2de39b333f4a5ce4908cad6dd9b87dde36ed22c45a452ee6f795701f746dc536fe1c6a83f326d200cdd0e5f061df3a45a8d6ed6afe8df7e3ad63fc531ef895e750679e60197865b1bb5827da1cc74843ea3e79708398e48081d374060e2a61af85697d3b20bb7cd4c43d21311d471fdbdb59012acbd66214fa52b8e325823a11fcd0a10798ecc13126f7172ed717daee9a8a099ecfc693fa279b1a52ecf4cf4439019af47539998e714aa33da81b38cd716e58e2f05486d743dd56d170bd45c80bd74db3e8342f4fd821ce91eb76714d407f8f9ef3e25efad55fcacacafc957da9d0ef416a4a0b4258d9380986083e3d9e9a1577dd0e0129edf8ac52a5a99944f51e471fe72c72731b30d3107bc9e867667d2621d3832df38c160415eeb57efa13dc7c1615e4b7d63948b09d5ed715bdf793903b780e0e59796381b1f2a2333b0809f72f4059af72da3d72f694b5085ee762b43e7228bfed0dde5bda354a86a4b0e46068b2fd724b975103a6ab5b111aca6dcc0340ef6f11eb5506adeb0163f989eb3c84e81a32930aa96feeb00c894b423d9f7ce2c90044d5ba779d890e5b53e07df377376af76d118a963d5e4ddd4fd83171c676af8e2b63c75e7136899cbf5a27c4a72b1806e43b16dde6fcf89945779c2318a51277c854e8cafcac75d3047df85fd890505e82c84431f01312ed2692ab032f7b49e8d1f22ab48b3687ac3eb92ff62820e72d975966a3da89a8d7cae64dac94838227ce9b0eee82c3bd9d930a3375bbbf401a278012a5cca8a91623db7b9a599fdf6747d7a1f28c14cb56338bc1fa1aa7d751e2c8e6dfdedab85790371fe4f085b4e20b33bb1531c5d89434e0d3644fc8a7dd3611d7831c7d5741f6dc49560c4038ef151230b9fbe71faf07a1fb1b5437673042bf51146742fbec313f9aefe066d9846aba3b5910b59ebab271686338dc7eafa3ff139df7706f32605aba0030ec97326fd9a3439b48bb5e4fde0d35e34670c734a5d47bcc4e666d0606a1d6b41388c39c93f9ddbc8fec5db4af488b6101e974839ee3f41f0c0e24c00f6db6ab51ddc54e6f869e6d14d711812cf65dd8a732bd612e9e9afcd45a8729f1a36eea48c33ef4ff5bb09ec60367ccf4ed93c0d28fd1557b6fc0cac36f471ba59ab7b8b571631a29056e300671938c0f3fa99339cdccce6e2fb4ea2e8c986c68de2b1a4e2fc83b73d6446523e53caa7094a1aa13e8320b6a695ec241952cdf3e97d266226ea0b377768435c1eb6aa74c6a8b2ecfc0905b7d2da41211044f0729f1be531d83f9f9f64d874bc9f34feb9b04899005b6e2ce9a6cbd5b749640a8ac594fed969bb1de5e9506749f09bd576f8f5b37ac979d5a73724691850388345fe5f7608182cdcc6602379a093c7255c5eeeb2fe9ff66fa99548e11b0d6790773b6e0e4afa526c4a6f438f480975951d8ceb617437179db1d4436b96b9eda0d3734ad81d2bd3e5f53e728dce12c4fa4a998c241f6c9d1692ff469f3f70982292666e4ecf22c6da909c851127e5bba043d50d0e128ad012cc451ecaa952e86bea3153ecc931bc4272eed742c0d6c67931eea79754ae7467e7dc9c5d6b30e9e25992dfa8de41b20d620ef5a04b72d5c8630a3236aef56e8a6906ed55ed9a3f9f03969631294b27c161607a60038ee73d8a621e41c9ce8462113bf89afb0e54b7036bfee66e288031ac5c61a5d7b87588be196d9fb3fb0badc81212044e53adfd3e1d79482ffc38415974756c66aa230b2f67d9d40d93eeb530058f9163a64623fa2cb5b2e31187d2547254d812693043977af655c3b430ef99ce2e7054f99527f02d5bd77dfe1bd016ce0ea3ab2133e48b3f3bedb391d82b99b7357400d22d6ac13e0b38754aba3dbac8cb9b82e0870b880ea9d7e934f5e4d584a62d1c79fdfb07d84b1a70cbab1c789b084c80c43999ee856b198b1e0817ef4b0748ee57f7a23f96efd4dceca3254967ac638e6dfe1a86b183cf79a4f88dc4bfb1e36482191ebfcbb021b77a82002e025b43e5150220ea003e396204394335b8b9f284ba70d7fe1ae064a6c6a6280e49afc76bc0fdbf20013f38132339a4f014d3d8deac019b0224f656163d95d0192d759049c94ab529c226e8e4f3a749e0d82452f96a5aada73f581ccbf6bb7dc7322f6d87c1b5abae7510c1e580d7cf53080d34c234510b8b69d33ac6252ddb145ddffc5223417bbd5cd77bb41133d50ec1da5adf66c3889f57e37cf7e53147b4fe9f72997aafb50045dd84e1af2b06796873d3341d51177aa10c5c3263b943f0342758a3dc524634f1e5857eb3cbf9e4b966f82b1320a8c4ffbd60600527bb58d176014a79c1c0010e5066320bfc208426d37a07e964998cdb9410f65112a57611720f38336954fcdc99a5135ee84ca1b9f34a773546af6762798aaf968b5a7cd9ac9988a7ff7df77ac5032922a88c361580d2ffdce9623db7ac023599112050347a3bafb85bcb70556229e4b062d7b36a51f9095296689e9327082a8baed174350bde5b6c6d4219375ee28ff27e17193c7b6d1f677ccd0d31e9be1f5afc75a865165a182234070674416351effc38921bdd0af23af8622a0e997d45a96cf3f35da0bb5b5ab0dcfce2221af820c52fabfe5c6367894867282c1cf00dfa9c7b4aea1f243a1c0f2fe246b227af1cca3a12866f1255a956fa7cb0f0f012a18fc489979bdb399007cea7156f5d89b6661de25e4293fb4dff8789f3d76c7453d70273e9d23e48e5ba2f217321e779fac0a8d9a614cdea7e87c4097b28b82a8413e5cd26afee391ccf28233dc77f712f9df5586e4c0244069490df74591cc3f4142c67b2f91f676b2a7a7fba92a3da04b46891f1234149ec4db8f9e2545381070ca37f9987dc60cd3459ff537e3b230d78a49f9a04ff1254c36a472d2957259fb23548a956f47bd23fa005abbddb73763546076f58e79a63aa9c0202120a2d6243b6c5c4db521df6f543413bee02a93487ec8695eb11677e52083f24fc1c537a2a17a340da0660d1c88c9d4c469ca7588721af0eacc445bbbebab0afd99c75eb6ae212ab7add823398d0ac8421850fa4a9df9da630316ae3baa7ffef28c209f29cb6933f74af8b2dc136f77bcd2dadd576d98407560f3d594f003afd4a4781dfaa45e412846db78997adc776d0d6060d79f1f36a31d73399c17c83a1b605e0cea1a145dd25edf8c565e58f11d79d8ba6dfd71ad494f32ec530ff14cf44f62a17f0d7de171087aeac1e7e56025c57d5587ff5b29c95fdb310876f842762467c05f019ea2272a8aeae565af16719a272aa62f9236ebc99ece6203e5058dbbf9a3f5a78d123c0dc700eb154ee92d86ec2ecb1b9b02e4b259b16099afd0a3d27f0c40239616c148f41812687b6186e87f3405f8c72e16e38a31f1c51b6225fac49c1388ab30705fef46442e86a5882bc8da1841921cc0c1d08217e63a09f135bb7bbb63647eb65ae7f92eeeba7fe19ebd5a9f92998fd80b4a9cffcd3e5c56a4f235b0397fe67f6b3c7f3c6a47669e50cdbe6a3cb8e629848d6192880427f0bf6c54116cb9229a733e48cdb2413b2dec9e38594054c","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"a04e2aebb4f065114c065b7fbf49759e"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
