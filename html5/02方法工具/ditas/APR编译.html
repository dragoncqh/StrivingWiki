<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="zh-cn"><head><meta charset="UTF-8"><meta name="copyright" content="(C) 版权 2024"><meta name="generator" content="DITA-OT"><meta name="description" content=""><title>APR编译</title><link rel="stylesheet" type="text/css" href="../../commonltr.css">
<link rel="stylesheet" type="text/css" href="../../common-extended.css"></head><body id="APR编译-1F447281"><main role="main"><article role="article" aria-labelledby="ariaid-title1">
<h1 class="title topictitle1" id="ariaid-title1">APR编译</h1>


<div class="body conbody"><p class="shortdesc"></p>
<p class="p">在Windows上将编译Apache Portable Runtime (APR)为DLL</p>
<p class="p">在Windows上将编译Apache Portable Runtime (APR)为DLL，有需要的朋友可以参考下。</p>
<p class="p">因最近要用到ActiveMQ的C++客户端ActiveMQ-CPP，需要在Windows下先编译APR。编译前需要下载解压APR，准备好Visual
C++ 6.0。</p>
<p class="p">APR的源代码下载地址为http://apr.apache.org/，需要下载3个部分：APR、APR-util、APR-iconv的Win32源代码。一般下载最新版本即可。目前最新版本对应的文件名分别为apr-1.5.0-win32-src.zip、apr-iconv-1.2.1-win32-src-r2.zip、apr-util-1.5.3-win32-src.zip。将这3个文件下载到同一个目录下，例如D:\Work。</p>
<p class="p">下载后将这3个文件分别解压到各自的目录，然后将这3个子目录去掉目录名里的版本号。即改名后的3个子目录分别为：D:\Work\apr、D:\Work\apr-iconv、D:\Work\apr-util。这3个子目录名称必须是apr、apr-iconv、apr-util，不能为其它名称。</p>
<p class="p">在VC（推荐使用VC6，高版本的VC可能会碰到链接错误）里打开Workspace文件D:\Work\apr-util\aprutil.dsw
。在Win32 Release模式下编译libaprutil这个工程，libaprutil依赖的libapr、libapriconv这2个工程会被自动编译。lib开头的工程生成DLL，非lib开头的工程生成静态库。编译成功后，可以分别在3个工程的Release目录下找到DLL文件：libapr-1.dll、libapriconv-1.dll、libaprutil-1.dll，以及LIB文件：libapr-1.lib、libaprapp-1.lib、libapriconv-1.lib、libaprutil-1.lib、xml.lib。</p>
<p class="p">在编译过程中可能会碰到以下错误：</p>
<p class="p">错误1：找不到strings.h和inet.h</p>
<p class="p">错误信息：</p>
<p class="p">apr/include/apr_want.h(52): Could not find the file strings.h</p>
<p class="p">apr/include/apr_want.h(121): Could not find the file arpa/inet.h</p>
<p class="p">解决方法： 打开文件apr\include\apr_want.h，分别注释掉以下2行：</p>
<p class="p">#include &lt;strings.h&gt;</p>
<p class="p">#include &lt;arpa/inet.h&gt;</p>
<p class="p">错误2：不支持LDAP v2.0</p>
<p class="p">错误信息：./include\apr_ldap.h(136) : fatal error C1189: #error : Support
for LDAP v2.0</p>
<p class="p">toolkits has been removed from apr-util. Please use an LDAP v3.0
toolkit.</p>
<p class="p">解决方法： 打开apr-util/include/apr_ldap.h ，注释此行：#error Support for LDAP
v2.0 toolkits has</p>
<p class="p">been removed from apr-util. Please use an LDAP v3.0 toolkit.</p>
<p class="p">错误3：找不到文件apr.h</p>
<p class="p">错误信息：Could not find the file apr.h</p>
<p class="p">解决方法：apr.h是编译时从apr.hw自动生成的，再次编译时此错误会自动消失。</p>
<p class="p"></p>
<section class="section"></section>
<section class="section"><h2 class="title sectiontitle">log4cxx的编译及使用</h2></section>
</div>
<nav role="navigation" class="related-links"><div class="familylinks"><div class="parentlink"><strong>父主题：</strong> <a class="link" href="%E7%A8%8B%E5%BA%8F%E8%AF%AD%E8%A8%80.html">程序语言</a></div></div></nav></article></main></body></html>