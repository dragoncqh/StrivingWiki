<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"41517e57aac7d32f96a08af50e2597169a8f6a1f123af6bf990ba890da0f161e44aab5103eb7a642082f0e66bab21be285a8ca3b6395db7e688569bf84f0e9983d4f2c6889f66f3a7f62a137e88aa3d5fdf97f0ec11df415aa61ec09fb00c56ecbbe63e4e6419dc610139f702c3876360d0aa0f7539a4a41a539de7225b1a9ede77087bbf7489a1d600ba79247d0b68a02edbc4edeb9b572e7ae7d933f3d679ead3a17838209435f9c56636828c9c1ab51697677b0e4d642fdeb13840313d76bb6537eb1d8d97b7b2cb95c0ce95b4029e46df2751195587903d63683a1979540ee8083326005c3b3cd18d49843b8ef971f656bb1f372fd74bb4a6fd752ec5977d84b66e449274df7e794edd3a5e63218e8ff00befc131d23c0c7f796a8cfb1ae9dfd6d995cd7e66d8c93c643021e03e05dfb6f88169a257e77901d36ec3883d38ffd93e30e5df8767969dc5443584d399318ac0fcf024b81c0275232ad57b0b82004c6865b11dad41816dcc6100102f488bdfaeb566ddfcebe36c14c059b2fb32f7968218dde60a1ac5a43981b5f8c4e6f0e21324a7979bfcaa08c7b40c9920f121020daafbadf74196d4fa1afea9ea2e2642b07ac6abe6759c7dc6003cbd452664d8f38d045dc254336ea5c2af1a55c61d7c139415deeecacbf4928658ae8e82acc44502082c94ec5ddd8757dc14b9926d4b74e4fa28063a10b45cae28a4e4316ee36e1b7f2965ba1d47834bf1cf29495fbfb55d06cadbacf22ef29f7ef7631d5a79b2fc266d86bc1d11df699fdbfa46620ec65fb11881631086b2e6fb36a8ae377dbadf7dc833d761efe9e801e97aaac432b31e7e65935c172fb487fb12bc9933a91d41e051f18517d617acc0f1db9bcd40cb1547a5af2e9c3de67118a2cfd91da595a3362219774b351b0f359797ff336cbf6d70e879be2ce464398d732c78e9d9bbfeb86846063e5e6623fab931945f8ee2e589f50f40fea2bc47be5e8332d3e946c09bdbe5c4130ab926bf3af6e1071ebc5e668d224c8fb2a36f993dc18249d78cea0bf92dc614c6657cdc746d9770ae84d69d16a240b0b00f3918e52b34955b1c6f178019960d113dbf805e5d823d5054712bdee2e13ad9eca532c146b83f84ea911df1437b369714206cbd6eaa850545e95f358bcaf8db6e2deed5ca29eebf5bacbab5ad94b04466b668d6ed7f2c96e30e6a4101f80ba0620a103d27927d71da6785bb318a4dc975cd8d39d1f64a3b4efb582cb21a7242fb15bbc6587e62b4cd61f8efe0788baf5004a986874d8636d75c235ea07257d715a9229ac154b23b2cdb4e753cb02ecf02dfd8b607599d99d86f47047edc19ab6b3ea8a69653d0fe015e6d19aeaa65508c36fc3de581d114f36de659e87bba07bc3275021feeabfaa1bd17cafa26389f54800ce92995df4ef2348b16fa33e11d8b103cd057a2f27bccbfcd88fbc7323c3dbf63cccbe5ceb7cc5767339499cb8094bd9323c2e5ed02c7921ca27e79babfb4142f31a3b83d7974fc4f08f96825571ba568e14c74eb98e471d6e0eda4a47e9413122cd96f62501a4730a6687f5123f7affd5df36d4907939a02045f500394237b03db187207259b47fd491d04833d1f14183c85b247ed251df3f90f74d51751b6719124435e940844f5ca97feafc590bc239c63e899a2e2da26827cae8351485c87df1d0d082f97a5040e2a613b041c87d6e5320b76290a1d9680696d82603fffbb9c5910fd57ab8b8b8b91dcf5c3d0767aaf103eed5b9c7553748a677cd86cb2808652fe4477c11e3da04395a218d7b0840ce66d76e7fb9fe5b3a55a9a6998875afdf0a1ce435393ca15a03292d56d6a036ba92e14043007a8e0385fb54e02aa065480325343bd2b87d2936886706da03ffed188f246e1328d9deb20d54f2e3cf4ff8a1cbd50f1c4f7d6412a8e5e128bd7ecf21d4461521bb185d0ee1cc67bf90e234dbc9a8f43aa77bc08ae73ee070fa931ffdc165d6a20641a4b735c8eb5b22e01a7bea9dbb670407e769b021a78ade2120db17d83c28a3f9a582bae5100a1ff5b8b2b0cbf114fa04ede635e389121c20f055dc0d59f82c275bbad28d2626f4fa5eb99f7a7bd1a993f2426d519d07af1acd4344266a9f58511d396ccb1665f0b709bfea096bb72bdd9b9248377260176dce65aa7e4757a4006f45aa901c9a3999047cf80ca1f73ee4575e46fed7b50e4eb69dc963b3d763d3fc948b0366028bd8410d7c3fc0e2aed0423192af2220121eb5372198c8816d787621f68ceb5b4924857ca3d771d8a49f57489e9aaa73822d862cb51acb21b17936615c4172378cf10ea966b6c3c19b5cd8a0ba0b5136ed5d633c73f5f75f10513a0954748909e4e328b552faf5b303477b0bcd978b66f3a0e16a02e006c6d03eb7f31e9dd57fc1acf629e2c3203afebc77e3c9fdb74f4acb94c0a6ebd92984680b665e16595f675d8d42f0340923474c9320f8fdb0a51816faa5c897c4cadd583ce7d6147da9963c4a4adb4835f311fd39d7eec99c851796161fa231b884dabc3fb5c51d13cacc36fe887da3a87cdce0656fa9982609d6856a9ed26fe385b848c7f41dd3a07205a5c30c4fa38877c05cc8e3cf1c538b2cfaab74f53ea085997735400b037f9f7db1c09d684355c9ad1fe29daefb2eec486523bae495a0cbc99cc0180b3eea7290cedb109c0e39ff24df2e6671f49198bce11ea37ecc780154660ab2cbbd79918642f2d43c9ef36d58e8bcb3058b7ccb7610056ba217a45ba3b19ef6d3e87eb12c1e12cb9c882c88ac49737ca4526e48b31e8830d9508017ea6c08ddf40807c043b9d4e3c9358d93cf0ae8fdfb106a39e83013e38d99d2fb0a5ca061054052631159fa47efa835d8288ef3d4e2e46599b3695198bacb401d3462865bfa757d04bd435ea349ec80b605f1c4a0471c45dbc8d0ce08545923f8547fd77c53d8881ebfa3bdccc4406315f5ef10723fe2d3d8d89e8b86e4decd436c194e083ee8cbc7f99377330f7f67d62206d963e2cfd2127d6e7f54b7e3247fd544a8dae2f07018bf0097f9622fb4026532b081b27d5b65397ba7451e4d6145d694939665e5eeba62ea77e12fdb19d8daf9d198a6dab44a81d941da7d4f1d35c7d67ede14ce25484ef6bb22bed7c205ec54887c8e38e943525be83626efccae24c36ca32c27dd492cdd9ea1567feaf3e435a228c10439777454c3b8028fa6d7b142241cb014ceedb359c071ce595a6e847fd918f1fdf0bc56f00e0ae4de9d9b4cb3cee3f510811ff3bbdfda1a2907010482106d983a6a2d52c8f2a330f400c29e66ce8a6c955f798620166b2ea8704ff21dc49ff80d4f5d793e6cd0ea563bd9d7144d4b794ed483271ec52c50a937b90ec0a5c86374712717f28ec45e935f5aac997e983535b97d0634288c9651851d83afd34b28920bd1cb43c7104ec03d5dfcc429399666d3c74e846bd21701fbf5d8f1ef0f8ceffac28de547268afb525d9dd21e8a8eff96cb46f4412eb0c89de6efc4663c8e4075561b0534bb61c8ca6bc2df05dbf623925ebfe9e603e771b2356888bd8e1495bbd2b5eb1191207d5702111d87496b0eb9d0789c7e3f0e54b5a435f6f249175ae608b8c26c6f85d84984f8fea5477404d9f6e5b58ec04fae68653331351ca16ceb9b7106e9154a3496de0090f5045a371c885695438347577b1a7e55a1037e8329e31422c7d3f7db5e4a151098f01174639b955ccc132a50f8cb990e522d32d661677967b9d45992153230a488b6eb8358a5c744f13c45bfb6f89c62a983ba55a27a4cb675bf169e19280750ddeb46293333b3a720eb5f311f28710b7736c7a2bf4b6bc09c64b5c03c85dfbbff68562b140a2f1e9970fce7a2d34d9a80baaac550e125570b70c2b32066bad2964d6cc86001206e66ba8e8ca89b051f6cf1414400a2326115fd56f6cb91488dee89780883fe46de0856d55405000170aad973a9b5cd15191f325672c24552b4b9706ed432ed39e4d0df19d51ad802136bbf9061481c3f5c88ac03660b6310819147ca16caff86932f3deb7795649e99fedd4da0cda3b92afa2eba509d13d798edc998f11b43aefaefb3fd338b5782efc2de3dc207ba94e40e3041005bb876b15e81a977faf0b1c7e09946b0612d7e57f573bb65da9ff221970b5c2e0f7455e2e5ac17e9eb2ada2c425f88d806d290ea0ed92ad271ba2c864f0c1946e29779c7740d48e9836c5df64d2b5f437714424fa77762458eca88507f35f65d54cbfc76fa109616f705dd02a39a6df589415fb3ed7b82d7f4ef7d5cd1fe0abe01974c9151836c0568a20ce7957de08201b4f944aad6e51ff811257ba9de511c9ee30c2e535eff9e04066389c5464779413e2c25d40ecfc9ab4d5575a88660676010cd4f0dc6617ce1cb2d6ce214b48e79f410164f218de0a7226c8c0470c8cf6eec64570f1ce943259804d8e9f01ebd0e31ea060e9fe9acb780164da2ce5ab8c42254801edc67d8145035ab3c39889abcee6cfa7a02a3d05e72c3f9ef11b55fa4b79455bed40be021811b78326be66a90624df7272db37fd1b4bd62022d5d11b926d8bb562a4eddfaf4b49ffa208f0887a5ca0726a0c1b619de69b3feb8b4cef14697fafd4b4a09f47afabdbf96e0d3561c418291b2eff6114ad1865b7fe5346b6a8feb296bc470d5ab7d18b7f62b3a775a7bf9aca220e7df516043b6ef902661b72e082d8423397e1972c7c393017eabfa7bb18288025ccf78152a117db4af8281d574859c4447ab1c44bf3994718882f11728a8ddacd7070a4cf0fbf19be129b24416b353ebb17d694b58f36fe1f4f1639e3e8fbff26601f2bf5919a410b018567e100fde100680bf514fe6f45b8960338deb085b77d642efd126e49f668fcb1f7ce284dfbeb544082d783ff0933e82249e06ca6fd3b88e34a1c2ef0517b72dec98bf3e8bc9b42584ca27d8ee956abe25a337ce9951b13ffb232aba2be28aede2bcaec0277d7611ae35542c676f7b9a25a73a994d47f26a4acab44ba4046776234269ad69693903bd4595b3c3148f99a35ea87891ea62c88bf0effdaf51c7aecb4cb82a5f081ecab2c7a8d5f8388c9635ca0a2ed7f6c1a208f1ac01721e3c50cd13c16eb391769b71678c720ce0906f7286fa90a1cdc1558132e4c0254a6370a2780c637aa94e7125960627996170cfa157b4a7b7aaedaebf96bf74f93a9b86b232c399033cac48a3b0a3939860c20c33cb5f48e22ffa4436b195c8e357753d256cc67410af6ea5494f6649f4eb5c125a9ba01deb66e52a3f76ad74f83770a7bee5b016dfaf2f6ea3de2566cc14227a8d9f0553544a50c70ba55cd8c0cca8d89438eec607cb773618f54e0fe2e2acf03cd97f43ce96d77638f8fce2c9791e1897ff8e5c1267386034f97585977e16da51e836db0e6643710347f0a3f0b7053e70d2c909b86dc727bcf2a33da53d29bb78758d9d4e8dd34ed524ddf3b873c692050a25f45f99d152f4882a6a8475aca6c644ddeacf5698ed93ee00237f190ee960ca35ac4e3b44e135f50ac3f18f554e1f363b4a429a6946a89e4625579f50d0e45ffcbce5c73f6f63b544615a809a8f30dabe24b1a6d7e085b87052cf0d7733c54b0c69f0184f8008e190b0e63b04737d5af1c9088ab34df981a214361b0159243736f967149362c1a9e5e7bc7e5bcf73e253d6184270c271040ed75764286bf3ad264bc92e653ba594d7d92d4465ba1a7fd17bc0ec07a6c6dee76a1175c4c4bdbda4ea541f5332c9cc938834a6db8ce2a8bc2a0103e86faee5e075ade9aef266aa41244e3b14184a83aa411cc83543b9db5cb1d04c443d2c34f1e49a1d247ef931b178a68ff1aa96080984f517946740498fceb18e0346e89e804f945bfd301e7a9c76a9c1f66844558bebe7f9b947a7e870058734d9337429e6c8ce1f8150a726e698e38f0417fc46613250282a516c88c8be6a168ebed32d529c1bf5f536f96ed2b72d59f48f101eb51c4e28f5d4c8efddd534d1d2121e0fa0621afd582e45fb1ff647d04673526f66e9f18941b6cbd809fa6f75afb1f08942d593038784def334f7fd8c900554c49da041b7c91a09ccbbc519f3429eb73fbc04ffa302f490a2c41a194154ae9e7e035b893628f3d98db627c54882fd10b1ac386ae8bc3e37d574df3e4615658db366a1ba6ef65bbe3b3521da10f1a4fe723be3a35b787a53233307122cc16b8d20045b7e94125cff44220a0978cfd83e4ef2d759ee33d0e7809a7b67919bfc18e32f0032334414f6e0ec27084212e1d3ca1ae573f887bf87148740ac1389c0dcbc8a7733e41c6aed99c52aef0ca530b9fd7aa0293b90080d15e28cd4ed3f826990d1e70959e481138efe679eb472cea24f511076e7602bc848797e6fc8c077bab8f7dde80d3e37a2aab5f2a31c588fae4ffc7ae429e3f8620653f41d149291ab04ffcf664009ad7a8e837d5f42058714eab227eb9e780824141a09dbba6754dcf63792152417da00a1f91c38dd9729afc688f5fd1ca08f322ddfc50579f148ad1527887d7917a6742c11f7f73723cbe1868a2231414902a56ccd4bb3272faf4cbb30b51d68abf9f5c189aab29e2b42ebe5d8e0e3a27551ac3b11453820a231d34cd1c24cc5fe1f08104177653dacfc9e6f2fa3f5b4df21af73b445b34281717643070d0bfed83e7cab8da71397caad4943e054482cb5849c707c57d137556a2b6fda0d6b63795b4315dcda94f6f4cb9a3c1ab852ce8675bc262b19be653954c95e9b737e42bab1b85e762d85ebfd2f9e551651c14c2456b12e11419571e4c81b5768b7d0878c23ea690eed221621c7cf85cfd5fa95606e4897f29dea6ee6ffdd91b37508dedae8da8a486db46e7b91cf916befa36474fa419d44d098efd349ca0bdfade931fd54bdafb7803eb8c640b1d102ad709c9f05c26a5fce94270979630fcebfa154cf362d78739f4bd9ca7566efafcd8bf8fa9793e6f9ac895f0946976856dab16737bd8620edd70c24ab3a3a944ac3603c31a8078128536472f003ee8e9b355a8cc00f420f5c9b8ff520d9efc2ab888139d10b286436757278c094a3f3fba186edce864962ebdc69582747c20f629b206e406e77da9f136141de2c38a37df5273df5ece7251d778d46b1b4f2f4ca0587bf1f1f6a5181cf54ad53ae057ae953084782ef31fc5478a19a3950a4ca36907ff45dd5ca9feed54374bdcb8f4e90a226d6df0e532788ab59db21e982c38afd8f660be409a87d93ae86290e1ce41b1377207c358118619ad4e3dd2821f3fe384285f056eaa007423c8c73685cc2dbc0f8e9aa05c5507a46d7d38ff6d381b5029077962e4fa9ae308c96e5b6660903dbf18c7702cfdee665c9d14dd2d6581c0daa56c4ddcdb2a077bb39736ef63f76a3989d34120969dd91d20320d39e37bcdaecf493be13acf6287a6213a1f612349bd0cd1754a4af645db78dab59572928d4b28a533ea11ad65751c319eca891cc29c46d8fe4622100100046bdffb055fd005489ef6c1e7eb7ec21b734f44e45911dab90423cc9dfb8fafee25b4040cc0e685b1b3683966465a12ad06096715666bf65486a9c6c4bd77a888fd92b5870dddf92091f3177b0215e5c727151c577df6e8c5a65504269de65ec34dd61a3e87237d733df730e0ae4d7c908bd0f4b21e6090b6ef060c52743debf74f61be61f12951b8cd1f23e29c6c9fbf6c2214894b56a8acc474b1cd63737d33a92e11c2043c177102eaaee025f3e888bb98900dc768a7d459789b4a52971be2dd217605cbf88e40150b15ea8e0032f97579577ce301f19fa1d1c15bbabde126346a95c0af76157f7eeb290132d9263fcce5c9d6ff053bd7397ce18d089cc8fd5f334716805bef17d06192ce197474308545035644478aa94fd0b90f620cee31036fe4c657c08e2a1b261f065a4abfb857adf8ba714cd099883889adf945854ce85dbf96412911fc2a5d3e927441a3a0f7e9e4c133ffd19670287ced5e8b4dd45b19ecc5e67070faf1a5b062d825290e458d779e80db30549954cf1232b4334d80320f384f284de6004857c4472352038998d61d80cdcc65a663bc15692a07506b6c2932dcb693f3eaa838ffb765f7b7ccb851c3a255b6ffa6b5cc9f0e0e0587aba6ce289f651d921fd00ef3046420aa16ae8c3e3449e04c1ceeb2bee9f5e39d4e011a298cf0310756c3c5ced89e507b50ac811904d49e8495937c7ee43853bee9f0950f10a476e66e6c58a61a4416b4d15a78328ac95e3dc6217973ea94bedfc3ce7616706c95d3fe9469fcaa69613ac91e72e37b02798fe9d47ab7b7fdd268b1e0e85840bbb7fc1ef754a06282b3444797f1599375da7f136a2eeac02823e29429985bdc673ef99c8017c6ad42268e6a97d1fc100ade1af74536063e3d5d0dbe0f6ede94f4abc06cda12b8df420b26e59e34c3c227cfa4080ff9d09de70d759484c814ad9f78b06defc1f04369227b0c415a5d6b6b21bdb27d215097c894b9d7174de34f29f4009bd9b638968611c9eac7419a7f02e964706a6b58b3342e4e8500e0f7abf832c223f5b1a8f2b2e73d32e509e8f7efa1ff7a2f6ab46aa3adb00b2ebc8a750606717bc6f5d9b4321d7d7a7873df0ef375cf5c0f3a42bc7db56c1c868db3fc22afbbb32bf28aa7e7170a6305d9c8dddc6c144099dcf506f0e74c544b295c3aecc0f5ece1cbeb8d82e61a4d2a462da8c5c6a2899870fe6f9dd4d3f24ab2f622d8756b2ee2b7b6dd117a24459d42607290fc7dfa4430797ab573cac9c6e7b1b5c67b1c6d1078ddab80f272b5d086612d30012c7c70bfe6d64644b73c9c90f7d7a4486cb8836b7007404723396401f3953ac0b77b4821d5ca92be2db47cddbe4f24dc4f49bed9ea83d679e4f5e92aa64351fdf887e6ee21cdf88f06235d8d73c6b9f1b7c2ee1d942bca461718593518df355c143842edb53927f46f34ec5c317decba25471871879e41cd144f2aeab0b153120caca5e8754e26a7f8f6cc7a3b10a0b10841391bc37840bb2d36bfe04efd16d19696042d40e26ccb87f942cf92f0721196b3753728f95050a7a00de9eb7a6c66eb31ea8ae0e5bf20c04a5c550dd557b7f73048537e09d2fc19f57d4755a373889caacd75d94b957fa5c9205b2134e5f47b04c00941f21838765c9ea7bc5dfc74dc5982e0e842acb3bd09c7a350dbc7173110271c477f3238c844694cb4691934b2154f0225a85ac8625f2daff35d20de15739b0e5a14916ac85e9fcba2c4e2f00374f6b6fcac3636c78de9d55bb0f6d8284a091486a8e800cdd1356b0eda54832e484546abdf9a836b467189fb4ae696dea1006cb3ab706a72fb3fda292f205f871532e17ea070ae02a582e1e93ebf358b891e537c2fd440bbdc31f28491f77141b6c49bd43a08da96728532d580a4cfd7969402f740d9716562eed616e0b8bb0edaafb5445a53eff6b637f24f27f75a48d07530eae0451b59e42c094c10124af1233e9d78dcd6ca7f178a839c7cbd85b562d18359177c38d27aaebbb505dbf9992703caecd0220aeca2cb5fc4e7e74294fdc4384773ab649244e59f495cc4de9b39d7f7f7e778abcb1557b91c2658ff6ab0d389658e4c6164ee669b736a3348a3c1fc7f3e0461ef076d2dec2e2786de50a05f27cd066b7bc4e7ae7479c87f02af9102b52bd916ded125e0ceb3ba2f36b6520e4fd890994235e5a7b9a7bbf2e5f8e571555e5b3721bdd0dd751e79a7eccb421e8e474823271c4405b3b328ec70ddd252b1c8329337a31abbdeb3f61f2f2496d7f876ee2392306dcc241ae276b12d7d661afa6837fc0945cf66c90960fd39319da7503435b319901d18d0a4b2886603ae8f3c19e0ae3d04ddcbf32afe756b8bcb4ee3fa1d2962754355c38449983f03de4ffe29d0832bc83014d20bb1e9acc02386f1664d0350089828ef30a086633929ea9cecdda230d7cf790f46fe4fc8025980b33baa008d11b456a3d6456f3c63a65530714e614015f0c81c05a841dd5707195e1810812fe1667577c7b1d4301b66268017f70865392e9acb79acc9b58872737dbf8f08dff5bd68de80accf3dfee94d8d1bcf266871354b071032ee73fc85df236f36c292234f131fa00ecc24d0f3f350d6b584380ce23cc83d806794aaa67c145dbf193aac76dbaf2cf419880156caaaa4e84e5dec58b34433f5301a2c9a1db9e7c9bf73098080ea986567fe478371c4615127078eea9a455750731acdfca540755a0ee8cc67ed88310de166b8d4b39b21944ef3f4f6cf55cc8d55685b482d189d0889b23bd3d118651789228bbecea7e7e202ce316c4e8e78d7fc790272903e7044d131ef693155a961bd25bbdb58488bc45a3ea5120717a238b1255630398552ecf50c9a1e30635b7b59b089c2c72106f3fdc164a637b5eb9b99fcbb50bc881b3f114c99eed34f4f83fd6a038440190b04b90735450484e4deee920598ba174d1958d7737ac8c39cada7b9bdc47ac23240c36f2e85d51b0a4dba74b56863fa5dca2d6c81a6d8808fb53b66a2708a60e6bd8c9beac8603b30a31c454cba61dacacc9550682d51dc5165775f2823d774046e073db849f392eb2e2e3c0f3f6b7f307dcc2e81bef6307fc52449fad3de119cc6225263d1aa827d6b7841cc6c3e49763cfdc52896702afd72c6df6fd9904e8f648c5c51287403db8ca94ff254506af4caa664985a7d40bb649cbf41351fc2f624840e6b69450761f7466fb79baf67f64e6e6a77be63e062fb1ff488cdd876f00e48389a042f1b8b42a2dd5ce5c0c07876190332311bbe632e10bfc54b6a2a8b26475b2028adb661611456e996e51e708731de5f1a2f3e77696cb9288b9db8f5ec831f66c1143480b54a8b4d661cfffeedc902973eba7b790b7c42cea827693ad7ff00d149ebd13de7171728792083568a0678d847274d5dc16036d89b24b954bf3601eefe1654ff7379b5f5b5140b59a288f14e205a356833d65ff85eb178e4a12c442203bcceba94ab352028482f52d173551fd941d5d5c73bbececa3e681dbefc016e507e25e4e5edff91c596fdbfeeebe9a16f09fbdc8a0243564b0142d13cf4763b188ec5acb28ba92eb70b8dec03d5bd8720d9245075928bbb944cc3f8d97afa56cf798b3dc37c40142a14f1023e113464a08f610e8434d30bd3518d97d250e6590b2262c1bfdef9cee06e51d8fd5d2ec6f660b6d7e444500e4dc33771e05fae946a447c34bc3fd51695df4eec495bcd8ddadff29a6894cde91d2c2255dcf920e743c2c7c4c48daa2cd4b5f617432dbc0ad742a652f93c59c159670c331b0a8a678e1d2ceb2692386630d4666da65b0b2112bdcb4ea70a56f9577a6e1db87050416f32c607ff53594a78bd2dc507ed6e25c52929704d008195b1e66e30e0ed52f5d996f536a59008c40b512c8125314337dbf7a4eece6589ffba30c8097a1daae42f27035fa86435ae02a0a2b53424108a9178bf69cc1f8cd20843c9721ef9c24a460d2c5eb070cb532120037af3c5b2f356b0f63fba926e979fddf86f116c1ad978e693c3ded7b467db3c70fecc4e156390f085cfa08ae0b9a31b38b87871e332ba5915d0ec6f028c59e030bbc76bc479959dcd2dabc8564ad66150a45f062980aa75587a6a54ac3f03eba7e8880ff3c1dcf74e91b26492027ccd6c2c952fad88d85b471a82f7aa2f8c9ef1be19f2db0de2dfdf42685d86eb9f26142a6eac0c7dc613bb7c357e53c1469576345a5b8c756990194f201ea5d96d277ee6bea0e06157ae591e53cc3a5e2fe999733fbfea10f5811daa276364f4e556cde32e579e1217480311860b005e5c1085a0789067213e4f0b21e968f4401fb7e6a36cbf776c0cddfdd3d5adc06457e6e7b651231d8d88df5351b44e07fd7a1396840c27688c442cb87d0613eabfed8c5dff5064bc748549796e8fad14f4d107bb67aa1054b8f0694570b60570bfc5c23711743f8e543d01d7646f1c779b6dc61a1a559f5f1963ec29a5a940a522929341a90341b08f31e87b5067ec54bc317bcc3acab456b9a3d319fde963a28750f1920695126800bf9cb693de440a7d6dcf5149a53e5cede7c4c05d6f354d075a1cb53766d0027e96455202d09d2c3f50e85754403776d3c8378d8700739eb7ec73e895e4a87fdab1063a467a1dc0840c8dcb7b3040cfe5e025b1be45ade6618dd55334aa45d139ee1904159f5a6c5c51396c6080c02bdc6ef72a8dbfb5763390fa0adc0bd4c51fa1b81a34df231a2b4150d46cd09543adce19d0b06d97ada46ebd56fd9f39f2045ffd8d6a1bf010657bf4dbd379ce2c80124d9d2488edde6f82d3f8b5912390b38f0a4cf227e5d2905132941cbfa3ed9a0a14cbccb35051794b90570fb9435185dd7792532bd4e8b7d2bdfc5a4f15c3f593d5df41970fd5d5067b783e19e28be409867f776da3b144856fa3e02ec7a2afcd304e3c54c1fc02668822ea69b50af1ea44c9b723bb7c4aad20deb90537305327b153d3e04f49aa35cde8097ef63d896440a2175437094d7b8346b9929c78dbf26612db4d8e6d0d89a7a8ab0be68d93eebec72ae94ecd3f69cc043c70a20ce15162c3df1c153f5355eae20eaaf0a52c7dac0d77078aabd07a0976d58a1cb3dbab7b861d935cc2422a8f3baf3bdbdb73d4046b3ded384f8c6a502edc0f69c266cdb531eb38acc8442761c3edfbe4c5ebbf0f6cfc9223b64415423c04bfb33071e4d7fb2fef445a2a6e73c3208b66fae983e5a196b35a12e586161af2d1f6787725fc1d94a3a7c671eee40a6b1fdf2e4f75c2a900a5267fdf8e07523c4fdc523837c7bfba396bc6a2a9ae6594e29bc5081d74f1ba4165ecf3dfb7ac0aa9eb22a60a899fd6f3930bee78113cf7b3807e918eca166e4f25af206dbaceb1eb340e7b0c878f3c1774e3569538882c2ce00a05be8c491dc87fb82130790c79a98d4e418d53a665f91ef18e16afd2f80924a32b4068d0e6c25671a8521a18d77297922c3ce1bf636b02c7063ea3a0b16c2e61b05abfe335477eaf584bb966f61dd63880e6b4b675a55699417910e10b12039f5b7e8778274ecdaf7e6e20cb1763c46a33e7ae4d1f943888b339dae34c897bf8b3478a64e77f789acba1a81b8cd9b672ff66491380eafc54ba87f3b73ddcfd1d55ebae49acbf1e0402b9200ab28ed30ea05115bffc58b6457bf1fe753ef61b0d3ee104307510c119eb5ee1f451a79e661f748d15039d34d728703273e573c245fc4eb36304a7919f16c41910c4915f05c76a5074ad6e6206ce2fe1346f34165750b14db49a6e5fbe690fe2cd1ebe52669a40c7f0f79b68847be55bbe7b6ed52f69b14df22c24c73272dc957ae80161b04b65f5df9aef46765d2ebf6ccb3175bb818f66f4b2827243dd68de21312c35a232f195e648213df381171ebbe1d2029edeed7ff2b0b7d6947f046d64dde7d91476f789f22060f7588e86f7bd09d78b2d819b2dce851b28bf6d3649db9f3aad63490d7bee689e4925041428077c6af5afdec3495241e3e7b3a4f25eb7d2fca6fe154dd6aa3df186e2b288223cbe419d6818aa49aa3e5f2ba6b062f172bf24e530f3504e5f28a6c47d89ce3ae62b1ef049d912b666d1664b821f1d816a35ea85d1abb4fb305c542032d6576a6d248316fb4ffe07709d1350660b3f0459571faf91d9cd5f614df2b2cd067c9d87439e18e251df2ff264f40be14da1045c3e928d822c44089fecb1b5ae368f18065ff7d192be2537a08c864cc94ef8402d81b6768bddcc7f7522c23ef9b517ff019263659fafc097b0a21915ef49b3bc23a5dc123bea6794c7bf25be5fb6fb8c6b284878278cdf50121c3bbd7493727efea563264d1b382cd8f81f49f0b5f823635a77d65eeca2e3bd2b497061543435f64a99a2949af28a93d101bfdc98ade085281e7dc07d0ffeab5b31f2e6211a91e7d26c546c46a6db32097122b0c25d7770dcfd2bd9fcfab3a6ae37a8a13290e89ee5254ecc40c8d3ac47f2a58930b235059dc74b86d4d5de9acee42c9250d6c9393ba8996adca48c3057bf66c1f27512fa9cc0afd8c62f44dd2622ca886e7795e04bfa2591478be8eb193899bd8e99b0723eeb3e7946684f7ef9e1b3fcb8851d74bd7dcf3b554992ec6a1571171324246c5d9ad4c5d41855e733b662276068b99eafb848d956d7979c90d22aad9bea2888ef2f082badd931da019087036475c2ef862001af85ebd56192731e470fd62ad34bda55a463148d667669f78ab048133d199d38af1f54d9ba61da70472723a3c459aa0c0730f20c273e68ffc40ff3d63932d12cd4cbd33e9c0345cf171a53699df9f1fa7d4c7cc07ed5c14b4bc84c449f3d8898a7b360e204382bf1b886bf2949c14255aa3132e7fe69c311752e2aada48d97312308f9432855fb0ec39bb568d435e09cef2940975628308a984e8412609511c4a2986d955f571383ef983c2c89174884a92fafb15e0f380ee0b3495461b16fbbba9166381183a426c1322f83b1f15fafd5ee1c665943d1994dbf3db5bbb41a064bf757d64d8fe01835b74336d16e27f1f71ab567b52b472e124a8a97ece32b78594d6fa089766790d320fb3a49a189e4b8a8aeacda0d50beecbf92093a108afd0b26368a66c0a007e95b0404a8d60e034a951211a28aa14e1fd6c858ad76f9c8092b441b036ae34b3829b9a8d3e24c491588b131d5d121b771db15bb494c41229288dfd98ebeed476ca24edd99987656d8596d23e76e798ed890f99774405a18506b804b15fd20d6eb24455ba44282f1de85fe26165f1733af9c6b1b8540ba186f4bbac5eed915f11c04524735c4d3b9909e35de7e7dc4a790d42392db59bb7095083e1e181c2d5b56d8a592ac71fb25a1b5cef5db4d80d3d68b8d5baf17c530355267ecb67a8ad661f822e5f9783b698382305cd86a6404b7cdc2d2ef4917688347cde428fc3251c441007c970ec5dcb721896d6fca2455e612b0c58deb74fa7bc50db8aa116fb751f4dfd4fae90f643042f0225215ccab05c64d7768dd209ca9b2c13179609fcae526e99a80045010ea2f220f8535bcb45316aaa9649be157de614133564cb5e245c3922ccfd1b56f5600172944176ed23f2996e319e1324c13276bcd0bc7d3c6ff9d4f76155d438887b21b6a8ffe3f61f20c68058da7033d95805b6bac18a735634bcf402fbb7552fb0fe270171eee239aea7ec8887977104b74723ae3495fd9944fb8f742857ef461dee895bd3733b85492bab962910a2d29fe7c52c136cb54e1c2d64cec7300b09f8bbc1b322a4a16fdf8cb869b979bf311e029a22d8cfcba0b631b341fc40d4f81bc4bb27b41bbee52125d5a32359baaa1c8ba56d27d2369b5d9455e75d7c291dc0c6d0056b97caffd6a9c0869f6077c9d921be78da66a85d8ee21ef6d93052d539404a81bad610829c1e236ac866bd56ff394839f05871e5d372bd7e6be61a9481006277334888e9938023dfb237865a5f7dc85f4e02ae5bb8eda4f95a0ce3892504a6e993776062f48216f6d6755cc9faeaa6eea6630c769d01a7cdf908938de0d1091499ee50fab95a2821713fff70fae91254755aaee902468f5ee8d2bb7823302852746256fc6484081192ff13b2910fa07321f09e00efc8ee93412428af7951bfda2bcf717613ec32188247f7a5e145a8132a4bddcbb794548b3bc3b5a5002142c30e9e666a171e6c41288ce997d5772e9da943c6afb811501a878365fe1646f2fc363fe6c941bde74fb0c88e9b2636fe07883366cb041c8ad65c1f2bf189f9a98aa4c29f202525402c9463bcade2a4eee64130351a1e9722c7245483bd6afad9f9552f9c54ed7c722bce0b4626a4997b65f7362f828c5d289e428e6f5eb2ecd144ace281711c40d4570aac119e9c673bb673c10967d67f96c5a03728e3c2e1bcf7aaa55171255b245137964c2e6bf482d9ec700ef6","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"db2470865aa068691185dcd60d0115ec"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
