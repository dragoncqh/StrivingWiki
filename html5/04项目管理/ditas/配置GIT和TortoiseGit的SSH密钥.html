<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="zh-cn"><head><meta charset="UTF-8"><meta name="copyright" content="(C) 版权 2024"><meta name="generator" content="DITA-OT"><meta name="description" content=""><title>配置GIT和TortoiseGit的SSH密钥</title><link rel="stylesheet" type="text/css" href="../../commonltr.css">
<link rel="stylesheet" type="text/css" href="../../common-extended.css"></head><body id="配置GIT和TortoiseGit的SSH密钥-3716C412"><main role="main"><article role="article" aria-labelledby="ariaid-title1">
<h1 class="title topictitle1" id="ariaid-title1">配置GIT和TortoiseGit的SSH密钥</h1>


<div class="body taskbody"><p class="shortdesc"></p>
<section class="section prereq">TortoiseGit 使用扩展名为ppk的密钥，而不是ssh-keygen生成的rsa密钥。也就是说使用ssh-keygen
-C "username@email.com" -t rsa产生的密钥在TortoiseGit中不能用。而基于github的开发必须要用到rsa密钥，因此需要用到TortoiseGit的putty
key generator工具来生成既适用于github的rsa密钥也适用于TortoiseGit的ppk密钥，配置步骤如下</section>
<section class="section context"></section>
<section><ol class="ol steps"><li class="li step stepexpand"><span class="ph cmd">运行X:\Program Files\TortoiseGit\bin\puttygen程序，修改长度为1024(1024位的RSA密钥是最低安全要求，2048位的密钥极其安全)，点掉警告弹窗，点击“Generate”按钮</span>
<div class="itemgroup info"><img class="image" src="../../images/2017-12/git1.png"></div>
</li><li class="li step stepexpand"><span class="ph cmd">鼠标在上图的空白地方来回移动直到进度条完毕，就会自动生一个随机的key。如有需要用户使用时还要输入密码(不推荐)，可以为密钥设置对应的访问密码，就是修改上图中“Key
passphrase”和“Confirm passphrase”的值</span>
<div class="itemgroup info"><img class="image" src="../../images/2017-12/git2.png"></div>
</li><li class="li step stepexpand"><span class="ph cmd">点击上图中的“Save private key”按钮,将生成的key保存为适用于TortoiseGit的私钥（如id_rsa.ppk）</span>
</li><li class="li step stepexpand"><span class="ph cmd">打开TortoiseGit设置页面，配置相关参数如下：然后点击Git下的Remote菜单，添加一个origin远程仓库分之信息：Remote是为远程分之起个名字，URL是远程仓库地址，Putty是id_rsa.ppk文件路径。</span>
<div class="itemgroup info"><img class="image" src="../../images/2017-12/git3.png"></div>
</li><li class="li step stepexpand"><span class="ph cmd">保存公钥到服务器，将上图中PuTTYGen随机生成的key的内容(这就是适用于服务器的公钥PUB KEY)全选、复制，登录服务器，保存公钥到~/.ssh/authorized_keys文件里（如果用在github/gitlab则粘贴到账户的
SSH public key中）</span>
<ol type="a" class="ol substeps">
<li class="li substep"><span class="ph cmd"><code class="ph codeph">vi ~/.ssh/authorized_keys</code>；i键进入编辑模式，右键粘贴
ESC退出编辑模式，:wq保存退出</span></li>
<li class="li substep"><span class="ph cmd">修改文件权限：<code class="ph codeph">chmod 644 ~/.ssh/authorized_keys</code></span></li>
</ol>
</li><li class="li step stepexpand"><span class="ph cmd">修改配置文件，让SSH支持密钥登录：</span>
<ol type="a" class="ol substeps">
<li class="li substep substepexpand"><span class="ph cmd"><code class="ph codeph">vi /etc/ssh/sshd_config</code></span></li>
<li class="li substep substepexpand"><span class="ph cmd">i键进入编辑模式，将下列的#注释删除：</span>
<div class="itemgroup info"><pre class="pre codeblock"><code>#RSAAuthentication yes  
#PubkeyAuthentication yes  
#AuthorizedKeysFile %h/.ssh/authorized_keys  </code></pre></div>
</li>
<li class="li substep substepexpand"><span class="ph cmd">取消密码登录(可选):把PasswordAuthentication yes改为PasswordAuthentication
no</span></li>
<li class="li substep substepexpand"><span class="ph cmd">重启ssh服务：<code class="ph codeph">service sshd restart</code></span>
</li>
</ol>
</li><li class="li step stepexpand"><span class="ph cmd">可以使用TortoiseGit正常工作了，可以试试pull，commit等功能，默认会自动加载Putty密钥。任务栏托盘会出现Pageant密钥管理器图标</span>
<div class="itemgroup stepresult"><img class="image" src="../../images/2017-12/git4.png"></div>
</li><li class="li step stepexpand"><span class="ph cmd">解决错误：提示 network error software caused connection abort&nbsp;网络错误软件造成连接中断：<code class="ph codeph">vi /etc/ssh/sshd_config</code>，找到 TCPKeepAlive yes把前面的#去掉，找到ClientAliveInterval
参数去掉前面的#，找到ClientAliveInterval 60  把后面的0改成60</span></li></ol></section>
<section class="section result"></section>
<section class="example"></section>
<section class="section postreq"></section>
</div>
<nav role="navigation" class="related-links"><div class="familylinks"><div class="parentlink"><strong>父主题：</strong> <a class="link" href="%E4%BD%BF%E7%94%A8TortoiseGit.html">使用TortoiseGit</a></div></div></nav></article></main></body></html>