<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="zh-cn"><head><meta charset="UTF-8"><meta name="copyright" content="(C) 版权 2024"><meta name="generator" content="DITA-OT"><meta name="description" content=""><title>excel字段截断问题</title><link rel="stylesheet" type="text/css" href="../../commonltr.css">
<link rel="stylesheet" type="text/css" href="../../common-extended.css"></head><body id="Excel字段截断问题-3573B372"><main role="main"><article role="article" aria-labelledby="ariaid-title1">
<h1 class="title topictitle1" id="ariaid-title1">excel字段截断问题</h1>


<div class="body conbody"><p class="shortdesc"></p>
<p class="p">1, 由于注册表中Excel驱动设置值问题:</p>
<p class="p"><a class="xref" href="http://support.microsoft.com/kb/189897/" target="_blank" rel="external noopener">http://support.microsoft.com/kb/189897/</a>&nbsp;数据截断为
255 个字符与 ExcelODBC 驱动程序。对应英文版:<a class="xref" href="http://support.microsoft.com/?scid=kb%3Ben-us%3B189897&amp;x=6&amp;y=9" target="_blank" rel="external noopener">http://support.microsoft.com/?scid=kb%3Ben-us%3B189897&amp;x=6&amp;y=9</a>&nbsp;Data truncated to 255 characters with Excel ODBC driver</p>
<p class="p">要更改该设置对 TypeGuessRows 值, 请按照下列步骤操作：</p>
<table class="table"><caption></caption><colgroup><col><col></colgroup><tbody class="tbody">
<tr class="row">
<td class="entry" rowspan="1" colspan="1"><p class="p">1.</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">关闭任何正在运行的程序。</p></td>
</tr>
</tbody></table>
<table class="table"><caption></caption><colgroup><col><col></colgroup><tbody class="tbody">
<tr class="row">
<td class="entry" rowspan="1" colspan="1"><p class="p">2.</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">在开始菜单上,
单击运行。 类型 regedit 然后单击确定。</p></td>
</tr>
</tbody></table>
<table class="table"><caption></caption><colgroup><col><col></colgroup><tbody class="tbody">
<tr class="row">
<td class="entry" rowspan="1" colspan="1"><p class="p">3.</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">在注册表编辑器,
展开以下项取决于 Excel， 您运行的版本： • Excel 97&nbsp;<strong class="ph b">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Jet\3.5\Engines\Excel</strong>&nbsp;• Excel 2000 及更高版本&nbsp;<strong class="ph b">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Jet\4.0\Engines\Excel</strong></p></td>
</tr>
</tbody></table>
<table class="table"><caption></caption><colgroup><col><col></colgroup><tbody class="tbody">
<tr class="row">
<td class="entry" rowspan="1" colspan="1"><p class="p">4.</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">选择 TypeGuessRows
然后编辑菜单上单击修改。</p></td>
</tr>
</tbody></table>
<table class="table"><caption></caption><colgroup><col><col></colgroup><tbody class="tbody">
<tr class="row">
<td class="entry" rowspan="1" colspan="1"><p class="p">5.</p></td>
<td class="entry" rowspan="1" colspan="1"><p class="p">在编辑 DWORD
值对话框中, 单击文章下 Decimal。 键入一个值介于 0 和 16, 含, 对数值数据。 单击确定， 退出注册表编辑器。</p></td>
</tr>
</tbody></table>
<p class="p">备注： TypeGuessRows 该值设置为零 (0) 如果您 Excel 表是大型不建议对于性能原因。 当此值被设置为零,
MicrosoftExcel 将扫描您表以确定每列中的数据类型中所有记录。</p>
<p class="p">2，手动拆分</p>
<p class="p"><a class="xref" href="http://www.ozgrid.com/forum/showthread.php?t=47705" target="_blank" rel="external noopener">http://www.ozgrid.com/forum/showthread.php?t=47705</a><strong class="ph b">&nbsp;</strong><strong class="ph b">VBA</strong><strong class="ph b">&nbsp;</strong><strong class="ph b">split information in one cell
to muliple cells</strong></p>
<p class="p">Data &gt; Text to Columns.. with delimiter as Comma(,)</p>
<p class="p">数据–&gt;分列…–&gt;按分隔符或定宽</p>
<p class="p">3，拆分EXCEL单元格内容的VBA源码:</p>
<p class="p"><a class="xref" href="http://en.allexperts.com/q/Excel-1059/split-cell-values.htm" target="_blank" rel="external noopener">http://en.allexperts.com/q/Excel-1059/split-cell-values.htm</a><strong class="ph b">&nbsp;</strong><strong class="ph b">split cell values</strong></p>
<p class="p">Assuming that the cell is divided by the Chr(10) character, goto&nbsp;VBA&nbsp;(Alt
F11), Insert/Module and paste the following there:</p>
<p class="p">Public Sub Split()</p>
<p class="p">n = 1</p>
<p class="p">strt = 1</p>
<p class="p">For i = 1 To Len(Selection)</p>
<p class="p">If Mid(Selection, i, 1) = Chr(10) Then</p>
<p class="p">Selection.Offset(0, n) = Mid(Selection, strt, i - strt)</p>
<p class="p">strt = i + 1</p>
<p class="p">n = n + 1</p>
<p class="p">End If</p>
<p class="p">Next i</p>
<p class="p">Selection.Offset(0, n) = Mid(Selection, strt, i - strt)</p>
<p class="p">End Sub</p>
<p class="p">Select a cell you want to split and run the Macro (Alt F8, select
Split/Run). The individual values are output to the right. There is
no error checking and it will overwrite anything that is already there.</p>
<p class="p">4，其它:</p>
<p class="p"><a class="xref" href="http://blog.csdn.net/skyonehbyc/archive/2004/10/24/149025.aspx" target="_blank" rel="external noopener">简单excel表格转为VFP后，长字符串被截取的问题</a></p>
<p class="p">对数据库操作不熟的我，要处理一些简单表的话，使用EXCEL再好不够了，类似表格排序或是数据累加填充之类的功能，非常实用。但是以前经常碰到这样的问
题：单元格如果有较长的文本数据，导出为DBF数据库后，都会被截取，导致数据损坏（如身份证号被截断为几位数字）。</p>
<p class="p">以前没有刻意的去追究是什么 原因，今天偶然发现，是因为EXCEL在调整栏位宽后，如果再把表格导出为DBF表的话，默认的DBF字段宽度不是按某单元格数据长短来定，而是依
EXCEL显示的栏位宽度来定，这样，生成的DBF数据库，有些字段就被截断了。解决的简单方法当然也就是在EXCEL里调整栏位宽度了，虽说不用使劲拉
宽，但至少让数据最多的那个单元格能完全露出脸来，再导数据就不会有问题了。</p>
<p class="p">5，ACCESS中的EXCEL报表字段被截断问题:</p>
<p class="p"><a class="xref" href="http://support.microsoft.com/kb/294286/zh-cn" target="_blank" rel="external noopener">http://support.microsoft.com/kb/294286/zh-cn</a><strong class="ph b">&nbsp;</strong><strong class="ph b">输出到 Access 2002 中 Excel 报表时截断备注字段。对应英文版:</strong><a class="xref" href="http://support.microsoft.com/?scid=kb%3Ben-us%3B294286&amp;x=8&amp;y=5" target="_blank" rel="external noopener">http://support.microsoft.com/?scid=kb%3Ben-us%3B294286&amp;x=8&amp;y=5</a><strong class="ph b">&nbsp;</strong><strong class="ph b">Memo field is truncated when you output a report
to excel in Access 2002</strong></p>
</div>
<nav role="navigation" class="related-links"><div class="familylinks"><div class="parentlink"><strong>父主题：</strong> <a class="link" href="VBA.html">VBA</a></div></div></nav></article></main></body></html>