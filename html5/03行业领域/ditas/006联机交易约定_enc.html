<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"ec58af024da6be68accc2d29fe9ff0fc5fab007fa6f2cc79784d7e77e32316e8b93b9dfb8ada7e566a10972ed1a85cd66ba47a4b9ab8cd268f1314c84f6e6f51c20d7a3df1adcd888c662ce7a3bdc39dfcab1fbc2f492446d0ba1376d5458cd0950bfb005e20aec73f36c9055b4dfd609a1bd93e6bcea1e00776082e5f96ccc26e30d6b7e31839baf0551fd2ba569fe2c5d45bfc726cf3ba2a7dfdae3b598c57fe74738f43cc59cb35bbd6afbad989136cbb9fd918507f432961e260f03c6d2fe6b3424d11169f20a2a2963ce8b11c2f9bea075b697e430aad3c9ec14d70be6fe204905e227054d1f4d73b08a4ccae74b37cb3f5e65b5f4568ac131046e5a3d76b87ea429b15a00663de59944e254c498a7c70d1da0bcd1fa29351a99ac9caf4c2ec535cc2f26c2ffc489b5291a2e13d1e14f7f4592a04b9a0e51b922a82e1110e0c58bf870f789fd5c3c5aa79ee8da3fbb9cec3dfdf45520c31bd93ebb7a1f30a26849a874b0ebba73d5ae1e2de1715ff81b09d36c3e3e0400f87450b71c278299c27c23bda16aba26949cee3bafba0c1487991ccefaa97e46df09f7160c93086a10536420d9cee4d9b9724af46ce842ee0e0dc97a4591a5edf1161ee43dcddaab16d1eedfb3e8b629938c90b7437db0eb0af1c71d84290a76938196f8d3db7736d66f04abfbfe895e6aee3564c6338d08884f464cafbaf1783e6b75e6a6007e1188f8cd4844d3b4837ea4fd49432ae9a1b34ca136d6ff390315e9aff69ca970dfa64ee8c24301c011dbf88f28dff84d0f048f462af6c1ed3e8bba1487725311a3e19c788cbc91ed2e44ff04fa3441e84f690d5db8b32e029e1cea790cc08f8dc73b5c8a1d3feaf4b4efa8ab53f09cc2723a71960f875a653d906de55c83b49a2372ec6ff8e9bd3298fb540dc7569f36d0de2d6ee927cdd60c966541866d665e83eed5a624838fe76970b4c6aa4292ba41ad6cdec85050493b24d414238252a975a4411420abefd00bd50200c157e1ce0fd46fc1d2ddc5c38357dc557885052d953bbc9806442cf3a910eac8892fff4bccc79a8cccf22305f6f895de0572cef7938368377c930f9979648c24922a3d8fde5dbb11dd5141b041a6e35d60dd02c5b0fc4b31f9aef3717268f7f933faee9d496c967ca7528bebd1a0151446ebebac749889803f36a73505e6a87ec1e1b216fec0cdb694480874b860820a9ad65f3b06596d63ecc03e965543f81c53a6972f222405c93a0c494ef761dba1145f4ad0646b08adf0df3c15f070b1ae2a63d86f6591516e47b97e64ae32049f619cd196e7885aa198afd59dfca30d0875b92af29f9251ba156abe79684ad833f3001a094cb85391b0aeac2f2b473b26304a8137553c7a6b530796a1dc7f4de1cff36f780acd7a92ffeffa94fb5a65b066c426c0c146d0e1b227c1690d2f53485e1a4c329eda79e51c50ef9674860798d4d2e77008fe4c947cc0690adf48e6bf93e3b9dd5e7c7d45edc1ee009aac3f9503e8433919d14f8ca14a2def9f66ee1bb926347f5b1406d9066c38baaca6334772b10111cdc91924bd819909855f32e5c67d74236279a80236a082e2d9a55fc651b6f3b388f0ef0f08a759205cfe47a5386d71f1c4e04bad493612dba0be6cfcd02b1e5d91dde3af31da5b88a30f800414b66ae0079092cd1404c9f9aff3a74cb024fb17bf8073858e576540bf135a8cee5e059df4120accac5f6ff9ccc7b64d5b094a69ae4173012b467c5c42e82d75bfc8597770ea3f0f142b693ff1d2784e20f68bd404186dfcd55ca7156bfa3e700f895303d575cde45d7790d9b872fe5e0741a43cf304843c4cbf8eaa8938a9062aca5d9da2863f18f2d7ae21c4cf1f3f3de152562980f685cc22fc2719cb3bb4ede7761a105f802ed879ab3ee53bce61f81726f7be366d081dc67db443a13cb86870dea8a7ca4b54bf58ac15ec5b7a80aeffd09b270d5ee40c088ca2ccac4ca49cb8cef75ba1aa362043b9a6edc44b6d06db1cdfb5a058bdb5436129e807fbf160da14908c1565c4df76fe62cbbafb6d5537d9413f38796414d5071b7109e6f7a10c55fddbd4a45086aa6a47ca74b4653112402b8a0491e7b143742c933665432c7678c8207100a2d4dd813551e92e72ca855042733e77567deb377fd52ba79398b7b43d43396d67f7211b49dfcb5f8e276be356ebb1d5bb82efc002b30784913fdd86661ba7748c6e3eeaefa5fb9f1e5df86d8f65cd5a2b4e6714842cc6a1c1793861a714dc55cccafcdefc179599de08f3bb5d3f1d364854bc59d4f2a2f3409632f8d82ae3beed6266f71e4b4266cbeeb2401110857167112722def9c194ef6d41a32eb50a2ce0229941d88fbd507eafe0cf435726650c59662565ee0f212c6253558bb94b5a1973e88fd184af9aff167a246fff2c42bc73a15d8c164897a5c4a886c0d16d2c33797120ff7f8e3f9cd0794e623952ff438cec0a4b5e27287ddf3f88f40a2b803e8d2e3c546c06abf0e455e7105fdc8133c6503832191c3971ee28b1fe3090d6226613efb75a05d2eca5766f2e40c3c228fccc7f2f914b20be1a013184e425a5b579802ab83cbfc66b72ae25ba18b3f3d303176016a2ca3f7df9e5ab201e5e60e197cb163e19f1f8f91320052e1ec58834012ff97b9098936046428b9b2585aee20aa3abd9c7617d0087e09358d3640791124c2bbed4a39dd0816cb9f21bdc300127f2f923b84f1843640ae9c87539cabdc85f3dc92b341d952f39d4f71955fc9dd4d2a532a9c9abb9a5386baf34ebb9a4d9b78496cff44135e9e5539175733d9c1f61b82b171178ec0aa0ad2d22dea30db922ec9ebec7e8039f567559b14183516ddd07550b76a8ec2be198db22a033d22dab3b83d4e1709a2b890cb538d8fa55d9117d41733cdeaff94235a0bfccd513b30013d0634bf853815600b3bdc11790b8e7bc9b98bdaabc09b4b28eee1a0c19d7813fcf8e88a9b7e4f9874a6119de273ce814faddb4f89e7983454219a06a2a39aed9d8f6d5ba964e6860f45ba9f614d5e7f681b64a36769433b2a72a3fbefde8f1517f16081fcf8ba5764fc01515e27323826a11a9f07ae51f2bfaee45c650a7082c5ac3d3d431b403735401f48595e885b19731747be1799246eef27241a3a35de27732012355cfe748899f06b36d5415643e2b6dbf20f41520080087e6ba79e8c5e268e61fcdf98853b48e4d4b4f16f75d0ec4c0e01837fc48da621d0d9886a27737bf93dbada80199315bfcd961750427037d9d4d0065830691e5f23bc8c49a44285a1cc5a8278f1ba3d82111f6c8b02a1156230ffee5a4c1ab10e64b916fb881013cdd6c8f9bddec8e6aea33cfa188d24a4ff633dfd0d59ac00315a1d06e6b96db6afd82051629f98be5d094f2f2f325c81ad1d75e102a41a701cf3a38d8642d6f6d0d443f942105df54cd4518221bbc278f29b2a48edc67ac1044ea20cd4752e37826c155f26ce51f2b565952e3a7b32e710368245622e28356376817b03a5b4b04fe793687d101c7178a0a7fbea0838f91a22ee572a3dd2e31b7abacdf3fb1f00f02afc471f8dffcc4366e728195f623021b4f4a52ba6775aee8743448e9ac5151fbeb744b25c9a7867594761c14a057095ea6ee1619727449ddf4677208826e12f74b8bf78974525b86b088947ae605afa230634555457b6b03d6b0b413c699d30873090bb931c140155ef0ac38f135b65d087c6a31f20541984a8a11409782aacd284864d8f78d73fca15d941f2f817db4dc918a33872c8b931a50b6e8204199a72301af169be7bbd98c0def34be59de1a70f380f9ab178542ad018af516b420e7af7999d17ebad2bc5558171de997134ce00ebf4beaf83e81db390b70ba9a4c79f7539129a399f8d161f182f6add70d3ad956759de03415962177923d9dcc15625e0fb8e8bb7a35ab03038ab51126f4b6e8bf132623349a76c93c38a70dd9de0af97155435ff24a129b36925eff737dc328d4a387bca32b7b95ab7df9e3851c6bcf6ca1a3b95d79c45468fe9824e35347b9689b68ce67561af4928ad663a23e61903503d34a7c505f00b743c847266f67fef5522b78243340541c020e971eddb6ee51a1d3e07c2dd13e89c8531102fa56625635a70ef6a99d3e5dcae8421f54b3c31515e4042ad4ef7cab1e1502a7c717ad44a2fc2016ef76080dab7cf329fb97a47434b0c5f7b661507200d473d02252b82eff28ea728b41bdc889c3f0ddd8aad87729f8ca7313d3ae4534a7c6f50dc2cfa3271a96cc4b2ed0b2db8949d77fe60441ded4f72674c07ef694e65600ea24c6f2493966b6dee0a16279be0b4896762b243cb27903caac1467daf375b67e06eeeaadd38507e23006a118e2db65bef955402eb476de554888ca1c879c44a80c291acb1e0eeaf10c55c12290eff5a1e3d780241a4d5684d3e22b092283a64c8d0f4d3de4aa1adbdae58fc552e1e83fc85e64fc345656bafac170091563ed1c2fc82c29ef3623011eee3e33abd2a194868ef35ae6d6b6776c6ae01907c83fe9100b892c651246c41ac0c7e9913a01d0c1c83516f370ee36d77d5fea5972e8e34305eec907f027bc2028204bcf83ade5739dda3ddba891b4db342f3df6b3056d8cddd41b6861e782fce5307ae81cd9d64c7d6bd10f294650dee66449584057f7cb6880d5bbefd26ce4158597ef27929274c352d7dd02f2a27e769b1ca8db49c67ed02ff11ce9ea3051bdf82e0ad216a662ad1937d812f138cd63ad17faf79cb0a86408696ca52c86bbcfa409fa150f0f94c004765e08c716cd0b489faf85aad0f74ba2a5773392042245f4d84a6548eeb5e0397c76676ae9c0d099d1aed5930caf5a9d76edc5dd1d6aeb216080b397b722b81e6a23c58a64fed0685e2b5621d308977b2b91feee69cc2137e328939a07182bb013b104d4586633f499314aa1eb3c634f60a01521bbabea547075fd123deaad21b3b1d81d66b996ae1671be9d5b16eac328f380334b0591d7f39c9667d9bae9d7c5c9b7da04b6a93600fa45f5afec822162c384061d10249901b05db351c632248da251ebdde5e1cf6266d0dcda35ca94d9922a02d8b24bafc4cf482dfb3e2d3aa9d95b2e3b78d8d805a44ec2c8cfe55d77bf6b04b631c5ea940e7edb28cece1f74e059d486a54d24f9d5b0a6843024432f6174fb331f6f1ac453195fe9ec0087f860a1caa3b79fb36d954aba8cfb43d0f50751ec30f49992aad3b643559d3379479b879f1a4871c2a6dc92141150c7272fdf6892f20c02958d78deafbc9ada6726f41825fe606fd8921ecf44ad49c81b1268e3bf1afe5f05457bc041c92cd5d08ad55c0b0979148e45c9e1de835120ddb41e478ac728c52564af44e32d46a2896edd8a7871efd4820f216a28b81e0b2d1b475642a387f63879ce7b67e1128f97bbecb1f6dfa07891701a2036cb50cafab717a5d1a01a22bc5a8e966c45b7f3961e059f217127cebb2209edfeac51cf59874ce29b6f3b8d1e88d5d2cd7391c07431d3736fa4b0f3b72c7489924ac50165011341536d7edfe9fba31d2951bb3ffb407fb18b5119d5e053513ca638237a4819f553887e1d5834bc451e1377203e05dd1a5d66ed6bd1c57f774094f3db52ec913eb2f88716ace5846c44c75f9b31cb75c82f844a693af3250fad6821f875ac6f6ed85f45aaf76054accb7299d46a5782e43ce3f78c4f36f0261e5bc996e7fb80f731dc187e1630cc2456ce43857b7a3f09f858545c5f75df7c0ed3200a0b4b12d4889d755e92c56c37c1b07b3161f5dc501d899251117d7c977144db38bdc819d5e455402724d57332b82650e4ea273d2b10a56423f792dbb44808aaeb7e075d2ae2c5773c6fe0ebd4350b51553f51b61dd96272a751b1fc714eda1849e6fa07739c1480249ccce148187ecea8fdeda0f510762dcbca5ab80fe8e4655fe8021f5fb9e7a7c954617fd955c98bbb42e49ea0c2e8aa6ff962785fcf7f57a2c1511670eb2de891c553092dd3926d39b4da3aa622f43d943611813acf05a2200ea6412a7e04a8f6dc0222280b12f1ce9f93c841625eca68cf5424a7f69e8e77a945652998f923636c0764366c75828f6ae3e2a0264952ae4f7b2be0a8b6a11e142e7efc9ba4cf88bb196f10c7c774a1e0217c31032649e2aab28e738d098d4add1b2427c40b5b4daeb1830880eb0f1607c38a485a89de3e581109a8de9af43bb703b228d6bd0d8887e79aed0b7dc9f83d7cb04c7ba92132e8adb80d60bc51d27129a09dd177ef06abae789e32d805c0e05cdd896516bf6f1ad5c5b315fa1e27c6b51aa2c581d43777b1274dd95c4b1e2c716f1e28ef538b56384b16c4b4a45fb201f07159ba7ad023fe57da09357fcb2447e0f14c0cc4b4f9b3716adaf4055f965c8ad5a515f656499fb18c00f5a6d6dee9fe5a6d89ed50daddc19cfcde8c218afb80224d87619633c39b1a2d948a4becb1b64fb908aa3262192f49ac3afc1a3f5dc8a558ff1ea2d08c13e06a79c2f55f249d9e55111c93cbd65ba5bdfdbf1f1117f69897c571f6e884d6d44b600b27f3aecf155c20396a0bfecc1507d6a942ea787fd605f3bd08f6d7f7edddec68563ddc196b95805dd7a334da780b25d537753c732f06e1065a130b665ca0d8f53fe95df030ad2ca509e24270ca1f80fdbf3d09d8071b0e7c837242ba5a63cdcc2891ae8094f252515619d6d88497cb376a0062d66b4f8a130307f2474bf949a5b0fb76285e570ce0cc3d3be2ee6871de60d596336a38865d5b7d5b9d9fb627d6c49259cfa4a110fe4818ec5ebda85a5309e8de80bb646bccb41ccf9a6a063b671fb0e4fc34d27cf37c721f829c468ed9c0b6fe628efc03adc21d0dcfc75655547f9c4cabe2080e9b62c368d6a3a027f6e1f0d2de5ef52bb7963d3dd97c9a0853ce0ef0767409f674f3212496a6e35101d889252b49508ad6c7ab56b3d6d3d6aa10dbf6e94e2eb21ca4e530ff92a77425f1063b12e20bcdcaa3cc6c7d904a621a4139141570d553075fb44ed7e801578db0a11c7c145b7219d0a5c53ba68a1d6c7f2de6008611c66878032facd33c70c858916218351548e3897f2e8a785bb80384d8944ff63b4e9507ce14c89789f08df5a0dfd52b2fb5c0bb1e42f5ed2350b91723c3522938b88ca685a284a56b677bafc7532c80b0ed72ce9f8aca00068c917803359e1c0bc677268947b23e38c43497159e357089a93e3fe7ad3b32b722b2376e5b233c20f4ead5966c5b89f0f4a9cc7d96e86a23b4da54351c609ef40c64c17e35c62258a1705f7b42fbfc68f4ecf03525b7b81c7a7da0bd7065fabf42f45829a0d2add536ce853b3e6778154bc1a3f26d7f75f005c11f1ff192dcaeff6af959ade6f8b9b93c0a5b85d4f1c9e3b94b7169c331f4acbc899f0606b4d633a60e50b6460cf8ad17253e97098fdc6caeaba856495987959750ddde7a532cee86b2613abe9933be09019d206ae83c4d8eac4289babaa33324b2c833bf56143ed4bdecadc7fb116ab510aca87b057971b25be71ca36aa16544cf6bb1aa86758f23b2492d63a2f145a9be54530654109a9d93978e32916f0e2707157fe44d3fcb4bc98ad4494ea04ae459fb514a62a6f719397df0a8a42bd53aae0a3cdfd89ea8860ffb400bff57e0f898725d6234afde916e8879169979087575289bb4537308f996cf70761315e43aefe091397c0a748ad62e82145a1caf2c8ce6a1626f33140aee4fd4628817c8caf9084d8008a8f41b6358479647c611bda7d8861fd37ce7ad64ca260c2948821ddae0962d7310cc08dfdc019907b8d9db931f6ab747333abd4ae25e845ad13c117a60a66c1a9118658db2978ddfb7b157f37d8784622fcda7cdd0b1f483e0d547499ae555116dd724a627893bbe013c226c18889549e7bdb3fcfd5b90e84f5c09b117c2abdff61265b790b5f543a369495dc642b842fc123ccc1b45c509b6017e79a70f479b3dd2234a15249bef5c219de723a0116b660550e68178c98ee3521642cc726af393228fee853ed6fa035c1ab852b1b8ee46f6c31fba09cf1d6d7005fd04f74ac5e3a20bfcfe22d6f74a1b76237d046e114e104accbe7302b65357d7c32d57264a90bb012ac62285c22c2f4e67a10bc8982d5464d26ff705ef459f4ade5257a4226563698e06539992bb0c0580f17d532c71726cfcb15177351a706252d4bce6c990054ad471a2a826a1a19ee5c7be226dc6984106930815fa761f320e8067bf815eb3952af4ec2219c422b765664e4cd5aea2f58fbc0d5b890f8e9eb71c25d923ebd38367926b979dff3cfc3748fc2dcda9d6bd02d13413758a388eb9260d7594183050762caf8643d07745e0094ba7fed2ac602960beba3b1418023c8d352e2d73d8c3533fe2cfdb62dea951ad0415c76d788ec6e87825c7145087a57d7868225d8afe0a90e13992e98aafd43c18f591be964421e510c950d617baf3f008d01919eaf3ce61449adbe80e8f167062f4e542c1389e2121d83028d8c382331d3b079cd5ee6b871b264438c7207c7177f42f02c12f5bd55212996d1797b34081b28f3b349e03ea48179e93286b31bbc1b9a3e82a39408fc494fc2112619d7c24a852e512db972c1bd5404caab85b8fc25397fa0b51dd3f8cc184fb1e1a0608ca4f5bd66801910d1e65c5ac641ed94cc23e7e598d5290261966b41286cc75cd19117c024ce5574b3640aed557f365019db3584d8359639ead6e12c8fdb0100dbc6ad20e6c138b8410a2c4341462c927346fc08a28d8d363c6f83028eed799c2b2b5b156ee39e2cd7f227714908d3d6f1dd517af04207af9acc3136f7851027d6ad93cc6c516070be5f96a05467d2a2edd366e1cac51b23e483776095b3d22cf8c02a29ce8c4a9dd8223e20bf92e8a80b671da2ad137a79d898f020317db12122f73c9d03c74e1c4373e216e90a62651cf4f237082dbdc16e6b411ed3592714722811fe716dd78f0f25f5b678279da288b39f12d5145857d7163463840b1238de74e9656a3f70aeeb3ec7c87c2d53cecf0015be4316b18d9043fbdd2e830773e5431effde752d65ecb3caaba717fa9350b56b439b206c372f61fe0052c6ad260a3b7adc8ca405c746e33bca728d4a2673c4b1962c68150bd4e12cf7af8a574ec2878fff95a9dfc3f74cb9e4d1597f21add9c414fbeef16a9d99efbc2025720d698b332893a44313deffec72f182477a11dca826890707bdb6cf086f24eee7fa6e48e5e43cc2f89b9e82ab08f5b815832b05f7a1a66bb1a8271771f0415c6c7bc450ce373e4d1eeff760744f5ea1e3c59ae0fcfbe8d3e7069d549c3ef4781a6d7e08f8a97872229fa591b6c34e91975052f1305726242d523b83d98433da5fcf279bb40fb0a88c69831404d94c54779a115b807419178d5e711b6f6aefe35a207efcd2c3e440ec908b052c4c8ac7dee55d654da0185c3e5644e0c1e7018edf2ce8e44c2f4b0d9e9f63bdbf5e1c8b152d2b9aff991b4dd3ab9df72efe24b1b9d26a2a2a70171acc2446cb017187775e75a32a8ed782bbc990709c36387612329b47887c44ebba068284f929ba746c7cd5dca1d4d468616091f66292006350c286d82f067e4cbe2e169a061d8f64f51ab4b0e5751b05f710fb51931ad6ae120f5fcfaad483264dc9560db82dea8a4da7ff399be3cb62e1e8ef6894b0df8fd405046fd93289c2cf912d8db29172531c48ea158cac2dc46c3c72ce582802e457427fff28a9053102c97dcb0b6220d4505b548f6cb7be604403663f1057cfbe47995e8db390f78b545eaafc4e74ec5b5cdc478bf6ccb8609e0d09084f0c9d8b53960048cb0d21d7b1f70dc94e6901d5e826dbbd475b74916d293572c11f5e2201cc4fedc649fd744fc65d153908d636a17260cf881cfe3002be0aeba0f1e5d16617446460aa8cdf706016093482d6fa9a72eedeeb49fc404f5482617f529b366f9587340a1f234f1b3c9f17f4d841b20ea78e38b8c78819f32e84dff84467560d7af4775969a804a48deb0fea8136b816a4d62631803b938a5db2ed80f6839624a303ea2c3e99a783dd479901c1df4e7fb9b48630f4b602450b6796cabd059473f5f7dd337db9777ad8a0fd4d1edccd4898b42bf67209ba3f2ac56e62a6ed122445396e8d0f8993d12a792fff779c1ae94d28fdf6e0a4cc3e30e4bde080bcf66a3c27b717486d25d19ab6bf4382b94c12c8ac3e509256c533e228035356ce73c9654ba1736465103bb89d5c0a86fca700a6c70940b5dc6335cb9899ba1b1d75ca40a9ad59346d2b9ff496f2972812f9c5fca075c1f0fd0f5062d88952295d64529f8ba8209ab92ed28b2131270e965ca1ea3b2ba47566880fecfcd1013e97ed27ef1987bc196f6c61c5f6b93ea71cd311f90f3a78f0e043acc83d35943a6101b892c44568942199a65feece5d47a9d411e2663daa9da78f29ca9abeb1f38ea8c47b96bf6db44011fa14b511b1bad2d3ad7be50a04315d0d00223cbea27fac5ee98940db2615034a768bcf144f4516a3c7ba23b3367b1e8b5514937ffede38890ec6adc3da639ad5a225cc398484d104a44cec74638637ab3c6595786435c1088943dbd478dd2ff5fa140e2d07ad77131089cec03072afd4908d60bac726f7e894f981bb792c7bbe8120eaffefe04aaa538085043e831c71115ef00dd585c7bcdb76f412010f466c1bc9e96052ea95dbbe6a433983208f6b6b02724cc222da73e108023c722bac6ce14fbf796f0a8d0639ed778b57c11f28030207f48d7ce5f855d68bf7ee24a8b574a6eaaa6a9c1761f2e2588d4e8c049a4cde44d9ceadc2dfbc4c7731948accdd0e129396dad0a7e84a378e18d7f36d28d61953214faadcecf4e491d2eb393d1d50c0537325e2def1226a66b3c8c77d97d3d426df0bba5308e9d9741af0823dba3f0e0e99d0be50bb015cba4e10fe9c968ecc06c6150f32a3a9102d40f71bb21624e60bce0e8bb6d96b0ef9d0684bb1378514be3c73a40945c801234b6612445b5fd2c82777c51a1ecb0f961d667edd01fe5cb5b2b34bf20a4c7caefa06bbfc594265294ff5b335e0609a387ba8fae2e0446097f17f3a4e52bfb65ce382f88ef2c92e29fb412e08e133abab85b150f1c414067dc809400607d9a46ca983d29047c85ff4576923e87fb76a5783000fb62e3783eb564b789febcdfc2fa9d07f202bf69f051593c28465ecf86644c6c77f1ca6c4d7234ac5a89de633a8b60b49e78df7b1e9c74613b9e2d161ce85a47e46402efae98dc4af5e087530fdf5a3542f282bc7c1f018228c5015ba8acd134a6f00f0b19804bcc189b48c8345da814faa9865f6ba6096be7d2ee83c845219dd27f5fd9b2596d568eff2627090ab75944e62ac337f031143cf01c1ac9bee473a81d61cd5b04dba8677fd83099a3f214c2e17525402579712c0f86f690d5c70c0dc9e4bc9610897cb61ae6a525d2d657a2acad17128c6df2ebc88b76c892857dc597b91f24382b6c1d369cf4366026dff9e128099e6efbf88c75fb93b8be912c1b7750766aacd88dae1c8ec28c7d573c8972ea4d1d8907a0d6e34986300b10bd528440ba3e734a4df921b2fc6cfff3489c4df7bf84335f496144fd43d68f7ddfa9cf8de71b4dcb73a0c4c9ca1e12bea5466f7f0ec2288ab7ec52c85027f5ca3f1db0f9117c6bf1b74469792320fb0a156b933286f064c0fc9083fd2e9566a3ed26169ce3618fc0eb2a3dda5b69a9b12098bd56d39411180c7ed388b4f89e8bc002b55d8490f2f8c0b2b24230a969f55f92c875e48d86ef9157c71578bf3fb4413eb24930bbc87a4ee45523a9ccd1f72072a7c5a445ffc80403b461a2d3eeb6a3ab3b1a270dc4b0c94e6c3074ffbde674f0f74094f09e385f03ed898ca1a2d8048eeeba309ec5adaa22ae28ae386a07db696919319e6c4999b8efedc05ba82cbf90cac8b1f1e805a68b3e3afc875a1c27b2ecbb9b846823a5425af98901be358957e82cc53b30b80b72bc3a7ef4cd9be693eca300d042abd58df4aad57fb10fc47733848ceecc49b993e8cf1998e2b7712a04eb78a157c9b111f7d090d8482996e88b80f2544df63115751bf1b0a8ba68c3d5ade51d91df3a17b8583931a1ddec3e3afed21d2f4651f061a418e881dc3c99fcdeec35532723899fd8677005efee21791039e3d3f15dc2bd7f42f746a490373986aa113da840dc1f64867c3dfe7183cd4187e52e57ed9749c6a5947aecb3b854b57eed46e2b5697c643e63326ead1a50703b91a28d3211822d892913c5fd94e53420bb815100ca5fd63970b9ffcd6f97671852a11b05f629057c235958f8d568bd019d47f40a149bf4bc8485900aed5339d3a543064f9968a0bac9374115b5549e832b9338b50b6babaec7badc47a786a4bde542cda5eae3deebce8308f9624e99136622621cd82ec4d390f6c15f8116d2b5c472a98bb0c98de1fe19c185d180c5338dd24c876e9514ee9dc0b883e4993a36705c69f8a19b30f4df1f7ba2e0db79a767243f93a894276b60fb85b5b0a827015beba8ad4e31ec8a59e8248e32ef20378ac15b3f63e64d2c7073a4868bf2f2bff5a45e7c11ae80ce9a50b39dc259e31a3be5f4c0b2c2d3d0c6871fdf7c745702331063ee04e9f85839cfd6d753731558fbe04d6d582db4631a18aeab028107fd88ed20c2ffaf53a3fc5d93c994a2db20887511cb37cb6866fede0393e2b337cd32c863af7effea007af44abfc1989f8da137ba086d75c3135a93cf239c3ba77cb3bb27280cb7d6c38635ac1e01c57cbab2b07d773f513ca0ea70f0eb0ba9142b85c5d7d0026ce2bb92231a27101122a0a8672fbd97c6684d7ee9d1aa54dc9ee447418a7f3f057937931828983dbc78d451ee3ca11f774e5a1ceb04b9de84ed26f01db86d40bb553e43b3cc04e16eb4a75b951aa21d5c705c35b97c5fdb92300186b56ca21e3d16679d99e53222f507bbb3153d29c92e87c961b5f5b4df05ffa2d0f817494f81bdb10058799a847805dacfac8665c4b315efb5e6a5280ff38a78ae721b91d01987ed5dbc4feef5ea5513280e7187caed071a2c01f60be42a0f2a463cd1680f83e7a87d42d8b6fcb1fe103dadd2163d4da9e324a5a1ff2a4cd26e1a7df2e2a7f778ece884793178ec60c0de0129b0427072d242ddc1cf62e753cf25853618614ef3c80d58c67b9ccfaac9c1533bad3357259eb045222b580287a0cdda85bc93b8c827e9b50c06c2e8142c6dd0640ed0ed8a89fecfbb94464ec8737a81fe3c646e70b86f3d4178bb2946d5d9ed9245888de57efba26bec38ecc3b4b1aae51047069c935165f74fa4d3ace85c320f143661f1d38526289a7b6c111521954e9192ccee3a72b50bb6309da0c307d93e45543f8a11568039e18b9976f6c04e792b3e6d8cceedd40677c7dd6672861c2657329cc955fac9e433e6a1ec05d9ea87f3fe0c868196a49c5be2ac40c1225b29787e5a2547b6974bbc4672777e1a4c83eee6cea56f91ad30b3c971dc34eee12ff7087d77de6a0838eac324074a2757569519d5fe1dac1a89bd9041e02e584b9f647c3aa0a97f37450390e4ce86b043ca84d6be6c3c5038c064409ca5167439a20a113d9f30144c82a7aef33896b4a22e4c49fe67709ff492608386846094145f2fa6b03fffe5d1679729bb45c326cf4e65d2fea9fe5c8c02aa4eecb93841be0c8a0c49f3073f76e85c0ad220e012c0c463fd4f68953a8ad24cd69b26427f66541718697e35e642a4d5d5605d8b0c07331e83c010d3800116ead057bacd47f137bc3599f2fd4ff9ceefde9fc65027b889ae32d0c71ccd85af3ae73a4a62603cd77a0b26dbbf74c9a6162816727dc44a921c0323b187ea6aac9d0ac55fb0a57a217254a950e61abacbd11d8386f16da190c7eb69a690ba45d047cbfadb4144f069e55a0a96263a809af4f84e5a546e42fe37ddfb972fddd7ab3e62597c4a16ddc585dedebaffa05cf50bbbe797835c67c128edea9bb32501dacdb99ce62a0f9c462e04b2f6cb02663041652907f1328678cd42fe731a162cce909ca6d15f5e76e804b470c34046e795a196f22eb7ccd18f43908e923bc4005ebd883f81f1194c6662ff9281e11977b65d2c61446d3bdff6f83327c5074c5fcf4296db8405de42d95384c359a463847d25a3da6175430aec1d3430f61fd1ae007e64ce9270800764dd2f5a1e05342a1401c10e52e62dece965748cb1056d1c908e0c7a7a21bd011247c5d33af9271b0bcdeb074cf2351665aa82169d4f00c104d41e73e0dd1c609ba69c08f8fcebc1d0af422fa7a75170c382fe14d0c1f88261e7b8597430a230308e874ca3142d6463e26f58c40ff3dacda4b34f9a8737c67026e17016cc0fd308f4d45d2257c9951e7911cef308b75270250737f66e8ac7932f273997b97536f1ab91b3b69a3dd609251ee7f8ec2708a15edb4c7a1db006101a9117569bdbae9e35c574bf0b1688e6798f02f390d5b0c11a14d09252ddb55e204bee3652b8bb17c6b0106645a3fb687bb8aab146c8e4e171c0fca2179e678b175ee78b2b131b232c4859cf32868ed3955e23c595af9ce0d3b5f1198d62dc9ec9ad13289b31dbb650b4cadb35df57b28cf4ab9d261192f255563a473a70feb480a0e0eef5178265b72a1ae0728386c4bf1fa8ab6cad22f8122a67679d80ce6d7bc4dfba423a72adfeded9a0f497c31f6471a0b4534d489cbf95bb619ae9e492fc7cceea1672fef8cb25c3c38976a541fac2de4c377fd77a4f3b6057406c2a153aa23d77b1438d0019850d66b11ca7223da3a7dc9d059b427890c022f9f6097b58de2baa36a55b77a7e4a420a1ea674bd2b47ce045a650f8ee61c02c3095a7e259265ef3b1faa8fbae260f2901bcde9eea7b2517f30c107746683b90c3e14aa059145cb7a8ca666489d2a238b0dcfaf9088281e51028288459397b83bc59938fbde9596d48230a8c4897159076bb3e22397b27a96256b608e9f54e6d9d7afecdedad98e45d38522b4cc3989320397d0d9b7df34ff98a025b84e0c56378cab3d5cfaccf007374c6720c38a0cbfb5a5c947850481493b4b8b81744a80f2fac44cfd484defbfe96124a895b924c7786e77ac000b3b3468bec0ecd1cbbbd039d7455e07af9dc79feb6e5a318b8f86921384fa3c3613a6b9b6fec5de39d5d1bf9af8fbc70a6d4bcbc55db5474e6f32fbe0f474f67353fc8fe5dd2f2ba158c5cd3765a3c160825971c58961c7d442ec3c998a0019034c91c9d0fa22fb1a09c69652ccf1f53f28ada7b31055f2e937d3637d5a7680ab8e0ec706c0e6b3935c4e371d914b8845af0bab6c3a7eee0a839170a6612afec3ab103ff316a521c79305c35663413b0206d2b39199b69fb7033815bb211f5d159858b933e83235f0527f629fc71d0e95a7a2d5a91e295fddc16c4ae99c8fcd1a1f1b891d2981ed464d92f1195eed927c410bcc91a1276a0b223d23257ba77104df369809d6179a03837ffbf58188661c612786561607d5133de025fd67e2bc2797c704c0a0b233442be211c88575d63d67fbb69ebd29d33cd601600f7bfeb88b5762344060b864bfd65f34b36a45b9b2559b2c99e3c17c70bb9ea3f4254b6e07c7604d141202fb3f86c8307041b3fb89c1cd5c3953e6d523db1e222d528e726a7a5b52bbe1fae4902d189f989cde50245df2f0050eb146da728d2f0a77cb5b818062fc7ff6f0d6f9d6e0aa3d96695b06587ec4329b53ebcd233c32c83d9daebe78dd931e4aa6bde1046ab5e079e42598d97d8fc74e6f2e546a395f7761ccddd206d797b8b7bec3d1493d8ba833a35d5ffe7af768527b9f0cbfa7fb3372dc2057f693126f63cfc23e8ea97ba738643c69d117ccaee730b703eaae66c11cdab0b7597a1c45ca5ef1a1ecb9a480697c1d40f68f4241207ce2ed2a40fcee1bbe0861d0279dcdc9f64ece13703721e10fe5796cb231a70e179479daf73275db921917fa9122789f9a9f847bdc9a0619b17fdb12a8da81308cf56befd805dded0fbbac109821e667f08ea983583ace280ab3c375a1467f15a458056b797a28f896383ea1414066b2f80396a355eb44798eea8e8eb8dd1f757697bad67c959388e50a7b6b5b454ec01a69dccbe4276ecdd0a61ed1009098c014cb5f279800936a138eb4b6a02139dbbd24bb56645ca47ea436a8dfd9e85083da71518fda7d246533bbeead637e2c762a12a4541dc15c0725bb70978039612d67a68d141d05026b79abfa962383032b2a03712b1e59cc00a86098a33ffad8ecd6f32fa8b6b4ad789fc19f7ec8881bffaf507767199541b1da968087af0b27ecf13fcffe39224ef02038fca4af00943d4a980465fb1210f36b4af7bd54913acb021c4d475b505d64156d8388e748f3d730a8a5cbb8d8a0ee0ca3cd9ffb13afe052878518bc849adc2acf9b22d7abe54ddb29e73f81a79364539ffe7ae01f55548675132caf58b2eac5e39f5d2b101c69d0258290c63c39905bbc3b22554578c4cd2c1ba90bd2c4261f89a8178e4d3715b02ca71fc441a01de9d34d451148cc55127b6bc2077697e2aa51f7c337cd3cae5c5d458706b752db1b6ade5de138fd6cb60d3ba3fbb97b0de736f494f8fa44a8d3bdf4ebc10bd18ae5b18f0c727568cc7b2bf101475ccdae8a7bd1c279dadb1954d0473f","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"e51cb6d05ed027db058edc159e71b81e"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
