<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"8564e5ba9a1497e77e6cd9ee93438812055af0a4c30e99ccd2c9e618a3ad1f6739bd806382ef101a085a14cf32389b938f2184c572b8d02e6b7c8da41779eaa9c1af1acd9b615d6966ebdbf25837f452c525ab6fe5689fa743f5fa9a791b715716582593eaaf1a2e77136e81e6e0c1da1d74368c94ae2edd5577020576901be4f6e0a6d1b9611f3647d955358002fd79c39b37fd6a89182ac5a0a17413ac86d36045dc9b8c55f1681290011eb409e52b59e014288c08ceb957b24ac1ccf167afd62b535840a869954b0ab3ba1a5723f467c3ce29121f92f15dbb171926bf0f6ba735d8ee3a52e46a83e660b609e74872abf98091388e956360a82dc02370df6ec1ac5016301ae6feedff24c35634bd2a6a63c677c4d52aaa0ac34bfdee6872552482bbfdbbc8e6c64ca32c3057acfc43b25b8a7c77e9f9aff5eda55982cc30cfda2c27bb5fbae8e00393c2d5c11b97e09760903f9b3ec973592e10ca79c28d4f5fd355ce9695c7c3e7a7edbd5df0632348ee4232916be0328495e4f9bbbbbdd93641f487d6e0f75e2c974b4c3108006ceca388e8dde0588a201b5ea56d2392de736bfa64e5b802fbb83cdace6d3af490f387cf486caedc6f01a68cefbf2665d4bb9ea1ec814cb367a96196975c8a83b476c54921eecaa4eeb8695d152bcc65332ad80929144ad9431f8d6e7d3199de73429b2a5958e0e0edb5ea0f8bd88afd4dad5e36f8348d90291bbcc36838f2e05cb7502fb41a1fe0cef881ea32cabf2f4d2eb6435add5ce789ca1391ae83a3803a64efe58f333ad194cb3196decb410afb2b59dd4713f28b4d359a24e9cc8880544f05cce297d106e2d8540f24f26a479180c0d4e391076ac992f54d443cd5a78da0145fe365d24aaa0f9c516eb149c5dd07c2f32128e87a8d79a96ddfb4e48e270c36a69248f8c341dece32c94f649cc2be7c3a739be0cf4e96e81c3bd43fd5ae91fa03d79eb847ec2b8157eee4bd9e19034ba4f87cd354344b4ef974bff7dd7b1cfa1b5a03cea1dccb6a37f140c3ce579e0dc4f083008ad3a5ea5b8f83079d78a313d1b6ffeb7205d677504661478465f29c042bee6ac48c68ba9b5711e08d5e3aad2269dfa11629d0880be02b32590d055090240fa54705ede68f3027bafed2e3a4b1b648f6a35ff54803e5d0a58d8fb5931cbc4d913475bad275c977cbe16fd7d0bb15f14615540ae823b51618864b40904a3ca6c6fdb11214a0315739dac293aac4172c5bdc32c90a77b5b647bcdd5a17ebdf5b00f89e5d5cf0d2ffda61df78f334a3089f036d55f1c74c153f973cdcb258e8c2b5846e261689b897e9d6b321ae484b247c2ee44895d6e74845df3677ebd694c8bfc51b7980c6cb9f65b7c8c68f86ea3d2cc513c40c2f98f02f32a05fa5ee99b4a78c6bda6a88589787d3f4ec793f51d0a00ca96963935639d44d68080689b9f6557bd36817ec753ffd4b9b67a0033f2ca5a4cd4fd3abc3ac82e013a2a059e6965898802e6195f01ff72c483579f6aea897add1fe52fe217b5c4e6efe36d8ed8cd97fe543532ddeeb00b9fbb9d97a6589aaf0502d3dda27a7c7b4172a7436f458446348c6ff0541703e3c649784cd4f050caa68c4c16cf6f409907428589f9375b46fc8381c1e5736d5117cf5e5eb1525ed815d8419cf3e3d61bd84866392f62505e90b6dedd23dbf4a74be6e2ebeb3fd5991cad428022f74ddc5de42b19b42e829c9182f76ac719d561642a6b893de15956c4f7eb21061d7ad42db55406e7434f56426616bcf503e3d49520406a4ed3d8505d6f81fb1f9d5cdd3e10184de7c068f3c8cf3aedca7b29e721bb293cadadbbceb3e326f3ec59857a7d2a386987ac16ee388850afc0e3b60229d4c5693f7108b275c8f6cfbb3752d4fdc6e034ae6a7cf2ee054875083ef02c6176e715af02b4ec580ea3306524356044f8c21b9f5506dda0769a4e38f2a588b0bb009e1f062405c58c69c71a9342dd7d10a15e1510afdb4ae409055f5316a497b0d6a782af34640c9f2df922b2543bb14bfcf0d7a9b45ce23ba2c5a07a14ba37f01a3da836d672a6bf28efe8861b7188ee2c069864d2b539c5f4b18ecf0d20aa571dff7ff5992e9cb8fa8ac7f8f06b0b389a12ac6640a7e394b4d77bd6c413715533a1940acdee4687b233337d5a1535314b96c6a38257b6c0870da446dbb24e6a0163fd82adcd6a3174718b569f54faed30e8136351bdb7d989d9389f398c2bdd4d1e06087dde4b4d6215a7a1d39ad814688e7d681e93d581151077edb91512b98b50ef763a506d2b8f8cc5b0d0fa9e30e8c07de9560d6e3cbb4094c7ad9e845c2132bf664532fc39093f34ed16da3ea402ab9bcd2aa678ba5429d1ce27ba5cb5979a91061ffbf7b307dc78b4e2b13e7460e94e91df60313243e35793bf081aad825a6523f8c9d1b722ca7fee4756add8861c8b7b21e51d60cb697fe16e2a0746e991a3741129b3d11d24e452682925df69c194360a52c7a906c7d07da57f80cfd671d623c2b756787144098d5d6788b4e2159c75a8cff2862dd11e61cddcf76c711be41e38dfaf6a2c01e3f92dfdc64c93e6675cf8eb49bd09ebf244ed2de9fd714e69beb697734f4f9dc90786aca8379468e1604b567fc1c07dbf5ed3ea9bfcc59b95221d967aac9ef1e63676bbbe8a4a379fa822ff2620003fc8683dc71ce7f1a2bd945e8eff929cce8fdead14049238e8596b613bda1b9ccbcb5faf08910a71d5012d6ab46fd5163141041349201afd10b9c7f41345a541f74ebd70098835359ca6589485b365b4f7ee4c4a78119502da2e41c5f17b278a2f3c3f0e410b1b785ae0fbf903e71e3d4e05ae3e2f82f8aec049a26d59ed7bba4e1447c5cb814ecee9b626e59a65f9cd2b76ca3268120d9d92583d35f26a7e124b5b3d63a1a99ba53e30f27cf6946d6b3e98738f5cddfce61d2b275873f9fe4be6b781bc16606717fb62c769e1a62a337e6f354f9e3d66fe3932701bc30aa095708fac36927ccce5ad30f6a07b3a06171bdf4b6dffd740be8be3d84e29b75242c78a640f67c8a026aa8d2ac0036348f489903a77df753e7bdb95668878c66fb96114cee68f7711d2441743b20a0fe1fe297fe23550d1a9581ab977b7e3701a71caaaa10368ad7ba4bd703fb6c98b20e12701a78a535ba323cd676026e838aeb4fb2a3d046115f83e5864959b09501b179ccb854b378b9f1972a1f5678df9f81fd7462def98a92cb7342b57b39c08155c869a2d416e6059a2256ad881782ab02d5e3e44821436c739668ef9fc1b69c9b3ef9acfba063500a4aeaf9bf15b41da0831c987050f1e949e85eec3e86a27383a6bcf652bca363ef9fd5fee8193a934977c2c3e41d21dc88b9457c8079322b5c9dd580136b233033c8f5c91ee548ff4885e8f42f22a02736bab2644b9943a9f1877bd9d9a02889d05bfa56b71401e9263c964b2310c05f89ac857a10681c7c342867a4badbfc0076bf7683c34c32b43ff74da5fbf23d57594ad1b9d0c9330491403df9daf6d5d49843c8737c563cee7f3c1755b4acab7dba07330fa12d646c1a5344b27ecfdbcd30bddf0d9b1d39356d7616f70071a932c783097030278494f7ce3536c956af4aebd85af3286b5a4942691591929a404c3f343fd5206f08ea62916c3d24af90ad89d91530651a526697629a4185e1981ff57aa9af638f2b9b0d179ac4efd512d3b093256da666e1db9aa011710604e2265bf10eab09003b7c186e34e4bb349c39d09bc539ad7d756d50dadfada9126c1f52827a3127582424c27429add89aee0078dda0a53327fd4e96dbf6ddf0ac253f88928a5294c6ae057e6e22256651b8ad8cf43b4ce73a7e9293d8b71de36db57185290aaee36d2dad7198c1b0e3ccc847ff3db9049880154dbb1b159b5a2c7d144838785e3851f4604f5dc736bf19640693604fcfd483f1beb9bc22e3a9fa6d4af04cc27b10f75fe280d319456c1d8151d989ec4af070ff264c3eec136cfe6868fccd6879248b6d660eb1c963ea97cb00c93ec3c2b8bc45ec8c342a048b1a9262e6d073903f9dc7ef1e8c786b00f7875d9a12bbce90d50b28d7cf704c47b7877c3dcb4433dfb22744d6c1b066f771006ca8e86db337c9cd323abf32ac72598ef5a2af537b4c9ef7a31ed4bae7d2ffe1a6f9e6fe5fe9cd804977d483acc43ba1539dd698c5c04e5bb6e29d4adae33cd65b44126262ba02ca9447fd6bad91d7cb8532e39829aaf9fe3fa2f691c0b31f7fc30678be7d1075cff654242bf213e15070b3a237ec4122afcb90426c277302fbff695737c8b4b965160b70fa7182cefa84ae945145bf553d419bc0360a39f35288a5e6b92e4431a06dd7edfae92db2d3e818c3b6485fadbc0ec252e6d251321df54206b593a5dfc0e268144d2432640de0f965376707ab4258df427f632fefd4cfdfe799742896e1f9a00d6b75888c7cdc17fd377111041f9ffba56cd739ebbd763d3da42fbc0c5193735bda3978e206892f1d89eaca4e7b5cdc8cffe38d1d435a1ba5add6424bb0493fd9364c22a04d756535fd55908462276da6826280aa6e3bcd8c3d50f417ff5b5369ef4adf493c3e9228ebaa1de0260429cdf64174b8c6b5ae6927ee7c53f1991fe61e3fbc32dc8c5fc5814891c9f075cf4f98d469d0ad0fc42e31ae6e69313b5cca3b028ed8703e581ea667d08bc7390c29880e57014b02609bd994db1afaf389e6b682f1ae412dc04d1208401e29ddf9108ec1954537a06cc45479505183e195792cbf331e64727ea9a21fb11e196191c349a4aca98dbe42cf130aa42263caee963a07621483c74fc0b8e8aae0fb51d9c87ce8c6e639ec6ef8d5a9c69b3a13b6a54caf131b7c22c44b89e091a845771a7b148f34ae6438c95773de11c06c11d4164951e2550c82b1c8aa686da76abb6812c830c4dec9d691f07e0186d70c1eaff1dd787891a11886bb319a5b34ff0ce9d2631b2f6c7291cacf2f9db838251fe51b2febd6fd6b8d8b2d113d75c24b21b970c9e6f6865140b76850368c07a176bd8ac35b201981447c002146dc64181fa660e083ff7b3cef09d50c54029329c088b69b0a4de03de14cd1fb1e67f6f6058b20e7b2f972f298b0d5e0c727f665920a9c967923eee6d247746b4fac6073085599398e2a51b58ca7663b3eb39acb62ff5df67ec4f85ef0f9485d70fa11deba07018b87a9b6c76734553328fabff64f84ece61b29d7f042b95f5fb8eb84ef3002de6ef10dbf1790a94149548d4fb1a778cdba68d62725e93331dda6dff5dc7c3a880a88703572c13034a4a76155684e2cf1d4868e8d7b288a3ee0cd3b7964f8dd2b7cadfcc1eee3ae30c44ebf87a2b8946f682fe9ed62e1e7aa5e5f496358111c50c46581001e0ec1c098490f2cc1a7ba1b3864905eb75bad7890631717bc0a62d7a6c2539b9ad132d264ff68bed0d50a01266c767118e251f66dc62aaf9adbf972941c83d6ae59d8f6584ba2f1020fa304bbc2553fb437facadbae7f7b392104e24dfc06b3a3704a6f242625a58d2fd964419ef8a4e8a3229034ba0cde00819703aacdf506e526c5fd9362df72ce5669ef5a3ae580b06df988b128d5ab750b13b17e251677090da5f85c118d8ada2c9cee083e94153de02d9b3efc26e7466d4175a5a4d39e020c94038171e296da086b787757b304be377e712ed38b0a0ea837937403677abe9d3f48c92370daa6a151b7260549f7a47b167fd5f5af36c265fc8467044c8c4debbb37a39bb71d2bf653190b85ac51ca7bcf29b81a43096e2d7efd9c2e63408315351e4dfd4e3942884bfd5814aed5168dde7ebd35c6e5a43c8839de25b32f39696521fa16bf5f4450b48cdd5e9144cda0b1bbfd4785d81c6e40ac5b475bf46aa1039f4eedf8dc2840b79059f1a17698edf66c668d7ca6093f61cb4610a74fb7794bc107bdd489da719720f3fd4204666621cd824731e29de2b23d0530ee8b9fe3f4e5d7c47009056610bd110a384d0bbbcada0b8ad581864b8fadc9a1ddebbc77d5640f0f8d10b63a0c85c50916af69f17f13c92ed8f7408005c8f31c75d7a56cc19c3f815b37cb4bb47ba9197b177371d8da4ec4ebe69120bd9d27b0a90c8ba600faf8a1e1a9846a261276fe6c97c372ccd3265672611828181de5bbc6111c47226deeccf69caec198b5de73e88dc23a8d2a3dac0fdf764c2c8296fadab50d664c3603eecfdb9b84ed058225a314826d9b9feeba65bdc49d6f4457d9c057bde053cebb88d8a2dde4077e46834e5ca1c1aa3acbd9bab437d54d1e00528abdfb588d7d5ab3506416ba1fe352ea2426703412a3cf24f7decbf264db335af0e809e33cb3553e3942147fb2525b942c36f32ddd94e5ffde18a5d0434941e161dd8d7247949d65fdc235e3a17353e506d92aa8ec7630a2d0465cd86b11bfc752ecbad74831cab5b11bbd8eb1a4784545d9391c38830ea3e384d38db2ce266584336cf9736ef97d4d77efeabd676598646ab1bde3ee8c3dc55e59b09d8f9122e0bbfb26c85ea053ba1b62f7defe166b8cd7e8e5ec81e3bfaf5e779076f9e1b937a87d5c5d103eeea5a1da44563d97cc7c6dc6806f9ad41b7d7d3643bc3255b4c5d48928c4e408a24ad1962b228f6d3229a8bbd3bc66e162b6bbeed9976d6591e91f90f0b4a27237111e4451159ef73352271ba5928c10c63f0652d05570e6eab473b22eadc313463cf29ae8f1e120cc19be814b3a209b9f039bdc110dbf718216d0a39bd45e87e5ec62768c23a76b9d4f428d62bf24610dd93d3fe856b18a586656f7eb5b63243417c46ba0d102a89eb3a18e084b5d1dde1593b689d601e1ba09bae7a7eea0eda1153d798cb0f3999ca9ba9b1697f9b2d2a988e74b2f62b892ec114ec8f9438e956ec3025c41b0652778047e392d4556cefd3736c7b077dcbc8131a17ea6458e3fb2130280da4923b4f7253787b8a6fe8a9ce936589a39025ebe522298951e6acaa97dd371d9da46ac45eb5614100699f89ceceadce5434912c1626d7b38b0cee0ba3f97ca1784d209c3a1150947f8b3d59ec770cb871dd66b6ed3427ff2efc3ce15b3b74b1aefdb68cfdf35ee96158a943a0ef2d6e9649a6ee8a378662d7c43dd890dc362bf83c3f2c13035da5af1744636b1a1ab163546e5d97ff83a9d76741439ceaae96f3fe520d0b9447fe45d709651d349ffa9f437079d010a280b7a92d5bb9c2425a6a15a7593a2056c809826236be61f86d7ccae2b7d7be61289e7bcf65fe86d7846716951c48ebe74556fb1c8e50999eae745c0877c894b2ca1fa8890877409fb1a75f9a185e81f0bf1ebf8ee08f3d0b1893af02db22b32df5bc66eac4d28abda199baba477a604a8e4266e481210c1cb58d15aa010312a9a28d283a8b04c69d0747f1ddb247405d1b802c200cc2fab39e90546cfc9745f6604e211a83eb80a276dfc0d9854d1b4a1aa9d085b6a90371d6351af493b2679f7bdc40af47055be776a818acd3fbc1a0de2fe8f03e4560ac490978853ab52dd0065470f0ef571ee509d2ebb0fe15edd0b8d17cd424274be030ad27534ece8f51523761e1acd4e5d05f29999e6a18c45ae99722bbb12405605ec9c838505b4045aaf17e8e0d0b0467953cf6e38714035ef36381edac91fe3678311f284e43fc9d011b0ccb529597075489e35c6a65d5d9efba51edb9dc86eb76d1ca236343bf1c3c3ef6563602f716c13545589abc09edf821ec407cf5ce5398f65e7e5167acba5fd66e89fb4b86dbb836d6522e7856efc57397a4fcb46ecf20dde5ce17deb8e7dc515ae2a0f9b446536ee61af97b71cafbac55a1cd9be7253a850fdf9eb677c9be6c8112d1ead5381d06e168c9a4b44e80e2068158c0b2f5dd20571063f0a53ad520383cc941011fbc83b571640d9b5321591dd5c78f101d1fcfd71df25f70aee1fb676e8d8c615165a7d81f64bb7f19062c83e481246e7bf7add036d1e981583224e8212aad8381edc38f8daa49e44f16b668ee0b879e4d7b1ea17db161e4a253e5006aa92f210f75d98e3e6f3a77f27705c8b425659bc80a855ec5bf94b9f8a056801e1c85a262af9136d4f22a2d48169e9f55f7a5e07480e1681afc9e52b92fbfef7e112737396fe345a13925445cf11ce92d82ae0b7c1bdf9313c97646399c56c2864ea1152009898ad7a1c3d2dbd9863f5983266e526d0db58804a36a1cf489360d9d3f174ece3197466b04da0a67dd4ce5e544902e2e5e180b776875041dac1ca2604029632968cf738821384d53365e01773382eb234f9b66decc593e302e97e8e41e5b37c245f3f4142f26fe6977bbecca032e4934ab2e0b5f1d6a6988909850b37dfcf3d23ae1bd45e0dccd33d0c9a1368d7a17564a2677b0c5ae40ff79224ce819606b62f965391566e83676d35c5b9c5c00d545beecffe44ca150525853755ea11ec5c29b7eb5c29a491daf0dc0bf895548cece987381c4c5f20bfdc1daa2170ef6fa86dd64561c96db9f8f1345548151702d16ceb9bce2c36b50040940ea34fab933dafd76f9bb686fd7f00e075811f0508b05c931a4d4f3574cafb4d4cff9af68497539e08e9d32468bb027d3468bb8819cbba5612ad68f3f84571aa3aedc07e585f220feabbc7660a55bca6a4c4a3b6cfb7d18d661966feb7f2a04e5133b69207034ef1d6bf1a8083018c894338400f5af056b3ac1c7d9e91a800baddf5c2d393ce58383e7e40e878ba3604fe8333012a0ad56e6724581d67dd0fd8ec4ca0570283baf5f39673a77c1ab8a76ed70ebac636f5f31c7e3cc47009e8afaf8a5b38583e5d311e00361af24d6f89aa39eadb1c6bbd54e7f9460b9fbf91b6ce89c8597150d4a46b8c9d1981c04e91c695e8829a4eac7b7588965a251a1e27492010bcc6cd92424a8d85e16387520b47ba284a1e89d9fbe135f4e76bd4b2f8ed9f66eba6a85f9e504bb29c4c82828a5baf2322d60453a00e97f8e7269959d94939dba9572a237bfb74b314a11f6c841b92cbe160fe60b5ef304a54c92fbf7028fc341148640c08e2eb639f9577fdd25634f64f5f557c641b5393058764c77db4201695aff50afaf88f57d62b9606aa2e638d76d3b23bb1c111fde85f4d3ba574c35ac355a250f159ba3b05e470d80a10996b78e7e92f0221a92526103974ff4636e51c96b0d891713c75a6c0490066090842e2983b1b94081fe78dfecc9f0ad4ecb5d7d514a97f28175003457c3e2493dc08d4ddae3acfa3dfbf8687a01130698fa176d48159aa9693f04ca85c62a488034883d2712a2605d8cb4500275f9d879ce5b423d1fe1c13954d1c7bd40ba8254b38885dc7f46aa130e8003e19235be40c65a9ffc190cc7175942ae238d38b0c6333caca229655749ed915c367aa3a146c0f26561480a388c36f2f2b25d565b7d2d08eac0ee9617bf2e687d64ee0f77de3e369c1d6a3be5055f66da243b4934b9a493a8f6fc2dfe1f5c730f4a04eb43094e7fdf515a21c4f24521e6cadfdce197654c10b749d5d1bf5ac51d13709dc24ae5f2253fc5ef04cda14a2494f0a554dce57d61db160f82faac8573abc03bb6bc83ebfa412579e5e69b86b2fe57a6f273f39f2aa8f9ecd23f3eee99cbde4b8a64fbdb7e955b14726b0a71a65b3d52dff53088a6e49aec2c213073c3bb46178c5998d19a32bd86527ec0f405a5376e0b1fdfb3b4942732a31a2b018523758c46976bb009ba5c72f31dfde4305760fdbfec6027e39a002282525cf6be222beff984bf7c89f39d6d95aa520d2038510fe5cc206da146263dd6a95f1b53bba1b667faa805dfb413136870493b19d1d3d27843ad9eda156fb0ea689f0c03ce9ab619f7767850cf0791b00b4017a96f95ecfe58fd60e3a42d2774c47cf2e224925b1dba99a3e7daaf233b5e19f8e4a21ac543c800fc3b22e27e94cbe07edc7955e518f99655a0cb945cac5f6385cda59080bf51b0a91bdde8ba8137b06a6e69aed1dd5d09f0329b49a8a48c5402b6af46775c54070836310a7591db8e1c4b08acca014783410895c13abb2faf070767fc2495f31ec0fa8ee69d75232bb7a31a22b4484b20a69e95007e3cae724feb091bcab29defcf3791f683cd8a8a333c7e1282fca995a799d300a770fc3996ec2d6f40b7659444357dcc7fa3b893c3819df7321e3b4e40b156547e3a8c611d4583db9de243463ece9217a5fdc798d21fc051b84e9b083215a36b3be0ee226c1546ece6c56aa18b178616dc12f7dd092b265bc44cb4ba0ef3b195e02f8e032304ccfaa8a13ee2bd6c4641fcb020351a34bea69abc816932b1f1c83947f7a79de8f2af6754170a98a20ca156eb1a189c538a3e1ec3452452ce67b3010373d545149b2a3b0e5364e61a7c4435a76b0223b27db779041973af08639d33b197e2b87d05115f8c6836b6fd5b245e5171ce2cf6f8dd7b514c55c73d78b2f420ffccf6390e67b78d2bb6883f3c0dcd4aaed6b24f314454993b108a3164866315c331c1a8bef0ead5b0dfb8c33dfaaa82b34307fa1d50a342fee1df58ef376fbbd8b046b7dd22391b640e72938c96b766a52cc73ad3f61f5911fb38d36144e88edefdca3ec9f232bb3192b04c9adf8875178befb90134a299a910957584682210ff0a6c1160a2b3e4116abfb712c6b80640682a8a49701655e4d0d9ca989f7b6cdfa85b69990640594bdf3e1f67ed76d7558013119a77f8f7b4fd32b4d399bbc42da26bd8b05ff520947a9fd38c60add3517ffb88104fe1b149285a654e9d6e20b15e50d66175cbfd9bd361f017f061601d532d0f28bc3a2306931a2fb32b0b53c725b748cfad9ac4f2ebe23d92951ffa28ed26a1b2746d0689dc76869d3ad34181b5ec35f0157e20f81e7b1f149d63d131092fb7eafa528d88eeda31c0d4d90b9f895f55b57428f638b38c41bb6756f1650f4313e797334168570a429f16761d6a0d28dabf612df05296be0c0213c41b233e9c48575b22074409aa7dfc1d20823e495ba5cf7d17ee57a1f50b5a8c918c3084d2d8d63e116ac69e199756821f466e9190fadc5974ae5c1843423c0606c82bc3aed4005e69c38f82054925e5851d2ab7eedd786eb7bf450852c234686013e180f3d7165ed57ddb3895e908c53e623ab01f428e4b8a0eda63d57a863043323da5c62b8075f842725144c3c652b9f7ec8f7706c1bbdcb35b275a2e545a6955fd9b048343aa8a9f4fca66370e4c4989752ac00ac6881f1fff8a86c1ca127115d7c75d5eda9c74a76ea1663624ce17d86f8c310e2755016cb41376fb62d438c7b2fa0fe25fbfc432a672383be606c13be85b769abd147dbdf91e520fb91f076f1fd32d1ba26dc248a5f8795fe63357df2f8ff7735f59cee1ec2634c876c55d9881f1d1fecf6276c387188de9e81105eece555570407c9c5f8ad1e59f82e6cfc75fc3db94798264c5bb7936cef0a75794202e20bac37f4c244d590cc110713cf8b2b0912124ea3f812707280e893ace074ae70f36d2c44256014cdc671ef6041496aae8fba8e101ec929e4554ecdba2b9d8b2eb3896544a8a5f0944d1608063ec540fd0abb2749d86e5051da9f9b6adcddf281170f6460f8185319ad51cda4b6e4e66481e18d9b705988e41cf54804cdd07bdbf2a8fdbda33fbb30812a86b2e07da6745573c47fff17264215ef13eadfbe99ee2ce35830471fef6d2994553952c2ee4e90797ada248b6986383d669cb7b1734414e32889b3d9308237b7e5cff6d7ec857c045e4647be8d1fee030bae2f0c6ed077c8ddb0ea543b8d519ddb40930e16722b6afebddd62fbdeb6e708338c5b97dfc2c67bcfcf04cb78a1568e9eff26ff02cbb470122fd3ddea094b80f141e68910843f2b0d048182cd5e79e0b5dcc84d69fc86cf852663d1705da615208177011136139039a25ff62b3ce700321c494824d3d22120efe1a0a6f0677127bab38b212e258386415ae48ae6797696642fc12dec6c7aadc8d93f7af8b549bf250fb0b9ddd85d0d29d52f591314d09ef6d02e2f600ae8ee86d5134946f969febcbfab1215dd1461b0c71436752cf4b8bcc49fa5a3e2c28c26997ca729f4fab12ae22a26a3963fe55c00b5e3bd5267d205d21ba1761d4f2edfd0f7a769d479a6552099a8a810282b5a2fa5615304fe3fe1054cf4620ee5b60803533c0284bc0be89e63aa97adb85bde1161e12722b798c55f985c5b302fd1888b4493fd03d98857d6a629ef7b273d4be98629c5faeed943348c0f955e36f710bbe7030a8d55fae3233b13c2453cd9dfe4dcf34e89e913dc910d3a06f88d483636a66d38524bea92363bcdbc9189475bbb162ea6c7d2c8b492b60e0d09c66436884478dccb52598ad095121aea2cd586adc18e327f8b2b84931e776f03ae490de10819b68464ae4e4d6dcb01cf0aafc314029c18633eaeaa6db4b6bb804405828e656b309e090a83bdb27480c2fcf46df0673e53bceeaa9b9f2bcb17c1698a7f15e53dc8900e63f19afd16fb9741a76dc162b91ce7a3211a74f6ed0baf4237720f2c1add23f7b243fa1058fb850cbe46e9f11823bdf40632d1f0a798fb5e66010adc8a6676ec93d0b6eadf386018e20105708005bb20350a63754ec94d103ea60d34687c02dde6f043e0655866ff67ff55b90a1f5a0ef0c3f98623ee54cd4accfe2cfd31da7cee8343a9c713fa4a514e6a76246fa63c38f0ed608b7697c8bf88bcdf29090c2d2caf41ba7dca70c0f867ec38815dd90257fcd36fd4e5289e4ff4a9080e0031b6ee76e96bd08418f4622c7ba5bc62ccd6113f581d840c69b86f94103d80b65d368970362832aab8cbd625b24eb55102c5d83c39f72e03f670beb7385796c50f86a89054f12dbebc5cfcb82724accb3ec3ef947f921dfc281bc21917160272efcf7e1fe0726323fb89854a9249a8a33b6f2f8095a26da163eafe442f9503094de9ac1da6166fe90ee6527583ff55624afc6a252c9a4d49007fa722328c12d2605a1fda3ff3693c999357922ca6736378feda398dfbe4b1b8a135c65b81595a0ba9470eedf7839b691de185db666ad7b83bb15ff347008f4cf5714cf220ad8bb302b012699d65323420c30623f94a478f62fd6ac0c44fbacc593317c34c47131cf5cfa473accec68e4db110ffc8eae421a977c38ea5aa50d0209943e990f2636ea9a6dbc50ae8126f76b1a1a6812e3451fb72e2d8bafa9ada98af6e157bc794a1aceeec6c987e93655cbd1b830b1a367728d9edf634c993ffe1f2ef1690767762d5f82cd8af6d2b3191dbcb757aa19b7c2b3775a9bdd2b8d9ff82392f125eb28f5f67be1cd61b93eb540732f6a6b1cb38762d3a239232b063268da3def505cc02db42cbe3dbde9fe905407c4a02aed3a2643b8078e96cba2f42eb053f792ac21263578bf8e0adacffbba5b9f55314b97ce5cf57c60633b1c7c9458e9016f042006b7bf196fe91eaeaed66c058bff6f7afdf7cefdeb7a4bdc00d5d7a21c87123f329c8a861e9b49f7908b396121fcd690f015cef32ad8fa70bac8487214a5157b4e93f9dda7e6e9149fab320fc2f68e78bd0be582a3b6c9b84f5dc15c071a4e83c2263b4788051e1a674afcc78575895e88debaccfdd458386044846cebf75860ef74f290876f1d59eb59aed68443a2a8e3c88c5bca53d53fdc7b52b750256fb4b1bc67b271a595bce67a8f02a4058e3651e3a69e91d6a60666ff8d6deb3cb980d384dab943c70cc0743c926fac2234b6dbc82de8609ddb02b4b10052ee0ec7226db107425c8346ca09fb3f0774bd1d474dcab2a29d763260090b95070e002e49f8f8ebd1197d440fe12b9e01e2ef0fb742d34a788a738596793c037e13d5a26c43b106e743c0489f176a57bce0879203160fdadbddee48f4aed7de6d8973229e3bc1c260504d89dff42b24eee9eac4236e0f7add954397550d54069cc73ee3efc510f837599e671fe03731c42662a85ef69be8142a9698c7d416c0117e87f7e713bbcea9ed0062e9a56f158858b5dd518135921cc0fccffa6286c682ed976a87d253b7b23f2665fe589ce416f3006b35f34a718a8b472f81b6aed6f065e01ef3101a34c1a95b94a5c7856a12df856b98e31090911b5ae83d0e9036c084a7762e4c01203abcebb171aef9e1cfbc98d6b3ca5a53c918bff7720fa96e568974edeca7279143c0bc72ba6c47250786cebb936dadba44800760560141a83768b31d053244558a51376aa24e0a6a44d133b71c7c02fe297dce4557fcaa574d44d6b63a50137b3e3ba015dac7699c800ff6f39248d8cf741c8ead9cfce2d0a7f2343e1263774c35ced0e077f33cd5380970b9dc84c04c3279087e417597edf8d96adfc38f6a2ad278abc8886575d83d0dee872118ee8f07eb19353d2e40d02d660b4ad055744b04f5f5720284116e79bc4ecd6a2bc5f4c05365c89e00155cdd43054cb1287f000a101e46e67f1c45582a03481143ee06462e8caef9c57ceb7cbbe6c213815fb6b7905221819fee5ee5e6e9d1ee5afd06a85c3efa1ebc97b37a6f19195ed699ad5ab401f2f19013d2373f1b7072923ae9acdb5abbd947106bcc31c98424c07b0f06b6d339dc1b0b2aa7b5ddf02b742af479eec5515e763ae52801de5e67d32ff59f8cce26b868b1cdb0799f6c571d9934929afa7a23623b173db877fb9c606362f60dccff186f3d98313fb349a6a60cfae8f4ed8015f46461a18bf47e1ecf9ba7c7b46fae6dba4256d4d4c548b573fea2a590c15862390e596e6f1a9ed1d84ee353794b7fd12d7f7da51131d49cd38537e82237e2bacf34ced13cccc83a59153c2cf72c9a88bf8be46ab1f08fea18e53e7eb9852b382a38fa5aacd422de794ec11125d93983469654abb3944ad900051fe9ba0107ad1f23469f67de88a90f1044645b355b15f3e71927aca34bc2430fe066f9e5703a8163b0b9e2bdbed9f0312dd9d053312b0a41d5d7809c6d144ad9ada2eab1df86a20ec275938f9450b76261efef9899d7782a9e0070ee8d4c57e5e1d05b0cdd2d5c45810b46c90b755b16623043b599f999f075373889817cd9b2890d9fca96880cc538a031e2365658b7fc258bc1922c5d98f5dd8b8ba8654b77726a0012fcdb3b464e8ba42e556893b5b19282db29412d1cfaf5bb15ccb1e3327a9b6a83cc0856bb1b3123eb6f0ff87e504d19e93c2bc28","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"3b65e88fb4aad2a4dfb95b4861d2091a"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
