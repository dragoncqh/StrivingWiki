<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"b0225f6e7dca3b75721828ad814d6944ee8d3d35f0a8057685440ca5fd4cd43794c0cd034ed3442805395e413b18e6d84a8221c699fd8919d9193dfd7749c6dd57d951925321bca941d5944210f537874365ac8ab7f8fc7ee31a67b956be80c9e0b9afa209ae754d5ef4201c87c76ad815b0520b28bb3ba83e812db5df220a220e523e0c105b9e2a5090beb5d9828c85423b8188d8fbcb53b992232b0176ce204c4dd027039fa65201a1c985369be074a02f3a50ccfb01e49e6c6ce4cc83038c88ab7724c4e345e05756238ca9e7d991b15d05ccd89ef224920ac9e3424d1d9a30198d96c3f050186c6c32a5c4e80859d7e907d6b5fe18947933d5e617aceb2f7630983c1c4279e14090adcdde252f68815bac74b2303a14f33c7e92e43ec3917e6ba483a80aa1935acaf75ea43b4d21c7cb3c1668f4f94e4520b072603a7a339e0cdc1600e8d67ff3e20f25c50bf7f6183bef0fe036a820e6ce265da3d98dda42eabce5295a086cb5f032aeeefab4d3ec4645ccc119da02051b6ad5ed4194d1a5ddfb98e51f674eb167581c2573a2362c1438c9ac4e91b8ab9781bbe572cee9c37701c5c4d06e8318a93629e5791869037917f16869536c3151635c282f185ff761fb5bd65d57a0b31845afbabcdadd6a2ed077fff9aab83790bbaae5a70699adcb9bfe224b54042b8b302c8e429a61a16ab3694a61995f1a61779f52a38131f70286653f1db91c6128575d85e8a9828990cafa300cca27802f22b47382e48685d78d0097d7603cec4405e2727e539ad193b716b2eb7e891691dae1be01473f8c3f891618424440ee9113dd32a27ebf44c4768e27ff87448dfa872581003e17b81c5d344f9709b1be4cca4fcc4e8f94c39490f5a275209ea4fce388de159a536c10c4e3a0b51438e88004a1152f1d14e64b8611ef28ed48ee5227af70306e3f303673ae59144c4608c7863cf813ac78da869709e02323cec12a2f5fcc7f64a64749863b80189f3b88ec73ee0da0f915b63db293dc97144d67afafc5615686734244ee989191e889ec3880f206c72bce2a2cc2e35b6c7c4de2187cecd8a189554b6a76bdf7934954c221c1977e3d05fd06cc59e652af80a9c1087021de84e6ad7209de7d068b8034fb651310fd2346ee6edb9bd8ee6de1530e91d2c19c81f07f0a263654155eff1e9579f6c49d4e238138777887c3efb955ca2d4afc4acf761a0dd8a72d0fcd2a814f16935f033e220c1fcc8c2bb55459a38c3cc686a42a9a0943e3b3b8c625ffa3cc28b626505aa813fd535eb49463858d404b041bf658998f30ff8ec1dbb56850efda08d7e24dc5409f2a65fbb156985d80693a7f311c35df9ddbcee6e02c2c1c42d50936f6010e99980f58e7e2171ded23fe9ea8f0cebc4919323461d761e80e5a44537d1fecdedb1df96067b71bb22eccc03df1d22ff013c7ee686c9ddec65b9a10646cd52cc3f6457c239036bbfd5984f467c2603b8db0fd556a10983510f0a588d31be714165388ee658e4ef2ab075b1486bd027d3e02673d0cc8c74a9f5cd9da9f398c054994d2ecdb0dada90b988127f13594fe2d8eee5c93cc7770bca6c6426ee44dc60b33e321b6c6e43e1151f59c0dd1e56335e17f30bb649cfcfbef2a481c9a52cb5c91f8639ec0a4aa0057218cc36dfe47234a4a994952ca485393c866e79322c4ed1eb38e85ae080bc8b3d999fa7c98ee9d75129ae0de765aa6804f250f2f8ba516d718971b0f0f820854e0f2cbfb588f25b4729f0bd30c55410fde97b9828ff8abd2787eb6481d650f8a0355603c3ed0477a50fb54b75b59434a82c23e54ae60cc9d3309bbe3f3899683e7048ed75fc0c8586f81c55307e93d8920b23a137db82d3268110f708e99b6d903caefbd590b6435f9349043621922c5801dc60e4c5fbe4517d9824128d968526008c6709e80a22ba3dfc305fdae1e457badabd81f31a7cf41bea194b50d2f9f20b438c85a4ac5e858af02261f4b1ef61c84dab1acba3e12e6bc8421fb5d9d43be7206698faec4fb36282ad236ed4695174cb5413643f3d4c4b20f7558db600dcb081ed861268413403de7ecde08344bb555f11d4a60c8233b1a7d385190a4f1fd6ae2e4fb65de30550208258df9e8917e519531522d752289cae7e2e98779f80d9aea365827a4e7b8e7c37479ec191223e140272dc6e1b77f3546faf21a1b8c87e917455f8964d24d7afc7cf5d6142f3c3d454b074ec077d980519d68da1cb8d6e499ec50627b05399c24ba0226677d997913615533cf8de62a11db758901f06aa0010134e66877b9c38dd36f0b8d88bb470bf58fe77d5a3a90f1f40c26de605d64cd6e4cd84c96578b82ac950becd997c848826aa84d4764b48d48fa3b9e239b51c1dfde94005830f4f008fa42b123e66a0243a2400204e32dcd3b8f83fdc0f3df1ec2189deaa4ec0d4b9ebbd4182dcbb88f4bea6f32b864f0b31d4132c0f129a334c6b6bfe7b949611bb2179b35662ed80d88c07099be5c37e6d4c5220478b442c1ff851c72b1d03a669bf625f5aceecc094331401a5643d8b44b7fc965eda887406c6246f86da78d546afa34ee95ef5c69bb7ff53514e3d5ee08fa0d45751a37e3ce3ae8bfa7224d28124b270803c1270e70d0cf710d2f4c90a26cf52ddb0bdeb9fe0da9e83d53ffbb8c82caf3205b34be85fc6ce11ac7ee0fdf7705b4d7d65cb83941114d4454f55bd0f88e0f3f2e52137b9dcc395781e96b907cbb5a9c72770ac4545c1eb2dc221abf0a4b546d80b45ae7098950e717968a4c1adcd37e9dae42ed2b4663c12b2453bbb0ca0f802f786637fbfa3cf8f2eeb870edff2abe859ceff4e60fd87034dc3834f5c4e2934c0998df7f7d3fedd8e676fd2d55b272377ae712f95761a2197586a0130f1a36d24a9e1710ab936e75a446a9d9b127aed627365aa05e94a8530e6a53dc0d2c5dc0b45c4e52210408dad44289660f6487415b881cda641c68f390016162a6cd787f52b2a138f2c84ccfb2cbdf5f8d33d9885eb5b3c201712acfe5413e544721aec45b8d4a2bce85a11cc3d8bd6bb62ee55e364f562f5bf5f7603d9ebd1abb3d5ca76ce983f91c1c60cc1ef2d64a663444bcd3d3ee93e80e0b1c2d820a61062d0c2d10b66cdeb154d6ed859ac76fa915a6c4edbc1f658dea1734997484ea969e13cdae8a05404cf399abaf33e377e64bf044d32d5ac3093f38fca0ca9b0b389ef14636ff072fae880403cb87fe5477ad5b33797facb2004aba4c70b61940fe00d1e55cc379e686835011073f581956599f8a3e5eec902a6fb5eaf4a7d689399b6d298769eb1271670bc13fc8772bef6bd85577416e83f545249743fcf99168c3e0fae395edc40731b258c4248e0a651a3801cf3805bd3ca08e265b4de24af5c391aacbd545239efe89d3a980132a4034e533ea02950482e9c3956a9c0ff652a284537fe280f32c2b7e54fc96cd73a0f23dbac72fbea325e7ce6cc2a9dd506cb752586529365e60999ce723737c57e07a33fc8b94358e095b398bc78beb5eb1ec8b982c361d6c0e84938b2c3710c581dce2e010b20a508e9d23daba079692985174d38c55c30b4e7f485e6db677fadc72b748cc134a2f4a6786c266213ac899702a091be50db39a4f89eaf58278b455abcb758212250acb55146ca24ec4f9e0606566674fc0a69856a04c4d93da674fc7377d2e691293433d7fc5d6aa68321460f83c2e99e680cc78365a5734022967f55df0a011b6a082fa9c24f07230e6eb4e1551b45ce5a215ca465a32f0d773d467d95442603c1ce0bfb8b15ceb2f3d3b29e15c084a13d74e59612a6697a6cf24e024c3ccf667de39b7fcb402c7e4db198fed224a7f3ac9bc202da0ee16e0f7170f9c66d82876b39f99f1c207c0468ca7c08b8ecaf895a92a4884864fda46c01e78297160ab470cf2a5c8cb9ce452c5dd6da2123e1bc202361ef63aa848664ab403dfb4b3c6a030b84a849fe69c25a11bb2f61456bc8ea71e481987b7b41e1ff174117d7d4bb693a17f43920e81e79f8c836107e27ba98380e0f1476a5a3e6dbe1873e40f040da615cb1b16b53e317cd65fa5184fe07cee448c2a98dc33dd089ae3ae4956988a6c3088cb9b771d29c93439cec0f66f09351944e87c9c36216cbe7ef7d3127ed229e6edc34145c54d40e5dab30a4c08023c74210c9578333527405afbd6aac0b29a559694ecf2f9aebfdbb104cc005f9adb859608e9bd358888cb0d2f3622e907f9285b8a6da8de1178e9178c36d49f2b9be40c18af12744e12e900e651469962addd285da577d63f1d063dca4dabe41b8d06e8138c08712b5cc528b607754b3033a44be45c449c6a690dbf9e83abb9cd0578513cadac8c059475869ce94eaf5328b3d93c52ae6b8ce1b6eb4fbe2f6127c96bf061a379f9df5f2ef376b48fdb3e2a2f67fb126d71abb00c513e6fd09bb7ea7a34805432592b9bba7a3d10423cdc3a7fc0583d8a3c7544d9a90ef074d67fa3659ee3c6789ba6b5ca92bbb72220284c67fa8769335c0264db03e07b27647dd7af95f579b256b69daf29988dcd4231746077f207040ba78bf86d98ae174c7ef0595ebc1e2c67e2728b39970f4dc530bf56d3936faf8e753040aff43475d6213c3bb82874b2ce9ec2a7d648e7c3e8b6b42cc5b1cfd9d6bbe6f345716f01289d9ca16b1ee17f958008e27f88a8fc7f5c440ee4d850114fe90d26357dff83462ac0e21cf806fd06ba21f7b0d6365b1d3f36b466ca58e9c6fca42f561669b6d81644577ba74a2de721aad79889537067e80bf5b78b06ed5d5a2a3da850f517d6e35e45c613969a344e7f56d5627fdca5714fa0439745fb1ae3ac0d2fb4fc05dd5ec25ed0fbcf411c46c1cc191b56c5b44359eed5eb7864d93d80bc8d0c2212a75349409642da4a6128708212c4250492eef5980e590d206bf7c313d509a04b6eb8da8eddd866af5ad139a2e850edaa136af3af7ce7010757c426e7411575152043c4eb066755574b52b44dec168c07a486dea3b9658b487de71eda7f151ed7f8c0244637af91d84c0a0ca3189f9e48e283d75a0e052eeabec69c1f3e2146c21ca9c0725f229fb1d1cb0104fc1c63131a8e7c50dd4ad1a7c2c8d1625d83147d7d0ceb300f9cee01b61df47ecb41b7a2f0e4724ab03f3c054b3ace8c8d7eb31a0da1e8af0cfaf5fd2d531494224b737d5d8c04e32f8abaa0afb8dc3a48ad3d1cd544cf8c3419ed06b69a302cf002da0474be8498244aab7d2c9b16bb94058ef4efce2e0911d95e8c28fb7613ccc6e70a8651b41eb81b074773545d3a592d16436ed6b64eb587cf8e36947a9a2cac8025d3c5f7a346e2348291c1a7cf2ee62bcd5cccb46879b4bf955e5fc27307f16927464083d1f4dbdb0cb648d19ad29893fbf37d62c1534b6ff87163e3124587ca24e928b42af883cceff24350bbae27a5aca1614edf6478a3d3ea04c9c839c47c65f6c9b3bcf443f8c05e4b7f6adb42d1144c3a6b0a4890170a49bb8a0bc8626e68415915bf97aae5f9027313222f7ced408446e546dba0e1e99e32c7632a2f38bb7626720a7271145621725a5ea79414e844c75d6ca5f886a94ad735f86655799bef35fc4584020d4d89099e67a577a5d5daab6f0d3a0e011ae25d57e9f562166edfe5eb83e83f2b526ed89e588d63dc04aa3a6e1e32f003cb02aeee31538ef2c190547ff3a9c902809c32a552c0a72bcc8be7963db54a73d150185654a6dda910de0e1d52baab526a26c6d2ab8c8d0d190d7cf189e24b1eef13f20942284d1cfe32999d0dc9b6e9e3eceb100853e7f23f73a0cb557db5d1c39cfba5bf374e401e6236711abd4c34e5c1f3ab2b81e09b42c06eaa45bd15a78ee582d0d0cab37e598faeafe35e346071b151b7c6191ec269f95b23a5c4918b3ac710733311b95a7b76cded92f51b5f386b1e10e1297d0cdaa5e15e4a0ba8eb8713d612dc6d6dc48238f51851310dd145015e25d4235002f5fbe6b5f26737a40518f7986e4de4c47b13fff5f2f94549e54f807a6d49132a0be0029ac3e1ef59d1263e3386d2d0e9cc98274b51d0adb24963e3231b6488ca74123f33a5e44f32da3107d0e32934c350636cd83776f999ab28702f476eb74f7befc5ac6fd761e21b76ff0131e0777ab6dfd8825c26b63ae46b7a846f79f0d8fcd73438d29fc9d83bd18d448bbc84d87f284df00a7791fc2833fa85ec858b3551f22bb84c9d33b6ec3937bb20b4b41fc48bda583dcdad2474ff231e0424e81c14f85d9070b44ad1ce5161d89b64dd520c1317ffe502c02c5016fd92d848c3f72014a5f6bf5059e1d1e26f88825a29d5f679a1ebe5539f7afdf00f2e702b329c928e5e01febab4bf6fc5581c0555f551d74023e54419c9d084d2cf06f85b188f6cec847aa9cda77cdebbfbb47459c392224815d28c23d7cb7b95e85c2540c4f9338660a6b6b65b28cddb2bde95febda03ac7551bf8ba079909e92884afd9002a5f90ddc543c74d549a5d62e31f13adba711af59cc7822d14988abb00ef20f26f86fee8f588d03d7b9ac85ec40e53233db22995b5531770e648d44447f59c811fcb2b9a7e955d22c53830b19d36e2aeb65ef2b165297b0cceeb60e86e16d6952c7e0d3d6ceaf90f56ce8ac6ac27d8b29fff5cccca9151d760c14fbdce08c989f00f16379db7b3212b62126cc0045cb2aead3e52e3602bb689a9f5a67dfa05ed89798273b7feb12cbf26cbb03815627888391a1d7d9ea7e81de27907a4ebfc7523e095f4173d4da9718b190a15d8fb46179d35d013ff28b01973f6929ed322ab02ba65582911d1268db2d5b6edb2237155d92ddc074bf84f13791bc06b7b6af0f8d2a8cc1e78605397962cc6c43395e8e4b1c25e8819a815a4742e746a8527b54892a6fcddf7ceb561093b0323ea496900b7558455795da3da9b0e3d3e201e091eadf4859fc9819ee1bb3cbf336205b3ac21e260de8416694bf8852d4b7a5929fda719266293b95b0ffb83d373092e8996c2e5e3c8d3a08d5315f35e1f0c24fbf1b8d264efd6219f0104bf1b4e1c9d2e11ab5dc4e353a8c41c2411b0cd158c8c533effec7448115ce61579f7d0f72ef384ec131a61f365063ff72887ec25167c5974b458902a335e3ce370a18c0a577ee78edc222437f635e749a9fbd6368eb17a750b672a63d6198446fa3466e9c1b2b7120c9a606cf7b471a4f2d9511164f7be63a76e1e01885df7885d60248cf7a63386ca7de940f376160254166ab8cc17414a932e4dd346a8d86c84eb1cea11678395c4f4f1c6ee8a6693cd46175a812926a62e2d38ee96e8adc2668342de810e3d69c029c0f815c4c6d2ae5d9e109e6cf43efe74782831d24b07550997dd0cb2edefeefdb4964ac4c76076664987723d6a7a91bacee4ebcf706721b62f9c083ef77552e22eef6da8ad366552f46d5346436c495525011ec00571562258d18d63d5f981bb1cf09fd7c45f3b7eec386356fa3cf7cc87c2ac2eb84edac9264904004d2ed31a930e2b0ab97f761d679d9ebfb758db2eb67123c92f1de9479a8f7639ed8a82a35f54519d19c87c810a054d2f9cf7db1f6658a11bd97926e628a61f620eea62e1f3b93b520e3944848b26f140bcc8e613f6d7c316e941fd2fba020cab9592c5f5cfc61edd31a022cbfe3528ead221caa5610660f2f73938d351e1049e652404d5ab56f2094732b93c4ef009ffbf3f72827f4fe8f53fbb4dce3b2c248a062a2a39fa47ad9daffcf62c240969624b5659bfe2dd8557c641bbf0985d7ccfd24077279db8d0c5402858273aabc21049773627d3096ec459beee0a8ba1ce75ba17136555071d5178555d005502533f5730f8a52c9be0a8f37403888b1eb7dfedaceeefde2839a15e06dca464a8248a91f6559c8e0a76702171e1954c2748540422ab7e6643e591b06963c185f6b3b08742cf20ddef48fce75856ac63463312552693ccf52df8fcf8c66d588eb15433b270e7255a072d5665758f29f245eeef13b90b21b0511e7023cc4da4fcef8629861340d15c958eeb7144b9602c50f56b0589519495dcc616d3dcfe722904f4e0a71772776eb99393bcd4885108e933a3b9c810190421f7777ba3ddde5c0f28ca2c70849827c1193782f86ba171913e11fdaa4571be04c7e94d40e9b52edbffbe9ab9083c3a305ee10d749e65efbedbe8a1417572465ae785440bc3fe652a33ddcf85b99c673a460ad63f43ec4f64a9b34b97296d15b45d9fbe494375c9873885159edf711e16e87ebcded92a6279f1f9d7d100a1b1742887621a3af9aa30b0b3ef69eae8f475414f2ea8b9f2241edd10b654e76d755bebcdb7b01108874b7d7759b2764e1767de47941ec7be720262839fb0e6337f98411f6a0e6e4836f2915c6c63bb61166352c2ddc3e4a4fa7eb416ad8962e0823121b380616f0170e759377959ce4f8e1036a281efe98107305743f1a4e1360aaf18d234e7dc0a128e23d81561e1ba671a8421377f05d0f9907071f68d4cfe74ddcf8b3f4c9e14348dfaafe7e9d6f839a84869729adf42417f2b0d841fec8c01a2bd8f83e73f9931e81399d0dee75faeef15ed8e82a13cd8425429a1e1ea60191908907326c12428ff82b926d31141344bfe412e1a87db18da06464aeb3f3e6e68f3c22ba97b3241b168a0b39d67b265d9b33fc39f37b499199d860924600a868beef4a322e786bf885a5cff05a36e922334bb49f5d2b23de8722197c8961ab75fd5726f16a64d0a02d755d5a86f12b2c9941082eb2e40ed1a2d25d5419633b0d5d721ed0d96f9ca07dfaa324e6e2123204fedd8b427cb84ac6426c4d1c1d0073e57d68d458273d5c81fd60ffae1a3721acce487e431ded960cc965bf21ceeba6d970b225645c15d7576f997e22c3e58241b87927bc170091a01f5febccccb8a7b7a3379210dcee2e409a17e750e235eff9d06fac66ae99e86663e6dead73990eae0a0e36f881b14c9a3818787869de1e5224977456c49c96c79089a145970c541479aca486b417098405359e1676d944d4e7ba0547683fbad674eb18a8066a309789f600705c88c7f3bb5db76e3da6976a37d8311c1c5f6fe40ad8b852ad58b3af95357a92b5c742401db14f6d7ddf1a92c08723755c6efedafad47dd5dd732305dfe1131e88a78cd981966f084e23bf45b0e968c1990661d981b9f7ad51cf0465d60c9cad916013242c7abb0dbc7d30c94f4b0750aaad52ce435d08cb477712983046e8c799f239a312609b7992b9e38caaa6deceafccc2897086b5c673c089c4d3c4c9cbab731d9763a66b0aba569a7cf2bcc094172feeef56186e3521fd27ee1e867669e8f4c1051c231160a78cf351afb97522684e92eec0d0389f310eb8ecd4e391577b1456c63c1af62836e917e810ff956a5428a51666cdb840959021fd20f8cae1d83f142e3d104dd515bf2f35c9f2dc6da757f5b695c6ff8c23567bdc6ccb6be7f0a9d3e04d3ffe1bb3c49f9282faa5933bcb137522b6e07c96dfc001b0bc6dc8ca753deaa5f9748beea30164ce17d6ad1b8cd99615ba6cc036fc482265a0794e5f2d68bdca4382181ef72c726d53516c8dafeea2a134293e469e291a36d67a133cccc657795cc1fe9a6ad4bc39aad6e00cee51498029fe99cd4681cee20f8657725fd58e64fc8185f80de5851856d3f170c9b048e34cf5c29c6c457bdc60d80832d704f7dda7d78b3cc36e90b65c56b710c3aea0fb9594c1f132f411db4554bfa1b67f6ebc3eaaaf1d1f22715d6634efbf7242ace5482ae323858035f42f129d518320582039ad7f8b34c037da7f1f0ddb3a2e2cf2e9a2a50f3c6ec32b9e1d1cf17276fdcd19d7b1e42359d81f7384e6478a5687ba5c9ba364db35547a3d596f3c01ae0463345b9b8da318cb535e0d4aa87c688c4a1965b7adbe8dbac16df6edb01a2250e2f790b5b08b628b709b0817af177ca06356baaa0aa790ade4e9ce80278c76bad37435e57f934c0b49576c0a2950e5c178e0bc51207f45d2f5b64c30c7e93309c8ad9cd023db8a63b49d6b983380121075b2e9ea9491fda61cdfb8239c87855050624aa95c0d10b6027daf8fabfd4285cee3359281d9f99829a210d09460ddab8b8a866fe13ff623aa43f21e65bb93cee7d217390637d123a3fb5ef1c732068b7722d1f838c66111c56452e435aaee351c89c0bb9925dae58e8d1a2917dd2cf6eafae5b8f9588d584e1e5b1816f815dbb6481eabd6a5251feaeb1fdf5e291f3d28285ff2af5a6ace3fa2dee0f40df760331eecf10515de410456268c055bdf5bf14eeb1e2f60463040610b303dc331fa8e2dc0aeaeda38e5dcc2a44b54526930c7d5dbc202466558064637082b5da9804c05db445f84f70bacdd0c875569b8d7e0bab970b9c47baa12f15067ef88d33d16429c3c0b5715c60fa1c68ea0a2be61c8473dd4db0c56e2381bd738be9775f30993b97f369817d54a1e814b1e91a3d4917b2cf59b45bc920aa5f1c720c34a0acfb361c228b182cbed87facf1d260bc842c6750e2efebfd3e2aed14765d0b6ff0529a22381d50371326dec363b5b0024461dbc7775ac37b8461b1071af7862f92655e0025620a602a07ea36fa674e82c3d6fe96222d51440b8364782b3f3f0e6f90c571a670cf1f9f85fc8658244158834fc131b94f1507a4fdef034a810622ebd736bb1c98cc7d60fce7560a0780bd7b83fa85c3e6ccfbf3fa698a9e6493524821c5f8e4a4f60c564e8b6c06f69c281cb33e417bc096a90440af79fbabad7068df42c146462877877148f50e4b8b21d037ba9a700b2276cde00ad9bd8812dbbf81d42e9a144eacc0fc20f3226096df3e4fc25a2ec11a0db1c70c696173281b79cfaa3dfd16138e280f7541eb79f62fb384d9e7bf35510df76ed62b2e914e999ec318ba0ffda729c6fab1c4957280087fd88a14159657ba03197733839fc75bcd246b91af197af24667ff118bc7eb8a28b9843fafb8f1cf027aefdefc6309c95f16df05bbe8b5d622215cd9d403e17cf0129876e27ba2059cdc50e837a7d6882b8ba58587b13c7a39949ce737b8bf2db2370fbdf9b8bfb8d26baa4afef2fe950318521263c5a8ab136af8122a2345461632c41951b0009cf02242b5926ecd8c6a6a01648f05caa5bf112bb4e92b65023d9e2b0f44ed3b1a2ff427eb0b8d29f94af409d6a6e10fc37814eb49599ea14d831cdac69a5aa300bfff4bacc9d02d634d135c894a44511ddf854e0940863dbb386876ec4bcf627333b623139b6c7bc1014b4781022f2e1f495636790d0a12edf60789ab966c11e6004f88ca9861401b8460a49501956f4ab084223478eb9041f54e71fc6c50249ed52b509bc2bbfc71d8c1a23c406937b86f25d8139872e0c76c2f2500fa23164261ed7c1251d632449744a1670c350b1bc1b9a68b48b9966962855afdd0a5013c7b2036e18aed7117d3f20a061a58d43d91a0ab3ef81e43a4c78890f3daf01dbb4e4b42c9390aa8c0bb7d68bec0e877a35cdfc1546e237e328e1c4e18ef4228e8d4faf94dcca714d2842999b6a4f12ac0d45e999484f6c47c13de6fad98c7e487477c3e3f0d3307a9cf3f50f50486f751a7c3d28d90449e990f64b37a43f7f2b38a3190b73960e8fd5fbaf80fa4b496ac866f2316bf059c9638ef1755d25a3545e91aa2fa4acf688b96e18eae3ed5529af13632292b058e25fd5edfae5525b2ac419ce4ddd066911635e9b3dbc7a8dc77adcd1e0e4b680b9687fa7e0b7df8cfb979cba5790cafb4fa311d9671aac66df06ba68e2cf6813645cf19c6708a0995cfb81492dde3c5109596359e528842ef06a6032b78bf54befb850c3b51e0f83a86f65095eec39aeb2cc5f44966f3e7993a5a4df4dbd0264053ab203cd291ee88dc9b511bcbfe4baa5680a589917f150ca8e47a5e1a506886f993b8f9b77a49151ec01a4f792ddd242d38731c149bb30f3dbfca21f98625e227134f278c7b3153ccca2777e30f8fc652a00d842d033290e38113c4947670ec8c2426340e03efa0003a5b8fb26b1d1ba02c31781234dd720cf8b09d4bc10cfe2c183fb4d9254e04dc5a01ae923e95240fe2aadc100167363330039c553ecd20498c8e7f87cf3a7ccad9a548410b2d22fd23b2f5807635ab8ed0f1f71ab37e0238d854b53ecfb8afd9a75e7ccd5a0b50a954ba423ca0f7f5733d82f56e6f831715f17acc7f86692cfa0a1ee1c8a3b475976ebfcae9cb12ee9a624859caf91ca9f4f2acb0723de79fe957ecdb8cf42666bbcda587fc549c10797652c5ff0cc61232bb34407e6273232add28a31a19e4e7a93c2fe7ff0e3d8c0e260affd2b7e593dc03ca203eb6f72ec4940b15f7c6f42e2cba8a16d4a690740a88440b63eeb4e587a3018126cf66184b85454b35cca81593d7f81fae877b3014787e4dcb057327aba3169dbecc4d1546de880726834bccd5c3db2e3dd2775671ac2907ef49ff77b1e7cad78e131a86ba65c57ae1b16d56a8907967d17f264c1ac968aa3b75d158394fe5a86b72334da4886074dfa62370fc469e5c35f468b8ef1f00eb9aa3a26049cbe1cef69d62abb1da062f5cbd40e376b02ea72cbd872a7e238dd7fd0149a073eb16a7126b91951fc245fd54c2e72a7c85393dff37c51976db6ee04cb6a1735639ea914fe714aaa3c5c3b05ffe6c758e74a662f3aab4e933481c471729584ad1b8269139b3e36fed33daeeb870d883402cde9c119e20dcf8d41a0036644ef578640abe1870ea0de8859259397214016b66f3f4354faf47013bbc7d40a9fff0f02a853fe6e517eb30dc3497cecbd7390096e729f3a1f44af2eb4e6f04096f20e8de8ece6be8a6d2af8df8ed97327f3419d59abc7cdfca8907181c5f08880288f0c1d6b64d233ec044348b0e17e8e48c26d825c2eb223b258753a47c4651c623d4dd26b115786dd52a87466973017ae6cc338908d970f2cf135f0ca96680284a3fe79e6e98c0a24213b8412d9d0a4f6b3873b55d691c7ec7f64220fef2cffd972289e6406a46fab5bd43c8e9d87bcd88c12ebd28bcf29a8536bbdddd2d62a4e7c0b7d936ab6b78379b4ba92720eda0d3584f98c968c27eb7fa89d3b241e6f3aa448a01499fac3c3e1ff0d7df01f7109c4054a6ccd7e3ba203f7ff36c3b192bba5585d261d3f3fb8105a41a85626b0429bfe91d368befbb57a62c5f8e72c02df39394ffd7be7adb7d547608a70b62b46e0b623e6217bbb0b10f60458e6e63eb63b5f0c54ec8d643f4d6626797df187630eb0b4c6c89b027d19a921b50dd87c3fb2ef680b08cbfb7232ad8125ac79823e209dc5d7ae7350eadf904f9a3bee744fcaad1a7d1ca3a278e4bdf7adb548e71c7502a594ed5bc31584c499753ff04cca3606049e003fa7d5f58172648bab61805d093e5fdb2d6ccc9fcd2181c0ba4009f44519b9df25086420662a26fb2ff48c9e9d47d43cbe7fa88171b8127b0e4255bbe7075dce5166c64564a6698a232d060b1b385e558e0ce2b9049968435584dd94f1445498c78e2b5be7a22b163ad5ed6aeff617543d777be7065f4998361439873435b81001686742a0aaf19656020366718f2e012eb2006574e726434f5f7f8839bdf0934c2860e1ae8becb6342f965f435f450f02c88fa06cb0dda85c72411eef815a1d3eb09f591fb01cdf6a57381baa22523164ca592859ce9ce41b101977f5ef6ec5c0bd4fe747e99a9f6cd774ffe02c59ea1f4ca4408e5569fd57fa3f430c6e21ddc8c92a104d526126793151ab0b2c02cd16f449e186078317dee9991b49ca5dac19dc5e85fa86c0ad855caa5f1ba36be525d95e6c844cc31a56315017347654ffd87fb04edef88092eac029fd259c68ca787450f188a5dcacc3154e660fd52ee5738a92841809ce4867d7e7381fb3b5b0b9e199f536bc5750a42cc30f1de95dcc20265205a4c491dfb4d31b148ff2bbbbb97c28dbddcfaaf3ea2220b6adbf3b2dcc9a694f6c1fda05f38415e9c31e76db12c9e391881463d3c0abc757fdb542d70bf051b88f318bb2b30974d03299c70290d8694a858c4fae0af224bf8d6194e30ab5a516c8699595d7c3cb2e9de814703ec08cb24c7914571a28cc974dd2fea8b0bbbeb50b922ffb8daab9fb730ea1b76bd373f7ad7205034acaa401964bb63cb709099034b0a4635eef9e94c07a5a64e2f1e9988260d7c964c520c40d091803859cca287f4d0da96d774ce17f4213933544d8bb9293734892694295f7ad3593650e4eb2e7b05ba7f58e2d1c13fc407818e2313efca29b6076a593fca6c24752aac59f5638dc50f6ae8f5c5eea09a4b32fae1be8d4aed7e4a2f4a144887b5356826aed4e02936393c37cb03b84bac039b39edd23e1f9d5f1f2c78b3b06dc41cf64380fb32c4f4637dfe09fc6abdd2de618fd4ddf565065cb787bb75c760f5cf49639b87e96026d7fb5e19e448de6ee7811fd0d905ee150466bb3498d7ef3734e3fdb86d5ca925ee2c809ba54855719575b0f2ce2ee385b6273d9147fef0f04a1679710e6a4e4ffb42a105e45a8b95d7ac4ced2301fb49cec7af84da39681a1d02d2406e7808545a064486707cf78df41002fc1bbf131cc287cbed27ab87cc7e708971764d07bb20b4edf6214a2d1d3f222e8a091e5a619cd4d61f3da8e6b8fa5e97dd77b76a6f318b4858243cd0d5043578d65d78425ca9ebbe241890423c56cb927fe0c243efed3ac333976bdce3c3b3d96ef11ea371eb711b43ebc24d932733c81a4ceea2e2c053444077da6d4e19fc6fc36949f2191aa1ae518bfe36eb10497e28a98acaac3bb7c34807370dc71f6be09fd3b1d8f4bea27a6175112e3c6d69be0ffa959f6f6ff657faccdd0d7faa1f85225ab6d338ee8f9816f4504c96d0747ff70e7d5af5edd5398ec737af7620ff35996190a34f518b1c42bde2b237ea4dc4f30aab3e5d4e2e6ab9f02134ff7baaa3c9d065886194e081dc5952a1b0ccf66443c6e4c19aacaf3d801adabed88a550c6c4558980f7540b69963898e8ad164df86632868a0e6e52585d7ab1066df0f1784862ea4d0aee3067fb8e09f91c4eac04c400fa63797b422b5f7f4db51cb1ba602f0771cee078c391fc5990b7d98339973c9f60eed67642fe97ca76aa8f6d82b31c52b61617d10a209163ca47a7b52770ca6a48b9b555e781795aa182fe87b473c44ecd7d3552c9ad011538f458665b9b3d24073222e1909da6476c44c515f2d32b74258cc57f3f72a916f97223571cdd43b9af2e823e0386bb9b44cf9688067f3debcfaf3f7edf1597f1d87f970201b3db0c4fec0404bdcfbe6b78ade3c967ee5361aa269775a0947d508cc3b269dc6fb0a0b51db2b22b41d07b12af03715d0d162dedee21216243b59b48c5706fbdb610d7c176f0458da8cadc0bf5fe4373f5ee13a59be227c6f311a5004734c4e571401d980c89f0de6d052fbf143deda10feb924e1403159d979a5dce7292ec89776f56e2c0df175fd22cfd9295374d710c20c978ce676f99744940403651b4d51d4c660fd900dc07a007f1fdb35a2f2f254ba54de9b7406bcfe50b4cb595ff6da936f60f88010491afa4aab2d27f845187433a89866b701decc69201fdada6045a4ff7533dbbb8e6b21744682569bd53d4f0f74ff86f632ffca120fb6b74775eb18cb39825e47c7fb060bdc4bee83c6276f95f1a55a7c5b2a273c5ccc905166fd0456f8f99842c237644ba74b93ae3b8ede9facb9f23bc6b2ef86f286023386876649c6242ff1b19dd3b3a9565b5f04d34ac850ca00731358a73c5ff4b5ff6bfc3efef9faf0e727a949f3ffad787a9d0731268d2a13b3bf37b679eb5c525fcecfe11c7717bf105abea6160a3d6c0e437156f347755c0bea1c75a7847d72005807be5bdad6c69fcbbfbb91e4d3b44a33e469cd80ac22926aa7133de88fb3e57730a7bd159b703759f7b7b0b1554c5e211fafb28f93cbdee47d18dde90b26daa805373ec6b33e3458a80b69ff577f081e4bbdd7eb62ec057b812808a1471bf5611c7ca88453f8f2654e122848718c0294d1ab487f9c1e4894152820c4102b401da0292660bbf4ec4edd1ebbcdf93e110c0c22ede1c7e25a000ab874d257b70f64bc3811091ab14aa2209321170ca99247207f743ff7d8064f764977e482af5080c4fd9123eb59e8c82f4f78792bcb75b901bac04209074cb2b6b0b9ea70381ad3ea24b587c6f02c91ecc82f8c6ec0061a1e113f6647e53ae45e68b6c548356d743af572d3d4992a50d1897a6e8fc5c57877890a359628476f4a328be6c326cf21fc8841edbda2b4601e05fee0f8c5f81d1e09e13f3669e58b4b74daa79340b2b5c8aa0211541abafbb4ca4216b3942a8b2e4d217525856753d9ea49f47281f717c656d0fd718841e99560332b8ae3d571a26100348de8ac8589e2f6c75ca0eb8a279e47f7eb0a","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"cb4dac17dd2d3b658155eb3f63bb6c40"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
