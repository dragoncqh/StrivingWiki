<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="zh-cn"><head><meta charset="UTF-8"><meta name="copyright" content="(C) 版权 2024"><meta name="generator" content="DITA-OT"><meta name="description" content=""><title>网站同步镜像</title><link rel="stylesheet" type="text/css" href="../../commonltr.css">
<link rel="stylesheet" type="text/css" href="../../common-extended.css"></head><body id="网站同步镜像-35D5E52E"><main role="main"><article role="article" aria-labelledby="ariaid-title1">
<h1 class="title topictitle1" id="ariaid-title1">网站同步镜像</h1>


<div class="body conbody"><p class="shortdesc"></p>
<p class="p">　　<strong class="ph b">1.介绍</strong></p>
<p class="p">　　现在的网站随着访问量的增加，单一服务器无法承担巨大的访问量，有没有什么方便快捷的方式解决这个问题呢，答案是有！比如建立服务器群，进行均
衡负载。但是如果要解决像电信网通这样的互访问题(中国网民的悲哀..)，这个解决办法就无能为了了！要解决这个问题最方便快捷的方式就是建立镜像网站！
由访问者自己选择适合自己网络的速度最快的网站！这样即可以解决线路问题，又可以解决访问量问题！</p>
<p class="p">　　<strong class="ph b">2.网站同步的数据分类</strong></p>
<p class="p">　　网站数据基本分为两类：</p>
<p class="p">　　一类是文件，比如HTML，ASP，PHP等网页文件，或者RAR，ZIP，RM，AVI等可下载文件！</p>
<p class="p">　　要实现他们的同步很简单，用FTP同步软件就可以了！至于哪几个我会在后面做详细介绍.</p>
<p class="p">　　一类是数据库数据文件，比如MySQL，SQL Server等等！</p>
<p class="p">　　数据库同步的方法也很多，最简单的办法只是将数据库目录同步一下就OK了！</p>
<p class="p">　　在后面我也会做详细讲解！</p>
<p class="p">　　<strong class="ph b">3.网站文件的同步</strong></p>
<p class="p">　　在这里用到的主要工具就是FTP，网站文件同步分两种情况，一种是本地到远程，一种是远程到远程(FXP)！第一种不用说了，第二种远程到远程即FXP，支持它的软件也很多，但是真正适合多网站同步镜像的却不多！</p>
<p class="p">　　下面我介绍几个我认为不错的软件！(PS：如果熟悉FTP命令，完全可以自己制作一个批处理文件时间的)</p>
<p class="p">　　1.首先我要推荐的是国产的FTP软件”网络传神”，功能非常强大，特别是在网站的同步镜像方面，可惜的是，这款非常经典的软件已经不再更新了，最后更新时间是2003年3月，最后一个版本是3.12！虽然如此还是非常好用的！下面是一段官方的简介：</p>
<p class="p">　　网络传神完全吸收了Cuteftp和UpdataNow的全部功能，并且增加了其他软件没有的多项功能：支持网站互传；支持网站同步
(UPDATA NOW)；支持后台上传(多线程上传多个文件)；可同时打开多个站点；多站点计划上传功能，支持镜像站点；支持宏操作支持计划操作；支持文件高级比较上
传；支持目录隐藏过滤(为用ForntPage作主页的朋友带来福音)；服务器自动识别功能；资源管理器浏览方式；可以自定义命令；支持RFC959标准
具有更好的稳定性；完备的信息返回机制及错误监控机制完整的中文帮助。</p>
<p class="p">　　2.第二款是由ReGet同一开发公司制作的专用于网站同步的软件”WebSynchronizer”，用这款软件，你才会体验到网站同步的方便快捷，简单容易.最新版本是1.3.62，
网上能找到XX的最后版本是1.1版！下面是一段简介：</p>
<p class="p">　　档案同步化工具 - WebSynchronizer，由知名续传软件 ReGet 之软件出版公司所推出，是网站同步化、档案镜像、档案备份的绝佳工具，可以执行下列主要工作：1)
本机资料夹及远程资料夹的同步化；2) 两台远程计算机中的资料夹同步化；3) 两个本机资料之同步化。</p>
<p class="p">　　3.其他还有一些软件如同步快梭(AutoSyncFTP)，也能实现简单的网站同步，不过，这款软件非常不稳定，而且2001年就已经停止开发.所以，不用考虑了！还有上次有朋友提到的SiteMirro，由于网上找不到可以用的版本，所以没有办法测试！</p>
<p class="p">　　4.网络传神网站同步镜像使用傻瓜指南</p>
<p class="p">　　第一次运行网络传神的时候，它会让你选择”完全模式”和”启动模式”，要使用网站同步必须选择”完全模式”.</p>
<p class="p">　　进入主界面：你会发现这个软件非常像FlashGet，要使用网站同步功能，点击软件左下角的”FTP客户端”.</p>
<p class="p">　　现在你要做的就是添加你的镜像母站和需要镜像的网站：文件→；站点管理，在里面添加你需要同步的几个的FTP服务器，下面我将介绍具体设置(主要是镜像母站的设置)</p>
<p class="p">　　<strong class="ph b">母站设置最重要的地方就是“比较目录(网站同步)”：</strong></p>
<p class="p">　　1.拖动传送</p>
<p class="p">　　就是手动拖动传送时候的传送方式，非拖动方式不受影响，因为母站的更新基本上是从本地目录进行的，所以建议这里选择第二项”只上传不同的文件”，镜像站点这里可以忽略</p>
<p class="p">　　2.磁盘比较设置</p>
<p class="p">　　这个功能非常有用，可以通过文件长度和文件日期进行文件差异对比.</p>
<p class="p">　　你还可以设置本地目录过滤和服务器目录过滤，非常灵活！</p>
<p class="p">　　好了，添加好母站和镜像站之后，我们来设置同步：</p>
<p class="p">　　如果是添加镜像站，则会跳出下面的母站选择窗口：</p>
<p class="p">　　设置好多个镜像站点之后，返回主界面就可以进行网站同步了：</p>
<p class="p">　　<strong class="ph b">注意事项：</strong></p>
<p class="p">　　一般不要改动镜像站点前面的“对钩”标志，因为镜像站点同步的原理是“根据主站点的同步信息更新镜像站点”，如果景象站点没有更新那么必须将该镜像站点单独同步。</p>
<p class="p">　　注意一般应该“选项窗口”-〉“FTP客户端”-〉“计划”中的“最大连接个数”和“最大线程个数”一般不要改动保持为“1”。</p>
<p class="p">　　如果同步时某个站点出错同步没有完全完成只需按“计划”窗口中的 按钮单独执行某个站点的传送即可。</p>
<p class="p">　　再介绍一下网站镜像同步中必要的功能，定时同步，这样你就只要做好母站的更新，其他的让网络传神帮你完成：</p>
<p class="p">　　点击设置：</p>
<p class="p">　　进入网络传神的选项设置窗口，选中FTP客户端中的定时同步</p>
<p class="p">　　定时下载：在指定的时段内下载文件。</p>
<p class="p">　　定时上传：在指定的时段内用网站同步的方法进行上传。</p>
<p class="p">　　开始时间：如果要使用定时方式必须设置此项，在设置的时间中会自动开始所有设置为计划的站点。</p>
<p class="p">　　停止时间：如果设置此项则当系统时间大于停止时间时自动停止所有设置为计划的站点。</p>
<p class="p">　　注意：定时上传种没有“停止时间”选项，网站同步完成后会自动停止，同时网站同步同一时间只能运行一次。</p>
<p class="p">　　网络传神还有很多为便于同步镜像设置的功能，大家实际使用中去体会吧！</p>
<p class="p">　　5. Web Synchronizer 网站同步镜像使用傻瓜指南</p>
<p class="p">　　Web Synchronizer功能非常强大，不单单是网站同步，还可以进行本地目录同步，本地到远程同步，功能方面远胜过传神，不过，国内好像没有汉化版，对于一些对英文感冒的朋友用起来会不太舒服，希望CCF里的汉化高手能将他中文化！</p>
<p class="p">　　开始运行程序，老外的软件就是智能，一打开这个软件就会有一个同步向导跳出来！</p>
<p class="p">　　在这里，你也看出来了吧，这个软件只支持两个目录间的同步.不过，我们可以创建多个项目来解决这个问题！具体我在后面介绍！这里，我们来看看如何建立两个远程目录的同步！</p>
<p class="p">　　选择第二项，进入下一个选择框：</p>
<p class="p">　　网站同步当然是选择第一项了！再进入下一步，要你选择同步的第一个服务器，建议在这里servers list，先编辑好需要同步的几个FTP</p>
<p class="p">　　同步方式设置说明：</p>
<p class="p">　　第一项的意思是：上传下载所有改变的文件</p>
<p class="p">　　第二项的意思是：不改变文件夹内容，只下载新的文件</p>
<p class="p">　　点击下一步进行第二个服务器设置，方法和第一个一样！</p>
<p class="p">　　设置完成后，你还可以修改任务名称！</p>
<p class="p">　　我觉得这点就是这个软件非常优秀的地方，以任务的方式进行管理.非常方便！</p>
<p class="p">　　OK，现在我们就可以看到他的主界面了！</p>
<p class="p">　　还有一点要提，他的计划任务更能也很强大，在这里我就不再多说了！用过才知道他的强大！</p>
<p class="p">　　有朋友会说，我要进行两个以上的网站同步怎么办?</p>
<p class="p">　　很简单，再多建几个任务就可以了，要镜像多少网站都没有问题！</p>
<p class="p">　　这个软件的网站同步镜像可以非常灵活，比如可以本地-远程，然后再远程-远程！或者本地-远程1，本地-远程2，远程1-远程2，任何情形下的同步都可以完成！</p>
<p class="p">　　3.数据库同步操作指南</p>
<p class="p">　　说完了文件同步，我们再来探讨一下数据库同步！</p>
<p class="p">　　这里我主要教大家两种最常用的数据库的同步方法！</p>
<p class="p">　　<strong class="ph b">MySQL</strong></p>
<p class="p">　　MySQL数据同步主要有三种方式：</p>
<p class="p">　　1.利用MySQL自身的数据库同步功能</p>
<p class="p">　　2.利用MySQL数据库的特性(数据库存在固顶目录，并且以文件形式存储)，进行数据库目录同步以达到数据同步目的</p>
<p class="p">　　3.利用专用的MySQL数据库同步软件</p>
<p class="p">　　1. 利用MySQL自身的数据库同步功能(下面参考自网上的文章，写的非常详细了)</p>
<p class="p">　　MySQL从3.23.15版本以后提供数据库复制功能。利用该功能可以实现两个数据库同步，主从模式，互相备份模式的功能.</p>
<p class="p">　　数据库同步复制功能的设置都在mysql的设置文件中体现。mysql的配置文件(一般是my.cnf)，在unix环境下在/etc/mysql/my.cnf
或者在mysql用户的home目录下的my.cnf。</p>
<p class="p">　　windows环境中，如果c：根目录下有my.cnf文件则取该配置文件。当运行mysql的winmysqladmin.exe工具时候，
该工具会把c：根目录下的my.cnf 命名为mycnf.bak。并在winnt目录下创建my.ini。mysql服务器启动时候会读该配置文件。所以可以把my.cnf中的内容拷贝到
my.ini文件中，用my.ini文件作为mysql服务器的配置文件。</p>
<p class="p">　　设置方法：</p>
<p class="p">　　设置范例环境：</p>
<p class="p">　　操作系统：window2000 professional</p>
<p class="p">　　mysql：4.0.4-beta-max-nt-log</p>
<p class="p">　　A ip：10.10.10.22</p>
<p class="p">　　B ip：10.10.10.53</p>
<p class="p">　　A：设置</p>
<p class="p">　　1.增加一个用户最为同步的用户帐号：</p>
<p class="p">　　GRANT FILE ON *.* TO backup@'10.10.10.53' IDENTIFIED BY ‘1234’</p>
<p class="p">　　2.增加一个数据库作为同步数据库：</p>
<p class="p">　　create database backup</p>
<p class="p">　　B：设置</p>
<p class="p">　　1.增加一个用户最为同步的用户帐号：</p>
<p class="p">　　GRANT FILE ON *.* TO backup@'10.10.10.22' IDENTIFIED BY ‘1234’</p>
<p class="p">　　2.增加一个数据库作为同步数据库：</p>
<p class="p">　　create database backup</p>
<p class="p">　　主从模式：A→；B</p>
<p class="p">　　A为master</p>
<p class="p">　　修改A mysql的my.ini文件。在mysqld配置项中加入下面配置：</p>
<p class="p">　　server-id=1</p>
<p class="p">　　log-bin</p>
<p class="p">　　#设置需要记录log 可以设置log-bin=c：mysqlbakmysqllog 设置日志文件的目录，</p>
<p class="p">　　#其中mysqllog是日志文件的名称，mysql将建立不同扩展名，文件名为mysqllog的几个日志文件。</p>
<p class="p">　　binlog-do-db=backup #指定需要日志的数据库</p>
<p class="p">　　重起数据库服务。</p>
<p class="p">　　用show master status 命令看日志情况。</p>
<p class="p">　　B为slave</p>
<p class="p">　　修改B mysql的my.ini文件。在mysqld配置项中加入下面配置：</p>
<p class="p">　　server-id=2</p>
<p class="p">　　master-host=10.10.10.22</p>
<p class="p">　　master-user=backup #同步用户帐号</p>
<p class="p">　　master-password=1234</p>
<p class="p">　　master-port=3306</p>
<p class="p">　　master-connect-retry=60 预设重试间隔60秒</p>
<p class="p">　　replicate-do-db=backup 告诉slave只做backup数据库的更新</p>
<p class="p">　　重起数据库</p>
<p class="p">　　用show slave status看同步配置情况。</p>
<p class="p">　　注意：由于设置了slave的配置信息，mysql在数据库目录下生成master.info</p>
<p class="p">　　所以如有要修改相关slave的配置要先删除该文件。否则修改的配置不能生效。</p>
<p class="p">　　双机互备模式。</p>
<p class="p">　　如果在A加入slave设置，在B加入master设置，则可以做B→；A的同步。</p>
<p class="p">　　在A的配置文件中 mysqld 配置项加入以下设置：</p>
<p class="p">　　master-host=10.10.10.53</p>
<p class="p">　　master-user=backup</p>
<p class="p">　　master-password=1234</p>
<p class="p">　　replicate-do-db=backup</p>
<p class="p">　　master-connect-retry=10</p>
<p class="p">　　在B的配置文件中 mysqld 配置项加入以下设置：</p>
<p class="p">　　log-bin=c：mysqllogmysqllog</p>
<p class="p">　　binlog-do-db=backup</p>
<p class="p">　　注意：当有错误产生时*.err日志文件。同步的线程退出，当纠正错误后要让同步机制进行工作，运行slave start</p>
<p class="p">　　重起AB机器，则可以实现双向的热备。</p>
<p class="p">　　测试：</p>
<p class="p">　　向B批量插入大数据量表AA(1872000)条</p>
<p class="p">　　A数据库每秒钟可以更新2500条数据。</p>
<p class="p">　　2.数据库目录同步，方法和文件同步一样，设置好需要同步的两个数据库目录就可以了！</p>
<p class="p">　　缺点很明显，数据同步只能单向进行，可以作为备份方案</p>
<p class="p">　　3.用专用的MySQL同步软件进行同步</p>
<p class="p">　　这方面的软件有SQLBalance 和MyReplicator ，优点是方便直观，还有很多争强功能！</p>
<p class="p">　　缺点和2一样，只能单项同步！</p>
<p class="p">　　当然你也可以修改镜像网站的程序为提交数据到母数据库，读取则在当前镜像下的数据，不过，修改起来麻烦！普通用户修改也非常难！呵呵，大家了解一下就可以！给大家一个思路！有能力的朋友可以试试阿！</p>
<p class="p">　　<strong class="ph b">MSSQL</strong></p>
<p class="p">　　MSSQL数据同步利用数据库复制技术实现数据同步更新(来自网络，也是非常完美的教程)</p>
<p class="p">　　复制的概念</p>
<p class="p">　　复制是将一组数据从一个数据源拷贝到多个数据源的技术，是将一份数据发布到多个存储站点上的有效方式。使用复制技术，用户可以将一份数据发布到
多台服务器上，从而使不同的服务器用户都可以在权限的许可的范围内共享这份数据。复制技术可以确保分布在不同地点的数据自动同步更新，从而保证数据的一致
性。</p>
<p class="p">　　SQL复制的基本元素包括</p>
<p class="p">　　出版服务器、订阅服务器、分发服务器、出版物、文章</p>
<p class="p">　　SQL复制的工作原理</p>
<p class="p">　　SQL SERVER 主要采用出版物、订阅的方式来处理复制。源数据所在的服务器是出版服务器，负责发表数据。出版服务器把要发表的数据的所有改变情况的拷贝复制到分发服务
器，分发服务器包含有一个分发数据库，可接收数据的所有改变，并保存这些改变，再把这些改变分发给订阅服务器</p>
<p class="p">　　SQL SERVER复制技术类型</p>
<p class="p">　　SQL SERVER提供了三种复制技术，分别是：</p>
<p class="p">　　1、快照复制(呆会我们就使用这个)</p>
<p class="p">　　2、事务复制</p>
<p class="p">　　3、合并复制</p>
<p class="p">　　只要把上面这些概念弄清楚了那么对复制也就有了一定的理解。接下来我们就一步一步来实现复制的步骤。</p>
<p class="p">　　第一先来配置出版服务器</p>
<p class="p">　　(1)选中指定[服务器]节点</p>
<p class="p">　　(2)从[工具]下拉菜单的[复制]子菜单中选择[发布、订阅服务器和分发]命令</p>
<p class="p">　　(3)系统弹出一个对话框点[下一步]然后看着提示一直操作到完成。</p>
<p class="p">　　(4)当完成了出版服务器的设置以后系统会为该服务器的树形结构中添加一个复制监视器。同时也生成一个分发数据库(distribution)</p>
<p class="p">　　第二创建出版物</p>
<p class="p">　　(1)选中指定的服务器</p>
<p class="p">　　(2)从[工具]菜单的[复制]子菜单中选择[创建和管理发布]命令。此时系统会弹出一个对话框</p>
<p class="p">　　(3)选择要创建出版物的数据库，然后单击[创建发布]</p>
<p class="p">　　(4)在[创建发布向导]的提示对话框中单击[下一步]系统就会弹出一个对话框。对话框上的内容是复制的三个类型。我们现在选第一个也就是默认的快照发布(其他两个大家可以去看看帮助)</p>
<p class="p">　　(5)单击[下一步]系统要求指定可以订阅该发布的数据库服务器类型，SQLSERVER允许在不同的数据库如 ORACLE或ACCESS之间进行数据复制。但是在这里我们选择运行”SQL&nbsp;SERVER
2000”的数据库服务器</p>
<p class="p">　　(6)单击[下一步]系统就弹出一个定义文章的对话框也就是选择要出版的表</p>
<p class="p">　　(7)然后[下一步]直到操作完成。当完成出版物的创建后创建出版物的数据库也就变成了一个共享数据库。</p>
<p class="p">　　第三设计订阅</p>
<p class="p">　　(1)选中指定的订阅服务器</p>
<p class="p">　　(2)从[工具]下拉菜单中选择[复制]子菜单的[请求订阅]</p>
<p class="p">　　(3)按照单击[下一步]操作直到系统会提示检查SQL SERVER代理服务的运行状态，执行复制操作的前提条件是SQL SERVER代理服务必须已经启动。</p>
<p class="p">　　(4)单击[完成]。完成订阅操作。</p>
<p class="p">　　完成上面的步骤其实复制也就是成功了。但是如何来知道复制是否成功了呢?这里可以通过这种方法来快速看是否成功。展开出版服务器下面的复制——
发布内容——右键发布内容——属性——击活——状态然后点立即运行代理程序接着点代理程序属性击活调度把调度设置为每一天发生，每一分钟，在0：00：
00和23：59：59之间。接下来就是判断复制是否成功了打开C：\Program Files\Microsoft&nbsp;SQL&nbsp;Server\MSSQL\REPLDATA\unc\XIAOWANGZI_database_database下面看是不是有一些以时间做为文件名的
文件夹差不多一分中就产生一个。要是你还不信的话就打开你的数据库看在订阅的服务器的指定订阅数据库下看是不是看到了你刚才所发布的表—</p>
<p class="p">　　一个手工同步的方案</p>
<p class="p">　　–定时同步服务器上的数据</p>
<p class="p">　　–例子：</p>
<p class="p">　　–测试环境，SQL Server2000，远程服务器名：xz，用户名为：sa，无密码，测试数据库：test</p>
<p class="p">　　–服务器上的表(查询分析器连接到服务器上创建)</p>
<p class="p">　　create table [user](id int primary key，number varchar(4)，name
varchar(10))</p>
<p class="p">　　go</p>
<p class="p">　　–以下在局域网(本机操作)</p>
<p class="p">　　–本机的表，state说明：null 表示新增记录，1 表示修改过的记录，0 表示无变化的记录</p>
<p class="p">　　if exists (select * from dbo.sysobjects where id = object_id(N'[user]')
and OBJECTPROPERTY(id， N'IsUserTable') = 1)</p>
<p class="p">　　drop table [user]</p>
<p class="p">　　GO</p>
<p class="p">　　create table [user](id int identity(1，1)，number varchar(4)，name
varchar(10)，state bit)</p>
<p class="p">　　go</p>
<p class="p">　　–创建触发器，维护state字段的值</p>
<p class="p">　　create trigger t_state on [user]</p>
<p class="p">　　after update</p>
<p class="p">　　as</p>
<p class="p">　　update [user] set state=1</p>
<p class="p">　　from [user] a join inserted b on a.id=b.id</p>
<p class="p">　　where a.state is not null</p>
<p class="p">　　go</p>
<p class="p">　　–为了方便同步处理，创建链接服务器到要同步的服务器</p>
<p class="p">　　–这里的远程服务器名为：xz，用户名为：sa，无密码</p>
<p class="p">　　if exists(select 1 from master..sysservers where srvname='srv_lnk')</p>
<p class="p">　　exec sp_dropserver 'srv_lnk'，'droplogins'</p>
<p class="p">　　go</p>
<p class="p">　　exec sp_addlinkedserver 'srv_lnk'，''，'SQLOLEDB'，'xz'</p>
<p class="p">　　exec sp_addlinkedsrvlogin 'srv_lnk'，'false'，null，'sa'</p>
<p class="p">　　go</p>
<p class="p">　　–创建同步处理的存储过程</p>
<p class="p">　　if exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[p_synchro]')
and OBJECTPROPERTY(id， N'IsProcedure') = 1)</p>
<p class="p">　　drop procedure [dbo].[p_synchro]</p>
<p class="p">　　GO</p>
<p class="p">　　create proc p_synchro</p>
<p class="p">　　as</p>
<p class="p">　　–set XACT_ABORT on</p>
<p class="p">　　–启动远程服务器的MSDTC服务</p>
<p class="p">　　–exec master..xp_cmdshell 'isql /S”xz” /U”sa” /P”” /q”exec master..xp_cmdshell
''net start msdtc''，no_output”'，no_output</p>
<p class="p">　　–启动本机的MSDTC服务</p>
<p class="p">　　–exec master..xp_cmdshell 'net start msdtc'，no_output</p>
<p class="p">　　–进行分布事务处理，如果表用标识列做主键，用下面的方法</p>
<p class="p">　　–BEGIN DISTRIBUTED TRANSACTION</p>
<p class="p">　　–同步删除的数据</p>
<p class="p">　　delete from srv_lnk.test.dbo.[user]</p>
<p class="p">　　where id not in(select id from [user])</p>
<p class="p">　　–同步新增的数据</p>
<p class="p">　　insert into srv_lnk.test.dbo.[user]</p>
<p class="p">　　select id，number，name from [user] where state is null</p>
<p class="p">　　–同步修改的数据</p>
<p class="p">　　update srv_lnk.test.dbo.[user] set</p>
<p class="p">　　number=b.number，name=b.name</p>
<p class="p">　　from srv_lnk.test.dbo.[user] a</p>
<p class="p">　　join [user] b on a.id=b.id</p>
<p class="p">　　where b.state=1</p>
<p class="p">　　–同步后更新本机的标志</p>
<p class="p">　　update [user] set state=0 where isnull(state，1)=1</p>
<p class="p">　　–COMMIT TRAN</p>
<p class="p">　　go</p>
<p class="p">　　–创建作业，定时执行数据同步的存储过程</p>
<p class="p">　　if exists(SELECT 1 from msdb..sysjobs where name='数据处理')</p>
<p class="p">　　EXECUTE msdb.dbo.sp_delete_job @job_name='数据处理'</p>
<p class="p">　　exec msdb..sp_add_job @job_name='数据处理'</p>
<p class="p">　　–创建作业步骤</p>
<p class="p">　　declare @sql varchar(800)，@dbname varchar(250)</p>
<p class="p">　　select @sql='exec p_synchro' –数据处理的命令</p>
<p class="p">　　，@dbname=db_name() –执行数据处理的数据库名</p>
<p class="p">　　exec msdb..sp_add_jobstep @job_name='数据处理'，</p>
<p class="p">　　@step_name = '数据同步'，</p>
<p class="p">　　@subsystem = 'TSQL'，</p>
<p class="p">　　@database_name=@dbname，</p>
<p class="p">　　@command = @sql，</p>
<p class="p">　　@retry_attempts = 5， –重试次数</p>
<p class="p">　　@retry_interval = 5 –重试间隔</p>
<p class="p">　　–创建调度</p>
<p class="p">　　EXEC msdb..sp_add_jobschedule @job_name = '数据处理'，</p>
<p class="p">　　@name = '时间安排'，</p>
<p class="p">　　@freq_type = 4， –每天</p>
<p class="p">　　@freq_interval = 1， –每天执行一次</p>
<p class="p">　　@active_start_time = 00000 –0点执行</p>
<p class="p">　　go</p>
<p class="p">参见:</p>
<p class="p"><a class="xref" href="http://www.cnblogs.com/ghx88/archive/2008/11/18/1336140.html" target="_blank" rel="external noopener">Yahoo!网站性能最佳体验的34条黄金守则——内容</a></p>
<p class="p"><a class="xref" href="http://www.heima123.com/html/2006-09/9238.shtm" target="_blank" rel="external noopener">http://www.heima123.com/html/2006-09/9238.shtm</a><strong class="ph b">&nbsp;</strong><strong class="ph b">手把手教程：一步步教你搞网站同步镜像</strong></p>
<p class="p"><a class="xref" href="http://www.soft6.com/tech/3/36913.html" target="_blank" rel="external noopener">http://www.soft6.com/tech/3/36913.html</a><strong class="ph b">&nbsp;</strong><strong class="ph b">中国人自己的FTP软件“网络传神”教程</strong></p>
</div>
<nav role="navigation" class="related-links"><div class="familylinks"><div class="parentlink"><strong>父主题：</strong> <a class="link" href="%E7%BD%91%E7%AB%99%E5%BB%BA%E8%AE%BE.html">网站建设</a></div></div></nav></article></main></body></html>