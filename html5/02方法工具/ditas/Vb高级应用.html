<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="zh-cn"><head><meta charset="UTF-8"><meta name="copyright" content="(C) 版权 2024"><meta name="generator" content="DITA-OT"><meta name="description" content=""><title>vb高级应用</title><link rel="stylesheet" type="text/css" href="../../commonltr.css">
<link rel="stylesheet" type="text/css" href="../../common-extended.css"></head><body id="Vb高级应用-3572BF77"><main role="main"><article role="article" aria-labelledby="ariaid-title1">
<h1 class="title topictitle1" id="ariaid-title1">vb高级应用</h1>


<div class="body conbody"><p class="shortdesc"></p>
<p class="p">六，文件操作</p>
<p class="p">包括文件系统控件（ DriveList Box ， dirlistBox 和 FileListBox ）的使用，顺序文件、随机文件和二进制文件的使用。</p>
<p class="p">在导入数据的时候，有的时候，Access会把一些数据作为数值型的数据，实际上，我们需要作为字符型的数据，那么如何在导入的时候，指定导入的各种规格和细节呢？
答案是利用Schema.ini即可(导入/导出规格文件)。有几种方式创建Schema，第一种是利用Access自身的文本数据导入导出向导：
在这个对话框中，点击[高级…]按钮，弹出对话框： 然后只要设定好各种格式，然后点击[另存为]保存即可。这种方式创建的Schema，只能集成在数据库中，无法灵活单独使用，因此我们需要用到另外一种方
式：INI文件，推荐使用INI文件这种方式。 Schema.ini格式如下（参考：MSDN主题 Schema.ini File）：
Schema.ini用于提供文本数据中的记录规格信息。每个Schema.ini的条目用于指明表的5个特征之一：文本文件名文件名有方括号括起来，例
如如果要对Sample.txt使用Schema，那么它的对应的Schema条目应该是 [Sample.txt] 文件格式指令如下：
Format=Value Value可以取下面的值之一： TabDelimited 用Tab分隔 CSVDelimited 用逗号分隔
FixedLength 固定长度 Delimited(C) 指定字符，其中C可以为除了双引号(”)外的任何字符，也可以为空字段名、字段宽度和类型格式为：Coln=字段名
数据类型 [width 宽度] 字段名可以是任意字符，如果字段名包含空格，请使用双引号括起来。数据类型可以为： Bit Byte Short(Integer)
Long Currency Single Double(Float) DateTime(Date DateFormat) Text(Char)
Memo(LongChar) 其中DateFormat是日期的格式字符串例如：Date YYYY-MM-DD 字符集格式：CharacterSet=ANSI
| OEM 格式只有两种：ANSI和OEM 特殊数据类型转换特殊数据类型转换一般使用的比较少，主要是自定义日期、货币等等的数据格式，一般不用理会。在此也不作详细叙述。请自己查看MSDN帮助：Schema.ini
File 下面给出一个简单的例子，假设有一个表Contacts.txt类似下面： First NameLast NameHireDate
Nancy Davolio 10-22-91 Robert King 10-23-91 那么Schema.ini个是类似下面的INI文件（我加了注释）：
[Contacts.txt]&nbsp;/需要导入的文本文件名 ColNameHeader=True&nbsp;/是否有数据头 Format=FixedLength&nbsp;/字段固定长度
MaxScanRows=0&nbsp;/最多导入行 CharacterSet=OEM&nbsp;/字符集 Col1=“First Name”
Char Width 10/第一列格式 Col2=“Last Name” Char Width 9&nbsp;/第二列格式 Col3=“HireDate”
Date Width 8&nbsp;/第三列格式 ////依此类推 我们可以根据数据自动创建这个Schema.ini文件！注意，Schema.ini必须和需要导入的文本文件在同一目录！！！如果不在同一个目录，必须指定Schema.ini的全路径！</p>
<p class="p">参见:&nbsp;<a class="xref" href="http://support.microsoft.com/kb/q247412/" target="_blank" rel="external noopener"><strong class="ph b">INFO：将数据从 Visual Basic 传输到 Excel 的方法</strong></a>&nbsp;<a class="xref" href="http://faq.csdn.net/read/215965.html" target="_blank" rel="external noopener"><strong class="ph b">将ACESS表中的数据，用一条语句导入EXCEL中，如何实现？</strong></a>&nbsp;<a class="xref" href="http://community.csdn.net/Expert/TopicView3.asp?id=5462502" target="_blank" rel="external noopener"><strong class="ph b">如何最快的将上百万条记录导出到同一个Excel中的不同Sheet中？</strong></a>&nbsp;<a class="xref" href="http://www.vbcode.com/Asp/showsn.asp?theID=11879" target="_blank" rel="external noopener"><strong class="ph b">Exporting large database records to Excel</strong></a>&nbsp;使用ADO的分页法&nbsp;<a class="xref" href="http://www.mrexcel.com/archive2/23900/27224.htm" target="_blank" rel="external noopener"><strong class="ph b">export large file into excel</strong></a>&nbsp;Line Input法和ADO_
copyFromRecordset法&nbsp;<a class="xref" href="http://blog.csdn.net/changechange/archive/2004/01/25/18598.aspx" target="_blank" rel="external noopener"><strong class="ph b">导入文本文件时如何指定字段类型？</strong></a>&nbsp;<a class="xref" href="http://kingron.g4soft.net/bbs/dispbbs.asp?BoardID=6&amp;replyID=1893&amp;id=404&amp;skin=0" target="_blank" rel="external noopener"><strong class="ph b">导入文本数据到Access的时候如何指定字段信息</strong></a>&nbsp;<a class="xref" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/odbc/htm/odbcjetother_text_file_driver_programming_details.asp" target="_blank" rel="external noopener"><strong class="ph b">Other Text File Driver Programming Details</strong></a>&nbsp;参考MSDN帮助主题： ACC2000: Error When You Try to Use Schema.ini
to Import or Export with the TransferText Method TransferText</p>
<p class="p">七，XML文件操作</p>
<p class="p"><a class="xref" href="http://www.mndsoft.com/Blog/VB6/0864.html" target="_blank" rel="external noopener">在Visual Basic 6.0中操纵XML文件 |</a></p>
<p class="p"><a class="xref" href="http://www.cnblogs.com/guyuehuanhuan/archive/2011/07/26/2116852.html" target="_blank" rel="external noopener">VB6.0 生成 XML方法|</a></p>
<p class="p"><a class="xref" href="http://sanbook.iteye.com/blog/304889" target="_blank" rel="external noopener">VB6.0操作XML文件|</a></p>
<p class="p"><a class="xref" href="http://www.freevbcode.com/ShowCode.asp?ID=1919" target="_blank" rel="external noopener">Create XML Using the MSXML Object Library|</a></p>
<p class="p"><a class="xref" href="http://channel9.msdn.com/Forums/TechOff/83111-Writing-Large-XML-files-in-VB6-IStream-Implementation" target="_blank" rel="external noopener">Writing Large XML files in VB6, IStream ​Implementat​ion|</a></p>
<p class="p">八，连接数据库</p>
<p class="p">数据库开发技术，包括数据库基础，使用数据控件（ ADO 和 DataGrid ）数据库，数据访问对象（ DAO ）的使用，&nbsp;SQL&nbsp;查询语言的使用。
ACCESS 和&nbsp;SQL&nbsp;Server 数据库的管理。用&nbsp;VB&nbsp;开发客户机 /服务器应用程序，介绍三层客户机
服务器体系结构，远程数据访问对象（ RDO ）和 OLE/ADO 体系结构（在 VB6.0 新引入的）。</p>
<p class="p">九，VB中文编码处理：</p>
<p class="p">在使用ADO向SQL　Server 6.5中追加或修改数据后，发现查询出来的汉字都是乱码，最初以为是客户端的环境有问题，后来打开服务器端的数据库，发现其中的汉字也都是乱码，费了九牛
二虎之力才找到原因：在追加和修改的过程中，ADO将字符进行了自动翻译（AutoTranslate），翻译后就成了乱码（Microsoft给我们开
了一个“小小”的玩笑），解决的办法就是不让它乱翻译，具体操作如下：如果ADO通过OLE　DB直接连接到数据库，则在Connection的
ConnectionString中加入字符串：AutoTranslate=False；如果ADO通过ODBC连接到数据库，则在配置ODBC时，将
“执行字符数据转换”一项的勾去掉。</p>
<p class="p">参见</p>
<p class="p"><a class="xref" href="http://www.haogongju.net/art/568743" target="_blank" rel="external noopener">VB6中实现UTF-8编码解码|</a>&nbsp;<a class="xref" href="http://www.nonhostile.com/howto-convert-byte-array-utf8-string-vb6.asp" target="_blank" rel="external noopener">VB6: How To Convert UTF-8 Byte Arrays into Unicode
Strings (and vice versa)|</a>&nbsp;<a class="xref" href="http://www.codeproject.com/KB/string/UTF8.aspx" target="_blank" rel="external noopener">UTF-8 Encoding and Decoding|</a>&nbsp;<a class="xref" href="http://www.planetsourcecode.com/vb/scripts/ShowCode.asp?txtCodeId=44569&amp;lngWId=1" target="_blank" rel="external noopener">UTF-8 Encoder/Decoder |</a></p>
<p class="p"><a class="xref" href="http://www.google.com/url?q=http%3A%2F%2Fwww.mndsoft.com%2Fblog%2Farticle.asp%3Fid%3D1074&amp;sa=D&amp;sntz=1&amp;usg=AFrqEzcpuERAJLrDrqdVK1l3XNL5dETLkg" target="_blank" rel="external noopener">VB编程中的Unicode vs Ansi</a></p>
<p class="p"><a class="xref" href="http://www.google.com/url?q=http%3A%2F%2Fwww.mjtd.com%2Fbbs%2Fdispbbs.asp%3FboardID%3D33%26ID%3D51594%26page%3D7&amp;sa=D&amp;sntz=1&amp;usg=AFrqEze1zHeXzDXSZnIUQa6J_FN9urulYQ" target="_blank" rel="external noopener">解决VB读取带汉字文本文件乱码问题</a></p>
<p class="p"><a class="xref" href="http://www.google.com/url?q=http%3A%2F%2Fwww.javaresearch.org%2Farticle%2F19240.htm&amp;sa=D&amp;sntz=1&amp;usg=AFrqEzeiVc_iuOOVCJ4cF6rGb3iF8k43nA" target="_blank" rel="external noopener">tomcat下中文的彻底解决</a></p>
<p class="p"><a class="xref" href="http://www.google.com/url?q=http%3A%2F%2Fwww.vipcn.com%2FInfoView%2FArticle_176140.html&amp;sa=D&amp;sntz=1&amp;usg=AFrqEzcSrySarJKKDFH7K3To4-sgA2RtwQ" target="_blank" rel="external noopener">乱码形成原因及其消除方法大全</a></p>
<p class="p"><a class="xref" href="http://www.google.com/url?q=http%3A%2F%2Ftopic.csdn.net%2Ft%2F20030812%2F16%2F2137847.html&amp;sa=D&amp;sntz=1&amp;usg=AFrqEzcajD2vcv_iKg0I7yMwdRV29-gsBQ" target="_blank" rel="external noopener">关于 汉字内码的</a></p>
<p class="p">十，制作ActiveX控件：</p>
<p class="p">用&nbsp;VB&nbsp;自定义类 OLE 和 Active X 控件的创建与使用。</p>
<p class="p">参见：</p>
<p class="p"><a class="xref" href="http://www.google.com/url?q=http%3A%2F%2Fwww.cnblogs.com%2Fbabyt%2Farchive%2F2005%2F03%2F14%2F118264.html&amp;sa=D&amp;sntz=1&amp;usg=AFrqEzfXsAcqo5kAUXNwwJd5IlLGVS-yNw" target="_blank" rel="external noopener">给控件做数字签名之一:将控件打包为Web发布包</a></p>
<p class="p"><a class="xref" href="http://www.google.com/url?q=http%3A%2F%2Fwww.cnblogs.com%2Fbabyt%2Farchive%2F2005%2F03%2F14%2F118302.html&amp;sa=D&amp;sntz=1&amp;usg=AFrqEzeVaHdYgea37G1rpX0-WftLo8M5rA" target="_blank" rel="external noopener">给控件做数字签名之二:生成证书文件</a></p>
<p class="p"><a class="xref" href="http://www.google.com/url?q=http%3A%2F%2Fwww.cnblogs.com%2Fbabyt%2Farchive%2F2005%2F03%2F14%2F118309.html&amp;sa=D&amp;sntz=1&amp;usg=AFrqEzeccV6CP3ZMxjlvlAuIN87IlLDZeQ" target="_blank" rel="external noopener">给控件做数字签名之三:进行数字签名</a></p>
<p class="p"><a class="xref" href="http://www.google.com/url?q=http%3A%2F%2Fwww.mndsoft.com%2Fblog%2Farticle.asp%3Fid%3D1075&amp;sa=D&amp;sntz=1&amp;usg=AFrqEzdQLJt_IdVnAahvGFZNu_-ZU2B2fg" target="_blank" rel="external noopener">在VB6中调用动态连接库教程</a></p>
<p class="p">十一，调试</p>
<p class="p">Debug.Print 在“立即”窗体中打印文本 Stop        立刻暂停运行 Ctrl + Pause Break
同上 F8  在暂停状态下，一步一步的执行代码鼠标移动到变量名称上，获取变量的值立即窗体</p>
<p class="p">可以用Debug.print在上面输出文本，暂停状态下可以直接在这里 输入命令并运行，会影响到过程、函数中的值本地窗口 暂停状态下，显示当前过程、函数中的，变量以及模块中的变量监视窗口
可以用来“当某个变量在某个过程中 符合某个 条件时，暂停”，同时这个窗口会显示指定变量的值</p>
<p class="p">十二，安装布署</p>
<p class="p"><a class="xref" href="http://teach.hanzify.org/index.php?Go=Show::584-1146320901" target="_blank" rel="external noopener">用Setup Factory 7.0制作安装程序</a>&nbsp;<a class="xref" href="http://xz6.2000y.net/mb/2/ReadNews.asp?NewsID=239663" target="_blank" rel="external noopener">如何打包你的VB软件（一）</a>&nbsp;帮助系统及安装程序的制作。 1，制作绿色软件:最好清除工程中一些用不着的第三方控件，这样开发出来的程序相对较小，并生成EXE文件。其次，程序编好后，退出开发环境，启动VB
6.0中文版工具──Package &amp; Deployment向导。用向导将应用程序打包。完成后打开安装目录下的SETUP.CAB，并用Winrar等工具解压到一个临时目录，删除
St6unst.exe和 Setup1.exe文件(特别注意Msvbvm60.dll和Asycfilt.dll必须带上，否则程序无法运行)。
再次，将应用程序本身要调用到的下级目录一起拷贝到这个临时目录中。如没有则跳过这一步。 最后，将这个临时目录中的文件整理一下。 最后可以压缩加密:用ASPACK等工具压缩EXE、DLL、OCX，一般可压缩到30%。如果运行稳定就可以将BAK文件删除。
现在你可以将这个目录改成你所需的名字，打包就可以发行了。也可用Fusion,VB-PowerWrap等工具来制作独立安装包。</p>
<p class="p">十三，安全性</p>
<p class="p"><a class="xref" href="http://www.ymdg.net/soft/sort037/sort071/down-2133.html" target="_blank" rel="external noopener">VB设计小游戏源程序</a></p>
<p class="p">十四，Android</p>
<p class="p"><a class="xref" href="http://bbs.pediy.com/showthread.php?t=142918" target="_blank" rel="external noopener">Visual Basic 6 for Android|</a>&nbsp;<a class="xref" href="http://www.basic4ppc.com/index.html" target="_blank" rel="external noopener">Basic4android|</a></p>
</div>
<nav role="navigation" class="related-links"><div class="familylinks"><div class="parentlink"><strong>父主题：</strong> <a class="link" href="VB.html">VB</a></div></div></nav></article></main></body></html>