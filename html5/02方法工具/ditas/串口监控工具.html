<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="zh-cn"><head><meta charset="UTF-8"><meta name="copyright" content="(C) 版权 2024"><meta name="generator" content="DITA-OT"><meta name="description" content=""><title>串口监控工具</title><link rel="stylesheet" type="text/css" href="../../commonltr.css">
<link rel="stylesheet" type="text/css" href="../../common-extended.css"></head><body id="串口监控工具-BF992097"><main role="main"><article role="article" aria-labelledby="ariaid-title1">
<h1 class="title topictitle1" id="ariaid-title1">串口监控工具</h1>


<div class="body conbody"><p class="shortdesc"></p>
<p class="p"></p>
<section class="section"><h2 class="title sectiontitle">AccessPort</h2><p class="p">1，串口监控工具AccessPort137：支持Win7，教程如下，以监控COM3为例，要确保COM3未被占用：</p><p class="p"><img class="image" src="../../images/2018-08/comm16.jpg"></p><p class="p"></p></section>
<section class="section"><h2 class="title sectiontitle">MonitorComm</h2><p class="p">MonitorComm40目前不支持Win7</p></section>
<section class="section"><h2 class="title sectiontitle">微软portmon抓包工具</h2><p class="p">微软工具包Sysinternals Suite工具包监控工具之一，可惜只支持32位系统，而且最新版操作有点复杂，下面把操作步骤记录一下：</p><p class="p">1.下载安装</p><p class="p">地址：http://technet.microsoft.com/de-de/sysinternals/bb896644.aspx
，绿色软件，不需要安装，直接放到D:/PortMon</p><p class="p">2.创建client</p><p class="p">给portmon.exe创建一个快捷方式，然后按下图给它设置一个启动参数：</p><p class="p"><img class="image" src="../../images/2018-08/commtool2.png"></p><p class="p">为了便于区分，把快捷方式命名更改为client</p><p class="p">3.启动client</p><p class="p">确保要监控的串口目前是没有被占用的，然后启动client，这时界面如下：</p><p class="p"><img class="image" src="../../images/2018-08/commtool3.png"></p><p class="p">4.启动portmon</p><p class="p">再直接双击portmon.exe，这时标题栏显示Not Connected。界面：</p><p class="p"><img class="image" src="../../images/2018-08/commtool4.png"></p><p class="p">5.连接</p><p class="p">按快捷键ctrl+r，输入localhost：</p><p class="p"><img class="image" src="../../images/2018-08/commtool5.png"></p><p class="p">点OK连接，这时会提示连接成功。</p><p class="p">从这里设置可以看出，这软件应该也支持远程调试的。不过我没有测试。</p><p class="p">&nbsp;</p><p class="p">注意在监控过程中，两个Portmon窗口都不可以关闭。</p><p class="p">6.设置</p><p class="p">点击菜单Capture-Ports，选取要监控的串口。注意这里是复选方式，可以同时监控多个端口。</p><p class="p">同时我们设置一下Filter-Filter/Highlight：</p><p class="p"><img class="image" src="../../images/2018-08/commtool6.png"></p><p class="p">当然大家也可以根据自己实际需要更改Filter。</p><p class="p">软件界面查看内容不方便，我们把输出指向到一个文档，点击File-Log
to File，设置记录的文档。</p><p class="p">这时候就可以监控串口数据了。</p><p class="p">&nbsp;</p><p class="p">我这里使用ComMonitor作示例：</p><p class="p"><img class="image" src="../../images/2018-08/commtool7.png"></p><p class="p">可以在Log里看到数据，其中发送的数据为write，接收的数据为Read。</p><p class="p">&nbsp;</p><p class="p">其它的功能按钮可以设置滚动、清屏、停止监控等，比较简单不再赘述。</p><p class="p">&nbsp;</p><p class="p">网上也有讲有win7、win8下可用的版本，不过我没有找到。如果大家找到希望能分享一份给我，谢谢。</p><p class="p">我的系统是Win7，为了使用它，是建了winxp的虚拟机，虚拟机中使用物理机的串口。这个设置与本文关系不大，不再这里介绍了。</p><div class="p">原作者在被MS收购之前放出许多源码，但不包括PortMon：参见<ol class="ol">
<li class="li"><p class="p">https://github.com/xcud/sysinternals-source</p></li>
<li class="li"><p class="p">http://web.archive.org/web/20060427210005/http://www.sysinternals.com:80/SourceCode.html</p></li>
<li class="li"><p class="p">https://micksmix.wordpress.com/2009/11/21/free-and-legal-sysinternals-source-code/
：Before&nbsp;<a class="xref" href="http://blogs.technet.com/markrussinovich/" target="_blank" rel="external noopener">Mark Russinovich</a>&nbsp;sold his company (Winternals) to Microsoft,
he used to release the source code to many of his SysInternals utilities.
I did some Google-ing and have found much of this code is still online
at:&nbsp;<a class="xref" href="http://sysinternals.kompjoefriek.nl/rip/www.sysinternals.com/SourceCode.html" target="_blank" rel="external noopener">http://sysinternals.kompjoefriek.nl/rip/www.sysinternals.com/SourceCode.html</a></p></li>
</ol></div></section>
<section class="section"><h2 class="title sectiontitle">Device Monitoring Studio</h2><p class="p">网址：http://www.hhdsoftware.com</p><p class="p">程序截屏：</p><p class="p"><img class="image" src="../../images/2018-08/commtool1.png"></p><p class="p">软件功能比较强大，是收费软件，免费试用15天。从截图可以看出，选择了通信端口以后，可以很轻松监控串口数据。另外从界面上看它还有数据统计等很多其它功能，我没有全部试用，就不多介绍了。需要注意一点，它的启动按钮在界面右侧下方。</p></section>
<section class="section"><h2 class="title sectiontitle">Comspy</h2><p class="p">这无疑是三款软件中最好用的一款，界面非常简单。国产软件,可以从<a class="xref" href="http://www.jb51.net/softs/508054.html" target="_blank" rel="external noopener">这里</a>下载。在使用串口调试软件同步测试时，需要注意：</p><p class="p">1.先打开Comsky，并且选取要监控的串口，点击“监视”，再打开串口调试软件。</p><p class="p">2.串口调试软件打开后，点一下关闭串口，再打开串口。</p><p class="p">这时候就能监控数据了，放一个使用截图：</p><p class="p"><img class="image" src="../../images/2018-08/commtool8.png"></p><p class="p">&nbsp;</p><p class="p">这时候就可以监控串口数据了。</p></section>
</div>
<nav role="navigation" class="related-links"><div class="familylinks"><div class="parentlink"><strong>父主题：</strong> <a class="link" href="%E4%B8%B2%E5%8F%A3%E7%BC%96%E7%A8%8B.html">串口编程</a></div></div></nav></article></main></body></html>