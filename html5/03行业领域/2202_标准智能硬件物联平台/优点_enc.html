<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"e0a456b2224133f0ac7f0e512bbfe845ad3b0b231e49a866e5086a7ee0a9840c28d5b0e254ffcc2866b57243a633227a8a55324e7c1cefa6b8fabf9135933cdc2a0985600a6d10b584827d8c6a1f9382308db9c890dac32975303e6e67f0960d05e765c18e6ea3460b9e9cfaba53f64c41b57fb90d180d3f184229b96b2ec8ab904afcc4badbada077c27c674675b332c1bc2487862bcb611a4aa79cd1101699a807c47511f2f0fb01470c24a74ad497fa6709baf45aeab64d546a41f4c5a44c46c5b22855ba82f1c61c1102164cdf23aab6026659957f9f111ec2c765d5c0d0781a16ea2ec7ad5a1ced0b096cd6dee5ff788e1449b5ddd786904bea1cc4b93205154892ebcb1806e0ffa965c7681e1b1f2729b976fd3c45763d9b5dbc169906ae2fe4b3b976af4403b4357f8c0c7c7a7b6d2f9163a0942d309f7dfa124cb46b4090976552e3a28cd0c2aa88ef9a79b5bbd8564afb33ac041ae7eee729d926567d3fd2e9974e46b7406e8984e45aaf31f921730520b3d4b28714f416ed9ac7362e0847285e2b077bc927f2390b6fb2a707f1c32e33de395c54700adbcfb6ffc1b53245267d8234b52efc810915846df955eb5502ab7b253a0e7e7c7a62d45781c0cc4e3b008da326b0ae78c6c9a9b196367c4feb8aac450e6131d42f34edc9127b821eed4352c85917168f9f67ef1a1e1342567468e333baebee1e9022c5708b9e82bb4772f18e3755c54a120d17e9058a354ebfe343915e0dab732025298539f647267f7123a2fc2b81949ab3545391ac65b017de442a51c2e460ac53275510d0eea72a9a639d59ed04d4c4ce166b4caf424db24097dc73f454b4c0b1359e8dc8fd29b67dc3847d30f7cabc0ea52193225a864db9504cb830efdeca8117b541e3265aa4ea957d7922fe8a110deb5bc17ede22aa23c9bd24cb7d7d19cee4210d8b85c81a34931d0d209a6af54a2a443892f9866098f7cfe52a83cf64023ee44eb0a644e4440ccd5bfa097c16c072d73489d1ec1cfa55d2df8e77edd56cebd7348731fa2fa6fdba4918248694ee80eb202a040e1deba091138c569a67c84ded887d3cd926c02ccc415ef94473a92eaaf2e532c8ec50637e78c67887e96b65a1be63a88d7d423687d478a2a43da04a53e2da71b67e41ac6751126e7a4b45c52c324bcf62d3e76ff9e0ac9b4f784249be2e438a921b4ab262fac0224413f6f5f863f234ead7e1935289e6eacf9c557aee082f8a291b5d1b7dfb0413c7b902c1b664ff525c25fcad8448a37a5e4bbe6a704a828ce16325e76a09faed6a65c40f5aa3b2bbce2f33d93c5de609de99747c22670195f32ee20cefc019752a2a061d642b49fdba623834c0052a5986f6aa2e9b2a99c56eceea50b0f81befe0b57704fb5fbf1fd28fcc311b26153480eb17cd939aa2283dbc7e7487d35c6e835e4ac5bfecc485da25c8621ed3c8fbb85dd36a26f93c1ef02d0f353488474c5272800f2ef361c96eedb654c683408f6b4a750fa42ecc48373183c442189f9ac0ca3e960ad25b0aca7476ae6fcb58d41a5ff83e44341903ffe42f46f17a0471fc46367eda910cad989616d4695ceb02bdfc963fcb6664cfeb04e935efff98141352096ff5cadfe20decf495105c6978493288a76ed8b4d4344a4912d0779d947d7667a1d94194a1323810041101ee724744f4927693d01ec2b298dc26feb56a3717e65b913070a0035a5cdf983e44c643b74e3d816cb22a7918cfdbefad947792473dece675cc9620384462d1b8c6a99f8598bfebc220ffda47378d23cfec20d66e44aef879f2882df454a68b9dca613893c0f964c08615f29655380464e88b7c34a40c6251fc3a03891377ea4fe01c7553c402e37cf32aefbdb8018bffccb309017f557abdc09a4a5dd38f750b0cc70443c8158e0d89277e9511c992759606f7a37d811a66944b47ce32638d6e9a36995531ebb576ae86580184d33510753240cdb387cacb9e709a73ca35a535d2d8e7a18f18bc2ea80c9d2383de023db74424b5b8e9da934551c9e8f9ad9410a535a63eb642a30e1a05e1789b2a1154b1b0d9c61083167c51a3e0af3dc73e474a987f454ff8714d3426c2963569d6692b6006a6f57da8ffca934b6ae10d28bb013536cea0f64c7c9cf725455ee5f03f8f2e6da06ff078ab34cdcd22be0ff05c1121d5837554550a822782d86595ed0513bd30cf85f0d8e887f405618144768bae6bd48b06e12d806f42b2d2d29c2deec99a1e0549f4d9976616ad55976d32a05a9f201e9600e6e335ab23c7ab184f54ce9b7013b9a96cf5867692cf67a619392e8138b1c44e66247558ec28dc29c43990ac9575c6ebc72e3286ab5969386bf6ab096cb7ec85b71372d7ae90b815ca67e6c2c12e2854f54c31f7bdeae04299926191ff2d088c63e85dadb9e7d6fc91125003959d67c575f7bc7cc1d09024457fce6ed1dad5f5f562aabf7b366032dd9cd599ee0941c8a76ab5395ee768635b35a4ec682ef54699bddef2784f71d126471d764c93524892e48771a68369d27a08fa97b925f9798ee6f2c20c88ea005c0b95e1c725fbcf0d72bf72d636f5ca87c8f7c10956119c81574df677c08618160edb8dcf3546fc002422aad38fe31ca9f1c409113ac8df8bbac9b954ba439d8b6e477304f71b5875937573627eb92e3ce7905a6aa982b37da95ea98a43d2391d634e38c0da39cbecef082f9e41af9552d5b9c252fa7d9a024144f97d9098653eb5e0ac9d1642fd0645fbd460fc950d13317b6b0182aec597845d0ade0cb7cb8089829ca39c3ffab26991acac935d78ec1603ea6fe09919f2864d6f156902b7d7b41e2da6e4a3f5d7168f8443c7ed5fb97749fa6b7fa65fe9d00b220182a740ebfbd6e3b1194cd6405714547baa71070e4b1d2bb5ae58cdf6cad0c89b3e9b452d10ed8b37e89af4d83c95036da806be0c064d43715bb0dd5a7db8f8d6f25cc0819f22cd8588318a6ac17747ff5db68d1726ea7fa73ea2acb2b32d102a74193b6847abbf62a322ed0ebc7d5d813777e2262ddca88f53e163ff0f94d9a774d5d9c326189cfa957e8d65ba6dbe468084a33071121898bf3473c639290db55ebcfbc464db607b6ac6868175b0cd971f2c254efea8e00d2224366ff97c8ffb49ee4fd3e8c19a194823cd21c1b13010a173518f5babe627c7cda0c6a149fe044d257a355f83bbd88b8cf274bf92712c5732beec69e736884b58f11788cc212327b377595627ce7303956bf5405d465f9e1fffeef99c37c47282695745efc46b534ee48a3e03c7338ae3a287f01188cf69b061afa26ae54a29c78040b5f0b0db9044d45a12a147505f0e711979f70914e9af232e5c686c943a2d1a2414deedb13d7f2bc16a69b999d37b8113f6fc36f9597ebfe9b2d0a75bf2a91bb1d1f9a6cd451681a921a87894fa93b18bfc68298d00fc0fcadc927954ed699da2b212a174dc61b3f372b4c95d9afab104e35c08b655b034e61ecd15edf8e4894646be269e115e2e26ff464b7b7e743c55d99e0262dd1f22966548cc70b148f7c738d172a2d1cd388e355586e9e3a30d5fc1b4c7fd49db09fad5420b7b1b50b83cfca646652a96bb9da19f98b121955980d3bc78a4e29368d204df46804f45d411aff6e64c56e00a58f633f5dd3742f22f0e0b818e18c318847c23739fdb70757b938c3ef87021482c4433d34104d0e1dd27f30849605f1dba5b338fa6375f4e61003e3707c61dae031fa955515a4e04e8d6e3374671406469ede88513bb9661d73b52a186d0e85dbee3b1e33e8ec076e44cee42d8b5126f78e312a5d3f8bcac29ed0590e0a93c47cc8e19008b865d34e4fcf4e447ec349c09dc6b11266131b4acf2841cba0051468ce7e1359b520f600dd08dc04e367ef1177c69e2dfbfd3849e8199b1d62420675d0a6279a90ee28b29e16427f94e2170c2d2afae0107c0ef3246f289a9cbf9ef0b3608b67a37e2a8ae962f3584923a268a41d46a1394f63df6fc9e811b6517f20ffbecc5a88d5bfb6769505fd95007df7caa013280085de4b8a2692c97a159c93d52dfb1e4933976dc1cd575c0d3c252b1d22ca724b33fdb87e31157f6b2efaf4230f4df7f00c949b862eeb35b5437ee607f838c78164187091c7dd49ff275b25b7941c1436b2066735761e24976e28a343770ed24877d963d29141189412a42fffae2accdb1ae86908c5160fefac02e2537c638656e8ad8b7f44434ff376318534896ba0824a0db2ad60e07a21eda8dfef68619a03bee8f70102b2657068db2f04bb2d71a172fa2da724d1d7794a5e0cf41a1f1c6467aad7a9448aa89c688df714ff0c9cf66b2a5c9229db9f20c6a7d0a298cd6122c82d556fa69847db98561167c7bda9a648c519ca58f0caa99ef1c977c19020006c5b5c09fb0659f4586f7eacc3c7ea689686af9aa30d8b6ad9bb48bda5e15b944db88925af5f7c1887b3702921727813a7400a50062461ff101cd0869c30a795c67701f0634113686c9c5383fb5e76a5f11a97f78733e711134ab3552b9584eb7a09143522a203a51a1f33871e6424155b9caab0f752bf84c8d93b89795a8b6f43df1276b56f48cc12789a02cfdf6872b34aff0932481d36c2fd4be4f3cd6daafe9830269f3cdfc6d0fb232ba98a6c58c1f862e6994669c956c16f7c6a167faa7a5443d13bdd4698126680c3382a6f94ca3adcbfc00b5a078642786ec4251796814bb0f034c2db3f3082a323d9becc1f2f9d6288dedc7fc8e8012aa08b62b3f206bbf2adc2acb0564c7fb475dd5c83a1f9d891efabb1bd649dedee41636af0929d0ae745c32d06d4f7070121dc14e792d83b7b50650bb7c8370f713207ebf6b3f14af307ae57f82f94db7a7ffca90782720e6ae1b7913407ec72129d112d2f47e498ce25942601ad5573eaabf6e79b4a7312035bd7bfb790eb18ec62f662e07919fc3e2be46df57c6c19d10f9d89bac23818eb730a74ad2dbe58d7abfe0ac2b595d1f6960458ce1054ccc71189458cc40f61da82cdf0ca7d7aa6bd80f610b978e270546cdf4df7ce62b893323566848b4c264ba34cd1d984e76647fe83eae4ad93b182841c2c3efda7e5b183e7d4b117aa6c3bff1bb271d4afe82e956a4f1011c858c81b86ebeb1dca6d4429b1603a3b5f65033dc7da432013c655b0b27092d657bd37e0e131d3f576a767fabb5952f044896b02d487f5f8fd8233774384d09df58981807eb9c3302e77279efdbdc4ffa48b0bc1eb48234e98cae99919ec3a1044f3cbd17a765839a40807f00c83527a97547efb8434f7ab61ebd32202c0ff7549e118586f863eb57124072921e235aadb53781b845d6d6357d3d0bec3f7c6f99951e57f2bc8b9c1844e0335f9be000e1abae35741ca9a3d4f02e5d209002b33c1ee792a8af9cc1b9fd78a6c89b6942ba91ebb3e854bbf1ae831ccd87f5d42a8367bf76167f1a501ebf295f0e7c6f8b0f7016ab6de84640481f609d8aa79bdc9160153280dce80bd4883a0c98e5f4c0163202d5db5a8b431574a7f3edb33b82518b842f89f21353e097310990455fbf60e0a185cfa3468d71fed89817fb56cd576c5ebda3e4ddb7447e1ee496fd994c23ea478ba1abd3d736ada8154fec513618d354c9c37dffe96a0549c1402fb2ff499067228bf7a0a7d5375a25fc698f0b274857997bd6cc9b1c2a68a1d5cbc17bf61ad3be26484f88d3368cb4191c0ea3aaa0d1922bb134d146524402a70465e5829bb68183c5c76c9bcb92e6f960e78ca42639ee72bd277fe4ca5923881fc98ad738e45f03a0f865337b139922cfb0d099b24442ffe4d02b639159ebb73dbfa6cf6a573c70d7e7f74970e0e29f8ae7bc0bfcb687cba238d43cae0c1f7eeec58dbf53968a7063a62c50bab470a86cb358b5c611251fc9a6fac5a98500f7b3406060190c90ca3499ff9e5677e0723ea70a4fb7e22d0938ae305e3a38b3f48bab716abcdc801c52de38a3547e929673384d82fb31bc35f486b301d5e02c9a995f5b2cbdc2f0c44f656240aa4d160641a20a5693d9305bde36d6aaa43ea5b330efe92adebbb1505f23d39be7112905ba32e311a7e8fcc3ae00b9bfa71a215eb81264ee562bca492c9530f0818d9eb43c28358c4be6b43d2ba6f775c6d34731e5c57d11202b0eec16f5aee973f5c4fba659e8682d29c8c8f7d63e2d9cafe07898c326e5251f1f58c1d6ec76c8bf5b43d01293ade19a20311e80d4c316480221e9bf31eec3637bb2da57ebb3618d0cea8d3cc49e58616885cef9ad209ebe9b1fce8ab95d3daaad3751f750f86453bad5309182320fe8735c6550cffefd61b07bbeb203158ea9afd08a13bc6ae8c5beede22161c208ebe2e319e87710000c3121294eaaab3827c571ddd47ee2e057a526e29c0bfbeb8794ff409398808416ace89a94025e296fb3ecc630a12de26cd26068b6a8d57086d3ac4a38e980fbd81fac19ac0728b8ef057805e504856435671599ffdfaadd472ce436c312dcf083cc1a85d620548880b0cecbcb52ce12081618091328cfd5d64d5121a61462c5014b22f25fa1fc2854de073eecb4de328fc123b82b00442a64ffac276a0a7889478e0b76e39a7da31aef41910bd8ca9b9be3c94edbd28cac7521cb7e5c4e257e0f50e4aa69d625f9d12330e78b290b0e6319e536f5ff5d087bfccbe6c0b152e74c4461282265ee7de3cba4626452158ea608d08b9bc5af21a6468253c8959872a000cad94e0a72a5fae700b3b5038c4b75ef8098c56b7d4e39814acfd73e62bec6829d63106c6810289500d84a17079b6a946da7694e64b2814914af2e496d278f886c7f5fe89887f54954bdb87c097e388cf15c312f81c526bb3e8d2353db91e1b907e15def073b772c92d671588456ce39ae4181baf4ea96f403b6cbf56ed93c5e14b7e8fa885e663a945c99285dbcf6081a309fd0340ba03d2b4150745ee01d9b4c1c6916d1a027f800c4c2910eff8f62026345b3bc46a2b4e0b0b9ee61588cfe1ca0631a6f71dbda1939cb6f2d436b895dae003b252bf8c410b40819f874fd0920dfe9f060bea6f6435f933397252b2ede6e56aabe35cb24719fb8e15b926a94e96e7d2ba5034f6ee4eaab2721a14d7c7ca259304d6bbf5554a4ecffe7ba7c88faae3e5159c1077082aee270e40174d1d0b50eced9c75397ab72485c6e6874f0cf28340e599d4393cd92e523d3d461c9f3a1f123123b50edef9c33635a2c2d145a783b34c95ab5cb8f91fa9fdb81b2673ae5180ac35911d22ea37ce136332de3ec5515373c50c9d482863db69ea6e97af1827ad1d285568cad0f7d899802f31023745888e3729b8105b1fb20f94b85902e0fba9fef8b019ea88d6c631a419fbcf233e6106d380d6d16b08111b61b062c7ac0fd59f109a36ac3c016d2e92920771b3ae45a4b868fd2937951e58b88d032e7846898b4f8d785abad6907db0641bdb327add645330b9c98ea9adf13b185f60faadc7c13f8cf26a27da420125513d8f94ae92ea33db91c93f14e158ac4094d95244fb61919f54001b30b48bd5c6e6b564d78d6b411282deface310200e7b9896ed77472ff03cc17e3302d5f02968e95d4ebf780f7cf06c01142a52893555a8c36b1b7037952c79aa84b101d2339b041d28f0f9e444add392387c8a6a75c2b19c4a7a0e7013021c1674358e1be73278d9f8ff853b571a48c163195bd8dd331b207d7d9b712a8ee3f7e850861868fd57a42fd0c44d452efb7610bcdb70b3c01a14beec0a92c96aaaa82a015dfb28b7fb2c8377b0d9fbebb7951ae33c58a48c604a3d7da452642fec049ad79836ac940f523f361981307e075891401cbb833a01ce5dc9314d59fe214d82c49f0cbea019cadcdee286aec7e3b1dd1decfee65e7fecc03e3f9070b1e579096db94f17525bd634b803b8cc7a39866d2d998a2e5f3ac4fb6c00cf0b2034ceada2d15b47dd205331770741f1632eaff4a7221cec7a944363cbf662474e7386553d4fb662ceaf17f013c7ffaf523a991176cc3374e0732328796c9b9f4cfa189ebd093badf2e9faf3a329469b8fa16153ea70ecf2224edf5a266b23a38b02111c22d2c48174c3d70eb86dc1d4ead62de3ef36e8b2a175c7bf500c4104519b5c472f59bd098d906eea9a09c4d2a2f99919332d55ff7b232a50cf3ad977c940ebb43f2b89a707add43cc6270559d577655ec1cfad4cd9a8a699615ccc983c4a849ae9c50d319a6a6c0d26c368677054a8f312c8fc813cc98858b2635119882a2c0d4f57daa74198ec77d76602463dc8511e708bc89b8ff8cacd74380b3135f512c83338e759889c42c5e4d985b5837389bc949d6aa859bf78694124c34509400ce1a00781a6da8b767d8f3af9598de8c0dc67b2e0764daece6a030101e388ef86b7d2e7f6285d3f58976b262dba642b791d1598af89b51d42bde173182e3d43e2849a88c9ba43dff263b3a06471f38e8d68b4900e8003e396d96e487e157d4f7977afb8d6429222dcad96f4c8ef868514997ee00b0fafb4e687d3099b936461c47b8944de0a39b01224f3418c6ace90080eb69938a25f5c8a7e493bb3c0acdbcc61b88effe41855522ed1d13492160aabd65b410460fad5835600db8a8e90c11d4327dc33e4652228a8c829d4d46f6ca02984e390c2bdaa5f9f6e08b1626f07427b9d7bf4c19d45303a8826a02a54c2f5c6dd47f86b57cb878fffd1b9a652ced462db0282fe32967b1eff896b82872406195dcc84504574d732c0dc431b71932ca3ea7310a127218c7502b443ac6580b0a257364aad98403e3667f7481efd24c1ab35c5796ddf7d956d487d3be46e756c69790c65a42acda0a82985a4874dd89a67dab2731b0bed2a3a6eeb26883ca5d0c00100dc9f31db0308a48d1f8106d79844aa2efb4e9c50ebc53d96c930d0b92576581094f22f6e77cb190c987d248cb96fad47d00a0fe90445c63f34a34d97e2f8b08d4a25c387d0eba0562eb6e22772925b1364826027ddf4c7047b657896a02211349f0db99ab34529e6ad0d0cb9cdcf9c245b047c97eeb16028f8251a1d3fb7ae92870bce844397ea1c6f1163a3b835371cc28ec895a867a3757eb3eca9432240f1f6afee0053a39ee567f62c6bde4214167badaa147c05860a7d3d6c22f027eab82436a4f23ac857ea305e6277618713fead2e3963e8e96c9ca3682b1afb8846473c06c5ba09f28a15a2847cd9cfb5cb4c24c5af293369299e88d320ba36f5ea342f7685991edc4fbf98c4eb23efe12f59dfafe19ca70fa0daf58d1ce0f759959321ae82bf3af704d08d4d9ac7641938ee5ef7c7f5177d35edfe11537fb6a0f0529578af9cc6f7b61af20d41892822a456fcbf80aec5061a918a545580ebc9c51451eda72206c70c2b311392edc6f230775aecafb1ad71f81081ec5b65266ba13441b07b2cc329e5fd7c490cc9033a825c1d388d67a66a4f91a0fc1a5dc98322ec441ca366b186a56ef0f5c007f3ea47f3c6a68b5deb460e74f6febc4edd54f3c108d88a7e0a4fb68caa19e276277bb8efc3558e1276a2114e717caae6725026c263d71fdda840486a8fe55bb2ed736308cdeba1e3e19f3f39331a88e3f4856fc7e3cfc42ce774f6d0f676edcc5cc5f969efa87fac126089ea4f58c9e653279cf710d0f0080320dd229578deca71e184777ac4a598ae927d6d657222f3af38a9b184931c8108916c22390a7785e929f9915a2b89c467236d8c7dfb4a257d6c8fb2037b4e03270c4087f5162d14a8e983e33c1146d6479b74cda062123c35bb7755d7154a244901bd7179178cf2e3457dd49f02839cf497a86866a5c231ff10ebd126df77811f436ec6fdc3c8c8598dd09dd1a7c3c5a76a5f6cd99fee41b986cdb164bc3a22c243defe5485dec8e52bf6b1e0b00e238720a25983355d06bfe020d45b325f8597e1099560a63bfe02bd82baaf1cfb3672aada8ad3b63aeba8a7c4913d380995734b330cf1ef8b3e225473b28b2325d315e9572f0af5356730f4b3a9bb172ffe11860603e9dc8b6e4a90c41310fd36235b60a6dc1380d2c8758ec6c72471bf02218d7ac5dd56911af4501fe30f5a4bc1b61b4ad3353803482cb8b8bc33516d5284f831ecbfb9440330dbdc150bfa25e9625c88cdea83f5f4c3cdf054a6ee4b44adc26b597929f435ccd482b3a173b17db08bc038c8d87740855e666086a654d04652beb4068c79d8fa59bfce9f624ba56da6c9df6d6c8da6821fef2b9e0da8a5ff81ee633be5490b4432814feb8f40fbad2597d3d0ba7c9030d1c3a598203c4c25633f1d8ae9d543b8a132cd03fc04083bfdb78f95ae6554141e49a84befd9b9470b20a28c2cb7bacf2fe7fdc7f58b4b5839565ba7b31e381775f653899b4d60864d620620d504976f468404329de9d86a13643fa7f249497ef1bbcdc1b3573f06e4b3d64a87058b22a32f9f8500b6a60a40bd4deedb68f4ff46f6561004cbed4088e363b78b9e1e9684564a760f7a24c738a13981c65ae2493a5ff5f0ac97d66abe5e622a534686fe603e4b71151700404c0020bd0618013ed6ccc742e7b7ca5d0742c4a643d3c3737ef7ad887683719c2a4628a5e79600fc0e0091968eb1787809862c8081325087a62baaf4c0573c40036d33e25fa234c01b6ec63a575899a1a79f59fa27263b9d0ed7ffe5fed67d4fea20876d364620c34576e9c216d9a2b8cfea4091641989be80a2517ce090a1bdc8a4933ef1dd358c3e3832f95c54e1fcd293b6eb87d139fa9ab6d89a5fac7c37ca541ad50d5a6159f1b758f5b616d6ae8d40661ddfb0c386aa13272de60d5bcd14e2e0dfa49cf90a53712729ff3aa23705f78f07af4572472c53ee288d6e9bb74c061e7cecf1ef6319c2fb90e9eddeb5d8667f7bfe5c075fdc636e1f2facc022caf675510d0cf80725759a9abed98c931103b8aef6a2644aec70f3f233fc4cab69c08e4bdb6282bd77e0bc5c092724846d473624d3fbd5dcf66a34feb847b9a11c2a308b8f493e9ae8391595424d4e737da38fbf0df56c42c96140834f87c864a300457a33163429483eff6ad9ce29ecd37b18c0da8bba7c1607cb64b1eaaef79b704555232b2b4d3dd70a56fb2867816e9374c797ba03acade72036afa00bf9cd12c38e2782472080f726f92c0fe2594cd43d8a973bf70e6168056c37a2629ce9dee021ec0004350e44d7cfaae291c95faa7b13b0a5ddab493edb5464c4a867f1ef4e7d8f4488b760455b2440de6ae274134c3106734f977b5a9c491e0d12b9e88be527ae9d75ea48749152308903b309b6198961c51b63dd8821b9bd80f25ffa1b5e71a71ed6741b9b6720df9b12a361d554d91c42771033ec7b7e4085e5a1ec64a3c09baf0c44547b0b0126f978797e8a620f9cc23b147d2599b0897d3e5e6fa75a10df3a1e10a64eb1d9eaeae573799c44881b4e015e5f194a2f30a300137fd7649062f261c42dc71f34aa9f5e2758e2c866ee2687956382155fd1f2b42bc423fc87c96e8cc8dadb124ec05945e679afef58296830e38cc306faa779c8ac0537ee4567a6c74e9b50aabc398e322d58107753676b4d5475791873120598a9d848b0c94d688dc8fd56fbdb933b7a7859b9442be51f5098eca5937e7ccd480f6f7f03472bc46002eb70f86d1cca0faa73be0e86097cb9cec536d28fa2f8dd1be8a9efb4a51400865f1ebd9ead7ff9fd63526d334e567d56d7e465d520cf67d16c73fd4fd690dbfa6e4df86b6b9dac423ef636cff917e2dd6be4cf2601c2a8c4e0e483abece6a0b7c4330cf66fa60818c73ecdd0041708d857a7711e4ee37cc4330d138fe0160aed4053f50973fd746b54a6320877129fbf058039699f781afd2376beb7d3b1804d0616eb8471044853535edca8c196024b9f7ccb4cac5bfa7a67708533de24f7489303d14be18b5d3a8cc0f2a23fd2f6fe5c7fe4a7a6b5ca5837e474eb59f2311c4fe705e920ffe9ea890e0a3b51da0fe7248200ff6f4382bc44b3c5bf857a50ffea14ec41d305b05378c80e34f47b90a82e5fd771daccae45eb3706bde4e21311851b1ff8aa02d14f901ffd593fab60389bb7bf54d4f91840b48e9eb0a675c2d9c6aa2ba6a6c006576d6d58c3c4ff4ae7a54efc8fe1a3a8bcb2e8efd043782e3f6dfff71a04ee0447b81c749e28ff937e5a6c4f281cda34c157e14e238764e6c16ee968a86e76446b8d48e0886a83d8ccb09effd03e697d4a863d569c6df72a94f9eefa4b708a88189a9d8ca94af27e31638d6f8f7fba0d4662807a827fe6de7d4e08b509074d7af342cf02356f0b340a7c88fa3028e4a9b40677f0ab7a8ce096dd016a8567f3dc0dbd82116270bfa62baa9bc76f14ae3015d4030d7aed6adfe491248bf85837c571f45c545a69e7c451d686d3f6ba41a1c74d21480f02055f9336407f0d6e2998a8b2c9c0fdd8fd951be4a39dfba0a87e300037ef1d22a126b9eee970c7765ec987f035054401c4213e00c5c5d65f2cc574f1f9381152cd66e1caff1914f5699b1287dee66147c33850f7d5e0a2858bedbf7f126520ebdfbb2178c2e1a4dc4b582f922f72ecd74249a19a033e6f1f331035723db72b72bfd92e4dda9c5374d7142ba96e28b5dfa5346b8cb3c6df0f7bd355e96083f4d73882105964bbd95c88bcb323b9cab0dbb0aaf441ac9ddefe56629a8dc3b70791e230885bf75f8ed239e23aa990d5fd24a679bb35f0843b2b99795c225c247d26542c54c53dc4e7a268a6fdd3a88a48eb84d3044bf75649b7701f2e656fb140d37500b9d7a2405102afda5495429299e67c7662b714448859cfdecc0a3f64c7a5708c290c951cbdc8135cf66f7758f8786280666e0db297c74ddbbf042d58be125d6779d6cc2fa9c2d572d063ae8984724d8f08d17d25fc0295dad3af341bc455645b75335efecc315dc486c37424f09fc84158dbbdad74fa805fb0396e5393cba9c3a2124d85309c882273916514bf7bd232160e2eba215a5cd4e46b70893bdef829ecef2a135562f5205b5ca44a7f36bf75642530849026942dba20fdeaca6c0b09fce718e4c17cf6c3d4e93da479dc9f74b38fb19975036a5e6e5e56b7fc24fac78d330d19968bc66a1d55126f569e1c949503f4b2fbe39038b3cf59e64a81bbd34cf6ff61f0ecf2a914f1bf2299bbf07178fde78fcfa00b146dfe5eac18a1db8a914666a7848b360808a8da2cc2469083ac41d03fc8ef965827f2fddcb57bdf3617dd0377e94e68fa95bd5055c8dba7ed04a9e456d938304b3471c633fdad6fde66653a92ea55965d167bf11db32f95de9541e9672cd8d7c4337a1dbc7406f4ef1167be1d1bffbccc68a9ce51f8f3c32f3475f098dd5944cd0e3072a6a81c7f7c7448be1f91d254f7f0d26d2a4f3e03406344ef0d5dbb4a1a89b1eef8c32d604dad83995fee0ff1b49e668646f5b9915844a3531ebfebc3c6dbcacbbf96c5c8c3e44cb786b4aa3def2f17a062c2810cdda5c0836d0c1614d9bfde9966fb0ab16fa42f6a063452e385bc600092d417faf9c1cd79cb27d19c2d1540786273716de42c6f4e738c803c1097e54e81ff2491a8a16f8d1482ff4a98cd8d5ca99c0fb80b497da0b5ad0bba1302f2d55a634fd78c3a5867c2b3d3c32f55d7efdbca23b194b77ba90a259b119d7d085414760ef5f24b23da5627cb2d3046dbcda5d696e258269403024f597c9154f0a8035b90ccc420b37732d82924279370c3f14b8d69aa32e175cebdb747c7fedb37dcecded04c247851cd3eae260b3debacfa136d341bb150b07f0331f91467ab0632a9cce2de0588e183ee6f259ae85371c26f35ed57a671362d23ad80488780daae2eab7890029cb00da199ec60505f8e8c09c236e4492095ef2ca87e8195657c2e305caa7f1c3b095692a5875822a43b6de0799ed28539e53f9e8602c58a05335995a4bb6c29d524aa2dbfe2315b82c6585ebabd5b03dfa57938ae6990b0b683fed8f1bac4e3ab2c0d40aa8b0d1aaf8b3de4e5df8e2e68d3bc8658204600d27b0b0589e452e087fc4cee2af132daff736fc64cc0095d0f0d8e3bcd19f16d21a7f49262baab5d94498e8eac6874328b7bc0d5c3edfdc358927850d6f2c04ffc9d76a396b752c53299be40c0015fe36806abbdd5fbfae5159d99fe0f12023c37eed931a71854c5213769ff8802c7b4d82ddd60a54e0b10b7e88b323c83256bce89c9b9f624161469f8897e70812cfda46d3da2383303c7c1a91762bdbdcffcdea7411c776ad4a65f9f4e7cfe54edb5c26c066bc1777ad805c9beaf156cbfa809748bf9cb455b8818cdee7dfa2b06fef3457179c49c4d5bacb46bc6b98223eb4495dba5f28b29948fed2dc7b59e76590642df5fea24810575355e4b710bc84a911a6c20c30c5e84c0a8158ce9560c670f1b9d6c0a995d0ad0f1f6cf706d67936fc38663d3b41a5c4432c1a672134bcb69ea73c1993625aafb8fd126b870f99eaf6240a4ef66d44e0c93d59a5a14fb5e35908eb420748d494abadb0829677544658a487b28072f2f8d5c540a90a05202f430d3b6556151b3189c5726506a767792a22135e6041c75a7ad728fb059b12ed1ba16116ce433bc6ba65f4f014b2b71e5857633a24da253abab2d578e44425ce0fd008357b598374e82205f3f1c54dc93e9110f22fd66d8eac34226fe0851238c06a3197ee42914e595d1cd58cc22437142f9b63bf8ac0309d814a5a9f2fa7f22e30e8e89375c2a49b8eac1bc6a57eb6e481002e8e77c7137221168852f6e358c469bd29fb90ae172e57f3af97ac695702f7578a3b608dda4ed334628add3d5689052bf58da72d55233b214cbffcf3db98ad29eeabd9d624647fdfdcc0d08e24a203152578537b6df0bba0127ebb505603a77578845a5a52a099dacfed6cf567dc32341c6edccb4d5f1acf4340aaa4de73ef1c1eea2a02ce25a07fa42999dbbc81f4f38746659d7ac2c78110d731b486894c1732ed89c5bc8171d67fa9d1fd41a7c29fdaeaa769f452ee65ae5f503fa85253b425d7580e0fde1cf013241fdbc2cdf2d5f341b5e58","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"a04e2aebb4f065114c065b7fbf49759e"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
