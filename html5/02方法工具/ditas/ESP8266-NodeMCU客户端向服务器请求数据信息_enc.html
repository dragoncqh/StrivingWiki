<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"b7d8cf63f061e204539baa27050cadb65e9f3581e9ad63581112eb44b3056529fff607252ec85433a0b221a4e4bf40056e17c2a317ded5bbf4c8d69a677216a0abf32f8289698eb121691862ae0f5d84865e80d88b990033348ff9c4aa4d7f8312d32462761602ff89788396b87d66edfc4eddb440a6b44908ce375f73400e298a140755242208c065f2ef8237833ccff2d6f1e43785aee3161090b84baf7da4d582b00a71568cde015f8f9f35049d54979a1926aa003577b81bd49ea79440efed0853395d0168ec44de441b65a271bf2d250140ddf29d625478febe16b6feb03b35a7c685cd4b61150f13ed911eb6f90213caa3d398e1e06d7b305ba6dd44977603bafaf7124c2d67698de587e413a1993ea216469f472030521e0938fac18008a163386c3aa3fbe92853abbb7b287919e18e68d6020754ba09cffa1d03c2fd86408536aa69b6f797cdbad20d9002655e4a872b721e5afbb43aa9b50fcbdc69b8afdd7b85bf8e13457ed098947a67b22eabb2314fd640af2f7698de28a063c9aeef648ebe708a241c2753785f627aa53519069f10e2d977c3e2b292f097cf025625709382c20a183e3dc7b8c57d85e596deba4aff0b60f49a5624ce2cb130d58986d50e730916da78008ea4041bebcac9e07351cb5b5561d0677cb36391218009d08a2f620d98506c6ee50b00738d5f84103077fa09828cc2b2ce6f4c623655e909c67a417d4f36adb2670a7ced681e12f33943c98e3011a304b9dcb882ab219906a4adabbabd00be9be0f8d772e64660037e5099b4e4a529b3abd30d00e8ee3d002237ace1b821acf8c2ac7be9609aac96cd157a5ca3e359cecc3d3589c8a8d4a5802d3df5e4c050f4478d79cfffcfcfb1f1104dcdfcd96eb15f894754423eca5fa818b00b5db282a7de197e5e4ef6add1015b574b8046d4b05e2cb7606883eb3b1d20d97a3b64d18ff00c65ec539e1796a8caf6ae11b0e5d959b6d28572c0da6014f6fe06d3f1396d414293e68d41736042e2f1c425654ee9658c7e975f724b3e027152046ddce225d4f04d0e47c26424996285fe5a9e586a1afd5cc0d946d94ba744d6d94b0836b34ac358e952f8305e678251c63b76829f236ecd503efa1cdeb98ea71e52a16683742cbffcc5fcaeced3bdf7832afd83b043e96985c4c81d6fe2e6e43a0dd56aae4de97c054907e156cce73e4e75a4b16f38b554a7570d9c64b4cbb943613341a95928efa15327d9d6f6a7dd647503188b27f78762a63dafcdfc27e091d26fc82a253987b9f12832d6bcaef4dd9a7252585c32fade3f31b0f0ecaaa0d07c19a241c7a492c884050e31f8e354b68a05e10a2dd8e5d9387e1803bcfe9b9fda038045f461efc984c173fd5c24db6ed54001b4835b91a501311e5b4e60ded959d9c8d3c6df0a31d78618ef4d7207f27da51777ec3082e47b1990eea7fac77bb89196c272d59ce938a8c35e056c33a0e3d464c4aa5d4ab74ea7a61dedbf879d458c5f466ac9d16a58e4b2b87266ec0b40fdaa956a763cbfebf51bcbe72766a6f0858a9c318f3ee94b7988b55829b738ae7b085ba9ae882b178231e2f51b8e125115f3a3241223b2cd29257f23c65d5a9a775f8594e2e99953b6d4b3f764a026503712c48829b9b0c80a3801dde4c040d6c656ec6824a3aef83da12b5d1f0187df4fe8ac71096e8566d69d9bbb8b81284209641fbd4575226a68f58c37ac34e0590cea6d6788237109f463a2302ef8ba63af759b67667303a5aa67bc11c26c99cf47f19d82e9a3e5aa6527e9669a9a5071c9d38ee2c08d39b25afaecaee2ef51d7cb80036a71d246acae794aa50be8f48aadc00039f73b67e8993866ab5964afb29442bc001acbea52115bea06e19bd8b5c1daa996f8021a230bb251aad505ce261cca670504f4198480a0657bbd593a8ea4beb2c2ba7ccf190a5ef25db0a0b67d78a3eb812446ef7a002d17ef8ba3b1cf451d9a587fe2fbb255e3e312bf21e8160d7cdee9c66cabeac2d719b341fdb3d9f455f74518be5a7e83bf94fe862e197d02c9168c14c6c3a4bde1956f59fa2ebb67c6a3e16a2b3d02a9010f1a27fdcbaccfb7e3389c0d34411b0052b1c7bcac17897f6354215bcc4169eb29aeec9991e9414379f646d889338e2891e9ee4166f2ee0029b299009aa6e1c6cdfdb09170ed8c55d839852f6adc32ce83103c122348afffd96fc5ca71fb42232ba3dfc0d05482526573c03fe1671ca11a9bbeb03a5b322cd27a07af6eaa3da66a56efe99e60cd342b71e94cd19a9bab5aad6cb761a27b1c0ae332aa1a619d574b783f38ca680b3d272c7e29435fa2e15f1168f50e5b7de36c63818566944f55ebdd09494f567d3e0efa8870e8e621aec5624b143cfb42f160be6b7d9faec926ca073130f3fc8f3d82b4c5113d62cce984920196e28143c665f4e87216d3fe70dfa36811dfa39b9bec43a4274bfd501835c0b120aeed56fb736cfb13f57af53f9206b39249bc4c49e42cf0fe87ebdc0dec0eed5008dd1c7ed1f08fe421c02a028a5b96245fb4c6b3ac9e079c9592f659ca40ea4d883fbb07a2af74fd5275744614f93bf14b0e0c93a58396ecf0f1436937f80896d3ad8c22d5f8bcd5e3f0d88e1fca1df7a07d87ddf883cb0d2e4647b63dd4baefca0a1d6fb2268acfe24026cae4fb67f01b49b28ba7088f5022189e24b522185f2386b9e46be08a426b4f8da897ad479fdf3b1d395687234c0dcb19ffece6bad3fedff772fb9744a1506414ab353c896aae9142a8c74aeef9877ea1d60bc028f8c5042537dae30c6276939665a46ecf3d90d7ee7b91849d7b56900b2e572b84b7a86c7a2db3ad847f829badcd9012502f54a9ffb89fba6ec237e0e613f3a5121086a09afbe114a31285e92976baf2e6f0d18d07f6b07f902c8f30dd80f116ed47cc75245e4884229a9ab5aa65467b13cf547702352351837d42749c5dd93d0791ba625f3d695368cb8d755638cf9817d570febfcb0a39a09c98c7f1221e79172b70eae3b0a047d7a1866da832d94bbf5738dcf2b6f2c02edf3ca153f65d9bcebe1ba07c8da8ef3d2a2f13494b38143f5596a61b0f12e410bf583a3e989380cc8183f5c4e23bdac6afc0a27239958fc01a394bf3a0f2c0126051c312d1cc84e0f38a4ef2653303818bd6d3f8db4ac3ba9b8c22639df3f32443026dc937947abd6c0e6e708ebc906d6dd2aa2e945ad59d4a367e1aa54ba5e8227d679b8989ce72b14c6995710007053a921d00032d4f2e6a2a8ae3cff5ff7267ffcd7183dff985d4bef10d75c0bd4f294a6647184f3d574a72938a55add75e8290a6374be723d7795d09db03d4c12704f0cfd272e6867a580a72a78bd4847f7f874d1ab00f5c3358b9a21d30acd306e08b9b1d82ab340ea403dcb2875a82e550befc40957291899aa01c0afa1f539ba54a94a6fc6ced131f9e1e1c9baa373626942b298ed3225a5155ee994346c799c9882aa705b9f4d56ddf00992f5b0968135520279858f6c5bfec728dd3febdc7b5eb6273ee9a2e63aa94ec35411a3e886c37661ddabb0984ee5f34b19b19cffec5d78292020ce8b828e374719c1c29e7d53c7d5080055cf919d03f1ab676b877811d50da6fef5fb3784807e76e5f8d1a63527b8b8e1fc4679c4bf9b534552aed3e10afd763280b8266330610828e9c803e8b9f1660b5c31cda38761630cbba8630d5f156187dbcaabb9b7174f9e4fbe022668a6540f6f4f08037fcc5d49a5ee2469f5561f94047e95fac0c025657af5a9eaf678c45bdea0ac2408bedabe83cf4c735114bb001c0e8ac52eb8ec15a0331d130663b9162353cc10551d2989a2b322b19084e96033d596a1decd3d677687845fa345b44d356fbba3868bf3dd52b6dc27295198dd9950f394ef1c425fe0d4a6104998c36cb6a43ac03f03c7d0c35d16a3db759170a45283815b5d0bdea790e6101afeaecdf7c61e3342c4b777dfcfdb9d7ffa8857f00de2464bf454bccb38fee85377d85f8677cb194e2b48eb84e97c097373a8d22445099dba92b438d694922b78f58f3f127ec1098be980a4566600694ecaffa3add5a1dc0cdf6704fe61351d87ee2ff435b34212040f2305d7a39246f9454be758206476f5ed33cffc9c6707e2cc7b038d97c259105505062af2aa04e9eb2956f77e42874e1f7d259404908d5c8f6b102f9e615c2d47a398fcb69cc61c17d712a3c1f3d1d5dc9260576e396d77c07d2cbe955c1792486d5aa7e36ed83a1181a70d4882eeab3bf59b4514b76af2cb43c9b64cf36baa9e6b39289d5ea30a2132ba5db06ddc6db2c8ca5ece76cd5322a24bbf09927342557abe87c869232d18005cf23f308b6b972f36fa1312b0ebeafdee1c57aaf266127e44534cf14d4b4fb5512e3293883df4dc673fe3b7744643bc32827229165996ac110b073dec7934c7f66b4f3af5b243abf3c871c7a914ebd3fb595436ba03ce7c703fab28dfe6449bf6a94774226098658cc922da2be22732ff787f376cbb38403c935227b256f79bf18d3e4e2c114c83a0e82f8a3dbc0686a138058ed84a02413199d31b4d98f404f4e689353172c5935eb2e541a4ba63bfda1fbf65939a736681cc381928e8e450fb2611a37accef86ddb6c33b774e037e000e162156972976490ee1a456d43b440e9fcc55023831ff4093384aa4c73945674b34f9989fab163b8408a3bf2afbdcaf73d2deef3230972c26c9117fbdb8ac26115b5eb71810a970b348f6cceb5cc3bdd6f4d53568c6693cca837d44eca9b2799ac3eb75f5a938c939980efe1939944f961db1ec6ebd4a8ee3e55fa55907355aa037e55400fbe2e9ea44a2667f010538a19991016b8ad00b78c633ce9b6e9e8adda405b6914f5164c0c5d07dadc4915504a4533b7a422170887a406e2fff74080adf45227a0138a50fe6544dfc10e84e06d0f350f6f71b53d148e2ab391c6a87011f4f2cb825fecf5ea4f4416052c34a2432efc9e9b25e986a420cfa2ae590418d94c2ab3058944b2237f47442d41ced7fb64459ed0c89002125cfb3d1e4eda1b5b2a821aa0e91ed6976878e8057a88e9f3bfdd10e92ac5735d9b936b537ee60e89cc4cb020c4cbf5c618729bdb41849a98ec5bf99af5b8c13e4242280e48607ddb8597037ccf0450b9fe33cf3c9cba421cb3e114ba7e158c8a59b31d32910cdeeef396cdb46af531980a390a55180fd46ccf767b4c964215136bcf5ac5f06cc6027ba3589368e662a0759020ba70b2230016d893645426bbfb6c8d0b654d4bd8c488a945b30ef159f58822c77810ea5ee8bf9553eff5dd3dba5ae2d3ad28ecdd05024b89b773d39b99c420b34c9f60e3520b643227fd0b7beab45626ebfde7ff72d9f07d9adf9505ee849c22b383f886154ae5dd162a92687841bc32f88dad35210fac778598d74e0b9d57f9c095e1f30607e7d95cb9a472c760147c565ce28dcea4e291a68db0124a6766585a009ef7c1002d72a52f0f97d38b2f54296acb00add9e93d73d98e634245efbef1bec7f43eb01b66125bd86d193bdfb308b694b08d0c74d3f03c0ebebd50b83b32b9c8c019f9f6078ba52b1a1a9318477fccb9db23ff6004fca8b9fd8026ddc4204a456b688a0d392226d3e3977c942f5e37e7e17ff724af3d9bc9b6a228b8e373e3296e4c263fe4272529f06b9127e290dbfb224b955e03e3ba737edd6ce270169416d7fe00d7f0bbd5006491b6c4bde43a58d28411934239f8d364ee0823625b17290e34d527b41605ecb761ae7ab2700d8b76a71d067fbd166be6e9962854caa38d3a4cb19b098a8ede7f7449d7b6d57161e0c8c2ed8ddaa08eefac55a7ba4f77116e3aeed7fcaf2e37becfef56e1836ceae7c2fe0553f7f8a383682658256f981a3cdd7cbb3e4d0d5b04d79ceca6da2aabd6690e893de9999153897f1502ecb2174077fdbfa52cae93f3e32dc0f2b6c83a2a6284b06d3cbebcd8965c8a47f82ff25152fb482c6c21d36164f9a4df734cb98e3bac20a0d777fa33b56ced898797c956853678eb4658ca3f7e9c898cccf58680ba41494771b3f357608b75ffbe6654b14c546734301a813723f4091ca9f24faac359d4abbbfb6b470041f3d8ed40b74ded3fc5afb733052a78cf20d7dcf0ba3c25f4d3a15a956ba646c4de8cb947f64857b452d849e88e13d6760d7d7bebea4fe8a4d99e84e8fc6e28644412055d07a11a7beb0d830a1741816875746c3464fed6de33267a964ee3ec61e5993ebb885a4a6c817b15103740a161bebef10c3aa50cc86471b3dc42a148feb30026e6775e05d9b892dca0ff6585f41a1f155c55f5aab08e284e62550205f1afafc9ed49514f586736ece2b66c06557b2569584555777d9071f65cbb9f3d0972d9d409422ca200b585a16b40d61d190951e8943f3a51af97a456618448720cf00b5ffa73a325d41fd2ba2741735479f3df6a862502c315d9aafb95865ecb84819a674e25ef593b57e57ecc971d29f56d029d093285d1b8d99c76db4f3162205c43b7f138bae937e453161e5f3932984e761e19f18fac1a75860d7341895eb26f00df6b219b6cc8df6be1388d8f6dad6cea6904044f7a5d104a85d73c9301ba39746e5e699e40f217261c32943bad4837864906cba955344c2816a472f17f99cdf16cbbeac9b29660ef1c2a828247667ec8be7c2c829456fdbbb962c154000efbfd7adb24c399894d8ead90eefc0e272f14e022f123f48feb964f04d37452d878a30141fde2d1814b79327d7bbc05e15b5e22f1ebcb885551cb920c5b198891cc7dc7e489c5c680ba487acc0796b19ddbe0d534d192e4cd7a5b400cfeb9fddc81f46803be965cfc486b3c784962d4ffc6f56eb5c4583bf0fdc8e5d334e99d9c9d7aeab0d943ee8b425c6dd7446e52d4ea8bf7755db6f190a3d994b95c5dd180afd81aefcf0ef9d517739be9c1d850ec26a50972a568e5a9eb7b1afdb3ae9f5b194196235163c022d75e8c71d4fa2a1f5bb2df39eda11f914f2c3c63549fd413b1b07629281bfe0f84440349278b5c95bb159cae777c25c48f4222db6cb1f36b041b539d69c68a1693491590c6d119b9edc727dc74db381d3d9c255c529f46cc603ed4b37ed73d95b0a578add1bc994ad7b6f6add41a567e2dcc6a31e61e4d6018c557d88b58a0f6cfb6334fd31d1ee9c6c91ae6ad1570b892872be90040cc74a8b650f452206121cc15cea16a6cbd2ddb6dc7ab11cb366d6960ea89eb06dad7438becbb7abe1283968a1aa9a4e020890be498ef01c35fed5b866f51c8f8f6c04c7bf4e2c191bab7db20104ee71dec0ee22f914b43bcf16ddf17af81968189c806f14704b90bf14079920e5f0b3e0b479f7bbe3fb3174c6b41e6caa88540bf7295e7a3d0ba16c788422cacb321bd8b1829920d0a9004fb9a7ed458fd4c12a6204cff445c5aae14347e55479b774bcd05e60da357eef466a1b84aa8f9ebb1a081552050afc78759a5940864168ebb112a71be0172f5093d6c66877cc66dfa3167b611dfceb5b5598dc92e1a46eb93194a7651b724e9533b4809fabe26473ffcaf8bc416618e8696a289fb1089b51cdeebab210cd1cd21728a606306546d71cdb790e56930602582cad25decffd469d787ca7c196057e1cc5a3703798ac4f45cf2d58fec0020f8f32aa3396bacace8dbaeff9eda1f2ab71c3832c63bb8482df0d8ff8f94e908eea69657b92b0c667950691eeba062af13ae0166d577d9a8da8e8d8e498f36c2a3809cc963cbaba955d6b8a9573fb801d69cfa0539294a3e741d75bdcf929b97ecbdf32518f015b80f8b822edb31f29a73985ec102d4404ee641a67631a2b8ec55ad108a5f1cc73dbf1c39e3208d355f2a811bf40101027047b47570dfbf339d21bb08d0db3dda266fb8446eac22ed13280c4aa17dff1b99aa2828ad2dc44448462d6a4d151aaf37e78abd22055f7149caa9142f8a22a9a9042fefdbc979cd91f89abdfbe5eaaa9a7a44a30645d7eb3126706ec0e8ac6c9907ad819a6bcb5ab5fd8770cb5a265e88420c2949c986dde316b98b38da6d4b738962fc11eba657006b86227014c6deb44a2b7f98876e8f836279d73e4d692dd198fd3d2232942531974f5c6e8ac5eb1effc8ff32a9a3174dceefa75bd9fe744e822945abefde7a43b54dee42fd9a6bc648b8dd6450ece050f1f19dc5cad653d57d82d6a9f4d9c0012e793972d42639a3f98ccf9d0035b88e766033e2b729c3a78101024002b9d7695052fef6ade280c4996280ab8137b95aa6f5d50077e4bfc5e98f3e76985918e3e9ddbbe1a5be2fb29f72947bc6346d9240285d2e6388b660e0309bd22eb1666585c846d7bdbaca3d43a359e650d50e03f3967ebb42b52228974d2dee01027057256cba31dff980e9b02a4aec0e4d83e1a15e8239d49f5def327e1761bed19fd6b54b917eefe7baa850a647422f15995250fb3ef85ba42cdaafe10978747aac3d2e34b1fad5bbc142fa757ad05d7c0127092393d7a2d4d0594720fbd3ae8cab356c25a9971c7b1487ce6f3048a7107c3a9667b120001dd68899cecf80fffdb7aa72688f988ba00377c5965fd74870fbc486edfe40107bbd0dbb32c234f0e9348cf332b80b69e70e2561fff4286fed7deb24f263a24d49128be5490d4b98aeb2bbfba96df36edd75ce39602ca760594665bb4ad5dc877de439308e5e6a915bb676adeaa180e0e3a5334c6224a2630523c5f957d8f7a9b8aecd96342f36f6be3c5f7b3b8e9799f4236deed96e677f64616956a8b6b80ea9b44713c04b97b048bf51b305f1b24b88502546050df97c683d92d736878365f8bd10d217fad0128b79f9f277482a04bdf748456bdfe7d0647f927f06d52d0815044104215c949960eb48e8c17da976f36674a2f8972140f1b730d32cd952e9bff65d6e0b3de604fce431cbbb11d1d5954292f055c50cb31e17ccb296fa5c7ca517f92d75e6c3e8b0c0ba80ce52e724856b99496011cbd4f5a70d83fd186d4cda5d12670c72e3b24633b371f1f7280452439a8b911f28ba583c0ff245081a6b7ce9f24b4aee72b261666e2cc501a967069e5edf00f2484cd602ce199404a6a6592e09e374e61472f515f0c9278f113456f185009dddf4e69d8c52028f9691632f8d258121b637a61281e816b59d2896cdaa1e488b556428b2ebe660347bb8c3666c8ba2887cb586f3d6ebd48e8d2e8c0dd6a6b63f85a13c085c0e8ed4f3e1985c40236547b1c435c678b2700d9d2983f91f6a915fa2a8d6a3b85fa15e5b623d3569a41ddaf19db42aea8d7d9f09d39f2f03528ea1a351353cbb2d2450cdf80d2eb487fc090842e657431336397c9157471f09972d1116a01291c01a83ac6a550b0a0a63fe676f4d214d026e45957ef004a877e9ba8dde1b69db7fb4f54b71fd16731437afe3c585841b464fcadc73833081040bb088cf7dc395145cb1cccd029482a962ccf6cc0b9701af03f9854d9a9c4be0a715c561e08b9d61a526e4e1960c7589dce247bfcc6947525c4481f849c14aed08a5a4564f5e27a2a292fd7184cc073bf3680be4852dddc5c4db6608258f691df02195b5c0a8b52e4eb84ee6ee33bd385256a5579765e57abecc6bbf4c190c056821690996cff4170318d2ec1fb4fd85313270505826b6cf6fff6ac0628eec3dff19c6245af28832a37f7fb4bcce130e55e63723bbab1ee342bb77652b22be1917c1e7271cece4fe3673961569be77bb83bda17eacdb9bddea6550c3215632ed66767fbe6ccb4bfeca18db951148b70d06d28be4888dd7fa6442e1133e62594c31223722a472d5a56613cc55bb3f68b4c1597257d64e2637a317787f964a96eec6650270eb05dec845474a733eb9203e482ed917417512f65bb5c406d28cb6db996f606945d134aaca735f601ffeaf8d99101871bfa3aa7744ab80d7c0150d2890eddbe104450d0f800be457736a772557f2d652b7a7e8e4c4057a363f64195eac0b47bf64fd56eba24cb48935503839e5266c70556c5f57973b5e1e151e76447265117cd881d16725315de77199ebdad722b9a16e54982070eb72e8309a9cf9ffbc2c6df2b547e6f63014ffb5975cfc8c1d41c5079a8d2c6de0dd4605356f40d7886c5a3f67b4c5e72b6f05b5766c95e67855e7497cdfe6b2b2d08210aaff90ec6552094ecefec40d91416d74819d30ac894ce3beedc795a2efca29b6cd6e6b7cd7acaa7f1d4081cda49b4e840b2cf9ab6f67f3d3e39d164b43d34fc716e06a18e30f3a8e98a6ee0d19a00c328e0b09e2e8e7b2c3471ba78fe4e7369211bd9dc19de4d361c8bf47822879de389db286853d44684343d7837ae43526fab571803a9d28c6ed58afdd24bd8acddd3a3025ff4278a58226e858bfa7a2648eb9a23e278c3e88df9d153a656aeb41073245fb613303c99ea896bae648d9bf4454f1d2b4b21b7bf67cc9dd93d24da0334ebee9ae42fb0e59b33430d03e13029aa601a90eb85e44a48fd3b569dea662e9c43438727fc003a4f9dd18c209e515f570a673e3569baed624ed8dfefb9c346b42583028ebffaee4b34183a06031f8966010050db7f2be5cc98ec09ee649b98e297cef044b9c8da8fb2f263322420351cef979726fa95466609f4783ac36091afd4cd4802f97d6d06faf1f66cd461eefc4f60b10f185cb4a966106658dce12fae5a536d847ac403c7e35deeedc8c931ff4c0ee7b9d37a6f1e9de68262007b1fd491a0a81e182da71e0a85ce35b546235828460ae7a4b3cd135426cdc0d0a670bf717dec17a1ae3e33ca65ce106f300bec17c9501ad6237ccf0e17b20ab1cc8f7e58bcc9f03ccb33e06a29630f3202eedd5d7d5a727619046f5b85e7d36d04acc0dc3949fd8e8c6207c501fdfb4129c8be9dcf614dc765e597560d6c079a755c9e392b9aea2fe51a02e5f5051ac1bab2ff7649f40b68b5352f6d1bdbf6d9c9594c12b5ea32f0d7837970824fe23bfaf60e7e60e77faf03d803d735b2c7986ef6ee9a46e5cb0485ed7cbbe966628a56eb6a4a4e6e054e34036ce6c1cabf720ac25e972db3e477ef30e2e03b65aa7b8826e0369ccdb3c0544ff8256e9924bfb71f5ae357f68af9ed60e1c4ebdce9e831e3e3bff57bbe1843c1cd7e0308a8eb31a22f09ff385db1a35cf50de707775309118c9953be4187bd27f7c494af80b0b9d5bb260d98f51a742ecfd26a7136ac158df82e309ee8c93eeafb71613e8f7d028477d20433b9eb0823e6c8e365108330330d5d9d3d2b460c8431aff33c708dcf2a78054cb799f9a9586835447619ab513bfedb08141f94e653f3365d34ba8ffa3c46451e635613a3ebd70e43b1281cf00c9dcddafcd770579cf10f75fa42c256d1ca13fc6bc959bf5a8bc4d51ae06a6e5b41ef7d243ac59d75eb246e719e7eb737cd2f61c80ed4d18b2c0592495903d571b966fd4037690d3146fbd3a9ea9495a9162de8766decefd9a42c26e90a2957f506e04261fffdf656aba899b1c4d3009bf16d3f8180ff400dc6c1992fb39144a585b9be11ef7626b561cd341fb8d3c652f46c5acb8513e3ff4cadc405810d935fd2acd506bd2a4562f3318081ad30b0bedcdfb3e301cdd815bd6dcea279022f3874c2469c96cfcbd09fc199c3976b477e91e8dcaaf4ccbbafc9f4193ccacfd4f33a17a4cbef202d4933e0f504d13ce3dfac1432c397cc8eb870840c077902613e3df6fc3ee882917cbcafcfcaea865f91f41304d63bbe86d0663e76a0b0e571fa4d9dc83395f3173d05b778723d03cb0ab28b5c6822f27d776627554ce95de66234c6e9725cafd15864e8a6e67a71b58603d85dc6c717fb47e8055f305a11472f8d6bae74191a207984de82e718d9b0d420ab9ac5649a0748aaecd0e92335dde7ee9664e317ab1c0123f72598c64cf8e8f73acd28f45712f6e214199dfdca3a3646aceadb65677efa5eff373c2d0df7b1d503a3da0e5bf5d05d23f5315e6a8b39abfc38d46ca8dbaa10f0a15d172d540c2f8fbbf78b9a82b0f1051c84f4b939f9dfc2e89ab3a2145f91502905b90a9a3a8556ac3cb7663a9ca824a00a7d91853b72862847ed1a4583b6744f1558eb505827fa89f7f077d0e694597e8c100da328cfe6e8d861472b926d69f9c86bcdf69f287360264ce36e7165913e79be4fd574564d78219950d61acef997af6a5eb680d57b4bfc608f61aab70b4cb2f190df5facb4badd007727570b057f5730e46b5f632b4b83acea329f5a88e3121065c05d90a02ea7c3027bad087954a69b81a6c6a1e7f264327438e0b92160c1dddf9cd3a07633b64ff33f8887e8b682e8a61e2919e507c6fafe6ae1f2c0d99442738e7af6f311ee7c23514f81f06a2e1aa89fbaed766ec3f7dc096c1ef23cbf82d14326cb0998ebc05c75d677e8899fb4515b79f487fb908f0641961b413f3b785f6fb40cf856817cac3f89894eb291f4941bae0e00323d9cd6d76c975adabcf2ff0c089b60a951f53d3defb231b375c34944eec35560259d782fa457417acadcbad17463050dad07ac8fb7c8046506cf9ccb93827d562dae7bfa6a834664432bc4ffff2dc021c5ea8dc05a5802ad683b1bdb70dc39130a7ec2be9e06b68c5be5ffb91ef0cf7d8a3382293aeb187385df38791d5d152168549209d5e6017c3efe2b60b161460d18c38a87066eed5b63c8041a9d16350fc38880b49f08c023ba73f04bccb10057a06b5e21e0d022bf79a1d210c948bc1d183f9ed69b017637dedeb3311cd7aca81e6b4058c2af1f526318b590a04a1fae6f45f9892be5201428557425eaa7d66a1356ffa6a6e14358d5bde93b94aa6805c130c1c6d47d4098284843f2292f13853c6137aa7dbfaeec2fa83ada3b7254c6757cc7846ef0c54b4f5c7449327ee5901278225433dddc6932e587f2802104c2c07fd6e480f3711b4419e03441d0cff4e0c3bc0070de80431028ac5d7add76c5eef21042c69f600ae1ec99c82db739eb563582ba11809f79da8e42854d6fa75a0d9035b6e51556a4f379ffe878de612f598795721416c5d89dcc1447ba6001df121c00bce287675d25e9ab98019643f694eca736e7054724feb7c0f5deae6d99219faf8bc80d0fcc31011823f23c7dfaa6d2acdf8ba1b6d4d82007e73a71dfacf827a377a9f657344a232248431ca1485a788ae5168165e4beef42aa5558861c7bbd68d7b527b9e379e01f81e242c569d0918a4865cebac8e81aaf8c0936add8db5c2e692205a58a54bb038af599f54a3db11bc88812df36b8081d42126744df3f2876209640e252c1c44d1760035bd5e0986d34b429c0228ce0dca5e972a75ec38dc788981f465ecce4b0e1561ab9fe3ee5eb7b1897a1aa13752eec7515091c715ba827e1e76f7976d868671dc8cf3dec1a869a83bdffc8f25a814696d72316005bee39606657970805e2697e7b9f2f9090363e6a71e2c8f8e1c4fa994e16b24bcaafaa0452e190ae14b76fbfa8798817d50979d931c87cf1126332953b1e1a77e834a919645169a6f16a21f2dfe6d4ff5571b5f16e2e62751232cc2653b318955bb6955c36ae6b753cec63bb8359b3af9c0d10e353bf1f77b366c5fddaeedb28b2a594dbbb9570f3acc58556b2bafaab5c0c775a5bb95cb4a562f11a64c94580dedc5aafea4c21c702570d52fce6c8028b8f4ebce704a3e75c0a88bc467c5991545857c2c77c4dabc1b772c91e60ea1ec1edd6b7e1e647ca8d51d152c98903778d6c824ca000f33efb99ec03381ac4ce947ea44fc791ce78274eb8dc32ee5dca0ac81e475cd1e7154e5d7f267d992c6b54bcec3617ebfbfd33f6801b01eb3d7a4d35bf56b638122d1910b8a9e311d3e0c0a80372f0e22dd2b6ca652ed6831dc5774641851bdfa5b6168752d1a584ddbe4d991ce443b73231d762f39a421b751e0856488f5a564776e7bdf1da72ba36eb05d05143a790e4fc5997d4d7c3d7e12af13b7daf429ead4b1649ee568277dbc6195ee5b66a606577a614444501ddfc5057156145a215892e64b2cccb0e5dba7c490f93c7885c9e291995866cad457c3cb0a3dbce85e64c12f83295620e7bfc3be3c99e267b7e834f35289cd5fd7a5b6fc9d88d9d3f39c07d5dce0b33c80eaf41c9ca831e71fcc8fda27401dc0aa3cf1a90026274fd7ab4c3f5ad564c601d2fee3784d52b540645bc6618a733d75c0af520ed7194c819944fd9ed74dd411d26dc3e7a50b675ade55b409bc1e7428b8e04d07ec26f55c595d7f7e81de3f45e646a31a60dba88be5332f362987fbea24c643a42d62f24d0fc8394d1f9f70c75fb2d08f96619ef63c315f995a022e8faed83c880161c91cb1e6bc956aee9d6d193330f468f8aa37c74bf8562ef9110f70251fcb31ac6239e0a59791b6462ff993d1066f4b31fa4bbc0d21e014555434ec6e7286e27287cd02407e0ec96bdb52ecb9f6040d5ef65b590ce25d4bf681623a075eb1ea0363a21cd7c6595596e4cc467d04629a29617f9bc59d59075b453eef6e6a5a1ba1a081ec50f1b7adb288fb6e8ba5d96c48e170c5745782202eceeb69ed26f0b7872d13de74048cd274e94ec2d8fbf63e242d83fe9160d454ac57e764535be582e60acfe5543ba57f638aab99000fbf1301074e203e6a6653b8b5807f4d223306e069dc3f1bf8197d69556536717b68ca52b925cd4db689321c92790722b35fe9ac6bb06b4a7b146ec9eef59172e2463e474873129ade821bbf7c9d79bd64ea18b4bceab2913cf2326504a658e3958e6774ed188c9db5e6c3398f84989929cf06dc52d8ff99f1cdac982deddac51a53ce6e7ccfc1025147c2ed0a0b00614f4cd28732f1d6bc9396da4608a42677266bb12ebf6e5e42818fe3bec68db487a64f031af1c56f6ad06f471d47c17688fb95c7a446f3aa31e994748333d14cf37eddaa31687561ef397b5c6049f007f27f59001ead9dca694badc661f677402e421d97c400a49bbe598179ab4baae852900f3a41024bbbb16f1efd01a8a3ccbbbb5a278234b6f2c7d3328ac2f776c082c4172bc0326654140ad872314640f363f63df79467d5559af5432ff4ce76b5bf5741530c6d6c8af611c6421ca0728a2c7d03b33604a73c66a3d1ada0f01eb423a9b131b3e4bf5dc82b85a7e1b9a8a5b0669da31cf9a92f80f5d7341df77940b08dcc563fbd683d1882becd06ee48d7370ab8d0d16d5d904a4f20c070f0cfb549cea5d2a76ae7484d42c34cae29515ed07cf1efd694b746e1e4039581e66021bdc46c9f0f0274db242df3f4d163db5843a5559d6603dd664408e394cf16009df9fdab1fd62dd551","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"fe727b3ec2446f3e9140a7a09442f679"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
