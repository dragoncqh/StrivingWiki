<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"a86a906b698ed8a8c1ee9df8b111b34bd5a02139f2ed648b3808663abe7bc41ceefcbc0d24408be4a18085594eee68068b1c7701ac672aef060d90ae33ae4e6939a2f7fbcb7d8a998916f4a22197c0d8cc236c285ec2e9c7ada75eeb45e2dea0c3367eaab588daee80900145c09fd93ec604f63f90cc359e43f1f705d79c58389205dfb6b589fcb2030e8bb2b077d871b180d76589a0410a7114ec522203e28b7ee28bf3afc87e6d3862b52843b640020a6d3d2232a1775d145b379237e62ad7d38da534c639c4306ee799366493fb3c03c47243b8dec79df94177201bff2a1e73143064459d7cad016204a657e42111f4537b8c461d82f9af120326947c90234d7a9d1bb1d12cc9ef2279d3dcf11abcfeedff3750e5da0bbda0709d771e9cc46516af51185e41243e7607f25071483f4859c868edc6b44f525593f39858a88fd7e553877e67fadc22fa50044fb62c9ee455e1c4e0d985ce7fdcac60921e3ac8ebbc7f824e1e93789ea3b7357a2b195f764ef3ddc4f64592e8c1db9d10bc66f9ca8a2d565f6c630ed4e1a5024c777a7adc630e331c12f774790c173f77b95446335f56ab0c3d961c5e9d1d89274177385c651fb8fa24bdbd1e34f2fcf24d9e1666fb10d0e9b9adf7585c5d503a7a906b7219907db71490fd0afb49239098ef12aa07d77baf3fc36641a685241e21e58dd94039af2849fa9d33d3796df433450f4cb3ed92241048463958214c1d5ccf6bf564a33bc0064a71ff872d73ec063a671a87e2bf03508ff945d50400b283458da68f00b79c81bb19bf9f98ed892821bc140be346b278c3b7723fb371b46fd7edd0b918f5961d0a71708ae94b88b46efd1ef9f4eb31c185cd34d3860d31ec559ecfb7b6dc40958c35dec030ce331646fb5258ec2966e8e1091b60905106acf456ca7cc515577ca8f8adba51e5ee6dcdf93076159a6d03c8fdc1b3f137bdba6a0be95880316eb46a695aa4ec6868c04182384212e716971d3046409042b1764d43804da25c2f58676657c6eb5178fc77028a1ee393e695d2f078aeb80d9331249d2568a5475d2b452beb8b140f80d2fe99a17886ff178448e07782e8cc9ca8db70b1e80d53438fefcc5fd421a4a54648e6928700f4495e25c78e98acc1f109b419dda785b2f01fff74143149833cc8ca40d71208a7d4c051dc56dd3eecd4918e72b5894a886dbf41178283e2d43c8c217bcf7922ce8531d3b192bf277c82d4493c5146e2aa2b1484e8bf3b519356fdf5e95bf37762aaf997e7d586ba216e1b37e567fc1d7af27e09d08e947cddf3618f02919b0e34f6e4f063830713c31252e64cc7a25fe55297b4e3945f6b7eafc63b63705fde88cb37d32c13613c342c82e41476b6fe10018ea24cba8fe393d07e28996a06fafc18780dcb800997a94f28580de3a5a3396f451f608ccd6549b0335b7a49c7abf6e3b7113bafa19d1ac6dedf70c7064e66d329f3212dfb5e12fce27f8f2b71d216f8cdcec27111fd30aa7c344a31e6fcfc8be832e5fd19b31276d97ba7cd7a2a45fc9051ea817e1711afe41426771fb8cbec9fe6b963585a31d413c3b7a99a374defed24d9c246dce04f1e3bf64166b3d0510ec42953fde02da43622da87cd4d33fed4e6458ff1c1e8489840796bec023da57feda6a55ada5f96ba1880f66f181287d91fbf3e605020b51816292e07ff56220ecbc2e3a35c61e52ece7640f86633aa64398e29465ea17301edd8d9820bb63a7953f8bb8c365d65cdfedbb45618c742aec46286d47019cc403c354de7e0e4332563ce9124f8f3e8e18f617cd5d06210a28c32133ea0179005c98e9b4fc210e2a9cb0ad05029cabc33e96021b096f8d073039e985b9aa6b5650495f1935ab6684cb2a3ae77f4f303ffcdcde33c1c6cca99118e4b5737396051736ed807116edd6deb6d21af05d915d94d0f3ccd62a86a9c12c3501f9a577128319431185db9159d14dc529226e8d1c6aea44ff8471d25f9edf83ef2cb0030317d61de662c55e98c51c1a32be41e374e77c5557e5d827d816892ee40452af08b1dd02115c280eb3277fef967a892e2174ba71deef93eff72e4ed328fab3670524a8fe0e1b8303b95f5d7993aec8422bbbbfe08bf92dac5d79716fae1f998c048d7b67dc7dd4a9d4c443a25e5048dac397a551bbbb1b9d5d0c92ae998877013575ae6fc79daea710ed10d8e6c09c5aaa620c95e9e7ddcd69bfc33d538fcebde7409299a1e9bfd6f27e39d8a5c091a8b348d332e33b93fb20550db80399735920c1c728b357eda88ce60093301495e5edcb0dbe1e55adbf5b7d0b9aa9e66cf3a842480b3a49bf29f0d8adb75675df87d7a2b8178094cb62f3fe12a02bd8d46ae375b6625dbf83a4c20e3b786ae1faad45608f9c8288779561fd6652c43a3508ca57c890696afc1a8507e8c451487a24c524909918416cb52e5cd19935987124ceab36c98abc1b968caa84ec896497b6b606ae580cfad35f164848834526d3d535d7123f7a4a69d693e711b707112ec61a5bfacc1479a47e94e9e0884cb3930baea7fef592b21bd6ed20594b1436ec580858cd73699223686690a108c78005538564353eeba937183133e3152f490eae4fa05252168a92b0755df35da46983dae6e55a57104f7ae9a1ec07a978455a917b2592a272d722506b9afcc47e41918f35fbf909f4a0c44795f14372ba498abc96e82639e81b5b21e960e6deb0b7b066e5db33a8584c560ff78fad549f20e3220e51b0cb0e7edfe21ad6ca06ab16db6e99790960e5d5fd6abee1e64e28f5e522593dad61e84b947696a13e8e04225a09aa38957fe6bd9720c0b64acda6bbed09640e020fad1cee253bc88d73837346362f6d9ea9ef4c4f4f2c9870c7800ad5b8b4a5b5744c63bcd0de03be95527015001d0f0f636878fa98aeda518f9af8a8cdfd283634fdb94460759ea46c15a118dc049e226481bfc93ffcc02eb15296f5d409fe708e064e9f7c3ff58e50966ca023a75ca5a0de979a58e1c3780935b670d1ea57b9333ca1cdb2e63afa3fbb1178a69b17e9516e4e7624545b48feec9b90af3a3fe4916433773441615e3cb7c5f52e96e384c2f3f88f0761c5810cc7bbf490c5db183e1f3cb2089708efb3c15da8d3cf723c7c555753c09e468decfd2d818e3f6a3382431c266958b652ac5826e042ab4b8a243906498604f3fe8627f770871fe094472a114974cd9806b387538aa92565a1a57573ea52b5b4b7bfff9af8f7800568f970f6547d1035dfbbe5ef4c9d1c1d1bc4d8b8a66a2ac4e925d8d569fdbb82c1506fcb719fffb5d623a8f040ed6129e2748ad08f7990a071b5d233d246e636c3ffdf33b5c024887b6074cc961dbc9bad57b86c0e9b7c179a478eced5c3aa8803584c9765f12d98a170aa0a957b577c544a93dd4a638d2311df00e66395ba75ba3ae70de03035f3b22f399c944c32d7440185a73f7636cf8a13a037a74bba98cceb1a2925a1db9c679cdcc768b59d098f834224d6e08e539c9e97288ca0f150dd1c5a356d6924792ed81406ac186df21c9ebcf8e36b5e4eb2dfb965795565bc5bca8ed2e9e8007307bdae0fb7b88c1843eb5b17d03b336937d86f94ba13250b250dc3be0aa922602af24346dff1899479c6446d8115ec31de4ba51e608ee5ed6bd1f31283ef231bbf14a4b43b63ef5e6d0fd3043fb43a42ef0c635476fb90dbcfca6ee795c4897db9f26c9589ba668baa03ce3c325800ff469323e9104df9baaa75ef815a6e9febc0c44df3ed7f3b55569c6217340e36927230dbe482634df294aed07a5c255dafab1222a7e65eb296d7acbfc611f519b9c7ce088139fce970fe087faf2390f8e53cb07c601ed376b54a8bb1f62500527683aa544a212ca86c892917fa314e85b3e06b3e91f8841a4f18be4b9f78c716dbfdf4b469b04eec37356b4184efa42053a8e44fa506ff10024ff66eebb84a7c3f4e6887e1aeb22db09b0bdc1ba2cd15f5b881966cb46818a092b8239a1cdbe789fad75f540265b1985e6f516752181357fbe391c848c774133231fcf508d3544046db9d69084d1d460f0a437006c327618e08e8d36faeab63d2f01be5f7abc1f62a91d2c3a905ae72cdf7c0ff577ef5fd4bccfc2f87d6f7eb90d0aaaf11e3fbd1a88a02d4735424c3ae246fe070595771048586c8f42c7de71eae14cc916c2b4bca1760007b7191955cc95881ddf3fded8189f7db2241a7455d553e4aef53d63410dbd260a8259acccd095261e08b04584fd5148fc7a89cca505c3bd4b705c448766c4b5fd50ba8dc2ed211e40c7ae1f48e6945a2bf77faf4f58d227d9b9bcbb3b35acb0c70e7b6b30087cc4d8f8a913198fdcb5dc03e3d07bc5059aaca03c044e9b3bd0ba833beaab41ed8918c4195a1290d6e9c90bd28547a1d7b3d3a3e20f523d9489c913e600009a779c2b84031272cc1894aceec59c0251e2476ab854dac074e2b3f09eeb2a00e41d37c1094c155c1a2fb2b8501f9b1994d3a9be817fa3061c3879af7d5ba8f2dd57b76530e0a5412df333f781b04042624120a63c3acd40a810405889e9b947bf756a842a03ff45f44db9a6b6add2be5d66bb280ebb0c2d3a5c9d512e7fb05bc2cdc245cd3a1550db74382340b9d34b6bff8a239c05ba5b21c737f53f83cbaf17ebada52bcca3a439bae686756b007267b402daae8eaf7b2a43a007dc1b3e345f466f99e29b098306519c68f57fb03fff86f007d5df975cdf79a270cc4a0585f3018f62fcd2dd9718d089a7d8b851e7ca844552946b0d5a648e229e4a93b680ed34699c9d36d46b27740f3a14fbd29cbe35efea456d5983243087845ec0eea466fa1d956ec3524b910ded49650b58dcc9c9784006f9ec993fa29f04011f1a17d4e9f8f0879aeb2bc0f729a1434a78bd970a14c9f22f2f4d9b2ce34c78fd5bb1c46a92659994bc4a19df9a1140c1b1873947e92cb9dceeb03fbada366c34eabbf397a819b440845d7b2ce177ecd1cf5f9c69ea623793615da78c7f9efb58678befce099bfe51140963087b52c55a751a8591b3238257644682bac9cb1c7d9a4ca6145aee3440a76cd34064348a0b5857b036983372baff3d1d5aad488e66baf587c3c3b4f3d679dd517519feb5da0c41c0bf9690aa2bf344838aaf28d2c0da921e36c6d0067a33dd61872999a8c64c31c9aa964687e4a59327c3e49dac05603d62dbe916f16aec0e5c8ac7db46598f66107125aae087f4f6b7dd2e8fcddcbbadbd5a7aadcb2db8fdb6c486e7d73605f921d14b90c77afb183f7294dd8515043c773034d3acd759be8ea688dda31cdc943d26db67dbd5da1fe6776e678466055fb72c75ece8e9fe3d57fbcd7dc0d2e47ea586801aeccc3c68b9de8d327deca773181b3fea53da76de51ce92f9390544690969d395b0a7fdefab8049990990dc8bae19c61f538b70cfde7461291d3bb9b7dda27e517461459e4fb7476197f6ed297b304f4c3366574932bd2a2042563c7e557735623b3be54393965eb5f0049b0c6c70dbd6767698501a4e99ca632bb4bf0f8b3eac9957f377a3de4b93c0b1af65921db2f723a35a2181f008af6f067a933247a46648ef935df049bfe60b9343e97edc16eadb27008ffa6e2d3fed10377f718fb394bb103d8216dca4d898ce7b427ed4cf89b95dbfe6d0a28a9933512c938c24aec7f54a0026b9ac643a498576dcd5bc2f995738bcb6ea3c238032ed3ac5f4915cbdfad80a9a58a65a49ff6d799466f614b177cf84737248b016e97412c616977c4e83f58ebe2f46ffe571c74c7c759c44e85b8b97a91e879f9b57ddc8a8efaf3e5ca3c4fbb3704541f4e536698fc890fb5c92273ce639949bdb208119115aa462bf9e23655ea7b2e4e931b365b0ed97da0d68bd7d0849ae16c7f2b8ed64d8a47fe564eec7f5245a279e149cc8ff1406c5249246efd10c3f7d1396195f59ed4c97069f913f5e6a1d82f5aa2ef3058ea2f4aed9919817bc31474827f9715312c92a0ed1e5f4cba44fe168463d30643e22f006c1b683c8d376b5acdf673532e6b115583eff7268ed693f9c906b5619de1e16b89aa7d439eea9576769fdc2a005f8a7c4f56f96ef0004f5f4cd98728e5802fe13d7833408711b6bba9684f0e994a2e5a8083b23002ea1a2bee4f9f2f8f9708935f3b490af47777857ada31751e8fb7fd6f021b54ee332d19d75f3f20138ed92f920bfc89475322e38ba1f1e372fe97473422fb902a4820ac709ad75c5e632288c3975743651d6aa16a212acb958baad1ca4c34c7ed15e53d2d9c71534fb5ea155d388d162403a167c1ee5725bade30b5133a16ca99185743cd5233275c6772543f6ae33e5bf781a724872e480661e63f5074a10f6246f20b209a0d22c371475379964534e33c95e2dc1ae8666943539f430ad0c45c8036e41de1d67ffe6e1d81a83a519f1c358c18b02a36f3b2a3c46979adb3672314757d10f7bd44a52315e4013110accc409a43fc0d7485196e17cca38e22c7e3ebb1e78effb60ee17b753a84539dddbad22de6646d7a2b7d8c2fe68a0da5baaa6c4adb6f15ee4f276459c5caa6affb5e8b175710261725a70e6056606796100c1176d4081fcfcbbec6d9dbb29c9f0d950d6cdbd9a86b7c69a0a83c0ae3f84becd0253f989ffa2a65af6f741bd6377375500c1477ac199ed24c6282299d5e563ecf71ac3413a1b890ca11af01287be5d99f6ed177086a7562b3cf14148cc311e3502147f357e87b815724a4c078c7df3c1ef99c8c53da0c94829ae139d723e42dd634176d8acaca906bfc9f6430973f5c2d82387ef2b1920050beca128f00d5bdd2bb7f84862e0c996acab85c8646714f2ab1e1ac22829ef28585fa70dad21e8bcf9074dc19683c5f6d7873b0e36b0ddb9ceb4df34084031181e9ef74163a12e1729b8d930c2787f4194ba6bd9f17a74b6b002d1ce5849a72179f4472ee2f884255dae4565ce32bb3c1f86063a7f4b0c130856dfcb6a0cf86ade3382455b2f7b59208b5dfbc9b411107616d5e66fdecdfec91b6afd4c4222cac77089e3cce129111168c0a82e619a14dc6de8ff925adf209ab10658300159b5098c2da2fdeb86b4f10c83990f6c341531d36040d7bc11ab4792b3124560a886d13606e461b9ca58e438de45becabba986e496f1e652b03dfaf87ebe1a63edc8476c58f9b037807f2ac909294c536e566aff24582c2d24bd6d0402c159d4af79ac962f17c418cd4649e62ae5fadd71b14d74461464e38874d647ee9b6afa6aa6b2c73ebe69bdb88671071d846b5308cfdf27f159f862d7f42629067645ec3f91eead8c8b739de3e7f10e8716035146e1e05c8473b8081ae61a97597605c87f5df894ad5f4b420356166efd4eaa2116d0cdf9581bce9da3203bd64d36e3fb870005711bfdb5b11ddfcdb0f806f0d5f9c21c3d8fd9eeac14a1633ccebad2413ffdecdd2665ecf8290b9b4ec1bdd315eeabe924a1ce113493b2bfeaa935353f8a4f1f2594e462fad0ede1782a6fe77a535340db77928aabf073d81783f16e55f9b86b478e34082eb65d680915cda8fd4d252aa6b750281f25c2f509ecccb5949de91d2c938687d9c9fbde8ed563b407b50266be04cca3797496af47a569d423a663ab72862187b0d5513f8c0a8b51a6c58de33f5fc6d362455929e413d2d0205b4215d38d115a778c90e8a1a1e35beb542daf7b87abc0288b3ec9f55ad7f886423b0cd4dbcf35e5db554c8b809448a25091a045e2778ab80b09a57aeadf8293a7f2c6751bc1a3b24ec6f7cae1cbcf723d80410f53863bce85f852ac707615315de4e6582ffbe6839aa1edf3f7690c06596ecd9d196ed1002681cc460a12fd8116656d3dbe670d1ac0c343f910b53e830f82f71f9930e9731bf6c1282a15999b806fad7512e0b9aa00d9752da2fe290fc25806f27778ac1456dc3c3461c8287dae1bd1ab7ef7195000d86235352e499e54c8cccb2d237f40eca0ef29f88516a71f9c6a3ce4c7ca2a29bbda97a16321664586dda466b480d09b908e8f4ef9bbaa3671ff79c38f809c3a3fc61d8229171ab6df30c2136f6c20141d931bce99a69e3bbc9b16acc36dfe7bfecb6268dd22fbd59f026d5e641c9627475f0877d7a638fd3d704d976136f81c41cd7c2f6b349f7ec6d566df84e66ae5d599d6b24bced3efe7abc265f9c28b2c5aba45250fd44843008643eaf54f8c06b2c5b6ae4ad677ea9521ed32c5218e14bd4a80c22a1dd39fe13148a0e597cfaa9669cce94d05b61d1983699634c5d6c59242c2a13c65f555f00c474f7390f825d4a4fee3e335231646d87caa7f3400d067d5d6167314dbdb4731e894411dc48e6471283a066b2fdec3d12ef8de82f6f9ff11a7247619cb857c3a5aa78c341679777216bb9178cfc8b07d4ef59ddf6b9b4f46a3a2edc81661160b8f35d127cca17e4f6e81b2ee5074e15591742ce4a06ebfc466bcb720741a94512161110be288e9f0996099cdf7bf14e2b696ec991847ca1baf4821e55e176f3232660689ac85eb8720688279c07e6d8f96c2c09afb8201c9b351cfd5ee9f50606b696e9660a2088e6277a334519233353022491745297dd826df0fea27b840aadc68aaa20884d93641701ab29a4245fdab39a2e14b7bc1aac4cf379df947a0ef510d7955980e6e022afaa1340df7078bf505962818149916fb75e0c295021496b945633b4f4c18f07b1ba872195806586e7060a247b9e2f99143c4ecf18ead9f3b886a816e8d8f7a447d457d0a0c0b70681fb62e7d20aeea9c05fbdf96ff1f031da665ae065c8f3f76e696231aa9e2e47ebe6dff9116d05f781963fe1ffb86859ccfcdfdd652c1ceecf94eecb4c97b13cbd92867c99c26794375f82fd72eea865ef0d763d58f43c7a925c2da3af75e83ba6bd8ea988cc8360b26c6bcaac6c4786d51819b0cff66a1cf71569fd3ae68cf380c71bc41ae08458d0ce0ea3c0cb3a93b317c17816c23a6af432b3b669993fe2a5d6128ec9e52cfefe69b4123f2b9c565ad0e8cb061df425696f602617782f6aca0c5b118647c2f07cd8fdbc24d2894573c2f949075e2191ea6518389158417c5adac2ca5a106efa55d62ced91cda0b7006b2d2287034c2dbc05be4b556cb5293adedf01c118704a28a827e5b90a260537990ab17da55217b7a711e64c293d80fb4741de52bed560d320bcf0eb65bb017065c19588f7c6488f86e088fa3eeb844bf5edf49c850b1368cbf413aefdedc177c26673597e0bc99fdfa0a91d9194266fbca2f8ec77e525a2ab29b492052693eadf8b34fc10269cf216934a371fd8f5d82ec95e97b7a4f5febac2b7ad18281972be680a93b914a3216d8a57e670d2a32f736b9fd82b7d3be01b627cc5d91e3bd563d1953ac08099612042c23fa06534d56268aacd30d021daf344ea344c7168407a2c42e3269f59b8f0fe7d9f318bc56d3a65fe39e722d18ccda79334c2851937fe97d38b61abcb5b42017455b18e2f07f05ce290cd547eb2446cfda548646eb765c52a31f455fe83fb17cbf532621846f03d909b47d576fe6a925277e3c2082c24ee327ee99bf59bf186584b0875e443ff4beab6364d5c159212b46949322ef7451ade10422299290955c55b3ac862a5c5df3e6dd769019e94ed603dd3eb99f115774efbdb19c907fbea5e056d62cde9c61ee1e847006e2395cbc90e8fca3d0c9db4ac3d60db987a4cd0830062cc0c69f825a45c208de44559df73f622e7f0bdeec94d817239350cbab7eae3037606bdc581d4b8a18d11b6490d5e4bf6d91e82b926da8dab31699e083750956d19ad147a687896cdd36c2ff76fe64fa28ba4f5f72e10c78a99371565c43318896def6b7e67d3b7f3574b21099082ca31b89d166ac010da938c2e9a6fac63138f5ef5461dad2e2c59b2b55ca200a25f9fa569a18087e348a087ec415d48ee36de1383aa194a8ddf68e42cf4d7b1b1428ca128fa3f3840f8b0bacdd360f912396679b1504beed10243f3329e890f5d20b04f1fd05c28bd3d97e416dd55e4997552a9fe629f9ebf94aba02086a05ff7d474b1b527c7a3d0f61791b35f4c12a55d47edf78f92658cff1fdc5d6e4bd794b0534587df54e9e30e41a775a0285653d542848a03b66279f5e47c7ec7ec9b4aba83d9a345a4b06e422df8795fb76772ac453e875627d5f6fa2338d297541e6c535e7f6daf3cdd732840e726aaf4a31002251d1f69a2bbaf90cafdc6f3e61054d91c99e0db725b980586460477b7eb2bd55adec83e400220af475acebc66fdaa10b88d8b3597b6e0d0fd5f6180784885f95c4a8c0fb83fd5522c5f452274d9d00ee27e24f37bfceb455226a34754e84c9f0d98bfd744a385bcab79943fee4d4d75928b694a08960a93a4918ea33a8bc165b621a496a0cdf7a4f83734454e1715c6221c29d1fcbc3d77b48f197a9ecf810bfe5e7a7d47af0d10ced75799e57083d9d574ae0517d4b665ee5c26bb8fa92e40b498178c320fe617b01ff2666fad61afd1c100fc66fab7186bba57433178a889ab82ec2be68d2dc18cb7010f165f0951b40dd8c3b9d56a459212630b75a8628343e9137f34182485c39140ffb16cfbf4a91a3718447e71706db3de096853564ae121d6618ec7452c8d02197c76da92a21347465ccb7036d577da2332efdbb9e135408743c8df12a54fc943f1c97898914228dca01b14ec31d41257e19f435760ee63c8293d9c0823745fd3fbb3d79c53d9c59d8bd6c8324d76c67ca3dbebbc0449d855c10eac98c3826401baedc9033a4de6db3befd1a1d8fad2fee9637b828fc195493ad756f50755594b24ad05ac045b9be6c8ab2e944d15b1086aff01f87df389511ac7e6eb5b42ba9cf9bc414bff5d8fc346a4edc89e70c756913c70267367cf9939883093332832ea9e11fc2964468be6683ca95b666a5b862a0de421c80d56f64ff3ed0a57ebab41eb30779544a2ee592ca471e654aae21eab88f1031195512fd5c43f6d3933cbbb649fc38e58d4fcf3c69ab1d24ca93916e85fc86e2297fd2e20b8d62dc1f7e0e5f3c1d56d0c3a9016af77f53680412ceb041ecf7613781fffdd20b5b85594b7ed054d54589d2ec534fe6469f114a925c4b77e1860c8fd95fb88e81ea3c2cfc3f7e82a9ae35ea849318a9d823147531304d90bc35a3f4b93b7f9457053b1af35d8b3f7fa0f7f50b1aa6bd67c8f9d575c38c4c744216e88f8a1701c70a2767f563d5e1e6bd5face8cc2fa633a4c75613571809627daf9afe62e8cc748575dbb55f55d1d0fad740896ef355051a9899fae3f42fa272260c6cfd50e0f6f456669479b6436a53e5e5054d40766f6e300238f1261ee69bb4c730429bdf1bcee11eaf18c7ef3bb47f47932a106264651f4ec63b427738341a0463750f447947244e4d10bde7db5392bf2a33e16fe474c0403a233334a8f9758525a88c049690dc4294a18cd35ce61a96cc1cdd87bbafce79717d6cc85ba4f8f1efc4fd927c6fb0351f8a4a5736a7a2fb2bad518cd95293697393851ca0366d3b87a20729d4b989efacc240f9deb5e0d765adf8e9d5701ed3256782f68c8e241eaa51a26f678a40344d76288f92d9cc699cc7f4a938d8a65b563b071c3562e2cbec89e017a96daf2ceea5095ab4c2e44ddb20c5035331389346f6545e7072bb2a6e5f1ad23ae404e919e1c1a891ad30438c5d6b5c7c88b94cc0f4635daef70f64eb7de7a537edbc105ec7ae43279ff5085706b31f716397630dc97ca6c085f4b6fadabf36a9a262ca0ba21f60b44b2f8b759e59ab4fff2b58606d6c2061bb4a12bcbc95a10cf3ee4ae3a8e3a073f845bade3775824eb0d4172da98971d6fc1173e576d5d0473de030fb201753b79c10fce23124397a4fe946f1b9800eb895b442fa004b2c1d4548b28f01894e23f5f847b2be9d5846645f8690c11f046efd93a9f5a89a909da1969328c7023a040b2f33ec7fc51479f02be56f7ce44d318359b56026063ba1790c1fdb58a8a4cbcef1fb508b4f34a2ba835963b5c7e979ca335b5531aa6190424c7590659c50bdf516ec722db6930fad1a439a337e67b93838383db20fca4675fa5af7bf1f5c1a4ec5ee18ba5721bd253c786a29e09b3ca2b114e97bb9b35987f338b4f8f4b7497654dcaa80faab662af7ce9df407c31fbee28389abe2e57d8fc5fd5ecb0ed7328f86fa73f732026e07af54c6472e41c0fd424efcaafdb951202579ecb40bd503fb72993eece01ea55059bf80fc8580bd19b1645dd1f2a2122ffc28ac0e6b508b094baa1b82677d06038a93e5ca7932eea7014a0827b49f1c785e4a43e625ad9c6377653c21dbb2fdc56554ca7f2a2dfe696d8b2454efacf7459f1b55128aa32cdaae072ee6e8198bce97b3cbb953980a2b413c87293cd2bb5c69d711c35b0f93b681497d3e2671083e9895f02062bda424c12509b244eb49c6936db8c2f39260ad1ae07c0fca8cafa2d00bfa6fcd9b461ba9e11d4f4e9dc5aeeb34cfafef1376914c10b60f514bfe189d8e495ce9d7fc6dcbe92c4352f4428153d176111ef0519e420851cb03857080897424ffcd04f9e21f0bfbaa26a6fc577ac6f01df42c52941c27e03774306852c57748dbd93b968dc6c8caeda6b470d7241006f5b70240219f370d46485ddcbe263f9b15593cfa61ac865e4863353f70a57ba5b94ce9ae8d0765366152544997dcaea3a0ac23834dbe2a993974ba4619f7aed07b97fa05692d8cdbf19ce1e3eb6e58fc965e16c3ba40c49abe6a5ea9313fa59e47ea3363f4f637a9cf2802021ec38ccb7f890188da1934cddb7e984d9dedb2c1b373fc0e84f6d88f1d0f3a689bad3cce832ed343f0523dfbf47822c97b21a3b54dfe69925540026541c5d562b75b6431a9e0a2a231841e575638274d1699b35eaa10ea18a646350eb1b9c1c75b8db5e431ab9972807e868f1de9f5cf6a483a9b7e062ef19bc02dce1fcca4778fc79327f5ea511443f1cbe74457383577688ba0b610e5b407740c94e93ee60fd16e37c7c0f4fc6b66234cde1f4ff0172ce020dbac4bf8b6b69ee9f441924eba572f2146e3c4b7021d7fea0b4efe38fa96cb9a94d070ae6fec63a203e7f7c3f6c144e6475b1f5a4ba9f5bab3a99076f2cc0264ec4675c6aa16a89bdc0b56d967a5f6e526f2ba85827e875b42733a6e8e8f0a232af5e0c9b9e7f873f3b26b91932cdb024b6a043d4969acaf9dbba6f877318ba4f4dddf7e1318eb491100018c908556da1438b419f9822cae0069821473a7e608f1125dbd2d865f0fc488fe2edaeee3fb3f75f550a49fbbf55c780d86adff6a938d2e79d1ea8f77bcb2e8c2c8b3f21c84693d391b6c0a88d885cc47f52634276b40f57cf18169cce9fd740920b337bad0b57bf66e354684898a14ea39d52f3f1a3088c25ac28a90e055ac43cb5f895223d736ae687e02222dadfeac991466927593a93a9dd38fbb63f4135ba60afbee10b29d9b18c78423411a9a2b0031e478ffad0e1e3eb07484e87610475d7bcd9ead87d85c352ba41d34d5066e2337ff5aa1dcdf0a717d52a6d0755326fa7690c506fff026f3ff7155ea055f039dceafa6aa96e5098ca33ff43782b8cf69f8af664ad1b667991d3f35b6a1d980f43a0e26ec557cd4ad57c6851ff63913c5f06e8f418695eb700787f3941e3197a9e3b1d0ef9641805a331a9d6557151a52a105a389de89eb07aff14ca4de6c5711a80b1262b8f4186b38feaa3250e00d19da45ee93881d5b2de2dd10b30bde704f1240fb4350d1a4676b85b28effd29fadf4ac041d97cd7825de109333438cf7c69e70cca0a7b8550399f674db37826e7ae450702736110e70bd8179dd3cf8bc5351a93900582b09aed51d97d932b232eb7e1f85dbcaaef4fe6fdd31a6bccf6cecf917d739f073503154e83d4c3a24d048d5f9f90b43c97002884920258a422acaa1cf7d43e650b1327cfe0192896ee9d8d397cb9810047cbcbd3bb9c0a9edcda5d63a62f30b06bd5ae78565b7093ae38e5943e57d066b263b9e50554befa3ee2cb2950fef7719a798526891dd505862c4aab1bdaf54884687c348a28bffe19f1a8496195a747368b888dfa32d9ee3914c58bf85d8809fb8a0f6d3dc61e12ea46cc5f58f9d1dc199ab8a9e124dbb6c64b40c186f09b923fa75b3fe6d93538cf732d1c0e02218e5a3a14bd9ec3de6bd2b51de20a7716196bde68d2f8ea24641c095719b276c2698705cf80d9930154e87539284e3c3b115dfbb09d0126ca8ba3e52d17dcadad34ff2c241ee79350a8d84c199f152e446ca6a172ec86ed5e1c76b760ec0c3fff00770dc4c759c8ed3c3663a6b386f2d60bbc8262ae0c63bad86a1a6b529d4bdab5a85cfdbfc317337b8e4818c446f28b9d4780644a5baa9e184f657688f0b7ad95961aa4aa2bc870f12a63845bc6d70e2bf299788f8d327c83df4c67eebbb77d376ab7f6289bdda0b141c0a81d68b26f986fc95a8248f38b7d07fa4de8e276ff9c87589ba434d628edbbbc6be357d5622b91ff2bc0af59290a9d058a8bac464d792a77ae7adcf58a71c0170f6808804215edb0b89b76355941bef85b33abb3c6a785bab55ff8ff91121b0bc0df948531462526af40caa26310e71a869f9a7f73aa31efd7e7c4ea6cc0447ac50401ded555afe7d6ea471f58020b3c5e66509744f139362f0646131f779ba9abc726591567075bbd45230a013fd0b6bad74b055507298ffa2b58ef9d64991139a3be2e01cc06f467513bfdfb0237fcff82904f5dbb2ab3b17e8b41d17bf4b13b36da963d3700a16718575a7cf07c29714b1b782d9c3d44684d1ed16ec21a4a6c7ed10397e83f1ca62eebea50fdffa5896b6bef2007d514c97d7c71c2febd8bf218d9d47043a7a3b3ea79ff4f8306ba87b1e5fce6814612917a1ab289f8d0d0ca79f22a53d063e396f8f964a9373afaa8f0d302f6162135186439ef085fb59eaa71971a9298aae8e499f790c5b46bbf93b06df2e2fe2af82159f4137cdb710a9f80e80d4c835dca76e630864301d44cae5a4382745849152ccfb3355fd7e6c259eaaf9c5ebadc4919b9990ab215d4d2996c355114e62a9a45c9f29bdcf3d8a598312997efe7c3489bfe0503c33df93abe1b4e857be1e56e61debc030603bff86bd57a016f4f6c975c3707e6ffbec1b47f20e315b1f1940f77770ace65e822371c63d8044c91f6e307daa6cfdc63b1cdb8378a3c3546b9f25fd7c8e128bc9d543d129f0f057802ef25697cc2913","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"e51cb6d05ed027db058edc159e71b81e"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
