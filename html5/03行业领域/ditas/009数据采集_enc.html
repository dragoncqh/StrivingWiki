<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"cf46dd6ae7872e435feb074416c228bacb8b5a429e2d6c8fe2b6c4df0d797ab0bfdcb59b6c5f3d879d451ee031f32b7aa7c5487a0392fd633d4f5077de4186015bb6b54852d4fc21352f3778a514d09817767aabcf250ed023b9f095dc8db29652d9ea38208167e49d146b01191fbf1b506ffff4c52f696b06bfe5b1225bbfb8bc489400bb4e59d32ec328c3945b5dd7b69aa2635f9357b35de0c05edaa91abc9b61fbf1d6c8d0ec3e660d52fe5ea58b662fbb4f9ce329dff6e8f7be6df16605a4e76c86c3a4c3308532075c59a951ffff8a9f21c9d2ea8e4bb659fd1fed42f36c51c9099f2d937a424a3cd6fd90fe518e4dc1cb0be3c929d698e73132d279250176aac1ec89ff94bc41191be146059676580ad5ce27eeff21318f98f953309337a249058a7c3b3056e50711c6a6bffa0a7f29813f7ba9a3bd6023d8f8323bb4d594cc612dad248991cd93eb11cdbab8aab4c153ac65dfd67cad8bafe04a8ffe86f9eab48101c636d9797e07fd9454a3b814848100b2b731dfd86577a9449ab587fef1547530cb9584014f932f6929540b9490aa3ba963b2b64a1a1e0dd368b91fda05e11ea9e12ec3a93a9c2d1ea16a780b035c390a45c3f76093db55268a6649190761f712f7a95c3d87a1ad86b097112388669a72af0e7ddcd6a14fc0ea88b23e8a2fba6b36907ac4867316f7ff82cf4e71e744f3cecc0f8ab22dc934a98aee7b36a614f6c2bb42df218fec5018dbb968ac89affac197a139a78f62cf55b461ce5889d115f8a9b95bc1447e5a9b0f663ef296c1ac54de45a452050c0422c650de1b304ff248f277dcae784a90c5b90535fec3bd4c75d9f3b82fae2ef72f7539b0c7c14c594ea62c48c0932031e8044d3790536f97217b0f66b8d4a3883adca636e81d03302957bbac863b6c64e8143041a938ad140b341f1a66f00342ae53d8e78074ab1d079567fe66ced6641ec60b26a6881a4b04326081fc9fd30d99ff7bc82a5fd3a1455e34ac1f38ddbee9ce27a8924a8907baa6bb2e49f696511ef1425fa9e066a9302e0eef942ff926dd9ffdcd4e0207b145cf0681dd75d1435c28793a5fe006da10dfd3f57f03ae082d4fec3002f7761784364d1603d900947c57e92ddde16dfc8ef26b67b58acfcdaa081e27182703bb0c10477a6ca2b43c7978fce1312c013609c00a5e51da94a2de3f56a7457ccc68b73926a9f6483c9d767a89bafce4886e63dacbb137d61eaf5d82f9f36144ea9eeadb87126ce4583e91f65e9aaffa3239a4d62da0195cabd462b853dbf50fe1a215df1c6a8354fc800454400103fb891b3ba4b10cea22fbaa13855296d76bb24b852e4c3b09eefc4b9c74dbf1f01a02b79145c9a1f7479700c542317f21acc00f6d66e266eadfe9d90bfec33ecea7f88182fe5936b6fcff8ca23626d458d68d49851e0d84b26e3cc99310592a647cd5f9d3f271adf0442cdc121fd78a856c7abe1b9f93e80678f5e65d797c7d62f5ed102d9a4f56d4ee78df45f02bac1ea90b4571d2c7f9329240cf63ae0aa2d1dec4299a731fbcbe7ade621153c079381ae8d2ff0205e48d547fd35d5d517809302c6e36138c76d20b71cb2a21e134db5386d88e95e91400410c5bc94bf62d0c77da60fb611ba4471dc1e2dd9f0ef4a34bd2ff0708512e15dd10f67182689f403e7f164b36ebb8734e28f81ead78797cc23ef65ffabc3d258b4ede915459e83810ab2d151f352ac6add2a3d863cd102b01651bc4d75e5bb618b1308cccb9e55aeb8257ed7baba14cfdbc431ca950bb70ede9ea67f7fbb12b39e447660c254c3473490515600baf5df623bd2e2b7ac05626ea43976a8bbf565e5e6b0f2729354e2e27317b90e556e17efaa6ae6fac0976e3aa2ebd0421e9293ec6fa8cbc3a2a3a15fbedd182d114808b8adf9297a9485ed1ccf9e00192209c9411db32633312c08b579daadb0494bb6637fa294a56a0f0a9fa27063ccda99841c471f8112cbc0e68c39532d5f73285508065ea6e5f12842a276d6aea6ecd12edb781f07b1a65c081c37550948080d4b242272e8b19778711166d25dc2602cb9e060ca0fe014866b84544635c742824a1d877b8e6a71a18e9082be211c149635f5b64413377f1d5e8041f593b551a0c93e30a1812ae44369e6cf10bf4eb30f7e6924ff069c9399304b1882c97cee11b2c099380b9f8125f3a3463400850aae907abbb27ee3eb50c339e991ed04f80e1ee1e0a28317a7b7970c32451961b1243cb2bff5e8b7d768aadda7bac8ceca3f6ff32173301e86caffa33defa2766ae31980b6478ffdfcc7e62caf21998b9d8d165529eef4b6b6691ac3e1ac40f9680b0b63cf7d7f09b95f8f479451498d8d2e0f7202a7cc46db4f05512e0e235ef0c7d7ab8ab4d0b0af46548d53ada993c608d07bc11a0c3595e1b04a82feecb3256a7d36a149e03e8e4c0a75cc04ed616c18cd311d15da4cf3b8ac761872ced10efbacdb6c13f41524a2753d6ee9d313890c1c7b5381aa1b668ab72dd70343ea8d9edd9891053c4549cb5d77cdaaaebd8986f191f9d34e86c50d237766771ce22b2ff61a2955d947042e02531889c67fd96f41ba8b7455c85c20cd1cd1b70608029c96386a1ccf45ddc46091010dc90da2c4223fab62d3b25bbb41311ea7605a886fa8837151a4799ce6f16fd0a410353563d10cb543e311112d9aaaec6a9e4d38e0ffcbe7cbf282c13c3397095381b1c8ab8089568d7e9505da931c8af03e6fe28ca60382aa7135d23ca8414d0bd8cef2a40e87d8f11b8a14ff17c8a77f06b97139389cea07a728397b7e5937be2c8010649bd5741bbeff1e93431ad0c36212d5cd039977691635a6b912c102bd34e5ceb1419bd12ef95c267d4fa5c2943848f457b057835e1fd99171a2facb66a6642c1a4aa201422370d42c7c128565c57afdab9e96ec0bbf13d6d28981f47e09b4e84997082533590669e32e0f7e4a8f51281202fa9f26e2406dc70f2438744e3946710687b72f50ec0be6cae3da3e0c01d749e46e4d0b56f20b2ff3fcb112671e98d7392a1f86cdfe9c733b935e5f464e6dd79e5e474b63373d86c4065c16fa4b0edfdce4e03b6969657e849e0314fc91a4ae8420d13eb499f8514fb06753c334edbc14cb748a7d579dc8e5250a3af5d91ef86d18a77fca7c916759023001acf8b8dbe71075bca661870da83038d23702c73731a966e965e74f04b7bae39d0f7239337d647f8509fd3e0467b31db744588efcd4180502cb974edc5cb03871ff4b9c9458014d8ac411a106e3e5ce1ab06ec5c55b5d742551f3d339e2404327d37bfcc6f438e737f5f14c81e852b7f3543521102a130f256a9cf2c6c9553fb757381b786c56858a1a55f830ebe35b3c087990585b585aed46ff2c3a0b733ac795d415b6adc1c2013eb2a103eafe70cb4e51bf10f98e358f3feb7181f030b0e0bc32c1329a11b13fb40be1b4d5de41faa792b02bc0bc7e937a7f4109c1050bfa426271302b7aa1a6aa4f9dfb3a22adbea344fab2537395ed60cd588b1a62f41b097370ae758ed0cb2fec2e0bf8d04a18c3fb0defe42e770cb3baec022b110cad1f8d0050ba47a4958ff8f736fb29d35529d9f7a880cd505412b415d072510f38769cb6fb69addf91a32ee3a55e2a9c492226fd187517d8ffc1c5cc15db9330ab87447799ee2cba4b17cec9ef817e8959f134f9cd1817c61969f76afd0e84688c2957d9349e698e384515cf0d30651926c5eb862a49f9cb60d2ef94a7f95b5a177794762632cf2ee9acf9c3c58b4d4b1a35eb9548c3698c050ddcd51a08e2348aaeac4d377ed5dbd1d584c37d6171107d422f87c0d290a17275eb93ccd7ef875e8e418a5b325b062f92b392ee3eb19121e285035920f33922c357e9c8132e60630d7d6b29afb40b922aa8e571cdad329a301a5e11359cbfc678ce75f4f9e07b481e88378253b5e2cb4d8a7ab73d030b9adffa86ad185bc6e4746f11490acd0c052f48d4faf2610eda1e2263cdc66748c2d732d27aad472408890b3ed737631a5de3fbaf586d0a5aecd64d55f4cf82b54f95769220cf1b2c0603b958fd41fc70fdca5ae472f499a1ceeeea9d6fd29065cee9c9627ecafd4c8fd50474851514df2b5b04c2ff5e71dd57daf6e35da6e797dce5e62cc73bddfdc352fe9df145c02a32ad635617843f8696586d93d1715680ab3902796b309a0f077a6f825b6d9d4291f6a92ebae074dc50ffcc1580e554f640d64aa7ffd5add04704ad1d5ba98bf47aab587e4dffd7fd6b612742155bcde77973691b81fd1d678bfacb9ddb00eb370bf9d16ff6aa024eaafb5da89be24aafb418bea92f0b873dbb2eff9ddcf8c8131413974b583e34c9cf4c64410155efe7a052b6806b3aba040192daa9e0edb5cf93b3efe077ce1e732b3642669a89bb928d0181c6dbb862a33b3eefb808a947341aa2e4b0f377e71e2bb288d5cb5f935ac36aed06a1634c851c5ae66b874047ea088a8330aa76ea259ac0cf907683b56aec2b41ff356d491da284b51f1c734968eda7bfccae3ab67b0910efc3c6bcd5561c5c37c54225ce54c05ccb2254f6d03b6760cbbaff3f2ca101e46fd0f33f11e3a64d3663c2e42d28d99faabaa8d6daee04583731ed3bdaf192cf13a0acb75b95bfaf7a1c2d6a976f63bc1c60a62dcd3b16e9aeb76d31bec1b23d7102e0dc62bf313f6234380585e05c9094a9141a050dbdc8a3bb674c0a403ad35ea1b7e473c257d9e9367c9abbad462498a2450dded835c6363ef72a47cbc02863d6bd0ad683f813212694172e475428cd40ae281c615a1f4d2ce7f3861824284c6ea390269eace586e539706b8ef2ea8d301353e23566ee76a0a249c397247e40fdcbb334be642c0029716e0f83c7d5c874a03983f44c456078f87726f6905d9a5f774cde63fb1047cb2f34b72d2d83b4e9826780df8e287f2d6db23aa2929091df34dbbdf7aa8955ddcd2b5d13d70036ac397dcbcde4ec4a1cd6c3ac06775fb886849e2cf5c8f15a07882de6f14e20e7bf222f117a13272dfb93540c31d5120d71e80191e43d7fbdccc5d9ebab77f59b888276298ffc960408cf303e872695601713de48ef9165fdaf46379b7d7e648d14eb762a1beea7413c51f1236e4086da29387876b14d19cc51f0103fb3341544bfec83aca237a571897d8d605b203b552e18688196d0a0ed9dbd570c7df150c9e272dcc6adfd5241fb8ef372a7bd4c2ed0fee27f9a0693a3da41d3fec7003679dcbcb0584f7a74e30d83e2be673463920a4e1e926bae4fcb8a9e9799bc1de42e71ced341c0134aaac22895cae9273caf704de7c37bed2bde52eca32f8ce10be33965d8f88adc22032a276cdc6e725f8765ab887ae742c539eae9629089e11c1adf621eb0bdcb970cdecbfe97002463f8fc17c62a5fd9a7efa6c8e7358014f68f3637741a009df1d72a9657f571484d67d71405a3c66011ebf0372c915ad8b4cc5e6f1146eaf9da7d0bd1fa38d4d86e2246b6a12190d3d21fdb892e669844c215ad18cd6d1086cf79cd592a46778b1375dbf4afeaad01f3b93ec7e9cdf0d70288709280df0246c4387bc32c8579dd9434a92fdb8fc777eb36c6a8d358a6d9bb51be1ba5c79ce68f11b474e8c3fcce98c93fb54f7cffc060020ad7901cc3628626def7afe195abd7f230810544a02b046f1d44e2e051620296501df488cb49f543311584e7e43a6b7c7f34471369623a6928e55eb2ab2d23cfc06d16382b203c71a001ca08f9a59ef24b25e32fb20b1c81bbff8d6fdbf011cbf9ec9fd195324f2f95c7d36a698ebe4995f219cac2cbd08d97fde0a4ac4c58badcc9ada81140257e8b0c30c6e49b8805f69cec4b88543a8e9d67312977ff4585adc458af0075588ea3ac384aa863eb1ad30e3d7bdbc7f8db1d3543615bdbe014c7b77d0b52c9e68cf3f93bd1ab5ddf8a00f6695af2b279d730cd746169d89ba8a037e6bc2b985c315e339d0f82b2b1bb70274c3732834d57f22a52c4142601b61862093dc6e558085a442e5008b52e8aa13147a9a1186d585e64c03131da1f6e1df56400acb0c6bbd75d3facb9a340ddeb748ff13cedd81cdbc3f64dd4dd48fb190355f9c439274bd7476f87cc3cd97eb6ff98ff444d70f2c77a9dec616cb89fb096151a6688d4c6803414015ce41297f0d5c40c75485ff5f72ee9b7b1b0620cd7db70284e490b57afb06f279c9080c9d3ab8fd3e6db6d13a56322312dcb31d51d775c135b82e49c3ffc3814123f22f82a682d2fe8abb2dabebf61e7808223fe7fb48b7bf6134e23b6b62a9003740ad5a37ff4c410561efd15c740c6d6013905c6121c97f9ddcb9e12f6625a5cd27dd41158bd027818a82a6676428b95ee2f988337aaf360273c9c1d33b6bd6c95f7372c47a4cfa302260d35705ce0fa3e12a415d5e54e67f133bc791998054fed31ba714f6a3dec4c376698286f2e624719d3d3bfc74d3068dea4c26a04de66243e66cc9dd042c5c3ea2a02f7aeca0f0d3a7fbe84eb30046f6ff574d85fefae5d9632a91d84903e47e62af7edd6e9cf08dfa66d7392a855eb42437094842d28474279047924e31b28433cb0afb8e00640ee62fbdbfd53ba2c585ba61a1481f266d490ea57226b1480d3a4b5e2dfb24bd4b9c938624013bc75007b2979e3667b648be09ce84edcce4418f333d7e7fd95119b2f243954189a690953955f8a2fe337ebf41defa2bd33a95b43af8a828c6472cad1968e3744c44f437b06765221a97e6a0105e16c3fddad52ab4eae268c011811b81a830dffe095ea949d237a4a054d9096ccfc88c5a1fd2dce756be9c33dbfd55781175e4de1006d44fb1e8a43b92fdbaea79a51c4d26fff52a0e74d22392e975ed50a12df96f1cf21612c2e4a8815fbdbdca453453db633728496fd6154d4645b93048b9a396ea3c9ce3ec8c283410f3c1d722f2d69e8ba3bce6457fb2a11c8f818335f8b9e354751c51f822dba06fb0ef98f86270461c6304c81d7906c9b2d7372197f7e9a8f16a01ad5df893b64f1d8167466f254b307b7f69e426f498d37adcde48397c5e68f3be3679d050f4bf74e4bacc397a03793916a60e2f03c4cac2ca346aa2d0c6fdbfcd8b2e71cd69f1fb8ad518f15623bd8223654f05bd81fd726f134ae0931a77fdc3fe0ec7ed2f2f22d52469fdcf7d2a3b8a1d7e0d9e9ac1aeed55584ac7addcb1b3519bda502b99cca0cd2951fcf6b52e193c0d43b98097d77498058810d326a06997ec07ee721847f582de4b9ff2717d6f86ba009a85edd07b35a41e41d72f4d9e6da4edaf35fe006691447c0d0ec95f5d5aef3b66a1843334251bf40881643d91cd68acd16faba19fa226695f13f2e5ffcac4be999a14a32657e1c9ced14c14624cd132912b5ec11e88e40e53bfc5a5ae0a8624472e55c0f79c8de4bc7244db47758ad060d910ab982bd1725ad58291116a42eb1058e0c41e193f5c0cbe5a409fe4b1c4ccd4d886706063399d87729906c9685b3518b92666a8da77d6e567cc9fc77a6bd103d0c12cdf53e00a605ab69a27bb262bee84dbc38d5d64714b21a95bad50521d8b00abc9c91d3f2ec3f07c337aed4349a40bab9c90aab7c74b1b9fc8cdc15a5fdef0da8f6d93f3aae457c3014f16697cf7324e28efe879b153f32014cc5ad04ae984d59efff20c014c994369ed87b5ed05bdc4c3978de673701b8193608c6d19d515718d371f1a1133797de220da5c5b407ef7878f6da10a2afab89255a279b78c52f427084efb7660109dabfc59988612797d8f3dbad0f21cc50bc011f5eb4e449fe5d46c0564d49166f6498afb0d0b42594c3ec7377ae746e04b03a8f4b218ca187fc9b81e1bab1a304c049415143ff1ec30af3acdc3dfcae52913da6ce4fd6f4a5d36f58bb3c7251aeca49ccaab67329e66c4f9600c4c460f955fb0ea88c84e80e5c6f4ed17b2488d0583aaf1e6c8ad15738e3ae3a9b742e99e36f88a277cf5697c622824a30199d06190189473df174189328a84691901e66b82967d92c2228967e0de47e3b1fee3a3c2355ce85b79215112c226f5e5ca5d105eed942ce9351e8f22c37bb0581f1a58f4c57ed485ea6f1f1b04da45d2f6f871866a240909134a084161e15de80db12114f5188af3d4b479ef9d6efc80937c68c8da2f24123c5f2655baed0e40081a2fc6120a54a8e24289e6424db9ee913ec87c74d6e4a06eb35e6eec44456dbcd68676860902973068fe700bdff29082eba1fb19adff8a5d58cb02211ea42f068d72aab554702ebe087f7b26453431fb15c48106342456affdbb0d1c368b64a5575b083f780d67a6f83d59e491601f722b0dae5d51627777e52f4f7197a9fb3e78f1f7f932502e895016c439db2f71af376cae7b1ed47c567d8a5a043b2a1febe6cf322a86cdb2959b51ee8ed826f423afe46a16c76b5d7f9f0e49e5af6b71025ed70c03dfea40696a548a75fa6103ea64ca23c744c48aa8c0526e6ef6e8f2f345e1bdc760e1087abf0c0cd73fe77037c3000ad7d4be80d3e09763a73f2108a50574b30eea4fcd6b0781e331f7ed6c5377286a908462e686f21633f4bacd4592d625c8ca6aecf565e1e49f0f0f222c32dd6f4466bc0c0a58468c4c1cacf77642f80c0efcb30e3de74a03ee986439ad5f4eefa073c325a66a2e2ec2cffba08268b29b7797ac5d43083994cbfe5ed86fa1203af6df6f42c2390cd353cb92266643c4ccd6255b8c4aed4372f4d31dd64e2c7cb5346eb3122a11852baa318914eb0e39b7cb23ac2731632b1342c44677fb456a447590130460f295aebb867766f27d644306c9ed246b496007a7927ae1229067dedd539d1f875abd3ebc0ac80eeba934f2bd2558ea0f695ff160825d111195f12287a804c33f07af8a51badaf0167f0fde58f39a24a5034dc24bfb8562e2004a6a9592f209fef1bf08a051129b9e507d863228aeeed7866be4262608657b79a059d132e61b8db47375dbd3e1634a96bbff3e48de7b483370eb764d68aedd16e20074b366e0c12baaf19c0dad0cb4748cd75248923c4a24b9056012bbc27cf4e81c922c103b7778a30d2b4d68bfda1ade946e8a72f0d6224055c2e39498a470eab6db76758e34906ac6d5266d3cc131cfb6184a4f906bd2b6c7cb7d24c4f1be8ccce5a0db684f0f49dc0a70b718a26305615f3b3878d834dd1ca30c36fefb1558d582bf272f3af8ac7a555586980c7af65855f8c92834e0bbc4f5ed44bea1f28b79dcb5e13e0f2749e87e2ca2de9f9104bf60ccc3412bbbcc8c0b4518f507f84636811d61f04aa91187c6cb2f442a66b4fb2d0302a50a36e8b8dee8c2ebdcb4a200f8be0cc74342bc16f01da1b7701a9100f3cbf9bff52405dc001a9301ecef0e179b7f1043398a4f2f6cc95ecbecbe9882b980a47aa72725059b5216d156fca941c31bc99e39d3700e9d4b78b4e9ebb3d2b71e85ba3cba6b57149a9e90d13dc486f7346378f08e56061858801fb50c47613ecb8a12b1b9261acd3993b70b6726e40372b37cad445e90104dd14e8aaf26338fb6f8d41ef0035a19af0865a84131d97d841ed0a77c82a727913f8c518bf515391fa7d81f7672d4694780be93ca915bffed27a1eda0f4c2d88861b224b8a45fc8a95b1fc5c32909e9c5a55f5253585d2bd738f7acbac23852ddfbd302935b320124ebc59a9c651ab97f80d3c2716f64dd949132cbab6fc2c7143a3fa4ce345135c359b40958a4060ffe47a3c80fcdbc511c1d8a28fc7ac822ff3df068396fd1d153d1c77006cd710b078c2227aa2a59835adb043fc60527649a68d7cc6a97be619ffc9db866e361708d9d7d25bf4d724aa6938269353e1734395fd9a46a331a15ea5d6d142975174ca533fb020b672194e43177675c15f7b910dbc6a770e8a613508c7d1e077c06683b88118dd61e6f17f31f949d0f1ee0b3f7d36826561ea3fab21bc1354468e0000df2f5c40bb6f1e585e172adc6dba78ad8a10a4fc0367538436a02b82411780838b1bfb9528928e00538f28d853434127ea6cd0370d74bd8ad4569157497ba8334eecc198f9050fca7bb6a0822ed4181630ff1f7b99bf9d85a0a33379e51948a1e2e467df9633dd4f042dbabc1bdc1e70078fa551489cdd69ea3d648127af1b99f20d32fe1b1734efafd609b844e63b676eb53b1617b12e388cfa72b3d6ab1f15d6fc4653247f66bfa34ccf815683749f07492f77be0f1bab2ebfc72e86d2a1e3d057c6acd91f0c8df8b8bddfa59e7adc1d73872b25ae5692860a3f1d36f16ae748af6b56fa99a0e2860c625512e5b3540aa7bfefd85e264fd51f439acffce5ef32dc2fe718e07cced0a64a6c085062157f935e91022ac270f7d189c5c4898a89aae8bf621666496a02d626967b0b4fe682ed43698ed89ea667d26bcecafe8831b85d5a3c24e4f6371f885684f11fb681ca6a1608c9d45f93dee49bf2b0e08a586b7e544ca63c8a16b9044ce6066a272bb4160a58174d61f12aa9483e5e8596ad06389bf9df1eab8b105e592317c4a57d067502eab35df942015023e152a61172cd9fb29351e6d7076e33643987cb38dc80a81f5532b515e77ba59f59e4ea253dbca9799201272c034efb05d1bae544f4973f214a042e3b34d1dbc6be01e06187ffea862a78edff6ecd57691b3ee4f3d97133c96e9033598f646861a9a2b5a72e0850aae130b59dbbc3eb7b5b737d29281228fa111defb72262e6f925d4ddbedef5b62b80895f7b0a1575f9b091cf2836cdbc5caa8dc3fb85af78641b952937f4343c4c6517f9ba5045578945460ccfe5e417b65d761a36da8eb9f8901c9cbe084146449d396742d5e447a88e98749722b2dfcd058c012ca7425ee06973b7a61f23a2e961c17894d4cd3f503f94af9f6bf7831bc46b89e1a3491d20db442e8353be23b67c11a162b13205d6d9a0fd37a1e5c5f419aebd4e008447cf832f4e7851573171844b8104e01328563820451fccbeb55fb0e8541cc25184a712ce529605b2394613102fd3b8284e8a2a2c240cebcb9bb01646ce4f7a22163b4acfc3aa01d08a5fbc16684f147567e9cabc8dc65157eb5451a2facd940f1ba6459639b3b8a7063f79d2a529d8b15abdc2c9e93998143c373c18b2bd94919fabd116db01c67c8e506d5dd1ad3593e009783c85fde81084e62ae8fb1606702b8f8a167f1b78ab56a71b0ee2e6b54f6d745d2b2e0236136d81acfa9f029bec3b450a4742d39c99d77a446ac89f937ffa75edc07675fb6dc56d9b6e884b183060f71ea2f93a078238700868782d0702b1c81f678693d05aa36e45f528f4bc1a51a9822528a3f5940d4104213b300d21d6db732d6040c01b4721b04ce31f443144d64d2e3e2b1312fd31a6ad7479f4c2aaa5f3e3cdcd231d10e0e7909130df400edc3fe3c75e86c8cefe8088ef301257b5a4aa0d71b1f27f49d72d9d0c79f613625f7234330fe648f85e4b359030fb81f4fc6a7af170c88b379daefccefe2ad8d17929038ebc2fd36a31c09edb1d3ef86405d10f4805549667bfae13eef4ebe2755389f572d0df9fc73f750494f91fa928c8cdcd45c4611095a3249060be75bc77be8fb551286a9db091aeb373d47a25d6964a7f0028d207f569bb368ad22980237d3b6df088866f7b082a2c305536193acb44b722f768703db72dbfffb33927511ba9905adb6f1f5da8e85a81a1cae7b61b39fc5580d871d64ceb5a5fdb1d400dcf04794bc15058ba392dafc0fb956f063a40670c384f08189fcd6ff7d7e4213fb23da83c2782e61c54d814db25b5b52409e53b66b702dab5a4eef040c8e6e7354e4f148d4555370681c3f425da0254c7cf3c4371142d13100dad590272d7ea68fb02893db95af6deac6b85a96283d6b3e90f4a87c448884d5caea8c412abeda10b139fc9b8e6f70ef14fdc82cacfb20f5c9f3e0bd0217607a42df70d1551208a1b2750dc82fdc8dd737b89badf380b08b92156349f154c2047267fba4d5c9542bcd980b8d3dd2d1216829dca2ae8138eb1644a4b91ff50ec75afee0fdc1b1a91930bfe9c8667e64ba41653c420aed0e7f3b82a85a290740fcc508a2c5a86752b7aa3abdeef13baf7648cbf4f09953e3b26ec637c20a5acb24892c6a8015b3c9fb20d6daab583145d56d9979c820402abde529e3c12481f81dc5f4e1c8b9829d189126e5e001379a6065e2058242a7bacf3245320bbb61c5c02a8b20613ec924487fda6376c71b132d25affad758df4014e43db5f7fae703963316c5032c43b8947fbf504ee6b1373ea372a744720c46dad727c8e85ffdaebb9cab66329c944fef15abef6a39463a18b2e095ccbc8fd57a1109fc3b242316a10b9f4d391b85190492379953070168822f074f161e15723e681e097d870ce9ce54ca90c7202114740fe4a7d8d1b7e05bf94c030fe0a32c49b6835ed4054e0a472c5e889a7d425aef7c964e1b8bba370f2508124ef2d1e0c3f74f47ae548210011cf893e37019551e13a3aba4723f6bbca016ce5f10b073013b916f73a84f5def8c9c61899bb899187ff89d3431407a0766c72ecc792c7e3267401de9a973ffdb2ac08f1b2f7c64c45cd40c9ed7edccf7599da4ab1e4abe51259e338dbf6b48711228df615c19b9c44c75517dc40e0f21292753eb2149719e3ce219148723d10535707966bc8addbddf66325b7f465a05c7388638bec4b5f12f355604bc87243bd84b1ce45a80f4bdefcec3df9ae84e666c11b70e12d1b7b3e77ba6adff7b41767a1eabfd4475f32f28e128c4224f86379aee72876a23d1efd68f92cb65f09cb59a930d28f5c62c4556998e7bbff7962141deb51cd4540df97e88e6ab2f88efac74f826cd5ef26bbd630ab3ff344f6ff2560d93df2b390dd9780caff5a00fd4c77682c8823674414d3e9eb410f63ae23187b5d364f12724e284c2ef6fd1a26427d6397c1bbae4361971eda147760abc3e0860984a52a7f81d3789d1697b29e8e04ff4fd6362d54f2a0157095aaba408fdc427ecb58fd19df195298c27d23332e863e381e833321ab33ee88f61872a574a444bd72191f33b370d95087ee49d1886a48288fa392e95f83c2c1a286bad4a10676b72eb7b25382ea8c94e90a686df501d53b9e5fabb08581ccbbfee28d4bacb941ed3f854a63c473ca86c006570adb1a9130e304fe64a26e5d0540bc80f5071ba6b6165b0482aaf77a00fba0ae1e264a217ffd79f93e116d4ee5f62eb24af87067f269b2a24da030417876affcf6da6f72a6f09f8d0719e9ef58d51ca82ff45aa5748abfde549135049acdb49ee341e5760923edfd626c9e691d325c7b552d6398bec7373aca700f142880f043d197271c5a1b8e479119ceadd9026f700be73b42659238e79523b4d1ac9c4dd298b5b7caee79d50e6971c8ccb3a8dc7bfc2a4325359d5a77aa0f437b2cc28a7161766b7c33c49ceb73d3ecab712ab438efc1f44bf55015412c4fdba12245878d4f2793d241f0a8a95ed297fd047ba52e8b3f4fe6e3b2d9e7c9f99acb48dd6a74365db4831a9f8cd36b96c89db9e9573dea6a0043818c00603657b7ebc55e4014e2e192a23fb03db3cef2d85395bb98439e0155f353998964684478dec97535a5281d0813797e5c23b2535cdce85a4d78edd6079f63969600211f9b4775d75f32d46ccff256e458d302eb3e00f63581874791796ab11b0311897877a33ca4060890e8f8565d0cee64b4865870a3fdbc6f4a334801a76e33805fe0d631a2524cfca3f8f731c26f764f4dba2c8481ea15d5f1c30aa96db7091a7142e191d1536c655d72b28fb5b93c58bd381a39448cfb0d49206f2aaf722a5e1119c8da5b86781faec96a2774820d75ad3c0298b2e41fe5b8c0dc25341f37c304efb203e1294b3afc1dbba21ec59454a9cfa0709381306c911ffdb8fd40e0019c13ee1220593ccef33e607c3ce55ac0893eeab970fd1a5d96a2992588cf5399e1f0ca1612638b316846e0aa8cf2d5b956ad05fe584c7351c63bca3120437905b8c11d5954a406d776f045f883d35aee8866922a86892dc80a6ca22c3fdc680a5fa52c12d115505a8ef1a06e930d785c150827163bd1274a80d61a087de7b494c9d8f638466c8ae83d3af1801b274df9bdc85f16ec453da67ff0a2c4580ffc393db8cea50b70322b659c91bacc4b9730cb7e23b7366f9400331ed2e9e581c6c2bc138498dda811e0c46ed43bafcacead4fdf15cd537d09638f421573c54c0b3144e3dd879466732ff3c51a73a677cc449b00d3b02f5adc62a7fd48e2592e9645975c79bbc246fe36922060773fb5bf6ac8c48fcfe6666eda635cbc08118e9ee48a55744a08434282e2de12b2c1fe9c553805bf5825bf640fd31913cb5883e5f19bdbb369bb7538b59f2e11b4409aeb2031cac82db70031eb03199929a59fbdc4a15878a05ff64e3dc7084f7cfdf032c0fb28aa0a35676d40d5d0f378907741ca2a7bed637c2020997c57726c643783a311cfaa5d0933f2fce9e211a9829f387e1dc6c0f9086b0cea75284fd78e754ce54b8cdcd35fc90fb96b3556f876874a098ccb25806f6194008a2b17b656fac9de5527e3b7c795214b0f8682a28be539df6fe809fc11280037a1752c55244e4e66a9af282b672835a25a79f0bd1c53d3236b88454ba9f2b02a4be72232501d64fcabd6382f6b161255083280e529a81329a68f19cccc07c8e7f724f3b1a5b6c3539876862086afea75e5f27f6810095bbcab60242a79b348b9eab17d90cf68491d401d627aba89cc3c4473df88d502317c7c0c1d6d6b748f7b267527eaf16acf5bfa14f2079cb55c4bd14fd187b6d47df7943b97361060e1acff9fcd8512952c7245b813deed9608fba620c7af713ac5eefbbd1e85f6f516eb8c3108b7416f14a31d92f35b08bdc6b7cc6dca32554e83e534f388200f3a02d5329b97a53a0aaec124e66e05484386ee1211a71d08b5bf733066d515eef7db0b7a9310fed1d6e44a4a066d509a181f994da715d17feff3f24594137d7adaa15fcfe7ddaf7d4be651d58ec1822f44237481462d5cd503f2c3d9208bdcb891eff277ee81e96ded266ed98c13da5d5ef466cf2db42229a960384066abbab43dd857459bce3aeb39196fec7ff011d97fe26bd64d60e2e7cc5c86f801f94b7a93b2648affdab98810029304ebeef5b1bdabbed1efd3951f9cdf89da70c9d9c224c4223bd158023000206589ebf7028801a60f8f492f79a8e52586abbc4a1cb6561ad156ab1aa659379c34c7ce4abbe95d0b34f2a70be5616250c6778131bd8daec5f350147544617197f6538584ea7f4ca0950cf1ea7a6d0efc0cf3f94466be0dcf33d49929197911675d9f0cae0cbc03502b77003f06705a7a48d0bc2d8093e9c3abb9e659d845ad210235c6be53e5568ab3cd48d7c4372b5e7ef9123c427800406ba56e33d38261bf816c87d804b5f0a4a1bc07b09ea684338910ec39ebfb5fcc3b5d5e52b2ce9438f493552b25ee123f0467bf0440d36d733e5fbce37ff7d219790b42758338c83bcc38e76b1053e0e5ab09cf4d861d2e422ab4a15021ccdc8564b8c8f92f61b5a4f2796ad1ff272d5bd93df4e6f52ec1592ac1775bded324d3a56964e16b7e64fe173858b9affe7939a10cdae6cffd759059f65f2b858f9a6127075c19ee0de314adb19cfe0b3559f4a48028d1a58e97469e22c54715cb7a799a4029652c1216641568ff76db840c8a254924a7e3e83971b35db84c46e60bb3b02c86df6c6dc2548dcd9f6fd9c4ea9d963781758d2b41d0ade3384cd34e86f2bfbe3c1df10e2ba6f6e73d07ffc4d5b316bea9bb95c90051c1475ed9abfe336ba83aa117b1aea24b985b47bfd0c62d940b7689f3226b31d5ba0c38b4e97ebe2fb35a338465ec64e501fb00a11859cf2fae8394447aad040dabc8d055818dc3d08c00bcff11be996d232ced27da81dc4d9d682b05bc27d606edf264dc5439112e576e109304bc2a750d7c211508059c442da4fc8feaa9f72773ea605d9feb51a99f3f51b3635308c6a8c44d4fc86a2e89ea0a824c8117be063118035dd75eae59e8fa196131ca7b74cab8d18889222e36f7f15bd1bee725c5dd25ebef72068e39bf6d34ee8607103994436dee37cff7eda8cc8117f4fb279b4bbd21c28587b7ee8c20aa9a5c59781cce058bcdf87dac1e33b564f14ff8224baa2bed66e4dc37fbbd26c3a87ff54cfe0eb052a5b26b4c56e1231a21e9ea3e2ddcd062bff820d322593ce49eb1a8f0a357281e6092862d96e84c19a5311c6423fc2a63d6838a19ce9077c67f71a08556e5dc4663d48167d7abc789bf2bf8d1a4b873afbbef23a858bee6c97ca5ed93b00865ec1661968bf87170b2560fc33d298651f520da106c22dd91763337071a2e942cdf6c7596372340feed5e219a049b721926992216e5eeae0fe7888914197db5ba48cb6ac28611737d39a00f1285d227e50a93931ddd39fba982d9b062782cb4aa2ec283087d4af201eeb60a22bd99334c6e74585f02d9d21dc059ee5ff49b39bd1a0591d796f5ca5a4b45bc3a598e1ab31a7fd52765455743a65fc89e8f7dcaac65cabf7289cc7996dfd266f6dc8b489c1550d4305d2b4104ce0203defe4c38af937d8805ac00ddeafae5b0b4061cd1a1f1ebede57bf489817f79ed9f40689e753d05508c1f5f17818b1fcfcac856c85f4bf1cf1957b54cef9e83953fea825f08670a9e99380d71d145708e9bb71d4a402251a2508d5f10479214b72baf78e8b14b5c229be9c0c53be5067803fa39f04889f8d97a446c5816cb4d288a355f5ce6cc32d00ab13422d3ab8923758a828a1824989331be0b92505e26e2746b55a6da34ce144cd44a599766f0153c1f6e4cd1e2a9581327a46c1aa27c1769d3d30c7c490791baaf09d8f0fe1a15aede2bb4c32ae63b1ebb9749f39cf8512de987f7ab7d114a428ef8bb51b7cdb1bc3f6b8543fee662f68f01e040ab6a7a75008d7972abc72cab2b6b872632620e7f206dacd6694413f84d2515b480c7e9ae4cb0bee205a1e50ea02a860f36be68001205b4eb1249d03663f8710d35cac397fe5b9bb4f5954fa672a4a86d5e71d7b93ecde3a4da745a636621242f57f8ec5c7d7179d0d7f977acf784d27430a07ee28ef8cfb954245056f4b8d153f14d994d88e0ed858fbeece987bb2fdea71c9f6589f2c6a8757993eb17bff435eadb7c940a739800e644f28561a4f9d4173155d005866a294cff465edc2c4285e505330a5c3dd8324adbe19057a28773906dc9a149379ee57a69b0b6b1074d15b2fd9106b444ad15b354e69c22d037d7efb325d74e0854c6a35481a02c1399a0c70c122700c5a395ee9ce5c907e60ee9a8456e4be1588807f554931e022f80a9d4acc2d8bf7d7685f61672976daf4b931bde2841a5b7565762c89c9c5ca31fa44e4df87f476","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"e51cb6d05ed027db058edc159e71b81e"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
