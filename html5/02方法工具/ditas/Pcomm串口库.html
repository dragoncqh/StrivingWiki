<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="zh-cn"><head><meta charset="UTF-8"><meta name="copyright" content="(C) 版权 2024"><meta name="generator" content="DITA-OT"><meta name="description" content=""><title>Pcomm串口库</title><link rel="stylesheet" type="text/css" href="../../commonltr.css">
<link rel="stylesheet" type="text/css" href="../../common-extended.css"></head><body id="Pcomm串口库-BF994390"><main role="main"><article role="article" aria-labelledby="ariaid-title1">
<h1 class="title topictitle1" id="ariaid-title1">Pcomm串口库</h1>


<div class="body conbody"><p class="shortdesc"></p>
<p class="p"></p>
<p class="p">PComm概述</p>
<p class="p">PCOMM是MOXA公司开发的一个用于RS232/485/422串口通信的DLL。</p>
<p class="p">Pcomm lite 串口库介绍</p>
<p class="p">关于串口编程的，有用API的，有用mscomm的。其实用了Pcomm lite，很多问题都不会碰到，只需要打开串口，建个线程收数据，然后只需要关注自己要收发的数据就行了。</p>
<p class="p">国产的免费串口控件象Victor,SPCOMM之类可用。还有codeproject.com 里面的CSerialPort类，Delphi的Tcomm等</p>
<p class="p">与其它串口开发方式比较：简单地说API是基础零件，自己做起来麻烦。MSComm控件、CSerialPort类是实验室产品，Pcomm
lite是工业成熟产品。</p>
<p class="p">PComm Lite是家叫moxa魔莎的公司出的，moxa是专靠串口吃饭的公司，业内有很大的影响力量，专做工业串口卡、串口服务器之类设备的，软件也不赖。</p>
<p class="p">提供的pcomm易用性、可靠性久经考验。下载地址：http://www.moxa.com/product/download_pcommlite_info.htm</p>
<p class="p">目前最新版是Version 1.6. Released May 14, 2012，支持Windows 2000, XP, 2003,
Vista, 2008, 7 (x86 and x64)，开发环境支持VC/VB/Delphi。</p>
<p class="p">注意可以会搜到另外一个Version 2.6. Released Jul 8, 2008是WIN9x/NT4用的，不要看版本号高下错了。国外工业上还有很多老系统在用。</p>
<p class="p">用起来很简单，pcomm.h/pcomm.lib两个文件复制到项目目录并引用，pcomm.dll丢到windows\system32下。</p>
<p class="p">整个库包含50多个函数，最常用的也就10来个：</p>
<p class="p">打开、关闭、设波特率的：sio_open ()、sio_close()、sio_baut()</p>
<p class="p">发送数据的：sio_putch(), sio_getch()</p>
<p class="p">接收数据的：sio_read(),sio_write()</p>
<p class="p">查询输入输出缓冲区状态的：sio_iqueue(), sio_oqueue()</p>
<p class="p">有时可能要设读写超时：sio_SetReadTimeouts(), sio_SetWriteTimeouts()</p>
<p class="p">这些函数见名知义，用法查一下PComm.chm就行了。</p>
<p class="p">接收数据一般免不了要开线程的，在接收线程里sio_iqueue()看一下有没有数据，有就处理，没就Sleep()一会。接收数据时它至少会帮你缓冲几十k，一般也不会丢数据。也可以用sio_term_irq()指定接收一定长数据数据就调用一个CALLBACK函数。</p>
<p class="p">这些基本就齐活了。需要控制DTS/RTS、自动流控件有都有，甚至还有Xmoderm/Ymoderm/Zmoderm发送文件。如果要Modbus之类的协议就要自己写了。</p>
<p class="p">------解决方案--------------------</p>
<p class="p">挺有用，谢谢</p>
<p class="p">------解决方案--------------------</p>
<p class="p">十多前用过,当时好象是一台计算机就处理10个或16个串口的数据(具体忘了是多少个串口,至少是10个串口),一点问题都没问题.现在早就忘了它的库了.这个库编程也简单,好象当时能响应数据中断,我是在类似中断函数里处理数据的.</p>
<p class="p">------解决方案--------------------</p>
<p class="p">Pcomm缺点</p>
<p class="p">PCOMM PRO的中断接收太龌龊,有时收到3个,有时5个,只好采用中断收结束字节,并且将下位机发送方要发的字节全部拆成只有低字节的数据,非常不好用</p>
<p class="p">PComm引起的内存占用过多</p>
<p class="p">2013年04月28日 ? 综合 ? 共 277字 ? 字号 小 中 大 ? 评论关闭</p>
<p class="p">在一次使用PComm中，发现CPU占用超过50%，当没有接收数据时，%1~2%左右，而接收数据时在40%~60%之间，但数据量很少呀，难道是我的接收线程的问题，我是用一个线程一直读数据，如果读取的长度小于1，重新读，一般来讲，这肯定会引起CPU一直忙不停的读，但以前并没有出现这样的情况呀，也是这样写的，忽然想起了串口有个读超时的设置，难道是读超时为0，所以CPU一直在读，结果加了超时设置后：sio_SetReadTimeouts(1,2000,40)，就正常了，说明我的判断是正确的。初学的朋友一定要记得如果是使用PComm通信的话，一定要设置超时。</p>
<p class="p">3169字左右开始出错</p>
<p class="p">最多打3944左右字</p>
<p class="p">1，为什么用rts</p>
<p class="p">2，硬流控线的接法教程？</p>
<p class="p">2，能不能用软流控</p>
<p class="p">tx Xon/xoff 和 rx xon/xoff区别</p>
<p class="p">3，能不能4个全部启用？</p>
<p class="p">4，用最新版的Pcomm试一下</p>
<p class="p">5，用Pcomm的Demo测试一下</p>
<p class="p">串口通信,基于PCOMM控件,可将串口2、3脚相连测试。</p>
<section class="section"></section>
<section class="section"></section>
<section class="section"></section>
</div>
<nav role="navigation" class="related-links"><ul class="ullinks"><li class="link ulchildlink"><strong><a href="PcommPro(%E4%B8%B2%E5%8F%A3%E9%80%9A%E8%AE%AF%E5%BA%93)Delphi%E4%BD%BF%E7%94%A8%E5%8F%82%E8%80%83%E8%AF%B4%E6%98%8E.html">Pcomm Pro (串口通讯库) Delphi 使用参考说明</a></strong><br></li><li class="link ulchildlink"><strong><a href="Auto%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E4%BD%BF%E7%94%A8Pcomm%E5%BA%93%E7%9A%84%E4%B8%B2%E5%8F%A3%E9%80%9A%E8%AE%AF%E4%BE%8B%E5%AD%90.html">Auto编程语言使用Pcomm库的串口通讯例子</a></strong><br></li></ul><div class="familylinks"><div class="parentlink"><strong>父主题：</strong> <a class="link" href="%E4%B8%B2%E5%8F%A3%E7%BC%96%E7%A8%8B.html">串口编程</a></div></div></nav></article></main></body></html>