<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"34b63a990ec8c48f403079323259da4b9570b9a3b4999f908f0879c0ac68f6efb934c57457ba7737d9bcc531025b615b58d634debf68ed93b12252c5145e9d90360d14cb7f58540e67f21e48e3739731186f45e6177cd4565962a4f1a62b917ac9ae10e841ecba229a3038fc27d7512e9d1326cfb85a0392927510b02fcd2f9b16806b1ad7187a0b0b451377c1f32dd1dbabd8bcaccb7b18328bdaa99e14e8673db15282ac05511b434c63b02802e92ca3230e80c475f27eea49569c557e18892ee40579f1e0a58c88a82d1add8ea217a0110d6db98ebd486ed937567b507b867edda989cc878d97d0ab0c82636402b125b6b3c57c3ba16af40a389f1ce556dafab79175552bce739dedadaa40a5865bba8efa632ce811d7cd1a0424c32d549901e98e6864ba25a09008d269d895b99d4fd5ac4c6bef90707296878f2acb7700b928727be65bbf8997382da044a71ad65047010df3f66e8614616e7ed0c530dbe9b6bd636523ebc866b8fd8cf83746ea552c71a512efeb6d2057f2b45b622c023365161739bcaf17c7e083574408a562a55325859e22b8dbc75e8c35dbee9d571015bf338fe271c9e813d8af6f7b26044359aab13e8af012114b469f74b236a923b8326c105ea6ed6004010a7903268fa2b086f69a2f0d463de5f4eec252b5d2af077978f996cf4837aaa310d123f7524a19e8d66ed6db12bef46a0db08a55a91717cb3dfcc8b4d3a226256be177e849bfb04df2f4c528179851c4fa1e86408ef9620d192558b07e7b5747bec2371972414c3645a2548333708e8c11e58968b6dcf7c458894c9997ffe1d15ae91fdd946f910d2343a7bf7d2062c6452ecc559ddf1c9a1ec717ad4344dc08b64ee1a0695646a3dd0155e35365c656c54e4a07682b228679c395b58e4eeaeb25214172eb94b172647094b2b35c588be7d58c0d0f05f21dc2a8d53ebbf4f6a4bf4852a86f9a3241c63646f318a0309e0bd1f9bf3a385a86119f3bca0be7cb62859846a5376b570fbbd8e36173e2b25c34c024aed5a4f60422ac95ec65910328d00c18b17d75ac0cda6b877788f97730494a3ec3006346d9a95f6d17d99ba0231a0454b1e4787939218c7e4d23b3e7fb46dd87cf1f2ef3a96e06584bae345084b525b3d0e8581e07d23d0a9d8d4f03e09580e6dd1f0fe21d9d6740d77d1f57e59f1c207cda049bc96b926e0ca30e3708014bbfb0b55c26435f89fdefae8437ed64a1f86de19748b6014e3d70e63493b214186bd48775b554e1c6340b310b8cd0faa566e5462ec8b377aca27fbe4e8dbdce535cbd4fc31c6ed4d054b64b6e7de3f1b4f7c34b64db9d83b9d08dd5ec83c3fb70991d5b7c87e7eebc19dfdb84a55dbec90d3c087db4977ca0648a0d0662c0157376f1b6ba833506f049c87374f2613888c1bbf68af342d915284a9210dcdfabde1e4fe8a03f1f943c9109d6feb6f6eb8d35f3841d70257a165ad8e11bbf2e26032e7db4e7b6b5cf8c3c999090ff23207c1d3264cb79edd7d3113951af37c21307fb2ec59ddc6992d3608bb934ec12edab3270b615e4bf9ee7da27f1ae319bedd1de6e8220a5d049c5557de18724ee56d4804e51caa1516a66d48e4212c76b5b81bbbc30598f6ff13c6f20d23d009a446325bd54891202ece87c8c646c06d1cd5cebedf9bee4b09ec6157713c1055586ce79648cce0db23be9b76458b466ab78b047123093f6cdf8fd2940b4819c0dee4b2dfcd8e708bfa5a57bc17a5490b9e77ffc0c2536c36339818419267eedbeeda044bb574b64c78ddd3b29dc380fb5874d4502cfde10d737241a7112d3314008b2ad83a180deddec1c47b3386f2423ad9eba51e7e590e0e7326ca9e81c17eedef3acfaf205727a6c4308ce5994d5b47682e54cf8f9d11c9e3fe41faa98e866ab312ffc676f907f6c6243e2cec3fc2782bd8e94290c2b569ffca1f7424f23fa21c98854bb2bd9fd80aa7f8b9e8917a644d6228463d12cdca2ed6fc5a74a84bdd62c6363777d85579b36585902f03de201a8d2768cc9b697d4c16b618b543cdea4e749b598df0a5f536fd4521a90730e24ddb43ad3462f9979d67959c8e7f4d1351b0f7fcd24c664b6ccf2fae0c237ea63e8d0855f2d336844658741e5b544922c11a1cd850fdd680f6c514908fcce3030f6f694d248f5c607e232ef379578f019b0bb8e2cc7addc9f8fe74f6df6186c47374209bc5da5c2aa93b484b36b247597989fd45b60c31fee2b6a580aa82a024ea6cffc65a0f8bd9e4dfb110a1732f86c02273f375dc81e143da175c169f1994a9fd045bd3b2784df430d61dc85693549a8f500814e1608f1fa33199fb43487fcd675ff59f027deeef17357ff5d870589b01efb87ae92ee89498e88f9937bb8848267e3f7f744db47ae95015fba005ab6c397ea86bf0517b41a2975891273b6ae532e95aec0fca6e5000084d1c4181ff52926bd0e0e854e9ca25817bbba2d3141463eaefd9e79b358f924b03cf3c26aeb935af139812af2cb8453f512d64151de2cbf9f0550d0368dd93ce99d056badcef4de55ce2effac30884ac26dfd66309e05f2b809735688473a12da20cf064bdc9488ddfdae37933a555edabef4130ee6c3e5a40f709ec97eb78e699bd4152e6ede82141b517b7848be8e842660fcf6f5acc2162bf7aae5fc840fdf5bf144f6ee1f4dccce274597b0b7d4066dff3aa1157953aa9f885cd5f71b9f5da8c94548dd2df9b34e8fd1bdd59611db1438ad69270db8f6c6eebc54a9bee0bbf8ae98536be0336bfac2e60fde5c050f3d7663d4053d9f1ea77d44e9e7f0fd6391bfd41327c3fb00abd248491e0c4702cff2a5613515946486a9cfa21703eed81f59e3bda92fd5a349c373faf1df458407369eede78d6f008c494d872a4793892fe3348de8c8dda5d5a38937e042859ff5435ef0d1e5feb4e872f7f1ca9780a3a659220a528c41f0283680516c1de3ad80eeb999fbad52096e11d92bd7e62eef89cd57fc2e5b0b824137b44fdcbc360b0633916d32e41f127c13733fe531554544d87c18873900f136cb0e6fff029132a6430975f13459eefd650832b87b32f22fcc9ff469d0c852a4f525632d11ef6f074fa9e48d79260e5860735bedf5fd59e2ef9d081b305d1728e0d7b430c771693026ed421097a62afecc21ec014abb04804a45141c2d753626a196e9f3b68097d315f3a13d8466fbc3cd4f9f5822e0d3a3d5a453ddb598ea18cacf399a4a0e569439c4940dca40da146a73b2360f7cd1e6a224ebfd312d77acd620518aa751bdacaabf74156323606dae90cdb7340304b8bff511f2241055be9a6fab29ef9dbe84f5a5354c4b1e04123fa05c50e4236486a0b2d8f591e1889db4a5f3df1b930dde856fb4c98d917486b9574ef31c0def246717b075ed5d7f67646222491abd134484b65a20c5e26352ec9afc7c3108d7db71a607de115074bc1841af6cf400633dd69ff767a9465c4fb14f248277ab04359134bc2f4e42b627136bbb8e74fbb54536ce6d8328f00be8bb039a23fe86cb089d97eeeac382b4da0d812ee5e13dfc9e1457e486153ed47f0669db382de963fd11a167acc2c831ff90786b606b7b61651384feef95bea60db54f4cd9962182bb6960d100ccd6ae081b6f452f7987f02e96d44749e117ee9740f30c20b2cbe285b76050a4194160bd48889dc1194b779c8ad89d99e5981a9ceda005615cc7f080bd4577cc4606839a592326608174eeb76e6d49e067ef25f5037bda68eb52a1252c869ef66629a7faecc479104cd036e9e9b14ae2214e693b636d363077d3ca2bd109b95f386f532d792baa1e290b52e8cc0597847ab10660b2b3fca9955da407c349878deaa6c53d1c454fd8cb979f6c1f9d2143cb40bd21b964b73765e9fef6a5bc4774cdea3a36923c6b56f3bdada6e3cddbfaf6eb2490bb04570f09e66d11bfa762e604e9f952462c54946fd578abbcac3785e6616a3570ace334b0f6ff753ec191e18d8abc2c5ecb647527bef16cf878ac17b0a7bf4e6654ff32bb4179d191d912968880a0a76bf681336ecea016beb709f81692f2fc94442840aa6031159e154096e932889b8e9d569dd4d41b5e4e49add279d56638f5e7ce3c23a35fb297d05be6eb989be8a142ea1219842520ab5eb0e26a618cd184a6ead2bdaf69799b6593581c1026a30f5f9f33e2b0cae175120422a5a2fbd5b443cdaa711f676202afc2b53a4ee9b21204ce6c8f0aea13041f78e7e959ff13629a9df90b191d19bcf4413cb53dd34a01ad84fa4a5f33184216763910dca5a4239f35067a6b4b507e41e6d5b492e12c6a58524340e4247a16a835f9288c7449d9b7675076851b8bfcfca2724cef376389b6ba6730e3ec817e8f64e3819e87a15016fb03b895b71eaa7abe3bf4415ce9d4367c1098a3b3d9722505308dc059e9404a098b43fc3271bf07ff70662727e230165f916ed9d7ba5eef9c404b2c23b5d8a28ba609f313a96171cf234fb49f628d09c09550b61e7bb07e81fda314e7eddabc57d0b0dec238fbe3a5c89311334dbe747cd0418897b707836bf9df235eab74ff3d5cce138580b0b1bea41073a7d66b8cddadef7e9006f0ea32e179ebe6085b73e24816d354ad0aa93dc11da314c62d023175dc3e967d38851b0f4346adf164e393e25dc92678d2141f9525ca1538282d0f900cab537033842526143a68f7a7b9dc71901a471b840e64854ad4d4d9ae40c54111beface858b2a4a7c08dab45fea3b54cb009792cf57f121606359d0cce0dd754156aa22ed0e9a32fc6a3a3cf20b040545ee4b672d414f68e352eb2db0e76a6c7721a02d5b95f7c6ef87985d8c4cef4d620324a1a936956bd4417d5445c1ef218516f3502b06b2cf3a2412c9d88bb7455fe3dff8355bc3a149382c364d88947319873e53c13285f102ba0623feb6cd5c6106dce341ddc9ec188f44143a9f17c204762cb69ac0ba39c334c2e55840e74c6cbdf45d53a6346d8e7eaa3f8343014a18ba2ea0c9bb05e4363f65a0a3b958ea75b07e4cd2aded805030d385dd2441c8d0849edcf268f440488f69e28c5ebedf97854eb4f8481d0dc5943ed370de50316a7d21355e6383f5f5def03abc2ede44987158c01313ca8203ab91ff2c71fff570465e7764a0bdde527672385551c8733176f77d26edd214efcf1b994a31f42d0827a3b06d07c03b88fd1ee01715f5f30a5a5bc716b5748b6d965940872d5eeefcec90abe40511f1d1ea910b3ee36bb69597dab5114829b3c1e732f6204dfc89e73d2a3aebb8698a06ab1f531cf7109c599e613b515a52b86f911434e66cf16a07b3c825f566edf300528297181e1b1592f296468fa4df45551af7d140b0189f29bce573addb10c6a98b72b6d24682f11385ed55d87848853c5aea0eb93a1f36712b3dc4224811865e51998f59334efe8841eb218b55a891e4d2efecae50745947cb6d14abda6595333945c067b31626ae87f36b15458977bc4ae183a73cd64f809141f5650489ee82b138a12fb9b7839e04c4a6a4131921a270cb27bdd235a5cb88c5e0ce419179b74e932ff40fd5e38c06a93a5dab14f8a3ccdbdd20957b8369810378224f9480c927e8ba071d4255b86086610fce701811b91539f37a97a2203c295cacd65c21566b0957c99ccc4ed24b1f31ff839d5f2ac9f1f64b6335438b272731ae2d43c488bc30cdb57ab2eb90862a1301cac13f096b5c77cabc7a60cb37d53a7d8bbb164946f8a974f27139cb6ff9249df7c4535c8fd8e7bfc00995074fd33d3ba19b4ee1652090d9c28b6865b81d4687b3ebdefa84a2fba8ca975f82b102b0c8862930bd0d129684433663ea6a8e356af90ea0248b7e6e08fa46ac3a25dd7dedf7537e4007ab058ec301c565027cffa621de74a1c1d29be764f6c003e131a25340821400577e73f6e32c4a75574048b127683e6c28bf4f7530a2889f0297b0a5c4817af3cd193a8f50404e232caaf709fa932da18b9c7031c078d5bc18b197a067bef37ca9a9a1749141da6ca6ee47d9fa92972401b12a5354b07d9c0a7dd8c7f798bbbee0544e680923fc4b4f680f38a9e7b1c5733faca2af3f2a742c2fa13fa594ee41c831060eaba0008e38c836c767ad24519eb936c2bd744a9c4cdd64b34957a5e3bf4c97279c2d2a221e6c1175fc76d3e5b22e3e413aedeb48bc5cbed810a011800051c7bad7f9c202d70a4e7cc2f652d6e8781c3c4598b1257df144595eedc7721e01b571fd6b254465a78c03a6ce344f24297a22ff16513f9b192a079fedbd1164a5d168528856fc8db6a892b909912b3c63e07e095be04a6d64d95e60897e83e52ae3d6d408da328011a89707254509b626bb82b7f64b4a4b8a68c60ee0466a6f16a2b752ec9ca7a031e97b6aeee73dceb7781e4605e3c7e6a7f16384f54d20446b5bf0aa960c357f043842bae0a91b84b8dd9c691cbe84e616af848f7d95826b83805acd0a05c41a6f77742193f93cec38cbdd6c0d382866deff8344d2ed35fd1bda911d3bab7545d048d014847665e1053909daf4bab6b5f65b4634b7455597ae283ae7623cb0144ab54e78f4ab188991100198a344369b4a23467cc38ca79379201d76202b915381f13a1556346af95cdce8ceb4645aeff01be6f3d5d5eeb86ddda35c155c8e4fca4c3ed03a57a620115962a32ffe3af362a5b8c6fcbc3c2f06cebdd57f65d170f1e83ca0979f2630c22256608e672d365d5d158401500eecf9bff072c0b1798aa33a5578f4302fcf0ca4b874f0fcff9461c2e859d26d39a1a04ee99338b876b6e2c5e8cd3b32b7cf96c0e2437ed648f169e33c06deb5583ac3688ea2211e66028a7c5c7eee4f5fe9b056a51bb727e2ba048cbacbeebda1b09b84637dcbef8e3ac27f02b88478f0df42a2bd838be344dafeb50babf26a3671e3b7214efdac72b05a13cae8b9bbb41bf49a437065fba7bf15c519622f7bcc437c730edc0c8e5157644210a456baae7774617c8ed29c2c08bde2d825e51cba98c182903df967b4fb3156a7e4f1e1bb6b81947ae1e975f5ddbaa8728c635b28d8553fcdf9895945e3b2dc32e81a7578a6d92d720c3e5b018d4beb840b35b257978d07866658e5260f856891e62dacdcfeafd8e637a13d765ed4575ca3968e2af9faf34e4b16830fbfcb21d24983e23a6358799afc25c38f2aa0659fde091d7dfc9485f945ff34499a750636063d561287f1592c152e9bdba2cc32d9bfc282b9fddaae1408d3267f1316a2b08fc5d71f62e866e892bb804731e1fbca117eb4ac64358f545b48f738ab88f7f1b40c486c0c6313510b850893d634d2450a984a74bfe1388c2ebd8c136a0eb916ffd2e7e5a46b1e8ecb5fbbfcefefc639825547c33bbe87053a580a59b2e30b018873c35f5c598eceeccea2f2a692b166f47109437f259611e265a127ae5e09b9c1f3d262b538de7c44f9bc793a116704f5fc50810aa774a885f38e56c69f9e0113eb7d60d1c62a9b78b286422eb851250df1db286f1bc8cef0fdf116a06dc5c7c451065c216244c905b000a51d519d24fa5e96fb37218f3d25a19fdc871d4cf560f2968051a91d28d19dae6d88a1cc94684dad0ab3f53d2300edc36390c4290ddaada142b3ffb151f3f15da05177aaa7ada72dcada51849ae277a8a358fc999fe1ecf9ab52ee40182869c551c453462675387e6a212aaa7be70e814f0a5ca15cf6524431a9313d55588918f329992486719d0f3670c42f442ac6d82a412d36ba10187703d3db1af2bcacf0649f6a500279bec26579bc7cc3ca11cf694c51f81e6ff1d59bdc33d5047585f1548482dbccb97b0382d91e716d073718634355bf8e1a75fd18be2c731c306ac36381fd26de2abf1b7c59d431b443cdde7680376ced6e372e1f9f5160e509e3f2afc58e3f3b77d89739867f30bab058e27ae0c9fd6aca7b370dee732e58ab997b72a29932aaf3dcbe4455cf50082aafa48f939cc6640aa7c0bf7028120026185b1511ebb5e3de6c2f44c3ae652c5df3e792c41bba2852f321a0ee0727770340effd1d34dfc3d23cf1dd2604e63331dccd0c1f7f7cefef7e03bed5e318e6055db7d400eef6d88c19ad1dfff261c50139dd8a116554768740d03b6b84770a074ff3eb73daadefd054fb873c7f6e3c6a14a31683a9e2b72b646f9e5bf478a4a2a2a0a962f79b9328ba40330978b83cd282cd83330cdd26dbf8bb1c13c5c0d52dafc52c128bd95a445f9d384dd2af60145fe5751ac715995eb9eecae79243dbfe686e862d3c39bea7d95eb364fa466c547116c6257a4a0484150373e88e093cb4b501f0b8d75805bc0cf491095421ffaded6572dc4508c9054b573f0dd87785c6490b197800a427aff0b53be9fa31aff29ae360ae1728c04803f9f0f8d6c84bc898dd7eac0c26d243613a3313e1da3110ea86610d5671175ffee5e1c532fb38cff1f2e30ea356553a2286feaf8a803e5b8c466b7ae42fed7d46b1e68ff94b40ecf32f59e4d62da9fa58b647e4f82aa2f091982bcf7e5c77ad94842cb9edcf8011cb119c27fcc06ad9ed234be48d84f35f2c951c62568de1b60c727f9de9e40b4890a35cdb3c0f5dc3cf6aded018958177dc14aacf2fdb07c8b3dc9884f2be0437e3eecd0cdf8f2d69b017044a876ef78edd6379b535dfd603f872e4b3b6172744c01aaa069672bc7b5a70de46395ae61f8e929aade621e0c2278baf1c868ca4049f658e4e20d5d263ba225335b7d25615288bc8d9bdd9b82e1666b93f5eeebc6688530188ef6520f04007ed77549dd4960c43778a1276e9b10f78d5d12704084094131c40cff7bce9f7abc058052e9e5c9f4dff7a3d54a74a16512557e95ff9b1c11ef7e9ab5526571a92bbd4b8f438d2cb5947f89818fc5c456a07dd3a7befd803377a6ffa972f1f36157e68ae6936a8d899022e0cfde29baa5bca40c5948e817d862e52ff85004e9646b585111b9d64a41616da4803d2efc253acc2ca6ab6527252450a91b7504fa28f7594489d4845b6aa464ef8e401f13ffe21d67b01ea7ec15fc44372dbc41224fd617d5f1f97e201b040329567c4e5135eab48ddb7675994650b9528e8f65e061e64084a78a5d66532ca226b9caad89f451ece136f75d980f19d7c3a2392dfc67e07016f1123639eb2cab72be59e4d419e813731dfccf11d0b71ba49671331dff7cc62c03a41baf9c9bbd23e63ece65b5a88fa2b73531ef4c8083bce2388752bce4a41e10d5e6b54fc706e3aa63e0d6e6e98282d1473da9f36c3d4d139979efde09338e43d3659c126cebdd3b08c083673180e802b70ee21482f32286c9f8343ab3a7097d6317d7fc1c1d82871ffc353c4a3b374496526d6694515c6ad8f88a709a6f17aa1da4fd5a2406e992f9eb0924602e111b1d5c029621e9df85d6bf36f43f39182f814040d3b39755e0c48d60f597c9657b7dcdfc810f26a37160afcaae8922110a7fc94267d3baccfe7ea15dbde014ca90e927b23eb4839b003e56d33ea88145a6a722237596e1794077db2f1b986674162e331c79cb70878b60d89e8e88ebad13a3939af9b1188d8a5670415028007f942ff2bb1e9954bbc44966dde321057367388dcdb4dcd73319fcbe52c594c827b0b5637ab8582e78142e776dc8263952b40e9cd7d069a85a6a518ce1d45b16d645aee318399346c9f62ee1a80d7e1c2764a27ede8a9b3aa757fdc8d7bbb5b24f642a4206c9c28af275167e61100ded8797524192d4ac102f059cf2c617cafd2c61471cc92ad36d39407e8055ae37158a634824b7d5d35e267f535b7406b32bd8d3c0f45988908bec92631da8ae2191279df7391a64e2e2244030d72a08fb81ad637616814285bf835e5b1982e490ee5cd13a488d85b72063f0554fb7a3aded41607738128453ad75a94374240d0a5bb5169d31ac95ad7be47a00cf6b3fddc10ec64c95175a3227d1abe1134dadd88b240e42b230de929037af3e7cb6c2f3f9074edf6e3ca74522c6460b75b2240b0b37cc50d06714f70da18958df3cfd24bf744ba02f76c12da1491a03d0fe7303fd4aa219822cec04e2cf57cbed19eced01ef766a2184c02780671e6946d503646c6991123d8e11f2eaf10207b9afcc1b47584232b8cf7192e3de54a958442988f0e141e969ca6daafcb6206b3a2286c1ac65ad779f45fd7986faf77862ca6db174316c5cd829235b3c9497b94752d102334edae806f9f2a7d91a8fcf21d8aca33bab416b8ca0ca9a3dd88593d0f0015569fd1aaacceca2d2df4e8a9d21f64433600ac26b7453e915861419c6063c0236fb78fed885e7e965ce00a78ca411c4d9b966f383fdf870e8e3899313d3e44ff85a06dc9d539c18c45eb8e4fd561c88460309ab80decd2d1bcacdf27833aea5d726a3a9660df874ffd88ef85a24cf48e87920a050a7c5edea1af3159df1fdc4179ffcdf55df0b4ebcc4510622d8ff265ce90bdc13fae44158b07fe584a9329aec8e4148b51ca1eb70e054b0c543d0e535a95628e02cfcf27f1476b1d833b822d866f99c23f3022fd6084e5bb1406c16f30387d47780edf1b0125964c363e1d48713c4b47f7e1106d0b1e01e5d5290b16dcbe39f7eb157e669f224f0a867e76bbdaf920a0d97c1d1e0ba6e074b91c73ea1648c2169e7e0b6af44dbf99f6f3e941807545e906ac5d7c01ef3a1837d0e628686e9a5b9d9641ebd94000eb72f790385828c27fb80d380a506e31a5d8d2b84920e83b1fb515ebab00e44f564f61989131ffa235763fe8159bdfec13272712428587f03f9cebac14e337fb70597fc0ac03803229b77d6ea5e41c9f442eea8b9bf846e6e89308c90bbd825d43d38bf9190583f26509e2332ce82c183a755043332c59d876f5f5e28f05ffa8a3c745fefcd5ed85343051115ed75d1ce168555fd769bc2d01f526f42f6c5de03d4d21cbc2df977d8b3309f5e3efec4a70bc6a8bfc74e95dab82f25ce3fefc1a8a7390190a2e3ab11a3f127ac2b513a6349aacbb718b30f9797f2d61285515733950e77daafef28357a92dee375a023a92b542f0a16715f0a51cf8e668618c85cb58bf000176d983020981d4b1fe00600535c4c38d2f2e95a8cbf0c29945e7f2ceb3b21b411797e5187c3c1b350540ddff19bb561ea96bab5050703c19e8d3a1f3c4991c6d2932fb383f61a44fbc1a386d2a9692531eb3cb24fbc2ed21ba0e1bb3f9360f09d3f41547cbf922ba1270b548c996615d177854c21af35e0921961a4f0edcd637fd5a7832765c5538213505f7c4e88c460014d916fcafa2eda38be484f3953f747213481c2425d96c6da063740bace8306e22078c53ae6e6431c102f0274caf90efd152d8d214f206c127e78bd650619fcdf3f99c4d4bda22d3bf079e33f33de510cb0c2ce797cc24cfaaaf3378b11563e1504592e08faed37ae8d67355a5119117fd74b31fe0e917d1697b18f5f9f096577eb264db7b2e0965bd502d61cc2fbdc5875d14e9cf2ea8cdad500bd702f2177b0b60969c9d178a871b8bcee848a4910500d33673c6f75759ee0788153e4f3ffd52f2b5a720796db49e4fd5d828c93a98e15b630bf77151802f445118b6561f9434e0e65f6f638a45ddf7344e0d990e72f2dc6ce0c87c7506b64acffd3ad86b646674c4150ab6af2ef4d7af985ef8f18c7d72fadea900d01c427dedc2ffde40eadfdc041468dfa7a7f11ac3a317079f46c904240da568a6dc06d19e28de53e1454bf51baed8f1e1c094c49e8144855fd232f5a85679d93fff891a7c57e739c5405a72da87e27efd06ec89fb69ed8bb85f2e92c170bf6362ff62ec2ee51631e6b39cd3d1c9ad8b5d2dec1e32ace951bada60b45242f489c98bbe7288cfcfa2ec14cb63a57604f0edcfc19762e1b2b3842284073cbbe2407d9fd4672ccc4d8de58a8865c510b8168555463cffc1065bb1a09f71bd5d017c03b63c90f2ed57ee11d9d10fea2cb5d9f076d55a90e4beea012b36ac5b4ccf3f81d4c3515d014a44f80d0d03779380baa984b59327024eeb5f80c13beec56091046daa182cdc8da9162e46ab775a4302dac226986ca5ffb500ae60523bd0e83e1ee8888d523d33b9ee9d0e7a27aaf5f212d9e8f44e9223d150a832cfd5e865a5d30afb5f0ddebff13fa1a547621421121a891e6fcd866259c71c136a7138f6680a077de93e1684a3b50b565407290a770d6d5c52284815a26abeb2930a4bf9c571a0bb34fbb1566a95d3daaf858fda4061476e37655676975ef71a839011e76585ee121f0641add8f07371ca748df29a376b00ebd4f32f40c22bcaa0491467c30c802f6ffee8ce8a2fcaa4aafcba7f2308e7469e3a468abe25b7036a2e8e438f02ab85516886c112c65b2d7da5f96b83bf1cccf11446d6b03c1121b6ab697b888b6d6f7074ee7839fc832bcb5a102432e64b7c2154a83474b3eb36159a0223f55a8a5b6444075e954147c5bd132199919eb0730993e82f321b36bfbf99810bdb781ed2fa55fb4b115502eeee26251e9de7a1ce1d9a3424f3dc03e5a2623a34e0e728cd2d522015e24ab74dc77da705213a9e27a714ee99de22a9e7a0158f44ae0f34d6952355e21b84f31ec3cb58e181c1b86c1b3d9cefbb2dcecad19bb990a0a8e67e0a59afb99228554edd1e0f15d7052a15b5ac1c0f6541be0dd1b6b0f92d3f5b7dfc4bdfe21983684040bc8642687b4cc0945653ef7330675135b987af70186396352fc0ca2757b234f982a69079900ef5848fa1a9bb71e15f24224961ba59a01918e23ad92fef154c4556d0391c8ddc3f8688f7ecf739c6a0645262225fa6b9d3356306d1994322413faa62b62102279fa162c5724da2a7750075b31dbaa0856fde4dfa15808681fb0956886e0f2d71fc2e4a8e40d0b40ebbfcac8452a4da774bfb047d51bd5a9b7c7c4b1a0be57c2a414f4eb810880097c16b8c1b648dc44d2bbf8ee78363176128e1fd6187e03442192a176c0b35d2b46f0826d3583e5f43e98cd6554d8eea5074535f7f936830f3b263b3086bc1db1ad2dbbc9cb34848599432c7a03f8d8a783b6fbb2af583934409ac7041db1fc1bb4b80e3d79ccc0e16d772f6159a5daef8fc43acf89a76b16425f0405f4163747eb51552363af02e4e5c23243ac0f56e5a8d0139f21b7616d597041b7bc2cba0099442cd2d80d2ea155b72f0cdf69466789cf99ddcfb0c66146c650b5bc71c2a1ef494673f4b2dfc38301ce9e1e0c946580e9ca775a538e7960a2d852a88d39ef1af7c05b8a413db715daff97478167bd09252325dc8b6eb8deea45e6ba7155a446657b1449d4e0c443dc48a2de9a09ba4a14fdda6aa2ea82e73a4002847a8938f6a07321d4a335e0b7daad019ebee9a1f7d46c149c48bbbf83a9e877c3e75a1c9019e4347e96948f20ecb06db4f1890d803b66abca72d0bbd15cc2533089edc4f0747f16538112a10eb8a2dee47440a9a18575a10a15e881c88322ddfe0c4465dd5a312e971b6dc2df759b7ba69b78c79cf0dad61048c9ed4a30bd18297aefaf845332fb27053578e24f2c3469c140c1d215bb0bb606766c80cdd973829c9ce3ed380e64d2441caae9d3039f8662a4442e425ae0dcef031e657cae5eb294b525856f7d697fae09ac6e5e1d5b11d428cc22f864d55878954c04eaf84f5c444d092b875254646adbd7f24ef4b2c93a8d514f05e1c86e5ce6fb2a5149b32bb9e0a97ff32aba5ccde1e203bd2cdfe7df58b2abb9f9ce64309f53c1f76e47c667e7a6581953b3a6daebad8816cf910ea8b69510e5a9fb82189fe02c4767ea66e03f9bbe0bf5a6b86769d121cbc5d9c8bcefe8bcc74d7434b1d9daf0628ff3b37eaa02741c5e4c5d75d70a5b038c8b0888ed29d81b718cf20db43775ca8e43ec454aa30aa92b374f0560db652e1a40e92506b4e15dae1f9e1b79a1773765decd184592f890b4056eef76dde6cd7c37fb7b16e3aeb887b7a0c890b726634ed280484d78285ed4f1962da5d5d0c9947733efc0daa59842357516f981c2c0debc9467e1596051affdc347784d11a5f383d4a07889574889de1263c506fd3ea32abefcf183f0a021d4fc66f57c1f538e48d4c9f28044938b88e8a196087d8156ef32d3058511dcc3d2c5c9e02d5b0e75da770e333227e0f208a3e14db996962b35793bc0eaaf170f404641dc3e82969835481f4f7a8038f5b5065607bc9e27c333e4921a9f45979a5b7b992152796d3abd903a74893879b9f3de76742a184bbc52c6ff77655cf6d5c66f80563685dcd1bfde8217519fab26bb82bec954e8b6d6ca56e1a1108a8f894796ca847c18572d5c1460b7e29166d7ab8dd99b6b09bf9dc59cace5fc6be4864011fe2feb6425a41b4d1de3b52cb33d9d3da43fe4653b37e1f3ea6e6286a42f17b94973f5e0121e114c71648c0780923227b41f956d11b1b1334cee5bd64fecb4db162b93d49985223b670b7862e82ed7636797850a0cd1281a2e7c255f3b9311b92042404df35dd36ad6a566c7dda3dc4dc1200bb69d4f8289a47215e46c7ebdfa7d2175f9d37540ddb0db6ca0d065700350e1a85ba0c39581b278166f84d1b9532272c634cec3d0f91025ea9d0830d2bf4a51cd1b5bf584bcea9380d7ee7a37d18fbf2495b5f8a3769f7972aaf9659ba8d6a15e61132d2351762997552d3e3b4d0f62d37a8ce23c226e894d5cb1f3177db05d02675f67e00fd98cf537dc07be11a1039b786ec16389a52a0cb8961764ac929ad9ffb58ed5240fb8b6389e1a4991533d36cb23b3c0cf52ddef650b924fd83351977ef4b25d6c8c4e02e33eb81130dce486c564afe7738603618e856db48423c57e9ac6ff07223aa908e904b8d64f800f610910747a2b97250f67e2021e41e4c7f637b507a23c23d7c2fb132d47d5b644d5d88a747bb21c7566c1f653699620bddb2cdccca463370df47bb202503660153cf67aab1a3571db918e74d79af105c482e7c8a244ca95f311a1557df180885273aab76e4e8d90f07c6d13cec8eca6423ad9c2a2b351773bf50f26c9c0b1284cd3d78c17f33fc894db95c689754bb8ef814d72cebd7d8287a261fea232c94cdd6cbf9a5ffec46b53eb71a1a6a98cdb2004ad15e07bcaa74ba1926a784581f9d762d6d92ac9279e8ef8980e2ebc09e006c044125088ec391a0ae34a89bdd99c43b2bc43c0342f2564ae025a8e5c02a08a92b0267493596551f612b248a2da0cff67bd590b711233a51c356c5971704bcf5dce7c48c46c398f78cb1e2a45111d3cc73aa3b72a25437db9d7c332fa2bfd6ea889ca63211a23d2aba72e3333806794ba8edffddca63dfbbcda5ee11e9d946797c0f784792b3cc7077fa6969101afa9842bbb2a97da75e55ea351a1aebcf012d41cbb2206bc081f81c96c3cf0b8eddc3c81809befc3915d80aafb684ab0a341ba840840bf5c1f2f2836b2305adcfa6c0b11267b66e4328c938331cd67fada79bddd05f0cf9ccf4f3e0eab308fe27d0156d64c6c2edfef597492f6ac0b01af9f5a99f8da4088ca5298bd0a191ebdcf2fcc937206fc0ad47866cac7e72bd23baa7aa8a64cad9291a989a0dfd7dbcdca495e343e8f3f73960650e44aec3cdac48a00dd6d7421ef4adc1a534ac4f0123d09d190d9fd3cc3f2aa8d5995969267cb452c4e5b7f2d8ebc5daa1e4b720d50628b0c1e46a0e1ac13581e678a3f7091794926bb24a455d9c444a9ed5425ce50f42a6a43ab8eaf04b94a9211d647c1c5c02ea3cc7a0fa62c7834f95cc6e77c3364c2d8b450ccfe3397d079faec6efaf35b40289c5a21430feb38276cef17a84cf18effec6bd506f5e9bc9a2450e33b84fd65cdd71a79fa657fcb7347795d4638c0869b8e0f22ba40a2a45533f92924036af7a65ebb43c550b8a68641d1719b41760876c07f77bcac3b9ab91ced60218af7d6a6165af05bdbbf32279fa9e52ad2824f8b75a8c3b2b9c23235f004567b4c95b40ef241fc88bf412740d931fb43a82729412ebecb18044ee7ef87cec46131417a5a7274af6e1e10be99f40a536d3e785c15d9cfe67dd0bf497edc2dff286c828e27ca91dfcbdb6d890f94469c2509b6d3622e7d85c17e55cbf470527f7f7371cf46596cda71b9c89002043be95ee174c1ac1b84713a6c94c6e88b7402cefec699d8d8d0650323fd8619b216f4ee33f1d6e2f9c40c0bac60b5ea546c87362e16ad71d48cd4ec939d8a987bec4dcc5562b2034cf6c1b70b65fb370b5b9f3cb56e3ef57a1edf9f764452ad9657e06858c499ac4eb719147ad954df5be7427810435c401b6f278c49044117ec4962a87c58b2eb13b190786827c6f36e6c39ecbbba26fe2ae877164110160530271bf8d630d347f043e915f345dc7d3ae2c2e330a7052a2c1bb81c05c5da30a8d91b6aa723bf047d750809f09bb24314d89fd04c96d20679f400442aa7f041816c973884487352d005987eb3f77ad496e834bbb5dd0358de41735f7f44d383b9fea6fd57abdf902d8b57eb03fa1f792f85d9bfc97e1040319c0f9d7937e54e7f092a022bd0993013064cf33eca60f1abf6dc390a473d22c00ec4155d84e7735da6dd7f4e3a3095f36446d93c7e988f0df6f0e8261b9947f56aa578dc764957aca0297315e6cea16d37d975334d99753654a4b160e8834c1a85417b2519a04e3510525a26cc1d9a1717bd0c3244b42be7c4711d223e7bc8117407ba67db5ba0113d750a7faa7d54c67f9d044c2d312b122f330c7f24c49eefc032b789497c2e5468115f9002eada4d671c7df4a9697d8ff481970a6aaa38257483f257388ab2c2adf95e0a966b844d769f1708e47b27f4b61b32b5d78b6e3a156b079d21a0b66d68d1fc62ae0f2661fecd6d1b44ad9005780d1126923e53eefef448190b17987efafcb893d8f56eec9cf811b3a76d2b87e76b13576831935efdfa769a05c737f65f1095e86128ee25555fa7a8be9a30916851c","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"a04e2aebb4f065114c065b7fbf49759e"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
