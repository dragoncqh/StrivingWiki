<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"4ca101775dd30d3c7d106aa89c6b8b31e8cd12be4655e273993936ab1dc86384b8338a6290e363dbdc4008de3779dea1aa7482cd73ec84dd2b76273a13a10a99eb93f1755c974f5c4751978e9c5e35214d96211a36b0ffce49988025c454ad90e9436e4a3c38df380edd3ad8fc04821d1c2a98563147ff6ac8dc2a4e27943584c3decc4c06ee1f586e4bb5555609b2670ec8cd149136485d2b458cc3cf1775d6b06db63062b468c5598f3be300c45c95dc4a8617b1cfd405fd0967273306e438dacb9e9d91d7831810d6e0481e6eaee05f7842bd71ac45525e5af6a98760dbf07b6d0a6c97b3b2ba2e10853cfef0b8cf9cedbce5ae49260ada53fb015cb68980d41456dc2469a4624d8a9a96f6551678c1d16c7a825e3c20766acc1b1e1ba27ba795c57b1b98a05371718e4ab69c60cb0baf1bd9915544617c0062f78453da53e100545a2f99f0b02c978f4e2da9fb51d0d7546be3c2bf56eced9494a322ad5c305000f824b8efca3a5360116ccaff8f6175feef2ecda71763ddfe4870244f10dc35ec82faab6f4cff6e79ab69c64ef6e5d9738231632b9045a91cb4920f45e52eec666623b0e31417536b23d1d765484e32f520eaf42af8adfb42b85126d100d955c3f282ae0cb49c734d1f94fbf11b8bd0a5e89b642234d61bc943b283f8c3d88af28950a14557ce5175b8331519bad6563dfb64778ac322728913d615967b55a6919161bab2e7ffdc22f124a5e22fb4804d822e1ebb5ed7f2812f5961bbcced9eebc083f7d115bc050276376c701e01b2cd5af4a471eaf48b5638e095c1f2850a7c510b80eac50896a25c1723572e2b68997e5af6fc1936c22a2ff53f480b7e183d2a9672aebc8626e104db088d47bc81d301bc063eec2e83907e9a722de4efc2a66a55e9deaa824675321bdb45bb479023aa0686c375af0f929cd7980844fe1eace448e9f67f26e2f2631dd70de7404f875f72f133808c07a8deb68d2808da18735f2f12699e8355af4db593fcc58d86bd7956d3e947156d3ad72d96ed317336bff9d02b67ac34b052dbf4b803577c147438c2aa955dc253833b53e43eb18027be80033dd7957269160a38d1618e664da562a83d1035d89905d2d842e47386fb0094e897e04e76dd07bda6e08d0c4ae5ad869c3b18f57689c0638ae6d621367a05b30365eab2a27af2a6a324ab500867c9d115072ca1162f7c8952e52114516d9183045a3077d0a3b88bbc1b8c85c231c342b376cc5d4e160526cfb2fbef952f67f46779a8ddcd7086464eb4cf179d68167fc0ad684cb568c29f7ade70c58bf85571515046449e519edf6100b12fe431efd7113c80672505d3f36a6028b5b639270c283443fbaf060dc4f6b7442c211b79fac8f77bce42142d4a5c7af50ad6cfb946979408f5a11c3c466c36dc62c152d70a0f72f2d2afb7a362696fdb5134b43608fb0608c2c9d4a0754fd5d234467478b64d9e5a801431581e2ef34b8c9b34ccec1d2647e2c91bb0e7083318c0abcc52ff1ee3c3d2a055272d49a9833286ac93773886c83036a09a9d292ab9ae76e137177d2b14960b57e4b129414047988d70fa2758d20ebc309d7a92a46104723a2c74a34d66f460a3c41db0e95932da43f5d2382c2605d8d8d67cf48f2823c17988fee3beae7b1285e8c45e91a2bd57f41fb5850725133612a037b4566cdc6eff27df25f744e1a086c716554e5dbc0d516d209d011792bd4d3a7f53145be26539b94a1e8924b6d8a14471a7ad97fad9de6f88b91b1ff7f8e686ee71b87476e9b618fb85ac29b58407467086c684ecba4a21d486e8a592cc18b37396acbbe9fa778448e140f79e6bdac2cddd90fc963b846e9fbd0f0aa51a431d1a276f809be1dc86d7d02666fc47d869f5bf402ce134c88db9242ac0105a0f6a02881a255aceda434d537bfe2fe9d80c6e6ac4272d8fa3503da2f452f59ce2bd9d528b065aa6369f55203bc2cc9cf36825880172c865da151525681f3daed7c6f6a09b4fa48e9d4b91dc0c25dc071b53e402db6532ac83103b6fa19aadec56ed46686f597222c6a7ed5d776840feddfe93aec2677889d0a9fc15037b233fb173b9749e050c540ee1cd3ce7b7d7650ddd6e930b12ecfc9d7470eb87d7f732df3f3f10390a893d5cdec50be912f61a94af42e618407e1a9b801f42aa15989823981f4389b1bd5a2e0f030d091255e5852075b82fb63ac675a0234c4a01335e64269d4aaa6b29eed4698528c2996e036405addfb9a25ce44445e616c3f48421576c517b5f94d429d3b45b142f98f051ca3a2efda98c16f9a7a4214216b5ce34bfda6993a7d13dc2ca3c9c754e4debec67aa7fd78161b2382d33097a2e75583e45bd9f4abcfa4e335714c4c9f182d8a3ea8db36717255cc23fef977108bd1940069ba6ab547b3e4f81b5107a1bfcd53442628230012ddf460fce353bc4dc538a4685d6ed7a7d759d128e213eb379224db7c3d41847d3e254969dbea2f2fd5ab6870d66aa1dcd82e916101b37bd6347ac057362735acd2970a3a61d0c42cbd603a650346e0a0ca4ce74942f20ddde97747325f9e9a8ebc6765fcbb236ac733523038643008158f7c5be400c232b5635928ae855e27516e5ee2dc7f765b9ef702d52fe08f3b69a377cf52f2fb6dd011be42253e5c6412911416053cfc50deffa688279541bd565590e6dbb5a2e04606f4eb3ff94c56fad77fc2b3b8c8c9903ca35235ad8fbb99e0b47d905d4a4406e2bc3850635e60fa52123d8e9aba6b06910b2cf288937f9f5a25c6fa77ba45447fe183b4683cc17f254e11dbc6918fa11aa8007290f1bb7efe1d8722806163f5d62578e88bd75c4de7c0e6dd30ea423e566be881f5afc524f9ccacc2cae09d99f48409901901a6106c2c5b87576a335cb7affb2d127502824eb6d7ebbda23233571cc6cde47c73b9eaf92315bedeebcd6eeff3197ef06dc055d8ca38917bc6bd5f4804df53215d3c17fb28d886c2f1d2cc502ea63ac81a488dd8ff6fdc3c776e6a4dfdfce2c4b333dcb6b54e5a454cf4885c4e456a5de1be98de0bada9e298c634246261bd9206b7675009f232097d7bb670e7a8ac223edee3679b356c8d886e0ff7c9720f437e21da6d36b735f26a095eba2adaada85aaf388e15fc2823a9e2746aedbf1d4a81408d01852dc7116af71f82fd76edc3cda7c8d04ac59c8d88fe2d98fd1fdde2e81d28ad015eba7bcc000f6d4205d6edbe22b3fd4a43910e59b6b49e67593c84fca838def6f3c8b649e9bcc5d3b31cacd3e63f3fd3b0dad0c3a8ec2a1427e586f19d7d1850f1726d885f9c3de40bee7a53850dd61e23501c0fecc119986f5d1b569d4cb2f31ef937904c8c08688ebd7c9d9ac7cb9d7ebfe9ce943052cde2f174dffa1900ef1f345c44446c62047a00fb907b626bb332eaa5c00f54c8467a8466cf6cf9710179cded2ec8cce2180b8914db7ea3b42af610f9c9e58dc602419396f151e4aa029af87c1952d0b9989b30e435b8d1124d53b89d984ec4008dec0dcf3e185d222d92a73e22c13cbe19da4865500c538204854cd77bd7f5c53a9625158567800f7a9e035706ec0024dcf10a504fd42a9f9eca94aaadd90ad59c31a1818a6f44914b1cd31fb4762eb0db801fb1101c7854255c0d6a75b949190933ff799e84200cc94aec81726f0f30eab83c204185019a55b0b83f82100bf30ce1be45039d56a59765547a45d48b4d2e3b1fa0bd11c0483a6c2495ea629bb10802b854dae9f584eaadaa94973534723c230a3edab0b719ac6f77b0a8f855c5962dbfdf9ca11a24339183903fb55c8582b24b81dea9a8cf21909472b98d05ae0e1e7ad1078486088eb5ad735a663ef25a3445e344d97a551cfc15c452cd47ae5b2e0e3cf0c87c6b2e57062a17a7d90b576fd84ed98c11b92a0c02c088486dd17583a8f530e9f1d58a479adb0763fbabce54f1674ae72d04ca00a082ac5f58c0fbdecea557b687c5cbe8f1e0a5042be11879e4c09eb0f3b09e067688cdb7539ecd06cc79c1abc30f131064fdb8a122845e0eb32c3b990b15bf24fc987e2401eff87794cfe57622a352da0cd17228db28cab699e8a814500025761c911de8dd768172d09e4976285a5d901d9c21618765dd5dea49c2954772768228a4da48818b9d1a21f104cfd8893d0ed181e6a7991d5de12b7f98cb715af6c07af5dd826ec21813779e56011862aab7fba9add396b01c9f668957e3e705d799e6455e6f74d7c57ea68df232c0356b05c5cbb9e0c2bc4415029e2df4bf8cd0dc01b743ee86afa48518e1328695e60898f045419b8446786d825c5226329cf60e30009f915c6c12069e2429ac07351dd31e0d8b010f89c892e65e87ba3b9e05ad5f3fa4906ae965f3baaf937e0d0d5bd6273a45fcdcb035c0425714a87dd197fc8affa29876812540660c911e1f09e780579d01df08ce1b965a4935878277050f3e8515588d738cf9b064cc0d7e0acf855b86e652fd10a3b1e88dc2661f221a1ad7bbeefc9118190a685fd5a302c30510173f08cf84dc24e2925a4ff41f86b26edb2adfd16af0deafdc15c2457b1317220cd3ebc2c7ffd87af8bdfc1fa2c5dfc1601704c0e34af92e8cb711bb41b544356a6f92e0ed09c2314c1fe39a825f61263811ff04f8a556702cab97cfded1d45a14011b986417425656c650ca063d8b4dd3296c4dbe43030aea1fff86c53e5ff2b2d4686984e2e7056d017deba9e68cd210ccf08cb744dec698f90c89466625439b441a4421cace34ea83ede98c220d33859929972ba3c3ae49c485cd9bbb40a5b2edd5ab41dd8913bcfe25eb00e118d1a58a667105f1bb6c77b8d01fbb10b874828ec0c528953283192712a4e4071ac43a19118c30b6650a693aea5a11796aa73e5124cfed47725c39c5f7bb918c629a043bc253a890bd71139b96abfe0ea52c4e6c5e03f3c4b6de4e3bb807fb529bf64b9a9e56c98b6755359e32b87ade767254bd1e5b51069c03210d84f4d379091aff85d0f4b3bb504b4e59745621ab983b9da66d1f24d1e716c3e0bf4089e3efdde874f2eace6001e023e656660ad7a567a8cc7a821fd83312b85f1e5300bf06df159f13ee0f5ceeb7436eff97ba64a53731ec1cbe080152fdd856ea3af517a52e6794b059300c5ec3c051b68ef3996e1d18d79605a5df8d42b20304c8f97953fee3a1937f5436071e88d72886aef7dd8e8dde09f18015d094d256535bb2d4bd2cdacf196e1e5e833a8d1268d2f81bd8d08dac6cd93e6e4a3899a1084b21f25d86294143fcb1c8e56032780c239983efdffb024a0b5982294efd829cbd7020121dbaec315b6e520cbaf70d1e468a1ecb6bdb8bbfb26d7691bbbb856841d34d32820bdc4ec507a75cbca5cba2a2d5e1062d6c700bb2390822d72f62ec7e2256be9b4298495be7519080d10d846baef8bb121bbcf29f771a1936bc79d30698402292290ce6a36926c663a9c5f71a58d491069da314582e7d748528ae96e09eaa45e9df63b9e1f7829564bbae96b55a645d9047d15f46296e16e322da9d43b16dffda42dcd1ee5e83eace2bf0345aa8cd8501169ae09910d2fbe98e465dd7e15f439fb785a2b3b0b14273c6a05a455990f84eeeff8d7d31f2860f34e30d4e98734f53bd515f2eddd8eeafdd90bb6ef712e5d59277e51297df977935b34144fe16890709c19e744bd96876b33049c5cd5d12b4e6b447459f451042f060b7eef79d3dc45408eeda0b550357aa43ef7e107e302e29dcdbed7436ff684e10ff54759b176120cddc4d2ea23d047cbf098e742552f075373c23a880a9abbcc8b952e135201aa46f0c64d9a5d79c0323534755fa77067b6b5fc09c7a01a414e045858aed07e3d889ebb4eebd150a3ee767d4c4c555b1ef8d9abc5c338d5529e06c62d395adf62102a0b18570ba468f005f6ee8968603d602f20347cb7f41757641e6fa846af3eee0ca4023198e237a09e268e6ec0ea70895448fbc7a5660924e85e291148f07637676a778a7adeed63959003eb10eebb4fb1903083d273da4581d3316e33c3e575e4f7dff990f50d9baa3b8e569b75f495c617d7cce4662b88530cc644beccadf04665496d869c73de61b7861b58e6490e3895ac66e63f2a5812af131ac07cfa46ba7be34b54e05378c61b66ca9f903c2c0e29fc3bf8ebd6b4c1b6ffe2c3181fa710a7b07da30a02bc12299d69c84d67a6771fd9010884d3f86488228ea05779c91310fc91cc134995558e62bb988dd4731ed08893791c7da22f878b17a0a80020e5c9d110150d19cf27bf12098ceaad1063fb58b6ae1f4d60e96a3079064ba49f2cdb15bcab52e1dd597d9870edff71887e5b41e668cb9d8651a5534267a33534e8c7989a807321681ba62b5187954cb031a522c3ec02908c3c7cbbf77062d2c2b25c026f33f1eb04e4d2931dc88ba7e447cda990758eaf2000a9ffb7f8ec59817d07742d4915513a4ff8b622612a90f5a4a75e2210af2bed013fa423876aed51da564053520e28dbb6eb1bd1e814c82b1440853ec3b4ff5df6e05d06d08b092ebf1c6765375adccaf0f1779cca0b7236e9dfcf511cc7261c795a074909377c3209ead03129326a2ec141de2e3512e63b61dfd9dc55f395057d69b25d3724144e900f8650ee71d18bec48d78cc3da61680ebfaab9f71586019d7d95963ce5d794c5e2c7847588054c1cef6a9467e6df6e333e92b303ab254cadbc5a97589f6cf24e4e69311a19c9e2bab76d05eaa688b8c71affd088c63448c4329c2993821d953531975b2ebbe87fa353a7057d64b971f885b9b20d5ed7a843714060b26a2a0f02ea112a69a7a176ab76f60172404a2d58e3db9fef3ad6288b2a042195f5df36e6d201efd18742a0d6c50d6aaa89514c9e18475d48c8858f74d36d2d9ee09e8575c75cdd2fcff07cd60431e22d67973236b3d6589b3d464cdf3297788be91d354035ce36218602865f2b63f394437b534631e8ac7bd3ca6a6d56120097873087a7cb7b54b87c41a4b9f1f5db9282a38d5fca050ce20a6e3b1f0df06cf25ce0bec5dda79504c8998ed290e23b7ed9c347e46ee672fbd916b2f3be013a1413947383f41eb98a2829958043065d714e6060a2a4c4a1f6c98ffe847fd4933fb968a53806bd31a38bf318a34d30343d67b90ef87c3767445a05994f91c9f6616ca6c696957a6d293679c4ea201c543bd6f352704d1c676045922288f249b444a841775bab2bdcba64f731ff67d536fee8479c0b3fc5663c65276da418cb805c3eaeb216f5061946e7701f840030735923da58f73f86a4cc5b34bb0cbce73e370cfdb64c94407d8b937baed34e4ea77e56cdbc554e2ad0e8605b83a9248a906aa4f57677489cc477f5c19c03bc0cba8d7b48eddc34304a2a7801e7485aac002410a7354e26d50256b3b6c65322d8f444268b4938f6baabbe21616fd163e714339ccfc9102ea8d5b916e37e2362f2cde883975676e573aa086dd33f8fa5fec84eeaf883e64d4b5dfb8be52730a6b76659f76ce4515aa6964b594e2110d3903d5c1553be5407e9e21369c572844b428398a59611538cddfc1097aa447cd2c9431ae07d34219587b167333ee1124ef6cd1ba860069454d310896a0291f2c1273b3b47058f47ba2382d15cd61d0e122fd9408602def97d4febfcb668b8893cd099af4e2820a5e64d66deed96bbf03c4ab8697acd39be9e0c6681208463918b72fff66809694c6160d2110840c2fb147b205fe1400a8643bc72d3211a92d27a80c6d6664ebd0da1b2c818a35bfc5fdac9c73f147f7b1f9503099bb2d2e43e744e825eea184d69c1dbcaaddd7e22fb9147eaef08b88e3ed35a3065a0bee60895b0e9493cc9157fe3aaa4d54de2f594c15617c501f3860b0e2df5c0586899e1474140ff72951b0ed1ec63122e21d0f0130f0e04e24d82a65325b8c453f6f3559c7787ac1b8c72300ed01f380cf5158e3d87eb98e8e1987e09d03cb5e53f6353229dcb971917b714f30cff4cc1af7438b195972adb95a061a31ae296870c38cb48380a1f5d007d822109e34bc8a2f60b9292bcc417f7244c749ef785a085ecba514f94e7d7288344ad16f1f9d462e55f09c6b8e726035bfe06cc615fd9e1cf2051f7188fcbdd41e891553c139ae2d73321d0d3113f02c31dea009c9acc39cc9903044a3fd72c51f4121fed01acc3f7a6a52cabfb79671e010c84239326c365569038214af5ea2e9d11c94164fc5286c2e212a3bd443d5fa9a6e58128d37235457ab2026916c280d7038c772db0a4ff4f6f6797f2a5513c2a525e4fcbc2a39b404b27fc066c2ee26dbb412636a1b58836fd73198d7ab8788a1573deb4703ced2fe2a160b72c81c2786f71701ad5e37a42b758a5e3a190fb7c870e002b023e660beadfb31047f5450a8a4c5f5bfbf7f8f8628d616f7123d8d47ae5fab515f9accb4f3b9ce77b47cc52b1498c59d30d2dba7cb0b8c75a931606f2c7ac5d923e42da036ee17a86078cb5bd82a9cb5fbc1cf2e10ec8f881dcd5e3e2bbb11eb7e6cf1d37a4acfc38aa1b699a1ee30f76475b153500d30e36fd290e214f8355b572697736ddd428b8081f38fe6f5a342d68f345455057756931ada45e30ea8c9a4c6516a83d7b2d3b41018260d4dcfe8384ebbc132b81437ec85e704dcb249456eab7a17df0ff7e27aece505db4724f8f9b5ddcf6233a5b35bf6937cd3b29b616c796854a2918a31caef425e4ff6aae3925b55978be4bf03544c4879f9000139f897801a750cfba36124acc7b8f3514a5a002d558271bf655448135025d7c1fd9cda5f7042aaef168f29726681413aa5ca80dbc7aa6fcbc96f925d4d7a569bdd3deaa63cbf97e18c960ebc1f97d32b0e5349fceadeae91e8d84b533fc6a3a939cb88eac76ee82bfee1e270bb66dff42e1b42e0434cecd3192f20876c22e17ba62abe445f6a712afa053256acd6c691ad9604f4c4429e158426a9d41fc1e101c8679ee8c042d62ecf9d17c61a9dc50f5092b8941700beda6a75e9ee46a448be2f64ce0b81bede1ee8299be16b8f90d033f83e2fd317a39d48398037156a87eebaffac1ad98937c5e6bffe777f40258477fba019d9967c84232db9afa58fb9339bccfaafc2e3dea14b444f834a6e98081318b4003aa1f66551ad6045aebedd815bd539a43adceceed84af1818c75005c3d675a0d0623622652ccb2f03cfed5b6788977847ddf1ddaf6d997230e07b13ccbab6ab86d899150dcb90fa7a0dd26a2fb397e57492509b46e05aa646fd228d8615652d8a49d90930ef5701ce2feebc54b29c61ad58581dfe7b36e67388c39898860265f288c7ae0b9518e507d88437b4dc2003fc8f1390248931f36e41791f8e3cfd842857269e5811d78b0e77d1c4c9c55869b68bd0fd9d246330a9d4412b5a58621f38f976f6e2fbd121813f0679c4ecc20a88834a4184c9ab79f493fbf075550eae05c5c580224261592d5b3db21a4fffcbcfc54c61c12895fd7d53375a293d7890e2e9f2df60c14bfb3fb3b0f787e648c04b7a72e05657c837fe407d4020470cd595029d48a2363feecc36ef9c1d08d705973ede5b7a24dcce08147456c65c60a01debdc7e486f3285ebe634a8ce63ad7078afb4cff7c36929f01b6295299d13d237fbeb86be6f51d176f619ba744d990c296d7cf646aaea9c925854536a094ac4f4171c4610d947617757705e0e4087a33f61509d18ce95a8fc18410b244b49c44fa35650b605f5d34d8471ece55276a3b4df861caf7cfe5087c8510f9f4f5663cb77544de7d31904c2ce3c171903fb2301a699e5a54372c85cafa6c83a9e250383dedb088debc65990947e3d5a575dd5faaaeac3084b12548a96ce08c8931dae72ae63b220e1003920495787e83e82ca577efe17986d84fff726ca0db4b8865b5134026dee4667e0607f1d29259a1acad1eba700c3a013f3f314e45c027fedcec22e3a031c614c20b6cf55376908f1c94a5bc3028dfb85c2c44f489d5e16d32ae6df35358c8627bc21e8892ac395d6e69a43f1a551004f12e4288cd25692f96d79888abce2d1d86da16a98a1ef62caff2d9cb810b05887539ce58deeb249518776bf354489f6fe2ae77005998b2e771658797cec2b441634cf1a0e5e97cb8364fceea4243bff1c558e304254b8a4d498dd94e6dde5fdb53fa6116638c325a449dd4df77f533aabba634e482e789ebd9be537d4336c5460f94d5d0c853559cd9337e8f4324a73e11349d866d8c24b58299bf05684647c35507366982aea50dfc425fd3b073ddb1d25d744a954510efac1a827591ab95ae2a679f361f6fb09b175ca314d96a577f3b2f859a8b82961d1a9d89607508858fc8544ca4860839695b03f36da736c0cb6e1e640f65a51026432360846d17da20c4206467bfa4fc30792fcd6097534f885ffc6b9744d6f618c280d354686bacfa952a9a0e7a296ab0d8dd74bfd8caec3478d20df8209c7118ac1882d9ec878f7d0554414298ec29086fe2b25f57235412db34628d715ab6a5b6617604a3c969eb753508a1c2b6e0f2a6ecd166fe7cec544adb822f02c363ab48423c91397907a9e3972244bc73b718b4045bf7467aa7550b3ef96e79b42f83cb13d68b6f620b45612badfd0bb758375b84de14c40a198afd9b7878cba91e1b695f2ff285feb3187cc004367e05650b3f84b84e75e46e1ef9678b36c75e853666f655536ee75c18d4ffedb70c84206ad13e497132432e7ff40eecbf388f841757e070ef8f976094cbe13277437fb47c61c01aa049fabea42db76d28ed3b79167d6bbb05bdc41e69bb5af6bac92393ac83b02a251d447958449684698c98cbc0c073ee45ab8d7d155917416f42935b01230bb13840d04ddd0d27e141272d955fa5118b81b61f94ffbb33282d84700a483680a84dbf98db64705551eda6b0b6e330b31844796aafe52527b2b47ac24f2069d2504cf05eb202a864956394fb4e0248acd047eaa37f9c62ee8eb2006e6ea2037980bb5c046cce092f78bf5d16a3ec15916d47b1563167d724c984ad0ca2ace85f322c2ea5e305876e9b0dc90301314443da89eb7850a72660cfeff1febe00fa5c91950ca6352eb7717628c840342f0354fd8414aa1ac02a038bc5ed5f2b8d588f7ce614e07a76fcf41ee2b3a09542edc0f08eb8acd9fb82641a46e274c32bb8ee7618cc81cd623a0e8ed9633740c582936399f5317e4623397c3100231b698c78893c480525336b4c8b37df26c110c45e92cf3d6c1eba3f1a6783942f0d523322e23aa0ae9d67f160f28347743ca2c906a35f17e3c9f494aa64c23fb415ff402fc1d5bbbbd91369623c435ef08e053a29bca3f314647d6cb986480bf349f650607610274fa534bab01ad3adcf7e8f375f7359017b197958db72cb8f4a619bf7ffa7dc57367cd13009c35093cbbdcba1953da6144cbb814d9aa9ad3e67219fe2d38cd03675025d4e0b4505f11b0cced285e32442c249891b4bf15434e17145ccc83f21ebf8ea029591f4abe91c37153b2359e2b36664db1a8f1fd24f41a26d9aa420d5b3ef71eeae352379b05a1e86c406ce3e540d48c1420c3dba3cb0c06ad1ffcd00827dbae663dbc89eda16f135f0a4c8c3b1de041ad25a1b2a7ecfc2108b90163d4323f1834d793bf85145fcc3422531ed5a5e9598f68de4e8d6aa93bf9071edfa40ec1e9cfe19e7659130fe7f8230b5baaa13377d75df21c6e1a2e00e92303e4111a76857391d24b86be9753b0c48ada86b65dae5b97a3d3135fa13078c210b313130d55dc832325519c3065bf6b62978bea1e5325cd5e24b7af5b0e074583a978a9a558e85e6aa230c4a61532e2119c2dd312ea572678967a7745860fa3c5d6fbff1468bec8f22ea8062a52390e8c04f835a01483f0327cd279cb08be836fd931be496ac7f0f4607585daf2ba6d7147edbf2cbd68d4ad38bf67caad1a7d5c49e749ba0ccce3c24f780d47106cdcbbc7288e05c84719ce204ad4d971dddc2babb506d22683b00cbce1d4ad45a77dfaffd6f1abfc11afb20c3829bc12f98abac3fe01d10ea7000f1382c2309d0a9328203d71d6229df8e72c09483a5275e066857a5fa669d001100b7b266f4d15be870c7645b0c0cf06524c8b6e3f150057d99667ea7137601453d31b7e1cb0bd4a1fb977b9e0ab65e43f5a5981c0dea5ea533adaeda7c6f8fdeaa2fa94f471945d8c5b7ece9c13bda3f3c1c133b175f1842b0cfd1bbec4afd96904a349ea578c9c372eb0ed9b95370cdc8521a9241ef7f2db1156fc0ed73561555cef1e604204eb7d51ea8f87cfa7542545eb38b940465459d9e9b7b9e3f87a11d82bbe7184ba8d13cc021eb53e9931e0dd6671a26c50c3f1c40ffdf023ac5a2b99e3fd95db1f3a0dcea1f48ccb2d9db4f5462420ee623b270d985504a36682ffe6a88fe98070f67570863150bff7cf28ca21930c15c820007afa090804cadda7f5877e384f2e50c04e22af36ae4c8ea32f9fcb12252f902fa9bc97d1871f68e37d5708a9a83a6d4d5df871f782bc97ff5fb82385c65df11c3c49999e7e45e31a17700571bda95df9506816a2971922497845baed005668a762ca0d430694e60af7f0c1c045a2cc636f6c44caf9ca13d045a12f8ecd10b584376a285f1b7feff7425ae68f580fa8b0471101d55afec9b71ecea185d57fcf6e4435ca165dc4d6ea4337d50c61d937bf4b129af07aa7d010c1671f691cde70d1dd0999c90adfbbc1a335629763d28d9230d1fad97acfa92d7780b6b016b0a2138eb13017dff8873f605071c31cb25a31f070322757dc81c47f66afc4acfc74372f442af31487ebfb8de341b88ff1528863e441844c9fbb737609b3ebf82dffdea4f79c2a86887295cb84b911c2c74930e76fe7f5c1af6fe704a458e3c104aefaa6719e1271f0e6c10e3f37a8c5ac0ec2277d1a60f99e4d74198d7dab34ddce72882a446eb5ce737621c4b3729b6e14d46de84668cf4b892b4a6a03458e326575a1c39cdd8374154705573c5210aae2afc9bfcd596bf65f7fcc53d0ab38aa995f5cacf92ef070f52c40e1e44df59c34e54ec7277717fe0fff333beeb7576e75fde5bdaf86905b6d615ea9e43487be3c55084529c6eb092da39330e03ea128f7a658c06ee7e01a15c2dca4e3c9219df133c2c0ddfb886db51e93ef6053c4b21b0154b1c92bde06e092b91da8c6f275ac0fe0bd5a75275010df586f465be59a0293b82956413b175e56009070a34caba12475872de54ffdb4a8ab04030e8cc30b45899e6ceef9ee15329508c78d22da903ef28800d0e9c59e4c895d1879408f1b38660fb912c3854b3129aff5e5ba3e096cbed658ea013adc156c6229eef4162b8d4ee9bf29b52ce777785f5763d409818b92bdbeb02d8cd27f4d2ce5c1d6926754e495da02c4de12a93ac85fd48f6e160309da9829564eb7474bb262bbc6a7cf70f6aa237a359a98b7c100d5f75e33a51b655f40eb34c8745f5305b0d2b4d2bdbd71115f9168fa34506a415ac1b2b697950c09c4d2c7b4bfcb3045c0ad594f1dd8855e1f568a52645c83751234b14c8e5ff4a7ee5db85c93698f9aa125ef05b5b61181502ac38e488d06befb7d4cf5519b1bb17a63b5c4f133844393befa3cbfd45444da3654946321076818c7e63169dee05549e65056d6a84bad8dc5eebda4c809bf3393f85f0fa302b9c3ba0c4119f7e903d5a65bdeb9c0be4d50db9781d614bb9d6eb12065739107cdd0df95b1147c846f5b98f079d3c2c5db3bc0e4fa595eb5da84509d3f1112ac444977a50249742bcf81cee0571e0df07ac02f83d19c5c89602ce4f8d24b59d432594495c207c1b0e06ed2d4a3ace2431b5c945fc5f7f5ffd91ee1536a942e13bcf5aa3a12a894eaf89a3bdbce6d839a6e5e10419cbb490c333abbd853138acf1ecd24db2d508365bca4366a51929915dd116e3bb2ed307ec736b81c66f657b8e06c178160c6edf19f3ad4287f3a7c8fce4208c06bec45478ceab914026182a9cd0b905d2b81c6b7cd05654dc9bb1fce532fdf3d36ae6c4f409fac58671655b7913bd5978c2251d094a1a88e69d0bd3dbbf6ce6944ea4088fc2e8409f97c9ce40aa05dfd48c3a645d726b8e12700521986a9b9731b95dd447da3bec7d7eeed9a970e3b259c488c7bfa09418f8f556fb62306fbc99e5f7126758a77110c46ec98db68b7f86c79f545010562527aeebea5b7acecb1a387b653eb730f71038311811575dbca3ce628400d37407adb5858bc64676286015f97e28931819e5e06da2bbf15373572221ff923d9100badfe0108f8ac9a30568bb9eeae96942db3ae027319ef8b2cb44fda07b6deeac6ec90f7b201865326318ee77acf0a47aed7f36aa9296167b988b8d63f08409896fda707bb856b8150f7e02e5a702bd005aad276adb699a1f8e5ae72b6bb40af94056c4b35620e4531b391bb1f8dd189ea453a4ad077f594d81a4d0653da88f30acaeecad18bf455ddfc2616f9422e0538d2fd17928644808ae4664b677cd47063352cc1d04227c90905affd839a16abf9658e50531cb3e4efc3b9c5ca6ff987e45fa04d723aee5253651af439ee4e7e3080ece8f8e9afb4cc6a30397d143756979850b4386da54a13988d8eedb5b920bcec80bc8ba78c73cf50a35472b76c4f04b97c0cf61355171e81a46c527263b094c4d14b538a293a43963b235c85c37b0d08689993cefd3e677e6b2b870b5fc333222d38a0143e6257b13d95a74902f91af270917674ee1ed4a19a2d250d05bd367f97b03482afe716c988247f636d6ec79ae4bf8a14617623544b1474745c4270e998597e48cdcc87d891bebfd51d66081cb7155c7ecc798812deb9681bd83c5f0edacdd35e7e69ff66578b5d00c38cc71a6790a9b6ccbc28d09ae20a7eff3310077e471bf73941603ca8a013cac4d1823984680772a40e9ba355e8aef3c4c211da4319f7de75f8e3e90d92e5baf6847556686026fccdf7689b552c671891d0bc45a445f3767adad92faa1994edb5c64c0983ce2cfca93a6e26617388a4ca81cac6ef1c8802363f35027ffc35f788965ee0b70da3f5c457c5d153cc326e6e65f848a2dd8810a3670b19755f23caa6d98f0f12a6a89b853eae708a44a6e401651e96f56f12ba47f9747f906d99192f042a8643b603fe96fd1416da607940ca27dd3f5b4e153cb67a14bce2ffa2fcf23a34e8888e01c0238cdf0588c83a6ed2c9e9eef8d042456f05a38af492a9e62ce94363965dabc9e25bb105a7b757254443a83763a8936cf1db49360ac1bdd5d8114d0655a425912df75340d77c26811e73d15b355b1726b6015a12c6b59c7a7474b1d9ec55402c3285dd48d7d61766e0cc62909bac4b0e3b363dc80f1b6003bf765c0e9a695143bb3d674ae680ce0ecb05164d7cf33795e3c53307cf96ede74007e0527e50271299282dc33f77a22d3d304a7c926167a8bc85a0863914ec8b11f4c4412648fcc35dec5614f7bbc98ba06aa16213a18ac3262c14b7a1919b8f146d2e6e4144b4311956ae9a294de9b46fd6f9406f65484c9a6687c74e033bbc147ca49aa4f85c4e69d4e5b3094f7b69431cf4865ccf248a4747d741243a8bc32ea247e6f3ddd40cc79115a5b3af9545c0df541aedd8b0632afc6fc750e15c433f39175af5c7db971e7b62b2ca31dd921c397426203752e5b58f968c821deca2bc22d8b351c932f501caa00a4c55d5beb13c9dccfd9a3fbe33452e5d3ed5b0c0331ce3bcee0879c179e55f450facfaede9090d42838ccffed1670be7c31ecae311f157dc667e7d11b561136ce35b364b8226b0286fe38a7e2337daf7172f39aaec25a2c63a4bef8017667432b9b08ddfed66759a1c49fa50dd82100c5038b53a38fa0a846e35d17767cd603bffbb464587474fd1de84707590361a17a5b0e8b046b47608749bfcfd0723b6ec89798d2c31a211123ce56e09af398133cc363ddb169cd42695ad1e6c48e0a5bd2f8ff2ff324c7aab889dec2444fc9e19d3dd4d189bd161893c10c192c3f8ac76e7db053c420c7deae9a8424f085ea29d0d7392ae9fa7bed1f924538aac1f9da9401588fe10ccf222f6ddcc51fed62e8f4fcd8b2d8943c44f8c191873c91075a1b6478d9aeffbd6da0d62f1d47021b427012bc75ae43f57e5d2a1d44904a6b08c41c2b727eb13e48bf8ac33546af8e76061c0456e310ee2653569628c0aebec871bfe92f91d198dbd32fca5bd61ab73f900977a8957b99e584e05e7000d9dd7616882b1fc44fe7c26c89433ae1e865b96f25e3f681dfd28b2754aa593a8c6d5c54ffa94c6bd9777bd00ef4537d73b3748d62cd70a62ec87c74f65657c07e9ac52fb0fbffb3e751404942071df437faa2032e7fa88a4222fe4abcf926350c1ae6e0c947bb73935d625b2d907b387f5380e2db4a09b246e765e98feea6e4d5a840e7df68bc7988c51fa8c80315afce3512d9588947816d1b15662db7e0f41efc20eca2b158cc569530d18ca5a0a13f260853d309f98b9e56b98d92c51821e286e570558883be3dd969e15b11d17993c9365c71d0cb713507dbf9950a95d4e57dbb5a62ce79f7dae4841d6b2a799fb4979f3bee468e88901852bc1afe080b12d86015dcd3d3b566b7770c6cb59574502e1fd5c2d8142bb22f18eb01656b2481baedf1aab4298e8b369fbce4d824a2d0c112c2576c6a5b18caf1f180c30ca884d1acfe065dba8e9e25689f4c88b263f47d6432797a8b1b0a6bc3a3ec1e5d3a0109ff2e6737af6ef02c1d25d7d9a89746a30411171133b6a0e079e0b8adbcf44e39e52e98d1bf8622fb55836b4df557efec87bed4b04d7a2fcb433069a866bab62184764d2babf0bad78dfff9bb0bc7ad2f8a7730c2e7d59aff55475147a7cbf3b9d200df3e1e8fb7e5e5e52f0289cee74312ee3deb3e3a5af2ffdcf5fc8d1135a3cd5424abda959438d96d163b226c834bb870dffff90c562b7725175974b910b867f16c9af845346e5c70d7e5e797b7369dc532b339aa3414eec00d1d737c78fa8144028953d828370fc09421fdd88fd7da0a726261ce7438cceee667b8ea271b9549809c4e70ba215c62cc455a94b0e88beca44c8f0306e436ae1d8b8cdb99c5bf5bb38700b032a09bfcd0ff0ee2eac80e15992ae23197585dd434c6e837c0c8123e84ea814e86655cdfe01cd64a000a8297fdd75a417f6c934b1eb8747d2d29a86acc65d249f53c2b7bc590721bcff3811060f46bbe86f237d329b9c5b47f6e024405a2848677f1157f8dfbd6aa3795d0f9d13e2eb82fe1d997bfaa6834744c9a8c0a7c7886df116d9ef0edba8348ea1d3956a9c889f148a5f9998f75c03ec3258209e1b70d026d3122aad780321f828653cc9450337a07b3c03156525bc50dfc52d739ad616122d329bdf75fe7c9605764b55e6d525","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"a04e2aebb4f065114c065b7fbf49759e"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
