<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"8637cb568f6ab9d1512dfa6afce43883d4147d9a004da5ab4f7a21cd83b8b7418abdd9112cbf952dd6589a660b89a91e1f8696fdef825f27edb00bf7db155d96263b9cc9e5d5e28a8aeab2458ea8153793d6863fbcf6ee9f24eb0b38d26820b3826ed48d8b7a076d11164912ceda787f55b31e19ac4827f55c5b9cc335b4c1f19f31dce8ac8eec4156aafb49306444097565b6ec30d84f94327fd1b7063e530c9202fd36cd9c9a538a5750903971d500fb52b395631ff01bace46fc8a738d8085417fc96dd0285629d0112b73bd8d3cb29ed5114b5fc8b6d7363d39fd2fc869b7b796cb7b199c9d447b6769c8a62ec0f12c98141327396b65a829434a4637379dbd3f89fc6bd421c96c98a869ab69c725d0f89f81679690dd0dc0bc659b0e9413cede46af6751e122f0b65affd7eb6509a29e92aa2e516b0b760f80ef3f7701cb05d1ce4b0202bfbfeabe9e3bdac4028d748b8b90ce3ba3503ce28bc5d42ee4739407436b365fd1ed5cd32e24681aa39805fbabc14a83060b1c9a3d635a55621c2e40415eaa1af2460c30521d257beb7a66a003ad611de73ed66be677a54cbee4aafc228168ccf91f4f9f2657d4754987d16c5439257c2e6fd01ffd28c4793f8b1d5b3c9a612a3edcdce7b6c435f7d551a634c27c2d3dc0f5569459ad57c2f31262bba93bfbcadba0baf74ac08bd2783e15611d2c9bb783af90033a85c7b62933f883b7c412e61ec46f152b93fb4b6d6cada4be9f92264a446ab4a793cec1a1220e500b67aee53991994a9b7729e05faaee3fdfb57e75c14bc7105a4421ef8181e862532331665cb0984e56e4d0ee26828925528f58a75d963f6e105ccd8920e6b205c5cc8856e649d4df09959150af1ce076cfd80fabde5b8a8dfc583073db23766f24739f69fe489c89b64659e9568a33c5c7a925a138176a2dce14bc0fdc8b6c8dcf1e113969e0f2d1f93b95e470ac28ab76c70bc37f2dd83d7f76a6fbe97dabb6d8bcb58ab5d3d184549b7788eaf450f002d44165057c4dc7750ed60853054508a155e6ee0b08ed8a1a5a1f198607a9fca304f11bef28ec53bed8315816684305643691d1e692afba42989b559fefd149f9a7daa1ce1dfb27b880300a69640b7076269ecaba24ec3118b9eb65e643389839a7d18ae30eb5164fafa42fda8f6c65d33ac0126e9362f0635721cbe377b72243acf9631e69b31bbc1e9f6aefb8119140c566dd327e283c2d6ade3a23a64f4f791ede1d676379cfe9d0410035ea754fbff5bf2d13800df8e552ca9c7a02b56c51c9620396dff1da0015dc9600a01f8d65877ff3e17090e37e070401b6f6ad5fbba5553bedf8cc33056f9b6b095465354ac1910fccbe3cbe1bb82fea772d80c7f77da0b70131be7c16212c282d6c1e1a951b8f4c961e21bbd4c7fad7f87381b746732beb9cc5122b13446c29a5696afa6343bed60b5afbd956cc9cfb74c16bd853cfeb314e9aeea8ffae6cc19098fe4029c7c7e4b632225aa6fb11aad41f50e8da1fe0062da524db8b04f2965f13ddd104872b495b42aa28b8c9e221d325d5880272a9f1b5033a344123fe8a9721e32398bc31ae89cee31f6607af36baadd48113aa1911589a7595c02c67c4804d73bd6ea63c195cd2414b110467e7ee5d6d0960c0a71700ed84fa8553b7613b9a62bc229fb8eac5aa31351a288fcabb99a717c9307d8c3a4dd249f4fb357ea07c35f931e77f88c7f40b456f35c2a983929ad6b3a40998dc0d1595fc30d8545ef1c46eb134c150a4483121983e1e66fc384552f8a7c9c7e02ec28a69240affbc8bcc27ac1c21de1aad009f1aa9d7506dafe22ebc7006f5a2e180e86256961305f1df05fbcd25ccd4610e6c7a911201b206b5c3b5c1ba49ff9f734dcb834076c99c4ffea9cfd9f28c89cdae28cbd2a61b759a96f88db93df7f6aed5e1acb03a37e428b9856474b2d570e4c975cc994322c6db714019d9469981dbba4aa1eb4be8d3568f4b17de507273cde0540f35e36dbd4d6d72ccd65dc99e099477bb42e08e262e63970703c5f4bbb0f442adc81425b68e6b2990b04e8087dc8242a80f3f812f141c656f2a51abc6ba85a26bae0f0b852e48e334689eb9305cdddb9272de05b875ed0b63ac28b31ab26a96670c6dc340ee9d95e8c2f1d61e378ef8908213568a1dc39e24693749a36e66a2ef17ff93cf1f08599aa389a980392ea6270faf17572c508110e85f2d5a5298de2e207186bd123dfff230f2d97ef91cbc896415b38e4170c63c7a5d7a5ed49b1d19f75c3a01f35a15796b8864550ee9d97620831c202b8e7930e552c48a28aec1c9b338aab9e868c1c83e7178c148c526bb62d40ee7b4947a2d5dbb7811fc1c02ced820025d759d94b180639ad50ddc1d0ae7c0c6d9c1c5d806fcecd9b2204339293007d493bcae76bb58c663c85953fe4a512a34624d0758fac64c2648842de9b08939fbb683a00d8b54c0b345d93d0dfed618c19c9b772719c6d50fa6123793107aad374dcdcb10ca7e53a0fe1d1ead3c4663e0b3379f5f784aa739694af3b93c570c31ef5761180137d284df7f2e74b1d36b9bcd98ddcaf9b6fc2210792ce6da759cdb98a2fa5c8269940ee0f35a691ffc9e5776a6adcadaeda20ac895d3f43ac814c7f966000adda6a57c6fb270daf6ee02776fa9cdd2f92cdd73968412a0aa16a693cdc97471aa1a2c8d166e63913d20e50ad3a8b564efb2860e14dddf5a35896ff83941650718610e0bc635b22cadc409612eeaa34c71dbdaae7c88c338f12326f9420e9d2449b9c17d64018af1f1d92b60ce5c057cda4c4c4ccb55866df0506bba082995ef92df38860b75e778bedd1593c238c4d0ba9f3665be9a6a8f68d18241459256049bd17bf969bdc36513cc2004ca95f0168a8594f540cc218cc08c13e6363f16006403d5b67206cd2ca007e99a42b08c5190cee6096d5466e8a265b51cf92ccc1983211d2931fbaffd6330dc63b8a64c2f10d1b4ed802fcb0f729c6d19119c11fbe4fc23505a7789aa645007dab77ee5e5951a952cfb5107919c15307611afc79ec8e1cd3aed43db63257bcfb7661da6b03832e279a4fe293f6a56f21edd843886ddd37b34fe3a3f4b61132d858dd62936ef8c3dfa3f1f330686a7289504dd7e0c4455db4167da83447def196b5bf4b077573ad235915440c8e23185cea4354d82d1ebb51763a000f4d461b8b0251141d3d0a6eaa05a3d3418193a09c7f1bed33695f137cb97353292b34b79736c580d812a2933ef6549b30ca9251979185209133050aa429dbbee65173d0d92368fb6f8be95398f8f50014acba3fb4f589afb717aec70ed82edee2084f4531223f84748dd80219622d23612ed85b5d6d71d4b112f82e673746ad435627b862d324bc34d471d875527616eee31fc18080a1cde0679338cf79e1e5c962a533f47fc78f4e3171a6d7105f1b107f2310141c20f24c355ce12057ae6e0e7ccab1952d1d384578def0bc6864b8cb0bc844f1a02a4a4d605c5ef93b416e6182e7546597c65bdd6bc41651ca5a869f7e611128d537f09a9710aa023cfa4d30de3d235661b2f6226d8ff79ebe99405ac8fb9dd6bb29f8801af592d9d6b1b85dcae2ebe1afe10e4541ba2a9fef57059f5f31738f6c65c6c6db47167dc40240bb59962b3aced6b23bf3b4826401896548debeb92c017e9b5a8337d67bd78cd3de041d8aac609bf63657aa38c8902f2ad3817fe43d429706bd0e31c66a7123320a7e6360ae6a4cff3a418d8cd3b404df5e01b714697478ab8ecc8cd25953db87e603654d26f7a7a80428ecd21e9ae1f3b570417d40db9bb5475bf45859746c1a212d2dddbd2fb7baf27df23e442f7da8b692d2a7d88059040759536ded29e04d990b041dd79e2b7472c9fcfa46983b63abd1196f9c772602607506e62752f8c1d7e40e4d0569b269bec13aadfc7766b71debfa31e6446e81f987b25c33aec4a31ef3dc8a427244079cdbb401131bd4dc6f5d42fa8d6c71a2f3d68672ae3f44305ba50d0577a3b606bfb77590a8d8338c00993e1c667b3d3789052abd1f1119aec1e58cc6835cfa5a047d4180624e04c5098c1ebe3e61e0b6e70f92b8e0d26f281fc03126dfd8aaa251a58a164d383745a16d08414cee9e66bcbdfa8a3433219e2959823a1c32b2f3c44bcb2e4c6c56e0aa97ca85fe7a364231c9a544a3e082a76a3080e654f06fa7d3a2c874ad2ff49decae2ca9754a68a2165d5f17817959e4619b318f3479dbbd3b34b613b701ecb3f7b970158a15f5157845fab1fa2a61e94c3da332ec2444098509f0fe2ac0634507c558ab4a134c80e06f4eac8b3dbf82cab5b3f1fd22f6e1fe87aecd6d85e6c39a908eda51a97f1deb2a64b8159c0b7facc5fe55444855b349d63aec7cc4d5bf9b96c1861e23a380625820e163625277740d31be7cc5804c3c257dfa4d36bfe0b3c009ba134c593ce78490dfad609a0ec48dd22b2a15bb4406903a287c23b7a908bcc2c62981c62890f56376748ef2abfa2b1c03da90c18cb7b1dccd7df326a363fb996dac38f13a9b785b3a39e1985342879883e61f6382267859b6bcd871180c0c544fa46fb9161c41ce6476087afd4782c0f7691bf3c6a2862fbfb7f6f1e8b1dc02f24cbaec93c51c5b7ef6aea370634cb21de12c9dd8a24a4248489508aed8f60978f11bec0e821383c7cfc3969e3926aca2f27ed26e2cd38fd96c1dce23623eea237efb5fe38cee6e1d3e7826c2aa163a8b5b1f5d7890e7494680306338a071c746e4b515ceaf7256c1df05a3d56dcf3e28169a833845437aa314855528971a529c5da2484c0da556548888a5d1a941ba572a2480a08b62758422f9161eaaa9edac979375d28822d8a36ce960739e53e471d54497ae2aad17437959ed37cd96e3bec232c41579a07af887b56c3e6cb9e5baf0687345810d988199a22a4c138deda0d8ade09ebaad6caff89e27670c01c0af962b37d2d94064f788c3df6f4a4da26bedef0aed7859e2772409e72130c2b0946b98dabc9e07c32ef06fa6bfbab25d8867311172efe3c6ed6025fa1551506e280519504d8301a384e009932a11161f173e5b8440431224aedc3e506d2626259f6d0993268e11bd7a728da17557d0c27ddf8062aa7f10a5978de11839ad456754e6591cb84db53f21704878f732fa4c66c8c7c5226d0b419cc896a016c91961355853bb9681f8d8057c377ba0b42c72a4c4f046cc04f2fda7778cbc9a4a7ba69d65a548584e0433ffe9974741864d17cf3ab5cac8e0d15f4bd4f51c2253d4ee06177e292c9eea7fb4e73cbc5251c71655aae577ddee56ee7d4863ca60a329de45602d5f73260b9e1628f560ed7add46d5e2032f53018f027a8905a6d09935fd23c026d0b23292a54fab4aebab22334600f55e1bda947f3c0c7e7aa97b6734671018437cf0a6bd97e9b05536c37257b5664f92f63e8ce192d11248802423eb8a51dd100219e2f55815e3248df4a71ff5830dadb5c6dc402cf60ad8352a31aa5d8792b1351532c5a7120c19e019f0d53c20bb984e167e928e977aa4a74a32b7f315813ac8c04cdd35560bb6031b53dd0261f4d0d8482b82423042992e3f72571185a5bee77d617c4d9265fa0feb014388efea9bcb7fb5a68d8d2442f1a6053e458209a1ade6208c4c7230b54a363c5a0cddf091aa79103ef03aa17588702c05c88e70a5aed665c65cf564c9c49aef506bd2ae1d9e852f5dd5b7031c0824900f6b6b141474d63af64409828536d8710ce9e8d72abf9257625aa43f7a8d3d588dc7d695ef389712f4afe1994676671deb16e5e0ebb0215aa9999af1a89401627abda8d36be2f97bfca63d167d3ab8069fc907da80baa15e137c1a269e8c25de1ab0de020e6b8d3f19d56c9e89a036a8bba92079417b17c455afa0c768c3a48739ac27eb65d74e38e04a32222e3511cf177abbfd45119d711f337ffdd245b6cf5cceabcb5f5411e35889502827492e0ba32e64db47a3100fa55a89507a1929423aea545330dc8c799faf0d8af8d0818f4647bf0ca4bb93797ffda902fc08094e32cda82af0543119ca3da77b13e43875a8bbdc7c9f995309ac7da97bc51653158197fb1271bb2685ca9af9e5675641dbec78e52f0bc89e48e607b798c58f980e05a0f8c3a82aa86dbe0a9cb0829c198791824188ddcfb4b833de83dfd5807acb1306cbf3e751193521eab86ab0f2eb1b75095fa26714702f1982dd1ccfec50f84c7428639db5049f41841ac870abd085c01e90e2591025cef1cf3f029a90406aa4d95771583afb38150b9c2819089a102a7877a8da13dc5e3377d866088090e86ca4c7dee75e6bdf352aada1c6243220233796f8b8deaecdb81d4398e1fc0999f13c292208b3e830ca645f902f180effadf6ee38a88faf82dedca8e4e433b75d668687ba350cba5bd7220a80280f3c1b69aca7c71f5f23d51f7e6ac43f1c5bf241f7808d879e244b3338152534a3d8e8cb9b43e4a40c00fe6e642f0e5ee473b9d563b37acb1f34bfcecfb829a7e22b6a0e0810cb46e82b12a0a73ed54a39f2297662be4ef4859ee244459704c3fdb1ba6b32dd2c319e18027725493cab26ca74d515d175c8557d2c79d7dd82d127fee2d0b9d41d3f9f6595e75e7378c01ba4e02c9ff365e62a6db9b146e48bd083f5c18f1f62e0b41eba338c885ec16dc0d25b6a67f48440ab52ac79fbd8f5ba86895f190cd0b686b79949ec62324a046db355f879c73219e0bb5d808468c48a9fcf7aeff8a1969b78efecdc2276c9b73083bfcecc6ea32cb37c5750e50bbba40b625bd37af99cbca384a78acbb8f4d9353f32b85f357934f991460d78fe9e203a6fc84f02b6b1a11638317670a52c6f92f414686d22102f3a18bd7c7f23d742b877093ec67635238548b03c7127c8499bdb015b982bbfe99ddc68b4593b71d7e20d9e961dbda2c746c9a8f33adfc04c797cb0f25bf44090bfc204fba72f9112da12a095f024409f2fb41e3a0e16f2bd629477deddd3a98ade7a43aa186eaf13f3e48c41fe89678c9cca534d391f331e32ba9e84ab2f89403ebf24b9dbc7675db10bf528809c423b71e727d32878e56e8e115ac85df810ca27f722020a9e495d064aa5c644f410582ba101f817cbed9970764cfa8cbb1261d6d51dd202e20f3eed89a2b566de8895e00af0285c5f3acfedf92a2c748487ac5c65fe6a2189da97265ce03d26ae685b1ad36adc704dc2823f92cecf7f2f14ea56fab8ce35ab0280d39c821dca7acbe327ed87957e0e89a453f061f0b668e65507767636a48bb403a9cdaa78833e6c18517797f6f28d6b306093a0689984c58605688895536bc2b3cb7e28b55391f5911c1478e3a7cfa0f08f3fa00fb7341cb0a860aeceecfc71d0ee652b420899ef0e5bc2851d5fa041b1491d470d3ce0eba5a6c8f930c63bf5c835f3c24f5088c730832e8977fe1ec6ca8635c27b5747cd04c7edcc04851c1086439e6430aa36261b420a79c0064878f8cecddc9b413a429ed927574ff7ebabe05302a672ec29891f6fcdb83e8ec9cf27277b725293d683c9be2f4008c729e5e182bfb6dc8ed99fb687fc54ae7352b5dd0ad0da45673f088c2073b2297173b2e76d92f24477f58503b63a54f01c4b592043dd02679352a8395fade2290f4341b79bad1727609ebbf1fdb0a9eb61d7d4c2d2e951c139e51adc65f7a6f385bfea24e60829a20c3783cc81a566eee94592e54eb885da904b2f1d8f37b1952b87341cbe8a190d7ed50c8c20306b38cf991475701859878167f95b28492c4f565f378f939d7f3c36fc288b16143a56b0f0c4a3f18e8b3e43d8f89b3078e8388690f7c4b21e805d0026102beed3a8fb2d65fe15c1d19d8405fe6de17b0d865cfd11e6e0fff2102fb235c7a503c2c2c9e3b62cbe8d95868070fe14ea6e7807612988ae5463cab4eb79bfce5930e87433033038eb35994b2c9428900c1fa2c71936805aa7d90b0a1bddf3c8a57025487172ed025fdfe7aff4b8757db1dc5cc847d045b986cf15cc6ac6552fda9fc93def94650859690c4d09cb4eae15676a0e66de6c54fb1ee40afe4a9d1e83d37a1d47cf6cf68b76bf64472567ff016305f180428d8105b28603eec1d472ace633c42ceab6a6ba2ec22e3a591cfca73bb2eae9d54c8219e624269f8a30bafad9b3c53349dd55a4be211d4dedf2cd38f0b11988045bbf8ff41b1a870fa429df797cc75eafd5b2fcdd113c3cfbebe8d0c71dd0623c433bfd39798302295fe60c491d360565b2889feace476c2267b13ee1e331acf9cd6c7d6c0964ae6efa801432823ec5862e7e8a0bcfa71d0d255394381190964f3f20791bc245e2ee1f2005186e3ccc12f107ab44fd81498576deb03e4f72e6608cbbefe68a397ee8feee5c56ef2e1d920db9a2ea9c68664d58a8bf70253eaa2e3dc57db0f8c370a65afd9e38d96728a03c9f058ae4599358a10cb1fb2d6aec4a0334edc957497a1cd037bc08e93aea8c494cbe381db9a8e218f75464ee1a5afb92550af7ddee86a060c75091bb3fc6a3539af458ba3565c349fef353ffeac8a3e991620f367376921df182e399a3158d56af04c9cbc9f79848eedba718cfb2be4f71884d22926cac0fb6e0f28b84c8cd81a4c5d113b197c19d9389aa5c9d669b5ad3a78f91ae88648513abab12d247279ecbf9922cb46915341d24a98dae9607e2aaa14fe528ab529c36f7ba42701bbd3d47769ea33c5ecc9bcaab442c3fb0751a6777e8c58b9f3943f5e34834c0acede3be33d9361ca7388724f5ad452c3e99e9916fac0b54525acb7a8ee4ceef28a56c8d4761ad45d2943cde531e814838e35e1075e7be682f0ebd32486259b6f766fdf0acc650a6d06f775f763fa25582b4641a53f4d5e4077648f0730431aaabf01b81ee76ec751fac1bc1c7483ac67f58dfe17faf498ab3df9d914fbe7818dc235b2c70333feb7adbcefea860dcb18373454a8aff8b7f3d23fbecd08f36050f29e5431b46e2f05772faaf90600eabb0be05fa3085fc3116835be7159c797b6f2f6debe1766dedabac799cdaf290f8f657903c58368fd0967470e658b710ba68d9ab278b0bb3829c1c54c1bff0c51e0164f896a7f6a6492ddf1c3b34c05343adedf01a18eab3b5836635aa85ec6b5e3023ba5f40998a558b9dc9b8c82b91d1b064ca5b8796c5c0fe542a7eb16810788ecdf7e2d3eee92307cca11a58d52f56de9138fd216ab7baaa3976faa09a84943e92698ccfd45c32e508507db662a2923f2bd5ef6b4ae7d1dabce13700ee073f9942216565a3f719c62b882c9d97d595e0c10ac5a692a3d3532e72d971d7ec9395851be9ea39ac61db96f2980d226f69bed18e5044afa36089ba52d7f9b1556622ce34ba6c316a369e7cfa3346cd758b654c00a7792e5af4553379d0cf9ff6d251ed45eee8b8a6f8374b9b8c5e779d34f896aadcda66ffdf913103b954c0210c12204c25a155695681e11232ab54d38aaf3d61ce3ba48d5a209a004b697f66ade19d3fe7b8d0e19511ab731b1f316829a2c78284a3fcbe4ae57a6713bb4b39862a4788f407684295dcb3417e783586b07f2c0c7d86428464745ac16ade3d6222af72ffe93a2230a90f9c90ea0624e3e1725d1d43414ad6d4daec01ac99cba1df6a26e2f90bb53c0b5346c0cc32f227db64774afbe377db2f893d9b118faf06aaf7abef02937de124769885c4eb21e419cdc045e6608cfef3f2d52a15e9802a265fd33d946f259140f6bd02087dc3b7af8ecf7f7275471f3e9e730a7d2c21b056fa969f1d2b44cda07035c024f1dbc2e53e42cfeee84f602e28f5bb6d92a108738a7f3cdcfc83b621ea77d4652513c631808a3416c107361b20a384b620acf52874f847578603090a9d179feb6a9b3a3404a95132e4482d7da2942478be9415aab83cc65bee5474fb6aef1884061b8d20beab2f36b1d1030df52e00190603cc27a37519bd3fde982d09091758dad52a20d3388894f3c43abac3d807dac6ad8a3c39400ed6c2af73a201a9c172ef69ebe9b4503dfc3ceeb983457aa5b33d700ca32cbfaa40867bf53b83d293795009fca8f8178ffe053428c5a9094135027aa1321bc47f4594efab11fd9dbc6e70a31cf35f087ad97905229b856b3537c6ae9411573f808d9d5dcede988b28cc5bcbf40e2616d29c34181d7857f03356db2a027c888fee3f3290ad9c030174deaf1d8886154aa48b2fb5b09dee263162a6f065adff0f7285695a943c66c900e167e93df1233a9dc11fc0c2d26e72efabb48220d7d41f6d7c5ce0e1e200b14775570f430df06f7a5b4fe359f3bea7e57318c7f739a60417c4754c3b14a8d720f984c6f706b82082df2759b6baf6e200dcee4664966f256bb17dff6d71d1e328d0fb407e4ab484a7125d24fd20b652374ba9bb1849e3ca31f82d4da13346cf0ee6b02f45f943bcea3ebb88c64b16f70d4361009ef6a33e814c330f43c685f467975b1465021ae85b3b05c59b70cd5dae1a9689c13a156f8d4d47e587623013f9768c6f307f32e0948d100d93f18b6a19d7e6f4ba613180057e889ed4f63d63006d4c5c79fb0f106c27af80f0afeddc395fe58f6e90b5977ec45cb46610f57d2de3dcf03db9f8773f99aa129641f26dfa7dc909a37013e955ef2e06bb2a65fa736d81b23ca103b176e21ad396537958bc1c021dc8dc317c891940ceae1190da152947fcffc4f2535d13754ff6c6d2898d2813d17223e1c728a10a2880c06165ddf56103d02af3a45d6e5e39723bae7f88fbc848bbc5cccc4470a45d4696539d71676172afccd946b0f517b6ceda5998e616f487eeeb3e21c3e043c14702186a0b7a862eb79181b0bdefa3234078347d9e1a8e739d337c3a1c338e29986a67e6f3d30bfbb8a8bac690b30f366f4ec67ad36e1dd6aad9efe2e3d6a53e803604e20ff66fe61e4fb49d7d3de3eb89b0543002dde860fd32dfd811b7a34d5a5bff5047854df048fc5bac66b8b8313d60a6dcae85e298cc47e60c610059cf0608a025207b536052e444037ef7a0dce7e9d663d416bc185c85ac891836db4aaa7bbe0ce1ad717cfe81af440c9d51cb2feadd4060fec09c311e0fe3649ec840009560743be660e4433bddab86681b3bc254a2d0496f0723d0aec5372d8465924a0d05cdccd86c88f8da29caaa1166ecf5039fbdebc7732ec2399a36a48f501b64558cdc88a8d98d2b938a3c6facc91f41d025cdbfea74c349569dea0aa1ea776641d4ac2a6188d89917bf37d5ed0b3ecc723f14103b6b98c4a3d8ff6c352bf052f0ad1bb70d4029f2b1b5112bce343e60787a0f1b0da41593c7978f286691a29f2f53e3d0eb46994a42b5fff7c6f7cefbad58f9c6db0aa300eb2a99b0987c340f0ae440a06bfe60bbe5958ea6fdd8876e58d9476b2a2485731356ffdfb7df38657d0fb194a873567cc26bb148e05875e943b6a3d0dbd96b7c3921685d3bf47f822c7a0b6bb52a23d38994a52cbb191ce6032a09b2d431e05f9f2a3257669bb8b05e132ede62906c518c38d896cd3ed4d0b827ded23637cf1c2b0ecc9a07ef03a2c5bdc26e2484c7e2826f3cb8e54e639af10cd2a675a8565d3749f827acf847519d6e17502413c9f768b8f94df079b93e5d3b2c3d225d397b889363beae397ae3be444a19f418bed1615de4528e5d1113cde24b8982372800f7c23f2ea5bc267c7f73e324219ce49dcadf0e59d8901a5d603a8ee7f58b850db4305e5657f926043ee769233582fe3226ce1587a4964f5e2424025c3346f11e0a8ed4f6bc1ded7844f268fcf7e45cb9c5728b94759dea8c3232abc2ac5671c5620d252b6fa59004ba79b319b4c4e950282f7303bc022764befc656fb2bf0768c95ee99b49d53dfa7ff73ab1b262cf6ede45399221775585db1afa6c8e5f89ea86994a805732e165c0a408c7d1c867cfa0eccc3c9c0640da7dc6fce0465f2acb8bc978193468f6e63f834d59a36780d22e16f7a9b6ce877ba2f62e33945735c3a7ccf14d1073717cd7a29b1fb5313e9769f73b28d0f49fd6c228871edf34ac6c3ad613d9740efbd80a647c7837b63703e4bc3f91200fc13c5d1712824e3316a92a4ce23d0f2d6040cfe9d64213eba69270e7e6658072a26dab42840ca0169f8342ef09da16eda1a752fdfea130be6a2f14fc0eae2c7cc15b625d3e3e6b920ed4def310673e94c0ee4564a3ff90fba0267723218b96981a84e57d7139ffd6cefb450aacc687651a892c9e7493b22cf23e37e974d3566f13dc4cd92fdf661b5a99005430844ffa0ea2b07135f86e2d5a04803fc475658b7606eba17fe8cca69f3997da96a4e6013def652b2fd324fa12f919bab8976d81905d25cda45c28b0b0f72516932676a6ca33c6439b915af064ead226adcfc8ebfbaac26d6d39b04bdf3254f7838b20090533ff522c904b747aee3695929cdf253726d58f06065ba04fc3d2c815e973c300858ef2759a2d8d48bb09afd59bee2073b79968c69413500dde7791301806f793a48a0fb6db730578f277e4ded09c6975d28b81dee7fc275b6aa0bf19b0dfacc0affd77e49b24aed105b24ae3e5d5f1fee620a33560829142c99767e10a17744bf7af07e427df90ab0f1eb874d3f46f67969f81bebe8eaa943a83c0de0f62f1733043ab19ec3a3064437b51179bd4b9fd74c362a467706176bd42cce7da6a59100e62b33a3341850290378c51b508c1c0cb2f8b84f18cc9a487b2ec54e1db127658f6bcb3e693693390a72b8e3d48fe002455af1c5aac209675af742d39c7bf71f399e3e78e5f264dd10f42db9fae74f3eb65ea8a1dccbf3def8a3dd29864c4069bed367ebfefe8984da4cf7cea3084900dc1b7406186428496aa52295cecbcec42b6ff921b6379bd6d32c08ff052fdce28d33bd600731bec145dee09070ee80e3d49193a7b0ea515cb9211aa243b4918b4056dd92c88721d84bf6806b9d7432c5c5db4b7a719cb97b4ad9c9be549bf99c0de8675202a7dc01eac69b6b078a8c4769f6a946c009d33e290f3bed13a72dd73e0cda45ac7d055a511153bab486f239c49f93d8f304e24a0f328a2792bcd1a4adfc343748ed990253497ca011855ca23f07dec407cc55bf81be19073314aa4553c9328cc927101e5db41e0888e991858d26763fed4cf4e0f355ef484687d902ae135c614b5554e04a593fbe09bc5d5167cb0014c95021c94fab24bd1578bba3d80f5bdc5d573332b7d4b59679d23fc793696835a94f87c8c26c6f776923fa7f60adfe0a206c5653173899612e9333a1f1946b8ff137f984deed772dddbe014c7d5312debf0eb687de731c0e42488747dd960fa22657c2031710bd19bfcc861982cb39f5f1547549320012182d6dd4fd60f33ef3b2b16fc4a6e5341971616bb532d797059cd741adda9d0db522eb715ed44426c695be473c04197baadb52fcfd083889bcf50455b5ab81d991d16bf1b95869b0d38e313886a5c3e08473aa2ae95ebd608db7323082b0b92e3cdf7f44d2bdeba19718aeb71ddae6863564bade4adac0956692ec8784319a8361947bf5882a153dceef4317e706e2bedae10ba4aba9db220726ead490c614131d9f05ea21218e957cf8391b9e3c80fa151e59f89779887b507396fadca9f6964433f002b55e4db72524e657ce78fd474c68785c95c5d9c4b4ba59f9da38365feea0d87f7b3bcd8e74b371f013ddd6cdd6e4c0635757474b4379fc12349ed74d7c792e9444c4502c5375c1721f553b176131b52eec6e396474bde630a043406b4ddff44b40ac968f2c2f7bb482b258fe79d0c985657ce069b53ecf270ef98ae9536a66de40d0ace114151e69b64fb288532015c067ee1cc2c5de17aa09bd4742a5849935c1c965ce3c27f46aa42b57afe151835cc60265927cacdfb0eeb69a8f7e466d16c8052c8c81eb6fd4ac79f97f82605c8b312147e97c46056209af14d9a334090d029723fbf38966fbea5421793302d012b2b2f5523e4edf4b7b3d72b9e9fd64353a1061192971ee2ec9cd12fb6a345476408d8540d2205723272c0b7ce6f0f80e8fb947e4e5b415dd820885ea50ed6f244f989c07df0a71fe296dd6594edfa65fc157b519bf57ca8ae5856d5622f1100317a99d08ab6327f4ef106a18e4e0a09fd17c520c5554bb2e7f358947994a654b717552741a0d22247e694751067052c66521d3c54ae8d02b2d39963f976d41e973368715a9ca1b1661ca1da9953b2ae271a25d994e6afa82ffa8814f8e7b7115745a701176075fa0f3c0d18c6c4a4d677b1216405dcf8d8a0a3ea635cc6d00f74608edd0ffbf88c7b59c88fc4881d1b772a3d76ef8fda01e510bd8d1b64ac512aa05fb9051ec0b953fd914d945f45e6ef3cfe704029d90334ca66ef45ac040cd62ec7a422650399adfa827389b606baf0f4a39d1dcb85c49de4f19b51aa2d867074e1c1a2455e44617546db04b97fcc23e5fdce68b975a489db35be1dc3da2eed54305349d16b88030a845d81b9d3dc8d28e52c5b0fcb08ee72c35193685cf172e03d8be2848892eb37e54907540a73f7118a6e47c434e041b0dc4cc9488e7b0ddafc8b3ea7aa70efcb41b6ebcdcfb7714a2e175ecb851f255bf54014eb2bd50d3213f4d458281ee83dc998b5200ffdb1313882c7ca8e8683b07a77b774e75698c9edc92522642bba0c11da804b7bb2d53ee4b1a2572804222a287029d959a82e63f603acad6b1f49f2fe8b88f4edf058779bd15b22a8d02380041a70d52f351fd9f384854b801e65a22c7e8b7f48ab028ef2701c6a59ae649c75e1c234fce2ce671bac2b8c99dffe803056f0f7461006de6f647520189487fd3ee2761e11960e26279db1c1b875c3876f2f95ff7c58ab6435a67574f9648636cc7cd876fc18c34fc3209a769b19b473b0b4df984c3ab439fc38f0c7227b84bcb70e24a728b397d9f9b0f56e444b6f499396aac6ef6f9c6011b8a8e1c32997d4ecbe21dbcf9c7065e53a50178caf72d4d6afe86c281fa8fb728d26ddc9f43902e74c1584efc8dd0e07853499cca85e4c3749f6d8ba28fdb6a59552bdd11a653c94eb161804bf07a48706ff8d8224e037d93be8b3821d913c8abe65ec2b2dcc82b632774aa66a84f4e1a2a1a7536b474c4758aa6e173be93155aa82026a0c83a9f9357506670813d56401e779b17523702eeddfc6fda27bdcf7b6003905b6524d1b32da6bea9fc203b2b11427b94a866a15cf5f49cd27dc73a5ab8729f3b8a8e9006271e4ee0c55e0c431281f97e0e686f7e4c1e931cd036cd7372cf947f3052c5c0aca1e9ffa5599c5afb68de2e0321c149d41c85be087e43853eeb1471ae062c6a34ed62731a4f95958078cc76a93e7b35049391bc53d65bfd4e8eff76d8beeb83010b81b0965b5bfb41233221a8846090b7ba603900ce655a9f412dd928b80cc873cc48497d6873180221779fa0b5039e9f88c3a5a1e2211a966662a6980aa1bc0e86dfc2d0aca48b3de7a76e8030c19e18c9841b0393dd5afc0aeb0f950632a78e4b64a035cfd8d396c841a76cefeb5c6127de578d463d344fdbaa866f0b6bb1825e6b87a8ff69c68b06042f10fcc89e669c0cbbc5cf6cf7ff6f19995f94598995446c91f898d867378624b48e151393aebca764bdcec82a798fd26cfea7441c11486e945fda1fb16aa55905de727f9d2d3e9e3072b30170a2f1acdddb17966aa1ce1184c793cdc97b224cb72cba8acda03f8d6449eb517d79db4e759821206394bae0e14df2eff246633190713baaebac8b0244ec0a46d665030a0ba0045eac3ac293ff3bf0c53424c03c9383e504aa19ab00f91afc1218012847e1cc987bf38f86625374ef1c018db12b8deff5da551a743c7ba519fee1984b93f870e2a4d6c9a070119cb81eb5125f10dc3fe78cbb0aae1f9448e9ad6ad2afe8ccd6c5d53c19fb8e745273897a11d230dfb1fad0030d3578130dafe7e68a338dde86ac31be65e372062d48751003f3df10c2deb4d9666f44178c10e9789eff11b7755d0cea999ba9231fa90dba9f3d97a185b7383aacf5fa28ae5bafe4e7922177e98f30aa9a600f50e604e9f8226848f03a1c2f0daa66a72edbcc3e104289211ac4a5b43fd6bab2bc7dc9104a43664819b1b01374cfb9121d06c57c2eb4cf2d75427a462314884aaab303eeef2c473db96d10856cdea19e21f1db1a15283516bf378507a3fa651abefa704a6e204b15b768097ade35b8f9429086a4a49de5f793a3125898ecd6de715158ebf4838854285fe4a2882a1d788789fe2b0c57ff312dfad260278877a438ca2610372d5b077dffd9c0477f89f773304f548130a9d24c4ff4ee59f9b9aa612f853cf6627129a6353d08f6e2e7ee65d5f0e1d4b74f1f2147348b1872be7547f3a9aebf459cb7036cbf29c812de09b8dc9b69b62f35353a0e9afe37244dfddb752bcb7d9faef0b1682383679cc1fcad978fc09162268dec15e68db3d30736225f1e5e8cca6e423d13af54973dd617862aeb830e8747011c1a18286f3406641fcce95002878298d0ea85b05d795cd8d4f4bd57d5c546e1185a2428477442ffb0f8a803944f0617e7168770f041c530a95c9e1a9fab558f64eed0ccab54e4df103a234e3f4a716ce489e078730c4aef2c2534fcd3656557f5b","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"db2470865aa068691185dcd60d0115ec"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
