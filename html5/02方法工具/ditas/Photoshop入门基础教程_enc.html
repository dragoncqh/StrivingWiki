<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"0d29b3e6815b934257bfb26fb5f9e499dc362a9122e7734e87f05b6d4e36d70e9592165167fb71c5f39409d87c2b8468ee60e059548f04f7198a444a34d472b102a3822c6a52c5907e4647b60bb44ecf421f6d80e6972790404505fbef5a35a3256e8e2b83dc1ac91f2374e8284729d404a0c047b63b7f0958fd338d43aa75d10920e2b2bd3de0f54603c3637c7c20a87b2622a381c459317c92135435e4ede0a0d1696e85dd8d3f1aada241d7f187581a8f7f9371e21b210741431a5901d8c4875a40d787a7c6e799b78f440730045e8563c838337e33600abed35e0d2e5ccba14a60f578a05755b2d779a366358a50a6b05ac4d8dea0382541a42fad3bae20b55a55b16f15010108aa8bbda55cfd7c7f83b52a24d9e2cd13837d61e7abcf7c391eb53232fffdb12f4bcccf5f61c35ec47aa951a2fe1aaffe84cf9c8f18afbe0c8e334911fbf2ffd124b56f1478fc41e1ead9804a0ccea42b6d825c86d5c6b358f86295aea83635eb1f6ad7ba39f24b4256ed5c5472dc76aae83cf3a0951fbb9fc8fcf68e5f24118fec71b11b890bab131dc56245ff1a9a33dcddad0f4fe9fb81af0e45b1d3bb1e75c4b28437215115ab71013c2707f8306f07f58a4637768e23a75cd119e0e6bfddff3d01423af308d683b03b95ff66b9a7e0e993b2042194c0250dab4c2911e354a6dd0155ceb29d30972011c7c11c382087e1c3daa942d04a263f32f6223781ac8a817fb50fcb60f96020ddd75e0083bb05bd9f31a83beac05874907b202c8a6060952002fbcae930013d2df5a16449b168858cdc63a549e67b4b550955cc8ffea51429ab3a23d0dba69ac8c0155c7424f4e215ed66c8107df43dc500f4964214b1057f2eced681d37095993e51f931165532b795ee764108dce96a7cbfabdce870ab3d67453a40fa49dcbf1e70b2a91d4ffd84dedc98e0dc024a06cc1115361b17683141c05207d71db117a1e19b32fda19211cfa68e6f96454b2aa42e0563bffe39b8619be648fc29c50a8089f3ac7a0dd7357d13686ef9246e7352f70a4a636a5decbeb70e92d0dc873bc06b014f31bd92f1b8a3f7e7618514837b29a4b15bcc74afa36446abb8388c3d77d069a498551205be6d46747a52d87ff7ba5a5b7f3001a4458b33e5ed2193c24d00edf10f0d898a9c8faeb2183c7f60a14216b0c1419df387f66488f95b682f88957bb6cee9013029a24ae38f0e2923edcb35a5422bcc0477ae7934f0730ea45910b851c52f097c2ad758e6bf66e61993b3ed6eaa8de3ca1dcb9ed148e6d9c31cd8482b1991bfb3816e0588c77b4404e49069c5495296d08ac41f51064a79d10a9995c923a042e2839f978113335e811fa209f452bc84107c36d8d04548235571722f70ddc2305d5260b1327ba26a4291c1420ba225d622069f91e8fbee118dbfdfcd0c2a3c288a2efd251e51829f6d8135a72916581860038c43d58ea632ba6386e8d482d573548ee2f6cb4df27c061902d40de04032441fd3416f3dbc2caf0dfc434481780e5fa2c26d3be7b838969045b95c6e296790cde96dee3a82badb1159bee27de2bd790226b181f68566cf9e61646e7304c586e4d2d7135bed3a272c364b33175afd615a950237f2bd1fa171d018b7ae7b3c3b3ee27dcf8f4b83e62ee9b83838fb2fa6ca17468f73568deb39cd69852174a5419a730ee58a54e81b31527d15892aa996a36e91f5b70f45bdfc0b18e85d216330b82852abf998c511d328d64658a5113db43e6f380d35f3298c5e8a6967bbb03010361b1107666f745ebedb6393b62a7511859c148d47252e14fbde3978f6a7331f38c9a1fc5698b5e7d7f24635145f8d7912d2ea5435d985a039b20c6da3391fe7e6ceeb0a7f0b3f6bec572976c9f27f4582002aae47817ba64d83764eb4821211542f2ecb36b4a280197d350e533cd55b5c33ccede27bea06856b64cd91476ac4e3e1d3f337e74a3238f22199161c2ef2e12fc8e95403dd46943138830997a50be3848141bf122d2f460e7fd08cdf87e941a2953a88062f92ab276df65b421d44f035b3c5af7a720ba8928fe14487e54ab0b0fc826199479ac662bc7bc9cc5366ff069a9adc6249dd2d5f51deb05cbd638cb85479131ea712b6bf3d1c2976bc3b754233fbf02832e1711da4cca14347d661619de55d3dafa4980ccdffa2634603def28067bddc894488838d8b5a99296b1160329ecef304c6aae2bf0f11fcdc36c88c293cfc022824b0b7dee5db98c8dc52386a43afc923b7f0507cdb90acda287e68994317c8d4cd8dbd139b92005f0880d53bfb31171602b82837b28332265fbbd07dbaaa3ee7cf9de75077cb37b0e46fd8c4daa7af6b37acb708139381619586778d0eb45f9f44bdefe02d67d19a132c57d0de5059d23dd96650046ea1cc08b38febfb1a177406c5d02d05d1bc6762e4a524e736f3519e34bfff8bba3d74ecfc07ea738cb9f8a058ea19b455fb8b67d3837be77142ead4a475bd7cf8e6354391213521950625a2f21da7063bda4fd493d6b8bc08d3f0d8a236a28fdc2820ff2112b79932ad107926c1bd563199e1384a993eca155a1a490b046bef412aaa503debb294dd2285e8b6d6db2a3d7b5b36aab4dd58776b4f539081124e2ad73e7f144d81d8a8bfcbdeb2e84c3616a2e0efd585e6ca6bd1d3e750517ae6ba80c1ef83d8de673ee036f0b465950124727a24ffdc454f7e119c3e3f4fdfc55880b664213d09c52a352092deba856246577ecc182c77e350c84468cc5343942e6a7da9448ea61ff28865453075e11be747fd1df921d3c741e97dbe1cc08e478bc6b81146679fbe3dbba247d7a21fdc5c4c76c4aa9e33102c6769a11a6c13704cef53797278890bff090aab00f3ad8a74da1a59636846230f0bbee4be5113080e8e0a19c0261a7c6065895c01e4243aa350555e7559f1d5caccd63e67b96b71e7c7ec071f3617e93f1013cc8b87ee1e0e1d54cb52a32cf8aa2fbc8fe91476e341afac680c77d6a7a3f1a29791838e017fe576f38491de9bcfff5f3509583567ff8e522a2e77dbe8c9eaced7db7956df8a7a8b35dd21e91af1378a5999bbc926deb58c751994c7a346e7b76da332b8f04018498df2382030f304bbb01b878a7c8f3fd0c1300706457f450e32599981bbccaa9125bcec1a430114e6423510c6492ef608dcde8ce5d4f9e293f752f40ffd94486c6bc239f358bf3645c0d751e14544010e2881d87b686725294b554b893bd08f2ffc46648fb6f400f20c3857737d2395c1a9f14acb4cfc4df0cf9abf0fdf9b9aa5c505b9e254fa9a6016e45fc66f4bc359a6b022b63338fe6aa481c2b64c5002b7ede3de32c8d31a4462b4fd19b181348d566533050c7c085af8bd8e42db3f88c83c0328a986d5c9c55fdd24553693a500efdf53f878ad21a402c3a9de1c0d31d34cedc3c9b51666a9ff489599af04f763be1e2d406fe30a83d3166031ab9d70f9a390830455e1399ad05f0bb6240be41791b3d4959aa529484e8620cd120ce522a4908a016f0f1d728907dff20ef9b330c2dcd2dc9dd700436c269a121f631df6da18b2231f08162812ee793a169ec6c2db670ad9f125641f82816634a17f725f2deaeb798df1b733c596a7596e85bce1897728235a3da06bf5d35ae3f11f795fa8dcce5ae01423afaacb97df44f3eb1d906ba7ff6d227aa83ff69b2b4323e79dca0148339bb965e2e7a369437691a4d573a76284de71b950130e585f43c69b4b430412f3f1d39c7a63a072b80f334b83b4355891cdec6b5ac51ff39bd195308d323417ce1705b6083751a1e365b8c1bb3a30e786e916eab693209b41eff8188871acd7c62febd7de9bc5b227e00fde12e755c040e604e14b805bf4d9a2dd19b7939cef22c672bc2bdeb05cbd11ebdd766de1ddcedf6bb54d12fc8039edff164b9604907b63d9f314b28187d908c0b45bf5244235044d108a6aa6a1e0557fc5727ecd465cb29743eee16c870e6226cc65461a4539875aea62b4f9c1b6106c8007b9e2dca79ffb366dbc0a3405f06af1d9d95c03f033af96487227bcb7fb4498419af87be9923039ed6b9add11dd455ed809889f7c38649b349170162f8018defed39489fdcfcc05d5b4128c3d5893502f2d474dd4b5869e645dbfac3b3b594d23f4be4ce6fe6f08f533f27928f862bd013d16879097106acf636695523e1db99737e9502f418ceebf8442e3b37615ac188f4143a79b04ede2f5401159676891d4306e4d406de6264c0edbc46c47a8252ff49bb01ca3f26e8ed40f698b85134adbe6a0ec9f0d3d4eee6ab94edad1c6b2db4590fa4f35d43cd44475f5f7c05779eb5c140643d3639891649ab641dab9fdb8c403a922197b1d0a71819a0ba181d4beea2360eec6f2af4f41deb8abbf509cce632b57215a7c5ef27239ad621806a9d2bd04fe8142b7d2710722470e492c77bd1d846162a5d240392611127050200d8be405707fcbee2a29c659235d1ff0ab2844f30b3a56563681e381e35455b5be9ea2e4e6c0099756954a5bad81f192d5c43d88a24bc0ee2ffc8c9b8047d338859e358b82d34698111554dd734a88ecb370f0f0ac15fd23c263fa11715fa5f5df1a115aa7426649b4325781bf46d8f1bc70417e20879a284de3590da8fedfc241572a14b18c07e71de67a16c7cd74c0d005c2842e2b9b19e3269fecd7d31fa0460e023e18bf28ecb3bc268330460c9ab0949339db5ec8e6ffeeda52e46ada736cd16dc57df9977176f101a7cae1edf67a2c1ccf2cc314653678c6e3f46bbc9a424c05310b03f50fe923bace0ef7917530ef6e3c219b72674cbad17a775e62febe70cda25533756a3366ea40763d66e53e02105a73a1869a0788868d37805df5d6757c8c5d2a716f68ac9958e297242a3449789558a8fcf042064cdcfabef5614c7ad8af601b81f6b82a38cc9cc01ebaabc00196faa1f9b9d6c5a9efdde6a95f066b8c807c2387dd251f4307d10d67e48b40447d823e9eeb65f5fc9983f3a6b3ae9f143823cbfbf423517e1533b31e2e8aa05391ef7470f461a0fd16914bd4fb0cca60cf4d63fb1bc41b8e82fc315d0dd48e015d032c7c2602747fe7e692a9b34ad250935eb9755dbc834844dead2a11bbefae66ac676cff0a4931bf84b7d73a1c20f3bfa635d9ac0ea85a73292900fc5323bb5c5ff8d741061bccd98591b54602de36760bb2494a47acd49d0b926d0cab29fdb63ee0c5d920e0558a885771b35769dbc9e118d22bd86fcb0d9ff9bbd82cc8f6f50809972428c5aa24509c7299b69fba771423d9a84deaaa882096a76e6317e26f77e18289be98ae2deb2540c6a68030d0f4e7fa6c959e70303245bb17f58c73ff0ad81abdaa5b2466e2df44b32fa50c48dfca5759be44faefd2f44fbc50f96dec0d4bda63a046f065695f744db6be30d5469fa0aee877dd2884d4c8212cbfce28ac5741c6970d647e653b2fcf1e0a8aa6e12ca5e0ba18c65ba97c245a8dab691af35986e9d26b4e65b6b036e52dd3e130bba6fb778ae0176124d54cb89cc8da039f7fba9587a1f4246589d4298986ebd1b2eb9f1d1cc507e25518f4e0764391267d2f2da6373a10f0d6d8234099ccbfdedef60aa832e81bdbd82e5973db21ef04bf33629b95b50c4657635414abfad0dcd6fa8136db7d950dc17124da667de5d67e85ee3033813722951c087621a4490ad12f8440821223629544657732c957d2eb8e833c1cfdba05018de2786f1684f54d14950664b2aa638ba410d21ebae7a76bfaddeea6c8c28603d9ecef1f6f4dea44352be656ae15468860ef8b71b75a8a822816c764a660e03ebf031d98926fefd726725ba7e712d1274ebd7ed3f6d05d412bffcf9cd79cdb430c8ca6dd6a176d27fc9352a28fd564eb428a3a7c665fae61f83ba0d242f809f46aed2158a5803bb31d96008ba55f293b9408fdca474608dfbdc155420ae5b208831a2149df9832ae434a0c65c75ce4baa9dade6a51f9b91fc209f9ac2c8487e64da6898c23aac9708e49f56631eabf05280e418b36636a9121b029b5d07f9061113493f021d5907eba67080abc08c5b8dbf56f3c767771826a0de51c62c16caeaba4a50b29bc93cdf4be2e8bad1c38d199c727298a3077ecaf67eed7881ec0325c79a2a6bff7dabe4ee72e7535d818ff16c72a9dd8dc4e94b36df535d07740887849b2ce51cb5d15ce73b17024fc212bb61f6c89406800f316faf1615f5f11c440fa286311ace307645d50fca5c4ae15fcf061ae2f48aab331aadad6461b2ee81741e294c461534866e0098ed14829ee2ea5f48283076d6be5e48c236b0a47ee8e71094b2a7a314682205d2d964971441044d5bb6d12b984debd09863fd9b2e7fa57cbb908ac860ab1eb6fd757d7ec8f2dd7856fc4323b258dd092868d49b888a9572c17209512826a003f8b008fdd64b2d89fcd9fdef80edd8760df65d16d309454d14da1cde7a426461cb992f1e10be487e6e82cffa4ae24b7fbad13918b24a6ce31981ea8bd79dba6208095cf398b6688c80c143ab620554fda9f73956d73023aef2d47393b935593190708b2f9bd0f0e0740405c3b6b479e02b0c8ceefc0231cb4cf3af582205154262d115c432c9a7af81ed1c6d62733676269dd21a939fbb871b85168827460fc6e72ea166b0d8e75415deda378f9d611f687fc316b5e5fc7e71ef64ecf18d8309b35469a2fa8f43fb0edc1441adaf7c38f8c8287d6777e2ceec0b94750f25f1f62a8297dfeb6c3fe67da86ca83af05bfe2dd4131e67cf2e9347dc1ee34d2c0c7533f60c9909d1b6281222b0a5bdff4b9cc8fac88d4a212f585f2efa8eec5681f41c382391a2e7ffc322f16b080ca7d8e0dda9d3824de5d5784331c3b1cd6205caf7c6d2394df52e1797f1590e34e90555ba998f2f265aca1973f075d5b6a4ba9db5e817de74de59de6d1052137c6f3e177b4524864038a9a337a1b6305f01f2bf4e1b8cf90f94c2e2a9928d00e1d371706956e759aa3a342cec34d28b760337edf2fe050c9e96b920887692bb84576beeae98bd17f6a3b8b1f018097b986dc3183c3bc5a91a0b2fef20ced98785eea0c4d3cbc002ff663322ebf2854e22028137729de19612f4a83c81cd92b7a7c05eca1ce3f3442197392fb76016594ff95ddbeb38fbd1e601c2f64a4c13ccc9aa677e5109283cc6a8bb3dd6800768de67238220463b1df26a54c86961d3b61d5a4a0b96fecd6d339c66aee59950055ab955146561b04cedae7e62a8c5f7e9e640d209d140d60389a32180aff46833d2326045bdf0d2b3c1ecd98ff43099c15e310c5ee75e871ab65e77c64597fd36d0678d65becdf03df3e5212043469b46e84af7cf66d28d55fe2e20345cc929c425d802e3dd046db8f4e669b0ff623a88328bc36e98b12a1f962b50ca82c6548c0edf722f7142fe1c89532150791e775cde26d3e1a1631086b562791a7d574b4fa415a47c79ca7eb3453c64b73e7ee97d17a479a6d911290aa37d72a1a853e986d9f07f6a3e839c70e55b5629ce565f809a42e74c2ee8bb44e5578e47fac48563fb31a7f552c3f957fbb597c42a5f69894faa47fb26e24a02535d31ed19d8caa6dc98e1c723f09ba6b3ba74688b4661cc8b022fe92ff2356ad7d96089d1703c4911e8ed39ed6185f18749c550c70765e4df8eb2d67b63400205937397d6235a389a57ad65c568aeab80ef67f62e29e74e92e4a4149b2b90b72dc8db0d9e8537d31bcf9bb63a9f23dfac9cb6db68b0131476a732b900d30e076e8c980e312ffc94d275540ec32b6c5f98f43589359e47a6d932a967468ba6347713bd4e63f24a089d86b96a0775389890f6d0e733356022d069a01226a235cb4040db8fc86b34cced3ad0803f0cf02342461b7f75e1a364255b132299d94bac45087c982909b2414d21503db036446efa7b21a7124d695a30d135654335ff6583be0d79e77217ba235e12d9203b923f4cc3e94c281bb1c8c2ccf846b1a0654310591c8d3f7d63529bd6cdc98b67578f6fe001b47763d9260abf10c32cb5c4ca94d4b9e4d5fe9806921e5dd9df40b39fc639637319cbf33f0cf2313f8be79f372b95251f659101b603869c8d6a0b362e00fa9030586037339711c0f6f43b29cb0d88c382c8ec1b1004faf7f49a11a25deba95b318f6e9a734677df03073840082512356d52fb73e2f6fbb87a87b7c751e472f9ea5b9c3b5419e3a5f12ee343218f23d498aba9d29060619f413fd29f4fbd4fbf537cf59a4bcdde60c2d9611c391690bd5a241aee897603cc02994e71163221a30ad8e9c462644fc68098a108908586b5dca60ba1fdb4cb696c5442bb7fa57004d3c1d4db5e91175ad1385d26f3162ddba2ef89b83c98504c307cbff0668844f7e681ac31e9f63db808f657f51bc16e4baa525d208232fbf3aff28d79f664ef59c7de084049a708d28bac5085be0cf555dcbe829bb51f5e2608bf4969cb75c17812224e9013536ddcb677db38bdadf7b703dde09fdb90b67f87db37a47c7469f8f4defa6f63323adf42459cf7b555c33fda74f5267e36c3e583545bd228ab274d8838d70c6c7ae32e52bfa7ad22894d7abf6ba12de9aabf5b98f8773ffbbe82e2c493b3470d9004795f2fd70daab593dddb6ef465ec2d0aecd612f90da579bec678f4b33adc9ae51c7a70ce3f43755a98afcdb1d2a3a119c6bdb9197d2ebacc8bb594b13cce856a3550fc6510c1ca156536fe50ad822d584a0138f1114510b2ff3885ca286ca1d8716daf59ca8984a75a95aafdb5094b2cb58fc9c69ada296c91adaf3aa03edeff7440d49fea99db3b5c2959c2b30ed44c483f856c69d64a4baaf922fe62c50401c670cae36be6413a2d98039e6f76231459cf1a7bd984c7d342b489d553b86933cae4374ba41c369b962bf1eabee654eda0e33251a11db2c87dd92de000be6b84ab6e2e76bf79b10cd4e4bb3ea86738f39a3701998043ef3526926989f5a657dde272436ee34cb637f2b701e9a0182645a8e7d6de271fd7b0f4b20036d33d15a7a2802700d3789ed6de0dd1b781e272b5815d1a45981e0d4a5487311da816456aa0d462d5d7c2eab46ac6bcf8c4677925d9eba3a97e0a45e9819796096fd6789ce02b6f53af2f6f127ed36ac82d59672bc5f441d1ae922ae753183ba1f53421eb4455c66c4d4c066b56730bbb9344a9129bafdc65dc87e3292ab05df05d6c2cfafc97b329e55a0d211ed302f1b25c66b3160c274a986d55d0cff9aafd83356120fd90521d8f0a6e705dae00b46612cfa099d023b9aa790609a0edc2e662f696cdd929d22843039e04fb5185fd9405a879405bd3f3b3a0ceb5e48f32f5f11c5822da2c0675cd17013ee86b9e8d2f5bf97c5c41ed8975ed2f78a7883005bdab9d13f6a930c6b6c34eb2898a3b8d5096a01611a2c8567e0653bfae7350b78b5c3015f8babe6e5aecf25560f1b5b8ea05472ef68a2c7c40660f19b05b79d2564a33baaf15a2fa51119989e0bee236a23823c00d361d7e2e70e5d93641e2988e9505b32056af359f15ba2a2844f639a1245e8fd8f74a1c26791d19396e151fef2add4e9c66740a6b66781f01f0f600b1c41a5a0972d347b30c7678aa24bf5ca5f0296df3570766d72ad2d6e215fbb3321ca627d1bf747a7d4c1ad80478f0caf754a20247489ae151f3ff7bb23e3de5c1aa24828695b474de887ce24b9dba4a667160f8d5ec3fdc81e0f942a20a28c0303aacf97ec946e98715d4da627b8e229f49a4d86d13f53eea39cee639dc877621d63db874cc3713cedfa890974a0118a9ca1c921cba6a040400c5d1041f618da724feebe01a40e8b18e815d6fe7dd6d168f4ec7f9f8ed75b5ee7dcd6aea942ccf9a415ee577bddd3ba09ebd9d495a2d86099e42306a1d57732ae3fe4dbbe703d353bfc3cd01039b0279f93f890f445fb01fc551c3d77ebd36479a3901ed884ecf9be800599360cb667ec2cbc8d6368ebd90419db520a987336102f6974ea74a14633e2c2425fc3c455815f61eca76d434b3620df1d69e41f85ec8df7d804f3793288566cf9c5f15ad484a08b0c8d301374c18e2aeb97d1e53cbab990f938d84a404b0a2d4b310203e1e4507b61b17d8c6dcd86ab98c59d46c1b8c411c99bc977c52a7cf5c011b5841438a079249e77fc8a4f17eabbb2c5833cb52decd70bcaff865512d7174cea071b52b365d526b0033ba4053eb9392539cc3b36e96d113b5c3ca9632d0471aa48a6275a595434524b531f7249f696fd0aada7178ffd406e431a11cd1147aceeecc5ffa4a41303d75d5a3097f29a4573288fed5bc0c1388a19b9cddcf4715bfd40c89fe0861334fabffdb7236e2971484549b14e34995a18c4fba244e04a84be9dbbce7e98ac4d5177a7ea6db9573f891c3d372b72d08083fa456e251e3478b514ad511a7f5c123c7f8c5380afdf74d57d845b5e98411cc775c22632f386f2694fe54ab4ccec58a79766ef371185001133eb687d3de1920e3e620267cfcbc150528ee87c2d2dc4f34c333e7dcaab604f396b085e6f8d9bd6f1086ea76c21482d1167548867f057a2477d120bf5a3f56afe46d7162ae5da9b988612fd62f831ef443ebfcf74f76324b4fb69052606b76ba47cb7bb5290f60c3ae5744eeebcebfce244b31de60ed3424592fec1e5e2fff255f939965dda6c38068922f03bed15c3c278ad7a3c5d030b71b42f876e39b5c552a3cea8af55993aa5b9375cc9205fb57b482f1b4505b35eb4df4ba4c2c37c81700fb9a18da8fdaccdc7f259aef7617d74e050b5e0e019ca96449f6c17ebc10c99a5cbd656b812fb551f8bdf08547e861a86a0e21c6d7453dad528219ff0b1beb77c0d35c1dbe30f1de65669a408da3feb8d7d526a96d235d0066617729672914d924e9a40be7bd07b1067696a33594ddd5dcce0962bcb9d8dab7dc17025ce4429b5068106581852edb518819d176fe4201bc9e1295caea740f97afa792cba3da015bbe3f1df17de7d29531b86c9ee036e7394b900fcc48e69ac8a2a99c54cc35087f5fc63a78cdf8dab15ed0233fdb7448b1bfefa98e643974af200ff164cb04e5186b93d4119cf65b12e876824da40fe4e35a83b65ffc8008e8c330183312ed4b832ca523edb547ec1181ff9615aa508f69a80808d68782d7bc41e7840d12d6e8776fb2b7578c58cf2318ab71e4b4cc14dcff449cde72e8e620aa089a6bf2828ef23f5bc241ab2369fc1f430ce5755a17c45dd6632eaf4f7d3d46474e2a03a5d30ccce7676542d863ee80c507fb4d022ed51f8e3709a1752b196d6664dec346adc54f7495317e534a37e37d26ea56687bc7a035eb87403f29069d7f23aa19c5ddcecb94c7994c0207cea653569fdd2bcf4435b2b0f849cdf495ead86a13d80a916ba25e460a4485b1f320ed59d0fadd28ed64af78267b7cc8023269f6c02145c5ad57bee5ee74e06c48cda6e0b145c4565f48f9a90d2c826421df263c40eb967e6df39bc2c4a0b618be696eeaa114f8e2e251673bbe3648dbf849e05511dd662808016719198a4baa9909102ad41c5f430f07f008cb78485701b4ec925fa1f7911f421670991b269b98cd9ec910e4ab304eb12f6e5ddfeb2758d64bb3e9a1f22110fdac4e66ac99d89567332d5a8e63720c030623b7a5e1cc34e291ab9f8d8c5ce52d800e21ae043167a276f5f36f9bf60b404d7ec3d421e336ed2fef7906298a09ff344b80b271d51c191a63dd02ca4aae53ed5c6a830e4ea1f3befc956cb06b8a274be7d3b5360ecc45e4931a3be17a14e769345eba3cbafcf18d163a43c2fba3a57cb76eb39045c19a3f1a1ac81ece0995f2a3ffbd29a4d3a8b64059b2bde5679886aec5831076b5b7a1750da5f8c454befc3178330b0281604ea4f502e26c4a61a22ebfbb9eeaa664d795ffffe4bf79945517f8fbb88f23ddee3e08f45d7ab8dd72a1d98b490914f7f2da467169be5845bfb317145c01e3953f454811345e072c76f5b95dc35fa1f6f6b393d08e6de0c858dc14fe8356c2c2daabef4b10b4e41d5a726e138bb6059cf35069fbe8858d88463bfbe308b6cedf7c2c2063b05a216b0926ed8849dd06d8e82dcf3b5889694517885cf35579b5f29c1b2944cf9fa59e3625e2be33253a9129d1d18a90a55dad655e718d8483cf3c570c4a9b4e772854e7ef14d8ef329d10996d62d98b7ca064da30ab968e853f7c2952279ad9c930d0052f56d86894b1a1705ba705ab78ebba1a7d7fd414153615aa32cffb04cd9d04e96ed99b83988bb7c1c14af0a2ae3ad4a467e95d8baf2b78583bd22af20de65b401e30bf36d77b4ea0713146aa0a421bececf43b72a50124910a017581393ac38e579107f867e0538752bae01b3fb64dedf6ec50ea39f39ab98a51d9499c77b90b459d1852ec8a2a54725f4dae050d6abd48d2a818623de4e7437ce196a74d673aee6b94be8d592377214538f3010a9c985938694869ca70df8618fbfa1ba8df5d79ea6c5c28ff71af04b5cceb2f20b679c90250a77df97731aa75254e55fea3c5970c18957bbedcd023b140df181200b8f42ca2cfffe46f55693845b071f93e87794076c6f51f0af13b2ef5838b72ebcc6880e20a274807f27af3480cc04cbc5efd6433edd0e87c670296fd450e54334b55960fc72a7d88830ef3d2666f424d46fb04bbd5dfeb532314c4f05b4a909c6e4f66b3da5e8b8d22befca8693465a460fe87aae33c84736954716dbbce24f38b3244eac3883b522ac1637031eb511beb0d35f30456fff6da5be2bf26576a50625dacf322ed5b7d31418661292ffc7b3b10c403ad988ee90573884293c824984f0e546f2741bdaee5053e25e29151a27b6edb3c988e0ec7d1e1fe888d7eede26227c3f0f396574d86798a82c58ef89fdf971481af89a597f1802fd988faa57a53c4664f3f6058660eabfb875159cbf763e1c487f3e58dce44574c056d57d37e18c1f4e9cf690abadd491deff52d40ffaa2792735f1377646272aa04f0fcaab9013c368212c80bad42f7a98d080f9b2fe8a6eef05226eb732576aa1afa8e1f4193168b1e3ddfaa1bbbcbc8cb96f571e164fddde1672105b77669c3243e737eecfb4cec862c7fb1f61562948a83f4e15958a4b9681f41799958126623542696534c89ca5bdaa6f64c2cd7f983155e3b9c9f47a525638c7597e17a6f5a3dac726f506169702fc37feddbb891cac8dda2913509fe2175eff6e3f91f269882a894cce19d3f093eac6fef989a8141c286d7f973634ccb460442231e63eaa2b730e8ed183bf1159002defe8ea787c081a9b787fd02078d53473351fcf1ca9e265c5cce94cd1e39ed9c94598029a44e97af903192e23cddeb53291e03a88b588b1a6e38d113335d0b9fba58c82105cc3c3f2911cfd9f5b8abe99dbb172e6c9a3ec0d6f17044381d3e6645895a743e1d6ee3929284bd22cb422c7e5564a044ca4eed01f3ca0b9cbf29cb0101ca5fa7a047906b24ffb773efef821cc54b2e48cd39dc105cd699119ad3b5eb77af707daa657f572ff3be71fabc3041fe54e20bee01dd41e7aba51fc9d4f2f98ddc3eedf93cf4e80af969ddf8f77edc014fc8d7310e3ae5d0a371dc515fad7f37fb2c75e6ff487ead369b8a57cdb87bb431db19fb310272c07636e9c4c4e8cbb271bb931a0f6b7b3b3d9b9c34eb97d88200e0abf5bba6e9094a739aa6bd0be10807cbce0c8b05c0370fcfa854ec1cd7afa92a2a8fe06980ab5ba8469a105ff32d9c4ed9042ee960db96bd13e057b7faae1921c7737a67e523f04170515ea40c29a4888716d43660e4962f66d590c3e60141321c3c5830ce9afd9f7801e82d6067969f7f57c6564fdf0be6deb8cfd0e32ca77184d5560c34b4fbc68586c9d3005a8bd90184a126715ac773ebb42074be93a5f28bea5189f736779c2876ce90aca5c7a675831bd0ee682672ec7f18a4dd3a8fdcd7e4c9d4d7b2d8ef9e6907ddcf9f1804d51530f62844cfc54baddfb580f9ea3e32a7dd22c83af67db6c5490538e754e78109e56648fabb4269a77d725758976b7527a14b2a2b32dd04c41c04b4ae0bdcbbdf207808ec8d114691502de9bd513606e31a7e54cfc58636e5a9eaf92d155fc74473dceac79728018e91b25aa4c0eb1da21973cc57bdccc2faa622724995a034aeccb5e7fcbd2fa78b29373c1844dc1c5054d6679fee25c60dcedb83f9709fef2da8ff33a429e1b230b06f75f613c0b8016aecd139c3c3bd8abffc5385ed8f8bad9293e3b6a6b69fc56a0f553c2b4c0cc08ff1c2db27d40bdf9b45435ab7652b539bc07fd7419e9742644f04a0ac92362191cbac2a1c07f2afccd7f5b55c94406e66466272331788065d82ee8d28e5210585b60956f6215bb6652ac20304d21348afae4a7a24320aff219a4f2dfe6c131f12d8147b09aa36b06c8afdc45c1603f61be2f625493549ef0971330e4ee6565302f0bbb08fe030739f71cbcff5dcefe77fb426ba7babe052ef86409e6af5cd25b7db53c538eb5044efdf8e3578091e87684cd3764a62845c63b8bb5b4578a5962caca8991b0fbeee30fd2b652f7c9709e772b843fd38165e9c3ca01b61d70e8fac8e8a73f64309c68a3e06b52135cbba9153b93d9662e01703497fe14607d4cd02fb2578023081862ce7e7a0e5a45d8e1b5abee3e4998030e69bb760fe7470e8b798fdce6c9f8e49e4e151c0d86dd9e26060be61521a8f49c2acff528cd756b918cb8db8825b4adaa106dfddbe1d2447c5c2600923bd65ab68e8eaa7f75458476135d2868752628ca21f9c62c044dada75e77535c413ce30969f396aaea0b6880ebb0389ccff76bc0372e0b177f58f6fcbc61665fa8dd759f458f12d0ecadbe7de34bec55fc87e5ffdc3ca66feadf5800440d41e6faa00f0de9d0529b0d2385bff503329875a065b7353bade9df61630812074968448ff6ec0c0ab674bcaaa0df4aa70322bd61aec952bdd4c5e37d25c9445f7e50adcee99f591d9f968749486633b518012d852a33076308f36d8d2e7093cee369a7fc5b2ef3c754d6f162c166e4d52fc663624f968aa7f9742e6b3d980f5b526e0ea81b077fbd594b511831fe469ceb278ce805826814baeec2dab5ec5a3c4651d85354fc494f30a2ddca31f01d39991db4a1ebe7fe11d69b20519415d3c18687b1818dfc20015e07d1d36fb594aa8b5edbec15db1e452a3e1d9311856e9f49fd7e9f5a4a6f3409fff55a9ef5325fbe127cf8eb9a40a243208defad4e444a1fe1bbe275e2a3cd9a92cced2b234aa33fa48901f64237143b7b6fbc2b37628bc181ccee2789d11afe231c68bc03815161d469949ca206e85fe3815a9ccbc19991e280343fc7eab8e8baf7142d14a446bc04c685e6062de5b04f1092c8b7e3cccb2137c934d8474523653a99a746544f40ea03e205b93d05b7cfc2464390a4d5e4927b159965f3e2d30dc5fe9011263b1958e3a6d7dd5030798b16100fbffd78feee5cf94308f80b73be4aa49037f12b62ea4e430ab47e1b1cd2a4fa451453db13d6cbb363b8f3e3c2fa12fc482d6f404def5624f96e1dc5410014a4c9666b324d939790f897a1f21064040fcc824ab4f7ad077aceb896f40565080e9f5a7a9318f05ebb3de4e495bfc4dfe9a82870f056cebbcc5a16a1c0a938a2713271bfc2701010d34df86ecd9537984f4d048e6b6fdb8d8db6d40f2da370f52c74c9dde181412e2165aa1528afd913bbc99b22dd7caa908b38fd774ea37c471c9bd7edc95463e29ad8cb37cfaa3ad8241e72321e8a544303fc712a5bc8bce56a6028b32ecbba52bfa2be582a4df790274b03aaa11c19680817b5497795c30da514d175f1602b5cd35650654fbacfe620a64e098c51d40773ffef78758d8ad82ac036b7fb36da536fe7ac7e0cf3277747f87138026767772c2e994c2fde6ae574965520412bc9df4d8355ba03a11a15860166449474a9f6944cc96f444463b69956adf4a084c01c76b10e258edbf58c286d16392fdf02d4deb1f77825efd530d91e148ca1a5ab61cbe1de5f1b28222fad20ab1f882cbcc00e6b020cb33622d9657f477509aabde2e6016faea799022c1dad8afa33cfbc0d516baaed3e07a655d169b22c4c2b3b8310c30f1737091e07e7b91c9ee837be524d8b5b97dee70b00ed71e20b5d433cc22440ac9bac0f1d74ce73e269622fd01b79f7fa782f5db40d888b695744b7776f44bb1b41db77b1fe5e780716760d49c2b77d38d8c4804a828399168edd3d7af2fdd546e6593f50d3564b39d96ea4115b1989e4aba4036ab116716064aa5d8e5acebadc7f04836837f0910b4b802df540cf3bcb1fcc40bde0cc253aced3bb541d538bc7fa3816892d72b569a36230856523f79061fe4a2a40b6ed035fbcc3ee122aeb29d2de7ec513d0451b96132dc184464e4e31377fb8dca96045b324f16bd36646411a8ae12224b5e5c56ca0cc5f20ea1aaa349524e0c2306b02135a9fec4fe7d146623ebff72e67029b9eb853ea441454addc1b569b1ada8c3cd781b0853df78b436b0bb2af2657f5413b793dcc2d0266a1fc56200a85c17a5f6cfef8fc7e1f907a14d868987e","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"3b65e88fb4aad2a4dfb95b4861d2091a"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
