<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"28fe6357371a66f895b687973f6ee22f9feb31da7dc2b44c18a0cbdae580f7db4b53ec6a12de315652e2cb6d298c2a5f86a786a255e1b8c3b1b25b1db4595383ddd70b429717e8e9f54ad9e8a26c28e1a3fd19f3d2d15a2a76539b88587fe3e1899df495e9ed33efa5deb69fccc61f25183d727b88992de1d66649fb04330785c769df0be3602424e467e1ccaa45bb2e76c3cbd4131aabc2cdcf8a74375362bde45b7c22b5fa90a5bcc2161713ddff6c7ad9fce428b81c610280985c5695e5cb6d61cb4ab4c6f4c2adb23d3390e22dd4fece5675e46a65847f20f9017167335a9c8fad647a5eea0be35d4fc1562e0002cfa35dede10c72b7e83da0db69cf5bed83d2c8bb4b3eedbd42c15842b3b8498c6ce434d0e3f853ad0f763b6e1a68324265ee90ac4119386d1ec799c133d166520c51a5e6616ab2b70c9b6306ee6e4f296d553a6ed83ff610965aefc95d3882d08bba3ed61f31c5883bf86c37451979ab2c344824492a63b8052e735730a3c2729f8410b929167386c16a6d031431f92490b6c685223558cbb6cf04cf9d00b4e2782f1c02a2c3a676ce0ddf718f146481dbe6930e4cafe8ea61c5d8ffcbaf0a4016fd75f9b9c9a42a5fc9b4d70ad6472c75858d4cb66eeab1952ce89f9c698ba20fb23a9d2568b2d62c171f1d5baa9b51ac25391c1838be0eabbab0b46c78cbf5a5429863637e5d76c63b60858a77bf208f9d15ee50f64ad4d3f5c08105afd0aa7e338b73197c1e275aaa2449948843ebddf83c3acf8cc34e909fd138cde26f8997a0cf9cf6ae1b205dfe2173e2409a426a92fdbad50451acd694eb6525a9f373a35bf96450c1ef5593acd7b1f470ae85c3e7795aa895c9b8cdd639685933364edd9530f168a797428f5d80eb1c2a20008118d8e7c7025f2f3aafa13370b594b63766ab757b551046d1568eedee6a964180843f843e102d4ad97421f63504187ac8b0eb322693f97a9183472de2342bc988c0a26c9832d56927d26289af9f072d2b732beedc5ee4c7b6dfa401abb42739eb1bc6814b708bc6ac0269fe1799d57b3cb2dfe16dca2ff38b268aa354ca5018cd7c3a218068e6fe53265506d2101f9e5e230e5ecdb74845576e2093caf1464a5d53df7a3266c7658f74bbeeb82db6733fdfd432c66eb189b09edb3f8a89f24ff5869b381e58d2b1341af9c2e4473050d28e9cd46cbc2c5f3819562a95c8bbe0b8bf9f6e0eda3abfc303cd750acb4165682096a47b4ab9ad063b1f5ba69d882fdf249af2e2ede94e040de6305529d6f09ba3db4b9878102efa3deb4b8d5d4896fdcf8256f918ee4e7056636fdb5b27741fd586cb678e353b1730dd2e231d7ec11845ef7b3a4f72293b0c821b31bf9eda62b5645d097327d2d113db9ec90d09af8a49809bced82334b2f8719049bc2cf0f1f6a10444dc8e624bd1354316cd91a48d68369a5d48ba0673b59094923fade055ba3054639790c0e02e57fe1b8e23c082015e6fc9fe88161897497a9be91ecd76e92cc2b3164b9285ca68fe782134e10a2a99c3e39c5fab0e766cdb07c7b3ec0234a6389029d02906598f76f96dc555e1a221f33317a4d2e0c80561623b32cfd668cd5412c0a2695454ae7a449496b198e0f51db17175543180d14486f44c193fe8bffd25148c92f25a1252d9f3059b397a557bfdd10360f9e7ba926aecd092e41498d2d1829893ddc593174961a45c1c2076d64d6ebe3f98722975bfc943343a955d96ecdedadbdf69eb39e5cdcd1a91b5b799b7698df076bc1e705810c20f5e74ab655481a5d457b60aa19eb80cc9223969e997dd5b89708269355e33825ba26e15ffd335f9096f616987ddd1d56b5aac09ffe4506abb9468544cc59d404d6d8d648c723070fc8de2c6bf7cd39e4bc933c85d7568f02c255c4aff6586dae8e957967a63656c31e4289a5d0c02de1ef039fbe6109d39a7adb05a07badeb91e6104bc0ab2a4960caa110116af1b330b3e4b40fef9501e31bebe3f639565e5b400d3a94192b1126a1a6d6fad4fea82128b525aa98741ad3fd7bce25881bbe38edf4fadcff2f74a2594e32e014483f2f955d99f7ef5a23061ae69f18e9c1e9753995ea0f7eb2042d7a65ccb7cd957d202eaa92f996e742772ead2f0b20f3ec4b99dc828848192ebe2f514fc2a91dc13389d1c0c79e80bfe450eed27c3f4122337fecb8712f5f5f4e1f42d0d88ed770b4c43480e37e310e96a66e02016b19856b3c7ad1dc1fbcf344c7111f1c4a609062c547c857cc7ed85c1eb4bccdd1f72fc5a99b5960e4ea8bdd85eea9248345e25d69af36bb46a6b90ab9fd188f8d411e641be29192796def2d88a6020304848c86a78fcd6ec374adac862689fb76ee0b20c005d7e23cc079d8e6b325318078b9df59f603f62135ff7c91792f78e4ee3d4ef38f03f90d10194e25da13ee9c4369c49155fef37f679e56b9ba6c77cb2642016c1e2e0575113149f17b19905d4121d8edbf124913a38adde4dda8cbbb529ed928a24ad2d8a5d6e1f5e14ce5f7215dc8714b2f9e4f2eb81274a51b5b9402a1065963562cd7aced6101097cabeedc04a5f31d127b957f726e17b42015b41a78cf6fb6e27667c0a524853e776abc0ee128b0c5e43fd2e7e07832b85c173bc37e14f1c8b7d8b1569030f9cfd10dbe74c74eb45ea9d4c99d02f582be0e4c3d255ba6c18d444e9e288cdda9b6514f9939a73ab5d00e347657756056161acbf37d69705657fef981ac5678a65c158055250827ac98aa99d7ba34b6bdc747298e5b5ab91a58e0bc307e2e9d60d90509caeb37d741d1aa82fb320d165ca0a2ec177b7dadd3af125dd18d1421d0fcb2d42314cdc9d6d3c00834dd47328597fd8be055699991cc5484b878b314724c7af0c528034648aac52dacc19c1bfccded8e657e6bf0478148a2df5ecdf849a432412eda88edb1b53651b8e0ed967a554e94a2bbecdc2880e6d87d4365aaaffcf38c808c127772f099b76ac3690d295c3cdd6b3e6c2b4f3d35a6e5534aea4e3e4faefe9a6bc8822e6d7157667e99bfe8632ed4b07371ed57d451206d6e9d2c4b1ce97b84082f00a70e0f7322cbf01bb4a57aa89b22fe94eaad36c59db42d4f80746c76dab46d2f15d7c41f4cdbbf8f69be7d408f018d469c6759c11a939533bcd4ba3bd9cfe258e0f8103111f15fe622562b6a888a0688964bc92752d1526dcc6dc6063b83cf73d90df677b3ff67cc1712f6b06000c216c7a3c59cfb5c8f43c8a6baacd00b271670d1669750b68a11b3458017edcbf8bab8917abdbc52eab25af584c8dffe361dbd94ac512490a317a93e299b59bd38e608750db79cccefa15631e0b44c1712f240fdc8c4bdbfcc6d1f14e88f17edd6fdfe4d83fb642841b471a63189d94fd67c24dcd640f0439007226ed7a76de5c4fe8d114a7c5c835c6b61c340cd7c115053bc4bfeab8e57b9e21e27924bb9a508b9e2c9738320a0e0cacc0c47632eff3e060b84ddd3c5609c0b6ffe79e3e4d9f01f12ac936c4b7c72a490268598781e3c1f0969e35cd08900eb264ab721dfe1e8ca87284591cad4c541361f0369bdbb6938e13a469623ec421c0193a6ccb24219b0c84cf58c2cbc3266e45dd94d26ae6150471c8ee13ee803dcc88f1653ef87bc5080b988898dfdee2a8af512634f0e16c3ffdcdca46531d0c5817a431bae0f6ac7b5068a76cc739e66ef7eaafb1690d16cb07ec354cbdb9f2ac5921a52a2ab5dcf0f0bf6fc5c908e097a793252740393da02264f42cc51bb4615fb744f1da310a537989d7050a08bfa4c3994bb35ddf02d235bb6eea03799001630b6947dafd1e88a1c525ba4e95081ea6bbb6ba0f47dcc1713f0ab8f0043d1345ddf85edd5d7dcfb06389f35aa6808f64251d1d7d27d2723ba2a62958459672c20e8cddaf7613aa4c4629df277e5ee694650766e1f24fac43a1d52ec01b9859ac3eab440f36577f9c39b35630daa371d56ccaf7c19c42604518e4b6843e2753694691be5a62ce19fc2c913c53f02ddcfd55fc313350f19567085efcc11a5cb841b23e0dbc1cfd521aba8c8f61d0e3ba340cec4e62bec25d0081ec434261cd6b158f2cac2fb09d5d64881b40310b98e0951afb16d280ea677ba8816819ddef24e7c09358018933e6473850e29e48f7aab335510b8d67b61a2f53f682e84a67033ef3012763557f8d548056bb398244fa57e0291ca8ad55ca0e63479de9e238f5ccee959b4ef4924da66399410d3409429388df6bfb5989f6b161d843ad1ab11f58e270bb503407c696052a9f0e3b36873f28b0edb5f9124e3fb9f6d4435a1e85c130c56d0efbb7260979ec77a90cd24ed1fe8936526e427d11574b9d61e1aaf10c867231daa9f1b9d1ad7d035889d304d50e0a0aea6481ca88d4eb7c40ad8798db3b35c3c5cc29276aef66436de08abcc086da7af8263658529ab00548c28484355b4896e11ff7bffbe0bc92209f47eff1cc34690ae3f713ee6bb8fecbe79a98e63b2f0cb841ecef5462130ff86c79a9944357292ca6f33cd9d8a66fc01b0f63515606baf1aa6f1409c96e991de7df60ca113b246b3dc42f1edde90adfce8153b86829b6f0c3265ca7a1eb4f367aa0ff75ad7f8df9ec0e7665ad0332ad9275e39d99927fca3a9fed3278b1dc890ac5d0cb902159bec88ab34f88850e1c2cb7abe3881fd87ee06004c851fb132dcf85a483b01fe212b9d5f92dd7ed7b18a756dcd2f767ae8cf37e3a83171bbaaa2bd30bd90c47352f24c34175e11a6925cad53a4b8af59e20cf933d0bbca7e7ec9ab8c45ed8f6fc8219f91a4149863663da86557f00604bafe5640964d0d73de4136f9c357e588980de9089b5252c779106e8af7fdbad69c898edb33e7a10820fe6aad742c7b5e465e8406265516f2df9873d233d7c8b75364f2f1dfb67cb379ddf84072da547f692b5c8cd51983aec4bdc22fed9ecaeba01e92bc83982ce0babfdcd27478d0437644028b1e1f10da88c5fd6c0476ebb178d4831910e1410cb5e8db35f2201a7bfa78a91ca8e065775d78aa716e9915f292759e3e6093e8734ad223430609d0c4443ec3e09ce8253dd8d9f459b38437c3d1a1e372a1ac9bd991fedab997f60b9eb4cfab9e75f66e001dcd501fdb24b2a275356f0f0dc0a8fc20002e6702b34ee714c6a26ae486906c0a58253e9d53d5b58881e0fbb540ae6d1177b0f00d20259b31edded35c9e964ce00c28adc40d97cf09b6386b9f2f7dc0b89b82e685c918aa7d53f6260f07809b54e1febac65db75cb80e4a1fcb8e21ebcbd3781076add0826f274a27f2f8d3201e48f153f3899e31da7a5b38ef51934271a25d20547601265fb9f1ab1481419c77dc10ca5a43f66b87d632ae8e2c7b0b044e156b3597202484e020a85bddfc6b57f153dfed043443dd421bc3aa1865eb29aa0ab3b6d36b0fc302b69ac868d15a90c7113efd2b63d6d257cda847846ef2d6857091fa388211bb8c673b25f2358f379ddc5a0aaf2a0fc14ef0e4ff559eeebeedb79d9682e4db2d8687b025d5065a4c666cb40d89560d8379d71a4beb7bf675404f508c259c38fb69b5744febd50a9152513f600eaa31ce20f7aaed1d55e24c85370738f568589a8a934e1f8ef2785d7566f2103d5696bdb77bfc98513a21b4566cdf4c4890489d4cb05b0c79e0e61c3726f83c471e59cf30f0e2e2e41df1b538ee1c080d2ffa84b910cbf99d0bfec48c45d8e4e11604901d6b5e5af8c2404a85e68c6f6a29efaff24cc441372850fe285fef1359dac5009f12aaf060159486ef3de14e21074985d6233175ed406484c48b033eb246d2d62f7f54c066c8edf5a51eb8881b13ad681fb2ac92b67192b6e071cddefb9c48a1fd6036866306c67bc7927a8bb69f2240d161d5e0b604701a612c27dbc2878d4337370d2feda072cadb4601f5ccd7c6201b21395b16c5c3c1547cb1d1b0811e0ecae1eb4ea4663320bbc62448744d1e405c1a9b9614888a85cad74712910e2161f23d6b5bd33616f7056a13f9fba4c34b828a307b9c7dbd03c81d6ff52162060e22a98ecedada4ca580fe8c83448027bcdc34537d3f0490934763093a8a95fbef0094f9156950487bde5c6ab3c1672d89576396476f0d87a2606c60e72c41eea754aa1ab26815da54e11a81a8a052c57c00642c979fe6e22a640d7fb4c150fd009db66866af5173ec51a5bf6afdcb85244cd2c3c3931c5266213ab7607dc523f43a445f1aa26a9dc0b49d81db1a64bb06c22d6cc59c6fd5c9d50ea92312233ea6c1f95efaa569212a15193e07a6e8e835f7bee0d48a9383204b4a71841cb7194d158712d0e2c625d1fb6ab70d0a1916f518ecae9f2d56beae34b0ccd2f48132135d3cc85bd078f7a3188f25487d179c49532c8c61490997019db8fa04bec7898654f425a9dd64acd4f1f64836725bdc298e549839f970e2ab4873bc4c284825e4f7f286d44a33f73a2e1355ac4b19ff04f6b02b5b9a14a647e027f3ee0b788bbca42868b6fcb7eeaa97d5b54ecab41bc3eb071f0c5ae67d6dbec84ac8b06a4223a4beaf62b16d15c49a28efa14a82a7b645cc7db741238a8216ea064c5b17b100905b84fa6206df98fd71cecf1177adb08162da6a7bcf12018d88fc2694a0629fe63b43f54e8f1acac86142d959303f978bb52bd2a7547f424d347b228172db6ea79d17da2530c00bcb97cccd1737ad2fbef1e9045a2b659fd9dac7370dceaab4c4e6bd4a16b87ef4fda6b370941dde65d77d628b7ee8192595da3049558850cab1119ff88929466a535561eb8a346cc3a050c47135ad54f62be66c453e402558b79951a54ecac548ac005b2d3a848d4c85213e87653b6b933f5aa601e6159b90a73c89b9baa26eaad4f499ece7be4aefd1b569a7c5426a041a955f2cec02e917fa7651351a17f7c6b0dd099dc56fcdfe8b31acbc7f5bdca5c906c73eec6ad149f571a6776d2bad34f515d5d78b8a5bd102636378b24ff952cb2cc1c4f3cf8c6cf783159e5bb1cdab44bb11314387a3e3de935a4b1efa9aeec5b229b83f15236486f62288a11009a3907262f5eaf68bd052e3c00c44bbbb3bc9fa697a7f9fcf0b4989b0976b3ff399e9a6c097a678441439d9cdf67300d89008259acbbdcc2ef1d6ff48f83f5ec608c66fa4f91c41a748614a7ad9d95fc1134d5b06a3a88f1e623371ecf7a64a8d8cab7ce3d6080d68838011edc0e0160c232632e55fc8f8dd1d75fdfe8eff955dfe4ebdb4a748058d3e493e41fbf68f1788a81d1bd75720870c3d02fa43717db421905daa61d2a62c2014679c9aefe502026e3f3bd0ee65232cfe6f2889d454a46392a380cbf8ed4b6b6b2aa9baaa3e5b7dd948f487e48354c7f0aa51bb6df6e0b0a284590d4d3669497f25326b79d4dba3b1b42589049a05a47126dfc8e081a3e05b3f1c660a6c038e231c9ddd6945f03b67fa21b9b76a98b56b7a493e51d1b169a7ea620d9c26ec2e7e2f00f98320aa6f5f24a4f11ed36b980209ddcf939687091a9a2d99a7a0bfd0837f6e84b49ce375849dab5c1acffe684c1bb3a1d2e1a6fb829f04460065facf27bbb30e746d52f46e393c9936bb843c0a891448d6e5443fcbd9eff321fdc2a26543d7b1e83841beec34ba6c7919934af77aff44bde307ed04abe4c4a14d35280cde0ca38c65dd79a2bb8c84b141e8703d54473b9c349cfc4717cc05f93b94cd6a737b3b39a4c83dd22444966751778c727d3e74698469a2dafcff43e93ee6ae696adf2513e466658ca5b0e3f16def60402fe815688426e8bccbda1f99f02808aba9bc2131970671cc5eb83355890e6a180d3d0ed163876ee1be16aaf79610fcea78f7874950128e584072f81d7bb008a31c10ecff65bee028d6e8250751c7444b140ddbd5b27f49f446069d4cbb29de88a33880f045b785c533d07a352c45f79d0cd2963fe971125336400e6b704bb18f5bfc2319c3207fa8aba3577dba5082894e4542a0ee18755b1ed4861fb44ef89cb963cfb62a61e44ef16c91f056456ce6de72be30b2a959f55f22f163fd1bd304c989898fcba5caaa3dd3e52077af0bc3a0b0d23e87654472400656ccdf0dd5d8632aeb80f2c57bf28dcfc62d31c3b50896621036ba6f1c56629b5a32373557e7dd91b9e6d8fc5af7642f74691089ecf29db9287102354b4eff5b94646465e74b29954816c8cd4c9d01b6cc2f141d552ee1ab1f460e3688e7bc1281716bae95731a01c5c5e1cc3153addc0d5ce37e3cd64f1aa4201d2e2e4862c6c6fc0f220e9a4562a5d26fb90744b2dabb04605f78e9dd7cdbb50e1eac73684a7a5b185bc5f4579c5767e99b4c1754197e3d2ef546bb1f78b6a59c312aea1df89bdb7a9177dc35b6573739a258e55cdf914f66ee6f5a36031a9c53a7cb7f96102ba815ffa36e81c0afc7a960704aac9d8016ce32e6fb7318ac4d069c94b359f9432e9c71faf77b3cd87db11cee33a09a2dd807eae40d6ec72bbccf67e9f88088b180827ddb47ac5e5ab1d9d42547cfd6654a8f5bcd8f48df3f48f3cc880618b2416f1759afce2317dc7cff7a3dd08ada022fa71883cacfaa95f66741d4fd78d835c597f2174ef5cea3387bfec1cfc5b1bdce41b246039277b6bab2a1cb9543914102f5520fbca1fb6348122adcc41462c741af18bac86c7aad0b9ec6d4848d267db0248fda1674f715f3e377c630fe6e7ef4973f4453b884c9bd2259dff7bba7a27c6c9466585ee977f8cb1caa27ee7be70d987fec107b0f9bda690b866001c4f0ac041047f580c7c7ef54dedc777abcffa15012d7529436afcd9423b1b895fe31e916b8d6f5f5acbc57097cecd5ba714645ebbf2cfe4b4595e5353f65d0c450b0d060bf44172f801a3266afc3fa64be3e8cd847e06fa14aa7419a97fa137451aa8ec5239647278fed6c343dd3efd99ca0b37cea9af9dd1e16efc4f428fcb8480cddbf335a98883b87f69cb6118ce03964149a3d42aaaf66093e00695db5ad95db7faf9b80554de59529b70794b831420ef46306162f5d801c5b65fa6d545fcbb2313e1e213c14f418dfc450f016dafb52c9ffe0e61f06697e41941a61f09818c65224602d3ad6eeb21b3d34f6c6add16cc16e2e192ed77af5f2a27ba0a30b2f80f4553c31786b3585753e3498cd27953dd37793f267770dc99c5506d9888a3699d09cba71e5cabf7e7a87a6a4e85bfbffeb544c6a6d8ffa9e6fea919385800c9b3802bc11d7f6e3a95ff6b2fcb218509f7fab3793496eb9e590efc5971d48dd00c27b6d49f90c9b5c3518c92f25911aab6f72aa4c15b41a11099d660403b396531fdb3d6b22639e2cdeda013b3cdffa58afd7e3ea36536cdf32fa15b86934a7b4d4376e5925acbd450f5e2dd063e0e31ec9bb9c580cce8b090a0fbd2651a49adcdb20c1be26b2f80ed773d47f31090cc2b1f8fa8c6b905fa327ab6916bcc5a2419a06e87ea729f25f29aaa779791e2137bf28ef8737710bf605125d626fc377e571d86eac5e1a3683e819a77838154a5e6be073ce87202ddcee58adcd1d1f89f4f97aa5d6ba58ec50a3b069439084a0418c445f64baa0f17be7e8dd859dd2b172716155b88a7d4b436c707b1a9a82c8a72926c3635804ce420f3fd1ade0fe2d01c0f6a649c0d48d0084a497308bbbb8fd7fec122198abedf62426724780e1ac362877bc4e1d3b7f800c003961c69f23f97f22e68135fb85c9621e2e7ead09b2aaa3f37a988770ec5a7592f494c30f21608f128a51bd959f80a8dd650fd5f5df7dfe9b9f05328148eb0720e05bfdc07ce76d2dd5e163e3aa54f0c3226f20afa8ded7a537566200171d4164b34e227a75c82fdeabb9f22a893ef01a0f111186134dfae095a90fef97da0d0f8f8f72e787fd13a9d859c16b19c8f676a97f92d61c1508a091a4308fcb902d729ce8e0f926a79c389d18edab34b792960f43952a81a8ba3dea210e54d277feed5b65bd79f483a6d9f09bce6a73e583739d7efceecfa3ba4ca4f1209a7f8749649f636319c0194c842b25611c832ce067c278ba4b22c4ddf3ae6c4798bf833be0781b6a967e4d3b11af3a1475743319d2f29d087b38f567991c948926cdfbc416dbbf4e43163e3d9056a3dc52d8a584a927cb3238d7fde3d35e6d68bf0e2b1ee36a6ffcaa3a8757e8f23f5d66dc20183fd5a118921c42510b2db35b20e5d2df209db13916f4d30b8a118df8526881d47a6c39f7799700e178d0db7d401e9a4eace8c89037707999058a946756e475a3910f88555ce8aff07e7182c04ddf1b2320ab60524332f22075f92c062538f9dff66fafca791da718e4f89d676d08e4a29f31581d988daeebbe04228b52de08950339f2f9beb6df0a40dfef717e3bbc82817151ec2c64572a138a041feccb5bf65e715b43791ec1a9019871443711cfa158790e528621544e9d65228632db2270de0b784d9cef1be366bbedb93d433850b4c323ae85dff80338c4a119a9f475efb4bc1778851ab0636058fb52c830ad296f9b50dafb5877f2ac01a35898c50dcc33fc390573252a5408f85cfa82c54edea35a2000c8c039bba32c1e4432bf03eb7c6b3872b5217150499d3c4e56151ccd5035993f7beffcf92524056db5ad18fef4205fc7e79bb7cc6760e6933e6338e44d41d527743fd71447a0fb3f12c17fb9e2e9df66cff46ef39b1d5be71d8893d26424c499a0be1ac6b4edfc89fe1f14764b3bb7b5885cc65597825ca32d1eed12f8dddf2182bcdd69bf4f9a470d8de5d60fb7e004e249f218b9a324fa73a8286862ea335193325b49365f607515b831ffb5fb1ffea0392d404ce650ffe751a516fad981659192607855938c9cbc7846779891c3df80a43c172de8e47ce7860403b66f93714bf271db405323947331c5b087ca91f1207cceccf5f7b54825c9d0d487740084bfdfccbcbbdcc25b47c54286d55808bc850b9c024c488302df1796b7bfe5e81d2f7e04f7ae8e06ce3f9a56e76cb7a44d0580e7d27471726ed5c003816748d2df1170aa5327c1e11f799c64dc39b25a2e88fdef1a7cce5db9894a6351d0c930e60f47773b01421eb7c65000e1bd05762927f7efca223e41c2c7c12a46d9ccffb83bd6ff9603e4e3528f214a3f5a311715664b78c0eac64ffd7153def0b5589e35b1b501e69508689efce1e83b8a72e74e81cf7fb3e494f9b077fd53d9d3cbd60463705fb05bffef647b822e2b8071ff59c183fe3bb4df0a87bd25acda47ab88a43fb18adaf18dbe0301c4351762bf69fa745a8d82bf38b2e4e0fe2300f8d41429484b18dc8a52234d668f864be7fee098b501cc57921f71e5b632f2fb5d540eefa13bbd7a73c219ba51154f638bcfa19851ce7f66a20412e7e61d126d4bc73c703d60afcd99c0fbf61f32ae6c18e829e5dc869d7809f838744c6430a18a56749277fb9fbe5dadb253848d3c91e675666c4198b492da9a8255a46beef14038e1fe2a0b3a79ae296ad7a695797053191a2ced7adf50f87718f4007ce3f5fc2a2e25d01db425065e8f42288939233d14d530ffcc3cdc4f28b6a378569fe304faefaf20ab668c168028f076b17d6a03786194ad8b0afc26d0a67855bcd5b71a24ee13d888637e3bee189192b44aa0e5af15563768c11774aa03d7368f0ccd0c4394c2a5f72576d4e321d0dcac8ea2a8c6a003e7dcb3511ef668d6712887e20dae54177e13d452fd7e7df056dca987704de1127345d17613ae66390cda4cb63e3bdd27a7f4c7d7e651925b916c0afe32f55b0682781063b684f17b7d1150f42b7f4e6dfbedae469a61ed5bdfd900568c6a6c6c8f261ac209b67000c77ce1d9f18c12931e722b731819ab009c5b0a68afb2e5313ab9c3780a1a7ee5de929f97aee1792eff554f7f529e697e79f5f8f9123d57d8f515179465bb9226ed6003604f7bf2d93ab522d33b4c3b9f4a07387b4427dee534b1ca70d3e70155b821349a5d07faf409e95db4a3be32c3ee02f57b74a9b6f6287ae978ab1c0c4d163b5b59789ddc4e030a71a8277a0972d0a6aea2452b282035703bee59afb6ac29905c9ddf3991d32fd811ed367f2105ccff5268b5fed8c251fcd4b5e9cfa65acd14666db663c91327c2c6e0f3b7897684bf44f2971322b17e406b449ee5eb9701ea1a64a1eb7bc585d455b9fd60cce4ff5edc4f737d3898e598b9a28b1e8007e32acde1667380ee9e5a6310b074c75b3978dc530b3798e8c3a0e3bca8b4f3309531b6fa8a824f00efd08a80f2a5ce3d1eb4fd66dc419c2e2df978422e1fa2c652c248c70d4dc0c0fc927dde24a1ee4dd7449908d9bfc5c02c633cd2614a9a5cf0cf97875fd98a35cd05c6295f62d1fa3f1d599f4a59db339ddc8b47dfee42bb274c2db8e588853cf2b6b9122b4c70dfb5fe0bff4fd7bf2c68df39ac06f72a0bc87bcbbea7ae406c28522002a1c7e164a602fa38d5262840b8d3891cf9ac2c5e7a5b7532c2275681c373bd4d2373a1ad05228fccc75d26425218fc977154e7c117680157eac9c0982e95f35108e65c465b0592871059d158253874e034005cdeb3e95804a73bcc6b817e64abac2bda66679b25a5bc0fbc3de6f60e7fa4890fcf08a0a41a2727bd3ea21b61a821efac707838da38c3fd80f6b995ef4a07727673b3fd11d594f1f60a58bee7f7450a645af2ad3febd1f5c64c52d98d03017affe2db82aa79a49f830830a41f63ee9b8ecadc4511214150ee0c1c80f44f3980968d690fd42d80536e9d8a97cc1739dafb23b9530ef2dc299a252f6f5040516249f4695b668665536c742e010206e07d81fdfe0e6c0fbc46733d5c7a80ecfa73186c7434c8bc6f707307b5d073ed4cd47636a622f7a325284043c95257c206eb26c5b93839060a810e85c8bbaac9906ad54b88f1ea5ece969f83873d24e2fdc029941091a8f5929e6ca607045792b6ceab6e1c8f6abdb4e396a627eee349f2adbcac48399b246c4b3993cec8aa0a27f9f368ad2165e9e85ae670962768ae47bd26e5f8110e139e31afd3648b2fac09c7370f4b99cbacf264da6b1500e9afce2f8a29ef7dc003e3339532b64498733ce6b71240ddbcb5ff913d0a4a609131c402cf0a70c40a32b8bbf97c9a1f9721222eb20f189b23feda468b1d58f7d7828c0e07c775454df95a3a07cd4271a971f4d8877d60af286ed2149642321cffa4215f285358111e2157f288c0899c33a5fc0245e686377e97f8c9673889d35ed9930d41370d4c82aee39924ec8cea779cc13f8865f1f10850c9f2b461da0145ac49280fdec460fabdf6b11c693e463ee85ab374e9c01ea6ffce02b057b57596ff0064a62ce0a3404d61980c79ef1b4b76020dd389e9220a12a5dacf55938f6a3df7e10a73c6f9172fbb72cde656dd46345536aeacec10e28bc5a7186c9e207f1ca64280dcdcfa4d2611b43a823af2999e2dd17acab50cfa76dfcc12914a4a2583e58d53340ba4bd3548f5644d5741d5aab63beb1b97c9144c13c2a319208c770551fc74645ba895a083692b24e49faff114126ffe5d1797ddc878edef3a90e744f96e02cf7feda42b87f64e0dcfe89d0c29bc093986ed823718a06f25bb7cfd4a88359bad3fa78cd33ed2c926da021ba0a0d07d73860989f6de2c6339b4127158f3632161af2c0c42ae31dc19bdaa3aaaaab3c23ddeabe58924630f55c8b5ae56b448217eddd4894d1b227007903f9725fbebab7bd93d2cc6552a0361c0b09f46174a08b2659e3dece25af06f4fb45a03b94f4e19026c4df105207566016d71f7aed6479879c03dc77ded75e70420919a5b84f01a7f1c943970f185b35a10eabc241ebea925148426281c420e99138fd6b64d1786e9b6aec5c10efcecce2a310ab3f4fad906d46137be47a2662aca095d434b91b168ae660c3e6caa6efeb626762314f6ba9da2c1c9a583c86fc369d0f2a1fd10d5e4600e975b3145ccbfb3ed5e8486d6cc2078862accdaa2128573bc6a26a34e52dffa9f7cef9906e76fec178ea217b58659476221087eab58794a3ccaa73200b5a28324cf8975ca47c0f339ff7fb95ec0e494eb2807a1fa9551f78892c04897a9e28bc1e5cdbe8e866188116b1126575109a8cfce42361dad1ebb9c8bb0278cb6f793e1101ba793d8a31ea86dbf5a7a42b4ed14639876a9f8767aaff8c2a49f1e728af34b005656166e77d5947a812d26516d9dd947de883d06c7673db3c63c03e6827a9694ecbfc72c027caa9de026c4efe905d5df128bca8e7b295b2ce920f00f344c9667daf69f88ba286fe57e771558f87246215c064cc7a9838e6052ae2b729317031aec163e2e4621f1fd1f415beba8c8f37e5efe4688e8610e9e9e1703e5f5e99b3ab36a253727bdc1662e83d0ef0a98e1c458fc86f85f5f2742ab3ff706d72f89e980d7b86ccbef0508c6047ada21b82b69f08c854aba9c1ef3ea108e13616c843b4cdcb8fa31aae64b87f1f5821a255b17ff828081686f9b2155d9dbd13194f9512a54bbe8b8041af7f6aea9195a03fde2abab2476de44771acc6e336da04da4282ec7455a6a8972dcbb10507ac3d7104011df10c01520277552b0addf31eba43a9c2e290caabc6a00b9c67ca6d0ad1589816b7f30391573bdde169ec2fd0a39f4a9483772b4bcb9c19615541f2aae69bbec6870193322d5d21f8b3b4db06991f00e6261b305287c4fd35723febb70466e13833afdbecd3b54de70b16e4d5df7951ee67f172fea64e0cd6f31dacfdc1436abfbe31045520aa156b9b7a8c1ff853175e70007d6dba9d8636a6bada90de0609e35eb87e29ce6ad3603fcf62fad0dbda9bd1c4a927fc92212944991910731a987d4a69cac1659c89a331588ea71cf6fced1afcc414f3d02169552864403558020a16ff29935c9dfbe80af97cce9513818139004a6f33c5df7190a80b416bae830f2dfcce67dcc8e850d85b64fd1ba1ee961f50dca9d7dc13173fb623c04abfc8a7d49b8b6c35ee786cae67f62f3ce666b68923e9eeb60f8bc10e22bd68eff9ecbe0a6ecda6e6351fe1169d745ffa14e797010aa6cdcfb139fc89311725439ccdf7a1666b4b94bccdd1dc37959712175ccc82d3f9e3ae0ceafe7bb00c7fef39da03193d7c478940318ecf2adfed09dd77ebd64b9a8242342a52dde7c7d88cce713e6b6d1a4b476b397889ad2d6059b1284073ed05f584aa2690ba78406b9925d3e610d18b1c849011fe980a9242ce9067aa5ea3c932ae4c3c30560bb8a02dcd73d6c04ca007bc1bdb3cd16809da2be995656e309cb754a7d68d0c1528e0ce1a5d0776ef5a916b8726b18932783c34a565b3720befb8298cad70bc19add099d2119afb8441f3d653ce795e875c34cad6cb35d1139ea495ce6bebd5db6876bf1042ebf733f4171af3dddd5cc5ae39c100f776f9e29283930b29ba521e37cefa4a59ba6601c49110341cd89c9b1c28f3ef461fe43d3866e86f2f2a992d1c767774c92723318777e99f49a3cc29140e350b5e1191b8105193615e73af0d6baa22ed31bbc494c449c2e68aa48d49fbdd3c4e1d80327271f5da54310eaa73ef6d3c1b3f63b7426721f65d92d02904f0742d140da7528939f849331f294eeb66a573b0cce5dd1e0963450040a773da7d4963f01dcbac4ea65006e79c8677553c774aef2e4c0a3b5eb13f437baf82a80e9def651dddddf98ae5f27534c0f2d2b3f1e2b60b505ee633b29b27851f972c3d4b8f408870178d95ac803c858cc12c4244213477b42f4508f504ce1de1925b065e9ac8529d2630985cd48246e7cc85b3f1f8189d8591649c41d73d63a17fdeb9368bfbcf9b2a4089c5a649af581f0fdc35a6f351447760e2ac5a9b4af6dd4b87290b6e1890fa5408e5cd678cb4771d7b930683180c52943ff8f232fb2f8c035a9d51eaf6a1dbd5d9aa47e48300d8a47e7e9b4394b1fe5ff5798ac9086f2b3d22c86579a9305e2d49e1642d2edba1c644368c053ed0a9e6703f4646bf0084524f389137bb66a36ce79c7ec545d4435a64202fdb7777e9c7336dd6ee9adb35497c71406cde4b6fb592e880926f7469016fffa55cf0f044b2194328f7c7ccfacc81903813ece6860d1a0a4f621a0baf3c2305ad14d201782318d66053e7f96e9c1c72531338630c7ab55f2feb70aabd1f6860c24d90d8afa58ff5affae22c2b241394075f67cd5bedad7911ba42ade7b35c5b76f6b60faeef87944a53a7a4b128ec8e9ec752e4739b98ea6fdfcdda7ee10b46fe51640c702ee3bb710b316abb68173e4e9d721870c48b310ef09746c8f0a36b07d912e77eaff531bf64acdbf085ae9c7be4c9a26172a11f33246d2894b1617e0c9e5a02295456e586eb2baffa1de699ee3f137084958f9144040e3fb28962a5672c9739ccded9c09f21a91c023f1aaf8a50820a91b4a8b95a2d835f1e5a54c857a512b833653c5b090d6400bf012a97c6d30944eea33f298545140b7da278b6d795c37c93c3bd31e4e79d6fcb6e0c87e0a79c5929a1b31eccb11ee222c96df87bb25d09c57b81bfeaf595fb92d854f257f92f61ef838766b069a22af5308e97fe1765c2df70b9484866614df336e8557090f60dddb892de048654b88de1d3cb48cdb9516ab7d676836dc45d4ab4206a0200f977097f941b5ffc83124676d491b6466a974296747200299da806ee302484ae948400831522442b6f78d2052e82c17abd1218aab63398ed98a5121b897709b7aa8dbed61ac099d282f3e341ab064a6e2575196433d53ed3332e40c94e","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"a04e2aebb4f065114c065b7fbf49759e"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
