<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"dc6ecfca8d7b0910eaadfa73833e17008204085d63775e077387cb94e9f04685a2d6b782d311248125800da3b90f6e44633dc1b545435c565840314fb613c4e4759d75bbf3adee66f1e0dd8140ec59fc62f65073c41d7fef4c645f23ab43df2d1dce65f52b503fb75cde4cfa3de258bf858f2f591a8c45a08372565c77a2aaaf9fb0ebe31a66e7ee9e28394100da8e5bd49c39ca60df1490799ad87d2ef374900314013b894bc5d12045328f247e085fe2c4a95982a8450640f8607a3002ab9c63601dbd9e38124759fc65d97ced166497f1683fdb23144c8ea2cc6d8966c50d820614fef13c833829f46e29181502715061ccd65a33572e76da4345186731ab20be239e11d96ca1c46de426aaee9d552b6fdc9a05ac5636af3483be3750f884c0ff254bf797b533bf1d8e2db1d6f895116b42f57a1fc1d6e927488fedf8a0d5d877c4c98b252dc422cb51dc86dee4c6593d96837df7dc409468d0ccfc8edcaf8722c0c9bb476c43e50e9ae74a67c5a2e53efee5bfb20cae3cdf744b438484200cdec756242f6e10912c21f0804f21b6c525680385f81f420cf46a7b0f00aef0f3d26c3832e48b38ac40a5b76f2a357765cdb1c9c23f3c8c46791635121cadf87e9731f5704fbe5ef5033a496164bf6b119e041685071d7794b0cf40cb4d2d69e5427a1b2dd9389ed21397699fba8818e6fc328e20bb68c1b0d93213f413c520af447be9606fc7a3b471ffee87ae98a102fa6fd4dd89ea5cb2f80055e50a979c45bb001acbf95966f58ddaa11dac97bd67e8ef8598a2b138118d400102cb28374c77a57a33217eacdc1c871bc03df15e6d75677c4db0997a618ea2b605b2d82d58396b3c94091e479d4cf2bdf24254d152c3228fd7dfa66634e8c117de86e8ec87efc45299e321bcdbb8de7144a2c905e78d9b98fa5e6b8e1fa87d1b0f82561d0c50a1662139296bb21848b02dde1b5042fa58df708ec3e6247d55302296083a3d51d287f88ad02a05dce096afb1311dbd7c2d1d76aae7527cd3ecc769bba09b83fdf9f250f1ef37f50d190d72c9d7c15d7564abda5d6bc688ca2f000758ae1c77636d353a954e231c5cc166bb051ef7c727a32f88cd5d013290c6b652911259b6e72ec7545b043c5dc7a192c269e60fef01979c433259e440e59b9220aaa61f782a9dc0ed7f33a80dc584cce4af654e410b4b7f894e32ffd1fab5e546b617077da514338cfaff58e03f7e9ff9005fa6804eea1e788365ef9382ab7bc3b7c7ecd9ed13a4df985c4264d5752c85a256a04443269e93627b7cf2c5b6a9b5b7ea6369be86b5dccd5aaa720f83c3b614952e37232ff3899db5f61e361e2d1a71ab021bc1d1db51824c37d7c8bca3631b527b88ecc95b5b3f62f0632892c2c90e6229495f75dec1062b0995406508e259d7556fc9dfd77d508f10ad7e799267015568d0de2a327558a3f56b19f03d30ffc271e989343356ceea9a07c1e194cde9821d89a20dc4eb5e95a054848dcf0cb39648eff98b709b9c5cfdec18d0c7bd24998a15e5d91ce695a70990bb3bb5ba52108befe13f4bffbfc5d885c66f69a00c586e237e4ad364e9d9a6eb7e830c0a35744c40db7ed27e87d6bb6d1a46656cc7808cfb37882caefa6da9286502a17fde468a7216212b4b658bbd1c7b6329cbe387939c98e640db2190e705873afab42bfc61cca8d00b791b17a3cf93e242713a3a8333d6508f2e8819f8ace9548b6b1d65a7ea8f44484689aaa50b373a8f5d479846ef700f581562f53f657bf54ffa36568db604dbe680bd342481192599fdba422c04e79a7da20042d6a9df07b5b7970dbce41345596d1c25b94d0319473026a1f5fb2de3702404d65fb5fc5d47453cfac752e4818c107e8e553508316318032d968c581d0791d07cd1115cd1cbe0f22561fc6010a6ee1ccc4e863de7cc7de85b4203f460dc978f3f2b1b897bf85e8923dbabd87caef13e38af105befe924aab0e65cce4537730116459c9d8bca8e024e17e7532e1c055509b702996e270412c747fe0d82eddc26df7b4c173c0fee0f39938e57cab8de0914b6b68f69f40406ae7476a740a0c26b6c5cdc8f2934d5a71199faf1ede3e6068ec99a7dc3661aaa635b58f183d5cc5f2b43c81f5c349acf9afb28551707cb5fbad23ef460bfc270676ce6061d7c32ac6394620de7d78c4a080c3c3df9a7b4c9bd550b480c552e0005dce9106d818fcf2b325bed3d60398059f996df962dae01e63321eb583a886a1e6ac1500e6691e4a94e256973b4cde38aed7838a294da53f3e000db6c4b4f38432dcdfd0c02e1866be6efaacbf7e5102bda679a2106193bfbc2311ec5f32bc6148c0bf3bb62ad45dadf4be195b45f87c8f9f4292945fe819992ea331144b8e82d1a18f5ad28ea08ef00f37d9525103832ab302c8c493802db6d077f01112d56d91d207e61876752c27011f74dfd86c78f0b6e55d392d8f16a5c240f3b62634cc4f232a2bb02a59e32710286e53e02dfee66246b89af2e4134315f5f3b58fdc6d4ce412c170a4a9b2b015857349aed066539bad295bd8b29618b6163dca4c87ebb82baf551f7ab35c8190491c1332c94ada013e2ce280fedf6d166ebc3122efabd4e7c6bceebc419042db6a7089e4d0a00a8a088e70e65883dc064a7ced5651231f528134b5e9cc2ccf3c4b236fc12dcc75e4f72c60c01a41373d841bb01b01cce78af8a47fb301b8a01c3b73889d1daddb23ab62ccafd49f06478d1321871f91b1dd354dd7f573275009ce4db1b8266b51eef77c31fda28943ad9f6d8515821c19151ce4c043b9d9e0057252a64ec5474b2d1ec6046a0eab3bec1c68e9362a466ba63cf0886537415a007e646d95464007f2c45e7bd02f296c8bf4c49a919afbe04518ef6208b4f43849fa16a25c9cb2c4a1f0fd3a5015fbdcc97c9ec06ff7ebcc372dc51e6824e017ef59bb39f8357f39e4ce121c77c86e7c4f1c05b5f00a38033f7d39bd1ec3e62c2f457563951edae0ef6e5dc4e1ad95f7cc64eb12961599011429428539490514c5a4da6243eb29876ad8d27ea3ea99a2032001162055e6b1c2a98282633f4fc60b8f6bfe3db32b7c1f3b208f6f4ee3067de93bfeaee16c461f4d65d54ddb17e74afde59defc3c1cdb207c5fc917672a1e4f648a2279542e712465777926b92cf76b848af2a004885ec400e1819da8f53c3a7d9264ba57d511b407d7cbff166b0d573fddfb25320bcd83c7f58dbf5b0b63945201754dc62914805f9c745300f5f426fb351c85c18359bc910950f55096873d3b72c544993c9d31e056d5c402c1ea0c61e484c464969d94d9c20c52747f2a822fb4faa63605d2707f09f7a255444f50158cb7645b2ef30ff00447cb1e4f2ffd809d60f512eecdb58b4293f634cfb11a8a6e39ac30ad56ac8bcc78545d109d260f5a588b86947d68c53db2643a1901d9e267e4e81c56728251463adaffd5ab7e66062371bba67fd89eba6bc85cfa72c87e7116852c3ac8379ea9ee36b6b50dfa794942dc557c877575003cf25fabf57a213f27be6d47fdb1e46aba15182dcc4b88224e5ed3b29ab12262bcf14d6833f4da49f2e3e77878df3e5c0c1117417a5afb86e1c15d33a86fcbcea0252f80b2bcfae79a60bb98fdafe038da071852a8f102fa0d481de42be537f801ce608112d9bf6eb7e641f298b13da1e7e6ebfd7e40086c20889ec63cd40ef36817d7c456ef63226ba58b959902e0c1c61773f2e11cd2a4aa23a046ed2797d5c1e8509e13af29b474e32b3bbaff2ef49cb345047099758de15dfe05d36d739f308e6d7a1f84dbe76834fee2b66b5b5062573cfd8ba5ae226868a6c57104addb95cfb089eee0328bcba8b9779303181dbba67b91a5671ff1ed54e86a939e901cb21baef500e3f793824ce0a202b39f59520c3b6b5ffa7a4874ac3206d816a0c38024b9ce6c74ecb3ce0548aae795b06446e5a7753f475f7d0878e62de909e636855353910fac777ed1e43f347369183afa42f34f321971dbb54357e35ca1c8cf4a24865ea2e20b50cabb7c29baf720193ac03b937d1d2cb0febcfc327fc995cb78fead04e243c547d80b40ecdfd89fb3ea507361222deb27c8d2f3c81434034eb83c3694590627d3242b16013de6a7c859619f9dd3b45e0d1129ecc1449a41005e04391666c36372a47e3ac3813bdb89bd39100b15eb865ae59992ca370fe3d9011ffdec7fd709ae34e9343c34e099b04119d884d37b9a6c764df9b50cfbb31868c8d2aa25159dc34b200fc33dcae0e13d15179315da21af977b554468015de12ff8fb3fe7eca330ceae3311c7a899dbc36d55e793e860607e4e033e370b70f73bd7bed3d5eb72e85f87fbbcb54c18ccf068c72e8eb62bb4b79fea932758681c0fe62c9b724c69c3638b22242a5d7a927de1a1358b6553b4b4e2ca6414cf0cf6e7f2b7af356e58e4800aa82fdd58c5366d43f20e76f9c4ae7128280f76329bdf4fa152fdffe6fab77b62f593a1787e443b9b0f415e6c15b03ed6370d584883c485c67de1021b5930e60d0226b5289c9da5b4a48d889b1fd15468499641bedde6d81b99b00ff48f9230602e1bbfe30a1d9fb90de42a385ce6419f157eba18e1312b6bcee5fc60cf06ad3c817c6caab00f0d6fca733b608a36c0e6b9712a12e374efb789c566a34c68a9738df8a18cea06578d57b198eaf96fb9ee537b89f81c2da3b84662c934ba9b566ea2cfce44b46499e26049d7f655c0b834c92cd9c93812462fba94a09bc999a60d2ef11e3e50ee01546733bc6953d54694420a3efc14c64db84ae3ee2ea7b07e61db79f6183ae6d27cbcef937ce7c793c1623e96f7a0e5edbc6aadf5b4c221a9fecf124f2ed269113b25cd8da68a0ed7bd4c8614d0e451db1879c91df6e166c92021cc73da980c8cdbfb0637e20e17a1db127ca3398861e13502f207c5ec2a14529c014c5bebf1d6ee1ff8aba64e0c17a307a8a0bf342f15ba7f6cbf595b2604d4fc34e86fe6984a2a70066eac7cb840f86ee2a97ba2403bc4f4ba83044f3860018550ff1775611574b6d82e2debd654ef0e7d5561772b02fa188adf83ee1fd57fead34ee2161138968219adc9b98626e6346492638fc9b503043ac80b624968aedb0f7e15958d0a3e2c08118dc2dad558299ba496f7c6bb87ec97ede570293a0a432d30c5c65a7e2d5caa837b84e0c35395096253ec60e76a8c3247b9e70e06ebad604f0f70f15f3242e6444201734658a5d28bf148eb881723471e0f7d79d80a23305bbbfc3d4ce5f939a5d6bd7d4371b84f36aa35cc8061d6b303b667b68f3b8b35bd7321ed839da913d9828e58cb7d47b62a6da38b64cd0e5bb36d49b874cf4701edf0ed838fb59899c94cf9ebe5be93f725af99ddc0bdeb560d18abc0601850eaf1da80b1305b55619b497dd09befc653e21de4ca553d0a711fb59a391363cb0164fc6775245758b015b20ddb03d9c40c9b81d3738e849198395c1a37fac0e673a96409cb8c378ad2b9ec794a775e06f16eac0d5f655f7bd1b427e8d47b9a89b605eb93d3608ef8b987f42f3d66c81a7abaf8446a008cdb8128cae4c8b97466360ca522569108081f1b7b989d2b3f0b51365e11d48be17f0918cc3aff6499be9cee18b240f8f142880d65c734fabf674f89f4ae5a64c0fd1c5160a7141ec5a1b51701d1139709707fb04e318007ee655ba0cf9f6c427935292c9dbce143fbc9eb40dfc01f35d3bbc27037d5371b35a1e1af9b2ed8ddd50c55a11c87a48275ebaff1327fc7637061a563fe8247b91fce36f0678b10cdb992eadafe8e551b472b459f7753d2d4adb93424fcb61a0266b2bf982b864e20f094022cb2f6410ecef8e4910c995e8c9b9962744a0230b71c74ac6ed43c3fc3846473d9cde98885e370e6446fd6a23f9084c723198a18e3a63f1042c495a436954bfe823c68d84c35b0dfbdc939c1945323d1a03d1a8cb83feecd6ac3679c1e7c909980ed57761a34a34caf66cae0c039c3352f54744d98f2bc1abc178ba993bf89f06f5a25a36c60e074f8415de3ac766c8cc336530113796edbf87d3dfe80e3786f4aabe5e593685d32c802bbe288898b7536c07a2cfe244f5dba147fa68c03696fa985476dcafae5707cb1400459bc09871592c9abe167603b48cd443f8ffee3d4a8785ec917e7cdeaf88a294bec7ab943d719157de11c881b6784a4bc34e06be6d92314caf991a1e6685e53e15acf9eda2b34859626387d403129aad133df9ee370430e9f054c00274e120a0f1fb929ff492d7dc9acba766845cc513638cce5b53c8cd76ac8bb72d30a8b9fd70bdd8e28f58b4f6f1f7165ad848defe156654a2a87b28b9994e0a5d962a22c156dcf9b7ea798bb8c0d6aa99fac172607e504c351cf2d7925317f1f5a560c3155dad362083c44d45d305bed1fbde2d83271dbce49ef67472af67ec4a9fb6fd596de8bf6a1bf1f383385794d5fbd3fd96220c54fa09666c71158864b498ab14e4941bde18e9066202b679c2c5b0b8776b210acdaf1eb61d27f47dc271a9a72ca910c4d82172b96401b172888abb3d2ff705184bef56e8519866ce1ae71db1cd91c6d54b09905d74af97ab7c37d39be2e2f8c9483b9bbe42921ab12e33ce8ef8c7cebe79690e9c8ecbd6f652c1e5cedd6a88fca3760d408455795e19ce29a7a8e127334a80cec9c5adade166f170ed16d67d53c2e80385ba3c0474a4d0b728e468c44c3a22c8b6d4fc3bbffddd137f0dd82af01ac52a89bba49e323d1b93bcd027af69a7dd53391c3b4d4e3217a222e8e6f15842ea4507a7f1e90b9f01851fb23dba439d5811dae5598728a477d24264e9e3f60149b26b3828d31a9cc2f63f2e91dbc9c53308e58f67f1ed8063308c2ef67ea3fe20c9b032547852ab3d6fd839944d6bacc87b0da01096116e4c47a6fe6dfb8f6bec50206568db35a41ef999bf55cee24e60b28729c7d0cd92a6abde75127c364d180ef27d688e131fdb0e87c396347243a64972c409003f1d7ce16ddde3bb4920b35cf5d3e4e71b2a337b56d0db9df91e4e160c6f1c2a49701241a8eb0a30b9565d07602f0a93aabd6429ff8c736fbd131aa8277d507123d4391fc9b590c53e60a78211386f72ab766e294335c79e2790b4529deab16d9da7132724cb439e3f27894cf4de212af6ee7990feea83c4dcf0272096076f96f5f822d956ccc577284e535efcfb024704678ead19deeb11393a61dfee65c00c9510b75ed1785f89fecb14cd5ebdd33eff81cb596732d04add918c40a58bee43c773d95a549573a7304b1589d3e7d247f30b69be70c2a6d06165cd90393f3c12112c5c60cb7d4e04b538d2ad31ef1f9a6839f1007b93d00340d471e8372b0217f4a169f0202830906cfda4dad00468fa5838868bb0a869dddc0d814632b54bc841eb9dc2340ace65a5c249566e6493519f37ab511217b1f1c8f1bc0d727f2bc0490ef67936164194f7088f0064f1f2f536c3a41667acc9d50bc8e35f3136dc5ce94734ca0891f624bfe91a100d35a7ae0485987f4e7f497109bf21af764a80dc5470f2616751cc1bd2ba7581d7a0f010988b90429575c9b3334a68ee81f6ef0c22562dd0bf6d693e5b696a6468a7664a1b47cac3120d3d6b45d0793e732286bb46abc1bdb5b67ea5b703ae5c3b7fdcf97f7fe443464d9136c79baf541ce2a91e318b32b5069a5730bae1aaea9a3d8b5fcceebe2eef286e04169bb0c28fc310af0abf781fdc049102d921cd650b7dc7ceb71617d5eb53dd6f914c408cc3f40036eb5d531671acc10b6728384c4cfe71e4485671bbec109bdf878deebeee0c2f074294c18d73ff95caa357224ed230499ad7093761ef868d416cca50b8f4dc94bf8ef952b67fd7a5f9052b28b4a381f7f576fca4986271871bd23620911da1fd03e9fbee10f76ab40c99cdf36626345b1b5153841601c2995597386227500482e863edcf72eba78fa1f51e38996eb1f8605c870224dd9ee55f1de3e222306579947559f34d1dc9b53d4f478695999e7455b54eb2f63cc7b4b1206386b24aebcd2ed5c9111bb79d598183bd6454b96e6b7dba9122a4182e6a1e84fc10a6c0cb29de74c7d19d5293f89e0b6512f3170bc9f17bd51b77fde5e167d56c48626f6be35ba4074bc4fb474263b29f4826c8d124fa13bb87b9d3a211e2f4c6542149a25ffecde3dd1b0a0033a82d7e6123788d9f45be23d20d7c06c114c54dfcffb9062de71fc34269d0691a9fc86d189b0395e447d8e31f883bfda4f0739215b7e5b2a0054e2a18a54c31e6ecdc2c6b3612696d133ec7138237c7dac21b6a7c95cfe09c46dc147569334be7d8bf547aa7d65eb4f1e9e2759091a26bb29a5b83e719a74fb3ca3d640ca29a75ff09801e4f66c18c88ad7effb79c463cf60cd5db1c932189e4917757ade9ac38ebb21d1ab264bc85d7e799ec0619e55c87e6e435dc187e1567a2d1393853bbae8ef8f5c0ea5bd4a509f81ceee7667977d236facbe5f3c1a67ece027fffe39602c9e4da3b89384c7a00b0924473bfe4da7b0a3180010a89827de0d2259468c1ca147563b8d76606413fcf05b0a035656e0043b45e1083156c02a4c75951dde244c9cacfc67b653617b610c25ae5c8c9107711309584f3ae6cf9f8ca05afed681076580bde5e3e241f3488ee603d54365bdf9eaca08f4d4527ee4c12b82d8d6f0bc1e766a79d5f0a19816a0b4fb0ab960ce6ac493138bebf406921f992d29e2afebc4fc116f72536545e8f103cdbd9c18aee638362f8c17f00d8f180061336b17fc0dd5a8bad833bd1a57a6a2c37d5ec07986807860479dcad740553442ad73947dfa8ea294a3a963703775a14ca518eac3146e930a8d8e93a792dc7c2dea460ce7686b296dd964829ba67c4b2fdd3ec38a34200be28edf7242eb49d10ff57ca741308cc41b659560931b9e1b3c249029f0fa74cec05febefea859810a0f96529e5e18a3dd97fd9eb9c103426052f8d3bf46368ed3ed8d6e155023f9226f622c3fdf6b5329976a2ea2c122dadadf136a6d4aa77839f592da1199cfc009194a054a4cc37899efd7e6ee55937b1824f86994752fae70c933fd37f19225b5711010fa8d6129ef29cb96aa5c8df3d7cec28c962bdbdddd153b72918bd7c45cc0e920d4f1a50edaf5c3ebbb4997fa96c61fc58fe2e355121cb8d2971b20e803f5db26e41adfbc5d5736c09abb0c0622df975c9f5d5f67f1236b9d445e979d9a1d451afee0fa809981a0698a2bebac2f0a10b38b3047f4b2a2a0464afc47933c31d26296aad1dada320c769726cdbcd5b4c3c4a50d844ce9b2f4388105420cccb70b7d797154987ebf53868178f4bba98eb64ee43307c513899aa0659f2b67a5f877addaad6ba7d9e6113d82efb7e0fa6ceb4d87fcdd15672f5dcca2012df73c9cec283969511d12193b243b2826bd1a862bb1dd3f309d349e972eae8f1b6f90f538834e37eae8b784c86c1017733dbb1b262cab38c86ac714bbaa480fc33e39845e407f0ac7faa31cfde2252e449d5b84516bbdd55ddb7ae72a2bbdfc0f12d6db25ac448278e1b10620d08aebc6126fb6a81b4098f950aa3d23b9825c55a297ad9b71f775e67410c29251d0daaf1d7bb2bb0e2bcdfeb1109a112c6450409c249178ab55d262a0c56259f93f8b062187fc2e5608d9c5f90ee07d55f3879696c42f2dc388a4b29eb52b8282c190334461470becfc359f2bcfcbe5dc3c6314fbdec460502f54d8d789ff6b43fb89b31245356ed37e9683a009bac25131497cef4af28d2e6fb6b295d2d5334fc51666af244fd957806d6bd1376f8012227396ce9da3935a408fe2e14c5317994926d974dbad2dd0d96b8ec983c18753ba32e6808d4efaca1fe96acd32484d0b46963a7554e7f3d1be0142cfcd9d864cea1304f9fb75caa70cae714c2e26b16ab36fbad169be0dd654efb54eb45e9a93651a0e45d32281c70cd0ee1aae0f2907ad47b00139158f7b4ecb860c71975a56694643b9cd1877ad61b0a4d85029cde2260ab49e2a3e821fbf1261c2b96d31b46d6177106b4f11721e437c6dabef62578b30ed0c5e9175157b2a2a55abe46aeddb70eeb92ac64f22eb614608f03861a9ce766ae19eea75e34f35536004d03ca45eb8a29f234aed9dfffeac5d6a35ccfc135716cf15ee081ec5b9d7d24bf24c1321ab36d502b454bb5315dfa9740dacea078de2339fda34d20c6a94e3649f64e4d17a608faad6dcfa4acc9a2c91fe43f2ab0bb4c043c7b7fb9211d4baf338d48e320e0d186ceb4fbcde0d9a04cd7c18ebf95610b97a7f02e9c63421c17ad2b56e1fc5c34e8c011ab842d1dd4eacc8a5d9a9afbb6df992362d29aeb535cd52dafadfb9176835c5ae57bfab0d6e51c15d5d1e72e292424d39f189f575be0dc603105785f1326c525f13176d74af17b29e1848d5c711ec70bfa88575a51750d7a3202393ffba2c7da2b9e4a207e46798b225e6f669811448911021ee4d6e2bbb9e423b2f5e2085015e40e41a200d3c49dafdb7d46903fa01c673ac1aaf337cd25a3bd86016aa84a2dfdecaa78c9f409d70f5d6ad5414ebdecfac59a5f86370424d1bf89485a875ec09e0be2cad49e73df7ac8d67287e5ab26eb06fc3c8677236304f85b2e0368312a88dfdea42c0a5c9c6f78fcb49f7e1c2f2030e02937bcc3193b883be48121b1b2134d7e34862afc27fc7da2f315460a18e24ed26b940d98eb90759374339b781a90b53f4b64e3995800a8a79004d241929351b8d31f6d355614a03ae142d68309554ef05cb4319e56e4a2af2e2e59e4efe4d9ed360cbfc4968e406c66a14990fb72dedef486f71bc6b1e72b2f6862048c87ebbd2be030e36570b9992149da7758aa9c32c2a49da6e164274c18cf066283d1d4fbd34989cf4332b8cfc0e28f8ed0b30d8655de7b1a2491b706e29afe22f1c3f6737d988acaa621fe5179d3c3515d47c8bf1db0219d1ff4233e125f317bdeef204116e5d0ad24dbaf5a91144dde2e2c6a309717cbc3bb6ccdee24b5799f89ca02e684e2e610b2b96d5eb474ff90a336113720b4ef063624d3ca3c59c97395516e2c6833a723aa6c36db3d940d82ee68d50b26b29a2aabed1396cc2f2bf853363753d6fd97ec41ad124be349ef84f285152c344eed322d76b96cc9220c0ed61a9f53bc9cb466cccf130ab10b46e02a05980a0cb7ffbf141e8320194f55592c594c42caaa9307db53023943ea5f2f893e4fea7774bd89276ac1042d4770ad6f8927df7e741a30ddaae63e77ed877ea1c04d73c191a5937a495e262188fbbbfd72258fc4d3ce3d4b6aca6e374befe7e3903371cf79e77122f8dd1c2d386c20bb32b1b48ac52530ddb9755e7b54074e426da17121693c683c07b98dccb90a2185ca9116f1a049265134ff0d32469ac65f806b4d6773fd06be7b45848744c190184ec358b036163d48aa8902862376dd69438521d3b4a0bf8dfd5392b3de515c59a7794e1313d3ca2dbfa718c54da60c5c8c5b7dec38793d74f7a987b5a6d5648c5c7a7201a94bf67997daf02f5c8acdd1ebffb5807b0c759ad3847cb2bdd17e678766afeb91fddc70d780efc9b7cc8813911a447108499798936218c7ce122b8ef11820c11f9cdd7f615940e0a6ef1d706333806dd00b4d650a2b2ef0373919d473443c2ebd786ce52a30953ee66fb95e3a23e3c12815c94c4a37f6bef53e981888c40603e78028574e23a9a972523104eb74850595a664a76810aa82c6f1ada73fb40045c569453c178bb1a6f8d569cc7a3dacc3c3cc9eada26f312ac44f18ccfbf2321f2b612636e4f9228b9ee3cdacbb16451bea2db75f9649a92ac5597a5c0fd61a54489adeece5f559d20a07f3da47e97b0a9f2b6581fabe565ba2f70bc6a1a8557ec464da19274fb0cbb0989cc28499ef480f3485a436f43c08391c474da25df3c019b30321edebe517b6f3a54c5aac9cfb29765b4802662d659fc871a4c1929bbf9b8356e0960b07d956fdb47bb548616fe493ef205405ff0e70047d8f5459f930de5fc8889cf34af67c6352a429cb50ff6f4cb54d437129a51db31d3db4a872f7fe972bbb4debd83f6d884707b4d25ae03e8228bf6106493b3ecde5328dd37cabfa03f387d5feda5608bd32cbbd89886e975325062072a1b9e35bc164b3cc51f5bba3d7f1f963ebd65b36256e780597392c3a43172b976fcc3de513b979706e8ea09623d91ae4c8efa1339ab6241fd6f7d04dd3afb380e11d574bfb1d04880359287c027c2e182cf3908e46e906eddc58d9423cb93cb427c0a889b52215558a687463ee58b068e9b22e25dd9a6050ca14714ec1e01c14a26fc9e031611a526df748f4fa34de6291a3a9241f0d3df5ed80741ba33c629e70274fb3fb83f83baba166a4c4750c49c6b1ee82f7c3520838fb19f0b664049d4f0a4f764ccd2b701f9f5803689dba48afeec345a609a6cfde4191b1e39c22f859ead8d9111f8400f0503d12e9b06832f3139e46512379882fa49563ffc150fb8673ac7cfe7a1275c62e9e5d465781c2b545a460c9337065e6027891a4618c68312f76a6c79608ad8b972c607d878af3be8bd4172f6adbc177659eec5047c8550da08bf4cb27d35a0212a5fb92528684b6e449014589ff4825b0c2ee1175ee2fa901518dd1da75149f658913c002855c82b2d3d689d62096a6ae3ffa6803208dbfa1ca15958672dda07f28f403d9c065d99b97622df94e462ffe476915c69a88f655457835b0b7ae219edc6333aa728e09ae5f0454f6ba5b21c79623031c459675d4792e05e6c473ffc65835b695ff7f01eeab7f6c8881034de3fac191ecba99a13d92e36458c7a47fed4120b727bed67f50c840822507d339d2c5e746e6450b083e81ae8b9574ed8d3d90b7e92ab73a911b5f5e3b4525ec445aac1a4f1193fa2afaa326421a169e498c5b615c5a88a055622e230cecd73237b381497e3836dbced79fcd6834cbb0da30c4ee7950d685287f3bdaea9d689391b629d4e2df9e0cf1e71db157cd1af385e64a2804b1b2d31d2acc6921c18ceb8331cf1b8c17772c37a407ac89672eb07ab7dc58188aebb1af3e59e7d007906f8e35297563cfe605331f91accf6513924475d6fd7600166b35bff90355e8d8c424d919b2259a9b26347e981b53ece8a6b63dda27988f6bcffaa249cae44299363849fab31c674b88ba2bc606fb1c304f72a02c3a493e9752f8f57f076164465de8f3505103341b49a0667a239364b3ab514df25fc6238c65db397ad507dce9c70112c87ac662b494232631d2101a533c55e15b051d65a0570661262558d52033d4ccaeb40810959393208f11705463563eb4619b9a35f116742a3084ef01118565a66e2c8cfe6a5f49391be560f144e3e0209659bfeccfa89a185da8ab392d993f54a8d2b63c5cdabbf552cf4c4f1992edd5afff88a520a5d11d2690ae07e6d5185a0ca4a44e1b1e0f4514b2d988d7ef1eba6d05fb3243dbb831942dfa4ca14c0af292dba80edcabcec845f3137ac2e13d1c2967fe805673d0d0ce8f5279bff6f3a1d26c176680a9bb6c7a2bd271b437cfba7ea432a00426721f57bc12676a7a61556d514ae5face3310d85f899bbfacec9c3fdbd7fe440220672bce0800bb0974ec105f2929d713e8c6bd568ba7cf4cd2032b632be4137b91c59b190c024d9a3fc662dbb3464c14fb7e18457c98ff3aa87d72eabbd7cf1d944d17931083f1b1d3b1a0ed4d52940ed1007e3433112ae04a4348e4c4f254e70cdf267d223b73be077b97ff1ca6048a2febf906a9b5c0b04ab882940ff3933149fab633777c3987758797bf8fe87f9578720031ff47e4ec689bd5f33198ee9b4ce7a15c67caf069d0ffa3e6d064fef51fce6af615ff9297c63965bd4e3c43b3404983444fb69f279fd14bc3c6df4b42159fbdafb3f62f7786ff4b20ff40e6022fb8f714e6420007682456c2e7c015d8f577118ee0c13004ffc2efef8a78f2180d641a50b7aa0c18bcc016fdf5b7fdd5a9d47e76a8854f0a515a8128b6cedb8dc1c7c932f5056adeab0d262665d2093eb866c6666596f211c6911ab7cb4e9719f4643ef0712f6a68b60099e51f7960b01c3cf5950be0073a2c5b294a0536041164f03596052ecb0082cea49d9db941ebb61dcdbe4b6a1e221ccfaa3512c261a67dbda2e7da13bdc0a213a972bbb0c3ea268746a06fa5990aa83165b4c1e1707d1995880e2e8ccf29338d463a8f002c8072b1cb7dd9244caeef6e95e2fcf77fdcacaee9b9e0f0ad06763906f2bb8a3655f23b18e305ddc8e36ea1ee613beaac32b9fb203ff65b3fe4f90fe8f1acfddf559cd8de6c71b98b1f3f3bb308b3730e9171fa7ba85fb57cac3f60d6c52748b22fb92e476d0482990e3cd2e4577f2c628f62589c84335ab95e591c68babeb7dad25f41a3d2eda66d297210aeb8914114529218fcc280a9cce69381ea24e025d70c3ca2076aef9886170d87c4f06cacc461df07f90f7c69579828463d18ef5e6d443a5b8018dfbdaa49181d6d4f428dc982a539330726d9359d9ab39652be7f892c06f1058d2631e8224b0483c784acdf367d4cf8d529ee532da889be79faa51014d7446842dcf4e8c70cbc4fe71ec3bca64c98240559e559c4b2d34cf1ea79c09458fac25d8474cc97eb3dfc95fbee40a23d8a49e797c6e3d16f8c3274b3d8e7e732f0c71febd5e56b5e713a13373b64b3de43f2f65b2f448bbec5cb45d4fa34c98d57a7326bac43b8f51710b5bea0b5ceb35d41a19edfa3ee7808520c811e0196b7e145bb3133a4e38a71fa779e8ae5dce03f2ee9dead44de8bbf49c300343ae2bb7184f6c7207ea6fc9279989401e9b4c368ff06c80c85110087cef1c278c27709c5f8efd2e6c5b90a142751019d94739315dfe97732a09e9babf33cc3a932414a179f33fa994391be798e3848433017d28706aba5ffd5f065fc7297b0b721f83c88f5094081cdb715901158198d9d703943a83b60e1014e31bce3c5137c8471b531b11dd3d459935448323aff5ec8f22d480365c01078341e9eeee3e57c21173bd464cac117b5aa6997bd11c6f2dd62e90ad38b7e0ed605b9b03b29a7bcd8bd6c541f99da655b73ceda9efae6ca4a2c6f5ab58a6e5f2530f85f4f93cea8152b183cbbfed8be","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"e51cb6d05ed027db058edc159e71b81e"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
