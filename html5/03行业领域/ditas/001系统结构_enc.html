<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"c67ee4c254ee9fee4a3fa17bef6b9e6e07d047d5b0d22c60863a5f6b5f666bf00e84ad575a7d64c32b05296f34b16379926b9f022a2812ea93ec4fe5b405e2902c193b8cf80574f63f15349706238ab231665df2c742de29d19986f0882ec4efce055dc642ffdb41ca3b966c750d62ad74df252875d792eb6d313dc5c98b818e10b586441360f80773fa0c55039562fb58427b2fcfbf34d4a656dcc4c47f0a2ef262eb27983e48b8394b85bbc7ffe612ba02b227c7cf8d74e9acd2d4da1f3d4eb48c3c8ddbbf5541b3f90d9a9faac10ffab89da8c8add5eed7131830bea897cf4e59c6d1fccd353317ed21750b30cd40179cb6b033db56f50909a2b5be8dd7cc1f1db1b2f823904cf3bd8c03e5b7279329464e8556ad88746d6c34bed46b63f822bf484a389c8befc3310a90049b59627e0bbd9b73711a38c9885807c3e2be3bcce6f935a260d0e2885a132adbc900f40b77e76524f828ce795baad34b3c5ccb208eb3bd624827334380ee0f599beeebeea3a02576b5a6f9211307cb3c2d4d5d5ed2d7868896f1a287cb10cc539ddbf63a2e65f8d91a1ea4c7588c163ec506e996e874e2ac31b9bc5a9ebd373ef73f1346ee52ba889581261e0c8d0e507d0c62d913e48988baf2e97e6dad6f92eedf9bcd284b1a0c8aa1a202586ef25efab028cb07927ccba9ac72679689638564982c81ba5b252d62f7d47ccad83c898679c83f0e95a17ae06bcb8818f7594873229febc08898089253d7cb06ca406994f30b2f60ad584f4a2ce7b3ac5f1f20d40f03c20e33997253a153d601ce7b3063c53c8e0c50a65db837f9d1df4da5b3ba687a75fe2375ce5d932496070e8c4b8aaf9385e59b05422bbab33fe69f11bd4c0d4b8951edb475ffd389666bc69245c564d895543effa5987be33967901b267f7fd19ec5b12f92a59766fa4567a424337b810f76ba879189720c844f0737a2b9a41354a89031a5b746c73b7597c658adc1308ccdd1f83d5aa4ec2e092e1bb4e307a27685228ee417582df7c392d94a9b959d6b78fcdc44c08e19eff01b5eb0214a54f4e9c045c21ba5eda2c2295ad33faa31ff38ceba4d89461dae6a6aafd901504a3e29c78101114d05a648478aa470ccbbd074492725703deb4050ae2d9eb13a0ad1f8af00bffc4779605eeee2eb1c8598ea51236bcb4bcbc9407f25fab3031f9f5c85b4e2b37b7b38a49b912300e48277682042d5223799f5544b45f95e66da2e6a26e917bc302a719f662a0a63ccb84054a4f9c3f0ed63061c3fdff4916051cfd3e23e073b800fe2c1aa5c18befef0b75ead65364c12290fc4ed145d354f148e18a2ec3652961283caf2c1d09a8b9dd235eb28a49e4bd9487e34ecb33c7169d0a5d0b0f02f127b2c8efd00acca80b6ea8edb8298359533d1427d52f39802afc9d99f7fc0d5b27026442733ccbee3add9b1a34752972b39dd77d3891896cc6ee76e3856fadc989d0c588743f3b07ddca268450481128d0266792a3fef9a5fed561e2cd04e3c9da100fe690836dac611868e0ed6d30e097635e892887e591a31fcf42e04ee1ef881072294b087e7d11dac105786d29522b8a64d936f489a1dc8f500a66f74a4f95d4a71e766c45f26e5d9273e456c900fc114a20a57f1aef188f4dbac15ee987eb835e7b382f931ab0ad6763c3474eea0256b57e04228ec9e493e8566331335a1f7b18bcffd4aed51b08a754567a78f70722e715b10fc76d092c16f60dee836a1057120c0a1996943ce468951dc81cb63a63ed1749f8a8d51e1b210022b39ada18d58f9d387efef81f04d29ba0249f3ba6c4831e12217ada5fa17b70b215a8ad6136550e467e125a11a42f9af105936c4e871f77696c1819c43f102033705e858f377b50be6dcb0d2999bec203b95e5a2257081a5c8e1374719f6216d8db4fd754e9e97981758a81eda621cba0f2558c0a16280e58a403cc75487e32b95389dd8845099939e8bc01e430f2a6c5aebbb18021564440a89763bd9919c36f83412c45d7cf5fbffc33e940a78f0d32782d0e214e1e6bf126055bd8ebad045e7623a7400d0402b09b2970b20538039be72af8f46c5117d3fe27cb1cb4403f98dbbdb4570e0b80d8788715eb498ebe1ee0bc9c72ead5dc908ff69525b7305b848e47d031da5bdecebec635c07f9bd884cf34d4eb17f2cc20ffea1b930c0a94ae81549780af683ca5a5f3542de4f302e2239834aa0eb023289710214ce1834d0acf6f5bf0a62cb726ccfa66308831ce6d6996467d473fadb113a628fd9a7c215ae8d8baf295855976a6350fcef8b367cc50f3271d4d2d5af8ccd00e8eae4eb4d5736866f003ca637dc6930de3cdc8e940e6e4a6c18992c55bb3011ab1a0522ce7c0432f5cf666c3a41c4cfe93b1f6ed8aca1dfbe7ae3cb058d935c8eece9b1df45a2a0981d8fd38ad06c5692aa6bb2940942f286e812953a8f2231d020484f731c5986de15602529e3d2b2a835db4f2715ae124b61e60e3bdc326c7c9f95e133748b2850b16e914719cd4ae5579d8599a50afd0c6f310e63f0eff3a38f1fa1b3cb29e1f30f2f775c2a5d06f0af61684d07cc933adc2f0575caf266dd9054c652bfb22086493dc0f4ff72843bb93e5e6b37999b46c4280d71e32fd06e6dfd2e569a564e785b46e63b6af1155ce7274b7c0065a237de5269bb0f1511fa00af1302192cd4ea00e887a8ff1387f536298f0a14bdb8a2234ef1ee4b69b2bc7f8fcdb4ec31d440c1a0986d0db49ccbef8ff03a9b34a82fb0eb99fe42e3e61d4e6c438bfb489eb7527b69ae50e1990c5e055e5608f20756e8cd688993c88982e32dc566053c36f291fe615e4b400098cf66cfd3fc959f7ec6aecd99e3dfc5a789588934f058956a08fdd02c29892639fd4bca82e3eb0d1dfe2b89554bb0534719f13a118a69926be6fc22e1a3f8895b9f717d5e432ae5085fbc7f4b1e3f0b93796300c10fe1fed693a946259667f40b16b3949c18d28f3aca017c1bfec25b7ecdef470bc71f8f0da3bc98cef977df9c5f8d5034faa9e42624a0754334028a4a464e2d7fa48bdf2ae1f8d5b52a80f86a054478a567cf8caf8212088b2c62c5a8d710d8bf500e48409814162eacb07379f9bea57f865605e5ea48092466d992dc66ff76943253ec220e0f647ce2a7ea556683f77f3d8733efe3f57c586c4395f7b20accc541d0cd109ee27763065a0d62ba07135f4982de10cdcef4fdcbf5baa54929ae43d9466eb139648819ed3fbb5a4cbe54588f0b24e70197058dfd9fb50470bb4e18f635d17ce2c9a93a199d99ec4d2f9becc0f9d0c4280839829d16a37bc318e9b2a7669b9b3481702ea293af812fbda1927c3431b79eb0556e493d38fb5b2cde1f571426726d8ae5a61adf00f1d588dba0a036e74254eceb2617718da8d0dd89298c1b79d6de18513647052f55eeab520f5930a1e3876914ee4aa7aff017de8a1123b117304838361179861cd1c92feadab356fb95bf3e4c08e9d05e1c2fdcab53c32bb4437e5d39a75b77f3e6f811fda02badaba2c058d536aa1200284cb4049f01f7bb0507871e378894c9a3dd3eb5a77c647a1c378417b9cb1fc6d2af2183f4a18550e33a972dec465a503d46b19e8348a12bf8bb601eeb8409d090cb3942c037a63a1896e4618d5de47d2a8520ec1bf07bd9dcf787cd63ee800767811e90f10413f7e16908b80b2c81a1dfada3a277feb18e3d4f651ae445776836856947cc1e15d5fc333d0392dcd81a95667bbf8c2b876bd717f2c66f481de5f6d45ed407ebbbbfaf3ad59bb63f7955ca2f56a0d427c3ac07db9fd6eb1afcfa62e24804aae1c98aa98c0610bd9093513c1cce67dc84777971cceb6e01ef0c1d68773251936d169a6fe8ccc6fc3c93d9cab0d9e93604b1e2f3bf3878e43b7c518b8df20e26e7f75385546adc731758a150a301ad3e7a9ddfe38cb9aedf0593a92f74fe6df545dbe5808bb1ebfd13b78271962050db5a533cd3f865b12f29cbe59bb5880e55fc99f6e0e07327a3a234368e99c88a2250549a7fd2cd3b0086b905df0430ad879bf6b3e3c77867377bbeba78329c7ff5794a0fa2278a13674ad6eb43252b00eedd5e960f151cc211ef4593b9a15a171e955bcf1ad57a5e1607f6d36efa4e0fff49f4f4819dea0929601afa18b4061f8dd84cc2ba9d9820b8344a4851d8fcc56b2bfdc56c7cafddc81df5b6da0381fb0926e996137be00c46359af2b6182f8de0f1a770d6edb45dbffffc70c53485aba4c244a74caff3b907a829ad4866981eb30e805adc0d72a5940aceb89049d82672a1c5002cc962a434640c8cc117132c6a2e1ddb36cfc1385aeb835e4e61cf4112755c56641e7de8633505bfeec43d62564925b5d53485294aa11c4f9bd20b5da80d0cc3707c24579d268cd34840e1bedce2cff82b97bbbcd27cf811e49d1ac0dd560d7b99530aeaf766082e059fde1923f5051c36dd265ac485c6df2b745e1ce8e587a3071557e4249de13917bbe8888beeb002ac844088f22b737ab082809dbf67b1fffcf3c5e928e39627eef8720133658cecbd7563d6daec6014088798e4bbf89e26bb3c6f075dfb32e19bf8366f03b4852de75997f71d1edd956865a79d0e17c81ebf6310c4407c49229f8df1f907d9819425912894893a3833ac740b5febeb766499eb1f376b5feb84eb5db1e9a24ae62a5cd548c9913d17811b0f12bf64527b67773e768f438d02de9773c4e301abc8178c96d326cc44282862a751963624548b3db1967747ffa6e5d795cb8228c5ac927aec25c7376c25bb6f14ebd488a97974b61b5bbc52d5aab29e2c892c72c69310f93c43cbeda26d47c3dbf5b22c18c84c4d48d8b1834ec5e699fdde70cde805f27016ffbdfa84b5234b43396266da1c6e3516cfa9a00f47620d181fd7b506c2facea39ed34a83e007ef5b8609837878fc04ada6167bd274689d44b9ab0df39fc4aba1e40b5e78702f403cde68c80856c271c1eaac72d24f6e786dfd33b77e95fb72a6105b29bcf98bf68672ec66d4d01f7eab3e3c7a34556066c37b0c02fa7d811cc9a0eaabf2d3fc0efb37a0db7fd3d309b0246512f34d9b210ad2bcdbac6b64ade6786a67d0df2094d253282efc1a7bfc02ce49554cd640ed4f90080a0f633858615d0e808a0413a1c9b05d2ff1338f2dd08bb246d8540d0da47e8e7ae38b17385e3ccdf781c45d8ac3f23e0e5d3a3825db86322f9a4f5d5bfa50c351ca52016224a9aeb6eaf7b882cb97d861776228a9e69e0f2d9dd724813256ec7fb2b6e15be3fac90796a1dc9e865d104d6f84ee36228b71e9e11ec1e516a7cfb600554de9de1fa9d74ea1d419cf9d420da1355bdad01492348d1d6f947c5fcc4f4619ed1b4fdb0638169db04fdda753395d1b955a7827a2668535dea9d12e87a255f8dcb7048297a038096526692c6eda236f873c845a561f7ab244d6abc601bb68ec35d09a2b996d32ef5d6ba13e04974027fcb4ee6243c0c5a60224fbe9c4ba188c6af59025044cbbd6f50b42020c8d2546f077cd2f3cceb8154c48dd5ecf8c168f1c9ed92633d3056fc0876dd9dda1fefbb3c6c1340538210089dca31bcae4696573bbd5ecfe5e491c1494f1c3467707ead27e3b1caea290cffe615eecad8df1f86df0253dc1a53e151de1f65a1a3523d615b6e37d651f00a8d74e6d0ca658f6ab8810e8d82e9197f5a4695bbd169bfd656b0fd9457a0aba4df820cda1677f071314b8fe8f005b056d8e2d1ed86c6411d26765b2eca1b7cddb18533a4723771ba3604c1217181bf7272063a2c63b4d0abbde39ddf893c8347cec6c5e209115b45edeccaf8238e376e4772e6ef0dce3cad6815201f79f9c00e853db0bed4f80a9d3e83b1a317b23daa928097a70217721365b9f1ca61e029f22957b3b17493e6e99115f056796e38faf306435c5722c6f1ba2232051fcaa55ed8c13e437e727ce39d14a2e014adeade24b5fc021225418248a66a80de704c742366b52f955431d10a0bfc52bb1d2eaf59458e9cd94e07e19600eb5fcf8e2d5cedb070b27e3455381bd6c785593df8ea550928ac353d449884b550bd6182a6222a8895d7e95379edc3555bac856e7be14f6060e2fbd22f6e97881898c7d1bbebfc0314c726e0de3c2fa4a20e07015e86eb4d7d19d9f2e5623096886ede8eb945aa0cb1d57f6055cd78e0848dfe8d5fe3d2ddd51174d8ced5f6023e91c6eeedd0a56fe324491b0a5d4c2c3c1d86deb6da35f4200673f0f7d227250759b1dc2594e2d8e01507e83177ac812849bba739723092f28038961945df4836ba9e9662bdd08dcd8f11260cc4495ac6741bda3ae7abeed4ce6506bd43bacf458298c583de5963656af3d29093cbb925493c0cbf20df092421e2a0e3a3c083f69c590eab67e87c6509a9968c73f0d1b43e2258b760c64e0f01f2855877909c25323e0b14f0da2678183a46b5a5acd1576f5a2ff80e709cc65bfa5f0f4eecace1fc8b6ee5a63aa26044ad75c76ad048651c09bb4096eee2ddb49903f649acd1244a2c21ed0191bc2d2b3ff349f9f1df657b77f4a5fe762ec02dfcb1212567d251321d2b28f1c4e6cd1347fca423297231cfbfcf6450821ca5a90499494299b0ce0f19420f84fe8978c5d00ca9824c48a5867fabfed06d33ee97e54f7f8540e847cc39bce1994eae980256d3d8b241288b26865a49042d5d6de6faea2880a351a68a44826cf29854df4965152991f47f0d382cb6a803b811e5f379536d3b9de226d39060ef2e1ed4edbde4b5dfba73ad301e01795b2c8d99e278e1c378bf36815be77319cb3fe5874bfabc94eefe850f9d20791c64a2316fdc017889a57d44bbd1d9acc03d846a871ca2b06254e8b3a3f5faad51ac80250f2928a2db16102352ec01244d9c36feee22061f32c40fc00795994648d74ac84925d8f6e41929e075738cb39198593a70ed08beebefb240ef762fa5673d280e27fe2dd53f71294878db14cf9998a45049e8fc62668ff3e59e6b97bc2755f547d9fabe3dc98f24122c4f34e90da578fe02788063160551877b27f3f4ad333fc06458b86423ad03757859b383c252890314ade309aeccdf804b4283e5f6afdb2304fdc01fcb741b313ffec86060ec5ea1c19a08784427680ffd54dc2b437f8d40b3f12a1a0ff6d013e384e32443fe5fc96bfb8c713faf3ce6d60b347b715c252c8c940346345298261e2233b66cadb2d128e840ec8eb77aa04d51f4fbc01104b2ef83c0b50c0315ddd0d5244b613eedb4f344d74a61c91ca4f49a13c7c7fcab95c536348bc50027b7c59ea23c957244da7848fa93717964010cb22a9bfcb76b766bdd15d76e0ff5f339a4a3438cc9176757b55b941cfb9ed669875522f2ca2a286016722094b7b4645bd5c49a0902e3e3847185f6839fb9dde84a5df1026e1965582edacf47429e9a8c24f741852586448451a799a049cc154d311bce240eafb7a6c92f555aa67590c83ea0fe10a63c9c09f63187bb4f4fb796712bd1648ee029f5a06ce48adccef3526aa1ed91b3f6eaac9e024c778f850b72641ba884c394d6e24d7ceea48d9d7eba6acffed1adecdbced2795f2a6a853d1f3b30f45259fd2f3813f062b55f9e2f9d0c525b528e848429f4cace36478af17c24514d20c912589f5650049d5ded987de6686d30446a35a6b9d17e2c726b1c64778e2b73cee4b9d136dc1bb8ebdd160260d31764a377b5ac08fdaacb35d76abc18a89642a7673de46d2a7135c365520c0e20924fa85138f501256c6e6dc3897abe75e29071a2a4b6562982db96ddc37d9a45e49fa5f6171cdcee0136283bee14fd6ba94e15ab2382506106364831c27d017892d62b977ad7920805e82c31a0a9c70c4bada5b1f39c2fa06706a1bd204704996deaf487c9e61c6d7b0e1423add6b106bf175cbdee878847f0d9055e839e97650762a4d52933861264d79e9a5e7ac92710d6534f70630339115b77645e258cfaec89e6062a8d3bd2f2565dcbb414a209a52a334a4b37bdf34ee205372562c1dadbf333a1ec62ac4e54fa5a1621bcbd0a371deff8bc6916e20cfc2a1ac76f6a69fa666c0077691f93a7c1f956038fca95b17b70c4f6337087db9474b66ed0919575126f6d928ddf9c8634d64ed8bcb5bf3a0ce0aa318a70ec06b048bfc612fd077f139e9afed2a7bc5e20021c761348f5f726b2446f82e2cb494fa92e7f92cc4ca190a609818b6eca169238b8483a9e6da41903d9141e7e414d70aafa685bd465249b87e570ee56245516a5626cb671fb566e291977a1a8de94ad4bd388247c74c868a9e99943f96e53831d4f46fef9c3e390264b619f6123aebd858dc686ff3093e8d495de3750b60e9a689b1ce6c7b1c9941f034278307662f5eb034931323c48843212b3e9c5b6ea7e047bebfa33c69679efd85b9e672e4bb9f0a06bf7e39e3bc67c0ddab58863b918765be6c804d13d09316d6c08cef050cdf3a131306dcf7b2058be5e2e0c8ad1c3c3d0e997e994c6bae8a15a0e0c6c338e9280c864d2a171106d50fe09b20c0b3d15be2988c1644e31066e4d5373b9111740938b723e821950997f5bc78a8cf8f63e8bf5134c20c20ce9853c39f5c830f205b409ac33c2ff448925c34975cc8a3fe53aec6dd39d9debad54bad2e76b23f101eacd9642105eb64ca06255c5a7245bfc454e1618a49f47538434ffd28c760376ff4849a54a45169f064fcd813caffac0e927e2fa17ef4f38c50762c91d798fa443188ee5fcda52b4cfcd04a1ec04d2bfa5b8a5c56aec3e5795b282adc3d412971dfc7356a8e633cc9cd6486bb56de7260afb4e44d328d085aeab94e07b2df57fe20a22bdb3d32d435fabce1e199113a30e4ddbbf2e57fa5cc47013cc2604164ebf5f55f4ab49f8f343b92db1c52423fdb9c7796ed8b2b730c3b50d9b5026d904c68aa5d1415320b2dba373b42b277450f862fef643a4e5ec4951a2f70c0cd4262b23ccde0e75d9d0375c76627f565ac73e209d1ce0cc51ef11d1c506e9f6ab045ef127c163f40a34aac48b5a310ac3b4ef8c8bd295fde53b66266a35f40db985a2ed13fbb8f80b3c909a109d431cd732291fdbd94e0a9942893dfb7a3d1d9e6b3c4f661abad179a3b66d92684bbab6afa4c2770e23d6a422e0f23d6837261a791131480aa1c0d663c4d19457bc3c0a02d99118d1723ecc20896a0a4f0ade7cec3f1ede7ce40b9eded35c81019b11200aadd76a3779772857ca143f1189df24b22921d176b47dea120740c73d2b556355d0f14f47886d0efd308fdf31db4db6e964f1adfd2ef52c5e405a8db6384e80fdb2ff5e2bd6af8baebcad592819fd8cb66a6ca70d668565836884a7d8d7ec4f4c6eccf986c7a9d89c446144e6d42b1d229a782e5c85e766bfbc59643481acd1c22fa4c1b86d2b3de706397db841016dcbe4cc483860b549dc530e04ce6c7e922dd551eace8499c6087079d51eae45c171224e726ab80f24cf02c832a38df61d33d9453ce67f73f90096a584887a391ca9b81ec640f275e0a066de4161e0db25a587d81dcf39fc38a04518649a61c4647dbf692dde7b5fc28190d7f7922c38e32416ea7076b0b60a86bada94c5723aa9b3be2b2355777d6f83c4bb9a75f8c8facf30e3ddfea11555e4a406e9003fee87285e8a865c194b4091b1c3c018c4504e5dd836b627fc344152fb14041c0de39ce83d7a0056e367a8b0979ce6a0e13acef7b3f0a1608d6651da295fede79a20bed3647cb74d12ce3c260225cbd993b4322050f00cc9d8c1fd53607a92ab94b9c7787fe9032408ba6d5cb01548629934d5351cf41a6e8721138dd5f907aef55a2abc1128b72e868ca119e917de9f74d1865a6da5475453d9a8b301a47d36fa273c515fbb00291e787adee077d0a6608310480676ad060c00d7ca5929b1b6240dc268cd35d97eaaac4ec458d8d443d02e1e9baa305ca2b3a8ee2a20f59ecaa3018fdc61a4025cbefceedfaa4e5f921c0a90718bb85a9bbd18ec8faa6070ce520905085e0c2ee19ea5f254b22f1da482fa988c92b34c1676dc450f9c62594e9a621e5393766ae7dc28b9da537435e010df2368a8a08e412405506206f0bd4f7a109a7d9b119a08476f1c4aac00a477151515acec4c9c3ea684f639c2626bd274b729b678a7f91035598edfdb8088bb4cb522f91afa5098c0ce894dc602f5c865ac8833fd281ebacaad66ee4c77a16327d4d41d32171f4d6382e873a76fc7746600ec3e7d7b49c3aa2b8e65bdd55c5c7162a9e2b152a726286c89d59e24d73550065a3b39c4eece8a92b08ed1c010a86c944ef3424f57ebcd1ec0fe821a28d2208a6f75c240a77b626a94c4968b539cb55269f928d31d09e64ed337ffbcfa9980f661b6a8f6eba8458978c23b752a08606cde2765befb98961f424566930704692266004c3fbd71d6027ee7e4c7096315212aefd965e8c611292019496b9e12abf34e9936005d16e0333d1aa95437e4a381cb6c59a5c8005acce12b4c7ac13b9f207a51143b2f621db043713edcb39cf80fda7f24ea668eb92218aca7d0998e35316011f73d021daee8d0ef3f2020171effee5ddb33daf6f634dbebdfc09d834f5450270d3fcb1ca1f838bc049bd1bf6e8f90f83a4442d5914f358787ef0e868773e71ece4368da6257f1e8ea24909dbed62365b3f8ae7b67546844ecdd3f692b68c58d5006a24be018a7df3e1fc96eb6e232f57e4dfa261e6e45bf87d0c15cf5720e813e2d67cdd206611bf35a91a6060eb9811128435e4991e09823da841423235c4c7d40a292dcd64dd5c15e36ef2255d7eb01cbdb4306e2c5c4009af9774c809d11b69f0e9b5a68c735b1f44f99dcdfea42a2869a48b12ba9443a21680fab42184cd5ffc25a2b44f55984c70c969adc75cc11ffecd53ef666e1b2ff822c34129b1c7df3abae68723c3e2de83f597b1f6fd324ed618145b0c0b7bc0b91ef6f1c4913d1958c0055b3b9b2e65b3b6c81cf05d5920df4cbd687a3fbb388eced4535f78839815f67ca70a551bf90675e35ab82b8e7ea9ea5de9a2f49934edaef8ce11729b2995d83a7064d7c075a5d123f9ad1881ad5a7ca8ebab3cc366c4068c5cf1aee1ee7434e503668099f3bf61a0d026a331924451408fe3a5247b5fb7f26523e033fab2cc568749f9671336ca4189e915a3f0230bbdac339808df80a01c1c3d20e80404b3f0036f500bc194d4fb2e14407e4f584c804141dd441b88891cae5e7f35f3b1e04506de750b5f9b17339e01e7aabb4db95425f912eb22f827ae28a456d14450d84ee7701752a19fda464fd662e047db6e7bb38df239281ac3341f934a26ff259e755a872a830732411d4c6b695b4616b2260861bb7bfc3d9e1635c1b738e11097fe1f8411d38beea59f9a1ecb70658e559ab5ae6dcc4b1e45dec9b56b2b90bb333844fedbd970f9984a29dfd8f4ca23384ddda45ef13cb815ed21586174eacaa7a88734f7d4b7e879cb8e375071607c070f8d49d237284c857bec24bd51e9564833ba7c2186bcddd6f2be55ca34fbece5e33d8f31f7ed7bf14063415a93a2eadb929ddf66a28f88446268ebcd3041d1c92e1bed99630f19c8eb935d95d2a3724491d8a7c3883f4682a4e62bae45640ea50753c2f6638d2a0a0c12e4e683578c0a7cd25a25a61351d4a8419be6f1ef65fd42a0a93d3ba92c3db69851ec3b131e7ae6f839af774d8b00f04711173e24ddac17cbbaf6307d5cc8c0d08e0f38009cef648cce0513f80f15970b8d0790e12cd7b6ba546441354b44ffef7cc29e30b5ec2fc0b219627a7d91d9877100b1300ac8c1d4bd4a346a897fb9761e2cf84e8c58d45f43eefec5058ea46c999e1e37a0b8457f216d337b6938ce8dd1bd56487771c9d42ce99f7690617be514be9e82f774eb9ee0fc225a9ce03c29d107e7cae689cb41cf911d3eeb8e324a9ec93e3a602d3a84b7e9312b80877521038c2ae2401206d73aeaf5ff3c67aac05f764fc65e10e5cb353a1939841e1d9b70e047441f9a7eb7612c9034cd2b85a23ff879372b942bc941f84b0b106acbbde9ee5db5d00508fb6fc28c47ef9f17977a89bc8720c3305cfd147eee5e5f4f4d5d17b28f405cf242802703e05cc2b24c314fc762d5d747ca555b6ebc1f64ba4666413dc9b07e9e861306b7bb1d127358afaa7b0a70150989e969b04531381d736993cc6d88aa6a587ae2f4b94a36fd317461e0ff7126aae4fab3e4a04fe2caba0d238ea10a53ab6dbb11109813965ec9d9b2ee0c1dce3c80e3c1e11c479204f6e1198cf8d2aa9fe37d1c4a862237ea1b2f29ab9900279587c9bd1bf52e286d32bda564f8aa995d424d9797670669f1cae3eafcbe1a39e11ef7d7a9463a98c88c2fd25a9fb21853c21c2374fef30cee43337f02a5c359d2f4bab707f6b09457e67e9739413dfd86bfb000e6d17d2683b6393beeb845eee6892c810c5c31217969481fdee1190e64600d5601aa63375aef20fac1701bfc061184fcab455b60d2cbcb2a9236e63fe92e0f654ff5689137271ed364f52ef234c211bca4e915bddb51731f6410282929b578d12e7f133238f4d690e41041d34d9c63a8a751dd19e8a0c65ba1e1a4334137ffabfeefc53acf2e7b25b66a31853c60b7035bdf9993646812ed974dac657eff9cdb62ec2277a2f6247b6e0a4743b58599d86c5f32eb36a457e1d76778ab88c16493f467039f7fa9e15f9903d05ee4151e977b2abd53d6475db7dbd1d64894d75ffa4830b57ae8c9b16f132d74f786ae6e70011b0c4b28c390877bd67e23d2cb93eacb53e14ef429b052f4ef947b6c4897078ffe8f04bf00f3797abf13085627764853bd35fb67dbde4b80f9729ce0fb02865e643d2060b802f7ef5923194f9bb43126c7174a07153041c551ee9c10582b943267b94669ed715ec1f1adbd204fbb809d06563d7c333d124f8a65562ad99286f8a09f4552511f2b7cb6dd4e856a8ab7ce13875d2d6a6448ea58d27b13395a91c19b827fda385877503e14fd844ccf2cedbfb0cceb5f7e9e8227cadd923a923c734e024ae4bdd63b0f694f1d213f908a70efc752254215d38e26562c294175dc15bb69505e66e8065890a3a54ff6aaa10bebdcfa88c1abf81706f75175963cfce10e748128e0b2593c90198ee7e298384a04b1136a01846451746bda11e08b605db93fa0266b33342a547f97f7fd19c7c5a58e1676568b56bd7231d2cdbd63fdad6a3b99e66f2899730949a7ce57941cfafe6e19de78ae8b3d343827f74325280937330c63fad198c58e46e54e88af64f6c75fc97483c91fce0f03c5c73bc6357727caf51f9387c7b7fa858a162b4d7c356271190cae942506f9af1c11368501ad13e4a67c6964988ca571ce9eff5cf355b4d61c2ebbc61e6daec8a619f7380e1f8ca19561d3bd8f31c9ae85f57acba897999648877bd6098ef6621efe3b701043066e7d073b57bc8c4f9d6d8a2b18843f0779d8816c491fb7204f176c7a70fdbae5b8faf0aaa9ecaf30e6dcf0ba0d915221286c326d52ef6775c90433471388becfb18b56fa16f68fedc5526f473cc5d1465efa109f7ca2013417701add13e2e89549517347daca2ed54770773d90211431b70ae69579c527a93063d083f40c68f5f5b37bd5b1142cd29d3187463f11763c5fc648a967823f755f8bcb1717673f737f3802f7cba8e2619d1913ae3c302794e4fd7b7962008dadf235d8cc4a1f77a5f6ec352e4151bbeb3974c3db5825a1ad0d0fef7fe816958c4471ca48e2e4ae60ccc5f653a17a2774808844ac81eb175c48bcb92e173b7a4e9b9d0e88dbf2df885490de16cf716451fb047979c0173a2acfc2144cb5e84895f09024a99f02b8af41b3d95e7af64d25d1b5d8c55a89f401fe8e3649834139c0632cdd82ea97fd91cd0edc7ff4203bdf92faeb151835a564949d342207d5480ae040f85530041d15c56f2e3e22a176868931a0c037ef2441f15437c7307633b28e49c6d95a124d5073ee789352f04523021d5641875073ccaf8cd8b33c04988f51501d245190980474953e4db6bcd55bb7244df4b22d3247e9aa464a2b1e5776c43b27ada20c49b216d36511b14a2c3d8b4a583a9ed682c400a745ba3d6e770d72507b7ed6ecfd908a60c00dda509f9415d20509b2f927cc8c6c8f9b12f793890f43222913943313fe1e10c6366b49be7d94132b4f315cb521ca408b9bbaf08816f4af7039bf38b41fb396c791e1bf9e12d77b303ec196c50513a83a357a2a0c38e2ab3659a692952faf78f69604c1f0b5fda50ae547d1f7f0e81390c3db662f6766704e4cce89a213842ddc86d32821bb3f117e35ef056cab106a1a3b3bea72644144f38ddef37ff90fe3ac45fe54465b2d00e3afc5239c26381e606beb25e5aefa211cc722c65c1bb797e8772f2961fd7525d8f860b7628805d20868278d1a1c0ffe517e7b8a2b92e79262b886ae759af6a600a195a7abad73c551efcd4789718fa5a40c62e144468b781322ceeeaa8c674b3f05bdb34c098037c103cc1a264d82b3502cb5890e76318df71df430776e0b556a2f26abf9ad0812c66e6fceb2be19206a5579769e10eca206e46f5c5203940efed6c6781aab1784e34b37774e5528edc2184b41b6618f77cec22abbe337f9931f071354ad63cf01e0c5984070ab0720c11b914446a7bdbd81ca7cd78f7f0f1b64580dfd0f97620a3a904aacea2c9f616c198eef537294edf6fc41ca9c7f6b3a705aa178bc5fa3a4d53e91b10f6cd3784b029bcfc38110dc7c80dc138bcd12b818ed4bbce39316403c5b253872ee3cef96b22f94557d09a06428e8ba70ac3323d63b4c58a04a936bff3397c957f267c5c613cc640a56b83b695318257c8a28397fe6526bf5bc8219a98d7927a4e0a1642dc42c9a1197090b704ed6ffd132eea0b65c5e0f99ad2550484e8f335f839624f6ea4d9d4d04671f356392bcdd2649193735837f5b69a4bd3b1da1d9e2e176c1c9231cee9af22bb7c512c468687e93721f315fee60eadc99a429fc097531349eb964d39d88fe219fe10fa5a67ed0dcd3e8c3c66948e0d3ad8f0c4feb434eb7a37b922ac6542e6f31896d8e46994f0dcc94ef90d413c9bcc4f87f32567da4faffca097f4cd69a3e60caa1338f919ebd2281986f09bb4077d9a2a9a6c3fc27dcaa35187990a5b2e4e1b24bbd0527d850502e9ac361287963a2e3af8303a21ecba27bebe4ac0933ff7ef9404d3ac35658ad4235261d21ecb698a8d4c05724b4b8e6448551a06df4c03cae5498ce66308947fbd09348f8555d4b1d44c5830ca1a79fe0844fcaec5d100ee174849ff9817949bb76a271db811110043ee35a5c24c26e72a78baf10b51449b5db47bee5834a8d8e6cd23a2f7913d4d9ea338bca47cac1ea0430cb0c43e2b07498bddc37de57644446104d540a9f2a93f64384bca3c6922c8738f03e84ac488a5c67782c633f16d8f3b4d0650a7b5de8e836f294ef6a5e275372b054efb04372a0fd880aecddfd2fb7cb161646ec477fbe4a0df603aca3ef0f4211a24b34549ac2c2d39868b438dd8a0b0eed7e714253ef2f59f84b5c3a5e417f00e76233c5bd7abd37435a82404218eaa054b8edaba3d30974fb323f8bcfba696c09dd63ddb2341f195cac0a3f12ca777e141b7ef209ec436ffefb3b8b74fa12cd96ec8c7c76671a033797455edf77a5dd13f890caa4890120ff62217d365a3627fb90d8d5227bf0d718a9c763781b5e4c00fff85ae37c459b04780410cfe7bc1656123d59d4cc345dccc9f8e4e11f1284ba53fc569dbc3933785270760850520c97f00e6cfb01332ab3cc0aa2b050c37f5439fdf77422cdbe96b5cb631de92e67f6dd5fa1a458de524f810a534f3434b4d0cea2af6f181f3a94ad543713d76209ae6cf3b81d73fa4c9d74f59de15c0b7e1b95764404cff74e60512fb3dd671ebd9fb53fc0207d3eabfcb021c98a75bdb3d4424147625369f2ac9517fd2a63cf9e4f52b1ae85c0260363517f1bf137485faba086f8968cd7ef6a9b9e1f0a50e725ec2caefefb24e0fe43b7ca0013b86b2289d48f6a4a315c5ebb794c10b3dfad856dfe056ebd6d45bad79d8888f7f56b5702f9162b071e9e2866c5478885870247fdcb745a6dc3bc6ea479f79625da5e6c20990ec01c0b7f43af113bfd0d3f97f455b7db7f7f9a8b6ca4d9a89707573f98b14520184e2ed8362621b32ebdb0e802b56baa8bbdc8496df075c1154342e808c074adc7e919071abe83842c54ee81249b5f920b355b5cf068386f32dd9ef48098fd32777e80c72740fdbc67309ee7a9363907895ec283b9adebbbc76e71a1296cee25c62a5a6fae8b112f1a957385188b8b44b7d96f31f67cac7e1818936d88679c5674fc8befe72421901ec50613e674363789f620fdf84478b4b0a71e8bf26f7d92fa87db5dd8be73755376f8bdd834354837e0efc047a8e4faf610f673e667731685d768dd02ebcaf6dbdf005dae5baf4192de87149c69e8f78ba7dd8eac04fdebd8e5aff708f486b3a5c0774227b0dbbbe04e5a338a164a69621c6d21b7e6e6c5c1bf0b88fd8498cc28de7ab695775d1e9fe1f2726ec5fa8a2e69cd298ad82f0d968b5085e36804f657567477320809fd34e29c89b59757dde16c97970eaaee5b726e5f14c8e062874e200997b4b50a0152976a54932033a5e6503e4e119b5256f6a32208d92737c9c090e0c44b03d6c1299d79766e1b2b2a18f56870ad4b42a7ef9447301cea6c1fd6766e1d9c0aede4f983195bc161b82a54b422fef18fa526f1864900714cac35678601b1773cc2346c236d8982b99fa920b18e2d3fb62bd3fd08271ff653c42245035093e54c3aee185580d3fc2e7c7d47e69c1ee71f7663a7970102cbb9b57eabf4986557193fbe9bb5de69df41be3a9a0b41bddd99a7c7e69a52e58966430393171ec3035175fd4adb","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"e51cb6d05ed027db058edc159e71b81e"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
