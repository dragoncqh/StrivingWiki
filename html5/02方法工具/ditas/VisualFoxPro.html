<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="zh-cn"><head><meta charset="UTF-8"><meta name="copyright" content="(C) 版权 2024"><meta name="generator" content="DITA-OT"><meta name="description" content=""><title>VisualFoxPro</title><link rel="stylesheet" type="text/css" href="../../commonltr.css">
<link rel="stylesheet" type="text/css" href="../../common-extended.css"></head><body id="VisualFoxPro-35731DEB"><main role="main"><article role="article" aria-labelledby="ariaid-title1">
<h1 class="title topictitle1" id="ariaid-title1">VisualFoxPro</h1>


<div class="body conbody"><p class="shortdesc"></p>
<p class="p">一，概述</p>
<p class="p">Visual FoxPro原名FoxBase，是1984年美国Fox Software公司推出的数据库产品，在DOS上运行，与xBase系列兼容。FoxPro原来是FoxBase的加强版，最高版本曾出过2.6。1992年，Fox
Software被微软收购，加以发展，使其可以在Windows上运行 16bit 版本为 FoxPro for Windows Ver
2.6,中文版为 FoxPro for Windows 2.5b，之后 32bit 版本并且更名为 Visual FoxPro。</p>
<p class="p">Visual FoxPro 3.0一推出，就受到广大用户的欢迎。因为xBase类的语言，如dBase、Clipper等，当时还无法在Windows上运行，于是
Visual FoxPro 成为市场上的霸主。</p>
<p class="p">微软后来又顺势将Visual FoxPro包入Visual Studio中。到7.0的时候，为了因应.NET的发展策略，又将
Visual FoxPro移出Visual Studio，并将Visual Studio更名为Visual Studio.Net。</p>
<p class="p">目前最新的版本是 9.0。</p>
<p class="p">日前，在微软官方网站释出了一份公告A Message to the Community，说明未来将不会再推出 VFP 10，并且持续
VFP 9 的支援到 2015 年，之后只会在 2007 年夏季推出 SP2。2006年进行的 Sedna 专案则是增强VFP对SQL
Server 2005与 Vista的支援，其他的一些专案则已经开源到CodePlex。</p>
<p class="p">VFP <strong class="ph b">3</strong> <strong class="ph b">-</strong> Taz &nbsp; VFP <strong class="ph b">5</strong> <strong class="ph b">-</strong> RoadRunner
&nbsp; VFP <strong class="ph b">6</strong> <strong class="ph b">-</strong> Tahoe &nbsp; VFP <strong class="ph b">7</strong> <strong class="ph b">-</strong> Sedona
&nbsp; VFP <strong class="ph b">8</strong> <strong class="ph b">-</strong> Toledo &nbsp; VFP <strong class="ph b">9</strong> <strong class="ph b">-</strong> Europa
&nbsp; VFP <strong class="ph b">Next</strong> <strong class="ph b">-</strong> Sedna</p>
<p class="p">二，样例</p>
<p class="p">Hello World example:</p>
<p class="p"><strong class="ph b">MESSAGEBOX</strong><strong class="ph b">(</strong>"Hello World"<strong class="ph b">)</strong></p>
<p class="p">Object</p>
<p class="p"><strong class="ph b">loForm </strong><strong class="ph b">=</strong><strong class="ph b"> </strong><strong class="ph b">CREATEOBJECT</strong><strong class="ph b">(</strong>"HiForm"<strong class="ph b">)</strong><strong class="ph b"> &nbsp; loForm</strong><strong class="ph b">.</strong><strong class="ph b">Show</strong><strong class="ph b">(</strong><strong class="ph b">1</strong><strong class="ph b">)</strong><strong class="ph b"> &nbsp; &nbsp; &nbsp; </strong><strong class="ph b">DEFINE</strong><strong class="ph b"> </strong><strong class="ph b">CLASS</strong><strong class="ph b"> HiForm </strong><strong class="ph b">AS</strong><strong class="ph b"> </strong><strong class="ph b">Form</strong><strong class="ph b">&nbsp;</strong><strong class="ph b">AutoCenter</strong><strong class="ph b"> </strong><strong class="ph b">=</strong><strong class="ph b"> </strong><strong class="ph b">.</strong><strong class="ph b">T</strong><strong class="ph b">.</strong><strong class="ph b">&nbsp;</strong><strong class="ph b">Caption</strong><strong class="ph b"> </strong><strong class="ph b">=</strong><strong class="ph b"> </strong>"Hello, World"<strong class="ph b">&nbsp; &nbsp; &nbsp;</strong><strong class="ph b">ADD</strong><strong class="ph b"> OBJECT lblHi </strong><strong class="ph b">as</strong><strong class="ph b"> </strong><strong class="ph b">Label</strong><strong class="ph b"> </strong><strong class="ph b">WITH</strong><strong class="ph b"> </strong><strong class="ph b">&nbsp;</strong><strong class="ph b">Caption</strong><strong class="ph b"> </strong><strong class="ph b">=</strong><strong class="ph b"> </strong>"Hello, World!"<strong class="ph b"> &nbsp; </strong><strong class="ph b">ENDDEFINE</strong><strong class="ph b"> &nbsp; &nbsp;
&nbsp; loMine </strong><strong class="ph b">=</strong><strong class="ph b"> </strong><strong class="ph b">CREATEOBJECT</strong><strong class="ph b">(</strong>"MyClass"<strong class="ph b">)</strong><strong class="ph b"> &nbsp; </strong><strong class="ph b">?</strong><strong class="ph b"> loMine</strong><strong class="ph b">.</strong><strong class="ph b">cProp1</strong><strong class="ph b"></strong><strong class="ph b">&amp;&amp;</strong><strong class="ph b"> </strong><strong class="ph b">This</strong><strong class="ph b"> will work</strong><strong class="ph b">.</strong><strong class="ph b"> &nbsp; </strong><strong class="ph b">?</strong><strong class="ph b"> loMine</strong><strong class="ph b">.</strong><strong class="ph b">cProp2</strong><strong class="ph b"></strong><strong class="ph b">&amp;&amp;</strong><strong class="ph b"> </strong><strong class="ph b">Program</strong><strong class="ph b"> </strong><strong class="ph b">Error</strong><strong class="ph b">:</strong><strong class="ph b"> Property CPROP2 </strong><strong class="ph b">is</strong><strong class="ph b"> </strong><strong class="ph b">not</strong><strong class="ph b"> </strong><strong class="ph b">found</strong><strong class="ph b">.</strong><strong class="ph b"> &nbsp; &nbsp; &nbsp; </strong><strong class="ph b">?</strong><strong class="ph b"> loMine</strong><strong class="ph b">.</strong><strong class="ph b">MyMethod1</strong><strong class="ph b">(</strong><strong class="ph b">)</strong><strong class="ph b">  </strong><strong class="ph b">&amp;&amp;</strong><strong class="ph b"> </strong><strong class="ph b">This</strong><strong class="ph b"> will work</strong><strong class="ph b">.</strong><strong class="ph b"> &nbsp; </strong><strong class="ph b">?</strong><strong class="ph b"> loMine</strong><strong class="ph b">.</strong><strong class="ph b">MyMethod2</strong><strong class="ph b">(</strong><strong class="ph b">)</strong><strong class="ph b">  </strong><strong class="ph b">&amp;&amp;</strong><strong class="ph b"> </strong><strong class="ph b">Program</strong><strong class="ph b"> </strong><strong class="ph b">Error</strong><strong class="ph b">:</strong><strong class="ph b"> Property MYMETHOD2 </strong><strong class="ph b">is</strong><strong class="ph b"> </strong><strong class="ph b">not</strong><strong class="ph b"> </strong><strong class="ph b">found</strong><strong class="ph b">.</strong><strong class="ph b"> &nbsp;
&nbsp; &nbsp; </strong><strong class="ph b">DEFINE</strong><strong class="ph b"> </strong><strong class="ph b">CLASS</strong><strong class="ph b"> MyClass </strong><strong class="ph b">AS</strong><strong class="ph b"> </strong><strong class="ph b">Custom</strong><strong class="ph b"> &nbsp;   cProp1 </strong><strong class="ph b">=</strong><strong class="ph b"> </strong>"My Property"<strong class="ph b"></strong><strong class="ph b">&amp;&amp;</strong><strong class="ph b"> </strong><strong class="ph b">This</strong><strong class="ph b"> </strong><strong class="ph b">is</strong><strong class="ph b"> a </strong><strong class="ph b">public</strong><strong class="ph b">property &nbsp;</strong><strong class="ph b">HIDDEN</strong><strong class="ph b">cProp2</strong><strong class="ph b">&amp;&amp;</strong><strong class="ph b"> </strong><strong class="ph b">This</strong><strong class="ph b"> </strong><strong class="ph b">is</strong><strong class="ph b"> a </strong><strong class="ph b">private</strong><strong class="ph b"> </strong><strong class="ph b">(</strong><strong class="ph b">hidden</strong><strong class="ph b">)</strong><strong class="ph b">property
&nbsp; &nbsp; &nbsp;</strong><strong class="ph b">PROCEDURE</strong><strong class="ph b"> </strong><strong class="ph b">Init</strong><strong class="ph b">(</strong><strong class="ph b">)</strong><strong class="ph b"></strong><strong class="ph b">&amp;&amp;</strong><strong class="ph b"> </strong><strong class="ph b">Class</strong><strong class="ph b">constructor
&nbsp;</strong><strong class="ph b">This</strong><strong class="ph b">.</strong><strong class="ph b">cProp2</strong><strong class="ph b"> </strong><strong class="ph b">=</strong><strong class="ph b"> </strong>"This is a hidden property."<strong class="ph b">&nbsp;</strong><strong class="ph b">ENDPROC</strong><strong class="ph b">&nbsp;
&nbsp; &nbsp;</strong><strong class="ph b">PROCEDURE</strong><strong class="ph b"> MyMethod1</strong><strong class="ph b">(</strong><strong class="ph b">)</strong><strong class="ph b"></strong><strong class="ph b">&amp;&amp;</strong><strong class="ph b"> </strong><strong class="ph b">This</strong><strong class="ph b"> </strong><strong class="ph b">is</strong><strong class="ph b"> a </strong><strong class="ph b">public</strong><strong class="ph b">method &nbsp;</strong><strong class="ph b">RETURN</strong><strong class="ph b"> </strong><strong class="ph b">This</strong><strong class="ph b">.</strong><strong class="ph b">MyMethod2</strong><strong class="ph b">(</strong><strong class="ph b">)</strong><strong class="ph b">&nbsp;</strong><strong class="ph b">ENDPROC</strong><strong class="ph b">&nbsp; &nbsp; &nbsp;</strong><strong class="ph b">HIDDEN</strong><strong class="ph b"> </strong><strong class="ph b">PROCEDURE</strong><strong class="ph b"> MyMethod2</strong><strong class="ph b">(</strong><strong class="ph b">)</strong><strong class="ph b">  </strong><strong class="ph b">&amp;&amp;</strong><strong class="ph b"> </strong><strong class="ph b">This</strong><strong class="ph b"> </strong><strong class="ph b">is</strong><strong class="ph b"> a </strong><strong class="ph b">private</strong><strong class="ph b"> </strong><strong class="ph b">(</strong><strong class="ph b">hidden</strong><strong class="ph b">)</strong><strong class="ph b">method &nbsp;</strong><strong class="ph b">RETURN</strong><strong class="ph b"> </strong><strong class="ph b">This</strong><strong class="ph b">.</strong><strong class="ph b">cProp2</strong><strong class="ph b">&nbsp;</strong><strong class="ph b">ENDPROC</strong><strong class="ph b"> &nbsp; </strong><strong class="ph b">ENDDEFINE</strong></p>
<p class="p">Data handling</p>
<p class="p"><strong class="ph b">*</strong><strong class="ph b"> </strong><strong class="ph b">Create</strong><strong class="ph b"> a </strong><strong class="ph b">table</strong><strong class="ph b"> &nbsp; </strong><strong class="ph b">CREATE</strong><strong class="ph b"> </strong><strong class="ph b">TABLE</strong><strong class="ph b"> randData </strong><strong class="ph b">(</strong><strong class="ph b">iData
I</strong><strong class="ph b">)</strong><strong class="ph b"> &nbsp; &nbsp; </strong>* Populate with random data using
xBase and SQL DML commands &nbsp; FOR i = 1 TO 50 &nbsp;     APPEND
BLANK &nbsp;     REPLACE iData WITH (RAND() * 100) &nbsp; &nbsp; &nbsp;
    INSERT INTO randData (iData) VALUES (RAND() * 100) &nbsp; ENDFOR
&nbsp; &nbsp; &nbsp; * Place a structural index on the data &nbsp;
INDEX ON iData TAG iData &nbsp; CLOSE ALL &nbsp; &nbsp; &nbsp; * Display
sorted data using xBase-style commands &nbsp; USE randData &nbsp;
SET ORDER TO iData &nbsp; GO TOP &nbsp; LIST NEXT 10  &amp;&amp; First
10 (end-of-line comment) &nbsp; SKIP 81 &nbsp; LIST NEXT 10  &amp;&amp;
Last 10 &nbsp; CLOSE ALL &nbsp; &nbsp; &nbsp; * Browse sorted data
using SQL DML commands &nbsp; SELECT * ; &nbsp;   FROM randData ;
&nbsp;   ORDER BY iData DESCENDI<strong class="ph b"> </strong><strong class="ph b">*</strong><strong class="ph b"> Populate </strong><strong class="ph b">with</strong><strong class="ph b"> </strong><strong class="ph b">random</strong><strong class="ph b"> data using xBase </strong><strong class="ph b">and</strong><strong class="ph b"> </strong><strong class="ph b">SQL</strong><strong class="ph b"> DML commands &nbsp; </strong><strong class="ph b">FOR</strong><strong class="ph b"> i </strong><strong class="ph b">=</strong><strong class="ph b"> </strong><strong class="ph b">1</strong><strong class="ph b"> </strong><strong class="ph b">TO</strong><strong class="ph b"> </strong><strong class="ph b">50</strong><strong class="ph b">&nbsp;</strong><strong class="ph b">APPEND</strong><strong class="ph b"> </strong><strong class="ph b">BLANK</strong><strong class="ph b">&nbsp;</strong><strong class="ph b">REPLACE</strong><strong class="ph b"> iData </strong><strong class="ph b">WITH</strong><strong class="ph b"> </strong><strong class="ph b">(</strong><strong class="ph b">RAND</strong><strong class="ph b">(</strong><strong class="ph b">)</strong><strong class="ph b"> </strong><strong class="ph b">*</strong><strong class="ph b"> </strong><strong class="ph b">100</strong><strong class="ph b">)</strong><strong class="ph b">&nbsp; &nbsp; &nbsp;</strong><strong class="ph b">INSERT</strong><strong class="ph b"> </strong><strong class="ph b">INTO</strong><strong class="ph b"> randData </strong><strong class="ph b">(</strong><strong class="ph b">iData</strong><strong class="ph b">)</strong><strong class="ph b"> </strong><strong class="ph b">VALUES</strong><strong class="ph b"> </strong><strong class="ph b">(</strong><strong class="ph b">RAND</strong><strong class="ph b">(</strong><strong class="ph b">)</strong><strong class="ph b"> </strong><strong class="ph b">*</strong><strong class="ph b"> </strong><strong class="ph b">100</strong><strong class="ph b">)</strong><strong class="ph b"> &nbsp; </strong><strong class="ph b">ENDFOR</strong><strong class="ph b"> &nbsp; &nbsp; </strong>* Place a structural index on the data &nbsp;
INDEX ON iData TAG iData &nbsp; CLOSE ALL &nbsp; &nbsp; &nbsp; * Display
sorted data using xBase-style commands &nbsp; USE randData &nbsp;
SET ORDER TO iData &nbsp; GO TOP &nbsp; LIST NEXT 10  &amp;&amp; First
10 (end-of-line comment) &nbsp; SKIP 81 &nbsp; LIST NEXT 10  &amp;&amp;
Last 10 &nbsp; CLOSE ALL &nbsp; &nbsp; &nbsp; * Browse sorted data
using SQL DML commands &nbsp; SELECT * ; &nbsp;   FROM randData ;
&nbsp;   ORDER BY iData DESCENDI<strong class="ph b"> </strong><strong class="ph b">*</strong><strong class="ph b"> Place a structural </strong><strong class="ph b">index</strong><strong class="ph b"> </strong><strong class="ph b">on</strong><strong class="ph b"> the data &nbsp; </strong><strong class="ph b">INDEX</strong><strong class="ph b"> </strong><strong class="ph b">ON</strong><strong class="ph b"> iData </strong><strong class="ph b">TAG</strong><strong class="ph b"> iData &nbsp; </strong><strong class="ph b">CLOSE</strong><strong class="ph b"> </strong><strong class="ph b">ALL</strong><strong class="ph b"> &nbsp; &nbsp; </strong>* Display sorted
data using xBase-style commands &nbsp; USE randData &nbsp; SET ORDER
TO iData &nbsp; GO TOP &nbsp; LIST NEXT 10  &amp;&amp; First 10 (end-of-line
comment) &nbsp; SKIP 81 &nbsp; LIST NEXT 10  &amp;&amp; Last 10 &nbsp;
CLOSE ALL &nbsp; &nbsp; &nbsp; * Browse sorted data using SQL DML
commands &nbsp; SELECT * ; &nbsp;   FROM randData ; &nbsp;   ORDER
BY iData DESCENDI<strong class="ph b"> </strong><strong class="ph b">*</strong><strong class="ph b"> </strong><strong class="ph b">Display</strong><strong class="ph b"> </strong><strong class="ph b">sorted</strong><strong class="ph b"> data using xBase</strong><strong class="ph b">-</strong><strong class="ph b">style</strong><strong class="ph b"> commands
&nbsp; </strong><strong class="ph b">USE</strong><strong class="ph b"> randData &nbsp; </strong><strong class="ph b">SET</strong><strong class="ph b"> </strong><strong class="ph b">ORDER</strong><strong class="ph b"> </strong><strong class="ph b">TO</strong><strong class="ph b"> iData &nbsp; </strong><strong class="ph b">GO</strong><strong class="ph b"> </strong><strong class="ph b">TOP</strong><strong class="ph b"> &nbsp; </strong><strong class="ph b">LIST</strong><strong class="ph b"> </strong><strong class="ph b">NEXT</strong><strong class="ph b"> </strong><strong class="ph b">10</strong><strong class="ph b">  </strong><strong class="ph b">&amp;&amp;</strong><strong class="ph b"> First </strong><strong class="ph b">10</strong><strong class="ph b"> </strong><strong class="ph b">(</strong><strong class="ph b">end</strong><strong class="ph b">-</strong><strong class="ph b">of</strong><strong class="ph b">-</strong><strong class="ph b">line</strong><strong class="ph b"> </strong><strong class="ph b">comment</strong><strong class="ph b">)</strong><strong class="ph b"> &nbsp; </strong><strong class="ph b">SKIP</strong><strong class="ph b"> </strong><strong class="ph b">81</strong><strong class="ph b"> &nbsp; </strong><strong class="ph b">LIST</strong><strong class="ph b"> </strong><strong class="ph b">NEXT</strong><strong class="ph b"> </strong><strong class="ph b">10</strong><strong class="ph b">  </strong><strong class="ph b">&amp;&amp;</strong><strong class="ph b"> </strong><strong class="ph b">Last</strong><strong class="ph b"> </strong><strong class="ph b">10</strong><strong class="ph b"> &nbsp; </strong><strong class="ph b">CLOSE</strong><strong class="ph b"> </strong><strong class="ph b">ALL</strong><strong class="ph b"> &nbsp; &nbsp; </strong>* Browse sorted data using SQL
DML commands &nbsp; SELECT * ; &nbsp;   FROM randData ; &nbsp;   ORDER
BY iData DESCENDI<strong class="ph b"> </strong><strong class="ph b">*</strong><strong class="ph b"> </strong><strong class="ph b">Browse</strong><strong class="ph b"> </strong><strong class="ph b">sorted</strong><strong class="ph b"> data using </strong><strong class="ph b">SQL</strong><strong class="ph b"> DML commands &nbsp; </strong><strong class="ph b">SELECT</strong><strong class="ph b"> </strong><strong class="ph b">*</strong><strong class="ph b"> </strong><strong class="ph b">&nbsp;</strong><strong class="ph b">FROM</strong><strong class="ph b"> randData </strong><strong class="ph b">&nbsp;</strong><strong class="ph b">ORDER</strong><strong class="ph b"> </strong><strong class="ph b">BY</strong><strong class="ph b"> iData </strong><strong class="ph b">DESCENDING</strong></p>
<p class="p">ODBC Access using&nbsp;SQL&nbsp;Passthrough</p>
<p class="p"><strong class="ph b">*</strong><strong class="ph b"> Connect </strong><strong class="ph b">to</strong><strong class="ph b"> an ODBC data source &nbsp; </strong><strong class="ph b">LOCAL</strong><strong class="ph b"> nHnd &nbsp; nHnd </strong><strong class="ph b">=</strong><strong class="ph b"> </strong><strong class="ph b">SQLCONNECT</strong><strong class="ph b"> </strong><strong class="ph b">(</strong><strong class="ph b">"ODBCDSN"</strong><strong class="ph b">,</strong><strong class="ph b"> </strong><strong class="ph b">"user"</strong><strong class="ph b">,</strong><strong class="ph b"> </strong><strong class="ph b">"pwd"</strong><strong class="ph b">)</strong><strong class="ph b"> &nbsp; &nbsp; </strong>* Execute a SQL
ccommand &nbsp; LOCAL nResult &nbsp; nResult = SQLEXEC (nHnd, "USE
master") &nbsp; IF nResult &lt; 0 &nbsp;   MESSAGEBOX ("MASTER database
does not exist!") &nbsp;   RETURN &nbsp; ENDIF &nbsp; &nbsp; &nbsp;
* Retrieve data from the remote server and stores it in &nbsp; * a
local data cursor &nbsp; nResult = SQLEXEC (nHnd, "SELECT * FROM authors",
"QAUTHORS") &nbsp; &nbsp; &nbsp; * Update a record in a remote table
using parameters &nbsp; LOCAL cAuthorID, cAuthorName &nbsp; cAuthorID
= "1001" &nbsp; cAuthorName = "New name" &nbsp; nResult = SQLEXEC
(nHnd,"UPDATE authors SET auth_name = ?cAuthorName WHERE auth_id =
?cAuthorID") &nbsp; &nbsp; &nbsp; * Close the connection &nbsp; SQLDISCONNECT(nHn<strong class="ph b"> </strong><strong class="ph b">*</strong><strong class="ph b"> Execute a </strong><strong class="ph b">SQL</strong><strong class="ph b"> ccommand &nbsp; </strong><strong class="ph b">LOCAL</strong><strong class="ph b"> nResult &nbsp; nResult </strong><strong class="ph b">=</strong><strong class="ph b"> </strong><strong class="ph b">SQLEXEC</strong><strong class="ph b"> </strong><strong class="ph b">(</strong><strong class="ph b">nHnd</strong><strong class="ph b">,</strong><strong class="ph b"> </strong><strong class="ph b">"USE master"</strong><strong class="ph b">)</strong><strong class="ph b"> &nbsp; </strong><strong class="ph b">IF</strong><strong class="ph b"> nResult </strong><strong class="ph b">&lt;</strong><strong class="ph b"> </strong><strong class="ph b">0</strong><strong class="ph b">&nbsp;</strong><strong class="ph b">MESSAGEBOX</strong><strong class="ph b"> </strong><strong class="ph b">(</strong><strong class="ph b">"MASTER database
does not exist!"</strong><strong class="ph b">)</strong><strong class="ph b">&nbsp;</strong><strong class="ph b">RETURN</strong><strong class="ph b"> &nbsp; </strong><strong class="ph b">ENDIF</strong><strong class="ph b"> &nbsp; &nbsp; </strong>* Retrieve data from the remote
server and stores it in &nbsp; * a local data cursor &nbsp; nResult
= SQLEXEC (nHnd, "SELECT * FROM authors", "QAUTHORS") &nbsp; &nbsp;
&nbsp; * Update a record in a remote table using parameters &nbsp;
LOCAL cAuthorID, cAuthorName &nbsp; cAuthorID = "1001" &nbsp; cAuthorName
= "New name" &nbsp; nResult = SQLEXEC (nHnd,"UPDATE authors SET auth_name
= ?cAuthorName WHERE auth_id = ?cAuthorID") &nbsp; &nbsp; &nbsp; *
Close the connection &nbsp; SQLDISCONNECT(nHn<strong class="ph b"> </strong><strong class="ph b">*</strong><strong class="ph b"> Retrieve
data </strong><strong class="ph b">from</strong><strong class="ph b"> the </strong><strong class="ph b">remote</strong><strong class="ph b"> server </strong><strong class="ph b">and</strong><strong class="ph b"> stores it </strong><strong class="ph b">in</strong><strong class="ph b"> </strong>* a local data cursor &nbsp; nResult
= SQLEXEC (nHnd, "SELECT * FROM authors", "QAUTHORS") &nbsp; &nbsp;
&nbsp; * Update a record in a remote table using parameters &nbsp;
LOCAL cAuthorID, cAuthorName &nbsp; cAuthorID = "1001" &nbsp; cAuthorName
= "New name" &nbsp; nResult = SQLEXEC (nHnd,"UPDATE authors SET auth_name
= ?cAuthorName WHERE auth_id = ?cAuthorID") &nbsp; &nbsp; &nbsp; *
Close the connection &nbsp; SQLDISCONNECT(nHn<strong class="ph b"> </strong><strong class="ph b">*</strong><strong class="ph b"> a </strong><strong class="ph b">local</strong><strong class="ph b"> data </strong><strong class="ph b">cursor</strong><strong class="ph b"> &nbsp; nResult </strong><strong class="ph b">=</strong><strong class="ph b"> </strong><strong class="ph b">SQLEXEC</strong><strong class="ph b"> </strong><strong class="ph b">(</strong><strong class="ph b">nHnd</strong><strong class="ph b">,</strong><strong class="ph b"> </strong><strong class="ph b">"SELECT * FROM authors"</strong><strong class="ph b">,</strong><strong class="ph b"> </strong><strong class="ph b">"QAUTHORS"</strong><strong class="ph b">)</strong><strong class="ph b"> &nbsp; &nbsp; </strong>* Update a record in a remote table using
parameters &nbsp; LOCAL cAuthorID, cAuthorName &nbsp; cAuthorID =
"1001" &nbsp; cAuthorName = "New name" &nbsp; nResult = SQLEXEC (nHnd,"UPDATE
authors SET auth_name = ?cAuthorName WHERE auth_id = ?cAuthorID")
&nbsp; &nbsp; &nbsp; * Close the connection &nbsp; SQLDISCONNECT(nHn<strong class="ph b"> </strong><strong class="ph b">*</strong><strong class="ph b"> </strong><strong class="ph b">Update</strong><strong class="ph b"> a </strong><strong class="ph b">record</strong><strong class="ph b"> </strong><strong class="ph b">in</strong><strong class="ph b"> a </strong><strong class="ph b">remote</strong><strong class="ph b"> </strong><strong class="ph b">table</strong><strong class="ph b"> using </strong><strong class="ph b">parameters</strong><strong class="ph b"> &nbsp; </strong><strong class="ph b">LOCAL</strong><strong class="ph b"> cAuthorID</strong><strong class="ph b">,</strong><strong class="ph b"> cAuthorName &nbsp; cAuthorID </strong><strong class="ph b">=</strong><strong class="ph b"> </strong><strong class="ph b">"1001"</strong><strong class="ph b"> &nbsp; cAuthorName </strong><strong class="ph b">=</strong><strong class="ph b"> </strong><strong class="ph b">"New name"</strong><strong class="ph b"> &nbsp;
nResult </strong><strong class="ph b">=</strong><strong class="ph b"> </strong><strong class="ph b">SQLEXEC</strong><strong class="ph b"> </strong><strong class="ph b">(</strong><strong class="ph b">nHnd</strong><strong class="ph b">,</strong><strong class="ph b">"UPDATE authors SET auth_name = ?cAuthorName WHERE auth_id
= ?cAuthorID"</strong><strong class="ph b">)</strong><strong class="ph b"> &nbsp; &nbsp; </strong>* Close the connection
&nbsp; SQLDISCONNECT(nHn<strong class="ph b"> </strong><strong class="ph b">*</strong><strong class="ph b"> </strong><strong class="ph b">Close</strong><strong class="ph b"> the </strong><strong class="ph b">connection</strong><strong class="ph b"> &nbsp; </strong><strong class="ph b">SQLDISCONNECT</strong><strong class="ph b">(</strong><strong class="ph b">nHnd</strong><strong class="ph b">)</strong></p>
<p class="p">参见</p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VFP/Microsoft%20Visual%20Foxpro%206.0%E4%B8%AD%E6%96%87%E7%89%88%E6%95%99%E7%A8%8B--%E5%88%9D%E7%BA%A7%E6%95%99%E7%A8%8B.rar?attredirects=0" target="_blank" rel="external noopener">Microsoft Visual Foxpro 6.0中文版教程--初级教程.rar 1366k</a></p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VFP/VFP60Help.chm?attredirects=0" target="_blank" rel="external noopener">VFP60Help.chm 1729k</a></p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VFP/VFP%E5%85%A8%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B.chm?attredirects=0" target="_blank" rel="external noopener">VFP全系列教程.chm 2218k</a></p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VFP/VFP%E6%95%99%E7%A8%8B.rar?attredirects=0" target="_blank" rel="external noopener">VFP教程.rar 4709k</a></p>
<p class="p"><a class="xref" href="https://sites.google.com/site/deepcast/Home/technic/codinglanguage/VFP/%E3%80%8AVisual%20FoxPro%206.0%E7%A8%8B%E5%BA%8F%E8%A8%AD%E8%A8%88%E3%80%8B%E9%9B%BB%E5%AD%90%E6%95%99%E6%A1%88.rar?attredirects=0" target="_blank" rel="external noopener">《Visual FoxPro 6.0程序設計》電子教案.rar 1915k</a></p>
<p class="p"><a class="xref" href="http://www.hentzenwerke.com/" target="_blank" rel="external noopener">Thoughts about Visual FoxPro 10</a></p>
<p class="p"><a class="xref" href="http://www.gz9f.com/" target="_blank" rel="external noopener">VFP爱好者站 我的帮助</a>&nbsp;<a class="xref" href="http://www.myf1.net/" target="_blank" rel="external noopener">www.myf1.net</a>&nbsp;<a class="xref" href="http://www.gz9f.com/Article/ShowArticle.asp?ArticleID=62" target="_blank" rel="external noopener">使用Visual FoxPro建立自己的框架</a></p>
<p class="p"><a class="xref" href="http://www.meizvfp.com/bbs/index.asp" target="_blank" rel="external noopener">梅子Visual Foxpro论坛</a>&nbsp;<a class="xref" href="http://www.meizvfp.com/bbs/dispbbs.asp?boardID=16&amp;ID=1467&amp;page=1" target="_blank" rel="external noopener">VFP全系列教程</a></p>
<p class="p"><a class="xref" href="http://blog.csdn.net/yasur/archive/2004/09/05/95399.aspx" target="_blank" rel="external noopener">VFP与Flash之间的相互控制--数据交互</a></p>
<p class="p"><a class="xref" href="http://fox.wikis.com/wc.dll?Wiki~FoxProWiki" target="_blank" rel="external noopener">FoxPro Wiki</a></p>
<p class="p"><a class="xref" href="http://community.csdn.net/Expert/TopicView3.asp?id=5504164" target="_blank" rel="external noopener">VFP永不过时（2）</a></p>
</div>
<nav role="navigation" class="related-links"><div class="familylinks"><div class="parentlink"><strong>父主题：</strong> <a class="link" href="%E7%A8%8B%E5%BA%8F%E8%AF%AD%E8%A8%80.html">程序语言</a></div></div></nav></article></main></body></html>