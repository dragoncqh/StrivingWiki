<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"20816ce9e1d21bc07bb033fc80daa6de11f8534bdf5976a749106f371ad5c2e2296cf6fee2088717934ae36878a7897f8021e4add1d8a7fe44d351b5992314c555f48c7b1ab137c87d604bffcb70fe2cc0a4123f77fec5e350dd71bc803b91b623420aafabfbc3880e92c324e043eb7b56d6f5b31db77265a121b053aa64f8656b7939fb1e6eedd7e08abf70f0827a83fd858493839d9a63fe7792ef18b15beacfba2563d8e990b385ef0ea3ce31bb9e02c692fb06d6583b9f9d4dc071d43e5e5123cf70f683439cb2882aeade3dff63d4b311edae2bd5a579a71906180e02fdf82dba776e1395299de5a2699bb88734df8ec051a560ee472805788e12ac28258362e4e868250d01da8ff861de5cad528f9b70076a0f7dfeb8dab9daa513295959ca4a939ee672a7b644e559a6e07092532195405fe3aa966f698e30b1bf7cc5f70005ebdf7ab83a9e8eef63baa506a83c64af5d12cb0edb339d746348d045fc572747661c52a7cbeefee86053eda9e02ee582774528164aca39b6bd18892059bc5dc296fac99ce94358dd5e9cd019e5c15f88ecd172f412c29b30a43ec17780046af872ed6bc184e675d1c641f7678df25e9e7fd13addb3d81c9bdbde8a5fcd551b73a7db66a595d3c32dabb195c0b30448beeb9bdafad17331e29a7bfe5fab397087abd7bcd176d8e1e15e27f9b06c437c17b2355111bd04fa1f54cd45c46ffcf11f2c99d9d9e22822691d6cb84072fbbf50a8178125fac26a8298ce5111424ec500b708048b3cb37aeb915741fb746a134de1a0bb403cdd0580e631fe2f75e2df2751fe0cad0041cfb156b938bf1ca48ae74ba9017857434a06df9d5a79fb160dda96795bea5790403fa2b1727ba339820af711232d5b8bda9987153ba5df89c0df2a934b6ebc54a6c000c86a633b89bb899f94c889f1b79bfceb30ecbb35e3f89f60fe44f38bda07a7ee44acb093763ce9d699c404a166148632633dbe8329fd4103c3d79324f6d62bf6891e7306bf4b471691c4143a1b0640b34da8bc8496ecdce441263a2fb72bda358506ef79921f426f5aa96ebc37755aab26fb27acc656b930f2a7a953ce94fa7ea222b8213f19902e8478a5130832bf248a906451c3238a27bdf958b286a8cccd2d0f7133d7387a95cfc98c68663db1d5ef393acb4069e62e9caa5625d249653c80283dc4631fc81bbad26e25150e9f695d732b73c9cd2fb179b1334f39f020a6e573efb76bbd10f23994c5b8d2101cdb7f2a5daff9d62c0a5c57c5c6bdeffc2c64111f4415d6cd2cb4f38822378e5de63e6ba70131b364c23c4a7ee17b53c74f02525d72eba4cdca5fd372b96550c93af703ee3cdb8327f870f83afd657a681b10795fb6ee3088154d535ad0d0c0bab58f554deff99d600b39df7840b0caaa584261637b7f28f06ef91f2e3c13918671871b5f85dc9472e18deb4879a4f9663568131cdd60d643aa09b4bd6ad10771ed73d66c2faead6624c21b4bcce1bd45d1a9f2fa0fd139d87f77e8713531be0d6fd709d70e40fa4d475aeebebdcf510afa5d364f3ed7e04050106d46edcf232e8832eb44188cc896b1eed50f2dd8d02104e34ab44a0a73e20ea69f0a4f2ad07aca7b20af006c87c537b7cd2ef6dbd8abcf2fa33a5c6a011feb5adcbbbb7b8ee2ba88942c594b880bcd238d09a349105f1c41180e807b510d44f0f81ed70d09c291a86c06c3e5cfb8575c22c1eac87bcb532272567b0188bb6cefb6972a8b5b2f9b303a76263b4b14fa500749d174a66a01522f3780ef10823705da927b5dd225901f94d7f4013b45fd779d870011151e945583137c2609fd025fa28376880ea8b0793025fff29050cecd88429ec738701a5a5d10deada33a1634b0fd5d9cedd0d98d4635c0c3fea9f7f374d9b95223c1beeb83777e640b2e15dc2bf0a100d4436f05f1546510b92ce4de2e56c731c711598527f26494431654fb51e07cfcf6ac72f555d5a9a4d9285ab547a5a6eabfdaa466dcb87a6f0c5f0072857eedaec1eafd04ba9710e935f0672c82e466286b041b9e9487de31a04b48e527946ba30df4ed54b880fb02af9e213465306b235b15423f2ee70b2f2c9c0caa7f348f50f9da465b2df6e0da0835771d4ff4d404954b7c1fa4029d7f59ad1aa66e49480a20df9e4bc818d4de54ba4faaff3ca0c93f3e405604822c1eafed631e0b6baf0269229618c4c61798a0655e75cdbab878420ce91f0bfad0f4430772afec12818cc5f3b1b677e2a392805dd7aa9ddd3abd48cf483054a8aa0234c39ad56d87a96c584356e8f61fb0bf2aa4393f09995fb0c360e5245deaba3ec8ebe7d97b99590405c0e6eb629172fd8ac4a6ce14dc8d2efc5769ba8b02ff99221c6f8b282b6470bed5fc8afa394af8a78187522585700fe1517ac05233ffc7fb1c7d287b14574b9d6a8c587be0de5a5b732682bbd0471f9e62b1c8431d9279fb8c31b20e53e1376bc90c86c0c945468602e370fdeb9dbc825a48c0d391575a122cd7ef3aa0f3bcff318e0828a376bfcdec98ea626a66b0b6d5c6ec84ee93bb853f6f5de9308fc243a4bbe529380018e28a0e420814909db5e7c0e32f71ee603d05e9900c23fe45386314455ac51201c9734f417bb73442b6682000a1a8c589c026d1e49ee988bb5afb9f3197bda6fe8d203bc88cfb09e7568674f480fac8f7b424d2b57852900b020a59d68611db442f56fb32618180875c491fe072a1237668635e4df3e25ef8ac94b2286ac804c5b76196e01f1f71fb424de5279aadd41055c3d9a196e63d21b9cadc8842a6ec292b425547b846f292543fb9bf69b3a556a12518d3db622cca926e2f17a9c3b7e704ad39d3795d454e5a186c105732126cbc61c9031bf21b95d41ea12be1c1eff5bae7bb3c8e329d0f3f8cba517b0cf6cf741ff9028d3862fbd48d4a4a5d446244fab5bc28166e545fe5e0eb1ab4909ebeef4f1688434e6c7fde1627e1f15728aef3b7a0858898a4f11f2941a82d7d439e7d133ef4e0f452aa5e03b0b7bb4bf643153592daa95d811ad464fcc0ba8fc10a790674d4759335d34edd58ce8a51a7cfed5f6bc2dc1d893517ff3b7855453f371d98b90d27db333d4f7274a26b818c0c12f3a1352a8c2d2bf41041b1cbf377bf3720d5b899a6e2f3aadf91f3b766eb79dab47d72643e526a4efea3be9b8d647ad09976e99d4338dad9a5b8ee57ed4d6eaa570d8b58929cc805355727deb26019e7c59a323e875d8e51eee66c8e0044703aad89258fa62352e978fe7866d2262952325cb0a48514523716de3b617181b447969faacad1300f0ee50f135a7b5360c5ad5ab18f5a64ea326b6ae753a7e703e8a2a294de13515ba012929b2b037f6a55d00b99e4079b10f66d5566d30daa4d29a9086fe6772ff1e69fdde4170c5db90e831d69ee83271ece2ac5b29ee4d1b7593850e9fa77fe4249163d7b0cb92c889f0d25c541a02fe0621386928d7a3d3795a9aa3df556864ae44605cca5a733408c73b5bc5a470dff2a3bb434c5ca75547410b049a828c47e714404cf5cbefc402fc3e72d35a8ea953038f5dc9d6b535fb5c4d15048e7ffdbc3cf08b01758ad0298c535e4f641a00d4a4c96414abb8c56bbf2ffcd862ec766cac6e5df4bba17f569f44f7b8165234850a1a3eb5c384c2415d5dee7b59e3c0de116fe8d2f024f2eed4e4e0e8615c64bf90dfb251e2d8ed33a2d1c7676a96033a6c5ec14bd9d6f781d17e7157e646753fe58a6111988a0b13b8846470d33ac9522fcf228ea0e194e23822785a553dd568cd58f5a453942d006bb3572764a4f44c8dc8c53a041168341e3792e11a4a7102b62456d5ebb822a7e3bf4044319173878abab1c61fc89be1d36c8ffe097f641385fbcdcd8d33fd62963af1fa04f68ab086417a4b4e44e9f8e7e6ea6186dbf54007512fbc9897c2ff797c711fee0c4b08bb4a79c491dbb10eb9758a04d065dcf35db8f19eba7e6a4cc74951c184c76e7a663cf3206d3e85a80994f471318d9416cfd23886a22538bb931b8be21820140a3abfb082b98f967bca2f5b4d1a63880d597fc0fa8718fd98606d48112a43532749be20b9936652cd9909d2b09e2cc48418d8868bb32c84771c503eed718b6fe68fc1e68e775f6dbab3e1aac4d9d52ae7ab65db70c4ee6a4118159c73ed18ff871c15277864ebf38e3716284043f5bd1ad5a5f4f25a5f67f81b75d2a2585dc61a57f7a39f47d0312e5127ffe2d24f098cb3588d4db88c9fd26f16c9efc990e3e6b651963dd181e095b734493030db94dea8ed6f6c1f28f30572f6043f8d0bea609e3bf49561cef9dcad05302aa304eef00bf994a4f52d9fb0138db7bcbc97995a246e043ff4f3ba74cd74f44e9f1f67f316e9a78ec1fdf5ef477a06b2a47ee93d04d32df74706db458b9e343bb2652198985f82707846caf0f90c14a6a6cc244b241ead53629812f5c84d880f36c8c308d75ebe77ceacd6892f95820738850719b71b6dbb66e0cc843dedbea40a0bcd34e65d085b1800a419b247786164d67b46e9ce61eb0a05f6f5fb0c25b33e413d5178808857c6a883e89e43946982de2fd44c531a2019a2286834ea49d7cc0e1608b66634d7e7ccd1b2c8e54c4ac53bb88863c5b795e689ecf4a5bd59c8d6fa8b4049535d035a31cbf395f56721ccc8df77db0f1d6e518102f222c3bdd34eba097570bafd5bfd0aab9a6e0a7ab71a404fd3e37135d7dae68b9bb37334d3d193973e906247c320e8a6aff12698f86a11ed063a9e9af0749b750d8db8582aeb06f13d1e4fd9365abb869aede020cfb6a9b30b8bfe181fc19211d7576f62d9d167efafb5a206e3f9572e78b3fa34cd370d3d30a36064e8727f7dc4d5d31112264735ebfa6bb603c84f2fce2249de4ed52dc6913532fc8eee1eb999fa075ea9720a02edb8b83fa8006f437d537bbfe0a6f603a310ffa503b431c85bcbfbec71db4c0a551905bbbd4cff1c694eb49a251175ed5002d3f7477d938da73f5716851a47b484a8c7e143ce16457210eab9a1825ccb1f3cfe7ecfe67cea17831456e040435ff8df423d60404ede5161322eeea7382aa7b1dfcc61911e3ae9a3d486c931e6eaeaa055fc27cbdfaba4e8221510c8c068ccf45aac3c0f3224da187c05b6bf3c3f6b6c8a8f34a6a41454a5bfc6c1ff972b5e725e6636556434a0ea1005d1c1cd182dc01f9d6e68ed65a3a61eb7f8e618f325d3357b58fa91dbef1d507ae1607df312641ba2bc366dfa863b329ff59cd79c41045f6e9624399c09062bf96ef873a20f9de430edb8b34b8f8a9258de44e80850579040e698905746aa7edfa465eb5790c4a13e731d8813dd2c8ec44019fa61068fc208b48414368156a8827b9961e30e76e3a813a8f736ce1a1992e84def12b8a8b17e81a749ca933aa0179038a4968699d7a606b5293884fdf63ddfab0854171ac48906ef855300b0490434d6d52552daa3b0c0b4d541753c8467df9335a4a4cc19fca4cba4832a987d456f744176d8d91e94dbd8a1ce2e88e175a265035e8f204da050e868d091b8beba29a272e296f86b0843f4e4645cf6a9bebd27e5f8813a7aab137bc031b42f37c49ca8f08773e98661c29b4e043403cd1a736b742855052cb039dcafc9a4d36ecb935895fad9685353b1680ffbf740746b92091ffd8e42bf8539eee12383e5e3e28309a0c8046d7fd0525e0d2817118d782e6733c0bf3b575e253a5970f54b9a0744509793226475a916dfc6e3ccb2f31cae05871de6d8963d7c51f028fbb38f48c021e33e5a45eedb067d1117307ac4a8af1546460ebb4f26d0b6870aa90e624a0e606c2b16436c376d71d9f38d51b33384c6bcc2098937416edeeb74da38f2dab58d9a59231b96ce05f1952dc4c0832d7023f6004fc3c835e1f1f80e0f88c87ce57e50bc634be03f5082f2aec171f3f253d9c13ad838db9fbb4ef0f8cbf89e7671525cff1227b3a31d16312c2755e3b453f0477a8d5e81828ea882ed51ebadf8f83f7e36b0536f0f77fd2af5f93a258189ea002cccf6c22df6a37d3461dcd7ef807fc20586af14bfb0429a39765c7c382d546f88c0798aa0a6153565c2bdc5bbbc6171c17f737ca7205d58e3805fd93b84ca660ac33adefcb1b669e97b24229a0071e8c7609165dc1a9c665f538aed60eec7e310a4c54f8cdc64b06a039c2016fc918b3bcb6d63606fffd10b988b655d51795be71454cad27e3d3acabdd4a1ad656e2e0db545ea2d3e08ae7bcac95b07a2e082b77289725d8b71d84a2828d67c74246f495b07b70a169f27f34211d8fceff87926f91fad457ff0464293bee7c1e607f41081011b685ed3e3ff88845d889db8a883d89cee9c2b2c57ec9dbff6621e518b29a1f5515e80e7aafa163a07160f21af1f2d068af9bbfe9046c5cf47dd488fbb59db9f4cc03dc43fc4192309e4156a1106a89bed76b61394e27762ecb38a7caa407c8984abd88af3e65fb11690f31fd10cff05ad3d059c4a33708bea4c09c29a58dceffbf05e4b7745c0ec44052f59d9c5936f3f83d2fd1ffdc51676e898b365a0f56f73d192634dd4681829509280ab44d0aa4773cce3691c49f2178b96e9222c61c696adeed620a23a6f5a017a954bfe598a88946c9052693587178aced00cb40a8f4732045994084c90c1ac2a4a8bc06b5f72ab52c5b1a8cb6c277101539593980d8084eb4d7449565fc18fb40684ac8ac0123cf3d10d80f8f9d146876b8e539ad6ddb8f4eac738cda8f5f465713b3b64dee20621c7fdc0381b36b520645c03b2896de0ca4eca90e6001f0a3dce064afecac9f813fd209693266512f58423c70dab1cd9cc88b15e907559dd0d4accfd5229cdb673d686ec1c666f0a6b9e421cf467c534e9b29a4d893047f579f9c494319c397f49a6001df9b5a1d5eaadbdeeb481444bc6737e49265ddf9956f9872458cc922f6b827555bcbed2afc3cb13934615afb3f024ad782b0cfda6df1cb09a66888c3b8b2cfb1dbf64bacab9da8e000ddd420204b31961482794973740e13c5d49a85149791fb1bd0e872eebfa1d635823acf733376328b75eac6725ff06c13f4408d4382cf50a713b595c6a2f5828ea925bc622b9e6fc6054e2ce4d4597961b9ba492cbe7e091acd10038bc7907d5e79e73b0ab6583d3a8b13bf75f61d8d69f7daf4a6c31295ef68a338683e51146ff8c314207fea02fb7898ba6aecf7227ae69d3381574758dea331b5d5101b1f2fd35d54a5727267e44c77ddf137d81ad3a8db7f745e6d30adb0d14703805c60ba710713dc294d3a70309eee1422b3bb105a7d0fd98da9a8c611e8bd5ab92efde6356a12b07d0aa7c527f3ba5164f886addcf3cb59ae2bb3c93244e9def7823364a79a2e068ff6f481b3acb22a908a83eb03de3b76f922b0b68ca6fcf365d259cdca4e724b85febd114101e6d29db6d9bfa49eb38c0cd01e70560caa7ee9351d6beb58ff035667c787b5a0bdc425b4022932981ca9636fb42a0e30370cca84d92dd053ebbc6a9cebe2408a9895670db2e750362f41c2cbf9936f5af8996e9c83e32362fcf92ff8a5c21829f52815d6ffdd2e4a09855b3e5602a2f9d3b3c4bda8ad0ca40267c499648b617ef9b77396f7c0a541aa47e3e4103a17ad7ecdbef9ff133f9abedc959a091be207a3657c1de7cd2adec81227ea0c3247ef08402fde5612d2a965dc46a1dcf0200bc30ae728207f6d1296484a34afe28613ca8da2e364703740773ecb701b23986c21b8450ed26d11ad657321563eded308d4670c93477a26bb8beb995af5980b8ff80a2c4be7d517603683fa1f5ebdd6ee61e63bd3f4b0d1c72256e6e54e5943d2afdd65427164736a7c5ae755e87cb57c89b3b65808617524f00490f826ce02cee49c93429aad8484612d424f92e2644c26f275f945df62508e94894046423936b4f8798645fadcb996b17a0b4c0440495acbffb23b4fcbdf0d23b3c9fc6a841973abf15bedf43c422fc316f641862b68e7db30b336ec01e0ab65fab065ea6d063fe539da54cd82a1cdd7078ae51ceda5292f89d8dc64b792f63217d82ad98f4965ad91b668930dba3161ac6e3b8734a6094746374b894c933575b9d65d0a5026ab19bf89206ffb4c14a4626209f9dc2e845f398d07ca23bee1252cd6a2526305c5c0d1bda0d0cef2949d8c34ced6ec4b6cde896ee0251aa6d4b9f5e20ead382697840fda3f6482a17d176c9f588e7943a4f517cab3e8cc2bb8f19b437bfb5833aa38b0422a19a33e998cfb916c084df040940660e002b37c7775794902fcb8f6eb057d83490f2dda764beef0c55c8ff31753990107093c5b22889aec6bb8c2b5c1b5a84a17665753740b1b616543c6acba018b46deeb31a9fc1f5c0e8e9bb8f2dbb6f9ee820ba74170a9999ee51f16356ac5303f04d23411a79fc515c570360a5b355d488c5d35016582a934d2c8859f154b78876112157bc5bd99ab1432bb84b535e4e276a2d29e3a2a5011426917bee992b780a4357e98d532612be258e2b30469ff8892393def83da17e8b7d8e219b06126db729056591366ce608a1aa52283e3dc00e07785b9ba6ec493cf142d36194cbc0ca2bcf5bf2e71b35c679fd2725117f5d3cede5be73afa81b93b3b5c7c69e709059ec1396e33502d8d6dbca602c27f9f27c3572df3d8ec9d83dbfd4ae8afd966d9fad0ac49db0b538f3430a16e10542ce023d134f5a31e70b9015d1311dbce19d1d0dbe1eda223ecc0a7a3bc1b878a02455b82586325c10715dd04abb1adb073fb0dd2608e6032abbbf40f10f9688c306580fbf51ce0818d09c9e7e12d0e0d3edfc1cd58cd2aacfa7fbedef1dce0c8dbdb48e7a3fb00f54c672341664d488e0c302aca15107d58a8bf00c46eb58cb2e64a1e0eb7547a3afe97fa43184b14adadf74b202e7781b1d0568b67a01745c703501b8745448465dc4b29aece7f0107aab87521aee42c836a524759acd135d3e8763366f6f9f97b6e99da378a331e877c265827904809d50e0fcc20039de28d6eb39e8f4ada239818651141498466dc38fd1e13a0e8946442fe3ad57f4788b0b3ded595bc93fe217c7c6927f7d849f3a09ebc31c6c3a36864c6ebfa7fa83b05c65ee2f7c8be4ebac31556b633dc92c13221dff0e551a134c3c8d81cc1e207e76845812d80aec7fc99394f1f4184f9b18acbd7b616e38686f931c94ac8fba14f829ba38aee48aa4700a331f4d580a839f50b38ca5af704e915761c86fc31f665012295870e4f4187442cece00abbbc50629472472e154ff2e3f8df3c00ef88a2986b068d2af390ccccd4ad15387ca2d7f0acdc45a4abd55b8acacf23acd82d60dd7527c665580bd734b8590d9227c98ffb1ead8751d565406183ab805952d0a23394546d4d9ae00429250cdbbaf56fda824ad54f1c7af7f7a19272e3602eae72e574df6ec2e9f763a3786b4409d209a1b1dcf0eeb7999ea03310475c222859d98d1057ed03546028cd2593f866f5710ed3ed2086920e4a4df99c3c08a12473f22892a105e1ca73f786892d954145a53bc3fc290aa088d6a79698d3c7101a8c456887f1114e71a9e037700faf06593d04567af59fc88e4cf44e618195c03216ee1e5aee3d054f51f48086c13be331124ec375b5c3a2948a1e707c0ee6fa6073b50d17767123b32647df0dae09adf9909c53d6e994399243601c9f16477e84774e1a6ff9ce75d5d3a2a3f8a1a667e7a2eab6c1e3f9348d706fce8d00386062728fc0747b87a08e944fa773793f6457346c7ffe4e7e302d515146cf104036949397ac3c617776de848e38e74e0ec35698986a2a6f424fc572e4f587e027004734b10d7dca1e48e4a63facd4908edff21fb926053a60cf7d2da92c09caff1393622542f1f006c62fa65c4db80cc28dd9af8ebe7a9a76b49682eed0f4a3a5d4b435c08a61cecd66ef4844b053414280f64083752536481d7367f0c219b384936039653915a20e63f9e7478c07be1f8e5fb440e13f7a41b0edab67100534da97e0a2239d8f611b774e8e0f9a0e32c8c91400ce824581bf80b5d265c82baeb67f1c7ee82f97483faf7324910de735d8c7f4f6f52e83882463bf5300ed267606416c8c08a6d3790fed4cb7a50974b2eb505c7d8e975a81d75434492fb5fe89b150a7cbc0320050a7e6dea1cf8e76d2f90353faa92ca6db2140dfc51a1c2f215617139b8babcb7437cda5c22b384c172e60085c2e7bea117f519a4462ec82a6b70a9aaedf11a146945bf50c4e4d5e18d3f2678d1f15cbb0ba34c0f44b22b3ea9f2b77468971931dcb5b7aebad584392d55078d7de3155338ff55d871627320407fca7ce9287fe2a3437b302039dc7d4763c54108ae614ba43724767f7de17ade0c528f947997ea214c3d2c1fa5f55ce88419dc04b8bb826c53c40431c23e7746f91a76a4a0d68d0e55a5e59d8fb6186e57f6948d7004e7bb06b99ae530d24e9cf959655ece98d26e0740b96d34cf96153b34c609c826c65dd2da1dbeeefcaaf1562791cb41e600e7d860c235bfb18846f891e517c59e367c9a8eb243a59d5c479d475434d758eb20b521b2bac2fada0299ead1279af539162aa302e717cb4aa15b1d9b4e201efdbe369164a521b93749e58c537af31c400aee6a7fb73e1ae5bbf96945460b022723e0beeee73d645234fa2787dba7cedbb31ad4ab10ebade4a79207e43b7294db51ed56d140cbf3adc9ee9960fdb9911bebbb74c8bcc3634d2dc2acf5f65ed8ad7424a7f12ed16074adb573a45c5bc216e7dafb6970d21aa66798a3314e9442d3131aefea4ca14a88c534d196d08ed9d984d0f1f56f40b90c6da719232d6bb627778b44ac50a1cd6d3be788133f5a20dd1510a064b5ff9c3072a7f0489cc8979b39662c23709a827ab578124c8d5444dffaae1478f62f0f370bfd5e622d24d360bbce1e4f6f51a477e4c7e11e22e4c5ef562a02079d69d7bfa1731946476b3122eba78d3f42201e68489c329992e0d8e1b2e64d0841eeb8a4b80e7a4f87828999ed6752e5e54ccdf150f95f900fc70b9bdaae6d9c3d01f81624ce79ca38e43adeaa704b5f7270c57e2dbcfaed3de640c5b09c9d550830edebf7ac45d152acfb8d9c0935e3e5fad2695648e8a2c5afef6f39044f42846373ff4a7cb393e3cbafda190a85d22d1f36625289edbd4b15d754d330c774d962ccee41eda181732deae082450db21874b024e31ab703bcecf1c8674e342a6b612f7da461b5bade0a306263252654e84c363535c75c629d40a4679a4ffb94bc5f39152eb8c7801aff67cbfbdc21b839c877a7cc77d3f3b837849e022d1f4808efe635d71b614b4e1c3770c0a3a02798648ff99650d5caa63875776e2f52ca6bf08734730893cf0b2b43ecbbddf2587b9d7e9289616acafb9bb8fe11154cfbd5d23e081652eaf71f0d78c23aabdb335165d84f4400290b1f8a3a562df7b21cf3f3533e075a5a54517567ff4c376bc4304fc76baea8f4791b242ecd2f8fc644dbf85f9aed6a5c1050b2d257553d92c21fb1fd200a51cf10e4c7e4c3b6c61f73b98d95a94c466ea4838dff383e28f2e0b62c1820e94b445cdb903743063324cc5cebfd47b3a7a3ce4328e0f8b8499e4fd81e0bf215f19b42bf4c8816a247f0280d693bbb89df8f18c936802f43e1f197b4093df7a676f1b8279163292ee92e0959b29d108fa23cf48ba902b5cbb749946939d2bb70883aea93ab19cebf1a22a6835aad74d5efe1eccc3f286122a27a2b5ebacdff48efff44b523d40268b1d02d6b5f198868b4f4e8cde968148f7fff96595c9ed5d38f781f267fe95605f1463714a2619a662e38df226f49a1d1c9b3155832e2523c606b6576bcc98b8ea26c6fc24421909aba77abcaa244c8978fc3b665e060ee79418487097abfe1fb30c20a6cfec54a26a9e49a3ef75e1df30437f6bedd33363acc4272dc491103e476639cb224a28f61e14be559116a404148e85958ed5433eb5bd46c6ef699dc2c2b41b4c819ddf14ee172bd4ed7658370809159cba61dd5bd935775e723e86b95d1281bd9127ac9fcbcb612b6a539cf28c2f705cbec25f6d806d18c5fc972e846a16cf48f9b33ee381bbdb0700a514307ac69daff409d2a263e24f0482d29634dd018c4c237bc908b5d5b58795322bf3700dd25f7177adbca13b947bbe76170a9a1ab8d3c971b96eb59e59672e5cd985deaae53f9e020a706af0905bdceb3d91319c31bf3e8d5d5b8bfcbdad3ba923b4f8233af82b494930561d11f29fe646dbdba1ecd4052985099cae7b711c9e86955ec3d67cf3108fb43930c29a8a0598f2b2df12dbec81f9ac5312422896af8c79bb7af1ab0c468b17c187d1a91a7b0aae717567b27769df781ba28c9fba53679a50effea9d958b3610cff532c5a2a2284f5ae2c2647bc9055d6a2eb5827c65a23607ac7830c1e58d6ee2fa4e5671ab4f84bc53161bae393067674b4357da9b432fb1306ee7b7dbcfe01f2bde153c86adc83b7a6615207a5f5a6a3e87d3875db32995f7ee451584f1498b5be8a579a83908a9e28bdc7b5565cac730ff914490111e5f55ed5c5d4a54d94b57818e1cb0a90fc280ad48b6115bbfd8ed66ade9f0c6edf781b850ec70b94eb667f674ba430d914cfe1ef22b119e164dd224b9720dcf76c2fa9b93fb41901709b545b5d8df0dc092bc07457eb58cd01366d4668a66370ffe18bbf5dce7401885176b7ef357e150656fee5ef56e7d445fb45ac84ab36b6b2310f731afff5a6908bf7fdd72a6090e538f66788fac8633d5214263be94a84394e4fde6f8fdbff8019ac8e3e7cd578d1ceca83c4a4bba9d00e0d450eb3f71c6616bd9f439994571304de8c3fbc475800187f519d089963a525716acaf6b5fca3156be046042e553b8e582a18b9fa10a6cf902664f63336ddf652ca0b92842fc8468f6a8e8fe3a3801a86fe257b3ae34be39e359a10683d1a4e8c72ec9f110a732d2e02ee40acbf30b74d94f9df1c161f59a1627af634dcff89844e80b7ddafacbc82131ebba556aab74dcc48f3ea3a95ad99bf6b2acbf38619c352977f8cd76e4006686cc317aefe7b56751d792d6515875c7bb2ff581e35a8b8e4b236f012c8c720cd6f381241eee686b6033a8c50fbe81c6437e242522dfad00eec0a98b5ea0080705ab5046728b0968c8d73e808dbcf290fb63d723e1251af78f3d4602e66f7cc04e59717c3601059939ad5c6ff473dbbdc4054ccbe5ac3d4a858d5b6d33be465d99d123a2e24e6f1ff05094921a63eef2dca54d55d4ecbdb121b4a2253a322664a8cf0b28bcc2684afd5e420b0bc090bcdb23228e7c90e71e1e5092a3c72ceb4ff04a585af973404b230d5753f57fb6e26ff1e5467f9c199bfcea609a9628c6b6c57e34c405a6ede11486138065a3f70433322d7c8330b4d9743d77d55eebf536adbf210b53b17e24575d504c7c325a160f1e1b111f2ed119df81db214885f9ed349fe74f32446ec5b6f0ba0c69e1d895fcf664b7720fbe158a62595384ee346cbc23d9e22c95499936600731094624e4176a6b9ba14d0a5091358167fa062d395add0b807f312ce9857a00ea5bd949ae3bb9875542ed261a3b1787b51c555293a1976576fdf0873173edc89c8e337f6718026aa11a994b2d4c8caa3c82fe6a2dca7ff61bc3dd2111dbfd6612f790cfacb11b7335a806173b2ac473279db8ed1f88bbfbea5d6548c3e95e8bfe745d858494952690a0c9ba806249de098bbd270ecf7bc050ce5e0c38796c7a9df5f38b4af154c6dd796b6f9e585b8363868e59fada273eceabac95fa8a674470ad7297631d8b5d420a1a250a34dc3d2ad0156ffdb126327902ce8be82efd72fb04d273a929d91d32bd0dbd820d9e36e464ba5959b5e21efbfcdde3425da52993856bab294f2fbd4185e6373ded4cf3c7fd13a761c3567af0bffb8a04ebbe367f685e3a939c6b2e1ad9bb822d3bcf08ea615978cbe26f6a7fdb350794ab96dd6b5397808a93e07598dfc63970d4f08e7042e2d731e03e1b8cb400b9dc486b00052846e60a919a8f9a9fcb723f09224473d3288ecf88db48140f00a00600483b35ac5be0a3c64f252e20821a56e26029fd7af8d33f663c60144c6a527ccaf9461265cc95859b839a788484cd62c311a327e85a5dd09f654f73805d8af080e19552acef91c3e8db2acec0120b9bb37ceee08d8da9019c616b2671fe925aa6f5e92fedb99e04b61a84fa0a68d3af151138e4f8b32c807845cb5ef44f84f1ff4d0d407d351d41299b008b47be9887da078109677aaf9489b4bf86949e5a84fabf612bab06a2b2411230187f35cff927b75fe737666138fa9df5e565cb367d54042178759c2e36a2f6f2ce5e60086721a4e410b3552734cc79355b9d4dc0fcb4b07920459b868657f67001f72fe1e208baf1ce7d3ff5bcdf2d174fd7fc163ff3bac0a2519b5b021699171f5cc1170313f1ab1f9a6bcb23dd23f7f891aac9386250226737a008ff04edea771a0d7eefa8f440be2fcb2468daf975b0c8a28a83ee719281f9caf1f4ccc97eadcc65b97c47e7aefce8973242fc63da0d25f2fd67f1aae5f92fc030ffd8e7ff1442dcd743a8ac74299091445e928dc1191dbcd34f39386d38c587fba2c90f50e04d021a71b29e4cc8b6a00c81a2d7953d066bdf47f2e08908da3698b6cb81a7fa0ff03c5f8b55e0c45657505fca4bc1653cbf56f829faa4798f77a0339eecf01ca5b0eee5fc21300017f1507684d3530e8281bd4a89d5acee5a4be02d3228b6f6b6986ba8fa07c4e4afd545ce16cce481055e83425b3192d61bf5cf9be9835d6acf209b5770d75c38c262e7e881e3a304eb0c62e74bbd21593bbaba7e8a0442b8892e9086f044384cc1faa7575407f0981678ef8fc75fecd363839179486a5e08007069cf2a3cdc4e306e282cc8523297228e3770dd5ecd5ed829018bb874ce6a32d111edb2f258bae5bf059ed8190659a776ed4ef468df38a638ba73909d44287bc0de3eb9a55cfb1b496fb5b39fad6da35b2a731cae9ac510b0e680213cd73b1045ae0d934695940cf9c382d2e43edcb173594ab429fd247a27e3805a42e73d0d9f23a2cae720ee0ad50d5452f93f71a94e8d009836f1bf2e0ab79890db70556069ac005f0e784dbedcbb5b7bbbd0956db852e3634ab35cceb7dff8b0e01e796a9dea8cfc97877be5a0b5ab5bb7e9ae8ed59dd04c9e1aa7e515912d0b5f105b119b9085aa0337c387566052b1e267c51e62a62e9a330105a431fca433d70663efb9927a09a336e1f165668ff72c1f57ddac5b09fddc3b5bc0ff7ef2dd77e5ca19b4b2d20d18646937f8c03e1de04c3d4de8b7fe9ec3d2aca169c295cd25cf4898ee4a7adf749f3875685bdd9a462c21ff0b2ce16e8c374d7c4dbee09a21715384512a764d398ee59a49a3874034665655080bd433386e948490a6eedd4a5c8bf94038f90d94068440a3171ba959e50e3b1707635aecce5ceb151d2dc04f54149dbc6d1fbb41b0169b2f82d33dfae6b121e526fc1f7b48c965efe54adb92526c098f50dfce7f6a1cf5f29a16bca8b4fc15b55b9ee58d0d8342d93e86f35c8136d04db05673f8a4b0a5594a2366b51c8c820ea29fd3c3f9262adb93b5399a1fe2ffc3159bbff8722ee9bd43e6e30bf5a240cf2cd0342f5d8d98f9aaa97ab10e8b62636f5610bec93567d62025b6740d6c0867d19d090c8038fa9ee36afb719154f189e3ecb538ab01615386d1cfeed3108f5de00eded4d5ca4e1523c336926afe39e407bb3c71178c2373ee649ffde114adf1331bd7ce9f803cf5e0d8d4667f7b00fa34a0b118fc759258510f0b1c276265e13c81a49bb49004e9b55d71e8fd72b6ffe5f6ac44d77bcd86b18c14e1321287496e6861d79e231786683b6d37cc0165a723cf84e4362257e8835792549ebd74b480746a873c402e820791486170e2aab9856372fea6f9f194b51ba4f9daa9dccd66adc01aae242ca80d4b8272b9b72348ea1c570ff35d3a32f3462ececab55a1fef059792e7f4e12b8b28910abfd2d81116a05dcf622f3a0fcfa20e05b73a02b68588ede1c1a2b9b6d52139d5981a51408e4a2f3c09bc54c02741665eb988fc7ceeca3fae90cba92e95fa9a8c3946bc13ba784c10a65cd7ef35a3870df600979700535d329ca25b6f7a902dead650f0eafa4d0f344b0b544781ce3ca39bb572439532db8c908a10f3b24a8124070fdbddde3546ecd11c6308baf2dde345ea29b672b128e12d84be39dc2acb86ce76137984a567921a779f42bdc90da43f4a8904c08a7293bf9e72f9901c5be5835ec1236ad20f713bf4bfe22c3867f208ad5e2d6a767acdf1354b1e07a77b4d98b16e9ee2bdc938e62e0ee5198192acb7e2a452c8656a4d0fb0c8a8b3a0a679fb1d65deeddf5f05b61d67166d79dcf2f80c958344c56b5b3d9cba7bf9d3aa948c189c92430eeaa264c168d734ad66ecd8056862c9824880772d2fcc14de7b19d4f37054f707f1e89cdc847efb80e478d2338206ac12631289da14be2a4b216ec853fb7aa0e5c2082aec90804cd1ee4a002be3050dcd05b6735c9576f85bf556c8579","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"db2470865aa068691185dcd60d0115ec"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
