<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"c6857ac3e589ae45eec526831d11463b4547f50df5a0a05f52ad7bcd7d6d1ff45afa450b612858d2c9c30d31b1cc3c220a2171d9f85880b0f6efce2a63f6dca35014ebe3c2bfb86b470d419e0c5461ef8b8560d31b432371c456fb29b215638cfb3626613f75c6d08efd7fd815ecb945c2e1e1ebe26f65b684941f420a625182fd45a96034e9b8ae2587fa741440537cb56e25d68939f89309bc2b12e5f86c394fe3ae92801eb9a343f16a36163b88f8d621a932259c59a0d8650eb8cd558ac23012b1f99e996b9e65849d1405f6016a37c7a375ea147c9b94d507ee59f22ee82f829c709bfe13df1144d8cfb2fa6abb4fc312a8aef5e4ba953dbe6543103c8ceb20f478b9c5ee4ea86785699d5c55b075000c6a0b6629d17ae70acf48c0e9af7a837ae33e66d374b15578488331f4bdea4a6d803816ee419f609f50eafe9851025de48d7b231d4743b71945429a12100a32a39511ff1ab2bd7899be3b19bd31434d6551357cf4628d4594b5a07a52e1f18248822dfa196f2a57a9e958629d5993918d719760b278af950c0815f119e8c67c1c60475b240e1dede9e4672c0c58097aa71a5fc17aecec14512e651427450ae16885d1b4775a6105a5c956a5ad0ce2f4845a7ff17f2401c4966ffa67ad55b098059658f1403e9ec70887f79fb1971d4d886a0c599b83e2a46cd221de21a7b0f593e18ac42f3b56c1e905d40e8f4965d8eefe3e182aafdc6c0d8eb96b9815cc346d2eccead7abf7b06efa6d615865a10134b006edbdec899e94b4342d30023c62c5b3d4a4ba994d8e99e3db7e08bda173cfb542dfed47e2babc076b5787acf78bd8b928ac9795f0146409a4407f715acfc8029a18854352ee7deddbfd257faf05c1754cbc026287424aa52562a567d7ebd28f4b6fec5008384cba80a2c6d49bbff7ffca86a115e2ea0d6d98dbbf1b9f0e859b310ae0b0769128f0bb35a4967cfae569bdedac8b90fd9e64a2facfa0a3639e570bcc27b95e27522209319fc5ec866c72c13051745de6aac5628ae466d0386347f3dd83631181b5d07716bc03f8b3ae589b67c585572d64dc39abaf84f7faabb73cda0415cba3969688b6e2605e673b2713460eb9392b17883ba3a13c90ac67312d6645acad4724f24fcc2a530bc79ca5699732e2ea013f527dab720358cd2ca60760cd354b2bb4fda4d59556b8ddc91dfcc073a85bf81d88984f79ec1b600fcc4404c401fad02f7d1b59662c987c30bc1ae250443cd02f38ea6c6ebd5e8fadca6a9d6436c0dfaf31199f0d6e25d5b4bd40ca87481b963b1cf500a4be20b24d58266ea370fb961512b1ee5d0614ddf7d4095c68bc80718127e99e2ace0ee066c27c4fcd87be88d6f91c2e5b0b5f049c89d2e90a7d7ccd3b49d9bb4048b6245c5202030bcb90df8af44b63afe0981170a05043c06d9fdd606a1407dd6e2e2f14cb243237d397eb5482e70b70a2623b7d968a79c13976055a91f78f9adb242bd3953b8ef9da45fc70045eb0699b53ea8ee7f2d4e699ed5f21305358a945f9ff4aecdcdb19d5d3a0dbcc4543ee1d487742f5294fad3ec7b7574f002c6793866a22d1bbdb4ed3323a99766bcc1ab8122e16799967378b35ac587603d97382406163e116c0377bc0aad251fd848d4416f3645514c46598987574b7651f4ea4e05d2c923071f473377d0b6b34384685d61a4ddb8c20e3918d90165c65835f3c9309c737a9d6f20c065a3a813ef4c72fcbe6983e25ad78bed139fb51b88e41f7ff976b1002f8f6031247604542817c21e04700d8fa882b0a57dc4a10def009be468d8bf2b8eafd61adb89709925ae99fd656f6823fefa4ac5adeec452f32127c9412a054c4bfbebbe8c7431ac2bbf90895ea7992ce292367c98797d5d061efab18719a040c296d9935bbd737fb41a080dcf40b9ddf6054925882727bc0b16c0630e935a538803dbb6241ec77cd2fbb18eccc7a4fde3f6d01010ce6d9aca4c9677aa6f35a17fecc5250fb7646e091a2247ab17eb1601cdc2f87c60ba7fcaa936615e50b2039f985bb01e4d581b959cfd1a4ef824837ecff55c331aff736577e1936cf3781e659341db3d556b27ef9cda9fd995250a919b482858fa817b903febb95c7d20743cd12bd7d5bdee25736b1bf121818b4c304b69042948d6b21bb023ea059730cf8b5cd736a6b1bfd4bd47945fb099b105236bd8bac4972550619cae0f8bbae74460d98bc91f99ce98d64954bb393c1e648ca59fe4229f5e948accceb6f800ca3298706619df67e9eddf76e112bf682e73f63a3a382b614bca1e3a4381c1e17420d8fd13193d9b81e4da77d59cac2d7320374d3c4617e735e1498e7377a9f87315ba7c80ec4a735221da37ab20cb0c793e8bb3560772e19d46a05975c032edc97af69628c60f85352b3211163088f999408d0bd56e718544475b89ba0e93e4b514bfea12e2a299ee75131a7ae81e9342b1e90d1cc197e0f276a0a26672d81de4020ff31860f71828e22505609a62114bcb6519a4a325480f9028da7f6ee31b11cd4ac48c50d7869d0853ee6d153c9d2c8f3012b9fc92829b961c36b11026203d01ac40eec76f0c4bb4ba19bd95e76317a7ab74666417c4066743e0eb7d8acbbe940421d8397d79b8be8b5938c32403b0414e9f7487b13daad298a31ba030af2ee176bdb6e51f0e1e2d7403602d4226b0265efefd0a8d4eddaeb89ba491d5bd7ce1030d941e3072ee1ebd6599c50d4c639db82cf078c404f474b76cfc96102598315c259423134d0415bc899eaf8aa56170656505378a070325234cda6e98c298aa4cf512ca4ae62a7be9c1add8aece5805f550ebda6300cd2f06759fb7ce3e70a16d471170d0a15758fb23c98ae25a89280bd81f4e8710fd4820fe8022d6e08fb960690dd20aa27196377c465ec8ae62e8cf722e883e9b9210dbf9f6b07b5fd7ede159a37d02abc1d61ce83a9352139c87313bfe4a8419c2fe9c3c58a77190dd90aea03ca72e0c87eae93b8d0b1f552aeb1a348679501396261ffcc8e72868ed92cc1ccbb00afc487df2686015397efe3d501af924afbcf8d3785b5b4e423bbc5776a9a14764bae43cac2476e6c527c3ce99dae5c6654808c5bc626b0819f4745fe48c28968d8c6593ce6058adba5e7b8b6aa5e9c93bf07dbc97ddf1d8b639911ba91ef23289e22c1457cba69c46aa7c2601a8643006e4661a34b6a660b4eb8ee2ce66e9ee3eff652f33d52919509e355f68df270470f4d993872a89a19619bfe5bd124d2a1d3ebc9657d7da31a709e8d8fac7572c4bcda09148cd16b341f569c4b211bc08de8b784ca368a376dc5e9b6727850faa59d21cb54868bf54cdb204de89fcf118d64d862c3a27e780d911c53bdc65fed9da4f2064daa7770ce757adae5f84d7e841da1e9a5a7703964832341934418461954ec01d6abda6b1ddfeda5cb626ec60fafb1e629ff864c10cd1b022528e0c593164d6410362a96144feb705b84a20b242090fd03841424fe4f0366e16bd9231ee7f5e3545526c9ba70971806d7bef591a614f1db8d5b768e567cdff2a63f52cf14a8b530dceadd6db17a2640e1ff24da1218d4fe1988dd167af143a1079f1231f90dd0f5b254b6828cc784b93e1fe996af5fdae8b483c04ee6847e5d51b16a6b2d8a10f040d1351f2dae361df122cad2f3e7b370302dc250ee09741448e7ad3e429cbbc56e6f6e0c9dea12b7dce3b5c4b9f97c86971983c2c750c4df3a0d8a088bd4f40c16e60008bd8929eb508900f2dc6eb199d5924c6cc65d78c057e49ba1573b24945d51fd6ead7f5119f982feb0b691b9ef47416c8118980a072ee58b8aa54435a6d5ac9183a08563711ada586f378be20b5188b7fa76d82a2cf019601e2e23e3973986a177a59976dcc7cd079fc61ae0583b54849bdf6b8c0df63f853268a6a1e2647f3d38fa565851d5126226207d91a1903efa487a4d510a6fa2e39a88bf8f4fb5a76cd898d9a37f458d525be682e00dd42eaa17e4979af1d177e0c9361b024ba4b509239c6aa3478d91c19e8d53ceb68ac8be7402206b37bb34e4f86d602c1ead5f6e42ef835021e6c16b2e9abc08146668a4d5d0874449428510eabd5a86b3488d7d583282a6f1c56486cba4a1c75d6b5a95c435e4b0e07d0797802be9b2574ac4ac1a3c018d87ddd9f8c8262c70c9c89300b607775b11b44a698712e49b5c5c3ae562ae841e8012df0e2d88cc46fb06ea76ae007b0ebee54c2d109fe98d9f6b922c33046617bcc54aa38bfd029c94193d9ef2c48c3f699debcef84a81e2047f498cfce1970ca6097a2c54dc7601d713b2cf36006a1cfe47a28ed32fe7f3197b5cad7316c000855ebbde75b60320c1678a012b600c61e50065813a938c9c9151da1fe37f1e000947fb1d8289e320c45834f1ef1dadf538c7fe62ac2c94ca36a3f558b452f32cfd8600f56406242ab3e19a0ebee751b5e51108c80fedf75dd9477b72e80d9c2f66741e4e51adcfcf1979ff2fe5c9a10e1161ef51e40f416d7186d020b43d56d90f02e7c386834eae3829b15fc680b9afcec1b4b792ec1f3c0dde93e5228c7ae65c492a4691ca618a2ee375a7bce59d62af5e6cbd8cc6a9bf4dfdd8e7ad053979da7caea9d963956ad78e8992b3334aa4f88aefe334a0153f0a93208f59ed3d9d74624fa7f5f2aa47d3f66b3d3b242519be754ae09dddf7c6ca13824eec954244e2e16d4a6708ee19414efc9ed7e009ae4d9be5a54008d8bd171e9a4ba5ff36f6c8684e688ddf602fe543b9a96959a5bf8f3fe8de19315dc81de89f58bbd8b7855c28b0f079cc67178e1abbd0ae3c243b8fcad0e6a0210a8eb0751e8329d151d12ed92ad45630f50fc5894d5549722cbe3be051989a4865e316b6732cd7004b63f44b4992fe9a9a814e5e025308a5f8423ad6b45b2d8ec6a0c994872f2c9744d0ddbd8ab7de0964c1e756b4c53e2a890bda75f3f44d315974fe4c4b2b9429b79b5439957d21bdfbdd9a0d4726e4e6d989d39c13387b163015a059312e0958314f40d66ab49c9b46b5d54cf228d3ae583cb45a615c2f5856a2ee6478e56dbd71c32616a7c2aed764f2418fa7a7010c76cec90038e877a73ced0c58d7933f5012c0999173b6522de764b5128449d2497ae904c79615b0f522f1d67db25141bdc297f1c0839310c590439e15b798a5a4ee8fe84695a24d4c4fbdaccaa27ccd9e62d39cbaba51286c9ae9d3a9230fad83ef00f4d5fbe70453b0afddd0cb503399738a067c8b11b5cdb5e44e30257d6159e882b91970d9104b070ffeb43c9c40aa90e0e4a831ce8c805453db7f5b8012d213ab833d79aedab947e2f5e3ccd690cd00ea1e0fa1a0b1eb7bd5dafd0eb9d54e1d0a8c34d8c8731b9e11403ea307d0d7acb4c8a46f01626f60729988168d46dc1588b3444548dd3750a8f7119b3ffc57d2b729a401f51d4efecd0c4ade99edb44f5d1f3cd06777ec206285150390ca7fced2887e218969e4c21aa922f5ae8dbba55d918e61c6f218885ebfb5081f7f889efd0386cdd99051d1ed955f4de89db6a9db2a044394742bf07740e8207e5381dcbacb4f7901182bb30d962bf5a592c2e103385430809a25477db425869c0d896bc9ce6a572a30c309a696be72b8b198a97dc0e8986086f6df714b51a0edf185ad389a1ad8002a7a9215d1501ccd58eda529033aae8fd73bde140326c6c6e6aa7ba2dcb7b98198d668592c4b9a933ce0e02a8174068e8af8e7a92cdfdb4656a873df4ed9e1920e415383d1609e94864e37940d68025b1ed52399fadf45c7d3950c167c70072543c4b91e8c663b6901efebd9880d804ddc505a193625350f435d0b9a49a3cfb2189f5d4d8ba0b06df1a994db4eb4a00b36b1ca23060733d73d68ed129e51bfa1d3f0c3fbf47352088319bec0d96a79018f177fcb5917d2ad45863f4ed52693150cbf0ae8fa31b724cb25a69af0f285618ee79bafac587793c052579d0f7be88ca0bbc39971f2a939cf4d2a413c5f69c3a1bc607cc879e0f90e3b25b8d8a54b60dbfeecb1a5a3f86ad4d1ff7b430945d7184bfb2a0b9922649d688217a6566eb37de6b040f8232dc9f27a5ea8ae9511ffd3756c7dbb10bd3cb80eebbe0e75a37dd0e4cce1f28f97f26e240ae17a035f42597698787400880598c978df518e4fd5c763b852211bd74ff8ec3cc41ebb57a158a60693100460be53a6edfead27dda11d5b85602a17275458e727f86d55e256288460d42abd5de6ba8eba953cd127dea472151a1f8d8cb7504cd84f66dc040dbfca7079043b9a60a71abefaebe32753441139f61b3d26ee8c415deca2fc2fe5bdaad062ff06add696618048e339452e296fd42c5bbe8b8b9f14941878894fa7a277f459c4e635bde4a31e7d87e1e0d5439304043d0fb2e9eafc99aecb48ad32bd38b98b58bb518e6b27fe2426d0268fbac939d82fc05902913d7f74444b296b35d72afd0e90cc99e904a91e7875a15f40acce59afa842afb11ed790f86b3f38dbf5a0c6a32dda8be36afa02fcdd5049f68bf5bd88d7db3327d9b4f4646c3d96f18fce3946563a960ce39f6471cd9eb669ce8c1e942153b391e93bc64f638d437178800a27f17c4b1444d5d631a6a5349a12a2f3041465e926bbdb2586d3fedba27c2a541175aa31b5d37c16018025b5e4aaab80da2faadb0c38790a9495f162ffa960b8502fb5fc6e9a03127bcd61e6dcbd332c34fbf4657fe0ecd61f8ac144693fe7d81b20ed07b005729fa463efa83393abac62dd233d7de26f63f4fa525b56e86534d8197df5e2bbce6d4756623b8a84ecd28435440541d541444a315971bdcc3d3b230c995203f5ece4159e5dccca9fe21b42badd78cf4f3531df2178cb37612f4d04a6752b0e4110e9e9527ff614f93e0dd8142603e5dd103726ee9050ad78fc1f4d4361674a83911854703d35367508b3e9dcdb0e2136ebe73035490efb59af0c2aefe8e920f0fbb0901eacabb0a5aad7924fca6096cb2cddbdcb89877e1ca4bff02d6e29ce587ada60d57e2c889f5ef990bedcba909f339794a9cd09662c56327c8a5a9a0d0b487dd49b424124cefa6ff8f879c8f4e9e1f201e59690b8f72bb30108cad474f9b5970383ccda40089fec07d9e0218dda9de392dd0582fa304240d3197a88e8e0a859d6f3d909c7e5bc540814dbd144381fd270b609c7ee46c0eb65aaeb5bf7fee93d11deab018ff024f605ec88ecd2ccf2cde6269d692f507b2c4c447ffc20fb25896e9f16cd7d52c1e9235606f416be236c78fc6eb056079ffbc07e7abb5f64d9a05d7fd88d6ca88f534629f37803fc395509a6f7738a1053c3e10a1e147a8da9e6420d609be8365f695c3502c9cf569b8a30416db0a853bf3d1457db8f689b040fb9f7377ba02a5c3fd58db7c08177da6568bc38cd8db059512e4199fbbb146efd3df0fc4555d5de78b60835b462257903ebe4fd6349b6205914a058fdcb662384a563b8c158b87f7f29b1a95c6efc16175c8c5689d38a16b4bd6c23369a99831c726957e3d65197b1250bc751b946b5d953cf2a3e7286200c418ba5b919a998429bb415cbe83f09bfe3085670ac1f684657746bb46008ee5f123495c1974d985a5ced1521d1814f92c04745d4b22e65d156b53286b7cdd96aabaf44f0d5ef9b7313e09853ccfe21fa0dcdf044baeee7a957c190dce756ca99242d347255c5c29427b63a4a4ea7f5220430b1929f9d7a0fa43adb42061a5bbe27ab56f339f970f67e91df2494e4e65218e95850f04bf64105d5046792866c178920a22610d343969a9b41d72af8397fbb89d462a891a468db37f763ff555f9f17039940597fbbb661c0dca7a120cfd5d2216d4057d29e00144c7de5ae378a8809581a2ea8452bae6f71c260d6011f440af6b16669fa57962afe49a78504cf3940777d218dfcf70cf3dc5bbc5f88016887cdf9a7beb37d6039cee457f37075b9e03a2ff4c2a69eca411e886f3db203834e16c9e6ede91047f08adec3074cd95cf77b0bb5d93825fd75db6cd34825d960934596ff875293d839c70fc48315db8bf763619a4eafc3a9dd8804d0ee1a846441bc50a5a549570a2ea1c4382b747d554ea91078bba366d1385c1eff8b5d03bc59e9667c06dce6e1602bff88d79df241600d55149702c61bd94e617a52b30e519e4550f22f5d16a98813b6193e7a8b7618995856cc75eaa41dbf00b6877d6d37193dc8f59cb7eb9856fa96e8b29a6ef8f458b1c43d866f0becbc6646accb39c43af2fc048db7fbec921e73238ef9278ce1d731bfe68c58a42f29915db5541823dabb80c6f657693365c9e141f329640a5b13c199363bd20f88fa7c0105503889ab99a5a4be71360f7c7f589548496d550d616af0ad425a4c68b262b0fbed1d6ed0865dd9c24a0df964ea94358749fc7094009bd3eb41a0187f7e91df3ade03189d4ba99924f3e72d5a4ac98e0be1d831f840d1f581d2dbce75e21ed47f0d31aad467aab5cb9da7bde79eb98aee6d0d9bd60dc75d4637f02910d2788064c77b1b9e1218802620e8ef9bd96f316b92977912353ca8cc15fb520ba197d4e912dca8091ebc8d041b0916ab469a0e6600dafc6952d6eee744b04c24f0f97f29cb5d3512cd9a31791bb4cc2ad5a3c65778933aef34040584e3116d567c85470669781222f9e9cc1deed948dfc5615b6f3b0da79ae2601c613e034f13d9cc98355af312feb5d11d47f58814f8853451bb57f0ff2ebcb369cef17c488823a00b2378848c6c06e398223d17dd1bf95c6161265035da1e48dd2777cc5a935317e572a73a6068fba354b97fec6c60e7dfde87ca532b2c86ae8b274b0bcbbc175e0726bb0ce630bda6e27ebfaf3139b96a1d12342c2717880cdda98b593f4d9ba9fc144de5914e33981719bba89db4c599e9cba838bd84f39f6b263f7d6e3e42d9606b87909f3fad6eafdb7d580b6eb647e6b1dc0ea792d3df596c99e7aa4f407e27aa77e18a7207081da58e5a95081625150c9f206e3264a334b4b46d6c391229c74857a132ae6ee310d46218fcad12d6d472fc7b5b4295769b0dcbcaac98ef21839c448070aeb2db485cb2d873b7422e75dc2c8f9d676a111ffda778f66fec5bb6c6fb70776d0c9f64a776266aba142bafd91616babccbce2dee0c24a5bd08c45b952d62f1368625a07f362094b65f70914dba35ea709758ca6c9dc8479340bd7bbd033bb347811ad5711245f51590168d13446af6b4778e29f50b1c2e59abdb04083dd5e2151913555a504c1ce931ee312e499335b6b4b83d09ce6a8d40582132e49a6450118a524b0322a442ac857187bfcd6c492aa5a7a5bc5532caa95c03300044342886df67e3d2cbc7d30ae3ac34dc25f60b135045fd24c253eee47a0f190df485bcfd6a51259b39fc224466970aaed4ef5b12031431b160cb895dda9e808173c05b65397e3c399022939b041859b2a5fe7aea464bacf4d3dcfb535f67e9eeef938e3d6662d7eea09a65afdd77755550ef5ce9aca305a476e8b93a52a4108dbe459576a213627d8c3f785e2159b025261ede8854655ca517c86bf0e0fc330dba27289f2f70757c1e3e93f68b671c424205c300c6d007ae4ab41749a334d5b0a9f117eabd63a89a7ab5d490a68929a03ada0a82ee080636b5a406b8a1a1e1e78333ffa4317c9337355ecfffef1c87ae5cb7432be46df1941001439744d2845744cf18f388b7e9a9c25bef1296231af5c86b5e4656cc18f4b3987b4129c949bcf1c2c737026deeed86a3518cdeffc50b39e8284d35d70ac19e58ff28a07fa80fa96d4424f098f87853d881a5ad5f92f2181ac1257b25a863527c9e37cf634800ddb281291b881e0e7180844b64ac2d258bfcc8a76a2424b90ec5b960462fb45ff85dfaa78daf16fe567fbab21b0e268336e592f4dee27d59df3519beca02fe6deda6bd55ba44f060f5ea7d6d6cefd9f6c735b133b5c29cb56fc64aa08d13e513022a39b4d9e7c93ee4447d55f4df07187c661748137a3ff1c08383195b560024b7a56c4476fd26a6e50ccf535c7f0a90baaf6f06e70c0eae9b32af3efddd1b5fe35774f1fad7736b87fd9f7aabfed301b9d917e5deca0d715cd88bd66eff1ad986efe8dc69df3dc8e97ee460ede01214e2c70b531b7b37655d82189d5ad011b0ff05edc97c65e128f2e5925ac2953cb48dee2cb2727bc9e1ad7dbd5928201d6b4259bc895dcc81b66056f78b232f17e9555a2458f52e8195db477c32332fb8e393a26fcf26a466a4968aa8daa96c9035f2cd05990797390f78cf8ccb49d84da778a39a81c6b658d8d4b366fcd198152ed20ec7c02a79ad54c3e8a2a1468c796e4cbb93e292015b99a5979397085b7d8a0a7c201268ca2a0076a64add05b0264f04f0554db54c610561c0841e7ee10a53fe1a71942932940a2bcf4244832477f1fa9b22257d41fde3ddc80c988074dfacefb75bad7a6230c7a408c801e4f24f2171c38710158ba2e0e2bf71c74fdf247ec8472d7a5449190a572eb2ea783b39795524468246939aafc247d881009ba03da2e8212a18a1064f5cb6c4d00e8c1148de9c74818aac05faaf562e5a28150011b2925303ee401217e8ea33d563c79036856a4d3b6213b0f178a3d81a1d7fb62aa46e925f1f9414dde4389dbdd72fec87552a3c4ac12a378600b3fc4aacbbcbf41b8ebde536219f9b6171373a997dabc203ea6f6f684c2e0b16361f13cd21ccab84adced861c89aeb7ede9a27eafcef3f6b63c3541214a6e1dc1cdce0ad5a210ad8a016d9362b9fecacfc0f143e29c9f470be4bec334bf034c7a82b89d33d7e47bb6f1579d6b388a13c83517300a89d8ee4c8d599f048151c2924a12f37fc3ea04ddcf87e4c101cb24f9701dd3a86dd247a01d8134982a67fb9648a60f91009026ac9728565201e626af4b2a97b311c9b08ee52a1f5e193eef4209ac1f4e8ce9c153c68a90c603dd5968abefefc9433bf1bcdbe781c1e66f425f9135acdf4b25dfcc22ddb38af58891c00b254a5a5df0b31ddb8857039d23669cb558787fda21d9fe93c1484bb66f43b3689e99d1b7f12f852902d4ba12af503dcfde927108db148a5374ed42d23e487615b094db8e102f28f061e204ac094e44b30986a8a817ac82842847c07c78aac402698467ff3d28e7b724ee89231326d6ce6e5e3a228139b2440566677b2f6e33e7686f8f824157b0a2f72f81a61edc71ec2d1d270d9d39812ac8cd7b3ccda4d6d1eb9435dad001d33c0bf4d13bb8e2940b5e70d28c32fe31b7a9d77f3d38fc70dac28c4e76ae9a4970d49deeefccb18b1fa44c116d10eeb10d48888ff2cb3a5b3ba7d62a990d5e39ff1bcdc474ce75712bbbc8ea1f941d265fc2e931b2afb3ec3fc4b87326a57d59941987560aae571853075cb37c7fad185a00acf99b1485dd9f629ff6ab38a00de00680b572d078730746fc1375932b0d6fe9c9815637c1467b0e2695a21283fb79c4672284c2f20a073279d0ad715449e35f2d68e3ede0403947f904a3a431dc02b51695de9f116c1aff1a8f40526d80a69ad1ee1e3d849aea73e99146629e34dde3cc7e15a4bd7954899ac21f88190ba1dae8ebf3d2262f5a7f2aba3a2bcac9296916d5467bede9727c987b458540c8851e7d02906c68603cd9c8f23b7fe863d0f17d709b6e0673292803d18f134d7276e9757557ae2dfd24d0d6b60d418c4f299b8fc2d71c52b2488f9745d48976783b9a5189102376e923e0f890399502babdb83a8a22bfc4f76d1ba51114cd2debed945d3e2e4b6f85d77699774d9fc59ff3128a7e93ff43d22030418f8ae0b7d436a8d4fe6d463c80eba2e5b5f67b87dd0a1c4e216d32269c9157ad1ae19e4236e5c1649e2f12c20776ab5526a041dc4c8b02ae1a2b949c86b4d24ba16ffcce20d7dd2b93ed77e714bd783643da41eaa88431aee7b31d247d5f95d2dd5924894108b915e2d8e7a56e296065faf80d604cf11bf454359313e0cd2323719e211f1f520accf0dfe7cc545659882c1379206c9c8936abe1446c7f002c082b37e9af3c07d1f9b51fae7bbbc3f9666e6db593831a8575e71004c8fdf170d3b1b080eae5a1916659c55f5533353093db3918059528cec089c2289f490aae23112e54ac20c0a8cd12e8afb456648262e1b723a6990571e00073adecfba4235972dec5ef6ae321c54feaada30336ae406b5397c12954e5f31ae5c1fcb950340e1d83f51433aedc09c5b85a64a105753832ce6aed06bbe764f78762c64a6353293c30893625c1581dca8493600e014ffb14a5845c4cf01ec89bfd8009bcb2f0b428f1d2d4a6051ad1984e4ac7221c3971f744cf6fd5b6b96a090f636c631c6207ddc60f4d60f39dcd93a0c910a0cac4c7fefe2d298634dce1cbbb91e4201b81da7077192d8f05f8e53a2f94b4b0a33dc69c1c9b3a9a1da07070088b51fec3c0653c6268db2ccccdf4bc3d8bc00902a8b32a139c5f35624cfc2da600cfc4acf89fb52c7ffeae9f90639e7bfdef65212ce476ce86fb2e9b067bc77e90eaa08a2e353de83485fbf5051de9ec388daa34e6b131f7dc42b8abcec7a7a3771eaa43571fabb51f037a8bbe65a6469b92a4c649f9fc88f9299f3f2f852dcde200c9ea6f60773eff2576699ff07cbcc5b195cbad6e77c566b04ff54d6b67c69d9c73759d56bb74c30c2113de9985a9def357fb5912c1f0a9d639b45a55e492d8e899a3e2b9b4a561b7dbf8518bfbe8f862c1b462dbc84ae8a562a3dd1842dab1f75d3c4e7cab0c4d8f3620f05d6b1cea1253738d27720547dd09123bd7cd4889c0b2d99e68c5fb92ccee61408b4a2472538d71a623224274b58d12c47d07190a65cfff394a2a9dfd773167eb556375dbf60b085abde752bf68a2f35dd5d1e8febd7539cda8d20c8e3387d18edfa0d9f548b2f46022ecaf2c80773d14f4c4fd092d1fd8dd74e666b4e4fa588b2a25f2a1dc11a9331ea7b09e9bef34f3a8b43bc8cab5085f680f2b30ade52802218d8f5854f4ad3e1ecdc48faa3d59841d4dd72f0eb83770663807ca9bd61873abf134bfd47eac1dc72def89ba9fd3631e77fd250dc72073ae5caa9eda1652fb800dcf4f70cc52baff7cff33b941ddbaed8c4c8b6319f274f8edc457ce4019cb1b14f88bbfee124a8590ca1fa2eb653b07ab233e9c5fd0127084a035280e7e74d0a7d82a13106bce21cfc280366d12897f993579140cf207ab77a3fe672014d261ba1c4eb5b5f0926a5c0213d64e8a56119bf98ead9d3011074e1d83428d99aad0137ad4521af29542f2012f12f46be06b42df960f022c9f694858918514aa35976ee6f8c665b0d94d42e2cb2653893a23e5dff4a25e9e84aec11fff1394bb5629767ae1ae76be02c497fff717dd480a7394c70d09cd0b4d1a714766a8f94e5811362e005a1b864b906c38503371c592ca750a3b11d6672b900da5860157dc9eb7a75475d52b966e83ec88e7a19b32d6995b142cc91f4865c19dcc44f69220f82f6e2cc6cb1c47474b2025fd98f5f84fa6503d0ca0e6389cec8fda251b7c7cbbfd199d948ff55f4f52d088a9ddc79a517b6dd438d6167127083cba16c1c50c8910a9165c5d970ec2826e9536970c5ac453ae967f3bbf3ca08daa12cfa4025ca4f4282177ecad439f2133f542657cd014f123f5f1a953422e73d4279d2e7d333ac9839d408284c156148a8e511751564e8f487e88610747ef3c3381da3c6ac7710d5a0365b57d03c8a89f81adebb7b7ab1400c48bb19d498b333883e777118d75c353b9a9c39fbee83c3af503d63403f2d9af266ac3be6acd4a6ae7f9f9adcdf991c8da1802806057e3688cbd2cf895bc71438895aa60053e889da5438c066b63e21db8c658e33e7ac3a0c6b8d0537d7d18cea4fc2c7233c6cb86c59824960bb675eab4ac97c59fef125d110d03d1ee1664d576525f08753b5095c0fc0de81b6a085e4adfca946afb8737223dcc9228951b2643972dba4057fcc118715e66ba643760aa3563ab10269e114f193b3ce93c9e9db23561f18e0c29c1692ebf346ea7a3722a2ddbe5a69a3b03649d0c2d22a7d51b87c81e377f90c5957089e4bbfd010e50b762fadec40a2d9be305a1bb3d08707472ba939a2003802dd100050508f7b7af667d0ff4ba2dbf1fda559387dbcf5d5fdc4f324cae08c641c9f72993472f4006322229a8b3d03361358d7731ca057e6101b26e8b449dfa79c3eb96f489be9172e5a4ba882e7a6d2d585745fc95ff29be5a581ba7448f01afd654a9691f76006c12e32b1c9f2ddc9658b1a54716e77a614831f5971064b7075a8ddb920759e3ebe5a1cb66663610625af3b05243bf2a78a8cd68f29eed1716bcbbfec5d30538125c6875578643a58939e4f70b7ff786258d7f4b0be72522f314bcb104e741eeb38ea3639ca6e32d41363709fb6f01944fd236b19305cbb4d38213f3efdf7bfa17eeb3081c35cfb5dd92851559c7c6357c3f3123e986cac5307f3b970d8fe22bbeb06373a4ecdfa6208dab4c606769f149adacdd129e35dbcce8773a6718b57ff933b89244a86d461c924f596619aaef9558004fe20badf4b166aefc402e82a55f96ffcf8e259301d31775c454b56b17b8c764dcff41f3542a753445ffa59dad67b9d210b6e1a3290d6dedf0787d8a07036cc3b3aec9e4654ad4a8adc80a409f516b6e69198914fd2e050f259a44b27944c425411f3dd1dd74f70ae44eb294d6c6fc45fcb22a6c1ae7c5141789989396225f681ddd6aa010084bff8559c7c4e6164c26b5b097f81342fbd57129ccbbeacba2741926606bee32767d7460df221ad7910d5c83042a536a5f98df1a9ab0ece6b50f97dd7fa957a6bb533a9b3068358cc9a24e140820e4437d6211ae7ffed834edcf1e3e2f1bbb5569a4a670ae0515839ae8409cad1faa00f6ec13e0967c004860d569948b2e0c276ac1925a48f4e90e689","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"fe727b3ec2446f3e9140a7a09442f679"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
