<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="zh-cn"><head><meta charset="UTF-8"><meta name="copyright" content="(C) 版权 2024"><meta name="generator" content="DITA-OT"><meta name="description" content="Vc++6.0&nbsp; 定时器的创建和关闭"><title>VC创建定时器</title><link rel="stylesheet" type="text/css" href="../../commonltr.css">
<link rel="stylesheet" type="text/css" href="../../common-extended.css"></head><body id="VC创建定时器-31E08510"><main role="main"><article role="article" aria-labelledby="ariaid-title1">
<h1 class="title topictitle1" id="ariaid-title1">VC创建定时器</h1>


<div class="body taskbody"><p class="shortdesc">Vc++6.0&nbsp; 定时器的创建和关闭</p>
<section class="section prereq"></section>
<section class="section context">如下实现的是：在工程运行后，每5秒定时弹出一个MessageBox窗口</section>
<section><ol class="ol steps"><li class="li step stepexpand"><span class="ph cmd">MFC工程dialog中的使用：（工程创建：打开VC6.0---菜单file---new---projects----MFC
AppWizard(exe)&nbsp;&nbsp;工程命名为：XS）</span></li><li class="li step stepexpand"><span class="ph cmd">在进入Dialog画面时，设置定时器::SetTimer(~~~~~~),如下是在CXSDlg类中成员函数OnInitDialog设置</span>
<div class="itemgroup info"><pre class="pre codeblock"><code> CXSDlg::OnInitDialog函数里
｛
::SetTimer(this-&gt;hWnd,8,5000,NULL)   //（this-&gt;hWnd为当前Dialog）（8为ID）（5000为5秒）,NULL~~~~~
return TRUE;
｝
</code></pre></div>
</li><li class="li step stepexpand"><span class="ph cmd">以下：菜单view---ClassWizard---会弹出一个MFC ClassWizard画面，在画面Messages:中找到WM_TIMER选中后---MFC
ClassWizard画面右手边单击Add Function---单击下面的Edit Codes</span></li><li class="li step stepexpand"><span class="ph cmd">此后会进入到：void CTestkbDlg::OnTimer(UINT nIDEvent)</span>
<div class="itemgroup info"><pre class="pre codeblock"><code>{
 // TODO: Add your message handler code here and/or call default
//在这里写入每一段时间里你想实现的代码就可以，现在，我只实现弹出“你好！XS”
  MessageBox("你好！XS");
  CDialog::OnTimer(nIDEvent);
}
</code></pre></div>
<div class="itemgroup stepresult">运行试试看~~你会发现，一进入介面，就每5秒弹出一个窗口“你好！XS”</div>
</li><li class="li step stepexpand"><span class="ph cmd">如果你想实现按下一个控件BUTTEN来实现定时器，可以把::SetTimer(this-&gt;hWnd,8,5000,NULL)&nbsp;这个写入到你的BUTTEN控件函数中，就可以实现，记住，在用完Timer定时器后用KillTimer()把定时器关掉o(^_^)o</span>
</li><li class="li step stepexpand"><span class="ph cmd">最后，如果你不是用ClassWizard来创建OnTimer()函数， 而是自己创建：</span>
<ol type="a" class="ol substeps">
<li class="li substep substepexpand"><span class="ph cmd">CXSDlg.h文件中，写入afx_msg void OnTimer(UINT nIDEvent);声明的</span>
</li>
<li class="li substep substepexpand"><span class="ph cmd">CXSDlg.cpp文件：写入OnTimer()函数代码段的，</span></li>
<li class="li substep substepexpand"><span class="ph cmd">记得也要在CXSDlg.cpp文件中的如下位置写入&nbsp;ON_WM_TIMER()：</span>
<div class="itemgroup info"><pre class="pre codeblock"><code>BEGIN_MESSAGE_MAP(CTestkbDlg, CDialog)
 //{{AFX_MSG_MAP(CTestkbDlg)
 ON_WM_SYSCOMMAND()
 ON_WM_PAINT()
 ON_WM_QUERYDRAGICON()
 ON_WM_TIMER()
 //}}AFX_MSG_MAP
END_MESSAGE_MAP()
</code></pre></div>
</li>
</ol>
</li></ol></section>
<section class="section result"></section>
<section class="example"></section>
<section class="section postreq"></section>
</div>
<nav role="navigation" class="related-links"><div class="familylinks"><div class="parentlink"><strong>父主题：</strong> <a class="link" href="CPP%E5%BC%80%E5%8F%91.html">C++开发</a></div></div></nav></article></main></body></html>