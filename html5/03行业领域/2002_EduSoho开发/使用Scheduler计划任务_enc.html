<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"94248de282ecf1ccb15f450dbe98ab56d9f1fd3f94e99dd3222cc4d2fb2bb32447c25c82bcda70c24dcb9b634d4578b59864ffe1dc5b6219c893c289840438e8251cc8110ddd9dec6e818ac96fa4e488cc413754d1df9aaa0766954047e5d9ac15450a45d88d791df772cff27ec83c9d4459c4b3c70075bf8cad3e993c674b2ed351ee8960d826ac8891d8630ab2185ebbf8ea8b7d8d78a086f83a544f5f1400c3e737df39d4aafefccca2aff6a2e86b72d621909cc0fb93c06d6071ef0c295defd0443a8649df1f9adc6abfa5b504f0b731d8b9726a1d98901c244a225a145a0d674c7e5915d22b17c3c92742a119bc945a78a1677dc3d30cfb100bee404429984421cbd3ee69f1178e014db2b6187dd674a2447266e6da6d53dd3106703fa446a8676b894c07ac73de47a5f67fd447eca1b2707f6ef306730600f049d6b24c194df8842c94006feacb36c3d18c74e6459ee6ddf67c1268ef26cd17d0c5abe7dbe6f25040f0ad3b5d9feca61414c16ab677f7f909568e3b57d57d8b6643fdfeaa293da9b1931df591ba4f15c9a51e9b787c040b92a5da1165865c27e15cc10cfb1635e8619a1b608852c7d090f7e2852fefa84a55b28d4b7c0091f5e83e6a6be4db2a81b9240e9038c36b704c3cb3f056cd7338a1c63eb933679e97dcca9023b3449cdb0a587494b5f82dd6bac9b43fb062cc3b9d000fce7e7a9dac4b96424fb22185ce58f985a1e9cd156b30f59de1f5088bbe34ecf6a5f3ccc621e707ee38ad9bc6d6673031774550282a1827f9b51bb1f94e5f2fe3c5dc3f59d87fb3d253779be4dc726fb651057a00130f2d860600bf0563d3d3760124457a974cc42494bfc7b26c259f8771e42cd2dd9c1773f6ba6c3191bff9f732cd3d1251b4be1b93395a2faedd4515efec9b169fe68c01e1618df04e5d070872e528e9f9ab1af8cc25d0d2e96ea114e9aa3e1f4ac5ac02f74345651403cab8161c14514a71c73aa251b9c0228307b19f5bdde144552d7bc13f9b2ff3aab07f54d33fed2f470a2dc129c5ade0c37d51850e6a1e751249db2550830ea8a58f32d587aa70c14a74466eb6e627b443892e8790a98e7d0f27f98729e3b1f615a54eb5082bef241a2cda0bc342bd483e988f259cddb4d446bb9347459f5244a5e1711995132ce24bb160dcd923bd87a2beb31b29d3d3e1df7b34ea5ac76fb2c79ed311637a687b4ddb50b9162b5b1cf9c723b14ebc1a3087826ba0834d7f17b8e3719f274c733c68127bf5a58cace9e3652b74876d79260548d0b57ecb15697b66cf194fe122f9ed4dbb0cdfbc6013933ed96d5f5152b9c9f40a4a54f40dcadff6bf951b0aca44a005516ec6582c6df8015d827036dbd01fb8e3361f0fcfc9614318fb75fe9b97c810d198a8a1103f81d14b72cdcf294d4cc1291c2ceed2386e688cbaf5fe6c7ce2b3ade92654ba90183f63157f5957e7af0912adb7dc07c7a1b2dfb23bd9be7d2f49ae9e76da9b0a05d8f9e999582bb59ac846e9ebd5f06de341f6b803952345df6010193542e8d1039ad9349cad44d62e5c4b38994ff7c59a4884beb27f248142d03bb21fb1abcbd5c8a8f05f7234f76b2c68e15d1b34188aa46292333017b7d1ccca7622d9fdddfe0ed468e27027bdc56a8e535ddf7620f68e47a220cf2744955a09f797d548fba8785e7c520726b91528d3a255e99b0e9377c158fd091d4df6dba2b1769e4efb883ac1b68b6793c1ccdee5f8680227806499129be7de79d7eefad4c09b01221043487296988f8b31d47703e0d9099597769cfd800ae376807c779d45b6a94ce88a6eb9d58adf0d8f8cee83a035e6d2141df22594fad6280e591ff3681dc5defcb0f7a01580c1301d7c908a5bc956e781082c3ba825874a84e77bb5991f0b6a68359c4280a7496fdcbef65dc02511aa9b8512e1d9285dde76a4c98ca3c4b1bf7f09d7d1e388ef6d2073dff41f18fa08cedd3a9329825e9f9186e4e7281e3bf321f8aa827b54476acb6f0f2a48a8d2d7daed07ecf67e8c8bc9dbeaa1abbbedcba50bb99c67f79265b53e6c87e02b9f4b471546630d63434eb2c483ae0e4ab90a35f324caa5883771afaba823daa5fc14e3ef1967076838abe3bcd245d850e44f86f68876944d6526154b952bd5e08cf0560f5dd7f1da43a292a7a7a0e51212ce8f1367526e09e9283129a671c8ecf546cd495dc3445fb198209338a58ed9eecb30b22b0d8c7bcc52496be0a5ca30c394e783d837f4b9a7394870ac068554321d311835a6060e15963e28e038e4976bd2b57305d19eceb3149fdafeefbadc5f285694229e43f6c4cbb6fca8d86712a15333a2504c22623f1772345fcb2f4bbd285ad6e10628bed7c00e244cb0d1d7a26ca7630ca12ecdfa1709dedfde2f367d9ad23127174449cc75ffdf7b02a5b05399fb666205571411ef5bad3cddb68775458bb8d7423f8379b2f8769bbbb43ba32e7bb14c9c4b0a99e663a1c448f16acbec207319e396d81db5ee81c557486765a3783a2be30530f54f1dffae011f8483867f9b174575f90ac83e2e3a8a3716f7defa5ca819b8a9a931712712f3f45da2041697a69bc4c01aff40f927b2ef36247062b0ac744311f252db0769a720cb7ef6c872391546c54f0951fc87773860f2a2985f4ee7f45af4a46f77eff488c47f90d00a36cbb4687c2ca11f4764e2b051e5a31206a2788bf23af87befb8677dbf85443871011e46a2025a6909f97f31bb7fd2e75e7aa714fb690c2114629a0eb7688a744ec81f49182e7d8d26196e23937f5f6ba9b321646c80f42c53cbd1319de2ef38b68918fa5358198e45dc3413b0e85dc832dc6aef4dfafbfbeeb637bc3d29768ff012a72cb9732af6772b607a484f4e2bd48a5f3ee5a882646998cd1cb1ba3294b7b415f46b37b7664a2cb0908cf1fda1e2a88649f4a7aa0fd47ea5321e762dbfa26b6846f8cf38247807f339b25a5551cd0fffd63992ed385fa84113e7e586175d32ac72861b0c4392dceaa879f2dee94c4a27ec7ad715e069431b68512b9d5701eaa860ef509737751327adfc6f739103bff7fdb613105267d80f951b98364bd774fd5f1e6b67973e81cebead3523094e5e2b6bb6204416663377ef4e0094a4463a4d1f526c278981c0601345e4d33bcbde741bb06c00b71a7bc0ef555b05466986ba0d85224e67719b08041914e0e052d5f9eea8430eea0609ae934daca72ee48e1375eaa9429bdc4a2414d3f86c2f29cd26842883ed976203b4b5a693ba8441614e28d8e19d08011b0de965fe0fac8e6b24db735238ce440f4b18eecb43a07d29331acf92f5a3aa661144319512f99e4a612fb99862bed8b4fc63a172bbc4df2d9d5639efa29668f15457e9a2d9f0d9ebe26728da045ea36fe14c68cb46667cec8c98ea3713a2a92ce819817621a9cbc8c95cbf6347ce514e551e89bbaeb56e479bf835d0af82a023152fbd04026d242500fd3c504e9526ace8303f98f02ddcc980fdaca50a8d517d00f95f6f3380f1c32c582c54892cb025d3255863a5aaf9610bfa138401198e4a34d81762b01615666ffb4d732e3a8ebdd83bfc709af3527da558957c69f08409e4477be69592c0e6cfabd5a4c803a8bccd53a4061a2e08cf358da0ccb3e1544c245f828bc8fe439c1227a04cba20d6ed5059c8eebdd43657abe1a3c64a7612f9ab95af491d52b798d5906c3056ff118be8448933b26b84c742b0bf73339912d730bc67c06a6b8a52f88585754010e86d656fc49d2e458ab8ca9b01e0aaf835809a8e62833de23fdb1c572debd89ea5891850782e599b022d3d4fc2bcba39cbcf2ffc68f455391402842eb25b58d29e7f42600188a2f1b13446a7a88140c417f0a33a8b280b10a31d260928b7512f7152473be63536a3bd4d08bba8ac85f65b561be2b1a98dcc4078cd33bc35f8a94b4060fe71aa6ba86d1b414c6e7051cb3072bc29fcc2a51a9fbe0797e7edc27d9592fc7c9d1358d92186ea00ac2378e3e1172c4f49415e2c310faf5906898a5b44aba2ff4ac868898f1431e664cf081eda935c99e47e599c49e38cfc8f52569e4ef06cba4e63def0b77586816afc0fdbe1b97ef368245161d14d00fb1cdd3900135c66327c57c757be9c2d9a4f7e42b8376c2de56c55b4bb612840f5922d1324814d977292d89edfe33f5595b682d2c3d3e42b31a376eb0a2e195d39e8426778426530e01cdd895754e5b396ef886f695ace315e52741be537904cf818981aa81801d4dac78e425f51928173b46cf0dff42ea4943ff94a1e53348ca3cb59f72e7bb264590409f61d397d45e538d925b70e6de1941ec0417c9b802774065c2dc2947ad1b860f992fa32972846426e3da0372484f7d04bdbe733fddee7e4b930b305bb97ca654439b7696662a61bf308c1cc23f29340ec9b3de5651277146bcc22928b88d009fce71b53fc6e79d20d97be1ebaa7fad39007af856fbb6731ad725e5470db2dcbf2181144ea545fcfc2180873d9451e4e9e08fcb05961203d63b3e600de1ca6be3681a4736cd4076b2fd6da874deae409f37aac839412d8d06e96829ea1376b6554de7acda5212cb29c97ec1c9cefdefe781d798268a1ee152712c95edf76d7279b14de71a34371dab329f4edc5320e1250164c6ad2cb285ec9189f2306b71eb86c062a419c7df8a08075526c595afd511834a97468406a3c08b146c1f07262bd4294a6b835ff359412672b4b3e918dec6d9aeff5d3ca1e9f37bb07fb8712c0ae35f9ec287bc226e37004c2231ca3368c261874b3a656e5e1ec2dec1e2b2e5533dcf2c763feea7ad7f0a9883150e842bf7e2be5e67f93d4fd75fc83c6521548f7b3608e82b4e5822b92418758818a7f26c93d44f39a26794615b90e2262597f9887c61e008170a5fbd1b9cce8b1060d3a18ea4ef6bc032e337a31b3acf684a95568b382bfeae38990ee5fbe8844236542aa9b1e88dd5017be79abf3692aebe461c11d7799bb9ee2ba278b028bc62073efa0f1f114753b022e7e0b6a65d84a3703608748c7d80363b86618509a2f19b86ddf3f11b05a0cf827c9bed8fd25ed98a6a187455a7e8c542064df8fe197c8196b6cb9f4ed8839abdb34cc9084947db4d845eff8cf2280de8dca80e8851ee298c218df92d0ee572456794b38cf5c396db30ca2e2330338ff1c65bba05bc8b38b5d50cee8a65e1c9f4649fbb719edd09bec73a597423c9a483eb6fbb484e4852a784e9691bfa4a2eb790b631d028250a29e7abc2ec557d7f1a33414f3bc6ff07a5267f29fafb3f149b340c0ba619ded5d2eddad36185e4160d1da382387e4b533da97515734cbba1a93ceb730a25043a44361fc73addca6ba2b2c2d26ba183810c3008c6bf4a241425eeff006c2bb3bdcfffa8fa6e998ee9c3d95221b7f486f97847e9a12a9455cd25c8965f505157a6e7fee12f087eb42ac147bb465c33e12717cbd3fa4e4fc9937eb54c838089e3e2f0cc379ef99c1b36c1ebfaf35b5f640a0ad3732d6da57f54a44f3d308341e2726dd92c9bb0f8350e9f43815127caf019b518b760b1de768ba452b1315a48b9723c5d85605fd1a374b4e82b208726498ae7be8a5ad61f2854b34cd017d186e7307b6af2259a551c7e63bcaf9fb316d6c2cf58eb129fb6ede32ae52705ea3aaedb7fe39a01673f2fe385c17a32b93839a89c3292cf700eb6597699354b8c0499e71ef71487139c2f99567a97badf041d3d2c7eaf440395063921fc4d1b0c3a2049ad9054ecd6b169edb1e6ae78b7c4ec6a42bd5e04c00bcd81431e6a129da4b3e8225afe3f35d49c0324cccfb47e238fd17571a4eed67f992fd6798e9c08c5af904dbaaadefa14e899066b4b46f3affa1c9b057c1c582566fe1c61684b245088a7e36f0c40768a536f4413e3b30af03f9526f92be877cfdddced11ecba3ae157a23a1a5312717cb390687ca4f2a785cccb694bee48fc7b1f2a3b03c363b5d31a518d19aaf582d98ec11630cf6c76da20adc58143478271d20fd2c3acf802997c7e97b0c8b1b26ef4ffabc8d3f0f044f7f510733941439388be86ea5128d6aa8b633728e2ae59273488edd4c60cda974484aae43e492260ad35e656383f3d7323bbf5ca3e83abe3f742be7f0309f71e191279af27d158fd08b79a547d14c65f53b0d630876e1a84966a036924a4febca41d70dee8dbda5676eace333fa39940a095c6ae6616ef30efb47ecbf8eb18cd29f467989a8d67707d856f679954c8caac36b35dd596a2e871046112fcc83912d7be66faf031431d546b0b9fef7dfb88e25ab9d017084b565d214e0b7c49e5e4f78804d3001947d6ee2f176a7c2cc13c6422cd0a60a7bc8f13ac3733e390242bc4e6e58fe48e1fa4929930e50ce48a8a88211af185aa57b4da187947eda63a2dec5afc7414f64cb05f36bf347bdb52064e236f1ce2812559fc73a572769872114d08c660763feb8479aaf02c5486c03077dcc5b64f6c67811a4bdcea788dda8778eba542507ecf787ed06b3ba11289d6efd7379127ef41598b13e1f762a4efda8c6efe7e70b90147ffa14a8656445b26e9139b5cb366cec0f33782506b7d5e3451e35d8485e56712b36742161ce5a0cee45115073ddc731cd5fd11b3eba292e795418eb10082694d5107829ae61e943582b24164cf34280d73558b9cd8631d1fa14c57440771de5547e03682def49c854adcd6cd211cb0ea6acd8b86ec17117bf819007959fb1250c615afb9e9c372c7e3b20d10dd9d228ecf49167270db3d784584fca8ce04711d53130620b7da16b5aab795420bbf7ad6391a6d25d892fc790cb17739b5aefbd6fd15ffbbd79f149059d8262aab38009cf74ea7e6d6c8cf238c8e60d5d79abe32b26ed84af2940f17d5f7aadfc3a1f66609b1391ffc3a8a69f4e4b8c6cd55a6e29d4522dd7ef51d20b9e3127371ab9eb39bc4b8ba44ed88f19e902c339035e3e645793bbbfd9b899d50df8fb6fc846fa78973ecc07f1f27e2b8ee59e06cb5d3bd25e3489c0a62a2e12bc9c831582bfe77771bc630f180817fea28315d5615794f9e850be687aff21307a6099553469e23762f91ddded2ee359b07b300b36d0cafe78c4ac92c63d935d03c7fcb0e0d3d98b53cecbc8ae91de7ab867d8ef15966569df0bde01e1fa0aac907f1ab13fbe710fe1a321c6efca8b01327e2717bc227bbe633ac25b0523cade7aa62aa6fb83ede234ef168f5a36afec0e97caf235cc358883ac2bea0478c37faa5cbbd8d1a40ce669bdff26ac877b6bbe496711815b2255857f5b511b4fbe4fe37468b6ef5fd0840d6815d4bde506441cbc500e9d760dea54368fffa377dc80d85f852e01f5624bd199a26cbe4fbbea22b943440f0debeeb5177caa721e558872143109a70e9745957f8414c9cd0da66fc295b0783c312ba1237c6012bb7d8c025078591cc572477d513036bce29944f4461c6fb0dc90104c9eda98d94de5f42a1ac50620c5c67006a03e00f0f3c2920484d29f788aef80ee525d64fbca4c0d3c499b67ee17b1ed7213161fa4ecc6b0a24e81f888ca7cbe7cf95c05b8336a636734e00253fb2ce67fe97d7f43d939209ef51ab463e7909fd04fe48f687eb000dd4a739ef73eef48dff0c051fda1baefebe0ab44984cfd3e514eeb93b9c1f53f9a12f165e939a2f136dd32b2e73586cfcda088dff2103421d56d0c9a48f5e9b0e2ad4a0dcccc1a1ee308b4b0bf79335931ba1cd46b26e9ecad21d988eea8aa946881a03d71f0deed31165398c46f897ed0e5b724bbab1b004eaf5645909f2a4098b815a4cda62de25d4738f850f418b7c3cf06be2e5b12a0667127938e96157a73546f34a821619d0a6fa328fdd3538173a3ce89e1c4ccc4d32ff0e461dd8acb39b6aeac95c835a8ae245c647aa2291d60e84933b33ea0a1f3d7758cab4d0490c0d4600cf9288b3d14e713fbeedefd08841873ca5bc41236e42d10cf538b9286dc6ecafc4f1c8e6ecbb94f3dfdb1bc435811675a6048d2756027c7f416f94f9d483c2cf88d63934304123e9c58cb2566fe1d14e20a2ee5da8d31e8854bc1b003a90ea37f134897c8c187cfe3cf7fec53c38c93f5d5fe579240adb6a9c0139853026c769d92ac2dc67c6a2491e93f43ccd14dc58b462ffbd35956c2880b8bcbfa507899be42e3715305add7a9300999f4b91d6483a5d2482cea72272631c7b534e3b5898b271eb41dd20cf52d22701394fb59fa38a3cf5f77c0f77166187639246d1571f8cdb106d74cad62a8912e83b561960a9be4d9013de3234eed7197f128d5065993823685ec17dad5d4980bb6c341d9086ac3c4e95faafa0dddd24f4b1ec3cf48b2e4e79e7acc0808cd96d7f70d7c21a9513e4381d364fc4240d8f6e0887bbe456ca441006a414929ecb0c9b4cf212d0cc5ad149fde239298fb5ecf4a0a7c42f3fb8f1ca79b6ba0f6443084e70821bc39c018e4f3d50c570b030bd5089b4ff88c956d08cb174e8cd77b31ece9b34fb1df8a29a3cf0ad143f2c37923b0986e317f069d37948bd83acc3064b4dd7647c31b2c7c57739a9b96e33f8df7e582bfbaf7982c07328f7dfa60f1e67e13ae9faed9e26c199317a1c575331a49979e7149effbcdd705c8f19e2be0acd440a254d157d4328eeedc53e5fcfaa46ea678d68536fe8ea933769ddf3e51a0fbb5235b33f0e7bd7f3743d9c8cda033cde323327d46369904e7b526a7d0e422324b052a0a32cd21b5eccc91d96199d20de7f25f3e13aa580ba7b84ae6d6f1cc2d059096ef715f48d696f44e4bab7d1bc63a965150dc46f9e40d0210069b294d80100760b3dc5ff1e7c2e0a8b22beb02c42c34008255dd28f1139f0c17910c70050e6f471ed574cac989a4fcca10ed23cfe3a0feacd5512a31caf22551c99f18ecca6179beb3ec74a2b996f4a8c72452dc97ee091d01b575ddb044ee519d806514c84220182f2f38f358186397b9fda988977a9fb691b0ab222ce5490086c8e464354227a39e887003900ead8d4d59d5e4bcc3e0ce1c4f534b5d3430872dacdf5256154feec5ad428d1d3556acec301d78d3884129e4dd346b84ce8b4b6f356928e9091d9cd1d8fa2ec56b22ab608f8a08b5c62965ed4d5e37517523b91d8b6665a8d1ae66c7fd1ac685d837ddc8281af92d7491e0bf0db3cd67c18aa1dca2a66299884ab83a205ef5abf67e5070d8628b80f0dc2984acee5704d2475be7dd32bdfb9eb01288149d2dc274772e13a41b049d1d080c56ddeeab3c62dd1db5ef7d8ccfab17fc516cda2b9886e075952e4a106dcabed90b31d85fb31cd1083ab032a6da528f8ef1ca6a487f6632b0c048ab0fc4a5ea6f653be471bd11ac143daafef6132c07ea337f92a869e8c5bc7e8d865930a0084bfbf0092c6eb32781f7cc2decd1375cad5e9b01159f8d6e5b6ea0c36b7df2d3a143d4ca1aefd3f4a6a0510a0feb0c1c94b520efd83abb875f1c63f52ba60d9b6a9b592ccd7948be77e9f39db130c66840199e5d1234125842f8a62e5718cad544201cb56ce25e5cf5bd2be437036dc7cc7666a1aab4450d11b6ff738f5d48e66a056f6d719ebd89c418aab605fa86194b86f32196bab5a5bd9e3c3bb08e68e9b70daf094bffccde4f9c007c0145552c4389715b815fbb929565e5abb0ea8fb4e324f06b882bf6e61602e8568676f1f9ac1bb7f0299d8613881cba75727efde717e12250148cfb8824efa33aca4b69171fdf965305ae136ffbe5b2814e9e255e5c58405f26204d0e25d502372b930eee53761a5e1956b4e35e20bac039b6d46e604528f917c5f34ad5e5aec14fb0efe837123f5cbf2a942e686f0b21e65ae3dc6c06dd71a340d3366a2e6bc4729fda82a6abe47f6064b6cb2c14c49a9e3ddfb0587118e550831c0a14b6afecc06c373b7d07676c7893b6e35dd9c456c0829f0da1145a26de6ac79d6085b4ee95b4d2becc79e5ae43107eb49b98190e2e6c617f8247684d54526cfa80823a2b9647f3b9e33612e14e23570ce2e27216972810683b00ff00b2e9d565765d1685c6ff869a029114b3b90ca59fbb1882cd5da9631163f7b27fbd2e3bbae07337a57a0f77e9c47b8a78a2064efd58ea2f5121d870798371c3a7d9d3e302d79acb981524721e992739504c6e4ec5dd22bf578cee3aaeebce3c9fba2a335e8833519d674f1d15f35949400ab1a4de6471a17dcd9048324da9102176f98aedc89f66738f6276a6cd433e0bb4fba30975dc52e6adca77331f78965e986f188d6178a4d30267f56c7332374353e84aba4a4a4f556b861f860a1da82fcf81ef6dacbf1edb18f705779d220aca810bca68730d48240a576a32462e76275d89f849c4715fcf4c3b004ce269f472aaec4b9c94040b412502d681496827718a717aa7505d8584d7a8b4e1c6be84668dad366ebe08f11907bcc7b24ba8188b763401886576609d0313c87a7cbc0a4cec49220b4bed1e7265cf11cfe3c94952e09000adc5bded00b7b3b631271e621bbad7c4f1a7aa03903113b287108faf55b3a25bab56f0a892ae182bbde336f8d8a80ca72ad53a453b7c50d0b7b5b53388c9888c5bec055f30a22fffa68fa53a41a6e317426f95997e7a846c29acf7d278ca68d3fadb03c8e42555efb59c5e6d585283198fcff3bc6e22781e499c875717624ce4aff48ad3de4f024e1a8384e691abf1d6880ce3be5f26473ec4bd35c592db92da76688380bd57433daff24cea6f20e0cfa4d97e9465092cbfcbeab2e5691527a5714bb882b631c1eaad8d5f97387bd71b10497ab3fe1e70f8fa5b7ff18911c5da6dbe19f0e2fddb607bc2fc0da25daba37906bbe0625c94fb9e68eda114b7bd6658d1a9c5acc735cfb0a8433a813f5fc45fabb198062e837517a324e12a67a0f21cb0e7530cf36b2532d29cf217392bf5c83c2c5425ad37947161b0614dff0b9845a550af4890f7555646a2bd713f38264396da8357d4c3aeb7c9559cf65a30d3f15830125350554dc1218e21b229e4db725f2eafee7f85ecf658d84695764489c234b3f21d2d1f64504c2aa19744387a36dadc1ab7af97fc9b5edccd0ecb48ef3a2ecd5af9c9eed3cbd0a2f1657dd403af5a4e4493de061ab732ef85d3314f77aaf64214ceee4f11f6e5d98b423fadc5366c5569c55a7b1aadc0b3cb61ee6b0d3d74e34813344ea107fcb21ec9012d533b9f929a42af8aa55dc2f9a629fcd9e54bc9f6107caffaa3ec2e74b06731a970e355e5b8ff0fa5af2068d216020238af6b5c1948a0770d3cf249766573d06bd31d7d9332ea062158d9377c4d298b569aaef6e6c6a76b65db619591aff8996f822f0baa2fa18af39ba1dc8b70da4ab1e23cba6c2091a09e215b704494c7cb7b4618659ad3e2c744ec40112c6d5a00a8ead3d6e35ba986c016d68db0ec5671ac0a081efd56363f7c16d6cf1e3a3c0a7dc15ded47575c458cf491dec9c7036ccf695f8e72493a53e351437d84bfa98d87a7afec43031477fc488b245793fb9091da0dcd96c617dcd2ba2d0ca04c2976b56dafe2152291d3c1360ed33dbae19aafc71d1ba46454df92e2b8f08965bf6e97af2ca806204c7121d3bb150e91f54212165550911dd55f06dd41481eea7983ba34fddf3835f0acba5d0eb4f6ba10feaf4bde84f86107ddf2eab5236a204e93275d7ae9cced2883ca514f45da287b5d0ba2cb93475129521ddf55910d3354a68e2c6c319905da64ad40cba01f44cb142b7e825e3557cff6e248ce47b37ce3ad0c9551b2127c82e31c791680af53f2f97fbdda105650602072902bbb069fb9c3bcf92b1f2227457f9a6b7c36d75f898cbaa14b8897adb296eff1a48fa50b00162f13159b7ddea197c96727a9a99939f5fa075b6295cd50b4ac1ee2c0c5f94c45191b155b2f80323a04656d5b4d3eac4ecb1b0af60b58240834debfdcf5803b15c0c9b2041df0d0c85c8998a88b4503fc3e893ef04245a858b282dde90805a5bf077aa35c2402be8af17068ba54934498dc940ceeb34150615e3521faa337f13ce7e8ea530dbbdb46e74ecd9fd67ddde89c3f3023846cd4b9c9aebfaacfc3afdfb0ac74f9fa87e1367a74432b6e8563d6b02527c6a65eafc87e188133c4762a732d35689dc89457d094bd5fb4311b97f6a4cb22037842ad99329fb07ded21a31fff42772c6fdbbf188a0b81d7e69e9183eb9d3f36148159d0f7fb7212a1d0078e1615c21cdb2b257f3933e64ee7eeaec3bc4a81951ee79e3e2f043519cf5dc32613e9517f9d1ff5dbba65aa05183943385a4d68c0ad614f797ced3596ed2555af6fd1833416f89f3104d6899d805cfcbe99a1ca45525a0abd18e5d9df14c69bdcc596a63ebca8d97e3ee5bd70125276d55140b4ad4d438449e42b9b03bc9bb9b9909465dc3f2ea56624f022e05311a32eb2b0e09de039bd169d50542f6532be23d15c8f04b443bb2da4dfe2cfd86d8a201ee6ff10e07dec8a2e86b17963a4cd50300ddc70dbb1aeee180f0979845f329b9afe93656a1bc9bd80f103917eba0f976343f9ae8ac15b1c6346d40a9cdb90288cc246753ffc3f953f264b55b45eb3667a9d94d21e1ba4b40430914d70d9ff016a21ab8c6388edfe598c4d91ff8e33df22b7273ef4e8eb79b64410fd423caa578a0916096c7795bee02e50845aaf6000880a777dcf5712ebe152355ccb946a83f1f3d3d9f6126eb978f4c3802b36ed7c5b1d5b5087a3a6facd2ac2140dc9beaa2572a52d7875ab8df8e5048f4444c86fbde64799015ef31f984816e54d8851ef42456da7430d38e4f7981e4754eed93ac94d36946615453f46f474fc0e46d5c5171371aea36c9f97dacfbf1347b2e491b04b31c02bd3e57640791ac809a5916d9b180703760776d35181fb516e53444fa30913ca4cd852dbf5dd49a5d35b074b127fe46b7b017578e7968416c14c090c010aaa587535b3b32b2bf0009315df09c60773107d7726013ef4eed0d5e1f7d7292e0e17d95d03f6b8f1f6fbf87b7706526d844e825e68694c0bdfe77dd3b46cd2c6fc80703300f4b0d62a48d65cb02de7a768760d4215b3be90505cbba2aee177a3af07538b9b85dd2565b382570917635c50a53d00f3210071d76c1802349416ad9883b037731c866c8efc3609a91f0e62d71f62bee45620267a17246b9ec716962a8f93a65c6d302478b45dc1e67e442ed27e7a23f3ece4441ab6267746c128fac91cf37f8b3ec1129faf7db530276a42459cddc1a2a4298bb2caf127067dbd3d921cabfeb14374f03cdd329cfcb73e99acff9898fd7523655a4f7f648f85bce9627d88bf1b607c94e093448ff0773aada02c05f93a8e81ce8b22ada0a87241d5b864029e9885061c9990a423006567a2203375825bf6fd755d710229c1a983ff9a20c36946f3960a8a7361af588bf222d8d3805bf517bd405554ae5ba37f88711bbab5f6060903310b0f192a77ef8fa19c1765f8c9fc5a1866670b723e98060084d4e6b62ea46d4428faaf979297219eebba023acd501c210a48488cfa4233b9213c8db360a5b8197b78f78bf6618066faf2dc52c29be79edaca75cb4257ef8f8001b5dd2866f381b94e810a0d3c05867e2f7281cae0b71d5ec377d74b265e37ad027f26aa4d265309ea50e43900e2d85f9936c18b350b152b3700bc58224edc9becfb7c27fe902f5248aaea06a4d17ca7f302920f5d6067e1461b87bfadeb0c417a4d0012ca81f7ab00222c47c60a638b76a59c6fa5406ea80220eb90540a4a38a8765ace66a7400c3cbec4e7f64aab056de7e9fe21eaeb24143a60732718fefbc13edc70597c67042bb670e1b45550460ad465282ed16b6693c1b13f727fc80f3f46db45edc86423af7bd1ac86b7f63796da846570e71d2780e1584b9dfdfd3e16a304718ec76a1160d6fedcc3ac875ce85d4ba64138f98fe5c7861b0d9bfcd85eda3028d5c6233b5063e42d6324f4b3d5c24ac875fa44e4100e564f4d688676f7d0f5383fa8c20228007e95562cb0851c3e0ad33cde1a451269611a67d22b3a0115c07d88b3c337f61c00c2ba7abd5e4f7b3125d5073b54937676c5542efeee7d87b96c482c880537a0a4e5776b37521eb8bfe87d771741547544e26cfca703fd5a63d437fe8a9679ce1c1456bd2a2621a3eb01ed33fb0c69b431ed4aaa1f2eb23ef205fca605dca4a25e366ac0c535ffc1957edec82c054b5d774f6394d969682f8d3641e51bdcfde5abaf361e5341feb9d96b5450f8af93a88762e3eae6eb635a0efd784da2d3c248b22561b53df0caa322766da4d22329c470ed3e66ab21e34ca98143a0b7a8142224a8f65ab86ddc98d17d06f06607f14c6a8a6c0508bea059e7ddba75eebdc1241b358a398c23f1f59382ad06e42bcda4671e7a8a7e07de58c7c76b1f50221feab4738a7da500e16c832b1d01a618f2582105f8d1b133af4f1f290abb3373ec14ce14588d7229e86abf2e0550d0d92efc36510092b2dbba08f869de898d1bbdcbefb709f1eab0c658448361fa27c1c771fd1089e977d367bfd34297445ff334ffc8d8aabca727bce305a85c54c8d687a43d0b40a41b6fd44b671697ad51bece52b50f6534a2e113df073f7f2c9a261ce495bebd453ed2829626f51067f40ffdff4f6d8646fc8c1080d6740702af4894e47d302b041b5beab5b96d6ac18617c9efe27407168f238d7d4a6f509bfa7e085b04adc4a3d5c6a6bbda002504881b91002250fcf3f6ab75af150b9947f9f6d7bd3753a1849fa310aec125c085065fc98aeec1e5558513d1e20b85469a416bf997f6c31362bed76c597fbf41162e18bec7c06c2446591b9f7e780e3230aafe980876539dc6aadd318c0533da95bd3e0f636b8d6d13fb86598ea40dfd62139e54b15336dd4726d87283f17424fe7ccfd2263fb461c5c53236533d5a878a211e351d09cc41877c2b0554305cac985147dcd02a2c5a12f1fe733b4cb7dc88ae75d307b03057ebbffec636ba0e4210579e83c60a4b956be020543b8583b0b293fef45e25f53c4cb95f1c605ac08770d026bfb2bb3e13cf5021f0471cd839a8b94feb5f56c0225bf6b3ae69202dfe48f1d7b66faf8558194a83a7b4484bff6782ba19c7089439e0a73d3534ff02295179d4050fe07af009add78bf1b9c0d331dc3de260a4ad6d7f29acec7b7c07db06971139616580e592c1249041e8c7b3d2491d62e735facfd7631917bfcdc84dd3de6506f25c2ada8646c97391df1a2a5e3ebcfbb1f2fd533f8c6b1a8fe3db476739c71351a60c024a2adb11a3cb0f3ecd1ed49cb08be5d660870872e1609f33a8f23920e8032f4df891c5fc47af2c86178baa1abe8df494e7d3597e16a397b8e47b56223090dd687b01732b5847913ed61960899d9568ef93c785004b4816b6b11d85fe766cfbc041722534eb50e7a2fd2a898178164d5205762582f85c7e600d1801b9ee222218a425c1fccc6e20846a9525f948e98b92d87b5fee5514d5bc5eec0e3a7e50da779425408349b305d474b76ddceb863e1ffc7e0a58eaa81792d46f23c1ca9ac875c624fda151496ccbcbff71c10b9c7e1fa0666d0cd463e9da067b353e28e2117ba78241ff964a129c38cb303ac23addfae185b5e0ef46e269e7bd7566bcf25b6efdd7a7018f6fd7569e5b0fb3bbcbb6f2feae6d57372f5eb82fcfd1aa58c746856aef75d79d18ab4bb7e213b92e2624018da0755a7147ab871826b4e09d5dc68a3626d109efe154e07b2d6ae9bc5ff925a92bf0ff9e931fbf0aea308529761305ed034fba30b5f4261fa2f41a6e8bcf9c9408704a8a4ac2e9b24d1f8331c55091e509cab374437879f56fb1922e4f60d86f84daaf1dc230f8e68b881e1c222bc91917a1cbfea2cc07e64ec01568ab7fd7d3f0172a9b2485b27e08f9c7d6f1a11038408a7261689aa582e50dbc5639aaa231e64197c398c591cbe224c695e7710746d0ff7055eec9845198720981b6533b0fdd2bb5ec6acac6a8993b0dd39e028879a86ce8f32650de45de2cfb40f48fc890aaacb1574665a4cec1591364d11b8c901df5db48bd090e2fb4784aef0d66e0b0c545ac237827811d3773c90ba4080168f42af75f2680dea5b6c94b4c6411fc9e298729a925d5a3aee7f66b55124ceed4536451e101df795a4bb79889d5d7ff9de7aad935be7c47554afa1f7de23543bcff3d2dcd8379055cb3fc7335becd237761ec6b02553d33d8ff8dbcc8ee97c171a26b1af9f2670788e12622eca2e2b83518eb099c3a9f32e40520909f8071bf862d56ff52c17bf04715c93b27c0dc1a23fab8cdad428be29a85e1b87beadfe0ecb79de69d1d5095dd702d41fccd257cf7d3cd222ba3b82f5a46e894e2a2acda561eee34913714f2fc47383ea375d45a4b14655af4e22603dcea4283fd691697bc6562695d83c40cd9c8eaa763a005bccb19ecdd076a78190e1407","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"a04e2aebb4f065114c065b7fbf49759e"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
