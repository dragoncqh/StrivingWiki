<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"c403a9e1acf167d66cc5e4325376f9e3292491b7051f73020f5d3bcb53da35c544735e6dad7a58a8566d159672c3b7fcf276a97ec5d11a9aa99d2d8c0bb7729f1af29d7f4dc15552f65521939363df231db0e8182f671e31f46724c4df7d69ecd5c54df6caf2f2b87ed96f59a8fab0c6a06ccdd4709c03ccef87c494f8c9c8ec4397c1af4e1aa7825b18452635faada358dba6fee76a44abeebea2e7997d28921a4c6451e3710fbf648eabdebb71488b7fcb1d02ff091df2d1fa8a776ad17c804d14d2c79f4b5556dfa9732f5eb8960c553bca9fb76526a9b7b5aeb0cf1b71a36ec795375206fa1101a711c7cea5f222c06859a1b790056471f4d1019b44608fe81dd69eab344ac14917ae0aff0c8f95ba176357f76f1d1b0b6deb2626931c2ab09a1e40b26134752f1a458b99cbfb91b65f3cefbeb4ed01ae6a1834148593099bcae0784cd1dd178d4876b29638dd62d520b8175dfdfdee49ec3b9da39f55f09ea5104e8ac5eb07e718587a5b8d71b4c2669d858dca19848fa21d3c04a9e978a4ca13fb7394caf80c3655d8d75962038f013faa15fd8ad3c418c408f094889ec9d195c1e7cf20c2c57030fe5776785ac90452f06efaf26d290ebb8077fecce11c102fb0035ff0575c9065cd220ca1cac61aaccc6653ecc4e1d007d796a0cd61578f3de038284f549888f20de5bc6d83a66377d425d9c87808fd7ab964ac9ca8895ceb07213b30451aa9e5b2a540ec9f3db78a3e49babff1fb9d82697f2081ed809b6916933a64f03d55aa54b6fb26064f54dc6a2dcc50d96127265cf81fd8b40a43b168bd039304dffd0c75b0fae1fd1c901802d1ae01406eb2c79c38acce18bc49eaf5b49972585c56f8eaf8ee33f64c39cd85ff944fcf96d064d5b51c85941ad065d17a9a3259023de780bb208e95fb5df83b7ee72ad12731ae00e7a4b545367b2571662ba2d3963103e9c399ccaff6dd326cb6ce455896d19aaa155c988392937ba62c95bb9b9ba67289e3959efb448928644385c79f8f3443a99fcc811f7a2cb731e7b50521d89b2abd8c6fc75ec8ee738004b793a3c6cfc1631c0d86ba9f6312eca9094cc3ecae84412372dab7cc6a6f03bed4df2b3ed8e31d0d3d420ea7b45efd6ab5fefc129d83b2deaa0b12450feff44d8de43869db0189326878864791fc5f32305c062dc8f1c3260f06e6f6b3db27a30bda8c3f6239ad2cae9c2aaa63ecb12c2236cfecc0b0f6f9e078dc17058d867a4dfda3cc7237b164e0699eefdb80459572d71faf0710226bea49c115a86147e021470cb97215ce11b4a3f9f6725b90642c80eeb7b538ec5b7e8fe15489f55893b6cd11f8f0ec2147f433a927b240b87c864100fce21be8e9fa3705ded028e29112c25ea316acdcb5c55913dc7d30404f94160ab541c9e6892b2a463808cc9c5c1621be58c9d902bcd2c4d181e51fa2a423f0ba91e9448f85a18671377baa692eaf1297e66bc34478c0653ad03135ebfa09e95c7e56725ad1ad638fad6482181f7befa19f5b702f070dc2713803b67e5968e8bc4dbf34a82700e5305c055194e61f457b212d18caba07143d9146fc0a18da1df0f95e7847d084f62ea729ea5fe15ba604514f9c17b6d6657bb47cba5e3c536d8cbdd25fae787f35e21cfd2f1796a8584b79062cb652f961901ca38807821925cbe2fe501fe14f8957fb50310169a68efc6ccc1e61f5dcd3547607f230706dfe562b693c3bbc7f343a9207a2a1b9527fdb7478f5cdfa13668bbf4f03a62483dd04d38ca59192225ced9983ae308ee95b39d2187806c9c86cd4f35ffe10a8f0e9b843e1a76c7a227e15ba607f04e0e2acb68e13e4dfce174b6d0dc60cc5a8703cf7c7879a6a8441e9ab9c25081047b4e107df310d90b23cd7bc7c70b48e2b8b3030a9b596bf35973d2cad44ee20348b67b77a58f4de2ffd857638d4fa7a1c4011627989570a83840c9674ac8120a170aee5a97b8b4be3bac7b6ea45083129d4a44ea72e82adcb5e74bc9bfd4cf081303efdc4cf14d12a49088a4439abce89262a8e552b06288aa844cbd2f4d2e6fcfea8998970109c525345735c7addaa616dea97d0dd33e425b92a5a8c93aee50d703804b490155d23c876fccf23c2adcd4bac14f937929f05b2ae1594bd28521fc4dc46223d710c2d18dd98ef2c9aa91d7a0e295cc7edec8446421f0893555ba926601d759251d563dd770ffdd6b9672542af20f4799680a94b3844a5f4298fa5353d97a361cb04078e6b11cfd02196c298819cb288319e019565f44a0914b76123abbfca5f9323d6a84ccc9f772559f073e2adc18f6db1a39737144e60b4380efe3070bf42a61352c53c8454f2afcb0efdcc1f82943d43680ebb719de689a8fa020c5038fc45714ddcdc4fbcf1b716de0776918f9883cb63024c87d029c0c1af33a6d02bea3b2149209f4a04dc9fcfdd4681d6946fad8681eb5432e2fe52c9c15699190fa43629e64f87cb46c57c37b095b0c8ecdb284c4e8c81a4b9edc0e1aafe88cf71ccbeca5947705b7be1a9653f94f457845fd71a091c47a399a213052875747ac69f38c97c3e0c9e96f9b5a29cb97dbd1d892c4f8e7f33e84379897f7c427992f0de4fa5bff8d46d6fca476c0c4161537e41fd657fff7821ea08d297f2ebfe29a9cddb016ff48e030411e2af8593c8f1dd719e728738b3067ad409e95163f1b93d67086da405525287fe60fb09b9fb9910e46aa40e05c5befc2e1523fb6fa3428e90f5a3c85e51d773da93441b9c42feb3fbfe53ccdf26a92268b00b2f24999aa8ab6fdf0a31bc3668c45827a5b4bd6f506d4fe69318cb1054adf71285e1b6dc2122ef083a6b45ea9bbca90d0f1a483a3e0d1c0b59dda4a8e3417dea4e7aac2105d1b7f8a7ab0fde2efbb50f3f712132247e74812c711ad74b574dad5754547f87b92440a6da1c41c709ddabe3f79386169a48c423e5c38b1c2002f2b83e4b2de1bb9eebb28ecff83d91b62d79ad4d382d54c4d1c142b9a86ac6211ae0f3a9957a3b138dc9ec12b0db09ed50edbb60e942427260265caca12531dc0880597fb73559c9a3b36db9d08c21121bc512a0b5cccbeefcd962a69b663f631861c77d45d4a8ee843332080a9771beaab27c54c5da5628d057894f80d3fe65da85a1e3b5d3cf6361a6b86adc7781e38983d4f507b11b3fd0484437e985a9a04aa688c5e8fa0f740b7d285525e3a5eb9bec4796fe8d1e0b2cb933c4072fae0f2a8cf870eb1f20def63f800da96d6ca5ca21d3b330e221ebd00d46dbb0cb31d6065979195378b0c6e658394f38d3815b6719372a49bd606e00403dcb5f755df5a1917fd95b87384e5d20d927a274e1ef278fc8c5897ce7dd094f7d11475b120197f15cf1a7cccb2062edd7d551c3f1934ee22f703856162ada0b1d7fa90eae92d783a93c0d8e27f799acdcca3d012b6c936090a205b2f146a3be29a973b9f5434bbfdc1cbcbff5b66c353377c607dacecc79938746ee90c287cdca402eec2ff812db6fd07f073464da17ac3e590f7b6270ff90ec321ee556381ee935ea2cf3206bbc0c9f3ebf5c1ec4a99f35484fe832b94cb2674776be3f5138c6b3d4b4f19a5c338cd7fed8aa16ae17a72c615bd22fd3f96f42558646e0b23e2a980d5b5a821a39a44f28c90f6f1ccfc66d7ad873b299174878b8d4e92e41131e14d3e7d4f4a53fda5147938094ae1bbc57ac44a77e184d1d62fc7e368a512ffe2f20598941e57b7eb2766b805bdd9a15951ac5813c0b01ed13507eb9df311f41a712732bb7ac076221b7cc0d8d5ed6e9db92012ceb73f05924bdec9f191a078058ec39f8a614f69ff81162437d78feb067e98dd32950e891fa6e968d9608c542a253f1a7667ad0736c4a9964cffd4079833ed5146cc00780ba2cf23d1717b482643882b7083963e2f1dc7696e88315cc4351019724cc5c0772d4d726ea4d4759712b950ec8aebb67f2124d5bf6cf99ff7802f520b81696856e93dd0ad81b12666288a8ba0df9c4dd3616b078ab1bf221bcea59b84ce2a7f868348170abde49f7b57d03e98567b15cd9043a895e16bf130d89c2d04c15470f137626bd102172c9c7e43fa0de764095e9a0ede54e045a56e83078174f4ebc330e956422b679031ce469efba7d5c4fc77e723738dcdf8645bd124a77923286cb9be2e8e6b5f96d3e93d4a05e5f60a644ba7eff96034e1bf611b38d35184855a0d07245f0991cef88e1d830d71cd21331b296e03a2e3045e73514addc84c222fa44bf459b3527f3083137b600d96a37f890bd1da0ab01626f07dcb15ed2661ddd13d340a30b5f3f389a83fdc4d0023eb172b587cb6a763bdaddcdec12b0d7b9378b7d7864c3f184038595b787e6bd02a6ad6d10084dd51c520495cd763d15ce8b36cd0222b45421ccf2f456742cc90cf25a24d5be9baf908f04defb22d187af35bf76a87adbd21e80e7e736bc211bc91ba0fcd8236c8655eeaa3c3f792a54ad4d9c61f0c86f19ccf7f9e50187f6bda06c01aff2acf49cf31ed2a200741a533fe231ce250c735fa86a45ba10af8d6608b6563a7a3e078799a9fcbd76967a4096263b9a51acbb850d7698c638a2caeba6ec3a36d08fa2fab780984a134b3ec949a9a6c7055c7b1156bdab4637e61c3b049af5e8de79c6328b0e839c04232ae8d4c289a2f3c7ef2780945973784f136f2a739f7e343162ab0690c4fc361e44cad811f3171eacdb4d22276e92bd322df18e1e1a9618494474836b30e909d289dccc71e41a9b3d314790ed3a2ab2b1ce74db6031d4094d1b32746d2c98f0a969031f2ca369774a02d41abdc30bce6097ad5d5526ed55985eddf25bb91c924315aaf1527202cf471d04a67f59a4c06ca06a7130b39e8a57c56ff0b263618946e09666ea282469478a6491f5b5f0a2aa35a42b3e6c6927314833c4993e648157567afae81973400d87dac0fd0ee4f118d43cb55eb44ad69b273c061c1fb40b64ec5e0b9816e4ad74939e3155b7f22d5af39d2d9629d7dd897cfc4ed089b3d92ffa87c3ee5cfac2d1f28cddfd8d0db716aec1d5e23d4a8afd2f90322fd61e35e721c4e0ee0dc23f3dcd8a034af8702100259b0b3a15e85d6169d1f85ed4dd4df92eaea436cff591a3a0154ae36419eea2b2ec52ff077916b6107acdacfd67d027fc53f2a40fba288b58a8ffb80a52e95142d3675c9559fa7b80c78301c217cae597ea08ee75994d2b7bf136b36e24f852df721501cf25fc2d43f44cdf262bf1617578bca6b74c5283852f9c1d30448f374e5ca8503cd9105aa52c6b62fdcee38448c72eb9a33def01d651e78be48aa118e1585f5f0c97e84ed4504449512ddc0f8eb3a5d373ac2b3593f8b284ba30c5d250a159feccb16c99b8d1ffc6d528f53a547a31205fecf1c98243c742c3963e1e9a70ede45d1a54e0326f289ced7371264767376bbc9403e7b90ca508a07e42b5cccd798f82569ed7407c40254738acc51db8caa0b02de7b45a721337a98ab2d08d74b13cb8ef197e86c5656cc1bb91143d52770cc8b2b304c8ca8926ef494fa515f06d9dfb5e54bf440d872285b45ad51b674c1cb787ad84321a9fb97c565fc100fecf463f3a62b3017e13049232ecfe4d0bd03136487488775baf4019b219ea1646db715016ede2e6721be064978fd55e031c327e15f49bba8c744acde64ef3f3d6bcfee2483c0166ea30e3002ca849d2d5085c7fb8e7b1d777a4241eebd956025780ad0707ddcc7e74fa448c60bef4bacd303db520b5f9a48113a2f685a4177a4d66baf6b231bbeb163af8af729b74171463b1b8a779a1e1df7460174756f7812c698ec354eb44147df4933bb6a805678b7225962c322b033c781131b4e503c88e3d6b928586e23c2ec32945ed28a0dbc98a69e03f3bc6bf9bbc6ef3ffbf9a25c745aaf230068864707d361fc41eeff217fad599876f6b675f7ba8f3fe885a589768fcd518f189733320c9967ce1e2924751225ebcb06f06cf4e4b4472083188ebdea1afd68731b3369808877e3b0e8b89f4fe90b45e95f0cd274df5be3f6e1d1ad9f67a6f934c374848f16b8e193fd69015a93fabcf8a9bd57c94d9d77d95ef7e9bf6555b1419c722f3d53d4e407c534a86fea26fbb79b383bf604f5751e54dc50686a71c7ab0dfc5c3b98a4422c94c19bbb331f2dad7aa1634e531d255dd88a6ab11e7d864f63cabe3b6af70fd543e6d6e666f288e59ddbc5de7b17105291adf2a1ff972979e55d6fbcff181a2f7f1ae7ee28b776e5913a064dbb6bf2fae53838abd9ff5103131c7a622074152dc9667e1a39c899fb6e5688450b6cb85616bbc20ccbe8ef221825f2ac50ff4d86d47befab81dda56f0413e02d2bbfabc8b435a01c8a3926e213e3c9fef00a8e634b0c2da9964c8dd6265182e9e3ffad9c3b66974a1f89057948a2370136ee5d4c258ff281b864e522f73428bea008867f4b554df7d3bcab1218ab1faac5f3cc6d4e9566392f7f9e36735006c77a3e6b5acbb9ca4b14116ef01c0208c50051d906a1642ddfb133c756183da2897222e49642511c5b1d91a44e7e26fff27e15289b170e86d1f95d4f91d19ff78744a96d58ae1b78d676493cf09951ff745050b40c6e690d96f956101a3ebfc321d60e713c2c4476ae3551e4808c17e51708240de3ddc9ad7828af7cce691df0ecdb129df2959862cfdda74b64ff56f4ff30b5c8a4cfa62092a9ec09d72c1ce29972866b07a9225deccbc799d733feede53b1071e0355f7d018777d91658a67172ffc3e4f87364edca67e3c993095ee14049043c2332fd86a4e876e77255929fb40c724ffcc411c1adb7909bb3d3d29c4f75359dbe1dc59315c7637d30a224754d9b20b45074becbf383adf98995629278bd9f9d9efce6914a690d5995adaab4f59302a4030c87169c73c2f46264cba4c4101167bf9ac2d6acb5164e2bd97a3d3cee6b6a8d86dfa4ce5d47e57a986b97c8351107b50a2cdbf4df995e84289f282e363dea68e3c85864abb489416c4af2fe695ced1c4fa20a40c90c658400ee72792fc57077cb57425de611a0cc99dd137a653f97f9eada9080e88b7e9102a6ec408cb1fc3c803e7d426f4eae1a5c3083aedc0daecfb75e3bc59e6a8ec5cf6a249ed7cc3b5c820f786374d41d6011eec0d6279a8145ef337ece0edd389fd0050b7292e8bd80c5ca6442b522075b520c3e44e633562cb252db40df123ac1b9854f4903d2e38978cf27febb483a29f625cb51c8798fb356252a83b1635d71199bf51d14a8d9fd9b26e99fb6dd84e07e903471a014e20f0ab623cd562b15bd8f1ec53446c7fde6ac2076b09b1273c131717828582ac0ce00c30675c916b563015b36425ae57c9f6a00badb5925098188074c149e2de850ccdb42422b0420aeba02293bac05a5d1d1a8c5e641c77f7def5f656cb431210bfbaf1758c32a5dd29196e42f67781f498f674934bb9c2d9f9b8314a76ec94bb04308e62aed6c4c4b181317ba7d2f48d0930a62e351e61ff83683b5781b982d58479173bf614174543bcbbfee6235c98eb775cda842802fc8055ba5a63a0b6706e29778b336ba47ac4ab4b97d305b7bf4075c23e314bb4285c3317b0fca66ea3df8e1da200ca7cbe65f48f67ff98c647a140c7f3bb71c3f81738e688dc698767e79cdc7ff5124ad0fbecafb686fbefb140aceb160658c6576df495eccb2636684d5a2ba4f9adcb4a4335a0a0bb58ccfb686f7a65307b34144a39c2a569c7dd86ae675e6778870299dfc628683005d61fec8bb3c1c3e55bca20879abd7e5f9d94f138f1eb273f2a5bfab65fceb651e7c48991ecaa9062ea2320702ca7a522172ba205f889be550136accb96565cd6cc25e1f4f2bbe1824de67c3126355a430eca3fca89aa78bf8be8367680bac0b92077dc98c2c7e49c22eea951c1d8e58fb1d5fd67c4d128c2c69174e4301427451b39418333818c2709d1eb50a1a5c6353e712cc58e5e19b072656147e7e4d272cd9eb152e237804215059def550c5f6c690cbc6c2d22ee8ff3eaf329471f1126a30bcbdc3a99d287c05d8a11f846eae2cd3da7a42100a6560dc187fa2361bb6a156c76f9cea89458276bf3dbc76ce7569114e0c8a29ed87ef1a4652576f632beee991ab68043f59d8bfa2d9e244eefa87efae9f7d5e10b80527c99108ec84f8a8573cf35522cfacd3c2e83edab6efe24df1566ea135426d21d6c9e9e26639010648eba542f3b0b4d70089644f44aa0b4d912406a29aff9830cb3e63cfd55a8c640696118fc0f85e6b50060bb57034816df50b3c9589aa47291cff5b054a2faeae3674bba51d4ab30e2f944be16cf7c7ea5ccdd6d45f6723208e133f5c315d61e80cf34132433be47a0713cfb09bbf2b217c83f990a48ad0713479b6562a016726fa2a4b02068a1341b3d1955a41dd770498b98a234c268f82e6ed5d2a265b7dd3e1a2b09eae2a10830cf5cbeb6581a5bbb488d071febf13e01ebd9d6b4be944697f7d4219d2d6310d2fd04b1fa56aab713f6022135c5af869d6301f8b1d2cb3ba9b52939699723548dd9398b3cb6f4fb04db84aeecd80d33741a30537260884f48238cf3d76fb5db4388e139f3d5aa61e970844367bc9b8b7ffae79517a64eb14f63bf12ba800ad9169c229cdb9f861ceabf448667395d621667bc1e97723f6bf2c5657613e298375c6a1b9f7974840c32ae2b1bbce5f749737141ea0ccb9198deb17af870c220c284e5621f98ef028b686f607a970a68d68d9a6922cee005762e7a862d6d670c391a4cc7ba05f7c2a8f062bf708043acf83a6cfb50055b400b14e4475bf9257e7bba200484b42a18c85652631181772241de3da682338ed765ba8e62fd052f409e34e909ea7b508c378088edfc36f798dd723f4b4356e61bb101996a38e37ef020656e088a51119d63da949a987f0c19b13f0cfeb83defa9aea6db876af5a198508d0b9ecd1838370b85936ef0ed0d8365f476c6d3e1b677fa91f6effe85aebacb1e72a9c3c23d9e3c635cbe4d655b6b8567b5f1be0f2d17e4d18630d9e424b9b87406bfd39642ae662b2d74a1bf52c79b30903172ff9d9944c1a60c9bedde6fc55c8c8ecead4f72bebc035801f3d8d2450b97cb2a5e64fe2a2f790489291b422a3a825fc95557f7a2605cc3c8bcd7638da1c6f9649d3b4b7f1d0665ee0a5577da9e828eac9b78d71313114d70fa81a92820b301a6016b211c26dda2d71915ea276fef6e4381cf574b0c6fadf101ebb2109916d6ddf040909f75a758e83b78be35c4510a99f3ba5f88e43ecf08cd3b8da13c9f8a7ad15bc7e2633f74f605bb480d4bbf15b11df423efa5c2323ef411c5319587a8c4163c7d4221334cdce9288d2e25aaa16dd2d1b335444dc6ed115c98bbae69f955b0e44ecf34c5ae35b25316769b2c06a74a07772151b57ae20311930c56ee5cc9b806bd7bf57e95b3d6885fc9332e765150e4bc3bdd11e88028ea88cf0bc6c7e477b14a24dc13946386dddf63d6dbf9b762afe09ad7ea68bc2bc5468bd677740e56114e50d79906348105c566ad90a736ebc2f65206169859357d2bc6e934b298b3a4c492f0d3665a08138786a86deb7a882f25c8ec8e921b60f4415df75d7a5647333a6bb3762aace3c11326210a15dadec2385327e6c3a2eca2f58afc5406de5519a85f3841dfee554a9b6ce39fdde76bd5d6ff646fc1479984e00fd71d4049815b9bdbbe35e0c5db3453c048bc8977716f25216573da822c6759413c5ae938769fb5169bf4916f33d4915c040c8bfbdaf8d6cdabbebf3df62b41224bea1986f853d6ba8e4596b83b6b418068dfb19b263f4fb32449beba81faa1d41e2840d655452c14296e4f2b812c56289691889c39ccd9021997cc1f31b2f2eab6396a1409d044d5959e5077c9ab27727e94ad73c12e00268ec4e798291d9629018ff5dbd958bf63b09cdbe392af2a32434a55987f15398fc4a823baffd8f89401a9edb006918ce7f43c519e67296890fce5202fe37d7ebddff10fec1af9e88f90544e36407ff9d80a079b27514553c4a49c75919cf641024234abf39ba4e97eeb36f6a72af0dedc53dea85dfc0869679009a1a67be0299a173bffa532386250b8d57fda21959b7589540de88ed3c5d4c647446dc283e218311f1b505e8c4cb7befa176c286ef65cf0e6c150ce0ac1d1bb190f3a709c94b2c017e23352b50a01d26ee8911225fb55916d380e0d846c337bd08f90a46a45941b62eefc6eaa38e1c588fc6798fbdec43b76f7b621805f7b328bf2d08242ce118064d7c2a349528522ce39170ee70d94f0033448ce645f5363a89552c7b115f8cfc622cfa1bf8e3b9d020e9ea0cb3f4975721437d110a94cc0a945287d3f1110de976f9dcf6e2a6501e4e602756dafdb3b1fe081933190167dd253ad89d7124666f3f182dbf4a3088c4f0300fe12a8a5ac3a42c3c72bb499363f9ac7240a75695aca38f746b680ab40be60f85010df9ab0d10c6d97d00b54da44468b9b01cc240e80209693a5b06b2705a4506d4dd6333b00b49827cba53dd378ee15461ed8e44adacb55ea1ec409a87bc281a62731c7dc6794699d6d9ab5f789670facc560b0449e6478119bfa1f15e3fa33955ca22f54a80e5351da1d826517d932e03e7e3d95fa4308036675d35cba042aeebbae9ee9a0e0c6f8c4277f6388b8f199a9c83146b88dafce4a072d2326f853bc2897fac334ba791f534deb8520206d6e22b75158733c7ffad9eaf63e8b91ebafbd08e6e11fa06e8fa1bb74075c97f71db3cf505ff7742bb7e4c735b53e2908f237082435b9cf929cfe9db5ccef1f8377c4cdb89520ba993323561cddaea1c18136174ed5c7aaeb40fa973729cb7bcbde8e709c2b53691978fde940e26bbdc6541e41b1cfa5d4dc588ad10d33a46c6f6e42a45ca3518e96e868fbfaba9737263bb5f65f69ad3835a1aac6c45573bf48cd56f8eda8b4bbc21a140382a82202d273cbf9b3cc6ce54e0c4af39efc444aae9cc77bc2eb9b49a11eaede9888f1615407d500227f42ade2730afe803fd56cd6dc0bc1d929fe22101f0edd8ab9657fc1a566d6009edd5e857a123e724f63da05e5ad9ff0856523e9bd0f25db1cb1e9ecfe27f72fb63c554517bb5da86efa7ee1145010438d1ffb73b4aa15cc703f23ae647835b37fc2ffdaf2b6e849ac24c163ef1e84ce483ef8736e88f17f6645bfab12a22eefd4a287d4bd19bab34913cd34fb6a6392425b389b48a18c4de279faa202110df449bb13a9d7de8cf93168e9723a0dbaccdf80a98341523d8a6e2e3f35d5c06cdd065232892ad8ee81c877f667858e8f1ef436329ae1aa9cc037e94bef6482a0007865fbff7a8f54adf80b89a685dd98eec40ce26218b381fc17ae17c65552f33b4413f5ac404a9d3639d0d891ac186eb2ab4d95c3d087278d5d7149992b9c482ec8510749ab60ca83407c059bcb29c81c08db1a76b18716eaa7d60935643371b21e8c213824d227d8752fff1c8e4a7495bdf4fd94cee34337e464ce272164a7f5e885c0b52706c289a7e6f1b89f511747f4300117b0d0436ac3a050d24035c1c8815af3e65fe0eca3cf40dcad00f15d5f2ac176c4a76ed1c19a8ceb6a2b6b58210c288b0b7dcf813d39bd33e9cfa8a263fbdbd8e75008d4d21a1b3d99808664ae7f1e00f49cf6bbd60620209b59456a162cdedeee905b0fdb7bd33dc60867d4721a849dc1478136d039c1883e250d69ec939d084f2bba79bd3072c684c693f5ca1dd5cfb861169e993157cfcc4481beb06b0b4ca69b3f8e1f84e39e72e18428056e2728018c8d8ec0bc2b7cef1f6bc5bb1ccfdfaccf75cf586dface821e71d582c78df1c82802d3832766abb8974ef162cb9ee4d2240c49bba526f7af0a891fd0f9515f78a6c7e1f786de4f088d7e335cf047534186dc7af357b793f070b9b5bcee193d0dd92be427414a537440a596d00ca6ec950c0447c6cbe6b6575ee391a67412a1f5a72f33a822f417ea9b6fea6697848c188c186777989210f1b80fdb0bb6f5146211402e3f0c21db3352936bbec27e716f6d9ad657950a2fbe6fc57f7e1dc5d7449815973ced7f3a7ff1d2c9209073a1c7b679e8d21ee3e62981fd4c0d203bcac84fc60715660854ce1462051c738d871017dff372a9b0c8c07746c58f2a6fd6202b8b2abeba0a5ee6be6f3cf77d8696c440b5e010fc99020d20123222f2559666830565fe3f56eb0d3b9790afa78cc40b9697abc7a413ae3bc7027d0c8df57feed9eafbff05fb7a4673ec4bb850511576288ebe6e4b5c10ab7625c58ee349b61f0eb992d0fd212744631dbd4b9ac6c5cade5c40d05db4cdd9a71b0da7007e0c7595bba9f3d9074c804e659b44240560394a92de042c347944af655fe94d155215f516743d63bc85939a6017ab08ba531f29ffc90ac5e3ffb24f48733bdd71e876588ada1a01f449b197b4c8cba11717bd3baa9dfd74d251052e325b0cc6531f9298f27461f24c87f7cb9c471eb286fe81629244914e1e26cb4517603cd0d419937cbf57879fb210747d596b0fc2add5633611904095b66775a853d8d75238180f26663875ebd4d284dfc52e6c4148a7353b5c369c14934a6fcad26e47179af70d5a58ed87f5dc29a6661d4b2e8d41e515bfe74574eca305a7a15ddf94e67586f66ed7f3e7deac0461eef20f0f32cab35de9947a4800acaa43f4caa715a90adbae980f624051cf643dc4c6198ef0ef0a88434cf7bf447e40249e2d3beb7edf7fe7804df25aa9142f37e12b634701e85fabbc1098dd8580827dfda6f3c6fa340d827ba9082d4e1bba027b9b79109a7236b20ed5fdf62b49be6d3168eee136a295bb3e944512d058016442ac3c1a879fcaa57010e9ff223da2cd55bdadacc56ac49519822b00c059f666c3005c04b54e10db1c76a6f3a8ac40809b7f18af6c184671497f6702362df6faaf18c9e8f1b7a6bc3d54ca10f4325e8e9a16b77bcf888a4f0d7d1a1e6b78d16aafe99d094c33b0bb66c67f9f1c6b94e66773fdaecd24c00166ad3dcdb047f63177b8df210589d36bc368083438f5737486e401ac70c8337949820f3515c1967bcabf587fe69c6f63633aff755f6b92a018ce31fb535aef59946cb392bd689e39e2149e431882d445c87127f2bd617b04b173410294b8684ebddc1f79e4e184d386bb299bcb2fdf7efbf6c797bb117f608f542111b3a8559447d22d626e9affd70ab27eb863c15839d8a7d299703d5cfef7f91eb2ecce59985c1bb85c53c7262f53e4afac5fcac7730b6ade2991c17fd01d1d8e72d4ca487216e03b7864ad6c2c8c35b1306f926e4feddf6c9a77154829016d0b1662e83459c3019a0f02220f54648c7ac656196b772a04db2582266506a8b775d1de3366a6d47053dcd99d27ebf9a2d80981723d12a5cb56034a6d794f7123dde63a2efba26f5be6d820ddc6ed5bde0291e4aeaf2c47a908bdfe6e7272ae30c36e5716ab2f2b106db2963c4c74b11433a2ce987d9a0f7efe0a45deaf2bedd71f211b92e2aa64fc5d44fc44b2920b2395dc925e80bb8112732f5c7ef757d05add8b21ec79f1551d505ecf7039605a962455ef888c0ac919eaf043424bde9cf4c5c6ca383160c3bc0fc52017108ecd45b0dd82efd1d9db7b95b8f264e9778099f3f0c14fb01ee7297a0f50e1e00cb510032990d32b62fb0dc4e64398855673a5e7436c225c223772b6976a98009338e9cd82bcde18b045d63d49a2048b78c160450b7417bccb5c5445c19cb5c13c998086095417e2ceb64f3cc3733ea9c02d6a08324c394ecc51d9041b923c91092ac08e44dd95c4687323abbd40ebd3ca22004e929fe3646d5aaed897289adc179d49a21f974c45ae19480854ada2e669b73420877d4273c12e97c1ccb35a6d4da5421705fb776599054ad5f331318669959c965b9ed22aa5d2387cec6bf6db59bff812261c83cfd480d971917bda80f0c8b72775f36af349b856ac0089f3c71417a08fe16bc5c66171229ffa031a957a8f96449f0205127ac37348f2fba12f08b99aaa5f7bda6e37bcc82e80aec261f2e38ff65de508389ff1cf739590e5113ca02a95fca9c6b3bad3b98fb533237634c22663f29b23d79c672d7a520a55a9ae80b4126053a50060509632ef396f738db5eb9142f4e8e049c44583ae7e6cd04aff51ec17685f9d74879109ca6ac21e353e9d1a8987019737932e38586d8b95a45a68b7439345efaaa8ae2e4f2cf609e17fc61cf034b570e4e63c8bc75e515e51dec8f167db81679a50dc0bb9630e5dc1bb3f094bdb5bdc4268a93e3472982b3495a11bc76ef06aef04680271dedcdc53eb912f076c5cabaf434fad9908db583df940e8c2267c69c2526f87ed5651e7e494746e5de61a8ccd1b98cef5e90c9a260f0ea10d2a2dba12660d4b9dd3b5e31ff475f15fbe20ccedfca44f1f8f95301c17af4454b902dd0e73bc91e5658629d29fe3982c3242b5a2738c32fa4525881f383135c0d8d8c7d1a30705f75096ce6c818673474a2c742814e6abc0e133a0b8bf00fb61615b51a1077f7a2c7a6658ded1e1ab1efd759f6f9f46fd72d55d3a54981511a4a7cf8ceb6eb74c922c993e69e5f8f256064c6a2864752fcb277d16dc19859474c0250ab7a36bb200592dcc7204bf06cf6127a975f5b3809bdb9d662452b8ce5b43d589a42f390ade358cd89627e2e2a36e49cc8f871beb3cebdfb4a45991b3c950f561bb2f41927bea762002715ad9c1e4e4dd6f1241f6ce5ece4836f236b56cafcaae4de49b979b0d879df401c9698f33e4b3f956f5140e2479bb8942c101e2dda3289f840032f5f37d239185217fc01afc5ad85d4fc0f869f0376623c5843ed02494c20660d1d50260277e612bb009ab62d63598164e7ed86e1f4f61b51cdf622a71aa2bbb3ae115a498fa63b8defa86b5e340e66d68219e8ef592a8171345cb1379c590aa86d2d9d3bc26b56e7152187b11b09e5078aebb9954b18e60ec832a75398aa83030f19264ef84ace0af8bd113cea285b08e22f2cd2c224c0b03ecdc","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"cb4dac17dd2d3b658155eb3f63bb6c40"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
