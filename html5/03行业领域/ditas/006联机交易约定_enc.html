<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"cb0465a409787b40cac63b513f343f9a2ecc073ad1bb2864273e7ed7fc364da8ab334c08e5137bb971e212d7b67de56030497076a8264b9223c4339480e3ba97f2db2f8a06e68801469c9657a274835a07737fd3d172bfa1129df5bb4b4b524eec496e8b54700ddf4557147b781d28497a37d22468e9f588b7a7b13222e5306dda470b655b06de7fe41fab7e523282810d873288bc3cddc79ed04c89f996e65f850badf29adaa18a1edb0797c14531fceaff8a458358bd5d70f1af348b66c0e02afa343c3d88013df890b07ad42f2f7c92800a01dea00c9d364374e8c0c06a89beeb5e82ee24ae4c5ab30490e8fa6152487b76012f191fdfc01bc52214ddc594055064270f8e541c788756671ff0cd4531ff010bfba1e3ea73334750f3a7b48c742bc1c5bc5e70d322cf5ad7a61a31bbfa5f0b830e108646244dc445077a12525e993ff1db925da08f0dcc83e31e1e29059f2974175abdcec883181e50d257382105573daa106891bf1622862acdb9446bff1e5b95a52703bfb8f74ecc42c846f73cb3b703f7be5169f3456e817737c31637bc43de9833b641fe1120cc1fba2debb8ab887b9e9c58fd856e13bd1de5f5b2c00a7e71ceb5034f0e71a7052a66cc95fc20106ca91a38dc345924b9f8fffe92df36a9bece24d4a7255353958e75e50b7df7230fa6b4d99e7da9b4bdbef43bd6968e2cc261070031af3907a69f322a270acdf896f606eaf29854de2655984686fa74111b93f928aeb9ad64110033bcb3f1e6519b72f5dec7f150f8d3bb1ad65cb0c8008ef28c88f16b5a531043cd1f47f66b1a096031719d32e6061151c50a1cb254be9341b138612e53c8a75d6a497b5a54fa971ea518a6eaa32a61a0f1eeed17b21b7d1dbc7d7084b4daf9fd0dc923ec038a8e2b11ff1858ce0f2ca4f8e6a33ffbfd8a4ea17b6eff18c5a4edce6ec94b6894d46b996fa9a3fbc63d90825e27ae0c2b86625cb511f996be476bf2b8efcb453b1158f548fd72aea15ec41b9c098a32fd0c1f4b67b5afc178d8e54c4326bd7f2c03e0fdbeffcd475bc5c2d7e1ff975e12fdc201b81748859e247b2e9379aa1b581fa7829802bbcc3b3ac2b1226a117e9e250ebdf1d26f10e04474e2ae3c47c7d7630a68ae4586ac975dd9fcd668fde8fbe2a2ebd0c44f5bdc480bc2f6917342074ccb7a922a4318904e3a41b1ca7354b9da60eee2b9842fcae36fa391aa7abdcf1f5be9f7f2f96313913548c248b68bb9e01ee4659367e6209e5035d794e047fa49552bfcaa728a6d32b6c9cc0597636a5dce96cb0cc14c842b4c18922471c0f0f9f6fcc051be25bb12190aa31b3c8ac416bc448eb30e4dd5888f60824ac4e0a8347bbc06c72711246d1260eafb38baa4802463bb19a0efdf6899e8ef4d8d2ae03565fbf06aa75ec931ed5b4a2741ffa6a635858f55a2729effddfa3d30d5401809b53b262f2da0cbe9b5e51e23c91ad8b4f12bf41f1f4087d8e2254c3dad48bd367a02e088697fe16aacf550f5ddac0534d5b70a44402f1c5c6bfcd0def61df1226799992da7aafac699088eaedfd10881760daf8112986f6765ff6f7a3e67d66221ea4c262a85f8b4561b3437fee8345257ef77aabe9ab3afdc37240b48b1e09f637523909039a19c499c15c76cbd9d6b4c5cdc185539584bfb07df65346d381a5886356ec7648a660697c82b22b2a98593f6a6a1a58ab75ca7f19c47718f5519b93162612cb6cb1dd64665d366a3084c6a2dd982fa902d3fcafcaeec9a02a6c0988647946125dce04d8635703e53c5e49d6185df35f0d77b91bdcb4e45b169df1065c0bc7370d434a3bb13a754b2b1da9ee9874f96c89556357eb58c8f4aa5008652d8b7b066039486c0b7ba7c6079b8b459e3be2d7240241df15e343554c4e46eb649b0b4e1c31aaa6b559a1b6bcc94a0d9fa774cf5567c7ff31a523c6af942c313b408b3aa667aa0b803e93a41a5ff0cfb057dfc1813489d1917e6a656f40aaffdb24c037d031f3c717a6717d6b7491bd3a422c1b5b1bb954a9642f069bb6ca8e716ffcd2c04d1ed88e6ecca46fa415bb77dd51a179e380ba915f7de30e03d8a46a7ce7421ba695846ed95cf6590cf9981e13839246354df3327c82dd009003aa610bd088fa433664945a10513b459334b40b486e10975a84b68ba6fed3b92450e53663691a707e220809c0cd0e3b9c7c0c42cef140231697119bbcbe64d4b77861a8a377e47d268c6f74ece89d9029e15dbe2dde82d0577b7d79af459071ae319ec15eab3bd37497eff0d70124d2fd4568a1bd742ef4b75220d6a501b4b34f24d657a4b690bbfc61c9f83b7946fcf0f1c81958dcc034fc99d9133e000ed55d7b084b7dffeb539d369d8fed3ccb91c833604088c1abb6190903c83de69e179c1123e1eb151148cb2c967a80fca7de5c27714e89578d689122c2dba439641a56e6a8251f337e9104fac5e201dcdf8b3fd264be4f923146c7739b2a3ed7c57dbf65c65e5d3d9e47ddbcf6ae87311eb55f65cfc16309301cd2ea733c626433f3e1c4da7905e658c11aee22a149adff57b3eb1fa87ad718d09bce0986ed131f9ba42c78b1e9369926df0f6ddb4cfdab96736bceeda788a69def96095d44af64e6f7a0ee9abe32326d15b41b6461cea1369534f2fb8dc949c1db450790c5af89ae3099a43ddac90f9991b5231ea5fe55798b17ae2ca3ee36192557aaa5e705bf6d684350981fbf1c446345961fafbe64fa72fc000e017041b5322f2cdbefc92e59afae84d9245085ff4b7f05dfc2a3ce330369f95ae9c6a75c48784725409525c86064383645282728628544b31859f4d7830bee1b42a60215bee1fafc26e82d88fc10067acb585dc7d0de85f99c4085308978c53164c8e82fcb96981ffb08f58ca0939e836b9adc8f5cf2e6a2a96be3d325d2063193478105d38f4b86c03638da5a43459ab75d0187dc8cf8ec3ce50263956a70dd380aca32a81a19e2a5e4405077834d27748f06328da5573c8bca61139ad19b91b68abbb13c090eaccac6168499d162994d25c879cad05996f714fabc8792fc0ad246f9005bba0150fb02af9064b5c9307f4ae284404d9cba270a2af454e057fe81d5203a94060e308bda0dc788333fc12f64ac9b03db0e0d7603f43e6716fb6fbd450762a63d92e970f551b64a247ec5ac2c6ad24da051499a7f38368b387aea832d1f4ed14f4c273f22823b07239165128794d0dbc6e2b37208ed21d44aa42eff5b48aa60cc6047bd05dd867c294609e6c75acdac303d408501418749c3e187b00100d34d5a92989a940a435a3caea30cf467391e549af0ea48e7642d2900b5553c6acdc8a8267694f1cc68987a7df85cfe660dc89b20711daa85a2717923cb64cdeec6299ff5e12f39682747c344be716f486ac6c5d826c5547dcd926e8d531871284a8866b60c9646d0a75b906c63841c56f4efa8690d50667a5ae60ffc3b0812cba45a693f607d3f6e26c3ce52f65c580ec903a0bc24bf284d69cdd4bc4e995716b73b3630cfdbd2d2925680d77012b09e19118390019218bafe789553068317183885d828b1a61c38220cf05e726f977552e21342cf4f2e0f604faeb1e4207ccb371ba2dfaedeef06e6db5cdd140223175fbc3e5ff82ea99960b6d14bffb1445d9ae37130bbe9229b532bbd27988a4c257eea8fc401b07dde2cbf8005ec565e857137992335375a3d5506eeaf080314338826cc1357d552a3af6e8bf0e4a92fe976fd5069478645f884c493af783bc8cbe5b41b50d70d94f767e4615338384d7b596ffa8e4bef3a93897de830be7c9af942362bd340d4343649b2887ddffe6f08cb2d9cf1f3ebd50955c3b8e2336d98edeccca31b1f802aba2cf9856fc99f89b278fd3abd5e072f729e4072bf067b434d27dbc7fba7720f1c91286a1f705b513cfbc1a80dd96f6f52cb86ab33d72173c4c88f58b3e4afc41904f4f61171dc0418ec7c190b067ba45e76363fc3332630bec5e72c2a1d3306e53c5977db372cce1da35fe60931edb1261f9ecd6ea73987a9e24089050367c4bb1e4de0d75bf768f71d6be262adfcd8307bddad48bc0875e6a585d313eb34d7e4f12ea6744ce06a2d01ad7038efda521fe1285c57b13c82855dca68a9082120fe536f06d9c7a44f6d21625575e66acfb5bb51c88ab92475ee0115f22312f809eeb8a4734c2a9a19f1d24a67ef8b68e63a1d53cd1378574fc66ce5ec275e7a3a618653b4fd6615bbb0ef20d64a0dc1c844d894cd7a9ca1211b1920324ca59d94c165c68a2a41624c93c97c31c61eacc2d925921920ce741816cf1f8930b21c4da7be74acb645853c965d9b693e777453bd3222cd173798eb054be127a820ed9e6ff4495074552e8775785f9e679f432d9d2aa627934deaaa4c73a8ef712504822a295f88ff5f7b8842377a19d4816ccdc7d1462ec089a1758e919c8202c12aa5fc836f9666197d8829b8b7cc0fb43dac32355c17e0f306938a1f96f4fafff6e641022378f1772a31be53008a75f387b66005b4780c0cbbe3a6436fd1331ec9b010579be9dc6eee9f64931045e516c08f6ec64e112d63afab7eff2d73976ecc5ecf59b3ad1f84dbb62f9e2b829fbbe5c930077aa1011ab7f73af309399f939bd6128166b715d3829493529085a177efefac4654b3732f890baa5edf33d78247a77998fad0adb269fd65b011ee212da19eaacb9f08be631b7530b0a86fc07a6996769f5410e5d9da9042967046d99fd32a62a7181a98555a4581c710e6dc3ecb5d444b4b445c980ede39612960679b18974e265f38eca7879c085a1fb0a50eabe5ead0b559387042c22ca645407dcced41f5e64e5a585a29e4eb0dbfe07e65f42a47427ba810e8c0b586f007008473f85ffbd0639f0cfe5dc4fdd2984989c346e969598646ae84a74e5e336415be8e824ebbf8c2ab4536fa61912e0b73c042ab845bd0383fc1da580c416537def0a192297451b89fdeb8604357e6e8111444d11b09ef0902dd28355167713f74a769b9fd82b22bdd877ba6abaa76aaa857e8c73ce0c0eeff4a7677f094b7bd4990ccfb1ed3d5e3aa52950d60b533f378a3ed83c0f691270f51f2ef4916dbe5489849d3d997da33a4d2c0695e732a4241ad43925cb2dd9918fbac569d2cdadb1d5aa35989a8d32c1ea673f2192b379f51e5db986acf827d3d1ad9ff2a4f50af5f4e2132d46c051f9b74b01f26d2213035feb00544988a2c3ea20a04b2aae986018af70bbfe3ffc72deaac9b92bee27c8cd58355aadd76d3be454a89906b709dd7c5bfaa48eb2e26d14f819aa757a0bee7a352ee5c7178cd5867003c3afea112d41c9b7243015b302bbdd675c8f43357b4634648da74a67dbe78c3da5b60f8dc7f8273d207eac544fd1ed3f344fd2083f66af1de0d40a1f9364de7833cfc2260ab9f47fa0917cc3bc881f138c9261632f7907c485728914c35af8304b5ede241550aef941aa060f9fb9bc40d144075a0735752d847ee915511d5c68c0ee333eaf7f71dea72d4d764653020a78ce065c1074aee13ed564e6f5a54ba6d94622be129604d4311dfc263b5b0543c65a52a72657c1636c8842887a500d025e694fda9cfad621076a060f17067b1bdc2fed83bdfdd2b600597834bbc68d3cf20766404c69643d61670297230204e4350d027e779c4cdc93e1d495cba08fbccef9cebe5588db38508912ba5914300b1fad1e3734bddb9390017ed5a7bee11516d138207e23ba421b859ef374a5ebec1791431b343ee987d72339054afa433f3bc8c6733f4ad5bc885e2c574815e9d8dd05132286aab86cd3e961933c8417e14549b18866366beeccafe067c8c591bbd91a51fb1c144f782824cd39f087c63799276b7a492c974ead2d26b4f62071abc6da6570373fb53138285424417584a6c7a056275b3d500c30be2dd8f5186aff330ce7a764815e6cc4f8cf1e824e0cb065421266e0a76b51971580ae285e32236473d80f3ffbf1dad640371edd6dcd5f74c3142f94d0b9763fd80e55825c555f80291b27e1f2aa706e04f4f20d306633e5b663588be89b697a7195e50df1f1d8699f531160b52d9383ec7c7261cdade02cb1063b53bfc7dbff7d139364264c29f6250db22d0651d5824d437ef38154c54bb594ecc7da583b7d8c536cb9c3be4bd7b8f4dc6a08cbf95ec05415242483a8bba7874dde0f7702f0864df5dfbf2e1b40a84714a5481f481a905ace2e55e3b7469ee1005c1d78ee2d513f475cecbd084adc3bca3decff9f39194b4ddb7cc9f701ddf09b7bc2790f2378f9db1472826d2cd4cd3a6ec5b5b96f49a388ea5387542680c18a32a00b6a40487f8a978e79ddf7c9137ea9ed1ab99807c2bb665b3eaa4670b01ccba8d7694ba6743bc3e21b1e27cc9d75643fda317777c1e3a10e0902fd79f63502ef6119ccf181256d256b70fcdea608fd0762351ae81b505863ed7ba438e0c317dbec1fb9547455a8ffd9a45a6688ee6b4cc14da3198fad6bff63cbfbd32e5e821e940dbbaf6557abab6f047a404c8ac1706d77eeda1b1365d25a39b867227c041a43ed093ca1047578e48cfe9e2f719011f3b75a06ede423d4a86012f6c313c6c8d5f0ec7ea5daf45525f0104221ce5dc119f4a81fe6e9ad1f4ea77ae7573bed04ad295c8101266a7465f38fa4843aaed7f4b8b47a0af81f942a6179ed591335a7d16e47f31427cebd586b152c7c5f41bb59fabc27f421d274187383a89cef807f097a04c8dbf439d130f95c9ba80dbe6e8011c3ca6c2d5609bd1493d8184fcba18d6bb2c02efc9f45984b1e962fb771ef1277fa0f491e893c5f7c04bf1fbd8f559e25d038d3cecb882c1362da270d7e01f4935dffb6599b083b07110c0f8f127ebfebfe68ac72fd87d631b50924c0edaada0d1460027ce92d60e02d67cdada6110979c7b8c8d5bd49e625215f2cfecbe70d2720fa195ea0c4dedd18476ce8257c641a35f33608f94a8d921840a4fd941dff0ed335a97d594d6d7e6752b5e4a2a2773101674c1dc6627997ed46d7b82e7a461676434ef91b7286b3a76f4885699d9cf98f18494c0baefef9af3a7830d9e1dc2e22ca39d32888e448e268de3f3d22c635b7683ba0da5a0016a4983dfe0c4b82a9e27bdc1f4d2504021f4738013adb4f9506447b745b17a42456ee0892466ed618ba8620e33c1de1616db0061a7e2662321066ad4d2c977577a8bc07eb7221bfc72ff4be7f694ad1c0930297bb6530a19d3610dcbeb83340644ddd7d25dd93b89d786bce3aa62027848f5c2eb38e843e8fddccfff34c391697e981e4b6c0fb2fa307eca0425f1f77f2d6849fb9d0d0a8a956347d9ecd4c078ef2b59c24bc15691da3d2f5ea1256cad413b35ddefee314faea1d8dea3c3ba1cfced0bb688c6cb27607f1ee05257c872e9313ccd9ab4466e3d5dffdc2a3cf3acf4be166f9d72c1f9ee9f009875ac9b1aefbdaaba34fb9e9ade73da88ba7506e9faca2cf4522ad5d47648ab7887c9d9a411affe0fc17d40fe5c23022e9f99d27fd084783f3d26fb2630a7faab6db7baa72f4e6310db4aa83bc4c8ccc5eba2a9ffe77161598829daa0028750333d71337bbc001c8e120c159409f50a9ea55c5ec9c84652fabf2604da163aea3066706c44fe36014c6bea556f4c03cef77fbbdf4c2bbaaa5dace73be4c9deea001f3c77b56eb9a29122f0611f38d6643d731cdef491940bdea6cf2ab7d96c8899106eb8c6f47c61c53bc7f54439b10fd8c439e03f8ae2151b80968ee7dce72a860b3aa2a9e90af684f093500eefad53fe2b8a5db5bf506d899bdd4763062b3b91ab4e98347f292d317c4ac65fc78bc916023497f337734c4a7f4e251b585495af43c31eef4e49177fb909f598d66db31361317e1a7e301878dceb66e7a42d174bef62fed6a137dd5f672b6678f2a58ea41e707ab377aa371ec6538a128ba328098ad9533283eafa5cb6f335ebb5e4c3728d34a16e0f4896572fab0d8ee67f5ca4ac86648a924c1ab6975ee95781b887572ebcaad1d370f237d195ee04ddc877fc3b4a38cf3233b11742e24c23188b02aed8eaf5e0eed39d5c115e9b9c286f5e8d4606f8d88baaa0f0e2a424a964cd323f7715ffa6e8f614e9b8d05786075dfeee269110452cf68ed1a09689b08baf8403ebba6b537322f6a357205b174db10db9132cfbbd09f65bbbffc6a1b751b7838ae9bc866f009eb68346659edf02b0679aa084160892a9d1ea624eb1631e2d01ace2a361593dc9b592d8c51894c6236a1f1f0770924fec1b83b979744aefe1bcbf81165f8970c53250dcb8736bd201129803bc457fe34e80fb9506c7a26ca1e6d5b612e8de946b3a6f754d19140f952f3215a10aee7c39f10f852780d7189a6debebffe7a2d30ba620d54473cee0fe4e416581a52ed355ac2b184b25cde24a84d81a58083ffa4b9c87eaaf247d89d8d5ad87c4d47cb7047cc61ba10133a3f3eef1de919027b6cdaea5b19c13aa3db6569e4d479920deecdb6117172a34f57ce01ce1a77bad9cf5d99a4b9323eedc3698ef4a8717faad4154b10615ecc1f87170be1dfb1f71733c5b9ddf9968beff65b3921b2c1849c27fc314a725f319e1c0a2d0ab7545ed191213f675e3a7f927be1e5eeaf9d13e24c1d7163f01f50f641a624df5607cd6088d4bf530bbed11c37ad4298d0354edb18d9a60b08a4059679d122510f860cdeb8fd0b4bbbd0cd175b7ddb79771fdf7374f8c3777d0054b9adc88e8538b16d52f19f380eb372bc896f143216e63871d41368f9cd9db14972313fdeb148ccd7eeeacb669de7d30b4524a419c72611bc9cee0c892e17ef551e5545c1fb6f1049c523faf484137452cce0b8c6f96a5e3bfc5bd4611903b650941a7e6dd2dc784a37d2bb2a966024dca0b5144c2091b059b8d2fbb3c4569d93f093a4bb850200c8ee53ebe829d378513b5ca747e631362af01e6b31d928360d6c3f7ac25a8963793ffc13cc11d8da31ba8d818d0b7054a2fa0626de00d28424fb6252804163a2157903f20e1778c783137e265d5123124acd965fd677d4ac4daf8da654d766c37d13d7691c89f2c0e287a3cb01dba9c740cf9c33f5772c98de404c7827bab7b3bceaa23e0f292dcba00299a536ffbf8a609635318b80eba68de84c21cfc68578429feadd9394704b96241a815844d745c6aebdc6901d5c2d05c069ce3241c4a7cbea4436d4d2e86a493cb9e6d934caa634e22c0c54f7fbcc922cc680fffc5e9fdbcef366443ea43a223b3e08414e237cdc9b74d50272151a22a5a76b626135a59f03aff15e7ff6fcbf09ac6db4e1b221c60c78ffcb01cced215140d96a67486991807ce159a506f03e2350e6e9792e4ed58a898c800b68c737870a070df515960274b698646cff73d66bd98e4b507632fc6842cffabcbd4e719353b96ce95d674bd7e9619b4b922f5696859ac6802a2f5fd42435cf045eb4821758889c2c16993f84d15498e2092bc2e6bb74a203509c0ca642265b396101430748ec82d4dc1c3242504c37a5175d3958b343f8e21f3f5e01bd3f51fc16c8663be9ebf81911c53c0f3312853c9272f06b9aee4c3dad24a5ab3c28b3a7f47a25979790a0734db04df3255d44aa2c0ce5c8ba6cd97ac94c032d4205a9a05784cd7195ef87eaf9ee52eb7e285209f485c222d01b8a08ec633e5886e8afba56cca51ae0b5644b83014d8ee79e478d5e30a2378104e9c192e9ba7f556775d938caaf33f949a1d4f68ed3eb021086fb10b3f67e3db608a2aa0fe13b25c97a0e8bfeb2f68c03b8001e4374587387c5f8e7d2dea83f88bb916d1d55b8efa9c1ef2351797c02fd60ad33dcb66f7f0630b96e48b703bdefc2a239360c7c5b91658ecfdd267d6103fe951401902438f8980174ff05abbfb8fc9b5e0649ed74f2ef24b8ab385be1f5b92f538f79d329d36a866046521e7cbf628689aea86e6f9019dbf79fb9489e775e7239190dee18a0f6975d9b502fd94b62e946c0470d8585491499d9d02306efe49358c379c19f1071280112942c0fd6593d2c0fe4f15c8c42ea866cf0ab8648a352ec0d5f1130e3805e75c8dafed020d8a3370e218abc618211f33bf2f221ca15057dd69888751204de1e5374822f8c4b745cd1f712fe7d27cd4d72994f1c754d79d96690e100228d3cd2201e05f93f088b6776078a6aaa218a17b6f4b40f5c4cf4bde9fde2d4c5f658e57421e4410bb735659049aecc5168a8e2a1430409a25051d5e65c3d51a0648bea1a1ebcc13671d1a6bdc03eb1e08dc80d8dde890d58f50b842803b4193bf870a544b4578a06a3beb68f44f31019731133a5c32316824ab6682729daed2c7210795389b1b92aedfe461a1e11e829f95cd737ce6a0ad85802291ceda18906f96034ecc37f4a03151a7c2f1e2a641d5bb5cce9c1b05b8a92024f561b331b198081e0052b8c1c1d6d6136072092f6384e51ae5cd8231e0c57f73540cb5f4e50b2aaa88673ad3f6faed84994ebab67a57cf3562552f8d4c9df8665ae73650e2fa63ad5b570891617b8433301f44eadf7b12c46242ad619f115f8b68acc8fa01fa73bc29a4b3499343dad011eedf2fdceff4ea547749618c811ae997ba035010bd72723389e7d6a7ef6b66d7cf22c52105d23b1e28bb6a35da9038d72461117b8168ab1e5949e8b78332315acaf042558e083798309ba0e943eb220cef0881ea69758399bb8ae7c286805890414b9e519fe88ea9947559e7a9ec0a9375a4245fcfce2d8dc374b2401ec94c28c5bbd7b055c5d494561b8f434331106d64a265fe14d551e77582c9a03758fa9a201dc2d7d7039a3cd833b48d92803923dbfd25afc2b4dab1c18f4fc246efa1f58dc94cc8015340323f7ef401fbb2c0ca4d31d1065f3703dd20a00c950be8113c195dd5eca9a5b6a1a6815d3970fc9694ac674deadda92b8ca5015fcee2351495aaa9d4c973a58629d0190da6e5e706f7ea389db62741553471a9366f92fad9b29b098a684088cf2f349566ed9e34af829a730bc2de60a7ce4b804d57695300453925e06d510b18bd47ea245bf32ddd702a35b0877071c47e2b83feb02af1e5ddd38024f364eccf8095e244a557fd29c7de38ab30384fdd4b14ecb18985d4b6e3fa42b3a583738158150a5230b1ecb52f82e954ace264a4f5ac956a7fcf929f03caa70886db31b5e4d116cbd997585aba3a155248005f084b2fa06c3a79485834cc747aaa688cf9f5e8e907f55e69fb05b679211ab5e8274eba65da8659a1e0cff6c9b5e5b04e61fe54ff2a78d8daea8da57a53afdf54d0b128f55ef91ccb4942ebc8363cc30912c3cf070815d83144185fa1bd9060a298242989e97911d0057121092aea5eccf09851e4dccb2b08d3fdd8266627e4a3c7cb13bad31f60aa5affab465b2054af2c71ddc90fb88393b36e5accaea3665ca73498046334d25ae58536f3572a7375c44348178a63988b8feb491c06bd9aaa6f1ef954c6b08c1ff393f0eb6040e062e6550b43d16ff21a4b39d3f448fdb8d5e0725edc28e744ca6431c8e4b0e802bcd638a68d0f328516a40f56360a4085d37034cfc0d454ce71985c2229873ac6d1eabb1645a184a71ac899f93ecb85a6b8429f5ad04aca53ed33b3eaa5016304adcc78aa008056e454273b554b4287c98961393067f8bcab79e9948f8382a02b56937fdddd6a1c3ad454500b2e90b079dc950ce549bab6d77dce13f7923b0876267ae91c94cd1e2c31ea50d8ad5a98b70d51f47e523bbf33f3541afbebda131cc063fdc17b05de5e4488fb6f3bccc7a6006abcdee58daec03b2dad7584dc11655eff97da436e4a8172e9c525ec22d2f7816fae4bcab8bfc484ed7bc4f1179cd90376d3ea8d9f2bb6d2f4570d660ab20ce27f8fc3d393e867b0c0216dbdf6211b0972005f5965bed95f137000b234b899d7b0cf876d5de99abda0267eab4ff4dbd3f0eb8e0aafb996aa1b8f818d9f97b99b5ddb2bc6b2cf225913566f709d25765cbf287dce145e72d8467a2378cf30a7189464952338499e41abe1d6b63138c071f1df215b5b335ea0553c7b76c34f9481a1eb5d0c71317842d78bffa53eb13fce081f91d7a9976e41513178d2df9a4f23b78f24a8904ee8a7abbb4f30470289fdeaf009de11171e458c72bb40ff03279f90b80d890eb4ca44c45d71dda840647803c25c7251fbb6f8d80f201cd50946c19363edb9a699ef43061c4b511383f67cb80eee693aa9122acbc991e0beb75bc7f866931fbf5731406e92e0d759443d2a39bf23a29a9c5e65f3a80c80d2c28f8c2e153a768a8bb3c5ece111689da318026b8ee409c21c4307fdc93cf0d1a217516a1d91653e9c274bd937a0eb2be457a308d2b8320d40d667a6ece0de74cd4bd96fa157cec3db8dc700c2e39da957c0257eac68083a0e4f6d9944eab21a0de588016a091cf87a45d2f8d51cb880e07fcc78c31741146542b1509bf965b7da07d44349b2cc8d06d626ed417aa510c47dfc059b180e28de024164d087f74a07a0d347a20d2bff0f41057fa884cb668a98eefb25f36562ccf41e331aea181cd049184b1ead31e205d61dca102af9b8fab8cef3cf44721299906f689ca94ae5fdac90729d08db324e56cb3b6086047bd76f984f9a07b7c9aefcb62faa88506088bd708f437ee89504b69c830053118c323214cf90992ab143cda451fb62cebdedc36f42412f208950369a8347c3eff86ef9d071dc3a04578606788df8514163e16504e740b030144c6549235769d030e09239f4e2557442415b6193c34b42b7c463bd3fce78bb0f2e6cd342a4bc7d98278eb5323f61eea006f2d20381d8aaec6eb117765f6c6526a5828e11043abd17f38a942149d543dff3fd632c0f2b050cbc6cce63e37a405556a3933ff6967363cd4055304a851efe5995682f772d6ab4f15c8df4e9511f75a779c4fb880398c0486e446b7c5c2daecd570eb2b4c5cbdc0d4a3938bbfc14f1059757890d9ef8262ce16bb626ff5434216dbcdd9c3e79ace46fc316aa3fced28c396e82d99c9e805e1df01f2c7de729568bad6762c9290c416284401ccb5f25a320b4a2431c53007f032056f7f5e494ef3b5d706173741aaa30cd0435e7400c681ad7b27df9f9022ac85bf170889910d1f056536ace42588f52b62c81b3ef42793bf031927e8afd42fcb7ef822d13440f3c332d00378a8784de4ee0c940acdb56609a940ef85eacc5f4dbaf31c597e0a9d8fe88116d935a8fba5170532a37f3f1d9240631b4a9baaa6c053e0422b9062312dcfea6748ec7fd4d36416ecdb54e48823699b3723c59809d010a6f89e61971ff9a980f877db2f203cd850543610d8dce61f1ad9a521a8e2f877fc3ca0153840adb178d50e182cc814a80b7d82d85685a10ca11760f2b4c3e847bf38760c42367a6750316b88d88ee44f8e594ff77ecd9390494b35cbe0dbc82a5e2bc657abb77abc6102d25d2ae9469b2b7d1df3e6102729e8db8e2c189e1486d4c3568976bc4c2afcfd5b4f51e4f34e52f035870f3a7da15126e12280dd2fb8a3891a270f828c1b1de7b1b191a47391a5ccb3b5632ee1571ae68d049bc4c3cc8e4b714feef4821a5261686fa174d535d065492789961ffac25ee52dcb9f3115d15369f9fe784503a60310652899a92f1e438c1fd91771f3b7c584e67034194f6e154267d8cd1558a8030dfe27cc017fa613331dc726d2ce4e91c2247679b2ff9c7a63d58b6aab6a503f2206b55b37f71d41b2c4ec14be59daca8c88c228620b33662c07c35b9f5e6a9944aa8d91c9a6d1b81ccceec9a3e509701addfed3bd7dec181574c7319d5408a785395493e55b0c968dbba627bc2c9b929d7092d23faeaeca1108331cd9c1b4cd545b7464e0a713fa9d84f8e1bb3bb681f23d121c4f2238c5328d3e08423d3b0418a3d723d106cb2959618be63b8391302dc95cab245ca6e63058c7cd4a53e762c11a5fd7e541412a826e46d7961adc2cb2d56b4f56050d19ad4148d9101ddc0e7e13db932a86ffa4b2e52c08614e408fe3bcbf99efab2e91c6dcc7f511709e3a118f91b04d4deaec233fb394ad3ca84362999510868aacbcf62ab878d3b626b435d435d14bed038300c709a4370239a89bd020bd725f5a0176a47ab92b90e51b4ff50ce2fb0264fedec6a63882edeecbaf952adbfacfd836e1d7af2d66c9bc201f41aec30843591645b1ca8dc070861e8b6cbba362d2dfaf716eb989319367ca968608f518bf19ea7e6a78b9bc281a8babe5497b5c33745fe3ee36fde0b587e08f088442b7057e836f7e1050d1c3b95d872b64c87fd39ed8c51b8402524375906b1c6fb877a54c1435dc2ebba57029f69816aff074ede95f420eb7c23142c7c7eeb4a5092567beca018540d6b225e215e24a0212971a874d245d71e45e026672f1a2323b36421dac4c515a7b35dd8ea6ecd6b57b3b11fb8b4750038180086aa04510cbb2cdeae943014ae67db7a444a8114fa68622cbf78ecdb307d8adc222ed4e9f6b8dd98be187c28395a17e46ec770b9f253105b3329458397844d0e60230bbcf849285547433cbb9eeaafa9c747af6b155efd63764a894a526f7600b910069bbbbf67c3a68396307847be4735e4fac4443b85c265723bb153090bc16d35b76005bf8e56df92231f67eb8b74ac4de65591ff7ec543d9a29a744665979cd9d2498d7fbd09411f6adb4f560c387d7b18f7c3c651593da21c9faeaac1ceed3dacf9cdc77c2e1c7d2030b54f7b27f3c471fc66fe3a3d05f159f4e088da05605cbfcdb309cdb4ea6754a4ca245952af7985122b7706fe1f87d4ec588fb361b4c46ad8d1a058c7450aacec44c0d2a6be1be1f6e559c4bb7ce3f235202cc593df97080aabb71339cb22a3dc4bc1e140e3e69d0f6ad40beed87c1cc48dbf22493a4c7841834c1c5fc283ea367c582862bc45d5484c7bc4d5b25e6d92bfb1f9306e9294d394965155e742215c78977bde2cabfa8b27bc8ddea0bedb912912266e5c4216bc4e00b655496336791528b682e3cb6b2bc38cebe8cada85a67a9706436a4eacb79ee09ada7a9a3c15f860154fc5065128b19a942b37dce7be76304eab66143ea94b9b78d92a02df7d713511b85da4cce951421bbb827866bdbf42f4d610a82d457ebc9a6b93b3c5f44fd8761552271bc674fe4c2baca1ee39cbad91051d57b9f4ac991ac90e6c178940b928c8c00ba5c65fb2be59f15404d2c748f842f2d66fa0043cde5f3b189692cb03b345df1cb93f7c3810ec3bb4c5fd08737a54693db456fdacd4f4aea92d038f802a65b72d50ebab9ff70b3b66d3f8362fffa636b22326ed9ba9ea831deaa9288811ab96a515f84c99abed3c1bd6cbda01174514843539060948099cd0f74a77ba7425465d15e2490ee1262360f103c039dda1ccc582ebafbee341a69d153b5cd3312c440f5a28ea6ddfd3e5bc351c9c4616682651149c71d954652186e9ae1a0cf50ca8498ffeabe0af050d7f43710bfbfe5caa28b6b8db1bed1e320ef302c646959ab310f6bec248a9324ffa393ebd254c34f9e9309ddf4d48818377079d1f13c17daf0991b0867f71aa442ea4da801dbf5927a472f7d66e2fde7351d513e0cb9dd9468880771a74501f385cf409b8b3d9fa542d02bb42c198f1ea284e363f15999e7d91a53bcc8b45c61bd476746a947fd22b29f1fd989e8ffb0cd27b22de29c32ef1e07b1869734a013fe0e013547d054404bdba418950c571014fb8b20e749009d3b1d41bf2eb7827432dba95b7fc2fd3427c072e44b4fdd846ea115d8704848cab2a706c360aae8c776e9966ab66bc9e0555db44648db19ab8ec74d3ff0a6552967eb4cb531c05f170184fafd22557d0866a091f5c4ca74c909a72fabd1f04840e46330c7f93b0cc7db2d00dcafe3e3fcc9f9bc4317c9b4f010ff55dd86ef460e5a52e1ef9f0998d7f291efb4d62520b8fcffea53b28c2f73a5d69c36f391d3178deb7d869046c64c27b7e118007926a9033a3850ad61ea6e0f1df93c1b47fcf6c9c940ad70470e0513ca978a254385cd751be9ef3c3446b3d8144ac665baea8590aea3362c86dcb4d59c9f62fb7d5f04a6fed393f8b9c4cc376f56764e0367c20ebb140715e365e8fa9bfecdc79cf2632e5f7a0ed496fbcb6c5a556a74bfb80961e7f0aa030301d2f122b59f5543bb0159e4c29e059b9b098831215b6d6e14271986432a1cdf9060f8d1ec59accb59f753f30c37016834b245fc0ba03f61d3091f79616ce0b4e96429b1b08bd905933a8b818fd60a62bd143e4a321ef7edd5a0583c9247334bcd5c581d4318d1f42b1bdc567f6d0ca726a1d422c5fde3e5723c1ab582f19a232d645e96deaa66a64042bfeb5498a963f93fff6647cf870daa7b7ffdad3ff3440bc6817069e391b77dcb41ce09cf4aafdf95974f6d424f110242c30af8b4df7a7350a6654b8bac189390b6750df5828a741975536a7b39783e9bbcd879ae7a4ce036982beef451be52f27f18d0d7f3d74673c7732cdb140f99dec428f52a32dabe4ce4e9eaf9e45d1a44d2c651fdd3de3a0d11d6ec85c4c1f3a4f30d366abc883c12a947a494e03942f6d0bb56c76652afd8e23de64cb058b11de0d0f45607dccbae7ca77740472d0d344e06227e2bc6d8818e297eb1d12f10293325b4215e620ec82140fb","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"cb4dac17dd2d3b658155eb3f63bb6c40"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
