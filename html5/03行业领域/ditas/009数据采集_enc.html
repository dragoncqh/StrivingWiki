<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"9be16e2e0f2d28d5ecca2153cc779575a5c1e34b159716b3058ef0312b1fde0caa79880cb16054205c500982f1d67795834796ca3da409e23784a8f29619ba89e5087cc09f745fa19b7eab33a1418ea8dcdf1530fea5f8c0747d13f67b268f3d9f401252c452d9263fd7248ad4d9ceb28ba161e9513d0a4aff8f950c13ac7047bb5cf7fb8a396bec0d7f984fa35b888429a431fc075034c3f0bebc9c06d8b7e7959e882fd9452c1aeb5a52c84d414d916f0e9c67f506dfececb0bbd7d92237f48085b7a983e4b5f599467d94c053c20d6b44ebe6e93793460886b93939c0d82ccf396918735deb0204c85ec61d52f02fe603b6a3e80b2fe59c37045df254d04613da31527aff0aa6a335bb3dd9ae534ffc76df747dbc3a56a5b1d2e7cd6ae3af599e3ab098e37cf73e7d498352c1a2ece8b779e05e6f51603115869440f58afdc85704ca3bd71eaffd86494ff1479daeef6397877f0622cf1ca4cc74b58fca1402d274aae12af47ae35338867524923fa4089da1da7fd748a08341abda5d017e996dd075cd8d5c92029ea2b3d1b2c75398896575ba6e83d34172c69794d9c7b0d1c90a7c154bcaa47df4ba15e37acf3b192a48efee0bc3db9baceb41a18d942762c0333c8e9d78ea439413237655ecd21935eded77833255c4af054a421a3ccca6baa96679cd3349b6aa9d795d38a229c8c5e33dd10e8e2cb0b44238b11477b1b281ddec032b1d7f07db4decad7fcec6ab53572d4fcae18f82275dedf80d8af8dd69123a8476d175f19a022e228037d14dfabe5f8055ce1b211bff4653b79b80f6eb43245bc6f598f328f1db0bef296f5493fb8712e4531898036e1f7664d8ff0aa5fdb0a2f47626b66750f19a8240b55f64c95f85a08b5c4e61197bd533c50f8f784aaff1bd694c3956a8636a07faef43540f130306e61115405385d69183804dd657a906c4838b414d52fd3339cd8c80664c8c434894ee518b50e737c41debae8f8df36e5d9251c31a14ab8bb017e88db7d1c551eb54299b75e2a6e7e760d22bda12169cceaa218d23ced71924970d522e28f0e6fdca695360b05a8758d18ff21fce433235b85e7cb99988674edb8e2cb6662a759788b88b0416e0853ab38bc45be0da52ac8654504a9478273f3fed76cf16591200f3a2bc6d805d97e934711c7b63692a4582f43abd27fd57cf70f63aac582aff69b74f0c783d6abdb9734806cae5604772136cf1d07cb1cb754c87d38c264043e950a7c2314f1dbd95c0281c5b4c0adf9fdd88ba9fa4ae18d480da24b7479aa7001aa5cd1e12c902aeac25241a45db21894dd4351fc57eb402ba60ddeb1129a940a6b676e07dd3dd75816909b47c16a4955881ac4fa5e05266bfad1c1aee2284757388cea47e41e1383d56c1989f7b8fe777ab5fed881b569c9d5c5de491e6620c48c8f8c9663c78dec3bdea328c194a325e43029828e305adf533cb92361f370df3569fb8b0583079181e787b68735210f880dbf092f2cff74258cbce43e76913b8d80f20f76c8d241d79ccba1bfa455d1b845fa60fd4bc86576568b53ae9a73815085b5447b7c927288ca095dcaf031dc03845cd46bf3d6d86caa69de4c0b0ded2948dff8804b5153366d3e1bb0d410a50cdd46578b9abfe4924a2d778c510d62f2ad148572468bada82745d695aeb536d2c6673704cc8591dfe2cd7993837add0daed8054193f39a9fa0412f488598f8ec9e72dc5779fb222c50937a1afcf8143e9b2797b128c9d54df7a8d7663e780b838f7733f74dd8de928c3e278115ece87fc372867e38c574624fdf9969b01e0bd9cdf3540157347648d97d42d7f34943de3f462b9a6f1857523a5d66e2e03f0beef6e0e481d994a9e2e8967f73ae24b02f1738a5ed3262bc3c3af30accfa5cf2c12bce6d22eb313d60697c63297ea6ed73766c803db07a6f7b812090ea740291e040a790ad08d32cd3b216e5ea0c8aa9105ee74ad48e9a2293b19682e36a9d442dc23c6df529324389de94e9eb8aa43256712bc7e381b55d13262f01206a060312bd4fe53ab1348a346b04d641b87f267dedf276a4c625f9506b2475bb65d25bb24cdc80692c50e36516c25173b78eb884ae3ac72448dd2e9aac168b43e7af364d460b81b8f3e38eb66037acfb5099cb96b18f8483e73b13e0f007b5a3aea922e46a698c758000c5dc52e0914853cb9609dad1efc32dbf57aecabc04d1ec01c29e110b468f7af34afaf0ca9d0ead66bbbf95256ca24c83b51f55f8775869cb5f9cffed4093438728232a4c8a349febe29dcb0570a42132eb5fbcfe2e6206c59c88b33294cd0f721a041785936f1f8797efe3c93337c75cc832de069704acf910e80e414ba813ea437a9a73c6e731582d266699640233b3c3ae731c248a7055029d76f95a3509997ea339ef1aab661de868e32e8a18faf66f535207bf203b939270c654625c8220ffab6cf06ea4c0f0183c57a4e94873a8752c7f8d3eddf230beb43f09bda368d38642f96709ad9ebf161d35f9d57e59782a105ba05342025eabfad401538f606be4b3abc01708843831d397b91397f19ca151ab12eae8ec3fd5c6a1ff0e641633ddc71205e3cc85c47792a8feb13f880f59c9b9b6153542dd253642e88bc4912e6fac62ce455572496788c612eea7bc0ef00e090bf334bf8548c404047cdec8853a406bd0fc95f04a35edf020232aa597d1700105fa4a0c66b387a8da50a81ad5ae4f17871846f5ad12385aa0291a6511a0277cb4389698f2050bed025e45eed6baa4ef4a21e23bd342f3cb05cdfe6edf43d612fe74c864d7f0cea6cae6428f4a23dce0aaf9ec795cd6a5e5eade6f43fc918918c7621e24561f38a8f65a0f96e66b3d6c08b80bceefaecd33e78d36eb512dbe8130f9c7392c61f671afd8764b43826663675d0eaf26e6fddd76985c41eadb331065dce65f235e641f51bb141e8833bf12c19b8fd48ceae4521f40a318fc741d9f846c6d1037956cdd50e6640d92e70bfc8131ddf09d28e57e8bd111288fc98a07fe2809133ade100df934edadfb8c8d4714a44ffffde6ec2116e2a99edb0f359c3dc202c68383bd95be5982b6e9e361a0e9dc34e947fa29bd8a32872f90d4c5f798aecfce858069f17522b97d1d1122ffa15f9967e410d0f46160ce78968a8e3622f58b133750fabe5a28ec37c86e998965a0cf4fe475a0b7f40cd7a744104c865695fd5d4e89f8e035f88435dbfcd2fe2854bcb9da4edbf62d2f671fb8882d039f460290b6ddd2bb3c94a5e1f6f5475e00748b4fd75af4ff13e95e54f3e4606bf6c48939828468d80dfa64acc5c8366b29427e3598faf2e8e7e2b61302d9f3f343037fc86744e559c0d6810352b60e9cab52225e55644eaf6b8aac1fb6c655cdfd0baf1a5106e7dbe438b172ca93203062d45cb989bc17000105ab7ef98a07984d94ae352e9b24aa9a8a79a989953ea65ddb91c00654555386feed54ba64411a51a31fd28d049aba25aee1684af8db764e68d3f2e427b167b3ec87accde60ec158154e63789383700da4d62ee1e5347861359eeec6554947351943b2f38b29023f5a483175b5a51f7a58951cae93cb864c7772a75f39581bae986d20660af77a119d1f2f87b88c18a214de13dae19e96426e25be42a27e35bad1c599c934177fc8d4fd70ac8ca18c41b0dcdfe56c22c029d72b33959e1994dc4168d1c8d7229867f4d053b52453c41b8e87217320d7740ee16131c16c56bb882ed9dd023a09b5e3959830942f89914ec895ff09b70f9957a8bcc9e7cca23a86558574ec89e9647482768b516ae0167439dc272f12e5cbaddd0c9acf2e0cd0bb1d828dcb7da641064b6e2ec1ab99666ad4ad61b2e7132395ca9616c3388691646028b02973459c1165c6c83336cdcfa15f937bc8db0213a71ec20716cb880daeee345c2b951d7996c2eb9592a5afb645088b0347e26804d758d337275d85a89da8f5739cebf823205157883e2a1bc49b9732150f511930c76efada938224abbd7be10056e54da9a55bea370c8b21a37e30eaa808576fcd17abba19c5400a47fd7563e6057e4d9b28d75191e0f6fada7865876ca167c42145ff74fb5a139a75eed14800074614fbb15f1d1573e35f1ef06dffd1e848e2ff7d77b37af14663a712982ceabb7e8626b41a766a4a72c8518283d8294c62f1884d051facd5ec55b7b54aede3d9a19343d0de7ce3027c32924e7492ba7c713671a34f2eb0478b845c345d76d2263e4440c5b6bc3a74ab4c31f6d8eff43ea19692f7d281cf7791b1f8927d8ee01760ec233980d9fabc1c3e64039885da1857c38bef1a9692ba21404d695392d93a38835208861e529bec80920f93050af31b6cff176d30a90da22b24b52c9133d466c6db83716fd5f7f703bd80abbde7e32d129af395d0f5ceccd1b7e7adc40c139195170bde0a612021ea9522579e02be2b91c9439c82c0c174c36e0e95d0a08d8512d306ee30fbe001fa7aded08620f0a2172607cfd62302c51f15c5fcf2bab65b73fb5c24b2eea8232a1ecf9a1a1d3140116635da41dfab5b9db15e7731b836012b1a5e4af8cf72beee1e59c24e1ba0824d7b15a1ed11add22138482e6742ea34bd86ad777abb52a565628e28521641f5dfc3a25d87705d3b51d11adef1cbb6cefd22fe53ee6e7b16c4264cb0b1e1878403a3a978c5bf633724f3ef3c9229849b520ac14c7045e27fc040f83072effd2de6f1aea2cedb101480a642dc9047b79755bda64fa29cfada7ad62f0c1aced4a40036266edf91bb4a2ee9ab5f4398f6ffeef517c226d15595cfe1fd290076580ed13612abd0a7d78b9b47037d5078d6ddf3df6c2b96ec6a8752042241c54e91068adaca76368a7dafabddd13c6725d1e8cdf20dd29b96c462c7f009ed4c8fb60d53c665a431f1327329c6238797a464e250bb8e221f3d1d679a0d7a2000c4a4831439d622c7e1a685abd8fc9389512960bed2f6712586c131fa4d53b28c47d8f7a4f7337224816e60df2ec9f0864dcb8aafe6f36966ce815c35e6327f8228b47b00b778aefcda16eb30196a5e725d7184f8dde514a436e33156691c20e79e5ef28e0789639517da98026c6400ab8a29cb44d6c60288626f6f68a96e6bc57b30859b5191be18e13f8863ec564150874b271d2fd86282bd66eb02c1ccc8ccc1bac35bc46cf1ace068462e89afa7c3b154294b29121367788898d26afb5bc1a9357381fa256beea521c9b607398035f29425ed6aa2308eff0c9747d2a51c83624b0876cdb510c8987b90ef141a7e40cc4a9785018562c480c07ae0cfe17011a164b0520491fc5c608ca4ceb164325842cd564d015f00b9b3564316c6b1e786bc595342dca9f8af4eeaaa68f307cb5cd08cc8cc27904ecd4f5e53aa4c12ba71c6ba8550ae511a2c382d29ee1a447ea40c25e6a0f30f4a858794ec96e8c99c87f2863d73fb43f42af4846134b6ca8d5e785fd7aa1af8c61d85780723079933d8ed67d18fddfca2b3e2366a41500a864e5bf45297cd9c145e21d0e1b136109b3d96ce1289b8528cda4a1ed99321e40b0bc4faca5e79d52e0b5534893259d2362aa8371872cdc4074c2254f4dbf66966825045af55f193f7d135501e80050f1f83c7e62e045bd3c1bb23c7b446fc7b620986344640e5c3f8de8b4a9593f891c01c5b5633feb1845269d2cb6a53a2681424bf44ed363fbdb4a440ae5cd27c926331cd5e941fa70fcbe7baeb733a1fe98ec3541e8905cbb0352d1e39f44cc9745bea9180ec2daa89312164c2360ed06ef044b2cd444dc5a57a25d97a80baf4f71a059905fc43e805de0512ae3cbcd889c9304196bb4d25c36c05dfa3ebee338fe14a35261f96c01c2739ef53e47964a5825e08d4b6f88b9d37b5b8046a6d34528969df2f48d25ad3a3b81b64c360f902c65c5e1bee36d8b6679d38f321c624b2b751529de05eab786f07da348349fa3d43553f88b832aa80446f2509151e4a8aab570a973c072493255ae00ecd0923980113def5e03a847f781e3e39818258cef909ac7f982db259dd61b29a831d23608544eb722357c123f30c0c11257339450bee93c7b91a162052cd4a95d7cee39068621e32b6110f13740ac1e7d94e5a2c4d861f435b8acf180d8eec7ad2a2baec2c10bbc8ebcb1c6640725bc375de82a81d5ab1c3b21450e34b46cdb17db1fba74808f57e49b14db5986cdfb2ef21180bea372384b9dbf79e6b8791e8b6037e2be9fd83f39a8083428f8fb50a710cb6aff0efb0a12c69fa927f88f5d1d1c452aaa0a1f80fc688560b1c198f27e938c4507f08025564cb184974093f88638428d7293918727c3306011e99ad7b5192a87104531315433a23f35c8efa63e3a4f78e938a399fe2c99e173ab09425fc0c2cb31a5a0b9b8de3cbc8ad1d75d9bc2d4da8664260aab33bc9f66a24e431a9cdbf1b761300fb1669c2e62c135afbdfe30a7c8c858181a9e28651fb6134fe1cc063a0c604dd85efe94f2381bfc12f2c478a958d8af85e04ac610738c9b30a0b22c70ffbfc7e2d5b54d6279f7975869c5875dad1589c8fe7da98deb10c2479bc5f161c7b5e70728f901aa803fa7a1e07b4c9411b84c32abc464b54199b542fc7c1346e131bfc24d1d9ebe3dc49be113c26bd9c6a01dd6b9a37af221d3a6d6c4d425887dc3d90450a8a1dbb96f312bb4adec0ea4c60cc57b58d93e706cf90e04e1604bfd2571ce689bac7476be12a4ce24961e106b4920be99b78005493fb1b9cd1538fcb83f6c7e5e1b90c3a9fc05ae84fadfe72e6c71cf98a060702fb4d564ee9f5b671ee9e3210b4d8470d7ffae8e94b44e327004652f178f6360933c58bb8cd8f4906ca8c3b9ecff3fe1866e123ca83094702a6c572c0db43c18bbe2d6877b6cf2273c2a365979317a9ad4d42701bc4783d03759949d9768b387d52a58fab2cc609ad6cc046f617aa6234838be602f92b682fb88427edd4ce0bca5242642d527d46c5900d6ea0332a6dcd1f363380f2ea5a4c5c1a87e318ac400a89f8c86e707c276aa7c3fa8ddb532b588c3e0e6d1cb3daa20baaddf3a07bbb0f1eafd7c1615985fd6a67ca422ee2a0d76f5980e8d9a07751f069d9b71437cf0063d43be5aea68eb902d1537189f0fffe3099f618672144aab7e1550cdc8e5c7447a05294ac3b380bfaf5b7731a3dbb082c5c18bb556a8b13804d334720f6318f6bca78225d643e2b58756c904458db221adcb785d8c03f1813e6560ea5af2c7e2a9f0ed946a29a07a896ea1787eceacf61c04539ed1d2529ee2138eb972ed7992e063bbec4af298ac2b8fa2dce13a5c0bc9490848d2c43df5dec06af4e20655c9c89079bfaaa4c4143b5eaa1fa46a60f10cb3e039eb13fea15b0aecfbce80092929533a6c4361d7fa2aa3ed5114f8cdee640159645050f812054af1a77bcb82c892c2ed9ed988f6a774b7b14e2cebc93b3513801c19568aff15bf57a99b6c92dd473cf97619a224009959b69bbdd6c54e6798dfc4437debb76b47b136fc548c466593a0c2ea88a4958fe3b17fa43bd182c4a9eebb5bc9bd6e594870f77dddf05572b53e69aebbbe6dd77fc68fd94678aac913f46990783a0b3b7b23abc2aba3b19544e54543b34c8c51291ded296620ef602926929fbb2071f2e5c4ffc58445ac3b5d8d67b86b76acca1b85076e651c25ed58d82abe0ce36ded11e3c64079b4260b326c2561bec4fad312fbb93ecc0345d423d7b97eb388d278eada373935c0ff0e283e51380659222260396d517acba7ad758950ccb5ed7930824d385528fd18307ec903d36e3b7872abc23973a8fe8328a55f124651700fadd9e1ccef6d7bda23bfb1af650cb4dbae503ce7385ce5d207f7954f8c6532adf82c2d7258a2aa7fad240e3a17ab6e8e51f589bec172127f1eb9495d89cdb6c80b3c89fae6905b8c4158d08d27bf5cfb5d58abc38458c756bb69c72a27da5e84f009335256cd7cd2004b54185e7869d5fdf5d3f54bc3524cf13345f8a7719f7b427febff3386f6d920a02c12fd61cfc038097f460e87df50b4cb9ce4880ed5a222cae53f5398f67ac13add99be49584ae72c1f288cb6b915fe82440043459ddbfc59fbbd941797b5968f7d86c1dc82b77f8d13d92650577f90a08cfe175ed914b59f8196e5a2a6697e3d4004145827f08891a667cb63253d5f8056ec752853c3cc35d565c098a36c7a8661e5f973cbd9c17d2c2b35ef94055880f24e145371723e7c7c3418b324e81c079fbec30418c0a1981d3dd20684e5e6eec23b9e67159912c94d1c0677fff6b4dd537aa105a3bf44d5239d09bae9e34dfb5d322ae8f1e9d5682cbbe6f1890ff7c1e06b8b2fb445ca68fe0597dc534835ccebdb6c12efe78acf9b34cb90c625aade9f7e6d27ce1c8a65e597e2e6c86181d139e0d34f727d8ad91a10d600a8123ba3e63a0784fac0491c5dff065ae3118fcf54ceb8167eafaae9d4746d336faa944290fd3dbbffac85b970a1dd4e174c5df0de30ca7d2cb36319970cce36ffe3707e3dd909843a0836f316dcf6e78309cf8c8949252b734dfcb48809a8c47743cd94e85ee1f75cc0b7db11153457ce71e20515043af4d47ed283845681305c6da9170f62e5d3747c15bab216ee2493c9e448fd72c47d6ab1e279b1239b64914634fe96c82963b3a4f05d188361e52ccf2d5905bafe85a7ea02ee6be0038c0a13e82054831e4cb9cd2e12c49f1b1d9cb9a7422c4f787cacf6646f072c3139a4a55385be0f03a7a4d0eea4a6fcf34ab224618e87bbd997e74dc5a12eff27e340e2af17443b99ad32134cf262ad6d4a0b5805ccdc5628b7a8713d04d147fa8c5176563a18f2a40e88948695dd8f6a5adf7b97db8f2be204a4b8b83ca0d350fc84ee7e270d1210b64aa78a499d352ead3d394d88fc7562db7ddb12c10de9dcaa81c8026a94132a30879b48443000f5c60afffe31382896278ed2981a743f8db8be450f3247ab847f11afb9df8fa20d5e4aa24d84846202f9ea4003732f89ffce3c1edbe59bcf8e0928b070da9b085ba0c917c35fc62c27852095ba23406d084486a948485d4d7f435d1be68c51eb5b7a1d569a867ad1bfecd9e9f424951db8b55a6df0c694b1890334248ab7f9228ffee21dbeaed6725fde9a878fdceeb47ad9923e810ce7b9c6dc9821b5c585ccc655742136f6fa8bb09ca47e1045cc04b6048eeec696084ef5384550525bb9e89cd94ad9c5c3b4bfc9ec975d5a9e86fd63284ca0ec5f8eaf7e7228fbf376a4bcf0b4e48069c796fb72a4c2940d719a14253b7e8a36398d7c4fc8498a4608c47ee7096272397509035c69ef162a658363c010b1d68ed9dcd85a95f6a0cf6c2d1326283d041d7dde5a5ce6f03ecd56d575b2ebf81f34c7945828afa0e1ff76d488ab19fa7c3fd4a8dd3574b74d71fad936f1d45509f7cb882d6301942461682fa6f605b08ea8df9e7af42d8c615c4967c79505faebb9cee563094e75a15280b30b3878e12cd2ad46ac9736b75fdfd52625326f36b7970a2e819d3e47c8ed980848e766cc1b91cd653beeb63179f8a96535a1d026bd00fb63d6ccc4e4a9028a3ff4ca1bc0713de33e909041604c7c0c18da16a6d299bdc00dcf6943fe04023b6331e43037b89364595e36eb6dedba154f4e89fd464370f4bbebf50e739621becb512479af8a03bb9c2819b7f6e0f1d7ae79f9e350269067982aa499c9cab44e0f5ca93d819c254370233cc8c214cc02387d26a3d22f827d6697a491c537ab61116d449c92080443e47bab1d652ec9ee3faa04bd5d4d6add8a95c0a127b9cd2cc43f47de73fc42827047e7d4313a80a07ba4cbccc7e5d334de438edcb62c4ba44af6029dd992d4ea47be1b18ccec13a833e8f9e5f846bc0e4780023d71442a6ecc7e8624d9cf58d88745454756d2a270871aa4855a00d493a3e6e3958f14600bbbe6351a4fbabf43eb34050b55cc171bff3c75cacafe1109f357c2c13984aa308cdb41d7e3c0ddbd033bda7f9fae21abaf2490446809da4311b27d5b4d05215447321e15a6e0c22ec9cd2bfe5cd18548f00134f3dfc5d1398eacb03e02dc3bc48013ea327d4be91be61296834f49b907e618594c9c51cf4706d0d11ededca08c17008cb820bba542413ac9872593be6b88fc5a5369bd305ec01440ba2cb234b04b654bdb024f3c6895059929624dd7d0f276e4907971b5cb4d5653ced5fd6f581ef4158533513c54191115a47a9d4d55aa39c176d7b5836f9c0c9605c3d5d492a7fbfaf06327c08ce33576238a40446eeaf40f5e954aa41aa59c1ad292dff02130a3d2d6cd85653886152be95be07a1c3cc31ee387a30d8dd2d36d4dfee9d675f092976e31196d3da66fcf251df1aacb6b69fcf9eecd2fe28d9588c07b7965c52c56507e8af4d60b1535b8cac32ffb919df4d3846be2a34fd8a11128df5afcaa1dab84ac0923d9c75f391a75e5c1f77cc26f2be7f6b864a0afe4fd7b61fff1119237d7555a49fc5ff50df9a288562f796c01541de97c29126e7897c7337d6c9f78e10ba116c4eeb60b02ec3952487b9550a4ce55a446ed5d1716eb4358d5ac3e15c80dee9c8e0eecd57c148733b4cc8f33369ab84b4724054e734a291ddea9d863190810d2fe3ebd695ee89ed57d6f952f5f9f86505154bf9fd56300b64aaf76af494b7f93bdaad7dbac6f38ee2917ab552cb2debf9f9a045c65d0ee430b06b4649cd543996c03dcbf672a8288dcf9d62affac0ba6d7f7dfec3a6e69e8bda26459fb8be91d6682ebdc50249127c41df6b83ee423a435ffcbfa85ed16a5c7d3ae4f5558421b7a3cfc0b20de898f5f1accd09cf7971ea475df6bfbd6407b0d346b2efa03d273d964b376671692c764673d35878bb0e7ea2a7185488fa6aca08fceb5c8cd621f5ff58c66bd3e80e55f7e98ba2126a92505992257f4ed1391ffe3040bc77fde8d6fd3a552f7aa253a8cfb34ed702a958d429d13fa58983872ad634856b459a54ef024f09ba1aa42ea35316c6d7b57c774bf1999de54a77dc934338a706af0c9594e28e2703c19a4ad02ee7ff9ebdbf257102e9381d7e54e6623b311618f9382f3c2952420210ca80c5906a7cf7fbfeefb27b48fb585065ea7e199e98d2c7612d26696eaf2408991e042954ac404d3bb3485e8b67658fd8433daad7f0b2e8bea9f248230a32ab2fd619cb623a86a0c4a4170dc45083075ec3ae612b3a2f1e6a589826b12e669eb7733aca1f6074ec0c9c3373c46822c2135dd3ac81ba3c3ade7d5c59601975efd179db1b603474a8d69466a52c02aa113ae92851b6efc9775feeba0118db236686bcc1c713a6ee98ff76dd3333dc58e5c348c93ac9e12e252058578941b022e484901830bda55d901026fe479cca0456c83bc5bf051772a942a40ba75ea50bed1e690acaeb901e2bc1e1e6e62464ae15ac7502363e9a4b9ce641629f44fa06d71954c9184cbbd113c61f3ec5e2008dcbc37ca4cae02a1d793b2d91e72febbcc02bfe3c45d5273e77729699d9da4619c7cab204bf1b60b37c170e58306a1ad0ca68f4ad09000bb3cc000b04791f1c6edf3d5821044917409ac0848bf8e90d051fbd6e82b127827ea9cac8c2547a1a272c1df746be90ab0fb495a2e4a298c1d55f24bc53dbe8481888cf988b72590dd08d591068746e13761da8b27f0028e87afc8d4b4de60139b43e110fd0fa95f28d7aa65aee378fbe3cbaddcabd21fef86dcac480b203bc11af4d0314e5ab47d250d5efe34dec439bc8d9da66cbc4108116ddd219ab9aae2261b80787f02187e941557228e39dd9b7e4b1f595e6da3efabafee967be774e17a003861f216004828f21eb2365fe67c996b9f37ad5b692368dd9e08cb4d013ecd96e2bf4a820039c6c1650a2c8d5e69af8a716357f01f57e14f5b20e3ae9414940fde5b2f51d98db23f5df3a5ab202f49eab9d750a60047525114c0038e1281da0622fa27b08a4ef3ebbf2ab137c7a33507a16988f22ead28a96fea90ead40ebf785362eafac1228a45cc1c7aaab5def91015dea726e4242d448c398263815d2526abab3b4d531d18d3dedaeb5014641534063c7902c588797168a4f346578873c284df99d4c3be2a047cb291a542769db598260d364feee4fc164c2988b626cf9c7bd8eba8033733dd1f20eb9152e555ac57e60263698096848d40f5c12b995fc965df70009a8cea3fd8495721ce5d6d90cc044bd8e0d1e0e27e3758e3b20287c4e8f66881715aa8af4dbf4cf9b444cbfa7ee81fa84dbd4c13127181880c7d36df701ebdca79609b8d46d5770badaffb5093e79427aea7285670f21eb889dfe0f09f89bb32e8622098b329c6691827d586b43f78cd05a0418361099f60cfa3e52b2a8951672720c1c583e5ee4ae431031c897f2bd2cf4e4e2601a00376d5eec9459e696c950b98536fe32e93b22d7eda4ac05a1c775b75f90261726e8ef10f187b97eff9d7211b4a5bd42fc54eed25a2946f1d891b7c67b7aefe6124622e775519fc566294eb4a6b08e91589babdae250171a2f352322a3c5a51f534fc017aac8ea7badb0af59c29bcf976a6c17151c1acf61af031dc9610c150d9466e6f7dd4023a622728935f937ae6bf92b7f080d4dbeb27f9999ea69d505e7debb3e3851399c049a537ac7bcf8ad9996bf526b5e9b1f30c5a2be893f31f8d17a72e50b1d12e209c7f88d08f2833a85aaa9d65f7763242387cb2928a12815a15c9f0ff0a4b56a7b6775a0ca63abdc8225ca6a1982b8592f21fe9727c2673f3064f5782db863bb040c1894d943b86cf212a721790e297f0728fb6d1044e64e230158e72311d35349e557c12426a9706cede17c9317f668adb41b677d33c9d55f6694e92a9430a051f60e212ddd79f7951af629a9e241e7e67b067ba625753d635fca459913cc18df7312bd073c5f7f9e3dc13ca324b35fb1577ef6cab48b348503ebb7c2bed126cb2084a178a8b0b3acd08f13d6ad1df0bce17ae1b6b0a64be046b831cb1ab5aae40059b3a60d4496d537de8a59179decd08979b48cd2494e99c161a59fe009bf615f976c90ed295b061182ea2a9548f46b995dd4293a2d086e24084b475f4b5f4cb264c214b185a9fa8dcf0b4f4d9f5f24e5e09a784f111b304269c7b878dc99184660365e37a3b5e4b2625b56709abfec716859cceb509f67b4b5e2504af0a4a969a7fc5d52cc21bd59ed8bc3196cf2b6a65a46e43b49dd5cc5fcfc4d84744fca8ee372ef2180026606fbe874a3e3fd89c8e45d510a9af2c576f05629fe9b9e9beb13bedcee385b7359cadab03216ad615b67c612a9b2902320e832a50275c24f31709fcc7f53b03bff5304dfd678d52f67f9e93c7fd966304c0c6340adf90656507d3cffa528a8fce1d299240a289d25331f4eaaeb026ba51ea46f5facbfad2ea4059ef98c80ad6328621a9957b95b7e81f903984e07c5c8ea608eb9cd6dae78561388dc93633341c108876635771d222a330f1b6a02a6ec6df1c8ff15a1af38f658acf43c2928b08afafe458f9c29f9f4d6a473395889939e727f05c33ef59194b61635d827f1cffc803448c9024e0e3913767a47a1fec41b5fa8535729aabd1457e6c266f4b29cc7617f0f3f2800eff93ebcfd28e441a54ee3ab0df23b35744f35def41b6a6dbad6ccb09304d2c65e0f73d49b62f98fae0920886ae7eec06acb5c893427c17eeaaf205067a4824b699467a56ab0dd10c0965469210d04660ea64aaaf7e1d692d4239653364504468c16e34948c5b8f2921ca9e42a8177e5723182449865d05034026f80bae90f2ef0f72acb60cd277beb4b3affbcb1c05764f74e493359b90dc11e304cec484c4ad5648b076544f71defb19ba0f597bedf94b266a741c6fce65ad9f2987e6200199a03a8a1c334572b6fe620929d30d0da5252d7ecd69c548c4901e1934b4cab621e16d0ad43809574a518ae9ecad1247d403731c9c6263f753f4d7a51f2be96450dce3e05d74d94385592a08929afe5f50a7c5b4cd8df1725cdb681d7b4301b666a9098c2f9e73470924594c4b1cac4f164580c7ce4bb6bd310b303bca8ade0d9efc7658bf52c3e1893fb45dbd4b098644c5c98565dbcbe9825bcb418ff61749963dbdd8958b7c778f31c7fe78224f9b44ed01aca16329b37a1ddbba3086f1eb14b75316fd1be2bb30bd86527ed890b0a1e52e2e44ec052a9f9ce50b821f3a2a9896ad40e4be5a4a777b70adda0e2dad019a7b1a1ed99bf98c3305b0ce27eb18209ffa8591b87d09b54c79528d3e24ee380f529956d4765a6faca97ca4fa47607ceb6b2326972d79d214aeb041851550dd5cff9bff22f53de1f7d296b0efc0fa75a222072203832c31bb1111f255cff8b17434637067dcea30b0c7477b8e3b22d5fc105404235c0d03f86dc5fd400deeb21a52ba2aed495aa6fdc5806bf610472dde4b234bbe5f9d18c504954902678d6bca5a51347556c0423baf2c8ea1718d8b3a991b3f76471fe0c92523c353e8635082ed90e227372f7d144061496ce11e2ba5062f9896b4106bf67d6062b728cf0d5782736ffc85e61bca2b4043bff7d40516204888f8ddb69ed664fb1db49fa5fd375420b9d37f58a134ee8dbfd413682b674640362f3f525ae534cd75c7a1f2c668466f06879f0272d4b1a659148ff136aa211c64ce129c89eaed7c87ded7ad15f99139774061dbc0d7d183aa6502e489962956cd3004130a77b3fe6e3207e91990753980c796e5a0014bfe5bc12fc30544dba08b0fe632118546865dd30d55634c625659f509a2cf16e0dc561d6d2be980ae0bce0ed9641be53bec6852acfa63d6e4bbf8bc9163804788ac6029fe71023ceebab4aa8d1145df47be8d6e8359db7e3d69d3ba2d260a53cc95819259582a96c7505304b9f6994a39d766fcbb7677ab18a2370d51e772a8ad5b5a01e8ce8d04058b108213514acbbefbace4ca12269521ab77e310ccc222d2bc8b3e6115e27cb20d439e38741bb1ee9aa22680d52856226f5c60f77ffa2332d1a11509baee494d74d22ebaf8c12dced550baac57861dbebbf905a9cf491b0790ff0663385982f25144d7de564df543c47b43d4c10e506c00bc2eeee9fa8a8f608ab4c84a010b6368340a33568ba240e0b2739b49360dd5cddd823bddb14d7d81add9ac2fa6a4844f91023896cab50cca6a03ccdc814ebfc38deac193fe2170af7faa1c7177d4320af9c7334ec0cb82e9850b82b6bcb7aa03536bdc640b62b7946a2083b86bdc934427a8ecc890acf6aa3ae054eb5139fce5b3c66770c9f2c9399d22bc0adcafbcc8370d748eb0bb190b71aa9abf65601c405efbaf90b3145fb8867249bf4e2cefd36ce5c8ec108d00a6e53e4286d66ea7bada5354dbd32bba8469da5084c3c4425f9121c15fe374b2059c3146b579a60a894967c5eb723260b066a8fde3f64f6755a816926a7afd8498011513dc4874df42c3c889ff0edf1bdc1482e6812f3759e50e6946b351528ee10c99a94b378e3c8a049097e55b2e149b7b823016afd5ddc8a3b964f13efe6575929e750eb25722894ff9e533c4564aa0a560b4155296199baa9e9cee74af6508f842b2b7504e0fbbd968a62696b7aa71a14becf787952fcc08a1d24aa37a6c486602ac327eb917d2b8d45022f2650fd133ee71396412ae9f3f37df4bd119421838c59fbfb9990e00a7474bc8dbec002baf7223b961649e274be4407374fc62fd94cfae67166f941651f93f5fd658e04362f09ca91a62a4116aeeeb59629edd70469fd11e9242d228cfaffc5cce29b7879547530646dff25da87a415851bb219d731b5cb868cbeb2b64aaa4cdf03471ac6230b202e9b08c712ca24c07c728cde18f044180d77215900474c24ee7648103c282c103bdc25097178a35f4271f05ca13db8b42b3e1b8c9a0b3d09ea7425d3b8cd44c0715b519ca03ca1f0b48f552014ff528d236d2145c82d7d5558155cf883a07b9379f218fa596fdbd25f3727972edfec8c8ccbe7a5f969a65f76e3f01c61391d96a71e528b81bb409a138b22b5f655b0b87d051f3831bc8f389491c62e76cd0e17adbeb3e858e6765eb300eb8c69ab830b3e1b7f159406a0b15a8641edbaf9cbef9966e6f294601ba8abd7921468057eb7ffaf16abfbc3bcca9b37c54734343db0c4787913f02fa111249c1ac0215b884d0bf93f6b06096f7befbbfe00603ab5f4f8526bbdf82ed4c25f83416d1d15fbea4f47b22d505d5465b6dda1332fc2e37d5f436498952bcc904c585e2186b7b7e763440e806cbdd880adcd8fe8f8aed08fd76bf230c220e0cd0aecb726be70c35dfb15586fc2b9934bb592a01f6d9e53264ce6c16f3f72eb4c4b98c59302f1dc4f998f3a781962ba334c8a2e3d75469fecc2c2cf6a7bb05c958ef7cc180afaf7af7484f2938de71ffcfe33c4cb35fb970b225764599b30361e9f915568a96aa8e275d3d52135e77f80849638e0b1da2f3c7ae1759dc9430401d556f2bbecbd6ad8b91cec4b218f32493a67e47aea5ddb16a9d62e4993ef5be48e33fd4baa7c97331495ffd754d2b517cf9230e356dadff32e9af5a92773b6c41255a3381e722754805311affd4bee447efcb4def004e857d709eb6b5af116a6d47e8b8ca7fc91ce35140ea3636319857418304976473ff3dcc0238539d263757294b705828a5351bd79a162e45e5bdbc427c85c7304936f99458bf8986d5d1b548203a2ac7cd87f3765d52473610bc7545f00bf46c8f4ea6371af243e6ba003a2e7a8d4c0bf52fa6f45a565877988ca6553bb1810c89175312e7920dd1bed4d950c8063524ea7d1bbce11cc1361601dacd694de926955d525cbc260fc94cc0574396f2638067d088c3ad08ef691d7247df3be854f4e8193a9e2128e7e009c96beec27cb7289a53943638da0df1ee0f8eab8755758685b3fce10cfd697b86339e9ea14cba8477fb7f9fca64a3ac6f4ba7b9ced881f370680450371ebbbc726c15db5f01b6076a45aa89e632d7d23827c50bd8e29dd1f845ff9ddf25a9f01665e3b250dd22609f5173ad3326ccc2e0b417620ef0b75b79e4e22781b43b7c3616d8bcd63cf25082c3c646eed3e16dc201f9d12d91e8b1e29045fe65015a4a76d620edc220b7a0d3e3e304207ed01ca378f944526980f160ee417863f7c3981cdad5cce029ff1c9b2b2cdf0fba5a0d3159fc48f56dad4fa47d5026c65a2c1876c24457b2b4f93e66247570790991b9cee54735203ead5edd3e9cf92af4dafc5a44b39072fecd5481ee0547aa75219c2aab75daacb958bceb1e74f8e2261d2bfa693170f801c6dae43dfaeeefae91e04a80705e7fc0f023f9c119e8e7fdba58cf3fc2b3b53572af5c5850f7b7260c1e2ab99898c9bc3a21b3e8a8ff2918ae70b316fb83caccbcdd88727808e5e319d34a669964011ed708e83da36f","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"cb4dac17dd2d3b658155eb3f63bb6c40"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
