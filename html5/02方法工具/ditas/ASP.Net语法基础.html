<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="zh-cn"><head><meta charset="UTF-8"><meta name="copyright" content="(C) 版权 2024"><meta name="generator" content="DITA-OT"><meta name="description" content=""><title>ASP.Net语法基础</title><link rel="stylesheet" type="text/css" href="../../commonltr.css">
<link rel="stylesheet" type="text/css" href="../../common-extended.css"></head><body id="ASP.Net语法基础-35861BF2"><main role="main"><article role="article" aria-labelledby="ariaid-title1">
<h1 class="title topictitle1" id="ariaid-title1">ASP.Net语法基础</h1>


<div class="body conbody"><p class="shortdesc"></p>
<p class="p">一，基本页面构成</p>
<p class="p">首先来看如下ASP.Net页面，以引出一些重要方面相关知识：</p>
<p class="p">VB.NET &nbsp; &nbsp; &nbsp; &lt;%@ Page Language=<strong class="ph b">"VB"</strong> %&gt;
 &nbsp; &lt;html&gt; &nbsp;   &lt;head&gt; &nbsp;     &lt;title&gt;&lt;/title&gt;
&nbsp;     &lt;script runat=<strong class="ph b">"server"</strong>&nbsp;<strong class="ph b">' ASP.NET page
code goes here</strong><strong class="ph b">Sub</strong>Page_Load() &nbsp;<strong class="ph b">If</strong> Page.IsPostBack <strong class="ph b">Then</strong>&nbsp;<strong class="ph b">' ASP.NET "postback" code goes here</strong><strong class="ph b">End</strong> <strong class="ph b">If</strong>&nbsp;<strong class="ph b">End</strong> <strong class="ph b">Sub</strong> &nbsp;     &lt;/script&gt; &nbsp;
  &lt;/head&gt; &nbsp;   &lt;body&gt; &nbsp;     &lt;form runat=<strong class="ph b">"server"</strong> &nbsp;       &lt;!-- ASP.NET controls go here --&gt; &nbsp;     &lt;/form&gt;
 &nbsp;   &lt;/body&gt; &nbsp; &lt;/html&gt;</p>
<p class="p">C# &nbsp; &nbsp; &nbsp; &lt;%@ Page Language=<strong class="ph b">"C#"</strong> debug=<strong class="ph b">"true"</strong> trace=<strong class="ph b">"false"</strong>%&gt; &nbsp; &lt;html&gt; &nbsp;   &lt;head&gt;
&nbsp;     &lt;title&gt;&lt;/title&gt; &nbsp;     &lt;script runat=<strong class="ph b">"server"</strong>&nbsp;       // ASP.NET page code goes here &nbsp;       void Page_Load()
{ &nbsp;<strong class="ph b">if</strong> (Page.IsPostBack) { &nbsp;           // ASP.NET <strong class="ph b">"postback"</strong> code goes here &nbsp;         } &nbsp;       } &nbsp;
    &lt;/script&gt; &nbsp;   &lt;/head&gt; &nbsp;   &lt;body&gt;     &nbsp;
    &lt;form runat=<strong class="ph b">"server"</strong> &nbsp;       &lt;!-- ASP.NET controls
go here --&gt; &nbsp;     &lt;/form&gt;  &nbsp;   &lt;/body&gt; &nbsp; &lt;/html&gt;</p>
<p class="p">1,Page directives页面提示:&lt;%@ Page … %&gt;，页面提示用于指定影响全页的设定。</p>
<p class="p">&lt;%@ Page Language=”…” %&gt; (VB,C#等)指定该页使用编程语言，debug属性指定是否显示调试详细信息，trace属性指定显示页码执行的更详细信息(如变量跟踪)。</p>
<p class="p">2，服务器端代码/控件：runat=“server”</p>
<p class="p">3, 注释语句：</p>
<p class="p">A，VB.Net: 使用前缀 ' 写单行注释，多多行只能每行前都加 '</p>
<p class="p">B, C#.Net: 使用前缀&nbsp;写单行注释，使用/* … */写多行注释 4, 方法Methods包括子过程(subroutines,subs,无返回值)和函数(functions,有返回值)
5, Page_Load()方法是特殊过程，在页面每次于浏览器上载入时执行。 6，条件语句： &lt;code vb&gt; A，VB.Net:
If Page.IsPostBack Then End If B, C#: if (Page.IsPostback) { } &lt;/code&gt;
7, 动态页面代码将在HTML之前在服务器端执行，然后才回送浏览器 ==== 二，定义和显示变量 ==== &lt;code vb&gt;
&lt;%@ Page Language=“VB” trace=“false” %&gt; &lt;script runat=“server”&gt;
Sub Page_Load() ' declare variables Dim strCarMake as String Dim strCarModel
as String ' assign variables strCarMake = “Mini” strCarModel = “Cooper”
' set label text values lblCarMake.Text = strCarMake lblCarModel.Text
= strCarModel If Page.IsPostBack ' postback code goes here End If
End Sub &lt;/script&gt; &lt;html&gt; &lt;head&gt; &lt;title&gt;&lt;/title&gt; &lt;style
type=“text/css”&gt; .box001 { font-family: “trebuchet ms”, verdana, sans-serif;
} &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;form runat=“server”&gt; &lt;asp:label
id=“lblCarMake” runat=“server” cssclass=“box001”/&gt; &lt;asp:label id=“lblCarModel”
runat=“server” cssclass=“box001”/&gt; &lt;/form&gt; &lt;/body&gt; &lt;/html&gt;
&lt;/code&gt; &lt;code vb&gt; And the same page in C#: &lt;%@ Page Language=“C#”
trace=“false” %&gt; &lt;script runat=“server”&gt; void Page_Load(object
sender, EventArgs e){&nbsp;declare variables</p>
<p class="p">string strCarMake;</p>
<p class="p">string strCarModel;</p>
<p class="p">// assign variables</p>
<p class="p">strCarMake = "Mini";</p>
<p class="p">strCarModel = "Cooper";</p>
<p class="p">// set label text values</p>
<p class="p">lblCarMake.Text = strCarMake;</p>
<p class="p">lblCarModel.Text = strCarModel;</p>
<p class="p">if(Page.IsPostBack){</p>
<p class="p">// postback code goes here</p>
<p class="p">}</p>
<p class="p"> }</p>
<p class="p">&lt;/script&gt;</p>
<p class="p">&lt;/code&gt;</p>
<p class="p">把上面的代码保存为variable_test.aspx并在服务器上执行，会显示如下结果：Mini Cooper</p>
<p class="p">1，变量声明：</p>
<p class="p">A，VB.Net: Dim strCarMake as String</p>
<p class="p">B, C#: string strCarMake;</p>
<p class="p">VB.NET中的变量声明关键字”Dim”是”Dimension,维，尺寸”的缩写，用于定义变量类型。C#中直接把数据类型关键字放在变量名前即可。</p>
<p class="p">2，变量赋值：VB.net , C#.net: strCarMake = “Mini”</p>
<p class="p">3, 显示变量：VB.net , C#.net: lblCarMake.Text = strCarMake</p>
<p class="p">ASP控件： &lt;asp:label id=“lblCarMake” runat=“server” cssclass=“box001”/&gt;</p>
<p class="p">标签控件的RunAt属性指定执行方式，CSSClass属性指定对应的CSS样式</p>
<p class="p">4, C#的编程规范需要Page Load方法包含两个参数：object sender, EventArgs e</p>
<p class="p">5， &lt;form&gt;和 &lt;asp:label&gt; 两个都包含了runat=“server”，显得有些多余。</p>
<p class="p">三，检验输出页面</p>
<p class="p">如下是上述页面的在浏览器中显示的源代码：[…]表示无意义字符</p>
<p class="p">&lt;html&gt; &nbsp;   &lt;head&gt; &nbsp;     &lt;title&gt;&lt;/title&gt; &nbsp;
    &lt;style <strong class="ph b">type</strong>=<strong class="ph b">"text/css"</strong> &nbsp;       .box001 {
&nbsp;           font-family: <strong class="ph b">"trebuchet ms"</strong>, verdana, sans-serif;
&nbsp;       } &nbsp;     &lt;/style&gt; &nbsp;   &lt;/head&gt; &nbsp; 
 &lt;body&gt; &nbsp;       &lt;form name=<strong class="ph b">"_ctl0"</strong> method=<strong class="ph b">"post"</strong> action=<strong class="ph b">"simple_variable_test.aspx"</strong> id=<strong class="ph b">"_ctl0"</strong> &nbsp;
        &lt;input <strong class="ph b">type</strong>=<strong class="ph b">"hidden"</strong> name=<strong class="ph b">"__VIEWSTATE"</strong> value=<strong class="ph b">"[...]"</strong> /&gt; &nbsp;           Mini &nbsp;           Cooper
 &nbsp;       &lt;/form&gt; &nbsp;   &lt;/body&gt; &nbsp; &lt;/html&gt;</p>
<p class="p">服务器端代码比较安全。处理后的页面变化如下：&lt;asp:label&gt; 标签变为普通标签，其CSSCLass属性变为简单的Class属性，ID保持不变，RUNAT属性完全消失。</p>
<p class="p">有趣的是，一个新的隐藏的&lt;input&gt;名为<u class="ph u">VIEWSTATE被自动加到form中，如果该表单提交后，标签会通过</u>VIEWSTATE的Name和Value属性传递参数给form Action中指定的页面。在许多服务器端编程语言中，你不得不为之自己编码。</p>
<p class="p">增加互动</p>
<p class="p">目前为止，我们只是理论上学习页面构成。现在我们必须运用理论，付诸实践</p>
<p class="p">四，高级主题</p>
<p class="p">基于角色的安全性</p>
<p class="p">密码</p>
<p class="p">模板</p>
<p class="p">数据库</p>
<p class="p">[真正理解ViewState - part1&nbsp;<a class="xref" href="http://www.cnblogs.com/wdxinren/archive/2006/09/30/518952.html" target="_blank" rel="external noopener"><strong class="ph b">http://www.cnblogs.com/wdxinren/archive/2006/09/30/518952.html</strong></a></p>
</div>
<nav role="navigation" class="related-links"><div class="familylinks"><div class="parentlink"><strong>父主题：</strong> <a class="link" href=".NET%E5%BC%80%E5%8F%91.html">.Net开发</a></div></div></nav></article></main></body></html>