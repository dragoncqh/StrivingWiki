<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"7327ab1039a39e520c004cf84d183e2aa47a2bfac199fb528c60c20b7271e784b9d62d51cabb8a4ea23e4b0c9bbf215e7a1646b49e9de4a78d081c08efb132acb97d71140ade3bddcb3669e4014226528db97af6066f4e5ffe96967d3a8607296ead4125341d59a3a444b3ddc30d6c046d4c2f2212f4fbec272c232473f4e3821773f02f0d23a9bcf0cb3dfe328b2e74a0e7ac6966b38195017d584f37b25fed0b8aea1e9cabcfccc5f1941b167569b56448b66758b9a8beaf62465377a01e34973ad2945140589e586b0fd1805f035e8915e1505227c8f93f687e85becb756dd95d62d60830f996eeb5f1c54058cbb6f407d02fd2385015aa705f6ea27f1327857b82f267c0e029018b2ebcb393c4cbd78501da4cd0cf455f6d33bc72aaffa21d5f6ef885452a6acbbd070f1dfb26d7f02cb2949aadb8b203ef0f17136848bda2f3f743c6ddeefba2718475f98d77f8072617a2a3aaf56f5bf390a79958fd79c2e2a355d13beba6bc5a364529624c4d910a0e183488a9989eaa7468e35370da087a8bc8b62421e51603664bd4ad18f1b7ac19598fee63c0ec69cd909a514cc27df57242c07219df425add9b4081f672180cbf1abc16c5295ab6fa5bc2fcecf70989d04cee8dc24bb995722106880406604366290bde0b12a8ec6fe64ab2b0c2843467d6c2108b511b2ec3f2b9cec2b50d6023e6c8282ca4057d584bfeeee3f622928f44b3f525f7f55942ae5e96fc7a88e62f240f5baa96d8e60e0b441c1ca7328dd608288700e5837423eb92c4df90df8f28f59b5e5a4397fb2beb528f32b708113f65a2ba42a08b3199dc8a72d667cb741fb50a720d1128511e9c0f090f10c9a2aed6488e425d8a16ddf86d0858963176319506055fbef8cd2ea893852884fe54121217b601688acce671527f2adbafa5be255653d39e7040131a47aabafcef108cae18a1be47bbbbab025fa94ccef413e8d993b97387a291c17267e9a8e82aff84aec7120b12c8df2cfbea81218ddb1fcb4a08e38d4f0c0cb2b5a09537b503ff0fe7ff039d2813c11511cbc61125569f803a58f82c2dd8ad31c3bc860db3981a29054e45412930ea68190a6acfe94212a4839a1ad4f057fe1e0a03c818919d67ae03ad82f95fbb93e8352ed952fe501d94501d95cfaa2c28e42a5b825ad6e7367fbe6205042ae448cf58b2ce17328c80f3ca1335d63c742f345e68f7b052c48f60fdcc29e928d8424f2279620df7cd27e7134789f19fa2155cf63d99d6ccec6ab7e3aa2c5daa09203b9f247b19dc96d97cfe3682da0d46622ad63596ffd7a27f11e71e2bded34b35befc61f2de68b81b5b284f91eec117aa4a2a6114e52432c8467e96109a5165764693af5c951d713dff90a90926aa34bf24b1aae3b1a85962543bb0ebe9906b3b3ab78c3c4d1bd71dfee57c92286859d541cfb0a213815cfaa52dddcc4f1cc0e96ee61f6f7a5700a284acf5d6165693adbdb3f872876f35ea4a8a503530cb9ba4f5b4a2da0928eda86d42d488a263947d2bb57f60d5be3a064516bb637879933f467be5873f1a9aee48b9acfb9233e2448268ba9c2a0699633d4c42737d982adc549785a3dc105813038fc987bd09be3e41267a0cfe92129fc20d0b957d2715b96eb140e21b4d2898bd4293248d818be083eda696965a1121254b40d14dcd1af1a3751951532092745edee12775f0d680bdf6105fff93da86f72889a848deb046daca7e063dae89503b49c9a182ea8cb083b9a0322039efd37fce104a7df0b08a29db3dcd0a66a6cedaf8d6b18577c16a4956e886531fb14ad3d58bc7694012ab1f7f33f702cc0665c5fd1de5f897626cb8ea58c7b891ce947c925617b31058770f99369fcb6150d57df2fd3b4d8eadce7673135889720da7262ed91a6e7d94384285b198ab648e3d32b0d2621ea1940a4b20f096d95900a53292c2399ddf52b08d6676c24ff9cd22d4f486a7049a74ba55fbec103b95d3e9c21fba85f4b88abcaa7df656c30e1cf86a718f6087b8f2fbbba12f5c99f355a94881b601404a35572521a1cc38c99396aa6a63f2a778f82cb045c9f24b488d3d5150f6881e3cc5c14a05ce4afcaa1d94d843025af2b0a08b747f3f02dda18d08884ec5e78dddbf00a8dc228f21e78d7ee4fb73c7c8b1d84ca05a0a901bfec5c43ee160675e00372c812f2f9e7773ac5bd3ec1c0ca992b19892df76feaf275d344514089148a9a9153055922566517facc8d581067c146565fb72ec945851cb4e59a5f383dfc289a7677e0958cce6610bbb3981affc78923bbabc7c12d048f09000071acb279c771a8af0175a6646537dd1ef0d29393185d6419f0b5e3c65a6f7d27bd17b50a8e1bde0d865dc91a52f9e80910eb1f7768f7dea6ea595b19da472a8c7e2d50f1a673068e27b8898ee0b08263c5a6c8f9212dd54441977ed893af7f9e0fe05a4d2af4fa66bb280c74d8261f189e010fa686a22ae6f2695cf10c9cd51304f431e74f3a87595701860ce9e3feb489ac1410a72bab724cb23f3e2fddf0dceff8cbbb68c79f780362767645fa7b220290888e9abfb2d7ff0123e0818f962296b8781731b2f1181b3dcd19a6b51a9ab263a93400cdca8f42e4698abba71d07a11385878b850fc05cd91789a46085d5ec911bc4a5218d0d3c7a6bf01b572cf103d65804acc19b0025b7256a5d9d307d1f481fba041cede947c3debb29150b4393162286032a44e6bb5cd1e96542e9a19a25265cc3549b6bd610e883fef5430c7826751c8fcd1e6ec063995669a85f13f30ce981fb581fa1b019c7a2f3a1fb11bbea9b90eec1542cb929ae7e5fdf479d85945d8e7b3740b05debd6dd8039dc20cc5a505d6ffa50a225bdf2d8ca0cbd041f11c6cc2570ebadac9b2a8a7bd03ef49f57223ce85a56d7790439d71d206507cbba815426c87ee06d041666c6f11c823ae904bcee2731b41112e66f491ae6fbad85000be9a908fb6fb9a7f661d6a35c2aeb17c601cec3eca59e14429f5cddd5690cb99c904131fb44a2cbd2be66b6b9476b69e103f7a5a5352676c90d3fa38f6676718d092bb5341f93a30e57a269bcdf3a6dee659d42c845b2f3b0c7dc55ad771e08214d30ad685019c7a1a2637f28d3ce33010bd116deaab3111500f512a58bde641904d6f50e158a554866acbfe7cb15d1cd0373b73d50870af466d6add1cc4ddc2789c5f28affe9500887781c35059bf8f86f66df8e583f0604b04b63c6cbf8d3945216b4ac8d685417a60a925f77f8e429c4fc5db73ae125e30367a47de10af47e81d3263f56b9950a28739b9578a08c0f248bce0ce4cde58e872091ddd92d488bfca3dfa40b87d36501911b658c9eb0fdd8da24f2a4905a24a330864e15dbffc40db12d7ac075033ca85d11f62432e5639c2332b37c3fc519ac4a70b37e6359c24254a8b5fe8a1cd32aada50958557c4a9c2e8278e9117f2544bcdeec5e09e79d15b09ea1fd52b7f2527445a0aa8c2977a2475df19d940b0170cbebeb75fa47a7a50ca1b9e0b92d0aa92a8779e64a0b5c01b9b6aace8e8eb3ed6281c566f47bec64b389daaf9fcc19a86a21b70fdb4925d7ff627b7bfe48ccffe8034ad15c59770380e32ecb71a05087f3d18c8725263eed5bd2ad2d296986c1e3ff06faf7850ea23506c1ec985fde0047cc166e8acf195e7f9bdd348aee7c97c1816ac78980f63027d49b1b60e421c2fd66c7fd617829303d127bc1c99da5ebdbd26fa0eaa0e41297c2bdc9ff2b44c2fb672904122ed493034e6b2d775cd054419d18af9ae6c0e8e07a2acad99965bf48a90946c1ff3fdd7fbe4b8ce332469eb8d838165a096e1bd1216b96b44a6a26d8d12ed35395bb468e5cbcd3a0d8de68e76e3cb0cc2db58eb9a0549b5512a18efcd0e578aeb72af58de4321dfe6608e8190d5228a4370c77e37b02431d72439c7b49072b0cf9d34315ecb196cff3b15e9e45a5d5678b41200e52a8df7d7a592d06e6f7b73bf205e470f434528a79d01872c671a72dc59571948e28ea990edca66ad114346cd73f5bbbd604674bfe69a4f5e1892a9fa9d078cbdae0a04b4b7cd2c2d6ed2cd9735cd7a3452140dcc617b204d556990d9bcafef41f91f3b5598cc60f0ba4faf5f8bf44c7b24849b99a6aa5d6a3c4be7b7e20a4ac85990c39a7d338879f7b25cca27f978d2aa432e55c3cb03d822c6018d2c2cf54c11960bf5c8247be194b37066128cc9d90fc4d8f471602ee9b632ab4c7d6a5d6688ccde2b11e5d10b9298ffc3134e7d705323077bec52f60f3457d60784eade245d0dd9e0184482225252ff3efc6317cf246d404754a0035651e439f06522699e589fb8a9195f6f2600a52dd1a65ba587e374b5d8323e5789345ef91fbdb90f62a827e39ca29b69d30b4fd949fd81b3688212a4667c4a623508d2b5136f82396e09fb8d4d743e461d431e2b13119a194f7f11f2d63475ac2561b6db42f9df03ee3b0766b0032ffa7b05568a4c46b1a586040d1339487e9ae30277e303b7eee8314f8ac6c3edc9fb15d7fb102a9fd6bedc84af875a87cfc8e527f7f7e25106bcdfdd635b7997330b5c3566c28ac060c033f396e95d5ff8ba40a711ed4aa0f58d5f33f06e7cca814307224355ea31df98280bffb18183383c71f7ef38047e790b62af5be8ed83d617753adca3e381e93df999e9243ea9762ec3fc929cc9cfacb6bf190893ca7143ae5f178a584e64086eaf58b3d6586620552ce38131aa7f44055008551f4be95189e62081cd2569e4518917698a930228f8abc4714008cf8ed44950feb040845bcee029f1084f7d777f6b7a914c11c6cf1e50a27598ca2527695139a22c8a7977a3076de0d5ba79e3256f03244c64b477fb484ed4b3467175d4e5e44773d8391cb90b07507dcdd9e0a3e55aafa2b3602245563aa4514fa30da51f2a09fb4dc04516f9fbdcad289826ded334c9b1de9af241480d76f4dcc6a4a0f98cedec37889b94329af33765bdbbc15cfc52b406b892efd7efa050c6a9dc7b6d7416b4085cf9b6c32bd59e914c8696e236550f4e491a98da2acb73a2955b92f9bba67cc37641ba30b0648d642c36ac2d55b0336bb30ad00147c2ad3ea0be28089d80ff746ee5fd0e1899793030783014670d85f6eb96ea498721ec6d078088c31bb8be7ff41eaec2b60d147b99258a4f16a8fcfa80d4360251cc202a0c1d6f2fba527f243d5e38c87af0399c40c115e59e8c4551d4982bff1e144d60f38aecce5379d7896f8a88a2f5f00dbe1c2551c97c50ec8ac5ad896dc7d2215b7ca0e99b50745623faba0762a5e26440edf9603dd1c1b31dd0343072f9a8b3ec8b48cdd4cdcc392a2ee381b33ed3d2e1ffb246be572ad9e8177cc0cb2a5ecc1499ae731c923448d7aba774315989db8de08cc653a79e0ca5a168b37dbc5bf6c14459bc5163801fb76a706ec05d13dbc7e652e04ee682c098dfed194033b2d3dd7d7d2310b1898e4ebe54fd67dbfb401c8a7cf7a633d6f5f7b319919011d29c21482e37d5ba944dcadc3ef8deebf3225a6330b08a87878c8ac77c5616cd2cc00797bed528c102fefe8322aeb8440dfee43b5350ea5194ec9c31589e1d4fa9f438f4335afb28233a554003d2f22f56f5a84af359016d33651086c9013b217bc0cc28e0f224dfb83653e2378d4e64489b971df9b648a743f1cbf416725ee7818e35ada564db26b7a7405ff71c1fb25fa921b787ef5cc9f1fa1486edd8bd620d2543645e541162b3052117e4aad592ab1346f3f014e05bedab6eb420aa5b9ac1d36392c5b1f454150fdef491bbe271fbba40e99f7de60dc0f76a8a6dc0c1e62a06a66ed64e6011e1b6bfeba11d42a297ec2bb4ec6afdb387727e1d54dc9413d0078ab9b9d5090d8da1374bc1e6492a8165031358cdbdc8ac61533142baf65de036127ed30942a871555d716c26efee668b5371127a2c51c91509186d27ec2c77f9560bb65f131f7d8c286ef69a3c8a43fcd01e34ffcc7f7442ac2527c26ea62a15a4b9fe189da9ff67da84452c433bbebe0d4f97bd1963024a32775192b452fbcccbad18e3514858be945a0e9347cecd3b0573fb6b18d26a80421b8de27c9fcc8935ac3104ac13bd2079de12eaed6467cb273ee0377c455db52640467a20252075f8a4801c0e933cc2649ce3ccffb0a5e5f4a413cabda0643e96c4203d92c01cfb51e1b2a98cfc098f0ba5bc09bf7ec897b795f3614585dcc72ddf65d4b0702fbf1c618b0f96cfd568d984146173d590418e53c6a01949bf4321eff5a42a40088370cafc0f2f9cedd4f1ee298e58e140eb0e1a844f82c8f9d854e4cd2db21333bca7cf0230195258530a878d15dd12757c0cb3b86ee2f42d0f10fc18df5688cb6f82fc03e8543df180835c445855c37ee923b0f61b719d616431734c98222361919ac46c4b72b7631cd241cdede76b149c20309361958bc01ee086e0dceb3ab86bd14ca44473d7cd398d844055fae0eae66a1e00936229374767c97105d24e69b5cc0f8656e1288e4e9e87b1800bea553e7af33eaece5effc68f335d62b00ea446db45e8d4b2e76ee232e4a6abc54961714ef141222007f0c0c3a219f30629dd130035d3ac765b2d55eea6c4b038c9e31b8e636aaa5a9cbf9fca0a4380d6ba8af2a24e67ebe9e9eb9b9f591e57d301497df49825306135b5f2217e842d4aa5bc1d4a34ba94532aa7f12f78877e87ac5bf24c4ba0713899ce01fa8704c29d110f47d772c76c57c44e971bdafce1c74f207714beaee583d6cf6ca91912f9987ed29b1ad02a2a720dcccea2346d62736e1a28f3d80bc29549bd74a6cb91975f962707b323d3ad6d71c278aa4b6f099537bafb8d221decf6ab51ac24525eaf86d3fc335dd9d78a4331702da0532dfd376d911c6bbe2bb08b27bc85d9979229db3347343c4d791b0820837fd921668bb9b2d775685caf2f8b95423c5dd26079084f6b0fe0bcc8fb574f0a9f3bfff54024c75155444a2c359656a406d299b56d51ae57ec3acc0a408e71a530b839425ea1706cbd1602dfde71c03291758e89e878014d68294d5afa636095c480fb974bd61324cd35d5d11bc9cc4d82f827d599af0650b40ac2a55a77cdc16bddaeb8c213b3339688f7ebb05e9969b6536a6f3a99fb2abde1727b0a9a0c721302342627c627191c86b5cf2153fe5bfce6d39ed47e62468a0408988396f16c6db7ac7d10370f07b2703ea24fb086a792955e379778148cc890b3d33eee45ac5c133578de28747de2319f1339a5a745124b2afce810f60fbb4917aa29713b455aed59811f665dcd90182b729cf587c11814427f333162157b447d0c499db938fd0d9818a4505e3216d9b72a33bc8386eaf349d02da3e7d9d051a795400d9ed9f758a62ef26bd07aa8c59b72c3274a95d01fa026564cfda045dc5333339bfff71000d823133d60d4d22ecd653ac1fe9f8e3a76117bd42860e85fcb139bbba4d43d6b7d2bedf3401918706cd25e6f36bf4fe9548c717a817cbcdb2f3569dddb631dee19de9fb406790e78851417aa2eb18c130af3c0197d5ea1d1de748cf905dbb29e48e1fff6c582711a6d65c8003abb1c00246a7b4e0aec5e1e4f1883fd9ca82a9add25aeb432f852f7a81ba7aacbb4699a158ec92978fd51be75021a1f3b6a5e4edfcee2c3d9609f3b72bbdd4f757ed01a805840c2ac62a1d36eeda4a0693d07f0ea590e9bb39adf32c75399c204a740489b320a3dce6ed6282e0a8051e8d5000aad2e9ca338deddef39289356230b81832b90584c533a7819f046186ece730d9c4f9b2202c5fb28d9d5613075bb9ebdd415be56c376c4c7c6cf924bd72227436501c12c7c0e5f4404663805c41849778b9837f9e34d437f495f9548cc810ad8299577127e13f75dd9add7302fcc21635e91bf459b910e8c92175fe4e6466c0c9296e5e19b211f59aed9666e10b2eb55025e9c567ba8c19feaee45d8a511d920bb687f941cbe45013626853c01e3b97de5145f91943889534bdeb1942d2f8a8e2460be1ce7cdd947ecd00d05b8dd250cfcd996ecc32e7dd011f0bbfe03564d23dea27abaf45c45100052bc5e760fdd0988b98dda7ce0da8ab97ba3dd9f56dbba948806fa526c7123b10207944b549ec91debc23bb59b525eed4effce260bba33adafb6ba72f68fe7e3857931def149624b09cb74717a087bdbb34e772b4d696c59e14d505b35c407dd826e58a6783a934924791f1ff4de66ce7f7934254209bffd088ab165b5182b199c64b531956b320503ec692b81ccfe5a754718ae9547ebbfbec0b0200d45190aaf68574ec759fe89813e7ad003880bf2d1a0f28736dd2c666811f22b5d52fdeb5763406117b8281bd32f1182efd09e82da835b13090acb18f5dfedc25432b07fdb728b14ac671a6e90393af7be38730fb21253a81f1455b545d99b5a8ecafd7097d9fa256e0c8b84b261e6c1299071527ce50d692ab6176ca78d7fca8a4ef921e7d2b30b6ed26418c759578a38b38fbba3e35626880c09b21758b6d161189c0e9f3b31225a0bc509d52da1a71734102af8dbbb72e9e903b0f9a412ca267e208fb772ce190b92f0b6eb0b618373cd779e4a6ea9a2f4424c06c3fd60d3333d20a27c780be3bb5d46951b06725ca6eff6fd7975839a4c18ce0aba1fd67cff55552f690fa9369831fe84f081909e42a303f5c36d66f9cdf6f29e438450750bef99b2810c93480f5603c99837f29acc167d97b65066be009fe1a7ff6281a6f2e108a434968c448817d327c67219d705c3b0335ea50e0cf7f76e8d2a6c22378af1261947e9efccd112da12aa030078cf8f7b305e0526ae7be2e5e0c7f8f0eada1c681557ae013c129961b06bfb697555373199471f8ade1edd6c74593e2c0700461f55ff503a490ce033764d69cadb8ea3f3cf8a867c662c660b8374dc06009ec79aa02df6d2bee3d2682df90f28429e362d1b94aafd5b280bbca1a83be99c58002d6fde9628a776ec7e995a5b3df0e8456f8eda48f4aa76dcaf9cb61d2c423a263d022fe164ac0441d1b7204f9ceab17534ab404d592df2c835921cfbfbe32dc82372085216d46cac3549d28722c63b39f3084bef1df5724882297bcbe41d9c47e52326a44c6618c8f258e8d11a341b3eca5983ab76cd92008f1fda6547f4c1ae33304cf62644ebee15f3e1d837666ea95e7470dce8cebbe17bcccbf716f29ca36facf889aecb0fcc53314f7c37cc7aa7ddd29df869b5e745ccbf9c1b2135d561bb7d4e0cbd1e78330c760697383fd27cd1f0320113816cb02f32a4730a58826f77f7f52192451517bd8471283fe41363cf9ec4ce1f9a2f116343e96551fb76319c6d5c3510c20f59ade7706ea1df16fa29649707543f994ac2e85ced24883eaf8f00c1026f8f46ff1d49ea2048e6392c184bbabc83f38003e2877092f3f954f8b5d17f05ad2aadb23d4da012377ea8206554937a834e3db27e70ff9f3c5733cc297ba3407895656a28957259754f77cbd96a0aa7f02a3cc2c74e5c53b4fb75a0bbd7d26632e24f41cc949a300d56002aceab9533ac030e94298d4ee40161ffa756ce971a73bb7ad87dd2d6c9bca1a17d11af55c2aaac1ba1fe93c0ab66a5c228f02407c6750ef0ea3ee5dee6743994b7e74438886176e9582f30ad7fa7a2006111e268e0128c1af3c5e66ce43d37b7a71da2bc103fd39339b87c5d6c0d2fc209c0b268a36c3161ec01368ddd33f0730688ed81e65585dcedc5c0b970741f094df3975a2ded9c7fb09e6ad7f966768fbff0f333987abd69ae17a4e8d7f4b5486b96d83b300fd50073aa96b4b754f9e6f39b1f29a3c9d7708385f06ae957b7e996a8b46877c0be9610fe3071316d2cf61397fa19f982f1a297ca9438eaec2db3090c4ba38331fde164f4166e0226a3f348d46712043cbe097fffdb197d22229b54720a30c32d1dab5d40ed3767a3644401942b7582970b2414b73c0651fcf2d9af20bad49d92ff4eac61e994469f0f0080a6a0404924d506533296fb5932c545a19c42069ef770f3dc53e2f498e490d35e61e9370d4f3ee52196f98ad04f82b4b14c9352bf35a66b3d8f539cec4bae6f40f4a8fbc31837e0498990f7fa6a6749e65513b39d9310c26763cbbf496770ed6b2b11881dbd67771f1774b55baeebdd5c1ca1701e4ae10553b1da1a473f5fdf81579410b1633e20ee74dd724d5060eaf06c993ca20cd20cbcdc4b3718ed8706772ae74aa445046db44fe5f7a9ea697cf5a5256fc0192bf458f766ba03be5d416dc353e512bc0a26f35a917ca44fb329c1a2934f858d2ddff7762ee44a8dbc2e035a12e55a6172503a36ed92804e9c24682f796037271838aab9d45ca8b96293733c4049437f4095ef1f9d5e81463145fd6f315f40bc22a99156031ec563b01d117868b56850af5f0114ede9cad7c594acfdd14c46a87cb1add34ebdd73df9ad3dfda6ff4c2c910b8d87fc65c3be2d27458621137149e4e0ed3255c7f8f317d78d12df742b985ae0abfcc001155e81e04719e1d5e2538d9f3af3f06d3251f638d0263acbc26c1847cfb6ebf0518e8ef67d9d9c37912cf62afc067bebc445bb58eef5a2f2d1eccd1d0428dadc9cd7fff1497a4b9e3761952194e14bc944b94b9fa4f0fd4e914cd1c06e220c1a2c0e3900ea28b7bbf487d921ae3f12caed84dbec8fd594051fb6ebf585428b3bc78d23806dbe4bacb6ace326d42ea40e6c791189470e0f2c37dd8a0e8fac2eb07b010f81d706a41136a9ae265d5756c7d4c965b6272746d17a33e884a01bf5376ab7eb7529b0069123021b6614dbbcf3eefb06a8965b6aca3a119dd642799f6ddd553e815a9111530cab4e92588c9c87722e4bd675b53c4b010b04feeb98519d07215ed57d92f79a430a7185e42b014e7ee7843e31a4df8d2097ae07eecb1138bb2556766eba0b3655d26ae82c571c7fc4ce87a288f68942150ad29c25104b36558784d07da17ae2538e4a6e11c3ba65dc2912b1f7763a5b10222d9dac7a4a585a15fd2f64cfcb09ad805d2aa62a678a0ec66b88ecf6ceecd530aabf1162c6d68f84478b6a1efed2930406277262f0fc2d1848a9ab0c22fc221a665d4bbf040a8170a18942f1309d9a372ddc88bc54a461d85aa7b00dedc8cf9590db7069a5040e0571fe21d8b438fbb7b5e170c2a15256dc4a155a0b324fff56c830235141420082d0abe5828ec0579fb730da94ff1481aa5ad919fbc6005833b641e356d1336204480a6e75b9d1c7a711066db4e84bf4238359cbb3966f03d20a5f0520f693c61041a871bc31edaca8bbecbc53745035bd14e655836f75459952ae985f8114411e35a9eb1dd65f72a3d5f6efaa9fa5d659e4e42cc14da44ab42326544ff513fdde3ab78acf7acde915975c383aa035de7ab5372d7c48907d36f0d0eda754b839348ae8085b2039e0deac2ee4c856a73c112e8e7513254ab9bb03c16155bc35e11ceb4991a0d39d9d722344e21a34cecee1160d03babc34a9472e55276a05be3776d3cc0955a79a6e6b95a797c6594f66555136fa11ad58cc909fc7bc8d7e76a273569ca2211bb4bddbe1a111bbad7180781a8413c62f9a13e3639c98efac790f7a00940a6d0e6653cd9a36e80c9546c6f927f5b7dba8594bbcc74542bc6ffe83d718e6bd3cef86a449fa250e4d08ed47f7b4fc4988f5a3646f1454f388a04611357a4f4ccb83bbaad46330bba06e8f2410dba7ea26585af72ed5742465d82fc6605477e7938395b28a52809679334bc49e6300ec0159eb909da96597d429fbcd682ecf019fa64b9181588587848631396822aab9a6d54b0f02acee8eada8824158d3e9d58d180493d310c5f8f42a6bed067a53c617fb8853079946414396550c7c26e5d59ab06003e6439e15bf90362adcd5090fa3ed496edc3ae05d378e0a79279699b497a430e0008070aaf307c19a763cd7099df2b2175c6815d87d34da2cff1e2509c5bf2d827b081f2ff1eb9937098eb34e78b8d6aa39698c6ee9748307cb48627d94c4e25190fb404b5bedb35ee4d74c1ac7774c24a452bca979b66622b8d90d4aaa7add5c71584fa9a4b185f4ff3dfc11780587d29460150e071d37ba32ef66b762b44dc94869ff7bacd537ac3a6d3d028bc3e5f231f476408b31c3d0eebbf51e3e03b40af6380a19cf12e92bb23160a5f3724f51dc788383872a343496bd3a926a44558e21c7a4da3ec0907c4d4574b0167b0b3a853d5aaf16bd180ba6e3efccda0cdc883c429557bba737397e2952f265dabf7865a10fc586b1444c7bf5148a144f4e37de19df74484641ca2725e8f173947ec906c299840debdc49c5a90e7d057eee7bca7bacd0fe4f004186268b3c793340b0ddcecdab02face9dc7b7d3269aa64e7dcd7b390932a27ff2adc15d52182d0bc8da91ea03dbf3dc65a9547fea116051854d2fa1bdf4001465f83d0d60010990eae459413b122015e59865dbab8153f250b21354be3a808575725a0d2298cd52909be97039da8721bc6c57f6ff2bf5ab28351f988618aa8f9fffef0acaae98933ff83ce844070a205ee65009325815df0d94ef2f99ae22106b2b6012fec5fa1daceda29ba548f5f981e54361aed3eaa7ec068c52d48b04c437eb6f39cf806bb0b871f5933be204e1e1c19f595006e8e5dd566be2d697cd985071195d5c7450bc35af8683f200ab664924078e891cbe188defa84385c44d3a2968cbb85e15296f4c6741e1b98f0bb6044c6801268459a33a5e418453dc501a8bb42f7cd7539253b7225ddce8df1d7d13059d6221cd1e3b52a0e8be023897edb812b49fed3a930e4d2a39d9fbc7783d20e8f9317232a36425faf5c0e4d784096ebdebab56e5973fdcd0283ceb8e1b00cbad9c5539873158f08a6245295cf243ecf9627d02058f0fe6adedd7e8f9e48a261e92a1338bc009d4a0f7b3bf5250fcbe3361a889814c5f45ca90aafa0e0b37f0de679bb13ade43462605161e4503f0e878871978e3ad286f6d5402b35ae28da054cb17d9c31ee256ad0193dc4cf7edbf9f47479a7cd343cc18af2473d591c57bbdd52101ebe746f7f1c1f6c8453ca428a6f603a756e6134a9703c08b28bd2cbdcb079d8fa2527584d34804378d91637490eadb20e73908e6377a8183d32e2e2a61794f4591c9a9ab8539dfdc4ce11b3d8655cad9a1f9fdd2339dc3f08cf32045a26642b73568c630a09b871a797069fb61c20dcc76f37743b9d06f3175ed202a068d364b686d1273be0048c8cd446bff1be912c027c150d36f8014830bc934753adaacc9df539071c21e4529810550010e0e78830fdd6a4cf848070f57519508f874e6bfce42512e878b0274f9a44c60aeb204b30e3f5631eda2478edf4aa795cee9caeaae5b8f191d136b680132d76e210a0fdc29fd8e241178cecf6534bb2d9dec100e8d8fe4cb7df2d13872407d2e036ca34e99a5f81c0c032601531d728e26cec2b943a684c568ca1c3f9208bb73dbaa4d6e99b37764dc5b9ffb620aa887fcb640593b4997de3e55797349686aa3ae1ba425ad5c3170222d113a7558986784d2e61084d58cdc699ea8af6657c9966602b8f97804201ee754674f5b8697c8bfdee2c847535af99c87c6fa502b7d411939a6faf57afb7f9a51a14e2214759a7cca589f7bac8a879b14e3472ada2a22afa855f53b4246c7572313f0386519b1ebea77eb44f295f4876fd9ebfd25b3ab0154cf977870cb16f3fa74d293fbab20c289c3ce7236715a9c6e7c2b785702d7a752ab37fd5724bd8c4c5e7431e21208f509a5aa859c5a73d91f34fb6988f41289e566413e8733419eb7c063462e1fbeb48004a7fd3d408ddefe642401ffdcb3b18b8bfede6ed66e630f93e3674af27235bb12648aeffb0b5c9c6b1ec7d3009ed9c65d41cdc061867076752dffef8ed4b47b3d5e75037f42532f2b5f9b6d4cbb15c9a0a339754c4514e64230507f8e1e319ba1398968f27c1f8c0f8a5d083f701587f69ee0d314aace3facfff5fc7014f6dae8c22af193d77ffe3cfa2cf5683c1e10f2cfaff1a4189b3b9da86fcdb809d46cb649f29cf841321dae84adc057ea169f2278d1b22cd6fdb99a7ede4f8dbe32667efe17effe993a79fa22d07e0bac6eeea9d473fcbcbbbc8a526f6918917b701847392efe79da4ae2b9ad06d574db3fc9125566689856ac4bd154dd5bdbd74ec466002ce5e2f84031562a918d1adb4a62d237f1920cb29445c903068a1160e8e1e6e3bdcbe9cff6e4812c5d13d30012cdc4c56da932388ea0e79f6129816df93ea9fc0c5b1bbd8392d8e2938dcc7823446d2612d08dbcb92a94b634ff41144d8d73cd2274c455fef88cfa323322a0089871621ac3f72d1982d9b2ec38cbc03e4ce621cebe803ade4735880fbea9a7e9f6f4182a2c16edc6c9a400a30bd7e0b8d9ac5be76eedbb3ad2c454ec4445d760b649b62c43a96e618fee72a9ab93ad2f26d2c7915c4afe83f94a315aefcfcd0e107bc8ae0a5d96d3f5c05647d0612bbfa57cee909b2102d60c47cecbea086f17fd293c7b92f583a2af08ebae1ddcf609cb401a7688ea62b266d329acec9c99879f4393dbc5227265cc2d5d8cf7201acc007397a16e95bffb41b51046cb94f7dab59711835097bebd72c86236ccc704ac01a47b5033808777112d3a0e55bda0f1a50b3f911daf4cc28178db196ae44f658e5f11c174813c43f7d3864821a83ab1c01bb795f3e71a91a8efbda1550a3cd680de4eded53ee8b5da03bef4aebf4ee8c0910f6dae67617b3699ed1ac2f35aa734850f150f7d9800bc8d9a7ead710dbed1d1989827451ae7ad72778fc6317d2d621f78e0596c0830a449154b32b92192726e0dcd96b1c0ef2d83816d76530162e90854bea574b7ac849e0c42c4f9c52e480222fcd7ec9a7aa0a1e8d143e65d02cd11270300578c9ae9dc7dcf57ab24e59f3d5e519a84cafea8113464ab22ac224a8cbb1fcd7362ad8e0773861047b62d96cf7e9414097f8c545690ebe6b3a656ce07add16032dc19e3a6319e1a8f494fd9f3834c45a5f8cc6bc8fd1fddc2fa30cb43c2f70f6635745a0b8b717abf27afe82a57c1cb9b64c079343e5c0e92b48d90b1dc9c7f86db68233e569e9eea84e31f0fdddcdbf51161a21e086a8042069dcd09497bc16652b524df2190a0361224194364844dddd352edc8193d0b757f3bb4673244a734b7a0a84028f682d490889245dd330cf5fb12f53929202a4220474255e9e22f187d5dd0b50a01882ec5d5cc74e45e39a821c98ddcef4f474b4a2d16158f1749c1cdad6f2d69786db0c6a3a36d82088cf57251e39ce9e54209487d91dec2fdaec824ad90c3b4f3f4afea0ce156e2f3da0fad2ba7e4427f396fe69c7420326ec872e6d4551056b5e616b29f3954c383d1007d0765c45d2a520300e73bc0b21e8d7c966834415798146bae6ad5416b8550d250017613ce80a7d6e67b2dc5c51ea59f8b590d63b8364d4ad0c3ed0f8eb2958663c7f0509fb9ad7880e226209486c25087cdd293f193a3f0dca884f9589112250385579fd237bbcedb505dcd060c2d0b41f78a53c99052afdd37a3c4a5b6e01e1bb226aef55aa51ac262de2a086a42fb5e65cce052eba13d5acbd44e9bff8e70f29372c8529282d1ab345221e1d72d36674582af8332bf29061df64512ca42dc7b3bdbf5f0b3dd8aef444ad5642be6bfc2de2f931c460a34c013192433ff8dde4dad309bd2bee3a7c88aa33e5c3634a353177d01a203760ec980991a5d9fc4b4dd77498b8d7886f9af34466a1423250c065d2b993d4fb0f3cd7489af1e277ab400cac3161dc251431a39d37d2ec3f73a7af047d0d1efc7f7518e1166f123b4347ecc7455772bfaef90193bad99f800b53de9b238268aee28b507d34e0d2e1e6a01d2cc97ead85b91f5fedcdc71c18f1cde0dfba3bf393a8d773a6bbef16e3d5609a1824b774f76a37ef808ff94648b9abbdcea69e1d5ebe3e1d929bda5f1c95e47b898e2b4b5c04547701b44c320a845b802ec453cb35e5cc4cea8cb2aa89c873a0116556b1df85aa74f689ab71dda6bae68f88d7e0cb2205abd2ad423aa44a970774fa1818f9b7471af4c1e9e77505e7cc38bbef429804a76c6c6b7e121cb0752af646a4563d0ee24e43416082966b736165918997f36dd0946b3da2e0e8e4fd83e441debd7c8f68dfa48bf3ebca768367e76a71a62b288352a81212fc645b5ea592384d37c0aff4b429f0f2e9f1a7fce4083484fe93bb2d17fa41296cc61b7f137ffd5564c2c6ec9286ddae64e8dba4b441694def0dcebf34e4305977b5b1b521cbd423475aacf5b863b0bd3358798eec225f1e54eb7cbc2b9e643aa306c7c3b6b2e077245b02cbfa558986a359aed1ce15b371b03fa34276224211d1ac119459cb0c796cd993fe510bd9b643803d1f344d36b5e5f2ed68b5cf89de6a60268e899f957ad3a76b1b61a1f35f9d97778cbc1c82f248bd0dc74002da5f7b5bb368c848a51e2ac5d415198a438cebedbbebfd3746ee00ae34e350c3d8dc08b7c407f535ffbf923b68006bf5d48cc99f978bb8d3d691a98e5c786a1e4d2a94e59454d37d32c7f0ef35fd4","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"a04e2aebb4f065114c065b7fbf49759e"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
