<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"7eb580b3eed7cb302cc898d922a95dbccb9483d842ed827f8c3d08210012d22aec7cb1b42d16f2535704da1ad71e0df45fd0ab0e0863a2e0fa3b5a9b39392974060d886532cee35995c8c95253f11b3d26f7f5764eb35e89a06a877708c06cfac167b1f860c44619110b2aa33428973e52b2fe6cea8a2554cf9da0ed4f8388463bb212ee84a0cb1955bca5905989db9db8808688ae31e09d91e058cf8b810055080d7ab2ca6a4e07a1e868c97dcd9c48cda04a6c124a60d9879dc265e71b7b80bd5c8bd847a7f4b66ba83e042b80e2e83c9b8afdfeac3a8f9981ad5a9e76f075c92ffcfc5a7515e7100d849de61fac2d7e3f82bd936f41eb18b7cc0ac3ad78f941204250c3ce3284328055c4106fed865ed724d3d32de5b22cf87e3449e1a838ba1363c7cf7e2f43fb6ba6a7fe96aa089ae0e3e59bb9b1075af6c93e2e2aa93a67e681aaa19fde0a6d508ab21c421d4c0594f19468f5fd89caeb4613aab0482b23b8ae26684d768bcbe2928c0bcb21970b7fc618f4ac9dce66aae05951064304e27a4d61186d34df403060c1cb2727217f87bef8a81d56df0244424f4cde3163d59d7294a9b10a8fb95b1156b2531d5a61b41abcbdb82aa1a0c3644c07d0fe650f0d8c91c418fb60253963fe0eda0937a3fbb8de4ec564f811e1f8214c93450b41cdf1485103105b164063335975e5c756a22adce132e9c2eb5ac9638d58059a4ab06ae6253904c2dce5bac5ccf3c0906ed3409f23acc92bf7618a27b0e0e76ef63372d1e13420b823c562f3ea7a0614167efbb5b2834c3e732a04e057be6482fc99126e142dcfee52098549bcee1d240d247a7113354ec8a15744e2e5a32653c5c2b50c16af9eaf434e61a79b0b3826ac039572b8b9a22f99fe2201a41671a9e591b5dd841a207c36c92b34380f75cf1a97fbddc573ee5d89a5e341cdc54cd52417f6e467dc548d0ff1a8d42e364a30364fa9841418a0f0b2a55a7b6756856131cb8238acc64afa0639de0b667655d9263e24ea9aac2774ef1bab501bd89b4e7ec540873a375afbdd90d323e2d4b0ee99ac81b5b8af9c0581b34805bb1fc980b7639d4af4274a4a7f3254cc341babf43e1f7fd65bd669d392ff3016eaeab58e4cdcdced45568f370c8b0e41458bbbb01be79215785c5bb49bca60084b89023f042bc96498db29162fee12d70f6eaa2222d09a5b81c9a2b7e3d1cd4a3604d3a03696f9aa19d693763141f73ab6129750715f106ec88cbeef2f3143766ef435f963e389a0a88ec4a94d937f9ea1c27da5527dc77db3c1a3b071cff986d4be9fb4b25298a60467a00fcbc54a9345ce12b1a5d2fc5c4c1ef65eddbf1fbd18b509a2a238b471b46711a4d9697d9a3b76328eb589d8fcb18802814d82ac35e46425f7ebf84fa9da07affe815340ecca19a2fb6f046670769caabafc4d2fc7b29f84a53d78b4c6e968dc0a715c3d323da649f9e3c1c8e0a3e09a82d588c7bef54f13a3586d8efa5c3be7b6a5d5d07bf999076ebcd2481c4b142faf2593be16a8669cb90282620d08870e22bb4cd137b7f5159d9a2658d59e94d872fe51a9c33f7b3c659764a9169293edfd23f7a6c6505f8de0689b5e0ea1f6db092b1787638c27aaa35befb6a281b686604b3665493f8e7528c99c128f211a6ff073b13994f1bead1415ffcb484b500fe2ef419ee8fc3637b3cc047f8e646ee23ad849a43db6170bb58fcffc1b39bb95fd3421998fb97fa1e8b9fb576c966c6a7af43aee17d9af4a35e9a65cb5aeece23ca48ee8528e92625a35a575754808813c67475376042f2877a9e189862a29c8b105f870f92a5dca708b9267f766691b77fe95912d61349c7d168066ccf6bec35daf507e546f13c1450f69518f50a3880779bbe325881b810f48bd4944ed0c60ba29d0a62fe6d6902c587284b5d86cc5f5bd34323b81fcb3b7da8127638afe6af2c7cfbf445242c271c4f3f769c9fe4e73b31edf7b3cad9ce007bd5b9595ac00088cecd70a7dd02b21d4a58f41717621fc8e61e0109ff31ea91f575cd13dd3b22f00446229b7c8671ffc484f9f04f48160062329ffaa21671d7f780958d00e27976e2f2b777fa6fd33d42a342717eb89e87d751ea961f5a31b21691598fcb88f2e1212f7f3930076e269a9dd9b79fa603794671e52b7f0ad9b1b19e0d6005de1ced73c6e27df0cd943eed792ea0471220dde88637d0cd821f371ba889bfdd0ce52b268726f6c759e9f80b1f5ef9d3e8d352fa226da975b73351238481bdb7cab399d847ae307b86fb8c4fa5b0587f26986a3917d5c711e19f12c0a8197a6848a1d3399e406b4fd71f496d68b2cc6e334c634a94d15ab2b9f3c2a1066cb4626ab99cb0c1db4b8e0e141b9d6eb41da2e6bfaea55774a6012152979109953a9dbab9bb62a12ae6ca4caeaa2841e92a80844763af5b0c60d73287386a28125f2d4975bc640a30249d7bcd450fbd097bfffa964ac0906376099bd4aae0875f12fde5746d021ed6e4d67e94376217aa4a8dad750c65d768e59c44cb7afb2ffec6ea8df846671922bb0a68fe1876aab6884a67bc446946c4ca5914759aaf26636b81fed91299b4c9d01786630a3328a682f7db6797cb390311c1a456c6d4b12d12cea690c3250e0e42c3fd3fff56a8dd62ed26b04d501918409ff62e5e05946e5caaaa1ada92d7cc5b502a84b9e5d83369a2a54486caae2ea3c1a35a5884b5b89f8ab01a1ac993d741236321601ed6a5516f8993bae4236ec64e30541b4a31ab62e531df8e33323bdc9865bdeb2e851dc0aacd09f9cfcfd6405fc38ba0e22b005e7b9d228b00ae0093363850782b7d1d61100217defc69abd23892396498ebd951f5ae4367e360b737fb4beaa8e4d4406155857d538087aad7f364d9c74c2ed221bd30e0ae57eb8c663b922cf5923a04aa902942b1626f96c3d2af003ad8ea4f9c8abd1dd63db8517f45d271b389f10af8a0c2791dd5e4d36e4471474dd168cb82ac9fe0f8642e006327391e0765e7ac79fbaeea67a4fb6287ad39dd8734499c7a01d3e0a5a2fa846eb92d81c32e8327adb0d38d5cc4342837d53f19f76eda92a671b7f7171953c2dd5aa57a82212ab6bf4658fd18d974252d55a6d0a4dd789371c8fd059f8974cbe17677d9261ba29955aef7fbcaf6e955543dbf05edb72a96d34c7390f55d78af86253b3d2df7e7e208add96825e42c48197057681a5dec280cc74423e554cb6c0ef857c85136a08be1d9fdfe475d164ccc5fe773880dfd3b17ece7a89cb4b4847b5e996e214cc3cee3fba368454f866cfcdcd12ecf975349b8048df87a3b859eda922ec206e88c67af5f9818bfdcee78641a5b63a20e3b9257d01dee2875f63f065f87d647dbee0beb7af0ff83c1abf6f11f5fc78c7e4a922799dbe31422d24085fa1e1e551bc999eb862a8a492ae931e45cb3ec9f39d302637d2099bb07760f7fb4301a34a32db96799a95fcdfa913b8a52ac3e44eb96987e4ef0487a3085fb80695160bd6bf50e599fbd76438d643698983884098c046668605029f6f7d5928ce4f4a7a917dd36a2abe93cd8210f08ccb0892370aa9f9911ae5986bb141ed7bf8a186bdbbc160390e93724b10d81925544a721afd865af63532de6ebfd5265673ad5b57d5be395f524d5d48fea833c9f01100a88d7d384fadb8a6b4dade3e4d134cfb5c36738b6fce3b7c4473429467d4914ccdc779a37f60207559fc75cc9e504af8092fd648f0efd69dc7d8142ce3d9ddc9062414d9aebd40860653b1b45a49e7264929f39bcc6d189d2e538d8986346e3c2d014948c3d5a9965682e7363edaa0c6b8b7d73c21dc869c629de4d3808eff006985996d702c28f99da2b4cc944a1e80de06b275050f2ce2ce5312b173d43cfd7a06f49bc1b646b20004a0ad46f0fb9eed7062a78cec21214758528903be6c36d6c5a90b74c290db03be1e80825641d9a16d77dea33b69f0f783b2dd01e251030db9d580016419def0d1f3e9cb37435d80b5afbb10c5dde2f19762e1cfcf9981cf088dafe7063dde624fe69a4b546788381cf76b27d467ba5d9a2f035454a4dc59d71ad4e90222edddca495880829440dccdde2b27bd02e8e156603f356d1bf2cf9aafa3535987223eb9a811c78d16bb3886e3ed72da897f7c8dd9562cd803ce1a7299230c27f304fb5c7a0bb30df58d19b8c081fa888ae3d2440b8f67555b8251eeaf29893150fd25fb664a83331d237559241c451709ff3cfdecdff62a0c99a881410b1cf27d3574d93dd3eb701161987b8c31e7a7090fde93538e0a443f0fb0efa13a0cef4ab1921cb38191e8d2480ca0418c6db57075dde24ba1a41a62065e8a22a6df49ad4cca2a7a5970a3aba7f9dc4059f8c786a277db201047bad5a7cc5ef78616178f55efa46df854b34b0ace14e09bc91ff91cc8ef8b988cbf8eab75560980d58c8ac5ec65e5f7dfa056fb4ffa255ed18a7103ec317c04e48b9fb6bd2f2fe04ba1a71aa727211619af367467b3053019f8ee1c00750e5de1121c3a9f110180216a2ba3d40fe1c920da2179224185b5463b690c230a0162f99d84e494f7caf4d9dd203fbf13dfa23809e2a75ab205beb0541d8ce59a4321922e30c560f80af59539c4c5e7d438f6e743ea7f08eafe68e967e51ceef75a62e7473908efff4187069f91001642463351d50f0152aa1314c27870b92966fdee07d6391a428f216069772ceb4ac57114e49c3f022706c1821340de4a10f7cd947ee3969be2f615db92870d72c7896579d1203352b262f21bc2bef7e1047a6a26cda295ee935ed09adbedc1fe04614d2c48a8f6841a88dfd68c4b328c4fa713d673293ef77d00c3998fbf743bc0293b5e3808787d3f63d11c96d87c28a02cd34f00e45d8f24f44de759c4b3302eba11100bf09c87e073307448124fec965dee60ec4731220e0cc7a097ad52c5624debfc6ac81acead0b1c2e795be25af6ae208d5e5c064d5ad884085a9718fd026bddf65fb2f26686c1c58f50f7c01c422dd8558e8947c10161f067842ba748987dce19cf1fdbd6dd72d1c2bd67baa9d7ebab4c6c523a885f1e72bc9dcde31697680d57173bd29dd8a93b7a62bf3ca7c97097a0fb0a5d451a892ea22dac102aaf81425764bd409c0e51fcfeea6353ab96bcb1d47cc0a835a4c89fc1de723aea93f20b3118cfde1f5c495b554f9aad7317523a3cac1847334b9447cf08dffd6ec278b15bf497122cc41c9b940bc11cf3f5848b73b4e096990bf0d609256746a061f7794d2d53a775cbcec0850132c551110053edcaa3599099f4e71e92c39071a21e5119744c0e6aac450a2ad5419ab2f717dfb4fcc9f280c1e2b605838ba5503cdcf93c4cd2605122f5961832030c48d6eff8db7a897258c171c99c765b3d7f61ccc8db5aa5b312a865740e811d6e8a87f88e698f86ba83c3cb91b1823f0ca40374fc994658a7948ceb1f5674509e606cefc45617a45f70b925e2605a600d57e3ab7afaf06f512ce4d3f964c42bbd5ce9fb86ca699750eb146a77fcbe61d7b82a02feb9e5cd732822593d92546bfb82f5b695a966cf07e28e79f58dd7d7954fbd15095abd8a188fdd9448a0f6cafd0c6253dfcde00fcfcde21fd5d07461895b63fd0dac16e5ebd0fcc0d8a97e2f0a08347f4578558fe247fd6987b7f52d64cff7c04525ad9fa08f01eb6c1363233d08f2bfb7332473fe2d5a0ab0f2de5cec4d2e37d6f937c6b669f1392ab52cc6b9b24347503cb0c6de171401a74e7ed8db714ba574133c1e59295ee15f1d8173f5ca4c0d5b89188da84cc1f6561f559e4605e804b80eb6f0560b42d7cc9ce5276a339bed20ad2f5df77940908e7af5ecedfe156e785bce65174c848d4f61f7bf756ae6587fb0586d669352a692fcfbcf4c5bafb19db05f67a6110cdd43c6ad62a2b26bd4c01c1bea8e5d9cd87f96ac54ccc9b237c1efc812b6a4cb2151ae9248f675ea89d57fb6482be46e57c7de27f854598b25304f5404690e62dc2b48ea7d799411984196dd8455b866db5f52a3ad291bc8430b093126744c09cab103d395f8ddd56b70ca39e1d83fe69f0ae4a75736d09a5fce1ba47e1f1f8159ea9271a8418676a00a942c88fae879b52a0c97b1995946833b7c94e63705ee2dd76966dd400acbac1180d99b942564eeb368ae2ecfc4577f6bd310ce3cdf2d1d7cf31a493786621ff8bc22d660158c92dee6958f9c3a4d8d17cb49eff5044fc71b21efb73d18a8b40593eaad6c12629b4dc5bed3f191c25bc43dc70bdfe2faf9a95c8a79bc5aef4160a1bf7b3839497d36bc45003dd18fd00eb45a1eaa3360cbfa998c859c22c455cbfcb31e7189a93bc4b6a7865d46a22e44ae9b0505b2be7e6ff68457a6438586eed06ec8a930bdff1c6cfa558d67f0aed78c7296dc14ae7169daac31a04b1a4357ea49e59311c7a7f0db08ba0345ef783861a27df51197a4f284e23a77ba23c953d016ddd18921fb1f4163202a0c4f2c7b3661f443f50296c27582d95bffb02312c60682e47fcfa19ae0f871747d1afa320f20157867da2bdb81326931744bf6a086ced7b92ede7cf3825ebda300f71ae26e70a4a747249260f921c6b33b4163302d07767b9977f57e9643813baeddc8e61c917029312c81dea1c1553f6485092c87f7b701aa5aa48bc132a0aaba6f037e5a7644e07c1e016af7d129faff417452ced704ba39870bfba10d7dbd291108e007fdfd6e66fd402e64bae6ea49ca6747d7a4a58b15e8188ac6eb7718c1b5db37d5b739cd0b543eb5f4b951fabde2eff79f6bcc0b916c1db3985b866226568c7896fe1477ddabca6a9eb400a04a8a6ea815dc1395ae33a58cfaafcb9a166681f466ab0725e0d948462995f2cb101f9a94f6b0f2c82012c98374ec75874117137344c4e9d0e382f403f9463499783f8bc0085dd63fc2a9e22b1ff2c82f51d5d963575424bda8f5ec689acde59b21c493ef20318976e82e991d34a22a683da701c0f766c01b589d6c778f729eef59a531e76107e276ee1131f1e512135bfb15cddbd7c2b8363ae9683056e30c772001fe1ff8936fffc429250ae5f5e58d2f6bab32e8d12c4a619d0f2805e0c7effc9dbfb92c78384c352321015d635cf9b3b8fd318c9b8387f5483e6056c64b2eaeff47d74647d8f09ebc38c1303db36533dfa648c2b1c32f303f78859fe3fb779956127935a222be744ebd185593b48c39f21aebed4062afd0e77f6cec0bee5be2ba7622ee0f1369d59fd5415e04e6cc38f43595df83f0d8da1eda7b127b4270d097150ac03b77ba7d3dc5c1216d5835e88f69c443feeb5fff0797046d41d5537d110fece24be86f3cff024390ff4ac2d754b01318f828fd4b2013a4f109e38ac38c7763804707a5fc1407a4497ae575cb4224b713aeefa53dbce4bb5428ee057449c4712572ca791574c84753dd4180b9be8cb44a4afe9e271debc99791f85b61dcaf58f679aba6df54068300b9831931d63bcf6decd757c3b6e787cd55123243e13a1b0f55b93693cf06c9a8584063f1efcacb1555af37d9b6c8a78f51abb605c367f716ef70ee19bb6931bee1f88667ad5fd6d7d9227d9353226c6c448ea91e7eab7eb5aa8df40e09f1bc05103f7448a9cead309e946f27217766075ab8ecaa44f03f2cbcf6d3c9b441971cda2a0fd978d34b29af0cdfe67c7bac58fe50f6abba0b07254ad86602a69017969b91c8cdf130d359e7a756fc47f445c4c2e91bc995411fa62b9719c20dd98c66edb71e589f4644c56e3b7584a590de007f8ae08df99711d8dded53c5cf5baa1482682836c01e5d6786201856ab2d424ce5d8db7f83c489a164e577f239880ba9255089fde0b931835b3f9b2daf064282f6b440f7258b5379b2aee9f2e65dce28a6702d9c0b94f9be4aafc4fbf840a08930cbe439f7485ecec77b6b66e9a5bbd6b6009d1ef5ffc8bb8bddbc7977a0035cee3ff3ec01c02b0491bb8a002cbc798495d8240ebbc67981837655beba719d3c703227b6363eee53f8a3a653be3eed6d1197fa78a9e1255d219a3902063719982e3225285f8ddd6fb36949d335f041e84d2c94c94e74287de7af6465830d59a4bd0b5a9cf587b344d551ab133c40177706bece905874b4618d63728c860b5cc788353b4f92760d50a3f3c2b7ad2f18cdcc75b037ad49d80939a38f5b3db453fc48404bf0b130685c1348672e4736f1946645df5bec5ead0b2f0ae30d9a87f5f8d37f89b65caa2bd8e63608aea60e0442fc1a1b255c6ed2e5a36aec8a6f522bdae30883c0bb5928b4036ff4620a1e7c6b121f7551a7d97e34dc8efa3aa863a14e44cff63c2cd14e17fbe6a4c0cc65a91f4476c250b17a9f155436b610db63f1bf2c059269c13101a48effe39d938a0205dacad4dae18fb8e3db7e8bb8fcb634e39528f2f3a9503cc6344e505924181c0afb9a50602f9620248e4d65092e9c61d3fa1a1347a0df270c90aae81ec58e29a51ff5efd0b415d9ad3e466bce19aecb04e6ea480a8a8f9e41cf3a85cf3c4e55e797ac74e626a8e7ae1b3f26c63bb517a63b91c705326770d664ba2b5376585c409fdc7cf2bf4ae45914fb6e08d39faea4498f20f42e07313ff3da2eb45cda0ecd3c97c96378ec8976cc64dc038479d08a20a0b3832e0fbfc2633f2a8df1a59942c36f5e81a308ef68a0067baffc482fe19763e5f19acc23faef9d08e3cff2f7ddf6c4425047652e6acecc5f26c4e613c06f601d717c65cf0cc012f1623451b03c57de05095de4414f686584ee71a0484203aff4f83d36bc3dfdbfe8623585fbe11a1e2499e23d22493736378797204587c48248bf82b4fb1b9ce764197c1af09fb97921598c21031890a58356c1492c3eaf5eea0c15689bdaf2ef062a45b939f1d699144cec6c2321bf4415006a4864d25ec331213cf11ab344153953da217a3945f5fc0f8ab23e691f64bbe2be84f03436a9bb83fdab680fac8f05c3f035a51ae2bd8ec3e406d50f3abc46c041f478f12af91816acc1f76dd85e4fdef6514d040205daa9e7de4afa94f249df21ae3c0d7289d0000604655e0bf025dcf5b964054fdf25680546388538448ae9453ad4befa427bbc08fd19d006a60216a22598a1460b3a66dcd458d3382e757fda6c680db205be3f189da2f3115d7e43aff932c02ef4fee097f926c1673278f18fb7b6091ada6e2628b6dbc989f502708955fb5edfc2ed05e0f51cf1c3ce7aed4dea4b3eca1c7d9c700be128fd45464e31e53131a05a7de4cfb9d3a6d65edb11d017105eb5842b05c84da8ad0ba4379cdd349f78087006e0f616a392255c43305305a67b334198fb004cced5c4f7ed5f27d61c8c62c602f920fa1604287fa90db9d16908cb8f0c30859b714388262c960704fd1d316d90f67bd841ad9ac7140b1d3db4420ca80e07b923eb28b184c57c436f64ee9e8022d6b5e674450d3cf5573375ad02374882911d9de8f656f83c741c142d202eafa4ff32d9b603d56d1e8135ac818b7aad0548b7f3a00c71eeaf088c69481749ffd7faee21e0aac5644cfd2e254cac3e99ab3c5f448c9afb3919fac8bfc57d1e47e9ec2e94752d23fe298ebf26868f873ffbd9bfe35c4f7c5170d3810e7918850bfb77b5c6604b9729ae1de46e4a7837352bc33574bee85263cfd9f4d73091e2876d3321ee8514458c80f916fc091eab580d80aefbdf6314bce5939c4ebd65a88d45762510418ee693b486f1148741c59a29e0de02762122edc5c9a6f92a392800bf449dceb6fcef502d98bff84d3be2d8eaaccf29fb8f97d55de9af8373d1f45fcdbfdefaabee72df664ec8996a1f403d5b52556f5d7e3537faf1dd8531fbd453f6f401ffbdd17859e2d61df7fcb6ffda58363b5fbb20dd06cdbbbf804a69e9f961fd847961084a487e928b22c9be7c803c8a582b33e2b2d02fc736489e21d29275116e6854b6f33e36c4acd51cc4c8214341ec966898497e4731ff1d01a9a93747e180e9cc68d3a14188d3133986720403b9a5fd41c765f4b94b028d99a86ace6c91867c64a96eee0c8553717791a24fa55b24c6ec0fb9a942391f7cbd94fd66dd6b66cc18fab54ec0ed346c3f97c518cfbb2f2a6e03bab835a8a33949a4db8bd17a726503ece7892c3afb4f737fec4de48267288a7e34e0a141166b48978b5c0c9e1aa2896f99b94d0091b1e90eaf8216e5394aa89d01828712ccd80379d3f0fc5b921ecf0324ad29eba5a9c018f60cf64dda1b4dd37f157ebfe02440d9e009aeeeed5bc4d782331936652529c15e054f922101b9f3c6a065e59bcfd7114e0dc72f54641d59b42d6220ee569d58bb066602edc014a1c46f2ee937a427a7f1264b2d7e1ce2064200fc317f40c0975d44c89af895bf49b9dad3f3bb9ed0fc9def803a21b13df43db11b602d8e541cb3d968a6b8113b90bdb67ea456caac9f0500d868901523d1a4a09cdab983368a7244fe944aa8065eb5715592965a1fffa8c0cf494c7407f72a8883fb93123d2d51ab808d4fefbbfc2f6c46c2f807c903a363d66674f6007973941f2c3062110581ee98130773bce2a25d4ebb07d0ae202f28afa73c793b22b46dbf8bd6da5c8e75108ab58f10d780dc3424ba16c0ecc157505919445ef4be4eb96bfd2e9492398a45ae440e54f5541e3d3a01ec66c850266b74d684a8139f2c398e5edf8f6a546c7afb2ab5dd7945b748fd9cf8b133e4822b121ec59c3f0752bb2597b2fe4bc06a2c4377ff9ecb393faae9142c9d6d38d57b5001f116079eabef01d92af353ffbdf14bd002335bb961289b4207f52fffeac3c8629947f3d7aa3ed7ec40fc17f82e6a8d9559af2c1b32ab3b3e56951e1746672baf159c75542b362bad1b0d81e5e74e907e81618f257c3345cb6580e283162585560bb72c0c48a95831158be509b0611c53a21ac5ff5c49595c83687ead500d6ce7b855477c07101a62e1d2238ae846d934aebaf5a682634b1244be2e3609cad307ef23f5d68ea6a8d2549313ce88cd4b15b10584e8954f103da83f9e724a91bf80aa8d7f89149436b0f9aecd62da7939e9439510e25650c1051c04766a2bb825d52effd1397f8068c8083707093f0600a5afd5cf287247c89e76c79de23d5af5a7583f4cec88d984234068ffb5e021cb9c5abb108bf19a522132369f2a5a4b8022673821a2bae5dfd52c109bbfc6aa1e192cded87cd0dda2d8caef4186ceef7a71c250cd96c99be1c1174be8bbc5b3b2b44295430e792a466be097f9e198eee45790243a4d3f3adbad5724c3aaa453daf75180a0bf2a8e113542e4fa52581dfd1ea3ef27651cb7478047ff7c669715987b247862511006a3d6aa0febe0d9a342e6d166d38b6573dfad296bc784577b0c5a73b547a2858937631c4bce7ee3d2695d14761bcd699be5d9242c7bb6d554e2eaa9d9a832b7d992427b686617f2f9233bc21fd8180f578893af1b6247574956281ef0bb8a18d81bdb30939ef371d11c49deaf02a8772c291e2aba8a445ce4ae96bf06f6f3b092d7f93a54345ece6e6ad799ece92cfe522aef7a1624d782d73e2b3e43a2e425f346bb73875edce19372776decc3c8dc140b9a8e81fffd0a4e982662fbd50aeee7479717aace7d86fb8f5b8317464833f9b167ee33662c98b661c0a577375726e4e41a5700754ea8e9516d8bd0d8452b0f506e940ba26c174f1399577aaffb89f1fa6d1d98fcb46985c2cefce783625a943d350b6ce082b1981cc91c64873b12b4083d163efc4c2b41090825080091d1e16a29d6abf93b72291b72eb0edf0b6c4a2209ec37488a5784758aea7a4507dc8d93bce2d41c1da7fcc38be1e022e815ea1cbed4dad037816874c84c4012825bc96fc48bbc67fd94c3056ca6212c7a63e1746228c470ca45c728f443159c02d10e30f13dbbe85ddee5cdfc174a5fb77755245cbe03f128f2a0461018ccfbcbf365e4b586396952094e59af89c2319fdbecf799702d325ed5c0bb342a6f174e1d0214b8ce10adf6ce3c5ce7e8ecd28aadc6b24cc7ee1c6fd270f202ef1306a6cb2af3b887b3aecbbe12ae73d8c920cde6c43e4226f7081f763cc205b2125b542eaa7f5668287840a58329bdac9c95aa7649587af1841acee5eda6219fdc0364301d46804af4f45d8165c4436abb1ca074794bb7f18ea3cdbb2a1462854df2d3564ed930302dc930104bac7e031efe6114de02896feb8213b06e779ddc72a37918cdc888c862e8401bf14748cae792493a8f39ffcbd8318daf9cd4aab224f84d5fdd723f2f3dc5b533e09ebae36a2e4990a818f8f0dca7cea20d1f7e9d4cbc52065a55b445e15e5af44af5c156a967fce56a9c5397488eeb8925fb1d2371d9b6f1b3ea263c2ab27679571abb0bafa6c15dd2c4cca6b31440b943a249787c7e979236e38681393ff2510ed966628aa1efa3c65c4792b15f1ba8cf7c445fc3c05bfeaf5eebeeb46fcd96ad33055be1f5a0bc0cf1b67cc969f1682a4a1fd96446ccd51989dcdfe953de3d24ca4f2fecb3e6ae5c3842dd1600022a1d441a16c484f3bbb958adeb6abb00e3d9ed68c34e066ab04a357a03fa16b997cdb7499939b81541b3c561fc44cffffe33dc84e000e1a907fb487c5b39c10013747cbace5a14b10b8b685e7d7eb8b0191eb9455039978bc441d57daef169c0938be54bbffb41639cad2fa03b9d2cf3111856e2d52ad5745156b761132b8c850f04a27c162edfaded70959c02514126d54a9ba4fc701d9fe028f51a1542e464cc3f61952c944b2248a60ea546cf71124fa5e93dbbb291e499213b049512a2da064cec664e61d6c860436c9ed801243840fdbd9e915e5e0a52e0fb1aeffadb70c2ca734164f873b3831709bc1fd798fc7193dc877ed2b078ca46ad4e34b1584262c125c9dd9e3823284f5e7f957fc8c9fb1ade3a538cf1bad8ac9115f23ce27a5a892c03ed74ac6425f42534736d6f62e0890a6d50e933932f96f8420f68d5fc6a0014f5fb09044d53a86f9ca43415098f5c2efbf54b6092e3f1ac0d0e64cca78198d9c40058a4f7f42af0e5fb55862d925ac385fa55c3c745000d8ce01d19fd86d6876f4c94f5464b7ce5535b49240dfb8ceac247116de6191f249fa160c7eae191f1d5c85fef96ab4178b15bbfee990e053572c21c6d97c1a3eda92b9512aef94e54140b9dd730bfd5aeb1a69a8128f56afd7b101d95e94f8350fcd80b425e9e3d3d80e6a6f1d72212424a12888ffe2b85c0e5952df4b45636f13bfc4ac4c884d2c21e365e986271a1e7abb895a735bdd8656fff06249ba2192e7f1ae3041f48f8b03b3fa2bf4a8cbaabfe3d1891c96dc2daa2ef6fb39fce48d773fe429a46f43e048d3b6179116787400f9e76807d680e0090fd6b7fe1eca39cfc12117a46f312ea192df905564321483e9d3e3ea930cf0ea05375e0f62c190a7f7c19352e5515c0e221782e07c95b28c13f821ca45846ae9af58d90e5585ccedf71058a0fbe38d0e1efbf80dfdede387aaee81bb873e3a8b8ca715b6de482f30a3a707d31d128add136978c864ab6711d1892c8d1655b1b43488042b5d9758c43851f0c4a6298be5d01e7b45d4c91b5d53892515617d25c5b7b9d66fd4f60278a8763e9c3cf4bd6b8592b6e662ad9075c9d9c7527c4cb11d28f241d6414bafd0a4e35912609c0b4d56be8669eeffb80da49afb1eca0e2b27403678edfec7d182c4397af2cc56991be8a72dd9c4308ec3f60980b94ee27d46c201966b65ad8c4c58de7dbf6563b3ff1972fef3eef62b4c02d36e27acb9ad38d321250201c6c0ac4d76c5e3e31a35821202182d709c30183455650d83143e07607c095ae3571bba71e4856847a727b30be761275a5263b83bcd428db64daa154df525273b23565fc16df6fcd064e34bfadacd083aea83fa432ac5a785e8cc121a86da0bd1c6b972713f54261ff82202715f1841430fdf9d355b41716a94a71717b7ba55e3085ae3498c78074ccd05b8877fba12bed289cd0dea6da378493bb1e8de0d52f9528993cd44b5d60e168fd19e0f0ebfd3b0852fb555de03104ef5047fdb1b36103a3c1dd630ccd7cadcbefc9d3b297ea961ffd598b5ba11afd943818540e4b377024382306407a78b60738fd59f9d8161cc5372abfce2d4caf4e50fe14824ad709c771973b697887c4a9b80ec61db9c5b1d9031e5d5828876c7d1bcca190eae4610ae3a5e7754e285f509a8da3b2c60ffa2be207ed5043ff4e15d77aa88035e00ffb0980b3f733a9dbbc305facd9bba4d1722f9c0638bf24c43a4cb10377ddc9826b399f9dfd7cc69d39e0f8496d166d6f115836226860a0695533f1c6d452d1cb015aac67431080fc6e9159b2d8ff9e8d2e8814ad8e4aa18e294232261eb5c79dee48476fdcf75e404a376f554329928ed52f23e3d7afad409728750f0d1a3c7b52e083b140944eec9cc887df8cb63922b2b731ba681e74a90fdda8ba7f21a14c32723af24faa167d03bd98ceaffc7a0a3e3889f78513b975ac323fdd1e4433636a7341713f191d591d1dd3c252eb54598df29cc25af15a68841ad09ac67da93388fb9c2cc47fdf1eef3805dc91fd5d35bbf4accb3678de05994cb88008ab35437874af79267049b7c1ac0544ffd778a5753d844530fc908d65757362b3ce0fa25c9b1ecd1f629be0e2a6c605ee7d8223ff5fb31719ea97390e487ec1be1368a582584adf8ff58b044842cebad2d18b09e2e741d281088997a95f9db27dfa31c8b20123bcbc18cef6d1e167b7c027241e4473999575aeba6512ec7e88de09e631a5936bc98b2136f41b079a8883b2c00d9498663db7592834596f027e242b2dc85577d1442405b693bc5a5d9787bac5eda7d921d8b8f41b54daa901bbce9760ee25ca722b7d0e5996f3a80a160618e462a4ce7fa85bd1d39887f09f7cd18b48fcb9f502392819c0428f4c0d6d5af8938f6e105a21731875779699ea5562341153e324b0bd","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"db2470865aa068691185dcd60d0115ec"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
