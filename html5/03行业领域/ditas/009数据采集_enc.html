<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"a5ec71a45ed7d159eceaceeb3afa57053864a90d897362b5ed01e7fd8d9e94e1568754a26a85c4aa8166d256b8bb788a9aa28033624421e51db1122b8517070a12f9e0c77656564414f6e6abe388d73c48c63a4c774feb3dd45871ca709ba524e075adf89445184056c3087a6cae3803856ccfafc4586085b901d3f82656d745984247f6db90cce37a5be6853c6db141853c4f5bfd71b64404bb67a994e8a5ce5108db4a22b5a786ae22f98d03991f9ed03cb9a3188d336561cbf3ecac60e12e1534804de96254b96155d817b0ee1e943f14dbf98395855344040cc033524ffc2afef94afada03a3cff58bbb683c3ffc43dac9bfe74667ecc80135c25ff62d5109b1355faa03c3d2b9562788cb7cd22a2cfc09db4dd9f84e966543164e74080025369bf2642f8b2f70db7aaecb12df55f33dede07cf3c8c7243fa7d7ea63f66c89b622b040fde7767974aca97f27b35257d2e311093c1df39d1d4b96bc2efd156761fcc3419a184be8ce824da4b0a7c10c0929fa7899041af5a512ebaa4642373b2c9ea8cadd0d1bebb722a398eeceb21f52527e7ff6ac3b550042af38a2d3e205ee0c1f9fba7786ddbb53c226f6275f036860b7f91067c3541b5a1bbe2dc16619793d0a795bdb21baf3329a827cd15574924005d2df104a6a28702d856c88ae250ce6be2c44e34a84324bcbd77308446734f3d785caf5caef40b6b9bcaf90a73f74af280c5a508556076951580f9d07c950a82d5aca777b3d0633cf264f6f381165f7a4513ee4fb4e80b19b2daf462bdf84389cd3904d1ff5707cc7b7e446473a2e7f2e0df95ab30d126781cfe083ca95cdd1baf39dfc0d17812900eda9dbbf047238a90ca43f2939d6e9a4958b17e10e47f7d864e7615c437f7ad6fd508a45e071e3cebd10f49d62c309d253cb830a4b1ba76542e51657231bd4628770358f3696014ff44d7d03b26fe69e7e478cb500b61964686685f376a00375575b6b7d226f9ff4262399ecdcbf36fb6bb91b2e7c2f9800a53415984aa24fc467d0942dac9abe67adb6b2c1bdbb4b7621b248f56f0651541833776f597269e5c2c594f3a83567426fbdcf747353e7eef2ea20d9bf04143399be6327c9ff3333ce080e6e7a4767180d639b5327b1a561ba48661aabacf158603d7ae9368edc84dad86e4216a5daa327a9d692c28aecc7aa3fd4cd450b9930cf4fbcb1d7412071d652bc3e645b078426a6e01efbc3eda55baf84310a475ce8976121e5ab376053579c998a7333c0cafd223b31f62a91a9dbf1fc812edd47b8df2da1c3f388b0c5fcecdebdde71661d8b0b914a964bfe45434f55dc3bed5f85d566eb79797e48cfad00de15c8160120749ce3448b53e04835a0509e1743d41450cb4e2f9c3f96509a528aa14a8a2f9b554864fb092a248c7732d1c384de0633bd160c4c77aa029c7b6608d1d9879fd13ca40ba45e755e2b3aadc301e98cb8a8fcb76ff70018a152f9771a3b33cf786a6d729ddc16d9b320ee10fe9b5e3dacae7422b894346d682a4be2ed8f17b06c8e4db0f81174d8ccc7178af3e1390c1ca65c5da612460a26d4a0214067a6b4ff3ef25a9d3e1432cf01550f1e84d7a655d220c1ab96b9cdd68ce76294fa4383dbe307f2d6daf0e2f8668491eb2d72ab4e4dfbfa2942355cdea0abe2f614f9c9866d5727b4dd586db2aed3183bd50050b7a3ebe6f0abb6f159136c2c28f0277a63c9253600355c08c26fd6a8e758d3cc53e61efe9b353a53a055776fdfe2dc1f1d48fa0f12df75a1d8fac5fc031e5fda2e19796e2434ff06054a622e426c0c1e3aaaf833f328530f728e0a58930b5f918fe4a27ab6a48bf2c0402c42295b0c57c7955fee61f24cc5f5fb5feda20618eaf67eb86176c3b55a5d2d826e0b08ce577c354563582aad069778d59f5657d29c24c73b9bb78c7b0b02c46e573c25b356abf983c4813694f87b8e38f2be69f79c73867781a097590fcc468e95837923fa4e4f1758e37e461306d69bf27405d38adf2821fd3d410dbb54a2b343e7a2823ab6945f99b7a155003cc5c491896e912bae68ff2d5ded5fa46cd99b827e790f095638247b17cb82d7118b37a05017008387c2b6aa207af33489a6a3b274fcbbe600b7fc6f915176451592c7330008693b2e7b037b1ae9d2d9f6bef64d93d48354957b15e3b40f94e8ce4501d0c92b08ffc3787acde801bfd2a233f480f72effce74f4de50f6e257c251548478a79e4a23a3e666e8aaf89cd17c28c1f0ece0ff2f097d06b7244929f420d64665bec06fc45344febe7b3a10364b07c8e95c595d8bbc5f05369847c27464f14a2816a57eff5ac4a226630928770a8a3eaac93c00f2bf27a9e0215837514cd7bcb7b4849d0c26694476ca83793bea2bea120dd23bf4228c0e392a6497cda64fb2e8e49b125d3a04fc8c5b44cfa8cd1f4305f96d94de2793ac4e0c23e753295d21b22a5366f25760929d43a687675d2bb8984b62877b314d54c6b10aed26f547cbac7d0c9074b8415cde51d80cf0e026acfa870aff03a2dc54014064c99dd32a7e9a1640a0d69cb64469480c3ebc1851526485524ce16663cb5d13c85e4849db2d49dcae080e5bfa108991801d8bfe67c2bc2abf61894e531cead9975decb7f7729e60fcd5be62c42de92575780c089b937ff596b059b6bd8323de15506d372f78a7946987bed15586a0c2ffc01b1aa2b5b432afa50e7f9aae01e31eeebadfe4aad8515021f7c58dbcc8ab131190a21b420ad6025e4d4e7ffb4c3af4d6a121091d49ac1e5ebd94d54be4b698071e144b21f4111ba8d505781167a967082d488cb5ea4427157666dfc681d91b580ad3dd589844457db25ebd08268a64f4bed274957a396dd3d4cca1aa6fea5158ae77a0723876c0a2141f3c13160f96fa95620f0814a1f105731def90d760197fe9aae9b71543665ca66a1fbe3be8db1e54cdc0a0e69496f84bb88aeba8b8930f732d8903405e3859b648e542c24aa86bf3bd9edfc412cab5655c70be02603ff7456e520557f7537a5f62d2ed62fa62e8ec81c0198cb3670f1c09a2d69d413b1fa771dde9d0d7d5fa2c78fe014715a482858ea13e65d6169f7bc3b89f9f0bc337b89d9004c0c6124314cbddf295d291be1b28d2dd64deaa8c4791f3f21beeaa46b40c281ebee72d661a42e751655ed6e3f19a59f4e91814fea4639de5afcd20995e14a4f7c60704c63330bcd73e802f942ceec37ff16a102fa499c76c9accaf40a92f600727fb72bbd4ae626128351038bc51d92e2286089757b36cd639ca9a172494274eaa5046b2cb794bb2a5ffb5ba0f2b055152601395631e6ba17756edc8638f72f6e9c2ec3874953dd089e4dbd873d3cd8d3a598c3c22ac32580b4ae1d942351a3eb588cb985cd7c6e91207071ff92082ec7fee025dec26487bd15a7f7435925a1bc9ed009057c07ce9f7b204d9c00869e56246c87c7bb2b90d8c49f9c4f78714f30c15971f805f165e9d3595aff4fe292380f56040965c7fce192667e3ca9855331932c867fc2507349b10b2670c185405c871d8fc53e823092d5e01a6fe1fd6c033e067e588eaf4b5719313e159fba56d46d1d98a21b45ef029685ece9b1a8202b5a47fb090573abfff5e06352fc4a66ed6a7eff8cdbdfa491d27e3a35d954f16a2203c2570708e01149c5c2a9f25d4b3db383a2dae87a60ce9c4a99240bec492e577532f60a4864aca9b4f98357ffb0ebef9c648ff9bae4d541923ca53fa85f304616ce38f93bf74620bfd79d7f7dbf484fc7183404ad42fbb696b0aac5b3298bfb11c50eefc9d3ba9bd41c6f5d1a8ca580048100c26460b2686d1edf109dcaa7136fc6e1d0cdd4ac78d4c1a5527456535499827ca0dd99ece6f042ebe951c972b3a8e990f4fbfbfa056e07ae6f7edf44cf0e138f9ad6925b28395b29b0c59f9da008d9c2b2fae283d108c55ba0a2d0f96d55ff80c6b84ef74892d6a07a0dab48974998dcd475a9cd420de9a838c184e500ed8bf40430fd6a7d9061a91bb7c2cf0a310c5ea8a2e2d7b816b541c9964248bf06d1ead28572e096a9f1ce6efb7c6b816d5790be99455761a992a3940b252873b290a464652b6c1b21495d7c7d93f6fb332023679f372e0fd898c2e6dbee3cfcb29ea3c505474003850a6bbb3f6c5bafab88f640e60dca6ca83d9dd4b88bf707f5ac99dc658bf8bcbaf94de6b1a63ee6cb21f8c1be07f36724abef5d0dcf3e093c594bf72d7834a92a3df71bbad4b0b62ea5426e2aabba5949836b94a53950353ddab731777bcc79e727366123d509f542200fb81cd279e5a265fe6fa45d44aadc13d68136bccc895b978c625d829f00b2ca83a083f50c82ef80bfc3e0cc3b29b30e9668b9a6b5cf1e27fa2df7f697a08ecd5b84c6888309b864e8f8500022dfe3a9c7b487068c1736d5689b4a25ee60a3511fe686725c1887906e6fe4e5d031119784bcc384d74d9a9233a91b2955edbeb754457b94e42bddb590637ef01d390be379ec232363dc048adc3b203681e9a818091d89df7a5a3fca2aee66e96de00e62495425a74c9a21ebc69b15a4a0505182816c4b4bc2cbc6b90cfc7c6b5313f1fe3bd419f0bd89c61f219c8ee924a415b81d20cb7c31db4742fff086bc3250c02760f6863aaf7e26d9e166630820ecd4a72d0e45b48397c0a43f61bdc62a7c11b7f837d39d2ed2e9b626985d1eecbf39c440338aaf319a7e5b471d2e38d232d474e305f5558679394bb2b0d0726966dd0ccfde30a93f18a82dc2d3844a55255856afa45d5e62b236782f15626cc0b008f55796744c92cd847e1f4087a9aa5cb2d65fceac1b298896694a4903feab1deb04061d7483599a959c5f82cae43b960d3b66229fe305fcda4ce3565c11dffefdab7886a39efbf0a45ddf9c1426b47ce62d4daefc568b5917917f48128b775cd86dc7c9a98ccce510fa19874207ff4f8088373bf110532825fa5e4820cad7270cf2e4e522062e1cc0d7c6011a6a84801a2c904694c4c598867f65bf969d1caf6831808436782fb604262c249dd335c2dbb4ab63978c87c33d5ed5b3287fa309a00e109e1a528c7b6439693221d3eeefdcf4fd5f1e266fa21d983f3c01dd648020528cebbb8e5c8015ff8097da4f24e21c93537648e7b023ed7b903de9d1e5165a8f26d0d3322ae17c634c0e03c308b7738027f666acbbd695fc73c7baf574cc55c36ff2a8be40381cf3067973c6c8f5a14ae839b168072b1921ebf20cec4a59f6de2cf05540104d9ff108218f6426eb7a63a8c1bf40000d8697ab20ce6ef32e70321ba2301476a5283568c7232ea857945b50a6080083c794ff32a678b1422806feba0755ead0af588eb4e9105d397682040d121881c94b80bc546d1e2d80735f97d3f13d6363c7b4ec42c8ffbe64938f55a5696f7523724367a0d9aa39fa028e92a1676b9c3fd0ce4e18a6f6417fff8b9cf39a1424b0a30ee53fbccea0ef6bb0336bc5c13447006717edf4e44964db4c856a8a96e905159911864deba1812f6f6e569f93b540fd9682237aff25b8a6c83d8ea03b754fc1f9c6aee068185909e90320cae17286b4f34650e6238c4ed5194e12b8c3a38dbebf9708790767c345bf5ea55f90dd6912843c16c6e64c279c4ed8d869df83b8ce27438d4914d76286e3b7be12da0546ee8dac52404da9a15baed32176b1421f6eafbe8f86c0fd8d2a849e05e62ca886772581dc85339cd8c4cc77faea4fbcb3699cf0e7dc729ec7413a7a1f44b115dd470c3eedc17492517ba7bd5d271236676c732a074a1bb94b3be3fcfb77592aadc460be0fff1374c4bff20110147220d04775f72c59bf8b981c7e5ef5f33fe1c8c61053a5c2a1b73624a087d8b453d93704f164dde1cb2082ffa3c80f3a6b8590986b505ef8757167b48c388875e376b8fdc6fd7c63f73960769e3791bae1a50d41644261260a3cba7641d6032f313aadf8904dfbd2b2228655eba2e784007d5d74dc1ceac3af74ac5ee0d19a4a0f7ed749f7d4f7deac7c6f41b856604781069dadb3cf708631a97b77aebf4beae0deab888c51ca6b1b030d71f1a9a1b314fcb369d56ebee8e6f6a6398e4e1921e1929dc5b0ec82a467e32131e9492adf7387a6fe162bcc5390ea4befe3229bea92c06a11554ad1161d41c93b0f2a0cce8a2f08571b1861fcfa5a3f58ca68417d3a1ab833c7089890132795373f0059e5d650045b98a1dfadf536a470b7f8f9d68c0d5e760c44951cc20b5a461884d82326cf16a080a017441c371498c72aa03147843edf554f9fe4a991775f3d5c17db58c474464fa9758210761e111e22fd6424389e9830f1f1c82b7f23bd80b41b4623c9cf15de1352d6b80ad6f32115d20166a5f081a95e89786ac4a4d1a4c60c93e65819f81a3a6abdab43d58ceebfbc8f424000406eaf2014775f643a1ae79e584ed2398d9207b81be747d6b2cce5b2a5638dbf67c8c6ebae29a6c7c281a4f8a47e96303bfb2b1db8a5ed093c06c895eb31cb356d471a9cb8d805a600536dda10bc346dc819a9db84fbbf5a9d0c13bfd9742a2fa1a200a8f685364baa5b61d73a902cb5654b5b9852e8fc3c0ded90c69444031eebdfd006d11f4d9e5257bdc8b0046c7cfbc6dca064904e9d25ac5018e982a984981a1e2e1c31436981ca8dd4884db90649451026989c05a04a43f59acfa9dc45b4a0ba112ce4bfec50e202df6f6a1c4a79e2effdc0cc336fece3163f568a4f21704dfc024292cdcf77348790e2bd3dbdebc99f5be79e61ffbfae8790e58152134afe1c630d95501ef72e9b9bcc142087a515cce2bfb04bff2e05c2396313a12b2f44f6be70924274e790faaa3a6bae85c2bcaba53d529b2f60ed25bd48fd15974f645bbee7beb1baf64e5813b9ab1e0005f1b626d461d6ccbdb801466511bb6c97c6d64a08ae7d113b7aafe37a20158fb084e0c19220042873e6f276d1ad89a800fd50e423c8bd0a8a5fa0111275ec52f6d599b7a05734e7f9f546501605af9a59c286d53ff83384b9a21d796a5689ce6aa4a94428f1c11e2398248d8bda02e65fee1168e08a22192bb2d3a1c1982c7eee65cadb57fcec4552c5e890a11c1b6afb04a4021def8355476c03186bea5ac013faf582ad9d56e8353e8ea51d5f0a7c96dd559bc5a8ad1218650033ad7ff8d879b49e890a4b9edac99248c982386139b04189058c6ad6b7a5d93245add8c51ee4e118485844eb1debed5b823887b135917f76b04d954c642594d21eae45e897b803d3398d0a87903ae74ef8ff9844756e87b502c564cf7173f4ba48489769e2ba7a1ee75f939206d980dd4e64eca70fde5657a4dcc499a894aab7de2564e12ee5f00bb62d8798960fb09e10e7e57aedcc526fbedf2568aa34071e26ed7b61e94a6154bc910c6ed6cd0461b33cf7391325080ec9497adf3904d322fb7cca8d62c27dea0fc2b0333033276d4d188164d234f905f0fb7c1ca97d2ba6b3e40c70b4149fe2618b9ffc54a9a140be394b05da6237901bafb637839b882f02b6f7b616da7d5dab6b73747c5223f46c3dce26396f4d59e3c6a415eb05f478cb6f9216209a6b9742333a2ab05512ec9d96bf82725fc93008aa3216c9d0864083b39a39517a1fb7dc347f47ab2c40f8d5026749d2eea2ad60c658fa301d38f5a5a1ee479812f928b0ba7d644936938be60aa796be7634477678ffa317d7c4b8ad8062e9e84a669292509efd3795fafe4a02fa802cf514782cf77b41bafc375a785a6eae85b3fb01705eb80f6af71b5abbd4a79a95850dec9e08a0169ed2ae030ceaba898dbae9fe808f786f1456ec9247a2667b8bf6236f2267a12419558c008cbc1206c9b32b8de28aab1cd03394edc8b8a5be3034322f30c88b58fe0e3c8c44d5e75f225e6d3fbf59420c87353c285d2ebd134e6676c778d26b4568fe2e88313a47b4134482e9efd0671471b3d6b721ea1fb22a997c427a927bbc7a3000a35eae9a3ea18e7383e7bbbf06f437788b51b9d5bcaf32ac537e5876780708384c3be1b4cf96fe1913a9f73f7fe29d062acdcbfb875d739c6d7dc908a1ad088ed018372f8e23a4c77896868cd95063c68a5ebb4a8f250be91eb3bae167a7dbf4d108878e51f48fdf27971b39b9d5e204ccfcaa1d2200ca6cf62b6f14921333e40f907eca5412c457424cdcdadce5ec0605a37d3d00753d3c2cb8a5075d142b73bd1b7484573c5b84f0ffe5a7170c1ce025190f0cd389b7994842f09f8c1c2074b20a56abc1fd1415253650cea1c78a0c85c3becb888257f488b0f4e9c65b7a7b2c83e5b0a37e0400871e674056ddc17410a76362d64471dbf45019362303787a518c26f7299875f6a04216a94fc8f679e3e7eaa9f6ef8be3598fe0f134d3290870951651d4d564fe0adff2a0988a93d95d3077bfa5c7000d4c326ecc1a5ea5fd4f0caf73fa57ff61c524cd58ee5a5884994ce77b0a36575288b7fe993d255de2e666d9350f5a6e13cfa74e723f039c9da2c65567f22208ebc93d74bd5a14525d6c183cc9c9eb1de39d839d43e6579f907d95af7a3ec53f8bbcdc6a63e4813f02bce47a0e9dd109a5fa705f8edfe42099c0b4cf492067efe65a0a269bded75d1dcfcc5e9a0dee8d7de53826cba493452e80e0555ebc8110172fbcbd0b7c2e98a0f4bb4d9495b72d03419ffaf1ad1fb74cea993d19734f4e9ddf6a06f5a4c1f5dfad8dbf1a4e5ceb591fbd16649e83e12d06532b14ea9f29ada61691906544a1a3b197e6e79c02fc9d79df193848b0e2fdffb4f625eca74b8a9753f52c23ef6a400524cfa40dac5609c0e56d8bc1ba7048c6870d0824cc709b1559f81513162e9f1797d25f26a15444fae4c9d35771becc5e878fdfbfc3a574426805781a189779a653acbd26696fd6de4b41f1d86aca7f496a69aa7715429600efda38510c19ef6c6415e5499d1fa88cc88d32973526db8273589943ffb14ec105bc0c2de7f6352cb5f65bb9d21bc772bef95408ac1ef6975ac27babc4f231a9c2622bbf3fcc366e96858b7bd0c77e78bed4dcc02aae624f6eaecfa165d6c7d29d911c5f17681e60b47ca340196ad7bf495a47365f876b1e41d8b3da9e3a23b0183551b5338e44c37bcf2f58e804717a2b744ab3c088684c85fae536b6af31372b33ef97f14486f6ce371b96a0062f8f779884d7c1003f5b9fc0bd06b57f5013b1fe7b3fa2a700689ae6deb07f1ad188d00e7e10daf34d3beb2ff2672f0dd8f48eb01d9cd710af9e72deb1f796b8b9ac2fb389b9dae7fe79e4a9960860ab63f15bb483876e70d234698c56b2ff31395442daef0bc6893a5858ea3aa1a915c3a135363e7e16fc365e67e5bf5e9a5103e93c1e70083732234e341e9b1ae8e2a8392547473afa97cd51f6d61f979d3c007bf525a3548fb03c718a480092fb598284756664305e8bc1f575b8aee9a4cadce70c84bc36ed9cc46eeadf156dcb75045d44da9ec7290d7a5416e66490888864bbd424097e031ba4b9d8d8887c3f8b2ef6a6ebab7a25e99b0b62a7be60e86c41863b03b530b161b0ae1852a4026d96cd39c60e7941f9520d59a6bbcc72ac8890e9016a27c35e6a55c5db5d108861668283bd35947a0041022104024fce4563732622327be0141f87ed66e411a9ad34caeaa74ee3f1ae7fe17b8a720496baa3dc61e53e8efb978190546191b381514dc94a6ee723ea7de19a8207176c0065f6351fee5c31d1cd2b794124bc6b5933eaf5b0f6ef099a96dcb50773f90af9f19e91890500c536a468d5b80e61c95c63c446ed04504bf6b88dde293494ecd9a588af9ff1df12a0887333d7701405b888cdc1277c693e39b7ed7075516b234aab54da86ac1a6f4dd030a28077d5757f4dd3af6ab2b695f6235959d36e862915266b08d85f13368ba5e9a9c6de988c804e1583157d0d398fed9283b3bf2af800428a2c2a4f750bcb3dce8aad1faaa4d84fafbe68ef4d842b25833f318f37f13a3bc92d4b27cd2b9ed9d097c0d9e5e455cc48726e0b768192d7e24903b9a1121d0d09c50b7b288d08c96bf17be0d4d1effb5145424e5386727f21a2a2787ac4b1e3f5ce60a4388a710d0e18b045ceb4d457f01e09a515c5016d05256371372b8e5618cd25805a8ae262b73a93ac80279ab42f8ee86cad73a49bde6425fc337c10eb8855bf1eb42505878c05cde678809f4e5e35b259018a7e9cb759812c09f2ca2f8998bc039b4bce778a6f9e4a064b0a0fc0620d0e0b4427625678dca40b73f4bfdab579e5f92470fd57258a638d7f690027d030325dc41b2a0d5203bf42804b3da5ca1cd9aa5b82c14e1a1868d7ef2c05c2b8d8077b8373862b788ceaf5b2c0a61e1cd4414f2cbe771c24dfb4b3950012583143daef474afe248d84249a6203fc99b7ed1dcd01a9c1369f14f4031925ee29d669689704c4aef4213e7045b3f2d53e38ca9791c7ee696b3b848b8e3a7b2d879766fefcd2762858baf806000d6754070ab7a1e6d6e7ec2fe246e222adbebf56e63ee9e60944f959889beb62a2c1777a290a7dc106a83a136f453c3334ac0869aa59b6731a94d5e72301c6f41e1fc461a513aaa8966a8564f25104a2194d209655284b434cc74ead3238bdb19a1b4657e3aa8d269e4f5f66a9b5183426710e5b6eb8aaade661e97d8a9a512251dd5cceaac5a781a4d6cba0394c897bac2207caba672bf7669a9970b2831a310e9884a2bc614a8bc1f4843ca60a7957fa16834561bf7aa6f91cc5a60c433be50c00db459dbe3271bd089ae245b3d497a1ede7567aa1e852123146b37f3f1999591cf711c7b0e10471125fe8d5c40f64463264432476a233d251d4dc43fd5b7a9a126f132c795f070c64f133f8b27ddf2bfce4c5e321156d5bc574f5cf568d93c23b2d5d085450356f2b1b97584bc4ecd7c65f6664af491ffef497ef6f88c0eb5d767f5ae3fb8f2ea052171769c12358a670fda9f8b91d6e6f98e694b3db3d4a2ae7170ba080aa84dc5b2c9ef452c22ccac60939aae66906af8f9bd9c3eb3382754e25a26d07125a3a80a6825404a730bff4e7a111cddb8439a6cf122eff945ec7555f6b89d9c502a7ba6b0ae3b60c8546917bfaed370ddb7fb55832dbe535bac3ef6248ea6f24f901c69100052feafcdfb2649d6d7875426c6ff5639e83e66e09011d0a443b5c50efb38208a7832005ef8df8dc71c1183af1ea43180e2148d5c51497ed4d868e2402849ca49aeb0dd7a746ffea6dccd0f8b8081611120d1a11a6d65a418a9e4f14bea707df84e56f5f0534578f37179c9b4b8f41bd9d447c36b0922028783d0a9ca3b03b025687bda01ef01fc19ac1c71f2e1fdea6a04c9e17e1743ff979ae87eab4f9973ab179f390c554bf33187ceecc5be6df29a5cd9b23832e8763332eee3aeebf05b17ac3052d77c2bc54b20ad153ca94e5c31667854f746dfeeb282393c6cb88f7c25f0a4f6d7c3ff5b2a48b1e74b273a6b4ed689c5b9012eba3eb9e9f45ddddbb03c4f78b8302f3e4b4b4e5dfa6f6c26278bf15ca0e1a0c45339d00fd2386c59121bfef8760dd16d53620776c63993da1489bf12b82386ded314b04a1b3197525816049f488e03b2b601bfd41ba1f684a8f831addeea99b61d89f876c460caae8d85df3b1058071d73c582ac625aeceb83b3b5870f33a6bbbf3703ef5494bffd9c9cf4405d623c7158faae952674c38c704abf06192bf379719d1ed38ceab5be7ad841434c185807011f870c07245c8ca234263bb24413a869785b038af5fa3aea6dc0f5851b54f5b222c16ea1299bf77b07a6de0b92210ca9b3cf81879ad924da2297b8c8b721a986527a3a0569dee9909802398cf569ec9cff5a0e927e7cb5cbf9c296a3cf73641e5e0715587b24051c7bf91838456d37a928b69fffb1dc65236fa5c7adb896b6d1751dfe2c24dc72f8df2b120ffdbb8c7819de38a46919ddd3efd408a4ea2dd7c16bfb9888a0f5b4ec75874a78fe7657bca39979e1537ec61f0d2cbc93987b8ee257d2547467648e963bdee0cdafe6ce39517ea6fbdf7391430941f70794239559b83d7641dc0d78aa649e06ec13f5255fba9450567bfa846434f37726f98ef1b252b53986897798a72234a579e477e734178dedabdf9bd8e7896633a520fb4ed9b26bb518741cdf0582a1127482e0ba8dffd30f0005fb4ad8b5ad6a99c2aa9100abf1acd5ec2af09b17c053eac1a4eaa911190c53758de243d187a0fd9bf32c2be09f1be045c6ed11f07a4c7124d3f5d79cfa1ab3e51da62cbaa2a46dd2a312b081e77bedf9730bf5d3d5c65b78fd5057e7f8b62b1a9349b0da47009c59e3c8109335e84e0bbcb71af07669c618974a6586954a981f39ad6a23f2996d3957f9d1eb0a3e15394bcee4faee15cc892ce49ab342c4a1f9b1e84a81d5abee574adf99339368c2f4a15161f57b296f0c1cd1bb304e988b5357536dc46296d375ab077103344f4488511bc39a1344b27cd300a46ead3ac008e2e0c737be7e2e3a1e3e1e0061da9ff2763aafb841000cd320cf499b644b50dd23dbccf1687314b4b451211088db1b790ee5df4ed6d41726ef7c173722b341839e6a6860aa22d9b1b17bda94f28c4c02c4a61adac224bc6c1bb78aeb06cee6fdfafc91a31669aa3cad603f46801bda7a0be207bc6b839b67802aa7dc3672fc18ba2beb4ccc5c00e9beb9bc9b84486900716e8bf9b341d1f99b0afee6fa06dea5c6b9d5884f84810b5ce56c3deab44a2536a5d1e3d28e414eee6e72a899a58adea113036e9f628c923b6e1df1c7cbf7c00cba8cfde96f7ceb40ac8ba128becbe960ccd9d984121f65613d6bdd93f7f09e489739ee276123fa42a9dea1adece58204fb749a2e2df68c014ed451ac670f7546aa28b5dc218dfd3d91384feac5ab2eec1b7175ab35a6f9cf1cc285be2014e5a2faacd3f4bb32616b910f52dc4a47a54aaf779ffdba4a16f8581c2628e8e6e0687faab0a719a7250ac4d84ffdb7b0f81c3a269c7cdeb9388e4a7212131bda1fa2e9076d5a63dc00df96452581093cfb8a0c3fe739d23cf0c297cdd199d2b812710516f015ad518ba9e105fc6e4d4e0b2de66402baf3fc31d05fc2ac75e8ab951d2c97664a7316b31d5fc486885b3d8d86620978579ca9d09c82f5a8b90d9a9bbda3f2e32f1f299095635e546bfcaba173aaf12229870fad558687bc5c69517e0ea94f4b1695344ade93201d58260f20ee813e383c7b705e977ca5ad469b8c2a55af33667ab02be0f2e0cdcafb37cd786a01d7ccd2954ccb8030cf8fff4427af62928f4235e2812b512d06a09bdafb6027b1824b984e54381300082adb5cf34561b828dfaca55228e57d31760274d31a330bac52692ab430be79daf4e084ee7e53b83e2ff57f224df474c9f02206ea169bff7df53f4260fcf545a522f587e8b650e6e3146e5d197eed6f1efe406ee5b06780e4b459a1670e2fda7f8784fd15df93d073d0ce9c8c995f2983c9bb834ae5a4f0c3ee101f23bf822a21353057324dde4841982c8da730761bace949b34ac7675b63966ded8ec1d1e5d2b19c68b870002bf780a894fc4957916d1859ef7385ff360cce27ad8e5ad7c104c52c04cf40d843b023f906d238fe449794bdb97f34850acfbf1fc200c04d6278a62993254b905ee0d700c24cf1f2869e6bbe94e41336120e76d0a746823e96e1f2a8d5c8eeb05560f17e0e4d438656b36507098647d3aae4174c8f174e78d668f028805e39ee404afd2e87347b3b73bf2b6a6a0a0784715efb4574f2a13d952b1378e52faf54ac72c73be8605045d7616f1a3f33124507d763cc060e8b6f0e2e4b509500273dab7255283b39dfd636cf47ea4c392c6176498d1bc6aeee815f0f94f0a1249185dad8ed0c65e0003dab8915e02fbe76a033755bd1d3187b51b338e308a3aa42aeda33551233ce1f45350aeee03c5272cf00978b345bc6f66bdc7647456dc3278fd3bbeeb558b02521a67c2383d6105e1f9f8b342ff15c06f0c589919e8b7109baf10277b34f419744839ccfbed02e3767aea48b110eaafb1e2f90be797c6682e258a20e2aaffc80955072f85df80d2ad876a6e26f1d99b428c72141c868ff9d6b6532683de73235c0ad9a7035067aeb535f2b106934bc17a08439fc9bdadf4cf084fcf5440a734611229c24812bbeca1bf2069685a025f628d4ed4eb2e2cf01c8f860f33495820c6ea040dff817ede953783a36f7493a18501221e57c5ff2e363e2de0de1a935e325316f304531c4aaca4bca8bba2287e190d86afc71bc0eeee66026f6f6a3c4bd3a07905a67320ce3e5f80c8ea2deabb3269660b644c83fb2402a69b9b3d976349dbd061b137e8ff65fb41cfc865bb535a56cbd35f77bfdc826fbab3522a1016bd22aff7277817235497988306d03ce9d87bdf0edcf7539b1f292b1dcb2f11d79943887b79e0031ef61390f797553dee2289add4c337d8feadfb7937041caa042264122e3e4ab75cd0cc0c7142b728e3953ad1e70e57d298844fac0ccb588d0de7c6310b559b7ea8752a17e5fa1438de4bd479e05ebf961b2d035ad6052f0e269d2158e2d3be06789e3ff04dc351de3beeb061be452e21e14df3f81203a642ca18814bafea17554dab02b1446b655074e0741f897261a06f0438f75ff4dfc3724064eca260aa8321d1a80c602988eaedf2decf648153fdfa21a7ad1744638710f044a00fa127ea69fccf1eaaf6578d3be0d60cbb18ba0ba6261e32a43eb1cac47f62abf0183cce13713f5335246c1217c47672420f22d984717c805bd8bb329e04d7815a8dae574038bb1767bf763c86d76a6a57bcd2fc72f41bf97b57c259216347a7194a585e76c0f8d32e15292fa1a666568282b0e1138fbc2f51f8348effe96d8cd6749c1b4f13f20affe819b31fa5565ed67cc3caa21993b5d81903d472f61bb2dde4d96f53633b9a08d8d6e6c549c5f8bba2001ab696baac7f5e8271b6cacdbbc040672fa6667ddb19cedaf3cd5c526f6f225cf2c8092613763bcad5cbed44891a64b8dac2bd2bd159d7c7f5d22ba4b907c9268454707a35e48923c12a779abc6a1adc0530d7a3c035dcdded4b3399fcdaee5620c2a91b12ac8af4f18ce3e3ef550e1791e5d3b9c68a28265f6cafec17e9aabeccad5d51c56f85fcf7dd4ebe053fd367fe685d0c0586c108973c4c22bfeba582d9547b65af5973dfc9a82487e3aa635252828b3729b9d66c01d72a1fa3af823ccad9db1d907c06aa533f6520e56135d94b891e49c0df6b1c5b13ffc482f68023e14b111e456bd82ce9d3b27b3ded3df865ea0106a6aefabd604b8a811583ab7d79473a1bc89ca917d4c0040f4b34cf168d319d888c2c6ee86e525b9d4a5768a6b411791708a2d49d2cd831bb64543d669c12b057fe207892bcba56f08a50d2c55669c210b6677bd7217fe1fa1ff7808c1488014521e2e4f375e33d11fb77e901ee1dfbe91cb2729c90949e4c88ec14e915a95810d932a12d551d31ebf38ae6c71acbc7545bc4f32f4303713054cbadb034646ddfa566a945825ed1beb5962a69d0330e77c920c313051c1a4ff150d2eef071fd32be9ef063188b930b85a4c7936d1f1da4d289db059fa650dcc1f9cb2f190e383747e1bcf5e71e38aefe3d346941fcca1b3c284404c702425ae02f178651c5256b672b70cc5b40a586bac864b548bc400b8d5315f5c4e0cd10617890eee3b71228d91f87a6d6b77f60cc88e23a73fbbd74fb0a7b315f424a1839272db1aeebe472b5147f7a803e629e34398004cc41c6b4b87042e0379a7b9e21e87bd879e3f74c2fe23db872b2dd76606cb0f0b95f437fad6ca3d239837dc43ff87cc331b36571c60ff64c3c4109ff0959bb244390d550554dfc855cf304d7ade1cbb123c1c68b2f8fd7dc0c68eec0df478afb3e676e5e39810bafa9b541f05f58c8a83a6db2209825efb9efb5187f97397ace282e8ea10ee22806b06f4d01bc67ec2db2a052a2286bfcf05e04b23238715ec1b41f8bd6ee0a6df04b6221f35c51994ac6df4927bb23e02cf9ddb034c5c427d7872e16f31f465695250da9bb346197662fdbfde9ca482752100af6a316a55e33716dbb9bac662a9b7ab8ab378828c0d7ab30b6ce93f26a0d49a28f0e04bd1b6b0a14e515006b3d212c219a26722bcd64adb88f629a505fbf716cb790ad0c79f95b4b1680a727cae5518218be57cfc3fd44895b474e80af9e4279d6c8c3c3f1fe7e12c2d5d9fb7e319595370d317bb68aa9534240092f50797983d1bccc516d28e8d6236d7bec00e773d8587bb5702c5397bde0d82862176b9a77d4bee7f3d03f7d3b03e980519e84384c2b5a2fc97838a2830827ab1c42031eeec0686fe7518f9ee59e6003cd492d6c6cbffff388e7bfb9e1bb74353ab0e77de1efe2dc4a7ff711fdb9c22e13ac2914e1fa3b5b6c90f2ead0952432aa5de430c46f9fe0c8c16824c64d14dd54972e152fd57f15646e091e3752fbf9a346de5a239b71ef63aca3cd3b90d2f515885a296614d5919e5e0c71b8d75f76cf2797bb3cc85b26b1186706f211e446027d01ae0aa39acd419b11e63fe804878731dc9b3a742efa0b66437a68e74f6d07c2d3983179970eea32dc802004d9f6f8255f00d511bf439d91dfa04e81f4be615385f9d214a00bc8c2e76df7bca53f5569db8817ebc7cc3a86ae7dfd039bb87a9e626e72f239b2043c760a80c148b698b78a9cf8b4f21ef6cf558f4bb363a106dbbfa2d2d1b1273139e4d01b43b2921deb057fad1ea3cae8d838713c410554d2ab9d18714e0078cc895afe9b433c09bc14c36e49038a13245cf56f9b47b43490dd3969b47e266b06be5bb4ecb979e264be2fd3a57ce27fece4994771c042ef4abd3e077aecd02cffc710133094b631f115c83505877a41e09d9c40894a10a3774421f97d3eb471070f9d7630e549ef1666d9fe0af40c821125d744421329165751b13d312e32fd0209d8a7d7ac672c8dfecdd16f4a6cddffb3352fd3719f53c843a4ee5dbc052fde08f069cbaa092816fe234b3fbc3a5cd51c5795edaa98e68252a2d75a05fef3e8ffab805faf8cb0e1ee3823d98b4f5ef4f689a26b0835570547c4a6624553432aa80d7768e493b93c5dd3bc824ce720f4aeb2dc6cb3c46a92db278f0d04264787dce23d505f38cec70a8b1032539d6ae717df30adf59459a65faa7fd3db3ad376e57afecb8cb426b2a6c3bd49d346b498fab070022165de944c970cb006dd79dd0c269ff9c940c13d4a742ace9565ab550cf0d86e86db05648aef5858ab480a85b471c46cbda25fa7c67f9bbbf76e0a1e1b66908491fcdfe3eb77b4528d1c190eb4ba48da2afb6f11d431ebd9ac21bd5c2851994b0966054667839366351d182703f8c33b559c09929ead93fd6f4a1e803c2ec5d113e68497cc619de93171a59f7555de1f56325bd23c5","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"db2470865aa068691185dcd60d0115ec"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
