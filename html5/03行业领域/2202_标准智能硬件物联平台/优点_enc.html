<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"8bc0077a820974a7c9863afc6c499d0b0d0a3a859a976c5b6a61277b64055a48c0c430eda3ca5066321823a9bdb0454a7a85ea520fd8aa68a67f58414e83029a01a76b0e8f7c69022d5b06cbbdc524e2c68d120e6d102f45f4a573940d8291e4e05edf2a0e8187acc0bbb528034cb9a4298cbd2384b49da06475e058ac8c2b19fe71305b7cd26a4dd25cda0c2f2fd8fbbf1a8a3b2612ee95d40a965bb838e943abc1eb46d703e14cc015cb5173852b20f7c27f480fc212e64dc71d8b1145a040a639cf06f7f3cecca64c8f1ac5047d7681b1dd518184bd4486809f28d9bd747ebf3f3c8aee859ffa7cd4592fcc152eab3942d321c72f93b31ef3af4381c376df7902c8c53a1ce6cb88882c53b0e32b968e906129e93a2d494a7711dd202b5ff94507b76f9ff7028d1ffb32a45caa23799e4c27cec2ce36ab0426f5fef97b3724fa2c51bed636f950c26064c658ef0104ef81804ad7ac12b46770bddc6a08982c8957aa91b61a813f49adfc1c0c168f0f2764907b1a8ca2828d982734150af1408b74df7a26b021ec5519b7004acf13c660586a03c9eaf06f6f7888c3c476b2d282b19fe7532f5d7a48d9a45197b7c176482b3fa84896260315dfacc2dfaa1cd9b83c984c48c780d19f49bd62a8bcdcb5dcec9dec4559fb8178c62e340c414c83f627f09c5bde1941c16af0d5542032295fa826a7fb3c04bfc8663c6d5b858dcdaf25c000febcb5d77b124b1c8de67f5b17761e4ffd69e1df7925ea4c08d14430ef24ea722369746bc4c4d45faad98e3440358b9e12b7b962e31d6b08654d2c4ee34d6be1e7cc060fc4a71ffcd5137d7ccf3779a4f9d9a239acd1d924c8102fbf273a25fcf1383d22ed834c5080040eb25a03715b14b60018dcff9a152e2bba5db2d5ac6abd7e1d560cce6f2a1265f981275fd86505558733a0b0ea4758d6d6e1d12f1fcd1b173bb21ae1a8519a5529afc8e79c4278f42f00b14559a1bfef41cbf8ea99c500801c6146383e736a031f89770d566721218180a69a5e6803348bbdc93d8d4def2f26633967e2d4efba626e1bb647afc9fd85a8f145c2e24b941145c49f1383af201622ea2047c54a90073718ba6d630f2c937673e3b878085a243ef63b7e89ddff1dc65d2c78e8f0dcff042ba148418ca966fcac86cdc1405d7b9a07a8e9f94749d7297ea9b5bb3950415985b55f5e83d52a94a6c5c8c1269e33f73d0f3401688638179cfdb76b87c3d2d149bcb5723f82da7bd209ecd7c66f481c63b473f5c2b877f9fb01642c4374e03aecac52af2c68755afa8bbde21ecf44bebd1823cabdb85802f628986b4c455e11e56460f617e6ef96f57dcd9a524e16e6c1c1f6202bba7d564fb3701705a08eef0c111c88af97076830ca9c6505f01497fb69ec903db27292015707c9581c0edc0dd4798bbd16a6f61b5a265d9a768e63700011ba7ca2f5b61d25edc079defd10be6e663849f1cb47d7b57924c886d1339ae56537b851791215ccf4153deb2b008088aace57a4a08a993bc8894e52467d7b021cf849b806e503af5e3858729113270a63426c1e5aa60de4aadd85fda089f4da1032c45aebfbe7dec099873f07615747664d5ac0c4c230bb248eb4fc99f9304077657480bc9622ed9c28998cb2c1160acb5ec0f6d17ee6b9517dbfd7a6921217d03890b0e504f8d0b50fd6e4fba3d16a3dc69089c432d599b4d787c0ea6648e7e212b12625f26bd594191bf1ff182e49c5b1f3a299af2393e1252beedf938f21a12ecc4b4591b08a745d02f14b9c639f578a7f38a1dfe32eadc1b4c0441a19b98b67c6358e4266e9ac53093b40756bd6875ed0760c9adcda8892fd0c25e1445941ebc4cb10be3559e480dcc287dbc4019ca27a3feb4fc26327ec93756e1a9cf6e6cd1cc5998dd1e34944bda1bbf2657138869be1b4b9bb666bb430d6fcc1e4a2c64f52b676103c5cad0397e0419a5a8664a96ec1ef08d2307f8062af6ec760e15e95ac737a8a984431b80ddd1ec62bd311d18ff4cb0d91e4d388352a7be9098b8f8ad7607474ee9012c66d9325c87d9387690003bc0a8b96178b3de3452aeda1218444aa550b1431a51f6a8343767c669198094b006b7b043f42810c8d31a2883afe9e4a1c6b13d3ac4a89a3a9676e12417a8088e2f476f0cb49598c902ceb16efb97f0fc31b50c4d399660974b4bc66af1a786d79c02134a86d2db08a06350abdc046c70d06b9bad77f27c7191cadf5ac7a4493e5dc34e1856b5f5ac49988b3c92f5f461c688d5083abec86dbfab6783e0cddacec3219fa5be70d9f9594bb36ff992ea19e4ab618b89e9f325d6cb7369815b3e8dea282b91b18a304d769b8184fcefedfb7aa48f5a8ebdf9ce8a1ad6315a5111e882d21c3d499a1b16fafa605b779a39ed3992c58f2992f6fdf0019ce5c2318fa22f90074a29b77d8d1e35446805494330d0916b7e21ac5e1aa734e805dd434c3f281d08c6627296436249974420ae20ffbafd31fa8af2195b7b81a45e1fc8b3242fe5348eecf46c1b516da3e6f7e17cdb3c5d8b0befd4570e27f613e0a5b08ef2b4f18d20068468012a4279542be2398f00b93a6fca55c214d89959fe15f67c57e3b308c53743b9222bcc2694d989cc262a3104dbdcc6e0985d11461e53e8162e0ef7502a9da83da994262844c4a1303a3bc0009787a195a363f53bed3bca3e54c1c27bc37314eb682d2615991b310e1a5df1a828065f1c8acd394d809e0a0e8903903c6137a179aebb92f6656702a62209e0c806e725530e544f1f4762f916626a5dfb714f134e341065f29e92d31121f4339d51f17af177b7835be80fe5241b5592f6c82e3b6954a272bd60446df6cef33bd705aecb9fbf24a8beab93da1c7e6278eb5f8419d1c3ee247558c33da05066f3b327c9f727cbf9b915c6d81ad283dda4a755531465371cb45722aa277c9aa5937e8658da492ecb360cf634083d93ee584b923cd4abf07e57bf928f3024245bbc20c6f4dfbaa8ba7ba7a235d6dbb61acd519c6252a55285d804d113bdccf943020ddd16015d29a27f8d0eaf99848d709d86f9e4b9d35dad7555a0d82a352f4362f7ae2418b7abf6f2d7439447477dd1472446943e2b98e1f334d036b7922bd337e972a0530ce6a30bdb1d37c7c1b433cc4d80f20c8dd36972d51169c3d1d6fdd57fcb4a614d00456dd935e36c5d6f40bc8bc5a1f890ab7768c41d7234b841589b5f1b26d6afc678aa59f2e3d3c6ed906b2a1d91463fabc7f7a437d7a10cd0de7a0e48d5ba2a7e3673b98c50b44be2f60880cc314ebff54d77dbec91f5b8115e5bc53acdbc6d787466e97f84f1983ee870d2d9f5b490f389ddf273e1d54ce4443004b2112d4d174c3409f6c074fd5b049508b7c3e7068cbe7b2661abb6214ca024b353bcbfe7177494c354a534ec2b7319b92484037860dd8e4a1daf136cdd9e1b1f4e8e990b49fa488f54227d74d3b07c89530ac4b8cf540b81287a0a4ad808a503994c10db43f4580588c8553d6a3b0d9c0c3493874837d2bfbeb4d76b558caf8b6d0cf1b4a76dfc086bccd00974dd09264903aead1d5c4bb9580afb40e79f6f3f7498100b444bdd6459d29e73f00c85dc8f037ee3949d3f83cba538c8a2b26341c3b2105659b95415c187a3867202e9b52d2118a015fcce5b08e58d9b142343c2b96e1b1fb1c84c0245a404eaf616f7e5a70e741490884f13c53de32ee5f4c24dc95742116d1aea5412b51838126dfec2667f4b77a8f21db94f6cfce3f5a7c1770eff6f941802de09c821e0871ad3a892411fa1e7c1bea2d4ce13b4af8dd56767c7f0bc8bd376f717c0836e5f59556c8c5a070f7ae679455cb0472536573e0c84a1777243800b4c3c27734d2664d9c9809e76dc3dc25006b6fbc75bb62742061112e45584eec43637daf7b9d3d5fc22eaede54dac7dd97f9a771a75a7c54986ed44ed7e90f6562116c9d18ffe2c27c8a5531b256d7448a5c528f7332df6b5e194704455e5260cb4b836aa785f409555e6e71dd332a13cc05a7f44ad3b595d47a35e5fb910a6b87c5ca976dcdbffa1e5fa6d2cc948042e33b8743ec20ca3cea4eb93ecb24cb7c80452883e0855c57ccddaf5792deab7e96b4583384ab51208459a1a58eda4a0cf84260b35d48713a17549ef28ef355a44df893f9b87aa84716fce8cee9fc8ca085e1dac7d496d734ea1cbb4b73546b6a4678d75d7fc1739fce05f8da00592d70b469ccbf50dfc3150ef004de346a48d7d8fde93f6682684a98724744880efa3d9aff328f296a7324cb5e09453b19db00094c1b7c6323704fb5045ae98693b277e30b7fbfe743bd98e4c941deaca5b0726fdfc3ae509bda6a7cff5b2f35d438d25f94a7d199f19c850bedff73f39071f271c69da68754986748b36114fedddd58219104026ae08a9890801138c694d7482be97f6da8a42b7c5a604d983b602212c9106ab6a716553d0706f2c4a7ac4492c76245f7534b44dba6c6b69ab3be831eb089a25ddb6b9907e3cac756bbfb25b19a71743f85a4e333894f89b05fd1e46141a356dad5d007c7c12f5592017af9ca6f8367812131e8173c7971d9ff55d9265e366fd6651ce158db329fbe416d867251e3f92e0004888f1227b7b9676440e9d8a41c9d2590bc0d4ba332d17cb867f053907aadb07003d0cdb950564a0d2ee9f93fa441babb4fec83a29167c68d0ed09994e60975cc3be515e345658495cc159dd52b9d12e01e682de4f367182ca07af81030c810a6904a196d17efb4bb17abbe072b7d6bca0136a51f79334ba4991510d047157d956ed9ebeda324d816e9849a0cee10e401ffa19528df9d6a9fd8e3b907066f494b16f1b9916004a8c9422aadae50712322671f87882e50fc5c55cdfea64ddacd3af4acd7bc4b821b5bc407970f57263f2d957e77b8697355b6e835547b4d6c44a8946a9d5865955665f55c3ef28578f6dd555f069ed89b1a2791cf88f82131414643fba6b924e25e2f708df378bd456c4f62e2b7932b6624e26468cdbd6a9e04053ea807b364e1f89ecc515a8abc7f8efb42a5a781f36f34c6a92db0794080d693f8340bc2c64d8ffefdf0860d19d5d5d136592b5295c69e6eba2812e46004566fbf3b0053cc1da8a6e41bd9716fb338684fc46907035a181f4695875bdbedcec734fdd586348809e4f2fadd7696e45c6f1d15b47fce5f8b0e24cffa6e30d98f7a6349e3919d1dfc78ee357a1198ce2ce8de1b97dd465a5c2d409c557e1fbb01c3eb46bc8a24aeebf4440f490ae9e472b509b1d0d2ed3e45c9d1efeeebb312775ddcdb04fae0db59dca64e85a008a8a28569df84e5ed36ee066032e29c67a17a422c5a5ceaf17c0717bc1586537c87932af1faa6b9dab47835b350cbd2cb9760a5107f82bbf2fc08f497a9f884207dd49332008084d5c144f25a2f0d136a2246ccc263dc40230390a5cf8d197cd59d7ffed0b1c88fae67b65409ae95c0f25c26c4ab39139f05fc6988c51a4e8641622232a1590ce117f7ca2dbbc123cba1a9c9f6117feeb4517c02eb7be24ea19da1f2e3a440447add380f04a8a8be8c282db2d51f46e2fcdf154eee40f110d5aad3c7c7ca8fb5a80c269e43361ff2bb0691805cfda43b63f6293c7ac550deadf8d5064982a92257f09cdbf1b6ba5cca96dd4f1821d9a8691fd86c13cf68474aac5cdc0fb0cbebc7c255035bf9ed55330d29b8d9d431aeb0b5e6d8eff0fdfc47a7010d293ce8c32384f46a58f33169f1d34e543916b1d29c8ca916230a69b6aae9b29d0b51858d88c254e31b99b139c5ed20f9c7a4b60c05c693d34b054375ce6b1371d366e0290a94e134fc07b3c65e01a62937ed4240bd751fc4aca48278a63729e4f0a17b8500c532d0c5482be4c359a627bfd15c1b00e26596c3501f11dea827612e75aa92b58227551007d3a41e5cebd0c012fc7af2c45ae8d9d3b4c6adf3d12ab39ebef47d698b254f5363ceae87b839550269d850161ab437922e36553f57bd9e7fde96252a6e66bcfd68c9f5a26a32f0f82dc3b8d7aecfe5f69d9db3718f55ea3cd34ba3cbb6133868c51d06d76c332da80f9518de37250136146b2866467f67ee6f72427cd4b658d6d939fc3b53b10432beb24fdc1417a1e79c769e8781cd9a41ab2a40b33a35a027ea30551101622f1baa1acc14cd5d81f9db5fd5607af0df01a65f0fc86ef7662ac84012120180b05ae464e741d5f93103902451df25d08e92fb6131a9bee9f1bda867e51806537db60993380f5235f6733b911b8756aab651da00c06ccb29fe74eae49d81d694dd369603d5da182ed39e631ed28bfd9fdb84f7542482a4ddea49c4deb0342e262b8009480b8a673f75b5d2923d3a573fc7ef5b131a3a0f0a83e17a9b9bf5e167cc7ef671e931c5b059ad0fd6344e5d1c3c00af00b109491916444259fab17a97655d351c618a676620044fb90991bd225904a73a08634960c1d3c89a4e2453ba0fb115954f040f0f1283959a465b96426fea65b1d5a2e7663f9f439ade7fce2a558637986990d2db848a16e3dbfac04559390a40daa73edd8d92c7fa25f9896ac044cc429242d2fcd2ae7a71b17b34496a717c18822c70b95ff8501804b079ad36a383370d04a38e2b9e199204c5720a5fed3f6221a6f56744a25077de65192ee09c843b01ed91750cbabef00d5679d57fe838ad6bd22d95392e958849c8d4ed31743b0eccfe9081563fcbbd8c7980b039b565f9c0e43809291282e047935ecc046889c35a99d428790db53d4fce0a664f3024f885096721c750ad181a63f7133c442fb966c692419266cd391c9cafb569e3efc28f33d7b0108bd7e2e76a6b9ad26c032f9a2b47aaa7c2e28883dfda0e1d43a412916a1f4d78697558531f2db7a1f784f45b20b44223b1cee87b192cae657ea12d834a5e6eb0eff2e9296741683b702f20cc4bdf21c75c56c650aff97cc3f15e19de9683f6a464ecc7acfdba0878327c236e2dedf8681e5d0bb9e1d321e08d0d6538bcb6e262a435c49b5e1c8d333807e79380c24c6f1e51024c6c4d9069dd53ad3673cbb3f50984120ae4cb8358c5a6a4b0adbfc02d932c9cafb3701567b705361586e6aca94d77e040c0bd0b87d32cfa03c270a29e06fc0d28c3a4d9a431cf342ce518afa29d67ea917fa47d2c4acf8e0d9bd9a19d81290c0430cce67ec3cb62b4bc451a5a8b1a20b4d226fa2d086bfdeb317f33e0b1b9755d607ebe5fcd3dae3e5b3541732b335eee343c39161f4628a20cdf814be493cbe4d2e29c0f3e1e7994fdf0d2d954bbec5332d5836e5a657a8f3c8964ad61f464bd46b7ce621ec1c692665e1622db146408b83623d3ca46a3ca927e7937e7e178d7588f9647b6152151800886512453125106c6f4278c9e907e2ef98d77424d278d630ad1b74972b4267055289675db816f7b45f39c45bbc7bd8a4c159932485830bf7814144973d3d098946bedb799224f25b4869ec8bbcf048e78347eeca05a67f6d700d4d05651c2390395e77d55897c4d8fa5650a7613f3bf198ff98b9d0f3a2d9027856c88be85eda80c7d1b800fa42d98f0d66effc4bce5821395e02711859c02bf0724e112e74718b0e20b240d7208f450b4684ea3e7f3ba229a636f9b208692eb6901ac167adb385bd325811b686bc5e87cd3b22155b79bcc51bb3b347c0928da1c5b68d1ca51472e58ee7213bdd2cb00ae1e223485b44f140db53765c193d6c2c666235a2060c6076a953a0769d9eee20c1c5006bc616a6cdceb5ee6957d8880ac7508e710ee20ef2bce7c61785c2034a6cae0542a385cd67631a347f995c6e659a8be29da00d9bf9b5414cd00eb5b6602000248cf140aec2f115a1e2d32eb723f11cb40ed4b04ce90fa2902152b0f5c15ff2e5643f48b57c42d6bd966081aaf88b98bf7caaf5e6ff7bcf2128eb1d205e51f0be772d0c96dd858b0a1498b7d32ba6328604179aed1569f6cf67972c89fdd2a48964d2f7343bf0ea4cdf0e570bc4c2b39e2581bf2ab61a31e8ca6a55800ff4ca551057fd49768b8e086fd4521f0a11b996ff34d5e1c8d61e8197dc9a3582ae283269de43785021bba4fab4d734b1f8909e6cea99d0d76765e5917d37963590f7b458340c345e583e9f296569b1a76db5bea69215fbb7285078a3839c865fe93f217ac1af24fa1a101f660967cfcd11ccf31b64c6bd65dd56e48fac02b93290aaa9a93a2f7feeff08f4eb28fe19a804fb28ea1c0c339daca4af3850d6368d303265419a9a1118341c5c5ec1627fdca5513a8ffdc43173c71e08d6c6fc4431526969734defe7c45683ac7c0fca3d9aa7096e64ac03dd0d4058de3b88a5db1f3391984841af4fadae0627e34e41b1b413b927ed6983b0a78daa4517df6bd3e009f610c2022422f52b0d45e2700144282a7557fdff7499062c88f9b6087e744a780794a7e4c6c67a9bc41420f1e30f33bfd5ff3256d425cb7055fdbdee04837e03b25ed30bee3bf879d569f58766ca09156c9e8313af36660325e8624d9b6c9ebe8ae1079d4a0197b62d8e4b65a5c13305fec55142e3f9dbdc60a2f1e22fbce1064a0d17ed6eaf87b4ce3023cffb15f40878919be5fb273027c9f276c3b04ea909d06b3ed42b117bea67c06208c93208383395b81202b41e6e46e5d51b4bf39ab426f3bc22487c2e7419e79e3775dc6d043d2f2b85986a338a20d19145d3935256fac8307cba38de628907749d6b9f63cf8e1516c24bf314f5a8f8092a2950d01de9fabad153e6ec21e9c5f7c1cd2cdc2e066a179a51785da3497e9ca9d203f9bfb0084d5d0d749d48d6e67f8152603dbd8755df8ed8a7717ab247b494a2ba9969b8fb803ec5d5bd0643b13ceb7f7394bca57b4312561899f14f3a7f70e722941cb35fe8daa341ccc2c77b54c8afe028701c536fc839cb84c9858157be4e548914faba5baa42e4288878fd96ba74bb77d983af12f643f0583d583a07f2c509181d992ddd45ae945b40d52c5da21e7c8e07b042f3246bf198c230a375b85d06b26dd5c28786157146bf6c6f8973c25c02a0793644e4fdb1543797a1244ff232ddb67e3afd29b08436a14ba5ca57162a9fda7459c62fe00d65f260c752bc5866eebbf79fda811e6c9c5eae4e60b2a7ad6c1fb25b51c4315e3e0847b80abacbab2bf73b4838469a34a4246c240bb2c7ffea86533719e5567ad3bdfb678360033979de4feb5c89719c3b83c0d9b1c9e18d52cc079e19fa3ce064ed3f619a43422c8bec01d95f5bc97fe75e6fed5abdce19e72c8b62885c892fc7c118b97f9b28899b5b58d5643176eb7877ef8794dea1047c922460fa301cd9ee1dfa27814f3d732dac0564b806efc94f9ce18ba32fc54ee5fe5e1e5b83b79e45592565c8329f59761cbf5bc01f6446acc01f033eb7c8202062ccd6da9916f11822a90aabb1003addafe8d99d0fd41ed21c350ce9afe9cc53990b96df3202d54ea157205a68285be876e55475baf22b4e295650e9450a2941261fe1926bf5757a941a18d5c8dd62710a60784abb7c4aa68fdff299438b5dfe26c2e8c0d88cd5b1fb0d8bf303aebe3e9e87f761e21f9463507923cfcc08783c844518209bc255ca19703794fd668ef454b9cfb6d24e5fd34b91f69e0d8cd52a203185d3d08461deaf576e9142fb23bec86ba7e7d18a6f6ddb96347e41301f5a3602ecfa7a9b04734856dd32c5d128865a3e0727483af6ad943578120437e660f32ec63f186c39ec655e6fb45e58b5b568d0e4737f4f2636b88677907ec986198fd2643f729ccd62dea16baab1da2ee3e18c14cf8592c4e199c1d62d07954e5950dc0e5793f6a727e7f57166b5cc91417e08faaf06594ce324f071be55a17d0565a446abd41124dae2bf0116c6ac24b9e4a23142cdf10de6ec3adfa478b2b870aa1bb93ee59f7a41257adcb9363f299de1f5a5e5e11b811ce4ab52b5ee112d284b65e9fa90532e6d497634a8e42296d8bcf22b4943b350e1305fbc14e5cb41b92dc7d57268cf5e73ed521cc6e1b25077490088c5c1e82523dfc59854ad8d8c93dbebe7a36d04ace83bea6f07541f2509a6755267ea0997f0b53c309ab803e72420b0bcc03f2eaacb148127234cec02a5023e26b3d538cfbcfb6a38f8f7732956f05f4ab514090b1e0ddd5e9ec89a5a3b264fce97c590e064b239b3b77f4ae25c7a77fa7443b4f8a8ebca0ff6c68cf2f9be41ee4c02c2955bad424d3c3b8daec25f93840e3319aadccad76b10a72f7f74db36eba8538e5f62741ef76980a2b6bd2024238e86a74939d393ff58e87a3d725bf624dc413cb16fe46647221e2f5b362a81f6ac687453205e6ef1d5e42aca59c418bfea854711abe2ac605008cbe9d88ba315bf9b84f47b8f1d8a457f2401a09238f0f07123fec9e2d60f4912f64f91137abc60b34fe184d830181e45f8e9532532222457063432066bbd24d30a0cdfa0fe7ceb3c9a079063680f00f90aeae885a11be48d7f9f6aab680a39205c2a97a26d1551eea50d84f4d0c6b117daa48e19afacf682b6470b39f998e7608a2554593f7afa366407da41ba57255dcf025b17123d94c7489bfd061f197d55eb90f083953af51b5a7f9d5b6cc720648a92750867d6d46b1be7d83010333e48a28b7901801772f65c4aa5d6ebf0d97a8a5cd6131351338aa292d31f52aeb5a8b1c0c659ddf5d075b1eae7474540448ce7c0335588208d8e79ca2de4bc5af7f0a9809028d69cca7508dc676931632713f23902191be6fbd3b955105be166018beeef4d859065e1c945021ec2fad19934935b3614fec416a9e00ffadc6e857428dc963915a51116680c45900e04022f01daba4c089992857759ad0df183a40804790df14e8480ba57eb4876f9a3e3be83dbc4c95c47c147679d03a32df3b75c57a28512befe17f3f242b0aeedb6ef916b9bee61f3c742eaea200a55ff9107315c408f3a28cbe41e8b14635aa0914987288b047666d637b9d57afa98c1a4888088e906be84feb1c486ddf97e1211eb6c12a5bebf657a22514d44e2a92063c3bd120154ad65af35b00daafc7046b426f0667e08203c478ee1fa84bcc2017b55980d0ebcf9d3824186652fe5410b3b707cf56f38b61f39fa5a2b7fdf46234365ee406be04b34ee69ee30585799846e71a5bdfd8e33c91b317eb1c8a88a9ab2e452634d8bfe48a9b0685b38f635ef58de706c1b67e16635d77ae8535df87c53dfade473d8ec2f7f4399fcb25df419cf2faf09745e6ef8d9fab0538607b3e004cd4ab609030f92933387ee98bba879f997bc5824b99c2b169bc2e8a9a22d8f00c7d963889951a628d2e9371c6b310a3a83917ee744f385a4d1457f14501b8b42ed405ab9b835581951873b70c7843c156d44f3a6d903be5684a57c6f313185bfb933cfd05e8a264adda073052b997e5d09a2d84b44af54d92b1591a0edb5f7c73b54d08104a01a129d11e9c2ffa250d77e279b4498d92b89d617dd46694089820730610eb9b70437d548e90e982bc66d1f2721afa6bf6a19061a41b574013959c29629370313118481b07faea5de71066257c1070fba502ea33465494073a7fde93f96047bb979359b3bf6e6d79cf0048ec9fc158ae9e2fcf2826986656bf3de756c83a021827338d63c5f461e430d9bd9a47c2cd94143d53a209bda32dbe328cb93a9f9224fc397c3eaa7b5c7b419da625c69f81cfa6c56e2bbe3e801d65a1a68e18873387cee6ab541d9034d30bfa8575304b110f0cb872d8a8d4a7c6d6d21b91363a9aec2fe1c6edab08e466ac6112711e007afd003430a2af4a15d6326b58cad062eb1a8039518bb8be6ae2998a962283b5690355c0da3f4438046b50045b24303f4ab369dd9541d9ee4c5f113287a3bd25a2902e6ff234b3f4a3c2567dc4dd3d988a8d2f95cf7880231a59098bfa2d8410b2551dc6868b1bb76e0972aee326dbce3deecc918d78e89a2c7095b8468cbf5171ce3de33073c57a26c4e4fb8195fa6cc1305c742c3c4713623ca274acf2b437b81548b9a2301465d12b46668b6aabcf57da178ec9e6824896937ab32238566b306331471d2cde7c98ca3a635031509f29e3fb6a0d51b3f088d033bb97b4ea1b79b5dc5698d89ead7d511db6de7f0b4d0e399ce78e1bc143a65b42ed47e741f6d5078498c086bb0a58a9503d1227abbc432548ae7f56180a67f226989263a967f3a4ceb3a789260c7a36d469f74a210c0c8fe368858909dd63a9285ddb15e6e83239d1fd376b6d007d7f5b1a26694e670efcb18e02059166f6856e2cf14b6a12c5dde1d5f132611e18d1881df0b81e88cceb0b93968aa0d4105e3dc996c5109b849676c342139334a0cd92f0ab12a83dd496cfa47334f9c1a7581a54d26c020d6fe2c7feafd7aa55d140e560e3722487845a0d034597e627fee47765c416f7ff151d1e6f97ed6c4faa980a18ae33af81fdbd442b878b9d830b38353dea15c6ac53b14cca4be70fae4074d16dc86b3a4c33179566bf0c8b7f646f553dee7f28ba589f94ccb539db2fe92ac86d163e1b7101736099b6b08f5309d8838ec67aeba52e2cac16f5ecbdf66a411ad2ef5207f1b3e3ffa663b5cad79886baffb91c3aef246842d5f38916e19562f44687078a312a10439317c6b8bf1b4f41361d9fb109085a9d928db130bfa1f7424fba3cdbba67b42256345f92437ff1aaf82f7e1579ba3f20924a1eb5aa336bd5979a2ce8065e06b3b28159091bd99a81cd4e1e81850c20e450e7b867fedf60614d3eb1110b3ba9d4cbf0b7d5084a6e517faa9ab8fc32663c0682ff143391b8618dc87a70f2967b872d03d714bedd132ee23bd3360eeac9e43f6b4721e78352fe3a2f962f9e3b9a79444f7b044e779ccff9281ea9c2e21cdf4ee4447d45ee62dfb2dda28609f6fd3f2268831c97ab1335918b431268c533a7ae6385d60685cac12b5679bcca636114f192626c9ea3d2c84d69a29e453e5f01b26f167c1bc567733cf9321901fcde8fe154a15e2543487f4a78bcf243cdd6051531e154bb7752070e9a1a2c216f31c1c3d1aa467ffc52aa563d028cf239af680b92e1db0cb08afb091248e8d44496946de7fcb87c6649a78129b8bcc663cc09366f3455e5259f2b70114a57034558ed10b8099058612a0904b092a8647a88a649d8ee99b49e53a609389e9ac40d37d3d2094462442c8ca310dca8ce376bd480fdd3ad5b0efc110de6158b84157a397080ea0c81da1364fe9e69520943c227e00d2cf411fb08f07b55f24a1dac8c9c142ccf38e69d0f48417a7556d251dbd464655fd34763cb642fc8e00f404a450d2157b12a172a5cdb16a5269be368b67d5708a08767c6dbc52ca4cf34cb06ebfe15e67b62854911cab82a5d6c9908cd50c908d5461bf965c924a79215a87828b6cbc770d9aabb144fe637243b0bd9fe3d45cf6a02765aaea62fcc2d5486b35fa3e5385ab4a0104a0952b8dd4067434190477783e9367177e1fcb01c9c75481986bffcca38510cdbd4af88cef9eaef2465118b36db006e693899a5bbb1f3d1063e4e9c963559c04ca7f04bd3cfad18ced2389688724ae4ef5bdea94bc4379715112fa840d376790b45efcde8bb51f436970b47e8df1c568cf4f9d34df1560d173866e64a7b5c0682353f3cf00b16064f4da0d03c7a88afd40482c845e30db539badeafffc7d333c78578ede710404844453b5393eaa4c9396c2fc11a7c3d4f4d42966bf817cc8abd0c463a2f9a9fdc66f8ad86b8dde82d6672ab1d928698bdb093d0fc3ecf7a3655d1f115eaa15f528bcc71846884474c9a99c3a73ed891359492764244ea7b7f5c856821718a869ef21e367b437e4fb42928813ce0f5e825e1eff409b99a25567c53b194d700c9ba94319240bcca9d00c536bc620d6203864b99d392ed3b0a7311a8d34dd8f919bdf3ecbacd5d06b40ccfbb44bb475d64ec20251e11f9042721dfb46bfce3be45638573e79e4724b520df15900c3fdd9aa86d380b8d11106f7ba296726433a522dd02b40b121b169c187e81006e53abcbf38ac5bfdb8df072907941b2083dc01a9ac9984dc57c5d1234771a6ff70af116dda1fedf61d0967b547d7042c7c2079c3a918c65e6c836e1d572a3b13cf599e7e79e43277100e7820d578547f3eb5920a23b4244bf0e24867b1b63c0a57a912cceb19e70fed50f32a17177c0749ca2bb51931718d89ba355412a4f34812a698c46e6ad25a8ba00f2bd06a37c0c8963669cec0ff4f57932f8f02790632f1a10adefd53366c16c77f69ad69c91611b381418cb390a414af63088f1969c9da6cd92159ced44abccdfdc40ec242aa6324a99d92ca652b35a9d85bf001258b55df08c9bacda57abcff562cabcaf228df3242194459b49ed8baf53095301c1ccb7e4ae95239429d4245a87783a74f7ab55662d45f44dd14bd9f7a36cf696f21db0a59ebf7a4965d6220740d5904e839f0947a823c448eec48b21ad057bb6bea857059d54244b140342e7aee3753a981f7a6d53dd37a84fc49d9853b55814535de990c7e4681ea9af283702e98783d92b361fb14fe79ed53a6ffae07b5ad0417e8a789be6c30be902cba229a0d1540bde3b5eeb95ad955a5769db7ab63fe691ac552d0e4966a845e353aeebaf39987cab92a8313d65829e464e9c81ef55bcb7dc3cc5758d2c1dbab85d4a8a9ff23bee0c8e166c4f4f95be44e526166765213fef91148871659bd653009f96d1a1314825bba2a4b4aeacee0345f9b52967c435ba763e2e91a737e674492f41cac37f1c384421c43637f82af4704505c2d35d8cf0efa2b0891a4df7246f4c9f1d9119bb1e6e20eeb04036a5780395af219c3eb43b27e3b8d7455214084f2ce3673c2760b9125b7c7c9c32e8f96f359246a28977407b46c4c1b57985d5938aacf0681bb254d46332af4c590d464caf6b904e0e8afce19bfd4268409db85bb1b739cc23e97a3d6911d6fe5e76c8faaa9e773d4a8391a6182ca0e25401a54c2ed69008fbaa30b49bd8bddea9a689911031728de52e013b5ce1ba668524a94ab64b1daf3a1460db05","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"db2470865aa068691185dcd60d0115ec"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
