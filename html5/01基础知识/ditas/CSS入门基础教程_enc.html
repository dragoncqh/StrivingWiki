<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"fe11d6b92e26270c6367557f0dca84c46831285c04f780a0dd8127c669bf6b5913121e911c24bf2d4ee2395eefdd10681ea9339ec114115e6e4581a82be8000c69af09e6bf3ef74b8e13008d4144c424b09f855e6d4b7fe4ce05b56dd29f17293830e288ef2b69f346dbecd5705ad8d5198d3eae8b81e031bae1398b67df48fb03fa3e0d58e56eeff72a0ed8cd0469a1743d67e6ab0716a04ea8c2983d0e5d5ce7647c970ebd42775313c696f4675233c9bf005c75a3cae1bd676b30f9ae74426bcff383d52cb05646205fe91b861f1ee8a0caf3ced9fe025707cbe964eb89fec091c04216e2a10e8963e0541bcf1c36352721d73f2e5d9454daf68dc49ab44067cfd30e0279c2d91442773c514df789845f7d1093a38a03d5fb8f82510ad4541e859e17106268319d6d12ddc4505293dfe4010d1f71125cc69b26f61a7918c843f9f030b7778a46c15a8c01af710ef64a8adcf3cb942ad495c238f5ec3ab288a606d0b0356ffaf9114f3d401765819d2ca2e9f73f3b40d7c19697e8f73e9597301b011d78813dedbfc2258d251a45f7b69487cff6f2de94acec4fb6b0273f346caa52480f4fc4c07ab45bbdb712182bc1bfe2c64c5e527acafccaa00fde1cea94b7a5da17bc9054e40f30d6fc7871f1084fa8af84d4389dfa268228bce9ddaf2fd91accc3f782359c6434ee101ab89f23f1dbd9c3ac7d47beddfe0d94b9d3ef832a6983bf4eb12131fab1884d2142afa8ddb12cf572073cb2e26500bc6893471c6d8807a81b1f2a346b06e64bef55e4f5e3ac43fcd5ae6e7d7a70db7efb309a77155dc41cd0cf094bc080f79ac6df45203318911b5dbfec56a80b9a4a3ef2b4944408d11c4cba5c0b7b2c1c02c7af2ae1b5fa1dd0475f870e52feb72998f671063fcecfbb713f23e43b1f2ed3a455f6878004f1e7b092ef440a9e913814e2183bc47880cc9580c0abdb5662e044df3a259851c0a4fe966b9598e93c504542021d32b10b44989c71d581fa0735e51dd7b11d701bec53b5beaaff263397804619a06240863fabfbd88638d26bb1e28f324adcfdb069e87cc7ce4a484033f92526f8662d1cf3d97bfb473e204318786e39d883c2838766ccc573d38281077b6cb4a551d691879c28d60ce6807ca33bf02321a06f92e4634d4f0843f53c9b4164c92b11c0d770d787e9dc7761e94b7c2109d0f820e39c20123a5bb0f9690c5eff0882d1eaf9ed8d5d5628f8b73293ed1eba28509c9d4e21628d195c1d2b78dc7fa9ff90ecbc499817ecc5c72f3a7a8ff824df7d48c3f5925fe74eb78f0ac121e72a74530bd4eb84409aaa0db43b6589f8b70e9f09763f2311c1b599e696c488fa3404b96893d9910896f2a4a6429b44d86cddddb009dd5747b2c5d9fe8585cce3511e8861f1631c49b30949f4b6a3159e206bf7683334ebff650756218eed25710dca5c384f31c8434bbfceffd59b0905bf83ed735557223386905fbbe51edf1a0e3d424a7a50102d975a901d2b8d5af816079855b1570d1c3724d09f92978fce986912fe885169c1d56bbf7473f8816e55191922d1e7f8339042daf6f69935161a04cf4ab41c47f52e59ff106a627509d52d4cbaf077966f19192a3b4f2667bee1b81e140ebacea1c29e14075a43e1c73f8a0d4738ebd6af084c68caa254f9fb4279173ccea9730f9e5e15774d60fb5047cd65da6c5af24c4d5bc32850926eebd2bef50e4c01e5db5330a6e5cd33791cecfa67d08859eed895173b12ced84b69430bc8c1119eb69d45f5b23d477c058e71432205525ef77159a1d1a058a7d6f88772a7f30c48d3ec329bf81b8fe59d70dac09627914e347c1ff63cf52e18c2215f9456ea1936dadb7b256a5b6509876202aa14bb9d68085b66276dd2351c80869adaebe01d18c021d7301d441776a240f84b71a14446a78af11ebb266655147c635ad282608af6010c7a3c34f72460fcf75891b083ecfe921e509ca9d5692f646665df2e852bc87f6a48585fae7673f71265912d2e2e9c9c5d443a0a2f31edd7207e5241c20bba10d18aba2338086892f753802eb544f7768dec17fec65e5747927817f670fc8cfc8e154b558bd12c19a75513494d403a6c5e4076c9d2808d4fc05ce443687f0f012813b81b30415676712c7e52efb1c8ef6cfa65f14656e04c2bfd58902b09cf93bd69059af2eea71e3ccb464320e516ee5054eb2e350e09437e25f28581c2ac6e9b3e55265bdef97ca1a2fb3ad496e54d2a0cdb9df7764557e7c1f1ffe5724ba08ddcb3df6da87a71894c495f2b0513226f256dc8042d7aea0aa5a28fe5d8087bd79b257859b54b619a0d874503eab13febf20cee7365aa08f97b82b299e0d23d2ee68e2f5f601ec180a65f5cbe6c0710b9f005d94de650f5481c137da24dd942f6ce19eaf916e702fa482f051e87bae759cd758702b3d505b865798fe4d79b5c4ec7f052f4150b566cf0eeb96105d7ac07d62f34b43826d94e5ab8a45ad641884e88109ba4f9167809529e238d67a5a5d0441516a74faa9f891da77ccf4c44c2177c95f5cd08a9fa0a0e2f386e8943b9783ca50bc0ff5b6a3aebedc4ddffee87c0ebffb6816e59746445d80bf5c82add80aa24736655d045c5091fbf56e0bd53f1672645babd40f93ec18e95fe0d9029e41d607ffcdff25fa89e2c5022a536e362e4e9b25f49f5fbf5020ecf3e15e7adad0c790e1fd4c341157648d4ab273ffa55cdeb5f5b851e32a2dd73e14e979613953a537b26620572738cfef2348e88c73b03b57c58147ed460f6f83391cc585d162c8dde75ac2cf889d001437a7985ba624ebde19d186da8c5494389bb36956828ad60e50046cb81b029c1988bcb7bb5578bf7ac856a6b9a84daae2013ff9823d97c7c2d67fe4f34fccc23b01cf63ebe1db293744dc5831725824f3716ff6d4d3cb21915d2bc8355cff2cea05070c68b9ae0ef483495fc411d226fd7465173c72dd463e1e353c0178a1783fd745f25ab2076713ae5c9c520662a1c4d76f941616246d91f60b0721de20b3968fe4c95f28b1d803cea3a21ff652865ea4f15118625633ca15418e9b2e4f10bda2d17725b1f7af3445fd0f05963b5c6a154711c91d0d310e5ea5ce43d6c9f40109b5295e799f6d69642e4fbd056e8acf17901535461bddfc22e923f4baca941e3b697fa8e84e9f71477ee477e05d6eb357c7ba2f9fcfe7ee55e864ffddcd9c3fde16b267b1b8b39d24faf20b2bfe04baf964eb568270f095cde3e61119a945ad05cec68990cd29941519097229da29bf21c81fe39de32a8d8e1a1f6b2d037e9304406b1a5d6d8db2209b38676491a4cb45ba7c6b601b469a32a59ac8d5581b8149a7c3bd26e3ee9061f098f8efe60838d96c6a02c2d3828413b3219544a2521850679cfd7fe91e0afeb4658a85313aca7f961265a4709ccc61b4090f450e365319a005c1818009644163f18754014cc61ae50af4705861503e274dff5e140a14b38415c7c4e35bdbe20f67f11ac55ae2b24303a093fbc4f57cf618d2830111ad0ad0e65302288f0502e6adc13c623140f9e27f45bb47d09b2b2357b9f851fed7526df0edee6dec3c193dbf2dd9bea2e99f9fa8964c1dc219b6ffc1bfb9aeedf7e372e549b2d164db3bd1f3c61a78ada3cb22178f0b6c04c9881ff050f0bedfbe31187ed82f7d57419c28fa11987bb416fc50fd8f47ce6296b7f53dd94fd6d0d77dc353a1a3275502d9065ca10b3c32182d547fc75518040d624c89057b3ee1f72d46cae907e8f34e95457ec3b4bae5e0086d5ed9260065c34504e12539fb2ab08ad15a840852341850e7717e14568cd8e737d83d4fddc37b4258af1615b746bec05c3f63522636d0b6053869e11f3d66b1280ccf04a5a94a48578fa4ba20cd73714e21996d84df7a02ace85d7bba874883671a535de425c38d39a41bb2d368f45d3046a0d42f040f30d6ff1d8d8335c495ab5f220e7c254dc4bf49d3c8d88d2a1643b9363836c3ea9084404836af96cd55f4a3f42416e3e41e06165151975e6a5245a9eaa0dc2b2c5ee5c3480b68e1cf423c270a2af80c534cc2d36df3d8594ecb1a2a2d29d49ff27d312b95f5e4b13968707ab08b77078b821b1047302ff70c408e75de344ac43188911ed54fb919f6b3837c57c164fb7362bcdf2016e57ec7ac92b751db389de75e91fdd69b465f85c35a03bca6a7c3cc95774ba015814b8b5e2d1fc4ea1ef78875fb269d538f2c58d85ba779e4cc9023716b0ba5a893f2ee8f09e2beb984bc0143cb6a033753d60c2e11d0ffd4ba8f4b76e4774f208845e1bfae951c50ddb216e2dd5ab7519a2f0a9e8faa791f16b65e4aba244d9765fdbef3da07cf4ce6d8508ba6ba9d4916dc2668f8d87470981f8e58e57418902ece276889c9855f1193b0ce26e66434d544a6269aeeb4bfc675ea2fb4c89a248cf51934b6a779cd52934ca69646b034f533e7b5d940edc8139ae7ac030e6500ea326d26b719202bd092e5f33f0b5a53f28deeb7bbb48f9bcfd299f4f0e6d5d745363464e55babd0201b2c5aaf3f9eb3a98c89bcc07aaa6dcc5fa7665722ae929e98d35ee87c987b349c6b2d86bba1c51cadb90d6f2d6e69ef34a98301f6e66c91152d9de63b90b945124b000a1e707eb2e2a5b499e25cb45f0d397b018932546c77cc1ad2662b8d0c3551966694fb372e059658411a54326e47662ded7fb68cfc503f67438667885e262d9bd1c4ed4bf8634411eb6774a3756828ed6bdaf48ba514692d87190276c2046831fe3379b1bed0b4273141f3f3eda76059a5f63bbe39481966eea42b66d2e852f99df58bfb7250474da70c8bd10eb8a24e30c319fe1e067df803040f645afa9d491d4ef535941ebf772ee974e4dd71239c40ac0c5bfbb3a6d8f03d99c2efbad6a99e66d517164d5f2ab9a9c52caaad91a1e0b4c230cb15032c53024a3acc256a87e49b574bd4fb56b4644ba99a354254b65ee0d7ad9e0cbde3406f2ef2b4c1f90da9daa0bb5c2729ed4bd135a3f8e65f941093f8fb0bb439f6e9685fe7739fcd47a6a51e5b70a2dc9239359ff6d5a66f7e877092b92c49299d5b9f4f21e30363b5d43b5d05d084dd4cce2b2a1875ebf7ccd1bbdc69ee642c91f1c390124c8798c9ceab32652b8b12b3b2d67887583c99b3db68d7c939ce8546ab41f6c8d7456db087a764e1a8df4bdc1f7cdb56051a0b3ddfde12e46775ec983378cb153b41997db4e0a5e88a61069e47530ae7219b50459f2d312b4cd2657be16ca0504f1ce4bc3535ea14b0bf7833a496e40be6e6a8f29280b638af23f2db8b5ea331f8a827953c20f36d1ab3f2a2f5d4644c44cc701f3d2296b57420cfca4fb17eaa520883505cf810ac8413526f705dd561331fab28eac8cd161ffe991671da8189ea62556667a42461db230029370282ab491dbc9510b125beff99cdecdfb3cbb323e763455279e3a3e7a4348f0f145405911892089c17191827c1bd12ad046fbfb4195e7f82389b72390f0be01a3db977211b4a3590068f147a37b53a67d8b33aa3a88e67e96eb213a21397617718f06a8d335e09bf6eff0ab98e626feb9d13c89042702b06fdbd3ef0645cc484d86bec6b12e2ae259096b9f43a5b38fa43eca73569f7097f09ac0f1e673c2017efd08cb0ebc34822d9dc61f983b48362abee502980b55439097ebfdd53ff14f989926249118ad9372f3924cfd6f8f258c55a37b5475a62182d9a8bf327e5e484bdb3c7063b5ac56809a201c92deb1661dad76bfe834660f229ab46fe364bef23f02714cb7111560710c3a31aacdf83c1a24bbaf8047ff325e454905165dd3db0b22d63fc0a9d9a6f47234f4c21cd7dde743dac9ab5b3112b2e96f31c10d8ce8daae2dc2e961251cf3a77b2bbe963a95d71d67073d4bbf72bf3f23d022d644bfed8c86dbf66abc7faeda3a1118222724d20efaeaa27009848ee25629919caccb6f25103f37063417ca73830869c9f176d2c0db7f08870d485d9f2da76370ef9ee905fff9c490d8e3fe28da45ec1171294a756b0a0ded0d663c1dce07bca4f421fe06ccb6dac04e4ec480ab2c2f2a1c1cd926467a664d7c31b03301e44b6bb5bb9c610f41d68001b01cd9d203b400f64f465ce70ae79409a68a8ce217099aa860957b9d1b9155f8d70ef51b82b8d1fb44d64b93ff23fd5a44e2d38416eac0669c00287121542af97f9c28dc301579066a1ab4396de445e219278455507f03d1440bd64acb8cfed1333a5d9c80548c471d856db9e4cf80798156699b973cea38785f3038020978f0fa1351a4a2aaaed7520619a91dfccaa8be0fa8024bd77c2f6a9b7eb77eb2c3cc86a9e334ab8571e4153a23b40479e5a132f4ba3baa17cec2f66f235ad580049e8b25224a68477c5eecb4ddebfe2f7c8c600f11faf225e0827c8987554cc068c1b0d5ca4eb09b8c7104198c12ceb2f3c897dff3fb7b2606ad58b113a16c696456507c2a289cd994d63eeec344652c02fa9417219b2913a6840fc15d12918118cf875d37cc51c5f19250dab7d70c55dfcb6bbf5030bf252ba9f9cabda2ec596f5e0f694fcb44a7eb0ad86ae2ed3f1fced4396240b6544e98afaf51fbeff42dd6a66c5283e5c16a9009e9e31f07eb0de4ef32ef0dca45d3880e9a1ec0034544e37b6fe943e782ea8562e7ab186189a4e41b3c160ae8c192f451ecbc6c5bfdc52169bf671908d8ee1eaecdef60358c372ac452a7db948c007919567092b98c98387759f51c838b49fd970504a4aefcdd62cb8fe452a3ea5db2afdaba4a102eb2e8f77353e9b2a3c4bba2613aecc6d714e549e1523e269e09be8caf597377251efaaa49d990df770eec07752277eda0a81942852af114756733ee3a7a057b6417701a75d525002b499d596ae65e6ae1295098cbd70eae210944fc40ec46b77c9af16d6b4cd410604a727f36cf54a06ed28a5958950dcb2bfdb8760e8d711790080f15552ceb7a6165bfbbc3fbca7b6b5c369b2443d8bd9516b23164f9fe5138f2737a5c7fdc95d4d6bfa0fa1039fe812b6dc5a5407c18d8d6f5221a0795e40183490e00f58dc73ab88e29bba9b936e217f586c60da9ff1bb605a5d7f020e79b6a9a009b88c6176966da4e2b8659d1c0192dfc58a636bb35e6aa05495b8fce5792938fd5965d0d43f2292797dd3fbba16fff510fc59a288ce09ff69ca950d17e585f2430fb2a811c8c56c6b5aaec42a594372fb3f57d0f67b7117680a3e8163f533bb17eaa07eb389934354a646c3b40968203a8ca1806094e79490a09dac2792dd73a152f3ee13f3c551ee78875b9f66dd4b539fe1ab64ac531d648e119a142684da62f411c6dfa7071e01081653ae0e8011cf757089626aae548cdc005ecd0f0621f145129d33731de2fa3ee2b121072105ea6d99cdc61f82cf98c520b23f0f7213587b934ac257a1b7a079af75e58a106a085deaa8820a2a2570b01aa66b413e9eefae22be020f8de8621f4b51dd8722c090c19c5cf2ec9095f99de164f91f513d973feaaef606cbef146e59b67813536045b4fc360c312d02286ed1fc923457cdd4d8bbd100a29671f5eb25561bb34a8a08a79f2d2b13bffca1b12609f1f811d05c527bd55e7cac42710aff4f4341fc1d17b6493b905e96c6adc8a30c6c300b07ea05ed7b950decffff1fdf416808ac9c31e49d14c8d383a18cd058f4787f700a18a806e9451065a293a5395c4bf9f41a99120d337e88912705b129271ef28905657e707a55dc842bee13f114409327da2bb5d98ebfcbacc424c0fe971ca322d4e289c97cb9633d5e4d59252b30012fa340b0cd69efb91b09c7648b4bb4169986c2053cd73153da4996ea6a694eac225a9540571a4ba9aecdfdc780cb80ffadcadcc6018e05eb363f220ea480cb0956ca7530193e092f590430caabc4982f17f754c7250e4f7a33818a3eeb67005e1c7a9c9c00b99f717a3e6ff85b5f8af9ff805dbe86d3757c0d01c09e3bb640826496ebf31f3ff7392a508d6eab7077b6f8ec446e0928343bdcb7314b0dd6cc268bcad6f9b1c5a379f247e064481a4990cb8a1c271fd0f64a85102d7f4378a139fab7fd26f3bd261cb9b67a4598d59db5ee627ba23ed36ed54fe120d11da97beb0d2f4db194ef9a5c5c528a9e032cb33289b009bafdcf98b5a656d961a577dde44a4f9de3bed575e86caea27c117e1a02cdb4120e3283cc62b00cae573555050a7eba2e31b3e8df0e1d2a4143884d8a9b935fb9c15fc9ee30f4e3b81a042b33baa5550fc9cfc9c7236623a5829a72838604d93b4a1e0b61bd2f752ed744d62b5673aab0945093c4b622e6bc71f55bcd70ab2ca394c557b742729d920735fe7294810f3307f83377a2a4ef8512af2a377c6507883dbc73d2128e4fd0b1a460300b97580ae2608460b9d67b0c3499e701ab9bef0a3c0ad88a20dc0aaca1d0ebf7be7f932b54a78240200d359c8d3af49dab465a8fedc5487ae0366c4af810402b203ad3b06300b0545519117ce9b9679644a65d1ae087e1e8ee6208ac3f4d8625aed09ace2f796db55e69dfbf1f20f3d2735bf0830dc9044909ba6b418cff6f5b7f426c098da7845f404158e9882c5450f354dc3ba2d26313ba723820696ae39e28bdd429d371dd6fc44cf448911a3020bef13fe51fccc50df050d62dc071519f1709bc7e829c1b19627779fe3bf0d489be82d80ccdb4fa6600a13e74213fa31d3b05fd5a070924f1d119720fe71b57d44580bb09b269ed91a3cb6b2a0e88559f16158ef826329e94cfd0dfd0424c33bc559cf3dfab2e7f73cc4026c55a1cfa71c4b254e08dbc778431bc311eaf227cc8560755cb15717f4fed8efe2184cf98d595d2b83285404ddb92a70305cff66833075474cf11364b6d1cadae48cebc633ae1d912f84646ac627f59da48d5bdae165b2e52f8965a2bd879032f580fc872b0be867e12d8cb2e1415aded6bfa7bad41bd360d7a3cb535d9792a71650e9b5a8e91507aee83ba63ae964670c523ce1b292b67b142ad3f5044c8ec8b7c8197aecd3dc526b990b0cdd045df1949f37297fa26eae14bed1841d02086682f980ca084f822456cdf994b04f12b5d50b5c7fc98d343c9b8ad627c5440323de5e66b337d5ca07d8e478ed13bc0f04b72ed584c3fbe84b1124ea51f1a1129638d5d95aba05b92f310921be88d0bde4f3ca07d8708a9144d1325532bc2c67bd56e57ddbee512dee63019865d29fe6bdb9a11f5b9f4cc612f8f8c851fb370894b37ab45a0a855c76eca7f38db207e8dadcd270ba027fdec0f847bb48e298b236c1a9d98ff93baef224466f1561f4eed6b03f4cf1a6f548c6c72050a956b49172ebd0e1201af914081bd54f57ff72e5a66c52b1372186c269e425fcae4ccc332a441fbe948a87048e1bbf6cc4e82e28a0c458a2c6f6a0377453d25ae55b6f17fc8c9550aa3e96004de6129bd4c70ff65fd2bc56391ce4a924a69e464c66d8e8464976c221cad5984a819f19da46e56cab54106ac7918412eaa44bfa51dbcd544d398245fee5c1240bd4d753174575aa46392378a1f546ae2157c5466bdf9580d992efc99f0930ee00c0079ee1a7181c36246e9586442d2436112af51ecee20d651e9b00e9d73a1b7881177672011add1089f19f85a1deee97e22f93bedad2bdfe066cad577548145948e9a714912900a1cc9f5d1aba8e9a1fb04f6cafa3948863e708b0d92e65b3c6db220ff6a8102ee4a20812daea20981b9dae6f4a6dbff29b4ec7a00ecfb4258f6de13b3056c1086c1e4858a800a70871dadc007695ca524053d0853c327783a8ba6e7510cd476b779487426883d14d1242da4c3f0b7235c4cbca956efe9fe6a20b1ce68d9c4e9c36a144ca2fc57be200f79970f7c9c7e16711732f0f07ce6c419fb77ab6c05a79980669368fd12f37c0f98a19da6bbefdd58dbab058b00e54f6d7941cc44350a885a7714517708999c9598d3904ef6a7dd5d7c9b423e7243a9d8beebfebd82aa076b20be7379d6779d1fcaf50bc1639fe2943a2d8890e88f83d995038e87276a0b74cefa1d0843cf51b60f2b0e52c26ebecb5c2fdd0374c0f4f2e45aa9d6987b3057a25797bef6e2038b48058ea3ab1c4342b188c3cc8d0540fbcaf4c150c4cfe3c219e6bc0c6892c1fb8c987ed954fdf6da1ff261d5e7f555b683b3141a47147f27b8af662086b0ba9d82ca9ddbd2057c19d43e46da49223afa125e95a282c8bf2e2be4f7045da1651b6ceb9efca105b586d77d1f8c1a65645d1a4f0541b9d34ac4cb10c68fbf2da060c9358a335022b5c553563b62145c6ff7db5a6dd0926123634d685e40add8cbc1af0dc3a762c0472a31caca9364d8310f09231e5b0b745c9c3099e659715ef818b04eabc654c70840f6b513e94a60dd273b7fb795455e95bca3ff457a5e37a98f695302881030d5309a3e0a8a7b264cc865ce64c73f795c7785084f9324d009544c9e5544314785daa83afcf2ba8a5e428a7aa42af9127789ba49d4d62b9b10ee22031a51f2813eff3ff330a582e49774d9383ed0e5077be3c99a14790f5b1e360e1725f46cec3a381fc6936f01814060bcbf47d6882fde176bbe6f8b8a5536c0544fa4f1cb73942513fd0e60b61cd600a860a7e57287aaed926a4a9b8d622ce5618624a0ab05d3c55fd086cd3950b2b7aa8f57bfd2c934bc835cb9a72ed682741c742f7b28caeba35df161cd21debf15bbcc670a738d298be0a0e2d40f5edd76ef5eddc45335c7e4258fff24c25881341db60adfdca50b08f2a07c4a9da02c517250e1aab6a580b0bb9ffe1ba6eac7ebb9c6d2ed11f42245f28c61de17b60e18c09e54237add96222e3e97940ff80035fcc018039528e46c97876b2058f31d21fe749bcb0f4d0e323c2d31c6784b32b2f339fedbe6e9c6d7eca4ebe4d7b2bc1cf8fc7c13b1d310b69e05988bc60324d3ff236a3e797282e57754d9ce3b49ba4f6c8851e6fef44092ab65d18cd351f2547c0e9c228c9864cf436d788f173dd19d7de8652715e0b77ad841ff13eb0b0b971c4bb95d8522143b9fc16f356d0b371aa312fc68774c01e7198a00db5cb6bae98421bf92f6975f4f64cade94b9608cd34acc77aa289e75104f2a5c82192010d2b265c5604551064a5586cfebe0ef72b07f2f4b82fafed30c9b0d970b5854230afa368b1f62a534cda98bb5f8bad4c4f269ce4a6564b8d0197c4994fdf326cb60ac530d4aa4e20e144108444419010f813f53209f9b1b435fabf8e06b52b03dbcd166876d262d9c51cb720e33449d01a1a5291a8262d3c06db60c54bdc7a20e7e6715d4e007d29cf9c04c18acc870bfd4421068442ae7de6cb5868d8caf077ba3dca4bdca2035a9e4b7afc3f876a10d2cc873cb4afbf9bd967213f3e8d374f1fafa0d2490fb867e8b07b3510d745eda527ca2e142d5fe2ab25e6738a947c62e854be00dd2a6068e74b6fcc2cec599c6d2bd78a634ce02e079883d3981d3450f518bd8a385306d0decdd934adaeb6729ef53bc0415ea7f757d98f2f501a37235c0cd6d766988d0cdb489fac6ec71bb0987235b199491a85b726a32676e81cb6a494651893144cc8b18b2e032a91640edd4baa8486d96dd07a0f7031153801be317c1970d50d1a5c75627a9ce603e0da8448c6dc291e0d663a42ea82debd14db833e96aa88c5404e955442d3df301e8b1ac2dd50f1a9bdec5e1856b11ad1ea1dac8cb13ad016359b694683a082d823d69927d0fef6cc8e3918e583b6aede1a139eed639563d79d56193812cca47f641bc709caff4417ea460adc14d4ed2aeeb676e93848ab1b0d06429899f404415100e4aad4014f69b21ee6f07449931c3fd09627916cb6695eeac2eeee390610d51039591495839dc9fe1e20133eb779856161f2763047d057d5c9b9dc08f9467efabc29c821b0f30deada95848327bc58215c54534ecbc200a5ba3af010a2a66babb46260fc5e0fc0e46108038de661ac2b7d9b34d537b3ea754d424caa25a928ac4294c1bdea73c29b2ab01ece10134bd9c465457bb2315c8b0ff25c2b443627c1e329d9157e28bc596b2ac6964d775b42bad4c8c30c9d8e35d5bc6154fb7b698b219db664cdaae4cc2da42a3d20afdaabeb63a2723a4c33d37894e493460351dc5b6c6d388df6455a515f651a816715280c9c2a0f87751b0764a59652540146a5751b786f2ff2782c8f2d8db21da5d40a7217bc263c2289dba57b88cc70f4907b3476f22d45833fba7bfffaff048b3f6b4d20cf040626ea5746e555f49c8c8763a99d1e895026557df154053f45f55c3dc94692a2f387cfb5fcc62f6373456c1af85cabe6bbefa6d136e062c358291383636a328e1650f7b40b304bf847bf670a199c580fef889e6b09b545220bf15b5d28dd1d8b7900bc7366455188affa966285e58f17d0b772c07b7bb5704048ab593f75fa6cb57b0bbb6580a77d7167547b8954ee9da2e5a9d33701af0aa3f7dfbb6a11d7470e4bd247e57c699eed9d0a9c0514b0e96c43169ca2b6cab8aecdeb354c5d3d4b7d799b7a004572de84205c696cf7b9906e4d23549027e4759e98d533a5a23a0dc069119e245a89d3e08e38d6195ef4af9e2b70506946b0f92d3ca18a5b0e51ab855b58c3aad102ee149078553b1fd70bf03fb407590ccc49eb66388608113dc52018ab02acc46422bc8f79dfe6327bee2865d93351ff802d0c5e138cc2c28ba687c970fdeb155e8c2c65a33e1eeaacfdeeb51c08e57aca48fdf4f34d538f2fea7ff2110a27bf68f5ebea0e3fb7f0327f7e13e455668e5b7312e6cbef3f2bdc1d5cb4b9aa891b2046887024bead783d1f1fab6ac61c7d3bdf6848272850339375e580ac111f44830a7728ea442ec214f6e6b966b3818e61b178a0b1546aaa191f19ffd69ba889c7913a0ed2252f339a2405779b4ab46f942f2cb90de5d86a0610e13517daf67fc7bbdb2d4b206af1152323ce025a8285196b96abd7cd4bd9ca5717c186fb8a422c11df9a05035c20213d5a677362856f67eff75fd9103f85d56a325683bbcaabe4aa3488a9662741f31d6a7a12a596bd59dc7a187d5029a5e250c2fe4fe8d6343c7378b1bfaecd7962acca3f5f0dcd9fea52181cca07976b63274ed11572c6e0f02e384680e45ead9269a878f2869366d1f0a8dc5ceaabd861b68a1a863f995d1ef68bc879f746cb43cbe2209781fba8dc5977bb4a34bc66a27195d9b7c852167b2462c960b84a074e3ff942c0807314f772b3450f86cc4aeb918135162f165ff8b411cc43fc7ae58bda1352b0c360573335274336b469e4af28518f8a2de7b8b0e8f3888b11361faef53724662d21e3ab976b85fa2d0e81ff6bdff8e7832d66c6961c20b49f71dbc7a29ff8b9dd4079cd7b6eca279f538f29112ec2f4e4e29c0d482d2917fa26013fe95de68dca64cc2d8424bf337d517de8159ec2e15faedd5b6d61e9d6937848448f5c12129bc2ae38d55eb8f8563a68db6afcb8108ded72f83f2c0acaf048e08e50567551345d2418e9b63c9a06d6fbf8fa0f7fffa52abcb14653a8d5b6e7096119613e444f58604101f818001e5d71fbc78920c71f6d2e6c8798d3e52c8f9f9fe6967b2aeca1e57ed239124a492a91695b4675c6533752e58531fbd39386baabdc54138369c3dbc77baa96aa92ab71bfb3929bcd91311d4f6d5119e612d21377b49937a6d0284d9afaf1a043419cc69148f59fd55495e2fdf1a8fe46acedd278738342cedc15cf414da40bec4ebd7c0d9f3fbfa55b022849f18cf5d1bd599693c1b8496e8cf9ef60e06f450d5d7fe5c8243551d5190ddd21497f9d4adafcd440e25782243a691542bfcb26b4bd8280c780d7acd42124d79d937bb6fb72885aac0ead579fd93e6d548c757896c4e30001a9c380c08eb778f6654a500ac294a239d203d66f436b0109cc92383cb79d00e02dd1ad987bb0795874773bb395d1b53a8adcbaafa15d13f9a6478f1b96c28cd1cb754de94728d0db804da46d3ae4fb3d3773a4c17df3736924a8f4a8e8ef17fdb1dcbe5b01eb33cf9539ef8dd7b6f5de1fdf47b6bee6ec474fa0f98fe2efda67bc3887741be300e403a220553c18659414809240d12e52634c75dd7956e2591f4a236006300fc41f5fe3197a54789078d0f1ccbef1a2aafd5120f75bdba011e414696ce16a85a6390d68a8eb6b1155d3fe388dd20e87206a30a15f24e74b5eb1cfd017fedfd12debd074a8096d1478060b182200da1ad4aef85fc0d95329e1f194144c2f5454c57a8012813526167ac7f6a2279e43b807bf650b9b67285405b755d6e685a3657f84a0fc17e90cc0b6ed127876a894870b4c657669395a8cca31b9b01b95e06170e8543080e016108265fe13cd625dbec2e5e45d1ba3a14f292ba3addcacac361216bb5b6a1fe1a71fad23a32244cabef0f7454741019462c08271cc2e346dbec70fa2e5f569e918b2ecf3eb9aa101083c96ec9c5eb21bc063bef50613ef277582ea2e93772d8111bd575b059704667281c9c774a833321332baa4244ec769dad59ac67c4c939966628871b00f324a4dc65c3245d42354ebd27d33d12e366edd1aa5cb030fe10f64791a0a92b2e53c4f16e0e42dc0e3a0cd596652b46332814fcb10db12edd124838064b3e734b5e8cc3e7909f07e4f1168beeb6063d91f0ba82ec773df114bb2c8434573ca1fe32614a5b8e2b211d5abb5c95206f824bd7a525d68fb66826e38257713e4ddebc0572149c1e60b481907a992d2daab6df3a28f3416e6eacf33864afc736b0f9dd3aaa18be488b2069726b5053e9e41174258178405384fc095b93d8f650fae955c1559241b2f6fa85520c794cfd1f26709388bd175b70287874b4399df06063bbec408e327968a0ccc5ac771257549da7ee578e09c92947f17f8d3d65c5a480f39d6e386637d6b2a3edbf6757a47761ef6fc7947ce2fad939df2154894053ade61da8b61a52eacae6b840a51d06cb2cf515637506a19c457e2a1f852266106afd79629cf67ed0b1775765270e3306617cab98b398a31d13d66905cd32a3d1de2b1b04549533af11b63c7625b3baeab9254fc3cec0ace451e8ed07128359849a2fc674cea0179abedc06c88a73af09aea5e4d8106a1918ba0e9d5c8131505aee9ebb351b3a5541240c904e4a305f2f0da0d","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"db2470865aa068691185dcd60d0115ec"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
