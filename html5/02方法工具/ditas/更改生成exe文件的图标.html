<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="zh-cn"><head><meta charset="UTF-8"><meta name="copyright" content="(C) 版权 2024"><meta name="generator" content="DITA-OT"><meta name="description" content=""><title>更改生成exe文件的图标</title><link rel="stylesheet" type="text/css" href="../../commonltr.css">
<link rel="stylesheet" type="text/css" href="../../common-extended.css"></head><body id="更改生成exe文件的图标-0DDDCE8A"><main role="main"><article role="article" aria-labelledby="ariaid-title1">
<h1 class="title topictitle1" id="ariaid-title1">更改生成exe文件的图标</h1>


<div class="body taskbody"><p class="shortdesc"></p>
<section class="section prereq"></section>
<section class="section context"></section>
<section><ol class="ol steps"><li class="li step stepexpand"><span class="ph cmd">在程序res文件夹下，删除MFC图标文件XXX.ico</span>
<div class="itemgroup info"><div class="note note note_note"><span class="note__title">注：</span> <div class="note__body">一定要先删除原文件，否则会把你的图标文件覆盖掉；</div></div></div>
</li><li class="li step stepexpand"><span class="ph cmd">加入自己的图标文件:icon.ico</span></li><li class="li step stepexpand"><span class="ph cmd">在图标IDR_MAINFRAME的属性对话框中，修改File name路径为自己的图标文件。</span>
<div class="itemgroup info"><img class="image" src="../../images/2019-01/icon_change.png"></div>
<div class="itemgroup stepresult">完成后在资源视图中可能发现还是原来的MFC图标，但编译后exe文件的图标已经变成自己的了。</div>
</li></ol></section>
<section class="section result"></section>
<section class="example"><p class="p">其他方法参考：</p><p class="p">方法二：</p><p class="p"><a class="xref" href="https://www.codeproject.com/Tips/406870/Change-ICON-of-MFC-Application-and-Dialog" target="_blank" rel="external noopener">Change ICON of MFC Application and Dialog - CodeProject</a></p><p class="p">1、在资源视图Icon下加入想用的图标；</p><p class="p">2、修改该图标的value值，把值改为Icon下几个图标中最小的：</p><p class="p">(1)方法一：打开Header Files下的Resource.h，找到Icon下的图标，系统默认是从128开始的，</p><p class="p">#define&nbsp;IDR_MAINFRAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;128</p><p class="p">#define IDR_ICONTETYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;129(单/多文档程序的文档图标)
#define&nbsp;IDI_ICON1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;130
#define&nbsp;IDI_ICON2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;131</p><p class="p">可以修改全部的value值，也可以只修改想用的图标，只要保证value值是Icon下几个图标中最小的就可以；</p><p class="p">(2)方法二：在图标的属性对话框中，在ID后面加上=value，比如IDI_ICON1=127，也要保证value值是Icon下几个图标中最小的。</p><p class="p">方法三：</p><p class="p">1、在资源视图中删除Icon下的IDR_MAINFRAME和IDR_ICONTETYPE；</p><p class="p">2、加入想用的图标，可以改名为IDR_MAINFRAME，也可以不改；</p><p class="p">3、如果不改名为IDR_MAINFRAME，则在程序中要修改相应的代码：</p><p class="p">基于对话框的程序，在构造函数中有一句</p><p class="p">m_hIcon = AfxGetApp()-&gt;LoadIcon(IDR_MAINFRAME);</p><p class="p">记得把<strong class="ph b">IDR_MAINFRAME</strong>改为你自己的图标名。</p><div class="p">下面是改变运行时图标的办法(不会改变EXE中的ICON)：<pre class="pre codeblock"><code>
extern CDNA_Bridge_DemoApp theApp;
// 第一个参数是替换的ico文件路径，可自行补完
//调用方法很简单，例如下面这样就可以了
//ReplaceExeIco(_T("F://11.ico"));
void ReplaceExeIco( LPCTSTR lpszIco)
{
        HICON hIcon, hIconSm;
		CWnd* cwnd = theApp.m_pMainWnd;
		HWND hwnd = cwnd-&gt;GetSafeHwnd();
        hIcon = (HICON)LoadImage(NULL, "icon.ico", IMAGE_ICON, 32, 32, LR_LOADFROMFILE);
        if(hIcon)
            SendMessage(hwnd, WM_SETICON, ICON_BIG, (LPARAM)hIcon);
        else
            MessageBox(hwnd, "Could not load large icon!", "Error", MB_OK | MB_ICONERROR);

        hIconSm = (HICON)LoadImage(NULL, "icon.ico", IMAGE_ICON, 16, 16, LR_LOADFROMFILE);
        if(hIconSm)
            SendMessage(hwnd,WM_SETICON, ICON_SMALL, (LPARAM)hIconSm);
        else
            MessageBox(hwnd, "Could not load small icon!", "Error", MB_OK | MB_ICONERROR);
}</code></pre></div><ol class="ol">
<li class="li"><p class="p"><a class="xref" href="https://www.codeproject.com/Articles/30644/Replacing-ICON-resources-in-EXE-and-DLL-files" target="_blank" rel="external noopener">Replacing ICON resources in EXE and DLL files - CodeProject</a></p></li>
<li class="li"><p class="p"><a class="xref" href="https://blog.csdn.net/chenlycly/article/details/45418447" target="_blank" rel="external noopener">通过代码实现EXE文件图标的替换</a></p></li>
</ol></section>
<section class="section postreq"></section>
</div>
<nav role="navigation" class="related-links"><div class="familylinks"><div class="parentlink"><strong>父主题：</strong> <a class="link" href="VC%E7%95%8C%E9%9D%A2UI%E5%BC%80%E5%8F%91.html" title="本文说明了一组可以在MFC中动态创建UI控件的缓存池管理类，该类继承自CWnd类，可减少在复杂应用中的GDI资源占用。">VC界面UI开发</a></div></div></nav></article></main></body></html>