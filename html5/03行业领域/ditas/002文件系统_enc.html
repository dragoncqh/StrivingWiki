<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"80a6ee15a8a5b7a1e753a48cce765cca42b32ffa0f6bec44cf484eafcb3a7601aee017e7ac96295587c019706292258becae8f41c9d42039146cc791ddbb32e7ea4f6d8bcbe44f04be8bccc72e95a88f082ad0d74ba4fb3a56b767b462b94e62e18a7d7ebe05423fd6e31a4ba2bfdcb26aa6b48d3500fb0123fe16393318251371fd4acdaee87e41c29b818a3a5ab15d8e502185f08b72fd61530f6c68d15abf010b610d5d8a7c8e79965599a5913095f6e4c1ff7591564be1fa6baa256b232e190ac7d1fe5cdeccb55d1e4714933be0b6cac53f9a15a081a80caddb8703951f2e49b2a1843b779068fc7b724bca12a0db77656189f4ea71d957d6ddb5854afab3bf4e84f12e454f7ccf17efd3b4c81c831e53888d3809163cf0551c5c03d8b8827c88f0bf6af098a9a49d49983aa7902148cef768c0712d2c78686c2de5c8a6e5ce045f15e5910021a93580a49b4b82b5d7cc8eb34c1c93d71b2b6984d032ef8e6aa3bae6fa8cbc541e6246841d85757fcc04732844474a63a437609718fc8f5cb9cdd060ab749363d7e31a4fc0ad888adb57b6b6f93340aba482706ce0ac9bee7462d438334abd18c8038e34e9bd0811f5d0b0ae731f2d184a48ce890bd821dea91697d9883422347fa0b5b0bb495a1c796a36e69c21986044a34c78071d7b677a191afed1103f47c125988ad42b1f9e0f5b7d5cdf4f7025ee9be1c91f6c4e226bb6cd6bffa73b3f7a1a27b3aef21fcc3a66c04abe37ce2a96832190124fbd918f2ea1c1ffe477668e88ff4fd00f89e3643a87099b34a8e1b7053c2ec40d51fb6a5437b3594b67dec346d991fdd143dca0f630e785703eae5bad6821a4f2ff937c61e06d77175419df227dbd2541198b5dbcfa87a62caa9d8db08ae855dd81f36206f2878baa86ec748466decb578afd3815a26825de250067dd120ac06ceb38dedca098f71e6d4d2344e454c8e2292a79d2115efd5e939707eaf1ed8f475027c276d0b26a8773946f1633b8c18b838705a1e1c7e09e11da4a688e554eb14b71ef9bdaee85ff88e6ed75254e16e0fbde53e006b933d06273c2c87a31570223cda90a18abc6c09ce113e4cf9f76fbe2fafa8d3f51370c10be927718bdcd0a90041dc9031e4d9874a94a9aead8b0b0b692cac75a93e6d519254be74fe78c761ca388fcb01f66a4ee150a0beadb2c3c7e90ba742a194614442f4d100b251eb2f6c1eadd96f39fe4381ffef5484678fb0b7754e2da5b27b2923c16de4024f5e78a17e1498657d3878ff5f9da675061ea98724b6a9edcc644f11a6b01431ac17598755568d176b31113270a136dd1e8a2e0bfb1fe371940793049d82ba3ac759b606aa454377299d32c06360bc7939b57cba838f651cbf5ce386b7812cfc4ea3d2944d6d20b313baa9aa06292bab073cf9f35d60df8f0dbdb558eec3a2645c7d61a08743315098f16dc6b893cbe4f7cb8c66acf8bb9db0e67838f65e987f5a06d53c833daff40fdf0b6ef8fc6d4455a8766991f38f5bf361b7bdd3fe6aad1088ddb2bf782461a808ced31b23730de3cb20dc018889362ffd9a1cff30faef63990c74d9a00aaef5f72dc3b252d0129d050c70eb0cceb8a6d32a5afaa6c3f8418d7ced1d6a1c758e71e67078be8caeb2f398b37fa1cf2e57b85b984bceaeae52a7ad9bd785ec9ee0f86877cb698b20b71b4ed27bac15333aa06bafd1beab889ab49d147c8c30807f7dbcd45c98a3c1a989581df640d256b469330402c55aa8823e2ce891165f91ea63f3a6eff8831741a9e825c6656a640b0096ad59b636d2f90a5163ab6171d294f57224f8715a842b6a4cf0c52cc977edcdb9720d70e9fb779c91764cb2b8c053f2d788264ae2b78b0dda307a7baeb5f2ccb0b2266d3543d2f43ea1eee92b61e799ec3c300d0303bc1ea750cf331d499449d4dd345e3db67218b5ccf7c34bce0b0259165ae103879c03124f0e695989cef0e1b98290a48af37d8d13e4adc8600e1ee5a6d8bf4be227348ac77186ac138248d28a8c6da1ca718fb06a525fda01ac1b848c44f914a0d6be0fe03c16be12cdb0678a8434230d599621bb279296b5be016baa783d97e5f1e8444ed3b19a09cc1be0bae0401b4b5aafbc8738f5bf2c0cec3681d01272b702a7a7d6039f9fea43e6890fab841d38edb9bb27c1b7ddc43255ec48b628ea314228e756c613ec77b0478558371e787c84024f360a4aba3e56e4a21c4670e98cddac8eb74b0dace74ac0c7db259f07bc96169a477f1717d3802eaf015c5a21f1a88eaacb83b0e470654a565c2291a87b859df96284e542aba06e5ac59679fbf4b6999baf9e3a63b3771fa43c619481e6b8cb6aee8039ae08a88562ca065dc2053d499884859cd468219401ee20feaed9c6008be57a35d331a23064d281d583d6dfecdacce8c169b0e67d3e2198c381ee4949acf4748f4725c613f596ae09e0572051c652338bc014a89fa00ebe335039011b737b6de3bd1f6059255a95446137220f2d64d93fffd3af005038095d42953a63277cf736af5ffe2cbc9ef90ea1ad5cb761de458ff4412bb9a473ed36c17a701c439f243821c0ba79472bf9c1ae740d05e7cb65894c096d8680d75a6ffe449e9cac1e2cc4f65dc671757fe2cbec3a9544283813956b1bf35d50532073f5e221b6e8918dd3b2d110a70554e24760641f7b990cc6347510243eb520c1974ed33f53db696e87213eb03b3ea2aa0efc8a04b86886e6bb95377417ba51e438bca25e072d3f9d21b62af2ade681b980ef6d6eae7509e1588b3b5e06ae2b006f22fcb1ff32b4dfba61d3247f753d8cd69237ee2f21c73e58523d743f5a38803ce5dcb7a36284e5e925fb3184e914678bf9c222b000ac841d602744a71e0d2825ba08e710af9efb7b5f2796e35c81e52b6473430e4a993045194d6971a448c5bf01f829af0f21c026aa88729eebf587725e67f049963ba5f374ce85b77c1ad880427aa2958e2e1007dad611a83dac4445342f8cb3b55e420582f4ac9315ef785e1bc9d6faa4218dfb36b47158c285b81d44def26a5657b0521e054b8db11e5a4ac187d696acd8aed9d99d67f377d92ecc9f52f55ca6647c3242f64f0980cb992babf5ea7823796afa5eead39b4ba7702a460501437d55430b9477fc5eda1f19e75b4cef83ac1a350d5a21f67aec03a5032cd4c8b07ddd1bec88b0d3538c66577395d4368a438db63eab7a7ef0866f482b5fca34a69b6f4de205d88c5e2c50f008ad43d43d4c19d3ff3cc70755fe73100d541f056a36c440525bbd83a4019c93b789996067797ae3a08cc70dd468b2bdd0563b644b52c08bf64c7b021ea294c9a59c31dfda2ecd74ac90b01cceedaba4d801fbf1dba2ae9e37b4bde167226edce406bafd121bd02f6f9c9714620c2d12676e881901a0af88768a6efb083a9420b89cd5f50633e49920d24f972fc4b2058276e2d50a0225f937f9353a6ea72126f3daa75ad6ff8807aa83472c40f0c5c2fa65f9a0050c542692b21de3fd433b81d3cd67d52d9816a4e2d1e5c7447cbf46beda22a6673bb63992eebb372515662e318aef6ee8d343067b23ea5b0a74ae59a5888b1fa6b482bc5b807c74ce94b4541a9e8eb4967f0f28befdb13541df3f563e2ff15ad74adb55458c2dafc3b639467e3edc7cf42451e5235b138dc665b4354c432fdd4ac3d79b9e4c63a13e2d774af2b9b029aafe111a5794ae40bdeebd756e4fe3957c371011e9906b06963beb21af82c5620d6c5351f2c105693daa3542edfc735544d1ca0b87f199f1866cbf28c7f48e2d618256d7057d05868704cf30ec94d6441787efd03156baf56b68eda23cc5c908cddc17e598721feec594cc7e26270cae8f0b6f1cbee6b7a1a67e4212caab545628512513ea2ae90948a5a5d62ffd80e51f1c497837914378924c121fa906b7aed96e9527a672dbeb2a586e0d20e302eb645c5578fe5c377a32e73ee25ca12c9eb5b0a5f2a1c6075933a9c04976f48abcbf8c0d3ea9715720299bd386ae445fe2bfbd1c7856c3cda6deaeb44c6755d6e1234cd408064cbfe1aeeb694ba846c824c6d5aaf121ace90f9e3154406fcf882ac3bcf1f9e6964bfa8a8ed4186ced53778d8726e436997395d0385379a7a4530ea680ae9ae185ed49264ce555fd5509e176b3157b6d7fd1667c90fa057e62332e38ac96c29c13d223aaf3b10628eb05f2e1fa7b03a74772bd171e74a3e4870ba5fa6756572c6cef5a60b68c2bcb48b652a70b1dafed0a86e5edb80414d3529167c3e03ad8bc7ed150347fabcf0774cea234be0c98ecdc66eab682f33e516ebf5815520847f64a1bc4aba0518169bec28f72796b6c4dd3a6c3a1e7ea7b77127e5e70eb6f30ba528d9734b82f6f4cd7779910581d5c5178f84bb1c75bf68fa79610261f0a0bf47a6ea83e0e0a97597a119fbdcc59c4c4fb6d3c5a9a66484414dfae8df7db506e54b0c887a094a4f55063ff212d27fd358d8034c18a57679b55f58b77494665f97affaea23e899de310369dd62374c965e64b6e4cacaa49298473fd35629bb7c30547c666ad5fd31f10333f26f2e32d0a9fae2c329c5c6c941dca1dac1d443432978028f6c449c8b312caa624967e25ffec3c6a5bede87834c502d28f0b7383b311ac27980ff0d265ae75d1210fd108bdfead61b92b883a6a8d28b4de64bdb86f97a4588203246e8e7862ea04534548e7a1b31070eb982f1248a604b8323db9d0247655b1c0931f3705451cbead003a2577a7b3820ed7c43145585d60a59aaafbff74f45bc9b2aa8a3ad0f5fd53781779cbebf1692f1087d465074f21db814201fd535989f875722fe59883985a8fa898f32bbe282a00e689fa30b3246c12fbbc628ce4e269e2541c22f96844624ca64acf34b7f568e4b048f41122a0ec79ebcee35886f7c83dccb381846ec13e6eecc2c6c72f30764b026d1c8d9e83927dc462bbde80fca288d6e8f324d4cb950445ff3381315d2013f581d23ed2d0ce5f3f6d65c9e2350b5a62e7a70067268ba4210398095cfa9ec25700039da9ae76598eeef705dabc287085ba71b61b2b45747ce2ea455088b8f175d3f16f089db7046d94857f827f85c2c461e3cf027c0ff77168cb7db7767ceeddce0d766eb924b7fccbb09b64774e5fdcc70ffe502db8688e2186afc09a93f28c75a85f4f8b4e6500c7398921d41efe937a9dbf261013027fae5826ac2f6451b116fe86890a9bd35d8310e2bb7a959d1876286714e437a9da9152345b0d0765cd89487d453837ef3c362d2a6699bbbf1369b1dce405d89a1754cd5ac8c3c1b2721627ac0ae5f0a4f50f52549d89b58e0ff102cf65ff27fe402fa0da3c88af04fd5ded00e55d8fd3c97e6c94f4591b09132a80e8bedd0bea8318928518a941355f2a398fed348c3e1e588c6b10d2ed3f49575c4368765cb8c9f4304e47a20c6a459ec472fe21ac4382719287fb4039f4858404092a7cd2d00367c3c1a2a30db375cfeb90fb4aa557fc95e16dfea3ab07f5f0b67fbce1c7875e27d480332664b889cc1fa127135be555038fa7d3e33d952a9537611a28fd6e288291f17ac453ea85b87c60ecbe48a3318ed5bd426001d4c317282a936088702291d49b5dad119058f9df9dffdb4d1705fffbf2d9feaf4ebbe588bab5986db72c88e6bca65d27cd032e62d81cb0feff1f441c4ef1a3c1fa982f60b0abf9f8a40f679de492d6d7e2fa8c0178f0fdc9d27c7fb194e7241d223acb364560b8130bf528ecd8e42ba03ffe83b752d1910917ac756fd699de569b534e7571ab4676ee9914c8e09de9c6acea75c8568021441d0a1d9d15cab6f32258ec980185c176d4d538dbd9f6c06d384813e3eaef17a228a9a8252165d830a40828986f565544325880178f7b56500008db47264586ad6424c6ed20bf8d6eb5e2289bc21929b5c5d1097db4164537a193da5475206f3292b1b4ecd75d39d3d01e767c501a103c3ed6d2d03e0bdb217638d4261f9ba5cb2c6d1c63f72fd878b5f658226d69aba6a17b4a14038d9c26b83a5306b56c85db60cd46ca126563a43239ae47b4aec9d23a8e69b9640a7d5e95d3073f6225488ef5141488e73525b84ce8d4998c6ab888937b5492a0212238434ee5d73c74752d7a9043878f1c557dbec5e197ffb13d0c0fac9f2824ab56fdf4b9952332c13cfe3c25c0d90a465560c5ceba6840ba81153c3410a9b63c9b4ebc6bd079c8e9019a53f49adb24e519a98c13a8eaf1a2ddd3a26e0665dd50ebf689fc82b8c2f1c35a024abc3e8edecc1e7427500fda68cb8fd9ba9a0aa8b6bf27548268c0c67cf014b2381b0c881f15c5aeb2dc4cd8897422ad792df0e5c4cbf1e0caed3510f41d63c4e85c8ec8327fcdbbb5cddefb6e4342d3aa0800c99034def87def018838e4714d5dcefac244b7a0de71e0e26ddc80b059d927287c8db7d824e2209af04b4fe8a91225c68700a46ab851769a865ebced00d82a6354f9088da34e9da5323e2af376a5637a82d5574b236f7197201c0e31f97c84f58ceb2e5e4cb24e9de213c34b7b39de148599c4dd8c8b567f9278a4a489bacb280490955e4f8bf910a36eb19757258d63f4e60b0ce7aa941b962443e25bbf7a07559e1cb52f4f7539aab7732eeadd106909074ab2f66adca0b19869ea53d2593755f5957e788082c59560589c9ea13c0727c6357ba840bc57e3bff60ff36c7b1d40f90a6d05f4654a7768e8d7e0abfa6ed5c1b1eaf051c6d653a8318725218ac36d934bc655bcac6ab3988056892ec1fa2c2919dd512661464ca183e99f2c1afd4b958ad3650a3763af3749216d21c0aa1cb74362e519abc450887238c5b55dc430c26b0c1a9f3ec80fceb020a23010911f3388628805c6e1d2ccfcabd63e2addfcd0cbb83ffcff804fb324b1f9b7f7e3b4d2eac4da2011f978ddadaa2848ea659ac23c0e70a6e43d872c506f85ab33b0a6d8235a17c7db5774b2d3f34e82901499ec15d32e6b47b5d9701123621faabb990e3da49807abfcc3775434ebb07de62a695b66ab504497ccec71c7ca874d532a22fb87ab172d5e862be95f5656e501313a80cbdaf1c9fa9f336c681ff8b4fc0afcc29dffa983d1fa7c8a7b0e8affb43853fffa9e733726970ea1edc7ea282561365acf58a562be5fe01735623c4bbfccc9f98615cd6d29dbb727af6efdc29b7494c312638a9ea7ba1730b521b7d9e7197f1bffd121c9c50a346a0bc22a68f623b23c978b464d88c31087978d7e6bf77633eab05f33659e3716528b37954b17979ad034b146a366d768564926815f9ca5fe186852b968b1e55a0922fceb882bb0687bd4999a5f9bbbf88509799f1d3442220fbb8068ebd9270a72d3d5e3cfd52e484b401ce53e1d4d18eca9ae466f07dc10cbb5be56561ab9f54b1897752e7351e81a6471e620aaf97dd5713654148bd4b24e35a2109c76787c8be517351a3d8b3bdb274b8fa1eca7d005c64e8fd62b7ddb7e0238aef7cb0c23bf9c285e437b63c3ffe2fc819fd674593e1d99ff43f78ac25d064c179309cc5fde18662f22fe5362ab1297a3128d96e19087c7a322fc057e3cb85af3d6fad8658b7cd97f67ec931da452d4b9c27b008b20b5846aabf20e273a7e8da2f0516013978e8ddbb6cd61e311b97a260c4120f622f899b51c9338c91d7dfd576040d614e12a107857ae69fe176cb9bad8ba992a6a5ca852b81986b603ea3b11aa06b7b3bb72420f7402fa2c499d9c251a994327e4d83ab43de7acd5e01e2497eab4f892cc8b263f9d6941309f5f414e15236d451e58ac18edf973075f4ca24192d741583935b5e53c63fc17ca4f3fd3d48c5cff5dd91e5a3e89e89fa943bc3c3643660cb561f2fb0d463a4f6e1ac64a36b01cca8efca421590c03c743c144d2bc03729a6eacde5d034733008b729de02499c2e29bfba846205f4ae6c4026afab74d16c89bdb50781f4199dad7efdd74ade66d352f7aec5ac3ecba7acb6fd49d69baf0fae952a018bdcdcb554789907fcbd23e9fce590613dc61d0ad4dbe47cb62ab538d9bcf91764431751a7d880e4d1bcc279e691168ac3e7c1819ba8285f692a786760c58a45aff402d616a9a2706fa340d905b31bb352d83e0a228f9f83749ba6041d4381f3c2f6a7c08c4163e53e6216551e664bde744fd76c80588f965992ed15fae7ffb630945fe14e3f585cad29be52d30b8fa5e0e64cac5b64f13c53d9c7baf5032121e1f86c13af76bccf891abf25ed28e26e002e7e1d18c0237aa4e57b3507c266dbbc32ce7fd82c95cddbefe1fef28945f0d2912cdc1f032f223ae4cc9e0bf21009dc39c73e3b8af118e2a088a1f2afaa72f9ce60c1ff0100f027983d6c623b094c3b3ad039d79fdb31317a70ab250c7dda99285ead66060b2cec37c194d97da14e639834b9dec646d5e6ed85421cf87657a8c500f6357394c1ec586f21ce4227fe018d62ce31c97eefcf78419989ef7fe49e7b18b94a9d2f4185c5b6031266be508a8eae47a3995086d730b663c1ef1845d4bf279f33ff3e7c33ae48202dadac2227733dc792c5a07eeef379d313309189d69aba9e99f5f715031d6ca3df2005f6cdaf3dc55f39579dcbc71e54dce6e8ca25a62006161efe4e62611c5c7891e31c8fe3e93dd176c9007537012d7d4faaaad6199a44895823e7e1bc42e53c4369b5a2eeb5c38c0a81f230c04ca999f278758f16565ce75369ddac383a38451a65f26f9eb0b737e4d859bf277ea4e5f7dbff6a76709a5557e2fa37a37b03c3630c4fd8f8d192de8c50ecf0f9bbe087715cf692c37bdd433332ca5fad71290d491efe302d1660d430c01c7252cb01078fd7f0ce6b2b66f26838f1eb16ddb772fb0c55d0e47055ea177b5646e37d108119648521df3b40711fe804daa3814a190c5dd7ebd3f939073e24850eea4cf15ef556257b97886c29f28f3cc61aa2d171976c318af0cb76c8c50be9980d8fb2b5bee0ebd37bf15bb2bf273133a70c3a321cfbe4104371bc4b89ca61291b0a53db6e24efce124008f3bd7239482e3ffb8439a0dc2ca567036e47e593b903df7d61f6361201aa40a3bfdda86d2ec94222e590e0012f499a66d6212ede68129b7e2602368e1dd77cb66c33126391db4bde4e84eb1b6652e92a6fc2c50c6107afc1214232b741d0e6878cecd0e3960e69557edcdc36188f81d73d48320fe95467e973418bc626e3db0d7e6f43394c7da1bd9a1f187b71f829cf706090cf609d2f68b23e0ba71b2b237a49b1ce2f18a1cc0cadec0c2aec0bf63013b1427a854d4e69b63d89b8888e28c9086c6d9c6aa5f90ac33bfa5311e958e4f03d5c87a529d60ed39f8e58771b6b050b2280c71afccad7026a1101d2a3e7b9f58dd22f04b1ceeb27653a601576dd668a6f9ced9c8d6d88dd70a5a507f61bcdcd4e3c39fa591ae33f571c8d1572d0bf76c444ea9e0056659490c6a3dd4aa6bc26bcb2b18686f9ae9b37c681ed87fba0a7ecbc9634488eec8c2cbee5bdb147d85d428db70e5db0dd2f77812eb38b6057917f7df7ac0c1d529ab5c45a0fd4b3bd1dba1fbe6af1a38b9278095c26854b1228df467574f8e41c4e01d305cc2c22c52ceae43818e0a10ac8f04ba05e75ba12b87d72a787968b545ccbee764aff88dedd4ac6b4e235e49488c0ac7c6cc40ef4808c98bf25c8fde98b8e4c4bcdcd8188cf6c9bf6197689dabdbbebd41fdf663f8f0ebbea141d28f9753c62601a0aeb01c90d677f73e474eee0dbbaac2fc68badfb8eea78d4a5336798a21d2321ef6ef77bbd448d3900b73c115dc2d5ff35c5c07a934222ea04921bff96eef06435303ba87ce94a102df03d8fe0ba687b4a6442bf6390e01380fce7e329cac888341f39f3fee1c6f92fc4bf646155a006cf169df73cfda1362736649e0c25867de4f96dc64c250829585b0c3600d8640c427cce161c4a0db7c14a88da4dc6b81b07684dc31c140dc245c98edec807ac64df084588cad98abf21bd5fcfa50cf581f86e9d885adab361d5a326abbddb8781abe6c2b2473b66403924ad4ff23ee80bc58baf0abe22255aded50e144a21da41f03896b93833b722882b70f7dede53b014bda1f95e7bb79a9b65662dd7fdd5fedaead170e70b01cecb3b68cd042da804ab02db7a0aded94c4c5a6066953f880e6f1ef13a5881afdd9a514f59f3f5b752cd06198cefeb0c34ca5dea50c32faf7c1b1a58c333d9f687db78a345d51870b23b762b798a55255e6816a812d65bf321cafc9352cb9a9aafc5c4cb3eb0c633a278727849d08d8e2cde65d24e68ebebbe4d28dba66869acad8935215bbc59c81a0b429e3babb5de919c5cfd709927602309270104698ed068e2c8a0f0d02c3fe59ea9a1619f67896ab7c7d9a45616198aa9bea6075b5b66ffff8aad63a9e1dfced17d3a9cb0e5ac38eb6e1618ec2f0b9826a0e1eb456cf14e7e0be1fe3be251343bca340f7ab5365c41239b4b5a585019bfa94ca05748738ec31b08d2bc3937ebfaa31fdbdd60cf75c92eae7d756cd0a8182ca22689bddc6b5878e4b5b366f4a639e93bc9b8463c0e3580ed12ab881888f70cbd5b2e22d335cea7859899413f8f98284072d71f79592c6963fe8057c06ee407b4e15419d2b8bea89ddfd6429d75d21d3b1e11e78b1d5a8b20be6ff8b4230f9128fec3a9656ff38a7b8faff27c00d3e7c2c8ffa66f41c975bbdb79ce30c9c5412789f460b84ae2b199b017c255699e187a8b389dbf1bca319a444dade79a57ee61eb830f3fe76615513ee1c05697dd1bd6bdf139c09f667d301ffd2030e99be7b2501a7af3de6fc267adeca63d21edb1f3e745ba85c9305db140e2e6b6018fa85bca8783df4a483c6eaf553d5dd0698eb3efe90572a937093082222211dc7876ddf530c5eb8b8abebca322cf734ae53fa9a7599397894a6e02c86d872b9044077e6b50062ccf5ba658b4559ee564415b4460e10030b6c508961cc0a13de26ebcd2a8ccd514803cb4e040c617f1d4a694b5f08977b73877098674067e6d86c2060322b10f72970b204c3e6f94adfacb5955aac9f7c34e5f902eb37a3919a30d3706af21d7727229315285c7578f606b69bb7817652341806c6c5feafc278b6e83d38982da94133762cc2cf40ce7b62697880c7c06d267ecb2965d0aad9eba4597701db63111d3b5f316f3fb8d21072bfa7da6458980542105d21923bcd3e362cb2a2578187b51846fab64aff9ad114cbce2ec25738e33a53d55f3f8be38b871777a678175ce6bffa32e4df11160c9dfb05a5a3c4d8756cb87334e5916906c4710e3fbdc6c4e336b48a231e045e0a4f45d4e6908504c0040e3b65d0e4e39e7776879bdd8d62288561aa6835376b563ec59c190c929361dede77217e4279723d2b61359f39fc6f6b723a73e503b6e226b97dac6fcf044bab77bac0a28f4e6e1267d1a4a0ac55c747ea56ef47e08d3b6632182e5fc0a8874311b645a5e71b0a824ff4583f4615f7a3f1a379c668649afaf1cfb3eb2e7dea19505df3367c75bb79c03477a68df0d980f19ba1ff86a36328b52f43f84a80dabf5b2897400143934f04fd36c4889dad2915f3e8300f8d133d07d7fd1179fe0381eb39e29d75838f2192590b77a1e5eae7b60c7c9cf60838570b3314ff58b597c57df5044aba3625eaa122cac7b77ab97bec912069acb951d80fd5a715fadc2dfe5f2cf444afad6bbe42685335e341751aaae749351db09eed4e104c9324d9b80e9e7576bf66a71c8ce3d8368b842e733d990bf0c84d8c5c9d241f02f932ecc659afb80b8ff79966b0c67a33907e1d5675fd5fc649dfbf2c61c1b058e14da12a8bc46412cd105aca7e792fa32cec5403a714b0ad885aba736b0c1fad3faca16e26d2eb62bedec9118def9ec2f5fc263f71887b78f4f460d200b7f88f753cf646d839991258e3fc993451ee447cbf80ef68b87bb2503daeac2ba7c991909c90a36f3826ee2d044da0546eaf5283cfb76c7e452b15e38d63d234fab20a5e3a619ad89c825bbf98f6271f89b6320b17839be4efcba14da3fafa7fb1db7460b31d8cb3d8c519529a8040cdb708535e83e02847edb51b594426a4e00ec4c4363c541ab67530606b6b87ae956aa1ed20a26fdb6aef909fe40932e6fca65ad24f88d54431ddfe3df6785d9fa3bdb25b4015101123164a9df85b8829388275167f9c4116578218191b3b767a7c76ced7ffbc3ffecb2bc3b1e1250f4c1aea5435f3670622ea0922b0d312870644d634c85f993aa8d2be6380d154877a0c21e9b3cb42c1a3017f1754c8c89116c91612f440dc509340d169683a9cf64be9724a9ded5600081543647fc29848b28e6e309fccc897ce9a9405649e59de0f80654555739a3838a4dc560d66f794e730243737ec4432a0d7899275eba472fdae223c8309d118a8d82944c605b3b9c3744f6bedb6258d048c098c4a24139fe873616fcc3f74ec7a2aa20b23b1b315fac7f10c274d5bcf0f9c97d61e4d0c141d1b5bf9780b8f2b177b04153147d947a9c57a8bdb9b6a4eda08bc1d35d956eb9c1bf1e2af2a9d56b681b57958fb5781b924cdf5bc2a890a566e4e6a722e3bca7d8930d11c36a82b60da273de8e400ac9110deaa7d82127aa8946ec9a98103e80fccc52ecb555c318ab2c7497f0d9ef332b0167c1b4fc5389d7d123b0c66fa2b77437fbb367fa07d5dea9424f24165c955e8c43e1c2e04c7b1dcd2db7164973031e56885885d76206a1a662337f93fca786a291a3747c447f3e0c1690d313c13f6e9041adad46c9d3f158df4dbd97d1161c7dda62ebf50eec295789eed3597637715336a947b842ef29e1a2662e306c62b7b04112c21e50910254b92a1111a1a9e80b9dc612f3511f8848068fce917b3f3e78d33a7ee5164b05a2f149e371932125d383c173de47631894241b74cb060a36f35cb8146ec616b99bf974ea3a10bdbd57cb056982b6c5956cd07fea4a9a84882f1a9a9be4b9ff04af69a35e14f33fd2e5eec3eafbea68364b4464267f0f727c279cf20a3d1fb4ec64797233829c1e6a184fde62e3b7ffd0aa1126f87a424554828ad1989769ba017a681b1ae4cc3e66586f82aa725da31ed1d0a9a8b1c12fa38fc62e1467cf8836111a44b174f0c8b7a8b1d83a8876ba7b5deff4dc600f7d91ab87d747279ed0b69005f2b35aba403cee5abf7d175b6ccda83d0c6099fa29b8559c70d8a63796480e130ad14aa9304a61aed2413d5eea3300c0a1bef9da0bb58cabef3a148b5d6792850860ee67e6306d57c212ac06001fb232e494f0e8f153d63a5e506587e38d7f4b2bbd18043e9f5d98887e98409c357325d69872a84f0cdcff883f433ff29159eb766590808786c8235285b2c4ebc29aa565e46accadb849fc02b57ed736b07f090258cd758205843aba01ee77fc2a7674f5d9cc0aca7bb2eb3931a8cfed3e9d679260260a611e065fa9872b1ccc00483be18f6bb4c585261890486fe04461660b8d74d15265eddb37d3fec1f280e9c7d6fb25d02d4aecf551963cb97b15a3ede7184a5d3e90e608169bff5a5d684a0ce03d21e98c19ba3e0fcabb09029275265b1d74dc939bdfab4cf67b07b25e4d28489fafcdbfecf4e87a5493107af11ac39341b6d336194b2b9cedd1b3bd5090756d4882dbd3d9deee1b87c9ab4f047094fa1c84b188ff5fa00d6898b79de1dee97051352c2aadbc42a931e26b32d9612024596b4702f5b93d2192bbf3e92f2372fef1625649af153fdc482fa3733f2ca4121eca7e68afdf7d8e8d06396b7f9d295f2f764c43b31a0ffa4f0b6f84b896b6111192969b3cd7f3a71f5a26f48fe74cc9127be693df7335f296ce986a8052168eb9192b41217311cf276c4a4cc571a161e6f55fe12cc6e197635fe22743dedcddfc422bfcbf9dfc874114cb6fd933b2b512a566df0748209407132757854e2702c3e848fb4f3dcd6edbf53163069fe51a58b4c78ec92a3ed6ab10905a2f41ce27f86017d26bc0d7f695704879793b0e1cb06f4001cb131c1505810bee3a5505df568306a34a2eb94210dd54f00d45c6ba4ada519c555785e68fc7f9370080055065d87577a17b133a3ed1ea914db030f9f563d805d951f0506939bf6761e5e1474f2e10a6ad53aaf46805c155d5c56e51c9f92a0921670c6061f3196ba687a61afdb1b422b6b26c6d0beda785e3dc0befbe0efe9457557b39274432063a6550975c8ca05bdf59bbfe1428ca5d2250474de509d88de321fae4bf98cee91653e8840dc969820bdc0b4babdf8bff6421495110caa566a5b35c1d5c65a746fb5dd3e7f99c7f47ef4ab422b165aad73c7f343b01c4d3366f963c63e76b25c14b1f25b5e0976431e0028040d2e05d216d3be25d187354a355ddbea9b391efb5562783e9c90dce6a4de53b23dd847a9dee32a1e16345c013dd968135c74166d9597d2620a22c08cb42435cb55e1cebe6ec2b9061a19f5b47652c4a1b37a037c6a4717dde782ce810dfef776efdeb8e96992f45a37d2a1964238aa51b9ff9951234b3a3042ee6a2019043f34f50cc6b25e71e3a8cab3b15fe6a88f961d6c32dda9c59c32ac60d772aeaa330de6bd3f2acf1deab7952b07b5381a2a2ef466da14c66cc39549b0d722cea51fc3909873f2e67034c41f712e389098ab9d2434230e0f6e1bdb5275fa4ef918c08ef5e656b48366042b21008555f8e1abbf86c2918fa7b0c6162dc1dbae58872bfdaf17b823930dfc0572aa18d04599f5e1e5ef3797d6acceb02e5a10ce6807e62c3f52eb1e6e5fdc9ab1b39e8f7badb14f252c134cead015ae9978cdc0a75473c8419354c28ca1192a52815ab3109a9b2670665efdca2f32ccb8cbef8a8a5e539f874c1fa9492a8f275ddcee23f5a1ea79429a6807d70f1ab4e8d23f77579c6e7867371502ccac33c1c4724d4e794fbc95f32afb950af185b0aa8c0cfde18007d64c8970308e6965fd06df1516839f7b1318f7f70f49d0455a3d35f584791ebc89a25d15bf6da0b384749888bbe1e39d61aebfe2a2824cf2da5375bfa8d080de2fa011f7b659cbc04d3bca524ba7361206ec02d790377c23eed8d52e0077d0f8710db77d7b6884beaac7732a111925681fb929fe602b7bd94ac40bb0d61e6846e8aed9fa6374cbf5a5e68ddf1074d0585bd4a5db3f271235bb3af27d2f23c1721c421a153f4b7095506905937c5fb27e39b8ce321052a7d7352c3f95d5919f485a651e79734a186b7df90dfa8ea1bae9e16193ab333e9edc7558b1a25e92d1b1fec0680bec456981e441157b6d591e7e51224870921ea5c3213d916eaac3ca17296433c5569841c4f7bec427ce8b0a9fabcae0e0ffba1fcc4bfbf7d78890ea76b5766b854b2368cd3adbb52f3246ca46223e0bc9684fa279274b1efbd96e392b73f1f3f62bf60940f4da2454252929d58a69d8e5ce14eb9617127757544f5b0697c3bc7ea1096674ab9a4e822215d100acf7f86dd586aa130cbeeb27ab10a2cf6df49d32bbdccf3a72264dcbfb9526addf5f86b1042a7a4cae89b133bd568c9ce14933a3702dd34c0502c5096a3ba992e80f610f8cddb30e56c624d5b9aa58029fb12fb28afa9a6e3ce1a2c09b5b5cc0c5e271870528368c41831875faef1c402e1a83ddf62f9f8d8a6c12e406e5287f048259110b6d119a4ed48067bdcb3cf7fb5279eba6dcf8cd249d6321f99f426d9af578ed9a8eb312742872c07035055d253cf634cff99682f9686c03a0871eaaf82dbb3737e89e6e7c934e900456af665c5f7037371257cc68030e564cf489d7b4455f5a3985402ef70f2bad23d42f30f653d4d8e4d86dab391cc85df2a8843ec5d90c1c3bc95155686e3bbd9aee9c2f3e5ecbe8027d4601be19dc779cf9697d1d06165331adebd67ff6aaf8fe22ed7d9c566bd11ca504490b9a37d40dd3adcd1c408924de6bca4b81d62be79d0e265a8b0e5fc49ee57c17b35bd5fb52e535f76468f2588bd6062b8657862d8fd252267b25272c0401a62c7554534b617daad2598ac5a149911b8d9513120ccbe2dfc5adfc4d9df44831d8db4821eebbc9c2f34aa867a2833fd2682550639e7cdd85b6aeb7d84b826395dfb818785bb9e74e752fc364c95212023cd650ab6593b9a421f19726fcf12e2768b82d9773a697663df3d5b0afa517c11dae493d049b50bc07569c885eb89e176e5ee976c9f2a96b5aabdbc9588e212fad049b7930702c90d788a6bb7a77728b3b566ec48e9b42d9b19de0ccdb4ebdfa448c3d84c5011066b75521fe4cbf8151a15556e089a2f8ab8b80522527fa99e0d432b73c23259363a394ee44f9199c8f26b9528ff8aa7","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"3b65e88fb4aad2a4dfb95b4861d2091a"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
