<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"fb8fb0b7aca8b034c705bf84239c7554805d7628ccc135e3fd61e5ab28ed286b7352e506b0e5b2e9669813fa7d5c45f29da5235b4f1f8a61d79bd4489b4f17fdd9d8736bbfc365e3a55e09804e0d87ac8ee968f5272c186668b66982cd09829e96c7e73a9f14ab4a9bc916b9a7c4622ca3d225afc3d12bb6542796c92d7f8756dac0a6759b41ef7dd5c98e2d8cf6089c7d80af38111c0a8e17f3a34ec217ac63d540a459f94f4f87fbcfcdca58eddd902cca5b9eba9be4adeccf8c68d13d20b49d971f2c6286524c2f971fa1f967ad7ae30186684a65bc958047b0de13f2bf31709e940d26fcc100302f90b1216afa995a2e7ae985b6d4403989925c3cb7d038ff59c6243560bff7f458cc779aa1ba065ac17fa64716c4fe8bb68dab3395cf06b704c383ad0b39ad0b15cd388c07fafb9356cb3833621b31310c21379835b25edf8e29c3ff74ae339d95a1a6ad9d8bc94c1da719bb822ce3fbb0e7ea0263590ab86137128f36f41e6bb44a0426802356700005d267cf60f7cdd8a75736fe54f1896c32387d6df7fc501efd52c3f1fc73d920a236cb0e6f32018d2b655d09986e4fb0da30f3720bae3a3c10b1a1b9560ad15922b7f5575f74741dd4d42df48b81bfd59650e15ed1f3c6ebd7d22b6ec256f5022c8634ba981080b7b1fb7d5c4857745e1f153505e8a1c2844053c5f44c2969e4b43a7ab6b8fd571274dcc9ccbe1963e841e9cc8d0fdacc988062df4b3563d3840dad8fbbb558ea1e030ba44f2971bee7c5038d3cbb52d3cddab8515086b2950713379182d99ed593ff4b3715584cc43f8e56e497a25d52a6222c05cdf3df8f78f58e576ae4ff9b6c8a0bd76ec2ec5cfe2a28c33c9a109feb6fd40d208eb1856a6b9b2244dcdad2d77d7cc684f8914dead1cc961ffb42a29bb6a1cf468a1bef92ab62fe46d7e8f5c723de6cbae15757453a149bc08d56bacfb2da12d3eab11c5ff48124382f83b95b3e66ed0b54fb0539053f581c735e844a6208b2ab0b292cdf0d825c9685d03d910810b6f851389833c4d8e1def6c7aecbcaa4ac49f45d481f2eb1b2fc435c0f54289e25c97fd6106add307cbc575a32bd38b86332a0384c4e6bac49261a0f8124fef1dece839156d609e26d53be0a3ec9e643ba2ec837ef705e08e8f0c88b55e78ac6b4fec755b301354781b4ea2fc8f5083edeb7f3e15373a6d2bef4a046866d0be2ea6dac59e38d4e31342c64da04a270395d0453ad68a3280571b4cc2bf1573142825089258f3f787d66c2c31d3786f7d75a20d8c05c6576a779a7320ca38fba0fa1822f9fe70664b9821d3eac16bfff3378f60b44c79b85b5e3d31087ac3547acfee752587454b71f32e99cb0094b166190de911f10ca21747956e5c04cb03fe2170396a5f58f51792ea8ba46fca446cae78a19b0caa25e8344c9b702afd20be768649a9e696b0bc75acead9bdebb0c0f258cf9049fbffc52fa69ab2c23ebfcfed19b716f029670d59d39b90c1829f5251346aa598645e595df953645a44f289aa49aa180e137858d1c074d35c63680a7d211d769c6d31063b57d90176b72842b4342c50e93b5c513f8ea946ab5dda8f2baf940ca40f29c9421a36ae39a05c56fca8d84cebb2286cedaea38d491e2442dd39362057b2f48e3da75a52b497d7a9309c410535195f502c5a46b4c66de56eef37afbd519c7bfa39aebf1a885c9c87429d13272fe2012865ddaa158a65bd98f7b8e0aec8d084923467d65727b54091457e46f4b8ef5393820017f594f1964acdb33a595cbe504e48f89f5b1e6ec32393a68350991fbb322de65d279eee79c7c0381b373406420b80de77f521c278763ab5cdd36d7822d9712262b717202f17cbc7a172e5bb06a68e59aac31cef34e5e56b1424e4645c8478973b52eb20d795d9919ea1c59bf182834799ed6e30ac16672ed9cacb191c63e355fc711bd7ba91c2aa84a10ee2791b212611fee587375e9e94dad885fd51699484b0080839fb538cecd5489a29fa8071959dbd39e42bd65675346125bebee979593737f455c21a97f1edca46a230a20a6a0179070ff8e872544506ca83bdb0c7b6375fac7ea8f13a7dc8391fffcc083b7d8a79bce18c3d27448a6054a5037008f9998e7047dfda08d475eb66bac77f5ff5a81972995468b7603d3beae033f8040a872f4a400f6356c453c6b85002814aa0fc4f66df9bedc2a02a660e8b0238d45ef3cf9c3e6675e749d2adf3c4c35bf907d9ad871ffc0006f73914e64036cf7b48dfb9706ebf59169ee86a944c0d403b77af3d635d5d37e5c4a6d7282e0ad07a4f5fb1db99d050f04d972359afc0dc007dedee7a4eff05862c9240bd6e417e9e8013ff18424d44bfc19deb8935d12298b4f4da0d04e33ef7f2f8a0a9be30df1536d61efc729d80aa8dfdebc4a6cd9deb6f21b051863c310fd058e0fe53cc3a60b764af726f38f71e130cc98cda0f16f8370481081a73d8fde73bc64ebfebe740a7cabeb1ba85befa195bde66bc8e21615d0d80314694fa38a29a1cacd49247d9d26fb67f2c249713e0758cccd36592f122f754ddc63d9b246193e7bca249efb99d7929d8b0241eecfb68fd6890b9bca8cc217e741c98af55defaebbbeba5144b36514d32113e99ade7924bf0c29b6086e0fd561370efd769773e9b86b4fbe9218b4f6e37756aef4228a10bf1ff0da7626c4083d14595d9474c6e9c1a0d10d3dfb34ead3f92008306148f3b7ce8164141b4d9051f3de01477a282fc12b6a3a5c6b818a1b71d8c3ea87b570df4fdd44d7e83f607f3f4b763bf7ce0c57023132a2515802a2b2066669cd175f96d93ce54d771ce5cb2aa196cef08f72b7ccd3123627d5f61bb62b6a66ae8d357c881a5a04d88c114a069af3ea2fb9387cd222a8af30b6487f7cd6a2edeb9ea7b1cbef937106d2424b7f382fcbf5ff5b66e653e7aced77b4bedad63680d50ddf96c03e931d100b10cce1dfee0ddb7c40a89bc526ced9b07034b8df2af39a750c7041da9d535636aa9719590a1083a485d317bf841091625126d3f5d0f845642380e27a8e2c02d29a9ea044f04f21656c1793cd5c893ccc32f9104cdbdf4a79dedcda4714af05dbd60488b9cfd4a699cb1ca9a436afa9be49a03c63354aafcc61a8c4311890445fcc54e3af7dd654c0b4e6b39c3a78b84512134e6b7ba4cd2664f0be93864105460ae0645db7e3b5b7c75ad341674db914f2d5147362659603077c595b49fdc916a78c957f6d11f03349cd101effcf333db583688e903c0b2ce64b94cb2f595769d9f3065e19340f08282ddc4df8a4b2a78b33001f95b29f10a85c404629d2ccd4d0d68467783fe70c19f302251ee0b37adb2b6a9796d4ae494a5be151090df4c06a4d229a3409570f4975f99dac5076a120697ae83ad04aa0f8a376867ca5e4bae3f5c3036c0de005be8eddbbeb4e6ed8c31b85c63a543b38dd93394bdae8792e1576bec261e52e173a509cb68199034959c0323318b73b5c243c22f8bee1535b9cd3a00fe3540b6b5421f7b7504e99977effadc1061e476fbde8517bac4f65cd190ae63d7be1f9b03d8bd5aebab4e2988cf697d126bb5cf2e0613af5bfb80475c1e5c2b1b649d0ea053203a501e39966d69a85f9042884b900bd14544cfd84cc8cf6fa415dcb04cafffbcde6f6f85ee245f84a9767bd7f15714f2d004d0076c4e16cf279f4e99e6d05b0797baa24d8c6517d9135f9acf8830937acbeea8655dd9a45dd54a0c1fccf5cca18ca73e447059ea5d0fb1e40f1ba17cb11a877d9f8e2974b7f55408565cd04586f50d76f03c46f1def6e8ae63a33ef17c32fdbc4cc605093b39d495fee41f1ab3f5f82a007fd0fc2328a36fc8a42e2771cc58f579231b4020e921071ca1c4e98958adc128243ba9ff6100ac66dffabce451682a3a6eac5f0f1b36058fbb87475fdd7b8290f6cb18a909262b5a44aaf977d79d0c865e355d06cfa13ad13f1963510337ec2ccc6e5562dbf48918773c64e098283129644de1fcb9ada16424853847b98c99f01d65d9e25c9aba28a82a1012484c1ed5e0b2e798a3a888a65b5eab1da7c83328ba7b6ec20b9c1d94f0d744b197be017ac4110307251adeaa111c557b81a2924c4937a7d28512ef19cea4e5f681ee8e7d46f169ce748787e079b56e70766d3e143d7db9e487e0e0c477dd7fb2c99b735a955d79e9b3efc67bb17244f53a1deebf67d29e3e9fcc85c0e86b570fb668d5120c574a040ade177fefcb2f0c1e0682a563d263fa04dfa0a65373453dd6fb26bfa29b6c1a204195627e55dab662a6d5e0287ca78e7b502ef908507430322d020f124fdb560cc2508ca7319f58076c0a802afdf16036f32710ffdc23a81f7fcce82bb4cb55d61de324a17f6adcef4ac29ea44582923e5c57991618bb5094d312e625c0696a642afc9780e1c6ed33833a27cb78d13d12fbe5e862a21407eebeabe898468c3afe43f5cfc443fb548533d1c62c933493e94ad1e594b1bcf20d143f66f9c7361c30b7c79aa0be9785670618b0479417ef588f00963ab0b6dfb5b2803e4c773a6063126fa718ef3d14a3f1c8e31cf3556369efaf29a9ad269c11473024ecd1aeb02c867434380b1e09d0e846d897fb363b3755b61b767d53900c713cc09fb88815508d95318cfe00afbfda78ca0a72d440ab6a3a907574c8d26ba0675026e639dbf241d207f356e06639a1aa38a1f0654deffa13954474af13f3d79fe5af06a4a21f4f17f00ea7493ca8cb84e1fcb0603af1b6050a59171978f0f00998f1bc91b5e1d4015b7c6051b84bf2ef270784a468b48d9b163582b383a99f58ad436f6cb5d47acd2b1432743bb334862482a4e7e765cb611537e12388041ec65a215de98ff8a4aa4609ac79e19ae252d6faae297811170c7295ede1a6bc375d3364cef84762ebe6fb0775d0c35e4942b5c9ae5b5bef23d116f9489eb1c1ebb378ceb9fcc73a8c477111e5e949536bb2dc73cf26c3ddc3deeb5395b76ccbe4a42af7b36eb44d9438e4188248d947148d882bf3d67bad5f2801bd2777c5dd0809e3018ddf6deae16b646d0c14f875dd8f1d80f5d035a8e6942ab497e436582b85ffc341632b46692299cee6caa6952e4c5628e24b3557cf746f4135e53b91bc5396a6970f187f8b7340fe633b38fc1f78f27c3f133054895b7008b563625c50ed60ebe8260215b7fc13f0072fe8572759489af2ac8a85f080c04db02b8ba5e4b22eb1e4f444be56f50500bf5b3b40785e64e0304bb7c235ebada3b6a2f168752e73bc05fa379968293d1d8f6322852a26e54374c9f2c52e2ed748967eb41d802f2d81286f70f2f1bd9539e3825e0fd9f618d5fb40b55c4995567753a4a6dbad893db102d1fead327e62923f0ec6d44b40693fbb4a1e2a3faa5c52861613c8663afbf6c67d6b9350b0e8ba283787276cccdfb6b52f1fe997b0d1eebfc6943256db858a02ec96f345de14e2b523620d62c065617597cd3dd94fabe77de0b1a9439045daadfa8d56d77b854d7d97f5654c17952931ffce4aa1d2a68649253dac5238e1857480e1b0c0ce40b0129bf49deec872df27ac680ee3d0cfe5e88dae3a671f62efe0f55cab61d53a8b43a40f5e162636c10b44f889b15d5666a340a132a46ca520dbe9eb5d0940d31f9a469d40bb7aacb8aceb34a404dc6690354b312cb13f1931105889847b23d9ba8ce4ad44f5694bc1dadb5cbbb422734731c770100e53ae4656d64cc1a4f922e70bed2fdb88df72ab93b6cc7bc46888baed64553d978feb1c019b37d1fa544e5da1bb4d6c66bd99853c37e86c7d485f037cd9a1ace4b7f317e075963f222c9b59dc1c4baa1cbcc4f2e3abbf1593d943f4ca36f895d3af9b442b7dc84a3c7c62dbb1acc4d68e090082bfbd5838468f4994f8b15ac2378734df02e48aaab86769b4c02622e34b7f53cc5bcfde20271413491229f8d55fc23720a858fbf234b9ce5804040ae1ed37eadb797f8a99cf76f65ab62ab448ba303b0b7efb6826a87e2588ca671c59c89d4d33e1ce7fb180082a9a8a831d4efe06d511b861f90862c3d70deacb2944e57e8cd2b1fdf47cb569a01b815e86d0a00b79b952241218ae8da8a8e8266bb388fd7d2e3e36a6dd924e96bbd2704bf6cd3331abcb744e0694f2ec08ff3c1eef1f7f822fd87d8dd3cdcdfc4c257defa098d0c1d7206a6183b1b31c844b1be354f674a11f478d8a648305e18373361940b4d86d855cb33b56b38a8e6e1fabc62e61371f46f4ddd816fb2821e3ea48b2f80182b2c4e7f576a9296ddacd99723f2d2448496e5481e4724d83d6ddf3c52f934bdd51b5e51764571311ffcf0fff6fccfc144527320f833376180b9b430980fb978827112d9fdf856a6f12ef6762844dd96caa467fedb74cd82bb517ceb3b2b1257789be38726174836e7e9754a5dc3227b36dd3b5d82ca086a9f4e3e04f20cf9bf5b2552020f66a88170371f5d6997dd24bda7b9704afd61e4b19e5c2ce584f3ad213bbe03783b4cdd189f2dec65bc63c3d81675145a13b407ac23d7910bd36dfb489e3e081f0f8f6478e073b99a74f98945ccc2f7f01e9c630efcdd4454a12f87bae402bb7312af33c015f095b26f464ceb1ea93956020f88277e5c043c655d8a68d0263c0f20df889cb32c9da687025eea701521c63a6f8769d988a840b43f7d2211206d706dea0862d3259de2e4510afd3151794145973528c5405e2f612058034c10b3b64e31872c5635161fa8a0ef5846b1f57a61610c2904a5127c1c7541b97d058592ad8f3ec78e0325786c11bac0bfa8c4672d21ad65991190c184d9a1d23a2498eb0dd77c300b5d484ce65a52f673fa0d828810fde2439be04cd61a3d5dc7a661aa8085b948f0c8c5f5ee9253ee2d4cbced648516a5a9b02eb54862e1a7f97e9d05d5e3c18ac2652b85d8b5d37e0a4b51d17dfe464d0de074a778c4205f26b7073a6579bcc22e7652ce49a6fd6e575091642afe643b8f1795b0cea8ff7b922fcc946a72b8a5b51179c83d615cf01261c5e4cab0534e6764f29615175ee62d21da12001474f0889a46b1110c810d50c76f926ad59ca8c9fccbc72c864796db2835abd637aa1f6f9b023dc5af20f9d1c2596a752ece2842bcb2b3afeb44a04fb75b8366a7d5589d6824dca3b68fd00480f38ff06f19b2ff84bf849fdb35c39336f5186f0fcc581541445acd5b1ed51b6f6b1bbda4505578712f9bd07c163feb8627feee792d597256d3f3ad18bec1660401f5e6610848eca75952f1bed672dc6883842d771470ede5fc9548105bd8c08437c5f6ab3590bb142d3c19a05053e7aa79eae734afbfc1a31a1f37741301e2c63bdefa4733a76b9b9ba6209c738a5d2b1644c845669793c150cb2ab381811a6ab565af69a2ec61c223b5dd802b7f31df5e8aa9f9b7b4913a106b262a3c02e449a8f5c1457c352842756c36e2597defe08a1fa427c355a598c4da5c67a12471a292bb4f7681e1ba988801fa910b2317256338abcacbcce4fbdd6895d8c05d64c566a32dc68b46f826bb5a0a5f7d824c71173b81da69e2909124c8efa1d0ad51d1481774034f6ff29ebc45122467303d61aa1bed24fbaa834bb76c7fb550a7bbe9421c83a974020f1ff16f4fd56b9717049a64102fba0eb86abd281a378cab5c7c2602cb91245611e6c3d0e3754f6f0e97b24bf719295dc4635d348486ec8c7bc2a234db96f27822db20ef2eb16fdcc54baeb94b76a60a65119933be723fde33c58f55d3d194a616caceff0db1ec79ac425e40ab578f06061ac122679f95f2a1be8214bcce866313412b424b8bb919ea3abe44d1a3692bbc6c45b7813f6368b222a4f20405200c238c5ba0764c487c80e063cc7e37252c5b7683e62c426cbc50630f76bd11b41faec70c6cfa6ca5fb2691c578992c788d190367487676d2f1e541540386ccd64e3ba1faacbf4e44cde3c2744c470db8a5fde07a88e03647cc5771e886b9cfd3e7c497172be3321811aa928f006fca318c1384dff355a79d3fea21626954d495bb55040fcbdf54d990878a1f13fb60a06b9f64851a6cb335980a19c5aa0123edeaeab2ace2abfd0e190106f870921634e6affa8e78a4b0255a57c0dec724a419adc18b527c40fe5a783687559b0935c0f373a16397a20ed99215254e5651a927212c490c55349ce5ffd852acee05ccfc1927517ec5cc5f2246e205f8f94490eefcace680141a929ce76932393a17893d2174bc86e4bda2c16566e95d15c4f470ae13b03e27a404f471eef2b1b7bb318fb267a0ec85408e145c05242365bf8fe2ae682d5f913ef10646e6184b86370c108eb084277506dc1c43b45a3587948ad1e19481443da115a125b4f777eb8617e14440a47ce1747d7da9d8c26d4961846ecade4ec11693594cf75ee8e7ee9cc2f5fdb29d172e5448c731614cb187a85263e1179d603c2c12b3ec924f1f04af86821658ff82bcb791cc9b204624923eacb704efdb668a20600e60f5d3745e110848d3767a3a121a19f445dc46b8a71bd10d7498cbae5b4584351101382b70e9c3bbeb2f48ea395a9f90ba7be8a56270b201eddc15cf28e8d5a389b5c822eca69f04bc57b84e312cdf18bc03452b766d6142baf96955d65470b47f1b2b6d72c35d1f69455cead1f234dc9b9fbcb1e27312a6e86affe6754449493cd6794657b77698ffc439b1f8c1ed878cd05e8d862757b72a9e8a0b4a1f164121dd0b7efef3d5cee83e0fed2ef4f093d152ea00ed8e03609b1ff66ffee0691a18a21938abb96a2ac2a435c8799f6f171c531163f59d0099188e27600801827a1eb8bd6df00fd77c4917040515c41fcf4057ee693b6289642079b843273508882be8918150fe14a150c636c1f7aa38b41eeef93bf011c665bb00b0ed665cde3ebc3e09d3feab6ea5f2ebfe847355138b42661c6d070cab35f5373a3fd45b29a5a4edb755f7e77f74d902890beb8d97107568857a46c57aeec22c97f1f71a9a76244feb6b0e3ceb1b62a01c4580c9557808b5392606a5f488989f9a220c75a0f48a037c8e444ba68183691b3ecf8eb1bd95209fcb907d285d3af546bf78d697655a3303ad69cecae4b4778aaf62462611ee875627c79c19dcc845c19c8ef0b19a96daed6269ed78368734f172107132d7f3987ea673a9dcfc7d43a52b4c571156774a2cea1edd0e128a69e042d0d0291b725a946e49cd289bfee4e01d4b5783a9b37d7cfba726380b3b0fc807af63d7db7050a8a6c3347f24fea080af51d882d7bdd40b053479cdfede9b66b6a141814dc4c488d6e33d9c432ba1c18f08887611df5550e3968f2992e40a1f06ef625b6790db9936c16be9169339a298d2e87db524534e950b9fbad08eed67aecb681c306c422ff4f1937afdeeeadfdfcbe951c6de84d527b0203ef7ec1146276570c50daa6a10a7391aa155e9de4f2c9405de8a434c55f21596982b2a002dc6c481959f6e158fb1eb45f5cf9554c4e901823c79bfc1a2fe420fbb72d305c961c717f49808a3c060d364ffce2592b279ba74d0ca24935c268f19e59792fc0c995db63c3646638fa13d84ffda88517d35abe910f99ccf760425da655da2ed3a8bdc33043ae1e2c60f22a96a41058f9dc44b6663774460478cc4bdea95bb8417d88d9d1ab663d35c248c2085338b4284ec4c270e4a6c5f157b0bf137b91843c0f5d3363f8a904c0ed83f5c3961f6758a35a7233755afd36cb33b54b147f4d708bc2886550cdc8e302b4e89641ba91fcc99cf4960be090336aa55be1994d2a6cb106507104b3ecdf200b8454177a592a4355d85ed6a30b865cf21cda3124d87356286b714eb72f4201ec08caf591b6fa774a3f02f40dd203bffca1df8fcdea7ff132b8d647d0671ba60e3b58954f5ae1b3d74f4df364aad10d25e560914d1df700296b37ec3f0354c2d79d7bc8cc5867ce9ebdb550521f5eb058d90a5993321fdeb224e563b4462f41d02667678c404a865e47240c62e763a5fa9d3cadaa776b21ef3b650b0400eeaba102994dee8fff52a75c91f911a93ab2d9f3872582487001c2f8cff1954adf16aa1f4098bd02990abb84a4d0665cac009caf692f4e8157e0406fff52687980f683be04eda4eea52e4789a2fdea4d161817efeabbf7539f5e54e9cc82aa03fd3a7185a52cece25f2a2744f5f49ba69f18ca23161726923d053f664f757e4eab215e536b47dcc6e84e40c5c284a66f0ad29dbd55a5ebe927b2fe77e19007d8690524a176a0489d360951ae0c9f4d71482e12b848000730762e51350f03a5c8f880465789502ad590f514429fde3f85bea283132cb9e53bcc3a44341b04987bce4f9f85385a6c7bb65458948298972e889b1c4c560ae9b0afc3513880b98cf0bf629f73e02269e42bd59b3c332ce470190ef8f81fcb408d17453fc8de86fcb4e7f3c2adad26a90b42376adcd60a5dbb2d6302b5b0c869972c2660a97451c87780d38a5eedb7a0a96581257d95b5f2340ccecd701bf709896e9b72e34e978c1b117d29c3ac0b3e097ef8edfade813d997d65137d0ac66f4587dec68edc386982b8ac697755cec8db25da197ba7a98b28806bb2a4132ce339561d335db95ca082f54536c81544e0236af1f243ba936fc5547b7af0aed7fba49789ad76a248aaf9acbf849019839bd7bc968de70539066bd396b69f50b93d85c6ca2b3bbeb674c364b0773631d825d14879b2e442db6db50b50919c687577e906668769980b4661a63c5be73e49619fab32526c46952c7d921811e020882b72b74663acab253182e7f9c36de939e61f0fdd07e12bbdc6fc9a395478346aeb5172ff13e08898c7fecc536c17b7e1f9cb00e63babe9a6160535b545581680a7a7ea0c84b07feee3028beed640e2cbfb2f687f5451517efefa17c8e9f860ed8bd7507a1c435199edc63bf218eec7593f9521a0d42e5ea737a512c7d4ffc6bcbc22f2ddd9a1d5da8c79966ce28820576b463dad18f3d060107779c5e7f5d613da90c5d90d890e3a058d649f1e827a2ba12f656b13660743665e9f954dd4f7b502d31e4f8ad2a4565853ff7727f864aa27a341967a195eb5dc29132547d7daa4c7635beb8c42b37e7505271c45ae5dad628d501c2de19e81a1c2e66abb185642b6c083c8d91537866863ae6279eb13a0b05e4a9e5a6488b90b4baaa90fa07a66e13f58bac5f551842ced58cdd98f59a83e2e8b6e03e94adba59dd42703ad0039b269e42e55f4254ebc92a3eb10e9ace88b0e23ec7d5ac27bfb5c4787fea788b896c8b1912e522bc2081fcab6f83113706d2c20b1ce1bb5574e8b6aea1e072e55ecd078eb277082413b2e849eb95abe3454c562d4856f5f7e7be8a9eeef02a93cb1e5ff2d84adfabe4d81b0ca0675b39b37542a679b4e629b720f2ce6df7c74231c2e484c8b0209e402b9e17671c7695fa0331f874fda754a545d8496eca1334fff2e3289108cfe88044b21b6052b8d1be1db8e568ef15ae60796914b892ea90b50ffeb258b9f084d0d8a931ca34f9cd095a350ff8bef8be6a4e38dd514084848d17c060c83e729fb0b9fc10a1b2f66ff1459f689b4b95b1cd41d6d6e03903f227bec8284827384e19556998d6fca09a72ab7bbff2fed66c032dd38cf596038922fe4ae7ed55058c60a5cf023d83446b0fa34c87a44f5bd15feede37e1838fe828051f0b876266fa9c67e2bcdeb3535006282adca6ecb9867b61073585c68792944acda15bc6534a97b8db3303b6145d08c1fa2b987abed4eb2f3ee8948d7503c24eb961de86836c71f0f31b7521d82bff1de795a318ae697c6d838df75ccbfa524a749081328abbec43837006a4d5e06a995d7f559d6d3983c89f43aad8ee648012cd7be59112b17a1594c35fc51def54f99ebf183971ec774371326b4f4277c584c371ea706fdcf62f89d03e68c723d1c1c09a721205637fdcea5e505f3303238f7f8e21741b19a7c9ba8112a24e76c69eaaa970a6e145e528320e3b686e72deb2fca3819a477710f6fc45614d24e2b82f40cd5bc03c14ae711150456d41b9ea55d2c6934cc7445bb87b46b54b84033d895e81d6343f9ee484afe322e31eaced750ff0808bb15354cbd9a61b276871344fa6fe6e6682b0cb53f18993abc4bea78d7784c5c2b4eb6761fe594585682b0c14d994693d2a709276ab5054cc7c63a6b1301f94554df830535c587f7b10121157f81a827fdddacd55952630f1a078668cd94d238490192ded5f8b8a889fe855f1adebda767b13a3fc77fe9242de35570e68e899bbdb12ef20114481a675186ec0aae0c235279588ed9df4c2738229523192a086b066c3132eb535c6c5b28da5a1ce38c4295b3ef270f3a03a34bfa8792daf2b5b9e26b0a91431322fb9f1961c34ebd287a906c6bd78710659d96964cd4005bdf9ec4df9b58908fe9ae0e62ab86ec6a83d871757857cda250c3824e3a8b0f7a974c8195242ddce652fc22d6aafb8014c0c96560bd5a3a9347b5888bf70615240af1476d72b75225e1f661d5fdfd23c2e20a2df2f35b57a6dd947f9915aa8a3a52ea2b98251e662bb641d3fbcefeb9736f6d75decbfd993b844b10c981d64f96fef92b86bafd5d9bc5a66794f8198e6a8f9c7f4afd1e884db0cd467701476aae642987c0693fb905ebcc42826f0410b68a860d3830e1519bed808926ec5f6d476b5ab3ef5e47090a5ec5664c1e3ab7d55494690a753fc1acf47c87e7466aaf4548d742d668f1db2fb4224423d55efa6c86e36cda169ddb78a9ecb242dafdda7adef882c60c844299646d11762aa6c0433c65c540d2b35b94735d70e32e6555eb932ea95dc725d088df401bc4c13d69573dff0a7712927a0ce24ff8bf99f04d7b9cfb7aa6ecf8ab2aeb780294f36a94a3be40f256e9319fbdf3c4e162608372a10a2809e0354b722e4375bcf2443da23dc99c18f66fde3888679f894125016335302c4e617eccd70eed85583cd99de3e4256524c9a7f266ed05181b5a4f85c436e6645bb82d5be17b99a47da741a4136836e25c95c74a07d6334ca00343f29d12f9a74a695d5e49ddcd3691c36ed43f45a9e466a75b877ee23ecff19b93721c11a20c1374362f9fb5f8683ddb42d091e7124a33b3141352fdbcbdfccf81111d162739152b3706e28a07bcdf662f0fc4fcdb35235421e34fb4514654582c384dffe77ef9d5912fb603c7c08daa8c9e80749b852598764666ce06a8439ab21e448632d9705ab978326a27fd3643b5c67de736535d5873a9bbbeef353b0a0edf7ce52afe329dfdec70104ac4ac5f09f32702b0bc653faaa0bf95304258b96dd27988b1219e4e7b4c62c7fd72100b4758bddd3b33df928edeb9574587593802920aafb566a4b6d610da2dc307a8a88c59bb078b3b2ed33367d23b902fe2e20767b1357b89ac989ac1298f471fd67cc4c66f0ecbc429f95da9c2f2ddd959705f709f23eec682ead742b3b69fc1dd17d547d6d0df02b7ffee0ac54f505b0fd586e9cebaf49249c3bf1d771c8a7c896cca6bfa9595a7ea4560a2be5601b1d47e6d7c7805a23af185b03e2b7b0d5e940270a728edbf5e0641ece9b7a3c0427fabad6c3e41d36139188323f81e6c51631ce8bfb206626026a568efca09daceba6366b2516106547d146ea8bab47d701b104d88da50395a72fbfd372bb58759addc0bb547ff3bcf9b2a73291603b5e61b6d944fe0f7a486b5f4ab92d87c36a98fb9c760b84ece72686193cb57b531b4e02bdda763ec539206dda30165a26ed56f63b21a416b27894f6303e1bcb6cb58a339ffe6b4fb7a43d72f8ba1b27fb7fc868f44ecb3a7c09eea655be54400bb127a2f35e1b4e63e1e81f7f3883641bfdeee2598305b7a256c76809eec85504321e86e2903e870713c9c931ff8c2bc380df9c6333319388dbfc35b6c5565e1aefb1931e82866ad5110330237b99f7ee87068090ef5ea31f4b027f6621b7484c52016ea5930137f471eff12357aeb3d1ba8400f695b2ed2a22a9357cbd77c5c6094f2211c683c65dbe31acb5c736a71f85466e972907e7e7aee4279e6250ff58588a0f49a0e74986aa6bd3a60056557174455b2ec0eedf7c37599dea5ef0aa3e0a73086b56bb88fca266f05b82f9d9c6c7bd9e37db61b77a20b3833ffcf0bceef151c7bcddd294b38b1ae6429b94bc6abb28abc324d3990452a8021373cfba97b3628f3428c3d2347ac8eceabe7d9f5381c06c0502526890e177167705502c91ea5b89e60aaec927bfa680e014adc81ec868bcbd58e5dd6cb5aa3f8e030021679e1eaac6e5d31f4d5c6306907e5ef5b771b0f3c38da0701af4f756404dc6ea592314a0a2300ba87ebebd8468cf110ceac6fe470171d5c41549aac95b4224d1e21e0c022383052b52ac231ffe999a2590194eb22933dde25916e086eccbec5c7560c6aaee35aed5f110fbdccb7e418683c56cce5d1e4e6b1969eb1d986c519498c74f00dc1649d271b2e4c8dee163b6c6cf20af477574ff9ac67ff79743599495c6a30e82f8d799f163d1a550c58eccc7a7e023c5ac37c53a1871dc3ce29ab8ec19353a889568e704aafff4e85b6674974d2f545d71276223b98d90f870328d7a710141038cfb2446c47dceb3e6f8035e58e750a3a0c8c99f7aeb805c54725ff7f86cccedad8eb9cca46c4b67a695a8e41a72ffaaf599724ddd1e6d4980c6a6436ff6885b291919428fa8403cc939c5298e663d35569adea06f01afecc11496a7cbc6640405eeefb36a00f1737b1311324a6847282b7c0b6ad03cfee70793fc0919c328ae715dbed94794398ad3fb2704355d34383a19926d9110d38a83cc87efeb3918460e4c935ed7dab4c06e2ec14c2782f6bd92209e282b0df4bbb348e5e54ab1323e367a1326d38e488d61bf78587a258be1a5954ba0e8cdefeddaf4953f7835302194ae14b7e10715b07d0054f711b52a97d533b37c079cee5be9514ba81c9bdf50b5105cd2ea95f34d427514f8c03cbddfeda8d3a87fd2506f156bf19faef8c7e6c9d809ad5edc929e419e5e76a4b4b4db572e643c54c15fe740c32c88efe6c6f182a3d419a89edeffc16a95fbc3b78808c4b9d5c6c5ce5a9a2fd8a7995e7dd8e6fa461b46844fbbae958cb59d95b18188b63b1169ccc68fc47cff204d0207613c431206de1e15265e5335df40b07d61e9ded986406d85ce8652520d261824d8d3b3dc9d3e79320acf134c502f8eec9e2edbf220760dd7c3b70f4ff3f30d438cd6a448016729b0859c278245c5619f9b634844bf3402b965a12741511f8c8df92d0fe86ae9829e2ea3ed7ba74db8b92cee08ec23eaf8d8bf71f9de11cfd0ae610cc41d66d2142b733e4e87cdbd4f84c15e67b7489accce45a06de2aca333892894f44a1f5d52306c815f2df29741743b435a1efa3fc07e714bfdf2ba7f048aa929dd5dbb4de42f4901a41d4c8ee8c71443bd593952678b7f7bca48c42370557111bdf4e60472b3e2c56d137353adaaab55f7395fd8bd4c20bce71889ab5db7f4bfcb12b757da99e66035fdcd2c27786cc7017ba16060053c141df4d8118c9d05ff900f5364cb968d158c8a40df62526ff5c2cf537baebe4ab33aa62356dde806a33fac31d410f9a8522afaab08c65072645f4714517ce3ae93228bfeae3f839f46fcd9a234b8cb641326835d73beb888e6d2bbbd3636d7acfd3d19540ea0260700394e9009d9c2220777bcee9cffc14e46cfed5a49be7409daca9ba47b39b586776c76e76f5200d32d6c063d7df3be8be649d5841177e3690c274c265a34dd18bb6e095faf653a8a4311cdd998a7bbf9423e993a85b971ac00e22aaa0c8a12468553e89e60790ba63a96bf13b641ef885fa2385a0fdf2a871e9b431dae3c5d1f25e4df66dde73a04c108c96dc5236c6e89415aec086dfdc75ce656d0a9854a6971a7f44b1f2bf5805e9fa62bf070b1d3565cec6c89f286301cd9ef2edd62e659ae69908fc0b59e68841a60e67814719a6fef2b71262ebd2d9ed969703d70d9bfc274a180440edaac856766b3d80701f3ee824a7fcaa5381192b1c8667431e005068aec7843f23b625d88200af281c0be8dafd347575e1f08d6cee809bce1ad503264d823f91f008888cfeae2bedca567c96ad3a80701b476c0feff8b650a12e588ca3618527733c80059e34d5b083487b7dcadcf8bd01b04bede88dd6b628a590e9df448e066a7eec6321c75ff2c39016ca164c912850f2504127f6fb56b11d43e95cfd077fc0a9048a623c1bb1f64c9e96d3a91204f296ea5737ef2ad7b4a72b5b42ba725a7b7fa279dd8bf00a37f3b75ec0dbdf209cd8877f8e4ac881056bd73b1e47912b8cad289428433b665f8549872b363aad6cf3fd8d0fb251bd0971ae7ea4c502a5d936b10960f23893e7610b66507110681dc744c8c3bc268a7baf3c3e9d596bc49c455ef156c9cf1be3031c26246cff89b2bcf5eae58713f3a8b44b8b67884d07d91e693d3d81c227f8dbc02a814cd61fbaa7a63adc982eab0c2a354745aa87a6454a705aaec11af65bbfdb564da008ca260a4173de650a9f0015cd4d06a27a765f22533b18827d40ae35c03c9f68a174b46abcb458626e38ec22ce345a9a991d3cb93c75f1e0536e320268e4279c8cdeec06760d2fdff83baf81a0c12878139025fd995fd8bea292a554320874e138f81f21ac4239c522108a3e6602e2eea82b2b6e7acfab496ac3a35745e279aaf15c8ca01b02058e00608ef629244592b057d5711d813cd57ddba4bfd6b4e7d2ce212f6576594182fd8d46fd833f8ee062817c105fb576d4060da2db584c050b290e7552ee975b283fd89b02376933b450dd0ff42f7c508707988029118b05d4e755862c0b26bd80152ad4821090d1cf8658e603aa3f7980f60fe14623dc42b57a1ef9d501257a9085b785378061f01aa70dd93090cd230e6c0457f14c897ab459a1104","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"3b65e88fb4aad2a4dfb95b4861d2091a"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
