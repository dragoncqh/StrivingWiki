<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"375eb3efbfda510f34305f261782a2f86ff58a5f685833858dbc1267f1513a3462d72fd934c4c8efe391006bf31ae53ac019554a2b8fad57a64f755855b92d2544b21237a02260fa88fff6e1ec34bebd4237fc05c59c5721ab6e71c34c1f67029366e8e8914e518f768230fb56da930837102950b9e5690e5118c973b46eea695b68bbd7c2de424303ee7da1a32dd54d420894de453b415f8638ec8e39212ab9b43892c1c7e0d810735ab9a2a357b098f4bbb5798e3e03ec42749a82b33484297d52a568961e077be10e6e6b02b18a986eda3ebea39563f35b2c415c1f87c318896ef78cde818b80fb175229b168fe87fd9d65fff4b85d396d69dea6f26707610ee2b110f672a544aced6cf51c243b8f38e40cddc88f1d04e49e37c7ca79d2bb4acf76d232d0ce3307ebee27c9c1cf9fb3995e30eb960b3c515611e6cef566996f358d602dc2e0e15657c6b372ba245b761eb915323320eb19f88a2b3f8a60b39db1d6092d2329df0e804966bf6c33d4012f4fb28cb13b8a35eb80cabb79e02a71931ad09610834510c06f8b266801e44353b8ff904ae26198e1206f7a414de2c5ef66d5cc5b40067893de273f5667714ffedbb2c533fc23531142f0ac8b28fa9e7dbb062ecbc73a9698040c1f7607f28842c910c25ece0b4c94ada649955846c7d56ba056005e622e42ed3634dee296b42761893c2a8bf06f1287ee26658e71a74f14f3cf8d0261931c28d2e03f6871191650bcf2f035cb71764c3adf646af9e33f400f85a70ba616e37db062d061adea12929523b637dd0780d1f3f05991c11876a816b09280cf1baca3f412e636b4dda08b5447bc40db199d56c61aaa87b6d1a607c9a9ed8cab45dc6948f380acde9ff929f5d094f0a4b0dbe4037e4542846585f7e53cb004846c3a37db70eac0a7c939603a87650f2c55b2afdeac2fe87bb2750425008faa021008279bf3bf7b7e3f8e305a9216b8b5310b06ffc6a8c55213ca858a639ebc83a08862141a0f27f6fb7ae6992e27e5a18f4bd8153e59371b99807444e673e97ef45217b1cbc6ab80d8b970b5458b0d031c6b7cb4b44d1fc3a5feefb131307c8da6c2f3b812a2219827fad67953c1dec6fd136811966bbe9dee42c0b7f547b6e8c5e3c69b6d5627f627bb4965ed8a0af665f4cbe754d03a55b02222389785a31a8178f35a37ad56db311828854c3297a985bb964a443a7935d29055a3969b2196defc51481a4181ec89ee5716f28ddd8e14ae3e8e90daa68816b8efff9608d4398c8122252d3e522912092370cd5c7c20704ab2eaaabbbc78166e86ddc4f8ef692d8b83305f2d4e521701b6f8df36244068f818680855214129cdeb400f574b50515299d7802a0dfe8f9c4af96f13f9f97c2eb5eb6f125e61dba45796bcadcb86d9f2835b4c43604ac7a07a8a0e4c3c56aa55207f24b7d7d923f9311b1974c028e9428b337a8cc835f902fc3bd81545b71806cd89c3868e88ace9d99f1fd364df990695d7d1c0f6456f52ccb02401cdaebd9d298648dbee5912e9aaa8f72149c488dce73fa54f34f3df32230b490db4408c087fb952f0acd66b2c56f25fa654afdcdff8e50a48a8ed07d19946a54095f76dadd6869a45b604b5873a1487c4bec30ec8d5a753fdd54adf99426e81352be903988e4d8a3a4108521711d0ebb173cbd30cab0726cf4a3199c8ce7b9f1f03cb6b7cd053daaef11ef0f1eea688f731d37c535493b55d2b3418338f2b8111e8d4c3d8f99d625fcdc1691912abef2ae84e8b0ebcc3c1cba1c3052227c84bf0e15853af71d1716a72bbd0a490214b704bd5189f10af2b37c85928a29a62b4ac6563488f3cc0b09109a7d9176e2cde4aa57ef29ccff0d9b3248e3fc1ab0ad7e72b927658627b9ad34d8558cf9b8fc13fddfe6c49f2065b5f776311e124a275664ede20e327c42872be8ae739a2e7dc6c4a895265a00cfdb96f96a83d09d44b05bcbd16d9852643408f60a11c4eb68fa65e51cba55072bed6c94f236ca15f6a7a00bb5ee75d2a50fc913d3aca067317d302fe451283cc5483a8cefa927199cc47fbfc41762cbf5bfe54b0ea37b313a16d60b0938c51c2d526944b76d1df153114ecd7e9ac4cbdf0951a7b7930ea5e10d09cf232a13a77a641d5064ea90643328ae6fd2ad5f6d63b77038c5915beddd9a0fc92bcb656e75e9b51a044f95137748144565dabedbf4051353392b1bd6ed8353947330ffd47bb046b776000d72279ba7eef97f5af7ba33c483384bd0309fd1d8e8a6d8b9b17d2c2529ca1b494637b20ba06895475eb69977ba5c25d541a3db5bd68fb5ca0f6562f9b426697a80e71c6f9eebf2337ae6f1e242262c87d995012e71887818ac18f5cf754b77848b4ed10c0990e49dad9312bd78de1b30973f21379968ecf052727edd8bcc21c32ffc0146ee94055f1b7f7ae449f1c741c0cb123b073bbc9a828b7045e3f220fab2b54399e3391740c60cb592dc7aabf012e526329a85220a9c287682d2e9ec299c6b88e91bd8fb02e4951fbff232d3f562ea63f6ede5f218210a0028d9425690922e2326084903082b59d986d9410f35cfb6a19674c328adf52fe94dd4cf34832a5140b65f9617b3dc4d5f71acdbd05d9bfd108f860f4bcf8e4f34304c0b19d8949ccfda0e06d4c8debaf2e53a08540429a22de94e04023a7ee17dae5967a33607de1a0cb5aa17e499612b322f9f41d1a4b519b5d61f37c77e480fb7e7a9a84186d7d031d6c3952e9f10aabf99f677c2fa146e9365a6cf21e41741d4fa2c606ed73a22201ef4fa3bd5c51b8cda5cffba7148b1c71fbd848958e550e34d0ffcd7f3af733fbfd16874250ea9c5e0863254d4d372cc14a94247094bda17d08b6c3946d7240abc3fa28e69e74b83ee1278d0b2283ae0feaf59789374c553f12d183eb497bb71702fee21a009b1ce07f18ec71cde64ef1ea9b26e08114791695d161878329a5e3f741c23c85cfa130bc78ee4c0294546f3503dff6e9ab93a3d67c9e8e37986929452fedc1971a123a53080c3105887fee69486d365a6bd24ad29a8e1d3c669826c9db3194aadcccba49cc4a08810176c6fd6b20ba08bb0ffcea7ffb04519a32494562e8bad78009d97451f790d4c269a932823dc86b5b600002b2ac9f16fbf4ffad3bc11052a97ea16d389f158caa5eb3d6736b7189ea117ecf5687833edc040914644ad1d9b563dc98d6626360196ebe45cb76d9c4b482db619b6b15231167d37ba17021100d37ad90d09c718e6836789cd2aafc1e82265ea475e230591a437ca65b66418394fe9df181e16420bdbf3118cebef1fcfa934f544f26790c2c7121ca83ee59055797495b1316add9fa74e82fc198906d5d5f01f810e9352619ccffd82494b3ead1d078d34d56095e096151304240e7d0926686fc9f96ace8e746459597271fe5b0638c898ebc33761f91bc607b751662bb05f6c92182f6b9a401d8dd5c3b38f454caf2394a255abaeef790746e738878414f46d22f24433df313a0ff66dc2a3a13a5f8302cbac1b1cfb60cfe9b09056ea924201aa11ccbe2e4837e5e1198b15487933ff5fa85d31b84e3a6905abc23bb8903484ff0bb2682f55ad1fcb0c5bf3ae5cf14216367706b932de74904d9fccbb3f648e3e3ee9e9a50e6bb60a9fd5504256ea21d7e93ae54751a9e0212b1242b757cb31bb60fba899d89165743a1ce07d6433ef1b52a8e06328ba2e38c6a439ee570d8897925bda106e69a4e654a5e22bce9293001afb6df66f472fe350a6978a66dfc95c9d8af6eee2bd99fdb70d4c59f2b17a684627665a4a321e0325aaee20ca5ec8e5debde648cd8dcc0b90aee23a5347c32b6331f4a7b6592bd909839a43b75af3999031284602f93f4762770a5bbb2c8dd5b41c6a2bbe98acc60808e1933db9c58473c1e6a68e74a3c9a2c1e37ada88f2b87f84606f81ac5eca81ce678ed4970f73fbd062afca785bb5cf29a5192b05b50d7c6004f2e7ec7d398f690abfcfe2fad7e13cd20a01e6c7e4a23b6f4f79f4ba95e8be4a6552e596480473b6bf42b9700c61eb75f169df8e02efd243cd726da690943a4e109621ec1dd37d7b3e776b091ff3bb9212ac74a86bb7ae310126f68aa0da5527b3e85a29381a32393f5e7d12e54894919fa86036fa36d4887bd5ffdb92987a42c6a3cbb8ca48ea087329f31edcf2eb1adf4b9a52b7fb917c79e4369f13bc3e1b814d674edc43d72cd178d22949737d83c89effb616d67564dfce575219e1c531ea5aa447e759b975f8a47c32282cf9ae9b6fa0fb05e459c980624ac6aace7c0bd82d2820594f85c4f1517cf0c4be885e90b78764ad579d4a455b3916432241e2dfbd2eb2867a21bb5067bf80043aa8f2c05a2b3c10b9426f5619a714f59a3697da470ad90f134f172208a933a41091e33cdb0135acefda3086e91749ae6cd0ddbb6da4af9088bda7577dffc274b69f2a2e833e85c88d1bf92c04e70534ff96a78e955ee813f6e8db48f91b7e5c2e69bd6944112b94dd0fb6fe3394bf9da6cea87722637f5eeab5853a36d4c7625c629a5f97fb76d5bbd8c0bb540e95510e734c75e68253fa4e4beda41c0432233caa1fca02d76000fa639ecd1e3988be7018b0cd7a6d51041b765ee778183a941aa9f61fd53aadb3aadee351d1a785db197eb80c495a27676f647e3f948c4b54da5423c917cef84c9527fbe2d24004b766b34211b4f7fa12a4e66f34ae4d9cb823191be4908bb790ef18f4281e726502bd48461c93981e63d927c42a110106073ceee7fdf1ffcaba14a6575d1c9e8e8a4530ab4112b80012766ea088d0d0c9d43f1296ff9b2f3d65ea1691fce131002f153c855e0d2af95926e75515aa00ffe3e2276a59ca3870e3deca851770369492ff004b14d18968ad0f8c19bac529aa7846170ba16a0fec8f9f5b7fbacb2206d31b8b736c61f9dfe9671d9b9f8df0b0aa086f782b81a1fcffd819fa7b5a318b2a5fef028c9b142bd5181c505e79bd86e0a10cf002f6822dbd22c783b32dfb139eb714d5e7c1db9a6f208db552439775c0c2c3177483a205ea84d60b0a2248885cf52c324a9d7b09e8f66d423275eb9bddb5708d3f345a8de45d02916e7a6ee1207f53c2024c3504866e70d8953ab0b58961e2630c478f415e9fb033961d7b84864e7bbe2e9bbb69e2db872a361a20c33dd400d566517ce6c40fb24dff5a1e50a4a6fc89ff8d165409c389bc051cbd84219bacb6f4168a2865ded0c429b0d0f008e6d408142dc5fd28fb6addbf07cfc2efdb34740db437cf062ef219789e6a999e241c9808cb9baa3e77ad786a6aea61529d5710e8f3174be448de9e8a820bd0553c67ab678a1021138b30691452a8620dc31ebecc0230d1110daac98e065045600bb10aaff3c4070d0406b5042cc5005cf5b093441c9bb918156879a33a23c006e3bfeb41ce16d809ed97defb633523260febdf87cfcce91d34f94061dd4aec9efb298edc41773a872129099f71fa8426ac4e79e551747026b7d3d5878c78a590fc1d39dca0c7d67a4e96edab2301323a6f36f6e5f59884d91ceb563f9d361fc59c530e7c7c75d035849c8c23d672b3bf625d64d6f336e0f2b14767f5e2097bf3aea047265b7b2fb2a856390b0d552fef808c3a9d4707728aa54cac1a71c7dcaa7e9110bf0c409313a27f2fb86d4a746d5d6b01329d005f8249046e4790a3d95db1f7c96f4600a5ee70d042bea5dc571dcf2d042e3fe1be806942f72d36e0c0e10bfcf9c2776a125d4e9a792a8736c322dc0d92e7e95f1f70cdde5ae9f9472e680717f8b4435ddfbb9bdcf45f1f4a380a145ac423b1e01648ec19798d960d13ebe4309f2ad8165ab475e03f06218ce1915dee4a18f8a3f394f583cb0ee481fc0fc0bdb0c196952d43d972892c69fd0ad96bb6ef4e896f9eb4c2f70c2cc41a625082a705f59628c22c673b4545562b99de6a1e52249e97e1770d70ab3421e80914a0ba230b7acae029fa2b710a629ac0fd2c832f89f88c34a149ff696a6769d558a89bf85876123989c7893aee29ff3ce9e68f189e5b205c8b1f8290b5c5360c2978154734f66ec0c98f16dfc41052c44b42139b49749a50b27a848d3a08a4d0b2a15cdfb5ce03a8af7e86cadb7bdec1b1fd729148373f0767927849afdaef861ca70711709838b93c409b893d17331a9fe5ac804a59e045c54af9fb5c0797e6bb687ebeee86882f31c7f2ae14ce91f403a4e1fc1696cdc9e8e7c9655ebc82b80a0659c3ff8d5d05735567fb90c6d6bebe277ac61a8ee5afe15b4a4493d21a7f499a5636b92ed94545beffaddf4b890f9ae91583ccddd64e91da032343d764ed69f94a8112aa253271100b28661d94f1cefa464ae0aee5610b70c1241578c38536a6a13790995a5ca3ba6096922652604facce6e8c37182a7f1a1ea4daa16b2ea7126ae820e023e603062d6a728936dd3187b18268e0f9dc6a3868bed6ab57125581fbe22b4df6712a09c55f69f07d47bf3a26a39fd800e90a1de64de71a25c67f0ea1e2d25a8f9573882de4e570c6bc6e6ae5d7b21b62c31ec885a32c609656ab3dd361f4d3db2cbb5c49f5159979ee41e0d3def0d94cb00a0698f1d19e7731c3dfc05923aec71377ab5c2875d1cb21bb4463cddddf5cd10819d9d601ee674bba97d3e96af3f3cbf8228c046df0e5a29b0c32092b387c3d6c7643bd39c7f7d9e7879dc754eb49a467acd6190740e237cbde9e5e040584efea23a76d7dec74b6c0e74f2c707984e426e697c7c97d0f6462b19697451fc107c8f9b8e5999dc2f75f38086c157846f5b91ee7fdc1d80d982101586a8e56f579afd5f919166b8994c900dd946247735693625b6d81d68f0be0dcc99b505fba1f5cd8c6fb769a4c26ad99fee5cc6c474922c53479f870b09410839ebf52a0f5e77cc444287e8e1dd016605475c078f4e276b6660f448ef8acfbeb5c16f1d7cfa8bdb6ff503539b4a2dff7b4d9cd631821830d07ee30afbedf681f73755739e42b0286ee607ae48cdddd5465696981c04d257794743bdb385ec4f30c990726210c292ef614abeb7c57c87c6d752dac373a4a636dabd848e16df14b46032ef55ded2a70297a973c477a7aa93eda2dd775d120e66ec78addd63e6cbd7bab979bbad98e10b786f6faf9c65845175633dc724d836375e179f9e975759843e00210c5114d0875cf3c625683dfbf2f63868889c88055a494542b24e8569d28a42870e5132023c8494b1bad74c57c010330b1e2087af47c2d87161d0c7177a722ae370e7276db21631153ef575714044b637f6273a0525217c699e42ba48fb99e6c2d573ee76a8fbe57a7d13b496bc935a3af694271a4ea9225fbc6627172f7308bad7f543f81cd077f0d1e34be366919f40afa751a252d9d9ce372b14a24c9879d85d3ac7c71d08d8569fa72aa3e9721f6eea04a941f7cf0036a2bb3f618634549a5afd929770fcbe500c8e72a8fcfae41ecf5be6c8ad077219da95f3f2b0687c8a2b4fc1b3e177a8170404ee96cd68f5114a30d9ce7394558c341157094bea9e8486a9ace140768b4ba5a1dd0d66d113f06f99bc4a1ff27cc8035da0688302d31e8993a500c8d7c0e9c633fcc5890e142fc530ecd537dd4036965a4da8f70f5e7952e18cab98ea7f9f1b1b1bd6ceb865b0522fc1dccdabe7dd484ac7a343e32c9da46151c881bc8800934a68853b6d33647be18dfac48a6e74c89cf2697725a53e76738b26db13ad6e812228bf2393eab8a3d940ba5f33f4869a23e6e606b37e1ea555d378def9059351248b7e0d0733f01df47569011a09b2479c818f3c1a6ee2143f8854ed958bd6e86ab6465b9bb638f1d6ac15ea535b41e5ba50b46a74acc2cdda66620e2f8037a0b6b36922ac739d161908a5694397473b671122089c2a1ea9b0301fcb7a85ab71daf1081154eaca1f2871995fae48744faa3f33c2db7b254c380fefb8dfd009141075c64cf68a77e1b9d9cbb227c3f8bec424b2f7d4e702a19d89218858d9aca08cd75e354efc6175471ac0c4b4d16c41077213b9c3464edb62848c309bd7935e4552c2c03e59ef5cc2f637be5c600e65ada685999141da6595b7b44c73e0f54297262f6f455f1c23da10afd6e33eb9742913f7c44d0c44fb0d09bf05b3f282cecfb25628043a549cb2442530c70473157f574226a276876e7332ac8a912dc033a4c11a4718bd92ccba76df18e12e5e75aca5767fc551ca793cfa0b689724e47f5a39c931381e73a36ae0997384714bc2c7fa28659bf3d8a8af30d9d66785b1cf20ef8ba37e0d2c7b26708e31d2116157d4178417dd8f59f21f885dff7a1ffeba14267aac92872b57915faca9e799e10e7558dc6895602887cdc4751b9b87b5e990bb5fcc37b0d7b986d58cc4b4f37753b07922bf9bef5b8a68819a300ad65436d576bb3567ce5ddff028df3794a195b357823ecc2002f4626308cfe5eb7d4173e14df0240e2bafe58afea1b5289cb799e1ac979acb58252082397380b461fd4d0ba298c383e110e8e54ce4738d6065c9d9f699de4fc6d044bee04f11c37291fe6521055383b8e1488865b6d56e39295b22af3e3a82943d1dba13d3568b4a11cdaed98f3cd5cf0c905c27b31012e5fad55a4884d5bf135fe249d9c5807b3985a9a1e4b2a283b03fee536bf78d81361e995e16ecd4c9a75cf2e9b13714e4f88edb53db6bf856030ba5ab24215a5544711d6bfd7b961246581b745b5468ac13e3eb2787b1317fad13648dcaa2d92c5da90ef86b4ad5d5d02169a2a98028dfc939ba33a93f86559fd92ccf46d11415b3368d89f540a4e3176754ebc2bd61c229880db0c4179350add1eb5c121243b1799e93fe3c467df4b2d1c487fb869fade842f9892d5e63e3134cf7a68208fa708d7daf298b9a8ffc3070b491771e29a450d22e7439d2c98cf17da637330d891a896bfd0a69c4225ee8429f58608ed87870b97f3af6060e02f647b8de4073b93f63173beb6f0423b91d1deff2e829216a25fd3d0aeeb079a5fdaf8cea2ea0414718258e0494db8f30c0b9931be935535910654ccca6159bf7c86595852b46907c07a4dea592b323e5f6ef5a695dd0058589ffbc9178728ed47bc808656c71c3d55c099ab3e877137ba59c6704611f36d998a61e83f8436e23d26545981d3f3b788c2f02376fee0f09adc89e8816388f7ed1c9a6174641973b18b8869f5e095c839d2c2cb43c4de307545f378e3cf8747e3a366973c76929d73630bc8fd7d134858065472b89d7fabad2c69495db699a7bcf249bf7531a4d81be4a339f3b37f22c541751fae70dec4186a923ecc23d9747fc507fb95c42154ad929c3f3f83dd291e21229333eb6cd36b0c78ccb7e2690b7708ef211be89d75e38339dfa4fa4b1150c9fb4b7bf98ad1e8f488b863ae4a502124f06e125c36fafbe28b713495990202da3a309e84cb5a5439f1417b7658bf6ae722c42dfe9e3ab01ea98c95c74ad325bbc477d961fe1fa1927a46463cc7fb68edd0b54cd9558a4032dfb3bd367b055efe59037d4cdebed778234cd1c2b242d270c94dc6ba195153205e30b4f42830ab115dfad1bfb9ce4fbb1436238fc877b532d4a40a1dcca03fad3ab50f00fb87cdff1878a3299361905362d2209bf6cd07d4ef31600793b7f2645aa0ba5a0640fab45a0fc2ed81b79cc36f8d9009121b529aaadd559aaf8e2414c7aa676ab09fdd3a4faeb0c6c4c0ce634deaaaeb953e7b6d87943cf0196e5a14cc9153e49f92f6c662967f5f08a05a0c384731cc37148a25f3fab97cf95dd9e0d554417edde36f337da410651710aa473b839134d6bb42da222eb12071dbbbbc304b0af30fe1797870b0049c689f34f62924436c406b6be7736246cbb7ad1788600931fa388a06d39d943d7a3c73aec015c91476e76f7bda43e98dd932382fee943d09cfa82b7166aa707dac6865ac4b4ef00a487cd2cc552ec2bbf2565fb4de755bacf794cd2ac1ccdb2714ae1254402512004566d7dd9418667516a01274a6b6551393519b191ffa890462279e868d888c70490bc5d10c3b85aecc32eb4384ad09ab5ca12b7ff31f2ed77a9a259b34044639b7375cacd1ba52f9f9ec84be1125fbe5a9a07e35173e7d42389b7b5adb88e6f6fb254af7d7e30cabf633a1e9f086a6fb2a25a3cbfe1d974f318a7177b66d21e4bcb8cee79c816bc7c8e4372914d268c8fe943fbbaf454435099510fbd7edf3d95b1452ec43933c0b88b33cfb0d74a4a8da56349b9eca4d091d072ccc277e3cae9ae432a344ad6dd7833b0fe26705033dd4a2b6b8dde977ea1b3c0e24c2ff4f0ff33a6224348d715a9ac52d0d6a41054339a8c14b68384da3009c758a43228a022584852ec0f8999eb3e668cf499dd0d5421871938b375baa6890cfa0a74dfb605a65f3629e53a0ea7af03ce058cd82664f2a58a282c090c3f9aa92f0340ea394697e8077825beac4dcbee014cf7d8a222f9858d437fb885c4b4bda22d09a95c9a2dccd9f4221c9fa75d3a9ebbf04f790ec6631cf1671489a1dc924939442d774ff4cd0fe4196e317a917dd0f5340876bc3de97e1c2dbf499c302c7d896afdc67b4e92f4c371c5624193ee0db2a1b3fc3e5bc1d78f4c29e957273bfde2434d2057573cad0ff9f74d78a1a330f552e1c439eda453cc245cb53400965ae8e60b913f5c41fcecd5a5ff975beac7350176cab4ce6f64a959595de51eb07517710e00b8529a01c4ac3216300ddf0beedeab2ada72126f2815300b23552ea6ea2edf338bec121fd077cac33ac1f8d2ae652df2e9ed866ac93f3f063e7a91eb7c9b2f19774fc5798a68711abd6704b71d93a1318a9d6c42a2f903de8c83de479a1bbf894a34727fe3ac4c759e9c85b35f590fc3ac9d9c00f0b27c6c237d492e99aabb6fbf4c9da9f851879f2d63b09d0d670f5961b9e4cbb516b69c7f7260f2d03e79b5a0be2a186542ebf3f819798bfeb81714ccbe474532242e3b8434332dfe8b030a76f839031316d12e5f9db6104b954bf360502f8d41531d6ffb5f9a800681db472ba5271c284cef45f9e7e25b9ca74f7293f73921d33caaa4bfee18f4dff1b101f64f967dc953cd90817fddda23a66141d8714fb9355658d48680283cc4a83473cc3bfab70cfa325f48db2ace60b469b6fad953289910bde7f338324f9f1cf34e4f08545604e4f3ad45513d491a2d024383c0a26b623bd1cae3924f3dbc74a07a44068a550502e6bc35e3c1331feeb966a529028cdb28736b3fc5888f90f008c9da37e0fc67e72a23410cd17289c87a3377032344e881f4f19c8bdab6d13c78df4d24f0e823b1c39bdebbf14035d500213f3b90666e6707f80261b598c5139c1a098be11358d0c8242b56dc31689e69bfc4c5ff2241f5ca9ea015a154fb698b7dbfdf36c0c6e1d4938128a6fb5ce1027fb66ac9c478dce00fef47de475da52ac7589be08b9a7006c7bd99150e114e6056c01c3e3d87725453146b0d3f3ba36696be7b2a8081b50bd6543d4b0599261900da63240388dd221ecac6fb7577bab6805b618affb9ec24c29df7f7d9325c1bed08ebcb5601c574c72530008e0a5e6592548b680ccca563e1d075e8920739b82115488922e2b746540b8222e48d48802e801c6446aa53650865e40df66f3219cde92f6a410e7741dad72776c178d990a1e8fe04c1ca9e94d24a5ac43261b6af6148de899c732d83fe57f65ec22a33d31dffa69e04e82ff03f8935063b64c09e747c800f2f5114fe59206040b0d0fa18e66473f0f1caebad6d56ad99feceb15e2a54582bc4a8644ad8ee9525aeaa02c713e03efd736b9e5feb82737d162aca0047c9f8391fde08e345b85ba5748374ee003f2e3bd9d756ea6900f1ae1712ef4ce1e8803cf55bae79f227ead0a8871eec24b556bbc07573abf3c5f102400022c87ccd71e556d8b601600909da8816f6ff31c6d59332a372894b8cd36c6b88aec662b98a3124d1dbf27717584a3c6bc6247d118b61b4bd8ab30adf896576344865e99fc83fea1aefde4499972d3005234db93cf5ecae762bb2bdadff7e8f3161c326958b2c6b7b0212844194e6ce48d8043ad5beed5b21b74082375bc1a0bb6d9f822a8e22426631adbd8f0cf99e61a740a180aac79045d35a851b5f30b230c1dd4966dc2ee01c3ee15807c113a599b902442db4ad6e5f69919794782bb2befd5022e18aa14feccf131cb6d6433718984a51b5d1830e43fa7a815dad06955012c12f68ff3a6947bbf315e33b6d34cf2201a8f093abf97c7c60fee4ad77e61bf2b57c697e3303fe5d0dfbffd66429a88dfc1dba1800f69b1a65a4d15b41b5e5a4aba1a2cbe0ab9c5769e59abf665bab981f509832822b22b8126cfd59af91cc019e98e9232c69528c991ee7332fe62f4e41f989925a61a6945dcc3bd84a5eca160cfa285f49880012e15d9270a253f556c1cc44114ebce6a54b24bc5227d2c6513752566345ff6cb247ab872abe4cd0015d60007976db1bc287fbce3556aa41a42c46ea3eb09cab997e5e395615d0eaf25f3f6b09e010a015b7cc4ae744e8101583aa03b97e78ee051440bdd417018d60d762ecc528b030aa21cfe46d0bad6ba6e6bacd702a921f3ed358dd0ebfcfe9fca666aa226513dfdc37657415ff40a9167e795bfc12c3c1b8003239dfb68ed81cef0ee62593124f48407ab9afe5530da4f8aa4dcc4a7d40d83ec9ab79031d54f7f42c2833f10bf0676cacfb3f5836c46c12cbab23f1cbbbfffd198dcb6c0037598be71682794c5e05d77b646f889c0eb58b87757c291736a7db18411a3d7f58308e0a557b17ca76ed509d0585f1bde5249d1beb011feb67cd84c5acca0073e2abd46ce744a9b78377e5a9d0bf8ccb4990292ab80bc977d50e6de11042e73ebaa56bd42430d1f56c949638ec23b5a1b8dde666feff4f73ef412869cbdd75ae1a63b9df016f209bf75c77852b0fc46ed5cff46312ddb4dc0613c54ad5d191fd116a7abe1c10fec76f972de216280c41da9beb38f37eeaacbbcf6e404d3360fe0a472d1d7b55acdc9060bb7e5a2790d92a84927d993233be2417c37509e55967a5172877c7ddc28350d2d232dde6ce29f60d8076067948bfb2c5f98b4b3d8e696332370d85063a7deb8008e42311c7b38f466bca9fb6f92826bfb483268c19eb2a2ca88fc00bada0b49d335f61c3a7f2d8d9b4cf26b9242ed9fc7f89da25cccf1d785c6c3bd2b2d2b3028e97a83b9d029371d8279d4a2f5fa31d317533cd47cf79bb5047436087a97626719e107f8d361ad1eae474adb14feadcedfac518fd3d113c55b80b2684dba870606bb3708dfd0440e204d00c5411d2225903ad6df013e5e450867e7783325cb2f8896fe995dd5bb4bcfd85eb67563d3fd2bd9a4510dc2c4dea8f6f05f41b13919ab66901999404f316a7027b9caf187c3efd922e76a443c5bcdc76b506a1e6bbcd1a48397dba8a0af0ca43170fbd70a2b6521afa6164e4ad0eda530894dd45a045cbf1894fc7887f0345d0f821e6eec68d54785cce620d870521c8812ee19ff20fa4110eeb76b32df04edd475783d3a7b9081442ff668ed652a658f68125e6ff262b22732d4f6869eec1fbe63586fbf3844331542435b62d8c68d740d8cf31247aad885338550a3197a6f9f837a2a630e8d48be64ce6805ed7bc12e07e15baf59ebb09a82d8197533bc9d5ba8e00e2fe552bab8d761151f0dc5c6a8a334a2792b4c38336cb813088aa28d39a4f76694ad59c36a58cd89e9ba64c73785a998570f0139f2b9c71d70830566cf50160b2f70e5f9f81aa7134f825d36a81a3e3d11cdfbcec47bd05e1e2cc2eac81d3732cd2740da4c2c6da49036e5321f0bbf475a753050d380991234dfc8788ae6e3aa39bdab36449016b8439ef2a25da3dc4c631e1182c8d609516fec206dd3997761f2d023c6f5196b54a6e794fc6c8d8f768ab0ff05034ef62d7ada29b30a64726c83affab4ec9091d1b51ec510708602873c1a67f74752ea8d83bf5cb7ab6c171176f1258fd24514fbdfe5c9b59aa9f1303d2f86f8ccf07eb03209ace9d5f93aa7e22466e1584a39194ca7a0bc11100ab7958a46870e2245e585c522f78dfffe987c88bf8c499d95df657fb219b7669c26fbcaf93af51aedcfd39d4ad44ef1eef1ef3a71d96799154dfb0e1245b76c3e852b6f867a841d00bc757f172241153b6a000fbaf9a7ef94471f777124f279ff160a3a3a30eb3ebe2982243ad5057aa0c4c3c6ec512e6c318513b9381f6a9e405b3897119e954c5860e99e998f27a7f0c8682f29c3539fd79c7e4fc85d6b1fb8eba3e5541a2851b44b66ebae6bf6d17bd8e66d086f80b8640016ce5d16bafd9321861b442a3177ea96a5a7b8725a32f2a4e7b5331d3a6fd2358b294da3496b81d79b5a6c9178226e03fcff83ea0feb0fab556e679fe99f58d67755b38897d865b7bc4e011d4e94da8a1a66d105dbf69559087d6816d3bd1efaa8a3762a59d5abf12190f083a9cf0dbc38882e2f8eb0e53a996deff468cb5cd16f2e0f1ebdc152db32497badd8d33c9dfc0d183879b4e7f1959955150ed9325d8ef0a98ef365b5b023ad3240009fba47e909fd98bde3bba4df96d0bec1e5f21e2693e609b1e6cdf26ec8e918aa57dca610d99b5d32dda104959cb51eee45707f2fd34007efa218ec72bc3aa0cd456f7036eb9e661004c6ce5de1848db3062003ddf01004870948c0552451fbf8eb969374567d740b5799192cc0b5a777d7da0dfe80ba7d4100597c133ce9788371cd44fef537ea3b078924fc5d069d238eea02601c4587e35ee95e7cb445ceed92370f21898d6b47844fec8cd509fbf7b78132454854d82c822ec5876d2927bf6769fa1b0493a8fcb947841c544ab2a47cace1214175b4bf1de2ad3bd6fdc3f8264244e1694a436a73ba57715824c3ef469144b35f5ee318468209daabdad93dc92241bbb89924b1e9639d9f75936ec55306772d68737247fdae1b52b5e094cde0f8a4f4e907210ef39747e153f97df78c96a06a31f36fd97f0e5800d63b541304df29434a524b96a76ba421183561b32a293a5ffc28a2d106c8e35272d70d78a6860905d68133afeaa5e129081404c5d10e483b2b0a92f19dbd9a35e4a8b3bb9c1a180148d8679c61a6e0301a0086d362cdb3b6429da787bdcea3f922e3d88ea80072ae8d6eef1086f3f51768c3d4d609dca232eb5a02234d3b608ff9c1ab0520dd3dbfb84ce596be2cbada227ddd03ed37e8adf8cfcaba5d23c24c295103a18a1bf3bcc4db70a8decb3895c83447054fe951c11febf0c8376aab2745974a06abc1c0d0fd53c17f85f4a5523ada7cddc22b094c2362f8d81ec5cb205b62327c188c1df4a30110ac03077e9df0f7bb0567ace8b2d45d902365c3519939f21f4aac544b3bed6c8037bf3188f36e7a02433a0a9d52bed2310b9be198296f7e8fc1f46751a3f3f0f8ae0cea38d21e5ad81c00b6edf38dbfcac2511bbaac94cfb371f7e0f70afcfb8d7e09bbfecde9409b14b73669da368c593f1166a824ebe693c0a171cc93d0e6ce1a022464fa4714f73f7526a8c1949af2fc7f9b665a4ebdc255f39dd741344e4b182ce5b265a5b36da1bc9cda44a6857ef7b69deaded43e036626fd31a0604be5e9c64bef406e8c3a6bf0bf88f94afccf703aa214e7024b078b335388a86ec508e626e319ce257286d3508971df3e39a970ce77e936f77f6ebfc9dc689f695674bd095d0b2b58aa602fdba8b53a3d9b447fa8a798c1add503eb26bdbb29b660cb6605995d063f19d3803ccb92932587093eed9408a347af1934f83499bbe718083f53494035b00db12ec5b370c3819bdf2a0fff87d6118aff9f4866ad0484a5cac1262552e95d5aa7add3f64039eb227d01924b99c8d4d7b748c0a2ad29d8f71a288594ac34f85d806a391fcdf65c812821275aa65ecc1f6208796adf5b65e7657d79bd9508f6c7e22e0bea8c52794e0376cefec954024ccab1894168a3fa04ac7eb124c79468f8335f9b68b8256eec76fe6739dc9086812bb6b5537378d46c868f44091b667005360c403d3942287d914848c7eee7eeb4f8ce70903386f5e1178e16e6f77f474217bc3ecea57682fb2fec185c5b3a6252feb006b4e5012a895909b845898f1bf11d0851dc711d92bbe027608eaeebcc6c0a1422aacdf34c03f7370b649612a84286e4e1ad443191813a1ba7cd85a5a3de17f669da2c10c9e1cc194f6e09fa74882d72185340d694d45b9f76331143bee9298b3865e56804046d1b0b03ff36ceb28fe99faffcf3e5a26311d3d3540f499c33cef8b3b5bf317a522289b97a98e7b8babdedb7d2d8d5cad1c0b752de4eccad717b97e376c7d4276aee18288d4c6c31bff4074558afcce47ecb48fd99f309a47b1eef1d71fd0dd2c83b330e60b73ecfc10758c90a0f7036fae2608453de0571021e0b61be8b0f8a5189c74948451be3eee84ebdd6a799fd04b3f8f980f2dfe3253e390002bbd60c2e0ae7885000b5d879bc2f717043a01c88b25a62f1ba5cc3c2eea6dc8154b19f9e179ecad1697517d2f69cac2f67251b7816ff4f8c3bbb07cb93b2803dc627b61a5f4af0196c66a15ddf4d63a5c8620a9976b8d7d2308f69556db27cea23eb7c494236f2d2c07e8c95db129ad318575dedf4821d4e0534ccc9a86087ca092c720abbc8d19899051422ab862d07b076758bfa0f293b437496528586b964861fccdcfd0ba98b0ad4080390792ec48ee02abc529ca9c35508e40705aa6232a15d026f6e0bb1eb688ebee70bcbbd70bcd09f81e62d6972268f7e16dbb5e824cea825ad3954fac5c06d2995445bf03237ffff8c775a5874d6c5427577e42dc7a20a11ca7eb151f0583600d1858f9e0594064f84ddae519deb8ac081efd12e2f341dc0a27cbcdac3f7523c6cf92df69c61dc238ca8ee3233952133098f08236412c5b3a14bcb9990710b5c213d9052fa62f220819673c85604c3532d42a76901247dd91747b8f5a6d55931172de44eecc9a958d52f3bdd278080e6297cd3eed5688b5626dad47dcedbde3a027e6a2505d065a32e89fc09b58494f1968795c7ad2fbca1174c49727084e677aa1cb9c33025af9c95f4f14dc4549e3f36fbe70c1c93fb0e44945ccc13a852b0b717a1349ccab093df5d826d96ffc4b19282c893d885630a97be5836182ae9dc6d588e65a5b59889cf2bcde39647d1ec2dd526df95688a32e164a98a9d0e29e2bb0abb969687132013a03c07f65b9115e1f497607cb75a158ff453aafb6f68ad32f6fe0bc91665d74cc730b145033b1e84ed7e2df33510481101c7a9dcdf8a5d87edfa41d81e9d345cb86c7650e47e50ac8e1561406559994a25963b1990a7ce3e0663c9b814cc53d4b63fa196782c16faf21fe7766ca209811020d20314e72a998","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"3b65e88fb4aad2a4dfb95b4861d2091a"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
