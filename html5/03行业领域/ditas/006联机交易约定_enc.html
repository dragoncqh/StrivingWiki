<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"7315d1c83ed0435e1b0ffba0ca7cdf60fb1169fd4ee2b8a94ef720995c782efe96c481cb16fa3eefa5bec93570fbe3d0b04b0254a06f5e6f2202b96670f10981960978ffbdd3538d25fe6ea2f3febbea3ff2cfe962f9da0c8683aa229c9edd19e429f6be13666895e6df5700dcfc8f229405ffe4b9a04ca84bc342d5107a7277dee10e49c82ff16e6f613e84ea8b2e405759150da2c1510a2a456cd802be1ccceebef6ebe6c2a469ab0d0d0372faf97d72602d0ac7def1e222c752227fbe68b511fd36d867b3ea50e725befe29b4903993327716f0976c2f044c342a3fcc16c590ed656980a1880f17447d26ff4d35a65dd9e598f0a7991f7818d9ce7d6a575b347e18973ba2b4de357527c0155e03e533d78ecfc9aa2e9683d1d469dca3d66a1f26d215f6e8493745d37a7f841491b74ec51fd742ac752bafaf116d001f26d2e0d2f5956a9256f6c9810e6c45133a39f8b68c98b40a5cc90a26387f2221e9e4e9bfaa38ac4d89d85bf291e660b2f141a2a3314a4b705f953c0577cf898a69bc442ce72dbb1e32cd1651cd69141b613e67ee4e60ee03c7ba20fefeadbc07de81202834fa52d43a2c06f049ade88a36d3f131b4a697f63f36c8df8c5ea5a9dfbb60743034112e07b7b6f37333cf9aedfda2721782360edf502960d0cacae92f97e9e0808d13e7c22f654ac19413a5d92b8a1e1a70f6b10687d7d151da615050281c3f1c93c22a397a844cb99b538f227a376ff998c81c369a2ab2f54050da4ba3850dc4ac99e61abb898f6bedb7d6cda2f72322763daf09bc0657188099be597b92cd200ecc75f76e37bbd90e0b977030373a9a4da6dd0d9316cfc43b0997623f9cb864160d0e2ce7693ff9fa3d6857e1407084c2e810ecb0280216990925d882b30447380f363c1228780273349bcb1827da62f36b98338bfbb7c199836241354c0db6d307ba5eec53f311a27bf97c3f3ea699f6e4faf51c6d2e780cad256de5eeff43dac1880538111e789f65f9f79b4388cb41ba5d6ab9bf152e6aa45e1a84a62c4c7ac6ad35725044628624caaa169d594c8e92891be0cced2266f9dc5c2faf0c2b174170d6941213285c4fedc1c89656ba38c221c8fc527579eb75fcb94fc83cbd1c69bb2870f83f501b7235825a42a7546ec348a4acd496e02714f9ea5898bdc037f26c2ad1105686fec8d77eaf840f00267e9db2a497906f0e92a6daf48e0529ebfafb076ced612838a76d462f6bee18893f7c217a5a27e938f98f2f31f943c17110dc4a24feee335226492c374c32b7515a9a890d351653def0749aba4ae0c5477ffb202f2b344d1216074d9dc81faf4b14c4ada65ae2dc2d519d3fefc103457892785dc8babcfa6df388a27e97de7dc900dcdb8b835f96fa6ed51e6226a0ebe4c68ffb2b74b74a3ed2e98a627ddf039c6997c65b4fe1ee4215202fa5bb6f737a91232be97079c196b6164409c3d03fa6d4015407a58e36ac0760ea2290ede0b0d60775d1fea0bd8fa12bf719ff07d9ca0a09300376634e9488106d78804808efe7699619ad0d53382d190fa7adf2c310dfff7e00cbfdb7ce7fde1535ca588304d3ef6e25168d4acd29122d4a9d7f54fbaf1965e031bbade66162d65c0b3493189312246dea945d7d32063742f99d26abbc25d7360c0652a517b0b57938514bca7722bf34439a494a2c1b4b3c5721cfb2f853c7b2f07b5ef4ade67ebde0b0f9b0a1a72ea2d30d3e2276a077dad4a96d4bb05aa158c30cf606f3b526760f54a46cd713a96df903ade1a874ff25248f8bd5c6a5a5267bb8e957913aa8427b1fe14fc115d05476c3e9bda16ee7beb61c46dea105af455c73e100bfa33a46d656a2209d28a5d560bb8c1b4f94c9d9b32bb1d92177d49c1e02d530474ffed88067dd0a80824c9a3fe2e761ad22d1ac06a1102f52aa189b3c47c379eea146a4fdbc638f8c52de54ddc02c7f33e40fc7f604197cd575c115d0680deebcc5b42593677dd6a2b91113c41d364d7dd43a3f9ccd02f95746254e29ae2806ed7d6f7154ecffeb292f76eec5e65199bad3d431b034117b2eb5121dd9df56b4488edad65825ffd3ab537f724193c5d21d150c5d9044d7cc9d147fe5bef18e12ee0fa89c4f5ab2b2863947fd5a18ea3af39b3d0d8229282b2e8547e220ef17e307951677e1a6a939d37b9e561ab1cf455b9ec77f13253619585931f849f1025f4ecc34ac896f721566108030a5c28fc9b365fc0567f2a1f8ac1f2d80447b88727ac80e40ffd9f050f0aed1c6561ba505d3cf20dceb2b92638a19bae54e81009bdbe1502e2e40ecd900fdc350c6ebede3233e6b0e127312b775243b1a6453600f81d232fd395243fa22896ffc4833103b6e8896c6f4b55895f96887698966aac442f039b2778e9c88b0cc9d3f1d4e0f5d27fef613b8ddfeb6dfae48f59d7030bb8020717662f0d1ffb596e8f40148ad11eaca991d60da97c675a299325a1f9974d6dfef0530adaf083c0e7c2a39018704c5e91184ab5ac0cfa63b5c013ae16977185fe94c42a4eafa6a540d2038f60682ff373229a9b20f71d5d1b18434eadf44b8c4ef34c5957f6b6ab8b0538785f4ae1af1373ce3e377b66f2d8383754b865c625a2669f5f52cda1d57a8375bf829ff06a3d7c8e14898ec5d0ccd12acba96737fd166887a55c15078efe784d45fd9cb0319d0347e08100aea84dfd093627be34a7f0434d5840ceebed975e3cae97653006589a4ad3055bd63007302639c25f0b7168f8ce97ab463cc68b509e4672bf3f4698e59884341a8f45eb8cae9b3f7c18dc4d2d88fcbf2b1562f8efda73a9b3d2c8c094ef678e98f653467018bd46996de5b46ac4de5c26e5cd15f0d1446eb0e6b0cb706a51b4981259f8a82d4e8fb180c641ba8196edf0798fbed591348b156dceff1874743923d600ea3647f116af031701241c7b3b4455e5c2561c299f10702ffbe2bbfd8bce7f35b7095a1187a72ff2d1be7e15c1e69224f9505b0281408f309b0ccb12f611960ab0c88f7c54b4e680a8d9f53b1ae238d07a11def1a39f2328cf542d3091f535146f1460f71b68bedf103e7aafc2efff5a2421e27135b3b078a4697a750bf773666acf68e4b439ee8f925732baed1339889fa06a311e1371cd510be6cb28df46ca8f5a9b0281448e3c21a3ddde39ed547e9ba232a7aa787cee49f535aa3e980a4a93c038ba71251bfdc5ac116cdebd9c630be3305bada716e8d7ce367d0b95580a54e41e232e4daaa5ad47aec2b0933aa60f282cd34a6fca5d813e4caeddbd5d8d249b0bbea206777d26ff35b82c1cf02d465d75e1a0ddb230c1f4c78c51eaa3a41b263a707dcda3dd0a97d187957d601e14ff37eebc06e9fe53cd010ac88472860295051cd53c17672167b9466d053e85ac96c97c7de24a7ae7b4587ee78f382fa0ba4a1aa96dc9a1b4ed76cd02a3e54ce720fa95afd502c6b89b227914c6d9b2cece72f1366c9fd869bce9d0bffbcf67093c1f3276ccc5b4713e2cc5316254157fba8264cbe0a63e238c40418046cb8135f655f411c615f18acf6088e7832fafa1d632709fb6b76fabfb7342495fa631e9f06cbf22fd5d33cff9e360a4cc3cf03b8b68988b4ba8181a3332ce7d9eee6697766667a0a019b7143258b650dea520795181a6f4c3a2f8720dd2baae9a505c297c176750530dac4d6029cb377110c984b6ef37342b38c4dadae45ab1987621eb95d0b56dd5a41fb2814c31494aba25121c84b0788621023fbd5a76971b0840690d3dfe340bd05a715ba63d1c63a273a25eb26ff48eb134746f2e7d812e992aa7514e51fba2f8fa6d1b2e6437302fde1e289e0e8f3af801d2a968044dd1d89a987f3d0c5e67ad4e81dc9e343e3ccb07f9c297cdfdea3e9c527a361533e0d40bbdd98b575c680dea4e26433ebe855998855420ab68c419c4a305972dec6df961d9d4fb3f5d90f726b38e0651bdfd7c8791945ec018255fc8bbcf1fa2b0711b6abb39eae9b3226089ddffb21cc8102fa17b99561c585ea09ac1a6a56b3e7f98c877b2ba27c37991aedf55a7c179692a2c898c966cf18e6779560b04b7742d465171b37bf1306f69de9dfdea234a337df776a43b9746644d863fd3831b9a7d4b9dd0ebba2878c64e019cf5804dd70d261b90ca6211d8baf4639529f5b47f9fa844ea8afec4b243bae60e6a630cbd2b534691a557ea62c50f31a2d1bbe1008d7c88ce87498d119c592f1ee3ddb9fd5d49f4d5929d3743082d753a4389354927062dd2131eb1ce18b1b6bdce724b4704c702572c15ba1cd60c6cca32d4b58f6321f10aca595b04c6a812fa7968833c950b08cec65c3068b6690a6b04153e3f0731dc45538a152f8bb1fade4c44600ea93a6c86e7c41895d45ab210dd789127048758dea2e0ed1a999467341d66a269add5cbfbff0d5723d2c11dd09c8f5b5774c841cf3632e7193c9801eaf3d9fdfe2eb14fda14b16ea0e8f04100ef5e755c9c4e0689581c4145d45ca4baea3643f3da7b5ccf2c4b282805ae16484566116750e8c28d3c14d1d87e7e50c7e51283d8f8c473617384cfe23e29cb2fa9e7e2cf35d55f21fec8d690d31e7b8cbc1df90d8abf6c595bdd927b4e61bc08a0562f4bafc64c5ff71001c8e85ef42a7559b59bee752304094957848358a0ec2f4042bb2a05da99a53c8b93c0a4d75b39482f39f72062c38325eedb3073aa1e9b0d72fd464b4ee4bebfbc031e99af61f8dd9542918e39bf109260ea926a125a8d472642d95b46ee2a942a8c8767c01b82a2400a27514fac31fd8513ce197f494c52e9a4470fbe50a149a22a5103a7081a676bcf288abc116da070356c74a51f2981ffed49a058f5d0fa13dfdc790b246f8bc3891b1b00936ea1950f3617d465d7db7f66bdaf9484ed72271b45575bcff6e4a08e402d5ac61f18ca892074a27ab24b5356b79bd226d63076a1cc074e33702114b2a8ac6e3e0ea72c9dc9c4b77bd785ec5f4032b3445d0d350e13ec39d2cfac32c10ab22e89f038de68cad6ffae057e31949dfb3c38778b03509f7a9105566f7180a5e8b8c6bd5a4ec063ec0481abeb90044e26d013fdb209747591e0a163fe10d38dfb574f6aa17f094b5cb61438569e5b521d9f4e215143c0c7348d568b91966c81d0d0bbee76cdf5acf513b0818fc9e3b833d9b506baaaf742519b1640165bab22e1dd5e42783b4bdc6b2963da3bd9dc00e53339be50e341d709950834b2e885666214f237d88bd9f8e46c8a0e9fe3ad6c2e7cdc870c50197c90a564e238d28a5568b0a8cd7ede5d4ed82357c45b355cc097ee255914042214703b999e883d0b9217e37f7f53e84f4f6519dacf203e96f8718f17d8396d3e5924fa49ce97e53241294e8916b8b4e6eb529523201798742e47dcb4929968ecd8a189ea832b26f69831177f947892aa04dded2d09a15686e774dc321d84a6a4157ccff07c5166bf7b975eb9c86e76ea01fbb35716a78ad521f963c2d1a5f29d4b854b06b6905640d65cb616cedaa8cd928c46036b113ee36a9c4617d27576da5c44eecb7ce73809a693c048d31318a2f39bccdf677bc2638fc4290a2e38e8b1329f32990d9298ee41d2522992efd090bc01bee6cee92a5699c5478c4a4f32d9171187eb9ac3f26bb8c58b205791b61bd66883b6f0d2fd4f5b3eee8b8ed5f7579786a390971d7da183630392eb907411f742444ff13cd7c42b3640ab3bf33fc2c43dfc5a5380dacaf2a2975b4fc72689ae34dd85bef173990ffc61c483de79b45eac572c426af5218be31102cdf3a23545a150b38378e97dc9b57f3e9b8f719ec4284d6590e4f72fde7abc9d5d45a5fff61d09d28cea05c0136361b7c6f3bda2d1a9f94c1797411b786a0b9203b91b36fc92c6ca9763f4fdb026a8ee57b67e502effe3b162ecec4d44dedf3cb2ed7d0802bdd825b059b78d3c829240f983a3cd679722174d85edda84efa216fabac3f2c7e42817e3d912777d768bb9f365eefd670d817bc344f499f3a7335ae292f3288cdf6522839174ccf6f6ce74c614f27894411fe9a08243c3acc21e198b8aaa156d3837e7ced53ca9ed530aebf535316599c2b6ae27e346204fb2139a70feb5a838555d321d439ee2b8c189cd5b20200aa5aacda80803099a30d1ae1491deed6116aef3a439f11c21aeae04efebbe9fa841bd51d4647f5a9ab836bce02f543a5bd5745b67a89a475f9503738cc1670c15b948aec315ab13af73ba57e768847c7e48c1d3cf41aceaa9708c5bdd48cac44c3d1a4645f327e03f08491ff833b35ef785b7de0fd142797dd66d2f8b6a4582c7a4bcf94ba951cdf64b154d78e432299200846d58ffd0968b29a81303cdf6e03d5f89288f4ea0e9ff7cdf76af8d55181e8e413d81b5fc65aebc87493053d1ea175d0bd4814ec0d7b910001488902c18c1ed6e1991fb46ba00209ece7951911dcff9d5247aa84fcb315f5426a8c46646415253ce076efe5f30c747c969e24552721bc8afa88a32040da1584e581a94f5345bb953533f45985680b8293f8245db4300968ac96722e22cec8ef077b542cb44cf815cc4ae3e924de759083c1b65b655a3858ca79593a573f00faf8f66ec311555df779aae85e364b00a4fa55f0b9f0e90f3647e18367761923583d831f2155538114df20bf3286856e58b6a83c2d802811d85d35fef1904ab787accffd4859f65fdea265f97c2ef91d0c38b39d99a541cc0240ef27c5cfd7c2f59bc1f4a0c6fc0acb29c30b54a2d5e50eaaddc43270f66e6e9f115e0da1f10ccba115cee33d5af4e0142c8b60e7ab6fd18d3ba4d2d7c4e1b70788c4bcc8c05a35da105a9484258c92d3a41ecbb06b3039fac50f0883a70408779877057bdeeda63c26240dff4b80800da68f445cabba608424b5e0a7f73d2c5ca4bd4c1adee08496c5581dd0e28a5430b0dd1d1e5864f8e237047596bb94d64b587bfe6af7729944726a02f752bfeac0a98b18c5b8d95b919a9a687a823f1cd685ee40eeec57f64b53a142a2403b4a25b04e3cf3b95aabad094e06d7945b313d1e9aa238a138356819b34ecb757479cb20d0d9bc7b91cce51ade90d841944b772589c03665caa66bccef6439ced5e79648aa0ecee3c20141470a80febfa0f1ebfdb844cb94627fceb9ddaec58b835981e9cdfad763805d7013e20c5f95f55748223d893f45ace242d055d46b8e0b701d47f53525953a85c44b3527e7d89b3e2fa77191001445bba0110ff5e9f119d187db034d0cb438d515f4356667e31ef50fa6ed1020103bdb9c8312941f21aeaa5a1185318a95cf2e42f813adb891569daa4264dc89f1c594b1bfd7e755a00e8619280973787eb1738b0f289d2c21d0ef1a5ae0fc9aedcc0b601028b355c93e0a4ac61e0791130279bbad533badafdf225b934d0becf475e6c76f078d4e53a06ef2a7689889fe6c4dca3eccdb2a53958df1cc65383e617f7e81606109dacad23b533dc145a4fadb27fb575cc9d6904792e2e33713734279c226307179804bb853850a4e0fc644c20c8f606f77a31faf4a4c5757c2cb6c7c7a1a27164eaefb940df7186a1c4d10f6700bd6ab1cd50cba4470d6b334f11727bf3e3e6eb6d72a7eff22cde7f3f5f209a05c7af4840fff4579f81f14a3cc42d2b5499219ff0402d7d4b6d45e8689074791103f6bbfceec1ad7c530f4374cfe1c8325662be018889e5f4a87d8180d300e2f42e64d5cfef65afd81288e680023ec94d3cb80b7413be53c1cce1fac25423568f6bc89a810436c4132aac4b4da45cab620eaabb09543231f4b2b65602db56553dde89878c13618274ae3b54a0b2559e1ea0b9243bad19c9b83948d1bd3fda90fb3a729590cb45d7948ba4aa8345905f7557291e814e5126c1cd6e406482091bfe20acb6257c5b2a23c8afb7f9d6314863d3a29151a23c1b4b290b712b8cf4b851ba31e84453e89369cbf24a3053bd48017e229c7a6ec8d1aa78b30553979df25920a0fecdec50fdb7d19e6e9deb0529622a177e6add33206cf38522f3c10ad24a1cd7ffe548bebef6d587f9ca1e4302d77b93ce392b9a769d68e516cddad06b2e16e825ef183263a9b3b7b121fa7181fe4ddc8fc9279dd4aca2bf1316f4aa05c3233c0326eebc17066b8bffc6f6442fe2da343a9176bc3886f0160c28f60f94055dbb7c908c883aaa78070b85f2ea92690578817a5a7eecef2b6d98b66478a9a2d7dd099a5ed9c5822f7452bd5ca0b021e9e8dbafa57be451d42f8ba8b1e596a9f8524329f55b71c4faccc9b36eb833d04db272c800a1fdfbaa27655003f973b0489222aa45ec62d4719baa76ef4a13237fbb41a20182fa5ef0d5d72ad3c7025c4a844ce085cb99991622bcb3ad7ccba169d4b2240f7e42ad97e53f8ef547799169421ef3f69c53a8c37209eae8266ad9f05298f020f30138adec83fb9b7a7d45b02573eeaa2a1411437f9832d506a28be950b402961777839249d5a463950aef52c09303ccf9eb67fa859886492f21022e6978dda09abf1b3926fe9183a2f0c4a63af4c6cc5888d85055a249db208c5e9077c94c16c4cff008124dafcba2e618f04af3683b23deea78c1b7183bb78ac0b7af40e80cc3500ead6ae63911cf60e6ff8d5504ceadaeb81d74f5043b2b9d1e921d247f84371ba36f8e4b3c64bb95d2e2ccf4c89aafe12a9c0e1b3d365bd89f3b196af6a6d2a177da33ca86c6a1fb423944afcc74dfb79a704f6ab9f9c162aae8c85ca0e0d9eb677f2b5cc98bc29c366675c3c2f7cb9ba5f2fef0ca1f4087d1e9b8b49b5f4b3552da81d5393507ce862385d091dfe3fe8f777b7c9eb33b3bdd925c65c03c7f10bbec98e4fecb46aa61e9289a36c2c9d5328169c053a62e97b6a70eb3f8afb1320cb30b6edf78c4fe5cfcb13172dc9bf9a9962faf5fc89490956dc359102a02044f30afdd9e1f9fbaf96c57e35e5115c5c82546029f0e1ec32d0a051b46c980a81da911b99a9aff53e51a441668bcebf19f00ae86322ee93c456a5ebf2ae7d695f0f955bca00fae6ddd25b56663488841d063339db070941b5078e9ca03a9a792c2f769fea80faf4a4d30602a1f76774d4713336815b90c9e545943acab852c6d25431a71d025b546b6f08471b2ef276657224401799ab2f6c16ec08a9d89a521468ec7bd98a7516d1f420e5b9c4656ec505a58c9ade074ff7e302cd4e2f7506b7fc54e165e76b3ffa9f4bc6dd6fa4dd8e2afde18df2bcbb9267ccc260ad5500bad125ff0ed1b8b1ad9e9d6d1ca4ef34029578536815c8ef833752482b105768533899a0d0147e168ec12d254f22883eb23f06870403f30ff89dd3febe0b12565418314f735572b4149090ec288c803f11980336dbda81cc3cf181ac0df7dad504eec6d314577ed4de0e1cd6ce5658bc25b8192384f478f1f8791a44f6b84ced6b15ce246253d7f211c2e94e2c66bcbd2271bb14aa90aa8ecb6b2e86ca79875461ca6ccd674f45f17deb4173e36b5724df5d5d2188fc286fcee7a6e6167125208fad54dad131d23362f4c5de57319675bed510ed067edeba091009446936d8ead003d7505d9961bff04e4623d46992551880b25ac4468c972fa2863b61fdda28dddf24690000694400c9be3afe89efce04fe7e6689960f10416833aaa2f9c6ca0ba59c4b80f488e337426c7cb2aff6e6da2aee22d223409ca9cb1061d9b2c0d59f32b1f11ec10968c6b043781092dd6b557f105cc8928be529cdd4a07713d73a2af04a52ad6ab3d8c71a4ab56abd7834cd58851031c493d8c9024dbb7a29f6cd5a83164f7217faa95733095fcdae436da7aef4ee5c5b1e12875b1e0ab10407dc39d0a397ac1a95da0d554b7d757a6ab8403fe994c42407d75c2bbc273dbc3a64e2dfaa34f48ff13028be5aff5f69306dac914404614739e1e9a28edc538582537b60a89612fbe4cacec96dc104a8ddfb3f564493c0215c2483ce4c5cc2eefe74f843de3ccb3c0815029b0b89173d838c430538bcb1161dbdbe0559863f47917e177396627bab52dd96f9c523f92e5087d5271a9e8cc930a2a50eda9e22612e07142729a87c3be3ea85650202fc26ce957953cdbcfd698c8e8e31e55f82b17c424757d615630630cb3f6d926b33f34d8eb11d5365583c672b6497e154bb6b67a6fa60f12765f6c66bbf625f28b19d2d1ac31d0ce6f32567ee80f8c474817be547f447bf35f8bd9dc50beca44d94e1712b32bb7c3c88493ae96d40c454a4cc52c132961109e90a0ce2ada9e9bb76d2a7fb0e9427f88294439cea4d7cba990b41d8b648fe48f121d37f8643e68ce3415b5551798c50a6b7cd7ed4ba03fdc5ca9e06fde7e0b51fac7f58d8dc8534051a55f6291d0ac5aece955927735813635528ea3d1ae5c10e2b10b13d41ec7e0406986ad24bddaeb1edd93afd20b2b53e4f2205a606fa61e2df617100cfff36ccd32930d0c0b9fb0602e13286a8b8bff720ae1dbf70a8ae0b83725a0c5a8ed8b2f5a3a814bfe6d1e012deac5ddb24f3ad92c4a57ae5a7e6bc2d4fbbafb0fb578d2b7a7e70e24cd3c8686e8c5ffb353eb90853f7a6890567c44716d351d299f64b2059f3e92a64f2433cbc79c58281170a59ce35503f6f386d7524dfab95c5b02d46d9c5c6da5fb8a30bee6734d844d6fe6f865122a6def589f0acfae8fa88a2d6177ee86c58fe07337cac1d7becedf667fc484015eaa57d9c7803c6799a67019eebd519a4e510951b6d1463b11505ad28118288e7a071d52538dd53ed80d448bdb7c89584bf0c054254e5f71e5445530b6703c63dd6c4734568f99e4c2fd94ca052956f55ae84a3b7ef98c79740883f700b53bd7be58c2922838372ca3ecedd5afaffd956fb7599e89cced1119e06d398f904834c0e045660c7159a0aaa68ce3640663aff537043b3f343bc84304f32562870531670408665b1b9cbbe6fa4ea91af90288f06d1bcebfab377b8e007d03f8ee6c0c14fab219ffc84d98652b173965e76ebf308f6367ea6067f509f489dd15c265fe750967e8d65ac690e83e382c31d3c7e23e6e3c88032f56c00a6280c51c787d2fb8a39787c66a5f338750c4afaa1da65a78b01e0196c7ba52f52756736bfd06f01a98deb13cb76868949fa29b743a35f4d84234bf3cfd4976c2a44c60209d1d160509f5769366efb7d4ef5f961ee2498e0e45be2e53f85bf36cf72038755fe9e541b0ad93305059440f76150f207841ea0bfc1845c6a3cae60db86549831fb667a2d77d4b579dfaa359ff563af3006716833d99783d25ab0b9c574580bea85deb55cab22da873cc940f7be195a12d74a90fbd60cf5d9bdda9fefed41a5f65fa31a0ea37143ba95a25757a4cf609d5d5e1c4e4735dcecc33593341f478f6ddcf778897be0849c30f3d5660a1d0a0f40ea5c4df059d3167b152b21477806835fb01b1883ff6e20bebc253f7c21714075c36c3e1a8aa895796e7374c633def3a4a81b6806cb8004e714893d02abf046b57c51cd11182a2735a311bfad2274c79257bc7944d62aded8c7f9e76fb99920786188db4e6841b46b650e8c9595d55c4f6a8635b2f8974793a41b9608e76138bbbf7444729604f7089369ef28c8cf77d0fb1e7bcf6432f6b847e7f84ce6f020a9cd16264925da3884a826251c0add81f7f88a8b1ea9d21bdbc0282a140d16a59db759282069b1ad1e625259412682fda850cfb5f6439e29615ab1b1e5ad8b78b5943b577a13d1e1fea85882956751ee7c5e052f0ebc1059338cb14b9904e00b543c3f9147cdee8602b0b2b4b36ed9d19897fd5ef3f0e7daae0862b2eb6c6d516bc26f4060bbce03f680dc67031afb674f610b0f752e8534480adb6ccf917cf3643ad7e1f4c58af71c0b9e2471c0b108da3c26bcfd30a42e08a820d9cc376cbda70c456f50a5633757c2a55141eb48657437da20e02fb3291c5b863ce391a5683faff59196d3422e9811bc6679c9d128011dc5e86acb91b15700d4ceff6d58f0ecf213e1d70e5e7f6935ae18d7d3bfc0d3e6b27135dde442bc7e9cc86dc9840e9b984cac1e9f03c9d03bee65633e04b28325db20f78ffafdc555c2201a4c8d5571539feae3a0f55d939efecfecedee36672c5e85db30dd434210d44da404fd983a7cd71ccb5c74005d76bd53a3d723ef245148ba95d1065bea81ef85e432ed18f3c8c22ff01af88afd4f7be443858f09ac4a90e3e7eec6a2e60df733cf66bfbebcd45189242bb9fff9cada3dd8f58ee366d6dddd0820f06a1279e3f0466c9bbbd580e0c24da3ba841a5525395f8cfc0f7acca1e103f2ffae3db210619923204b9342beec2696d71809a01e59bb74fc88a7997085e1525b6fd37fa575600349aa243b0530a0003a796cb8b5a4aa9e764f80b0d3907314d5a74dc2bc497ba9bcea8dd1b7bd763e7fd999807351e074db6f7c79fb7499597eaaf73f31cb322a41a311b92976f3d4e962578f0b457b475063b011a3eb73b2692bc133b1a14537c86fc16601c83f5193439f9ad0b41624261c0d27e907b8f44cbc0d5812c31a7288995cb616cbdff2b569abf1e6f46facac8b2f0a1fe59250b79125759d9e5af04b112ad00eba70b5037e4174d11ae1971cda6853af8b2756b4ad3f9052f64f827abdc825bc8dc87d4bc6bf76de8d9ac776c51f099c1cc7f3b4542349491d182450653198862d3499d5a5d82198f8fbe5b17cdb419ede66b6ddf8dec1022ff6ee8f6c9bdecb6ce1dab852af40fcfa5eb5f30104e678f8f1fb1c2a0277be669827b24299c3dce16202c8faf0d50d3c14de0b73f79abc00311259ffa04cebcabfbc0dab0bce5adbff261cf1f357e686e637a3c6bf0ccb80964b8769190f305aa7e29d01b78d28b5bae2f72b32bbd5c28428c7dad4161273425aa9b6faa229cdd86e4820fe1b640699502998c9aaf9cfb0699fbfbac7399e94e84e7f940b46255809ec8e5bf9b88f8e6b56860d03a05c151024edfafe0355166725a31b294583c58445844f10e2c3395c2f64de2d00bebbf3349ac81098cafd2d2adecadd87cd21dbd0a3c17a04d7fcf08bba0ea34945bfca709ad2836c91c0c9d4284ccb8c0f67b26c2168c540c097e025cbac9460967ed300c650cde41b0c7949c4a5bdacbac4f808250004cee47110d4fae9b60f703fcab9f0037c31046fe5996c8a70baecad98ff840fd4b7f2a2e749ac6119cba43a47e8ead3263d014353d2efc003f4eb7450eb461ae2fff13265cb0b54312a26b0605112716cc0d46c609cb5697d1dec754c8279e1049103f77d940bcdcc4e1d9c25cbd10cebd816cb045ea1b744e144900a29e346118a86da804a090bb1da13f6ed261b0b556006e88b012ffb41bd57789d7d68f29cdfc26cb80e4f585a4c6fa46fe80acad43647f828f7396e406479f9e3c9f7a9b92126d73320f06c90d251f064699672e806ab99693d1ebdd258b85449193b9d510596b02b40645e875fe0370607a1054c1858be273655698d8a72f8b6287f46700b69da5770fc73a02eaf1f1e47451b042ba108c39ac05925ac86f6df4aed4f24a2a525950ed85047b680a6b5181efc9c63c53525f87be5ea69b41ea85933f92263b6d4b3092d69befc8cab2c23141e2d4125054423836d8bbfaf47953db76bcc62a9d656febeb39384fd42522ea3e4eb75c6833c6d8ccf77e0c00bb4ae498483afaca92f559111135a4b9d289e0acc55266ee4a74976d2070f7ed68dc87c15b7171281c1a991454833016fbf8b93392d62a5ce35bf0c3adafa4b7e8d93c72f7959352d72ed993db9c7da9234085bf19b08e238f45d1dfe36709418f0ecd18a5b34aff5eac8b050d801b83256034c024b3de10acbf29e2ee78c905b15421b4be6ac0fe220519c6816d75f6a704a32453b62fddfd94378833c5b8915a626cf5a2d3389072260f89241acbb8acfb39d1b87ee72b508301d8b98966b04677496ed77a6d165849dfab261fd380e321680c189e467fae55cfd460192d5fc9b7fd5d3624529e39c032823e0f80e2db1f65971a7d33a2139ed90b95c35b6f9aa367d4f5779aa34d70c577e77f54352bc9d5e416357be41419f5451264b7bb1ebf327c7e10a584fd48b13e9432ca9ab8a408634e5940ec6b36a38b722b5f2b0a90302be1e1bf734f008a63b6b7fa2d43641463b1b727eec406e5e5afa4b7c02f99b1b60a0cdcf962397fcc80498fde8ae6a8e5498f4f86a9c47aa376d70b71dd8073cd3c748ece7ec0cb2964a1ad9e6de6c083c4f5f0f5b362d218bd72eb148a637fe0de69696e34c17b6ed70f13ea7b6ccf3be808e016766bbb089189adc0c82ea7ee56fd93fca88036ad4a878693cdd9c1b783275caf7f3b2f892b882b4f1aa2edea41c4768306595a1fb2eb2e7b17bd62f4b6458201a0c48b9aa26daeee869dccf213ce711573df0c05e76c0eeb3a8987cf0ae8ea5ffde3d1b8ba50347d11d1720f6c4ec66b11d11bc45ab6bec7a4d5f578f72cbc212922becedfe0593c1cc096fff83369c77f90714fc1dcc90af3b51dd1159ef6fa10a5d5cd82103c9549cf9a06633616beca3f640d74509b93fedcd612ac09f1885c2447daac28e047c1e623560a4b7086e7dea1706855372ac46d0534a2f3232488e70b45290bbfe1a0521cc97aa62d383eaa60c8d025c317d40c0c21b2a4c43e85c9adc469a561dd0fecc291ad9f9d557c4ff795ca9d6e054342d4324f1b6a22d090660cfeb1d2a2a9ca0b9b8b685d025f1dcd9360f9bdc4ec4640e0a84b830926097891cfd17ec452abd76d27e24996e602c1e014a9f6ea29820fcb420e690066ffbb4967c037c5418616819f9ae36b38fa082e1d5e8ea9551d842140a7bef3e60738fe08fbb0fffb017e735c9b437a282577fa921e59aa08c61e709c72db437a80739878c843844efc9d20c890baf686c0748e51e21b6d8279e1a0ee573322c2c327b75dcd6f9b7ed81bec66cfb66ae45825978407e9a026d6e5986c51b69236cde22c8d4fa7a7926c65a400794f8e41a14b2e0e2d1939a67219da8baba247ca89ef35e08b4fc301a5fd663fa252244e72407673d1143bf2623722456e6e9bb75b33dc24df5fd193e2c8a6318330c787a5cfe4b6e612cacbaacb93641d54f3e284dd23346c1ce9b9b629e36f1563725e952a03cd20c7fc8c3c9fb48ea941c3d0dd7278fd8693d8f699977733df7006353a04596ea32b5be4874586fece82cdbab24a87c19e90110d1910aca4c9689aafaef6ecbd7d89c534ae923972912ebcf03704d3e7b9b30931c32f357f4dfa926614942a68c684b4472424d24d7c80e1d93f11c047062906706d9fefac652daebada26257560af5caae2c6dd5c5896dee0c970411f1ce59c604cf1d4f0eb3553d74fd2372d03e6222209b430afb27af6e56434190c8ab020ecf8fff04aa716b1b08fd1afe2e0b223abad960400ad79feab2dcdcc1b3c2ce818414bb1497c9d84d9eed41901c101ad31739c5c29dca5c24aa8fafd1b3e71b980746acd8cc4b1970cd75ad88c182f842b05050afb45c71d6cd6da58188fd55454892547313c285a534bcca1b50446d13c66157777860f817cab2c3d00d0865076c849ff9e5af6025e7af3eacc11d4d04a217de1c8c03d5a4ce26c0824a586fea6d5d4dfd129411eb44023a3d9f353009c0feaf5f72832d003fa6ab5093c02625aadd28e866f85776fdd06dbcfe7f080f9031f6ea324d8fcb7467315e9784b2ff1a1ad05b41464b13a9e567c5dc3704cd12366b6116d75f3cbaa9431de317968ee205bcee7d8a5c5cd77711845017ef1f4f14fe12044904bb421c819befa28fd6b7fe6fe0a4e1914df30a23646265659af24a24259d78c0818cfd205da46b6d3cc7f9bd4341b8bf0c1bc829cc4608ea894eb4f64356a76b968c82303ad318ee1851ed640605d23f02127380a963d5b5382dc8844fa3c39b434f3cf736e2e3f4108f0f3202a83f5786f15dbef37f6e5463c0386abd5430bb75f6c9bf1a92130eab9d7faf1e1837686798dfa636776aff494615d254a7965f03be9400e6e1abec7171e23b26b20fa37268e5db5dfdd26f4336819e7bddec5ac7dcd4d715dcb875902fc820c6055fba3270fd456c36871d580277518d0c0765d957f953e7a3988ac53fea393a9156dd722f995473fd2061c3918369d198b3a11c1e9543ef8b8fe6f1c33eb812d0aafdc6a422535b866e6a1a368ceda553bfb1d60ed5d88cdf836f7b6b36a8f1ddf3221f966f683268fd236eedbbc64655b054537c041d092f071eb30e5da89e2c6a4cee26978a9282f2c10ca411523b8976660713c383078054c74fcf391e8dee6d7eb5233fd3d11e5d1d3a85ce1aa8d631291638be2981add3bde9f0f9663acf33f9926c45686f0ef0dd885c036112dbe7bdc40b98d677bcc9cc726059b5be2d892c343c3f02a569db191fa00b477b7fa4fc0cce9ef3cf108105edcad74feda1993cfb3d2f726f5ff70f928f3132aa5075b7e65476367427009678e9176fd587ccb828d0b67086e4b6d52248636290cea9178ab158fe7c4fdde0390c7146d75275e7bcddb4f4ecee8f2d7be2290b5c3f2cbb9b65488bd4b38b3cd09a88bc80a7c20a7dc304c4d173ec2d6ff310deb22fe89146523c92b827d1e4e2ca40ee0714c544f6ad7115e498f62cf7f6061cd056eff4615885944b6b7dd97afe293ce0376b20ed07be166a78446bb2e9bcb7c78389a662af","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"3b65e88fb4aad2a4dfb95b4861d2091a"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
