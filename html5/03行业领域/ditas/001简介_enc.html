<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"d7f5615d3d6bb6acf28719df703c9983017d9c18630d73fdde189b75b0523ca3076461a35b209fdfcd6e9880fd2d576ceff41d53be30feade2639ade6cea7704e55243b8142cfbd0491564c8c4a255b3ab3fbef3259f76f1efeec4d9129b62a1f1a7f9a8d89c195758f86df538c8ad602691e9beb036610dfca35fb92e413aa97a0c9bca64f4fe8fd8b7463e7c9cfe75276cc8b1a0f6411e77d0c98b3667ad5051ab357236c131b691afb732a3d5208ca04e5297a04d0e770f8ff676a07815d9f165037d2f494b07ff614f01f6fe5fd9166be4a8a2ccf6feea93b935a8234d28ad6830777f8768c5eb46c8ed22e9355dccf96d74e617113bd39c978f81b3adedb3cb6a69ed2e1a30639df24727b8776b6a1c0c759e649b64530e277e9db50679241cc4fdc18defdad74449879cf5d01102d7a4af22ebab9186ffbae14bd05e1d4e6bee8763fda86f9ec2664cdffd32d0af845585d628274148660ee98458b212469306989a36369b83774a7c5991a0d7697495272194f08d761ec5b461c1cb071ce1bce03c504aee849e2a3b1335fea850c6d4c3b3c5f1edab4b2f99decee8c48abb8d0b069b2acb224cb20869362477272a409a8df3f87fd4d3e32c1ce22cb32cd96722a55ab88c1ba1fe2986e6a83efa57d75cee8b3895a3b422d3c24a32fa98f1930b2aae4bce033671c0962f34157d46d9b32220476f89595b3496d74e007bca2e15c5c58cb3b7223530f740685e7c6e51b0dd19c8726e759fdb1ec092d6f52bfe166f08c863331c0bb6e98e760a29ec25fc00a8f6e5c7353847f512f463802094422452cf2fe3e1fb6d190c88cc4e9fb5137af04dc2ae4461eaec3ec4ad915a01f7da96634c7919ed528cdc0d7d1850330b804c1f5ccc7c1f58eaf54b4f4cc2890b32da6d4cf9d1eeab3954dfd6493a024bde4d4721b3212376b70d80193fc3d9916a5281ebe4659f82980bc69321d2ce7bf395a30b0b82a5a6a31607474a5a1ea1b736cdd1a98c51c1e765bb57b29ad29e1845d0d451c9b5c47df7df9e3e3505f77b77cf39bdf1ee64e3f4a3599b1085b367029ae083fc1ae4458fc65210e3f199378b59c76c21b9101639812d5d7e38b4e4b21eaffdbf26f9f71ff3caa708996c89731bf2dbf367080e96f336e070e62302ccad283e4067e219fb1bb6a7680981fcdc414004e4d890f5eaeebd1ecfa579f580718e561aa89cb86bcef735e2c50bb8dcb239dd51735e632b2e6dc9c9882f7958611e8821b521ed18711f1f9d71f837f8349012de388eaac6e02b22eb9f0e221818fe80312aea0c72a8178d21ed3bfaed557ad50432b6e6b16614d6b0a5a21082cd87ecc90f34988615dc1427e160b7225e6fc6c45c7415248f18d062170ab279c4c71765288d67f5c1efb643595f8a6cd7da083bf30066271bd1c029e61e0f72ef9e01c132d656ab6bacb45f1bcf0fdc8a8e788fb3627077fb4f0aff58f6379344c0d3db4e28d92d91e0de26b8d597484c7dec212678e1f5f8807b83baa2102648dc0244853eb6280e6cf14d42c92615d1106e9828f6b3a4f0006074d5bb8b0fd78122df600335ff2c45956ab90c3233d71ad7be577953f61361e1af2553a29ac286eb26f7723fc75d327a0038ee8d04c7e98ab688b7d19db0afd9bf26e0d7aed596961a3f2d8b4a59449f0e54d124bdde37f3dfed14e4e9e243499aaf5ef7c579217d7751c560c055efc34c8de23259e746ce168286549191782388e0e565cf89bdc919340eb0948f7ffb55b605ad79ca41894e891fec8c79935c9b68e05cfd5ca1076da95717ac7a6398fe27406f543e0fad34753fa52ef19432292008895a8a95488a0d1f16574542686594d784cf1225d400580117ef9c89d3d22a133b0d0fb86c521ecd7a55e56c75a30f557ba9826f8369a1f8ea35247a5de1e6f0b508028554e760351de954de25c8bfa02203a45ecf5c3fc2b2b42d5e08f2dee5f0d43c7d8ad93d45ccaf601913da8da0081bfb26cacd63620cff03c61c7df287019281941f2bc681b0bf0f5cbdcb2d99415e1a5c0500fb2d28480028f689d8349725ca22f0634af12b9fa6d34bb8424de204474f87f22ccb211fce3890b291a14d538bdf69e6454764c62083d36da90de4bcd242e3db149a7c82b29d05907ab24d70f4d4f2147d1adaef836fd2cbf0db104589e701570c42008e763dfa7e9a8f1a86aabbdbec7c986e79ac2c8e8cc29bbbf6399eff12ba989f71a2b326bbdee8e8724f703e0b0e4f83abb1993581c9ff50af3f18069884687acc38f5be8da671d6081b2951dd810abd736a3c095d0135433ba68b07561dae32b0f51aff3fafd352cbc00c02ef2efbe0da39e598a714bb1ab8d45ec04108ffdbf4deab0b256740b950a9cd4cca02fbab10ebcb4182ca62af837cc4711c0c452f1bee7f9813cd9c4bc9b8170b116b9ef190c0fc8d27e874eaee6982a7f77f6aea5db655896e08f4544e78862dd7af90cf2257a4e0a9d84aed2c7315fadec14f8e00f3b69d160fa86e5a020d68e1deda7d29a93531d50bb5ba162e2ad0bf42eda3aa014b9203ee2760e2962190a7a55bf56b5eaf883c8c4eebb1578ecb7e590d09ace1d8279551aeca3afdb9a0612aeb2b241c3ce65e45b69b26759fc9276024fe918cae66eafc88a3dbe53e25a817fbf104c31846e93563f37d125ed10e053abca163828e1132cdcef6df5e25741e221e52dbec2b0bdeefeed82ae0e3e2b738b734a926c829b83c04d64bff6bdda126a3c118a129daa452066668969c143b66409eff224d227f8e4e38e85de6e159eb2607e166bcf9454719618f32fe4bf7188c9c04565fa65cb7329977f27757ff7ef4077c6d16d4a2b422dffa88756afad0d092d8544b1ab0aafcdfabf01696012c5a29d43690fa8bc48f4707c8225951b038a2657ada9568dbd6f319be3cf81541a15ede61ae8027ec4e8e67679e232fe002f0e4f3f9a9014cfdb6ec73c4c84a4c5a33e5182869c5200f83493ac972498090fc2ea446533388fc88072a9fd16f546cb4ad335d959de46f41ee5432668bd32df35b0c52bd41438c21838dbc543f62c390128921707d1135e083d51eeeca78076d3631c531e86c5c374ba69bcc8f8d4e19300042758fe1a07fbf453234c50aa2a792d050929829f27b16ccdf0a0c4b92992fa066624788f0357d06e5980fc59e266f2aa094297bcf4b3d1b732f7f9fdda2aa91167a79d1b038775c8a20f5d0cf9b818d4a845d064c4c28bb4f59cff9d48e88fc196228a54c32379f65a7c3a53147400f6cbca09791c095040216b69f649ab650865dcbac04fadfa29504da2b4824aa13686f29f13a52fc3d46336752cc35a3fd848c53a38f259f2bc047a88447bcf0b85fc91205399b59fe2d0844aabff9046392c776fab2fc177d4b1e7a7fdf26eecbbebcfa9eda5d05c5d1e1e8cbb01ab143984c5d8f2fabb9bf81b5f758518b4c79f95f1229853dd339adff5e3b0a8f3bc07e17d625bb1af0be2481da10dd29281aba385f034f1393f87c027249526b95ba3d9ffb02bef793b0bd51a455bb5112fbbdbba18f194d454f103b8b8edf8fe33ecdbfebe7b53a92a53f7aa17e94ca0efe7a6442b8081f0c70bbf6c15d6405aa15e852bdfbed9a0197b53312c9fd0dd58de5279279fff95ec7b8780482c1bf97cd2fdba39f30a05413df6e4bc2961750733a18831a491531fe61d0ed3d471f339a4e99d668923bab0b6089c02dcf936cb517e1d02227b76bf312e075ca0e409a26a142c1ea2cc6aa0e0c22fe1bd76b6656c9d7027a7e3d4423985eca0c525144c4c9f0c7a0031aa48e3c77b32d0811d9b48b0867f92b12158600b9bfbba2c2c26f30e81ce21d983165b7d042e4f04369cfc487ef9dd566674d0ea1b6f973b0a712a29433f02fc68aa07d1b10c4fb18ed2e6719d574b2d5cc09f09a836f6ba4ea19a84ec98a85c7400e2cf8aa84bccadaa9a80d473c492a08733ffcf59c6f2c00cf5e5633be82a58d42318f5e85a382ef81ad16a8e40a8f3a566f385c19018951b6721c4b1e3847c84b9264405935739704aea24de1773dbe52aab68d5e65e6577c67eb182caf5aa60dfef9933300ad4ab5f1fb9d78c9657b73a049fb65329878f1ee2406c8ebe53cc9a3a9819e00ab5da7aabf28aa1e5eefa7eaeff1a81dec8fe211d72808ab7e0c32add9db7ace5d5989f9e41bed1545d0e07b94dc5387891bb83efe2ab85a9718cde8aa0400e1a8478210173ca44873c9452ec4689985877c450d8a601462965e2effb0125b876ef26b746f912b75023161964995ccfb6e61f79c3ccd99367c98ddc36d602798f85c5cfbc9a27bb733a1fcb8b7c1a27cb6e1284a44465bc18e6e8cb1ac59a27919c98447f06bdd97bc638225545844e5c1f593fd95b2b4a7ffd524a4bc7a27b6636f0715f43762fcb688679cb43fdc5094db0172e25be024a624eeef6ad6872aef8fc5f7aa36edd0524e3dadffe9cc9deba173d78d3bc38106e9c52cb2c37e0d1597dad68378c549e1dda70ea4edebc02d67636f16872d1ce107272039fdc338eb8e379844225238e259f47b8a8c8ba1f0df64f7edcccd7c6c93e611d7b019f70ee29e13c876e52dadc99f8074f768e75ba0c89778800768c90ce1553a75040d9bec2200c60d24b12ca3e52a74634ca5fd4839290bd9ac6902d3b8645ca19b8868596de48a03fa9eec569c370a57822f05c969887c4e39465041993069cf742aa869458f0bfd3fe955b0970721e596ee426181f91a3f8e754f70d9693a9dcb43080011ec7e331627147da00496ff38c888a0568e6a58e39789bb3f6fdb97a5aaf83caa589d8e02679c137deb99e420afe267beba32ecabc043e7df9ab2be6eb51ccf09fdb90d5acbf5d829f3c6d7d44aa523ebff7a7bd1a47399e590f5b8bbf5d1af78445d9058643de4cfb9febe7305d2cf4405e024ccd7e58032224e520eea72688599de322af648adc68e39d38416ae076a73b7973413313d7265363d58d4a35cf527df0568c773ae5a862de3b4022a78966ca33c862f1d190489daaaddd6349459408cc92b41f85d1ce117db13dc0e0772d0dc1de802ddbdcd37f50aac58c34f0c16866079e7ab170f00c180a16ec728d94d56f294636a69c3542acab79cee99c89c0f35757df8daa7eea3ca45f528bf49744f193c2eb83bf992456e18a6a7e3a5da2e384a0339ab5e7eef76a039f0e8944a2d13e2f9a1b2c0aace3c35eb6a4426929510d7e314fac8ecf1e6afda96b0ddc0561e992f07a523f92d5d6ca32cc75c0b4d7c0eb702ae54a18e1beceb21b748cd44a59c00f1334db57fecc63bfa7c1474d6688764de428032fb569d6f8f0348b00b38519e0f72c339cd3cf598fc60e278cdeea7794c5a7130cc0e5eddaa0df9483fd3bf8ad72f24b916eb359493567d65c8d1cf86a4561d3068295f4425231fab67305b54cc8576a39f82eb4b589cec062690a33806f6ae9fd7d3f4ca34daa180fa85b6a6591d09c3f0ada6994aa7e0314ac85ff5523ec6006e1f0e21f48f379a1b9fac656ca1e5b106edc7083c3bc756cf5e1b4bda857e0fecaec3fffd01bdec46981c7d46486ab39765deeab3229e412eb9a58f6cab1e226ee4fb4a2b9a24f11bc396f3fa8bc25a113a6b6894986a8b21593b1510f22fd4066f78223615422509428cf0527055e18438b4c31b2cfd21dfe99fb9ca62205481e396abef725027a6f30d5aabd9f2a0406c9367868c2175ad4b30d0405a65e4cc44e5f9f32ab8e97c1a6d328107b0c2ce7ff622c4a6b816416c329cc71960cf544c8a9e95a9353bd6a31c4ce707a6265ac30066d1fd6eabba38306db326afb6f55367206233b1f880066dec71fef678a51fcd56d29b8b99b15969cb0eb1da0f9fdf7eb2db1880b261cf81baa7b8da1548898d051712c1fa2b8068604b84e59209e08dc23e7475509d546bca885ca66ec02d049a9b8297aee222b9e27ff960668fc0163a5f4dfc858e8d445e67479f9e7ccb52d2d62d3e8a7c3cbe14de2f71ef2376d4b0d51b7fd5d6b52be4ef809db41ba65e05df651caec28dc610fe11a40667cc76890e658af7b01b9381cf3daf575e8c600302a3492942345f1bcc0d8053f3c09f314300e692c2cd2669bccb6c92629d8992186681115a8bb52a2555aff4b215e914730e22fe423a78afd9f8825f775e99bbf7aed11fff3bdbead88d83058513a37353372771034c163b71361a863dc328d0ba7c910937ebf5cf231ac7348edaf48136219c948ac9cb1caa95fa05b8d93d2e5bc6ac3003f2959fbd832401120c615d63850718e975ebe1d18fecf44551d53b263c87b6a37122bf953b8afbb6a2edf2391e042b5e4b8e2f534ee13d283356d1bd196e6d574b4eb21262226a35a66000b7587207f6ce72d70453d773adf556c75960e5c07e511cee0ad37763a38ceaf1e0a362f8936498e06d48d6d530154edd76912709fc3acc0d61a89782cc577011cde38ec23069d82b8848731df19ae82d0b9011836230851fcf60896c6c345c4e7e8eb2625d0c48ec8016affad7d4dd43f7cd8cc3b14eed6676018a4a3955f0a11410c4a27e159d35cd6e50fa93b8a1358f2dda2d96bda17fe127667f3bea29e2143dad3017d6646d3e0d9036835f265f352da9698fd8f3a9a1a425c045228de1b205d7915b7c1b4710c631bb8e22561ca0062bec42424a15a6aaf1e911b7844d83c982fb399324c2ecc890aaa076bdc5f07716b4295533eb734984f3fdc34e632729bcedd7ff1999c78fe37bfaf11299e1c62ac4494033f744f118c900d7ea4d7d0841ab7755369c1493cda0bed0e6d9f4897039ba9ed2f87eec0d725b5b8690d1ea184167c9b3e70a3340ff84c27b278cc534de1b8c90aec252c64ef00ba149c38323316296c41904dec676ab81129d70db43bce3223b2a463476ffbea0ff95b43f70c189e9fcf813552800658d4c6a924ca77a5a113f4d1579b6af9b060827c766d71186531e64554e3a7653dd0863671e088b84429c0620ea066b38e3867123a8463e1d4dd02ed045718b6fc539f200235a0d9d4b1ce12fed47c58b5b190d9f306c7c9fed23df44c79cc90f1a6ef2eb364b15801c97df229e2505d311349abfe456d6958069950e0dae30607893c46150fd978f2fd38493f06158f47dd95e38c17a854e237dea613af02bb4a4359e5e573605f697f275bc21788269cf007bfbb1a31b379de71729332db33972aaa55180ed05bf9e9d1ff87bac8f41dc0da71baeb77ae2573cfc865b45efd596f73f0dc5c186fbe1513443f05684d4ba9b51f002a7997dc127794755af4bd3bdf41aa16855d1a93df3c8846185cd172f003afadc75b2eae7112a8415d423f253625f3bdebeb5ff666af608d9c66758c78f997e1a05b1a60d7b2544be63448b0468c346956ccc019da2b298e7cf9cf5c2233b0d3094ada7dd84bdb2e35e606b1006de632f2466e3448b0d10e109db077c14f4a8b761d5a1ef087fae99eb75918020298af1a7abd911794cb34cf31f6a921f4f6adf6b07c2d1c9cdb0f513c7862f31b1355c6a413c0a406045ad74c3d9135215074e440d59f146ded157a6a702935abb058ebe7a25ad8fd9589a8cc2d0f11db080dd3c228ddc7472723e035066f642d2652d3d7adb1e4b972290d1d6d3edbb73d9abb5f1d100672d3b30897a9b8135e98654c138cb2b37d7bc7452f9d0408b436de57faca6ae40b9f7382eea5c5c37b99378a0616e3cf5fbaafbfd1ab9cbe6fc1607439fba72fcf9f0beac8895758e4e518d4f205a294acffb45a2ee8cba2ad1232de113adee4e6be026fa5c6182efe2b2175599481b9d8e71c8e1b363078a6b15bbbb176f76d9343368eba26e2a737fb9822b00275461e02dda5de8c16bfa6c0564360c895d6caf346b47004c8b45a47493406260ae1cb0aa6a06d075991b17b19b4339729508bd4a2fdf3932c2ad198a25043232a1c6a0ee054c1f616ebda6a3d580ef515facae89bfe584d3aa340d5861ba4375125b3d79ddb7894b015c39a3a30ceec6f63192e01af2e663d29fbddc12c5fc05e43f51bdb985c5760d500729a1a3915dfbb319f6d0516620f393bd03d43787f53f77d3c64067224a7ae0e2a36f619997705e9c45356926b7fe1d1d601b59c6022384caa667c7e0631af61ac8c172c400955340cf1eba1b63e5dbe118a2c0f71569c459cc957724ad769cb85c23d71acdab6f0b6e51b2eb6bf753dedb2a6b57b57300d8f8cdc602c7c0f9e7e6b91e67696f3a880bcd14750e16998a11b0bebf6f56ce1405ad4f27f16e7524e3c8bfe875344b73d023bb39e2f481349bca6ed3672b0796c07d9ff34ab494b7a6106e5ddaefb9bbbaffaeaf3a3d643a1d37a0ea71f17f0f951c9ba39242c637f1fe490b8c79a28049c3f5dd71bc27738dfaedf013f822cf3ec58ef579614e75f538b4beb19ff288c8392553a6e37f681697f5a38dd1437310ab15af3cc5eb15264ccda478587ba161c9be935b2969528b1ae2ab7ea2a9240853c591a1604f6c6307a74bba2597dcf3949be9cf665a451e146f30ec85de105d7b27904497482bbf23c0c8793775d2aef46e6856571e2d3c4c27433480340f1dbfee323626f818014554b8726ab7df11346a515f6f1100a161f1903d9be9687266eaec8a1d7143f78d19d587c15491229f94e0801dd83b1d9d175e368360f11ac794aa3d23aaebe638e518ea14e483ab3b2f7b7e1e1ecd155a1ec7af711d77e789218ec66fdec7e6d81e754c68c3d103ddca77a2f4cab5b33cf859fa4f5408f3b68e36cf3fa7f328408ba3b49138f761b9be93397a6ddfdbbdb2e602a4321f4f6bb711744f70c0be69905488e255e7ddf7fecb8b85137f217e5ddc236cb37a3aa17de9247221e6df3810b45a4f9a938b1bbd3c070f0da9b3c5adf31f6c9fa34d6ba6d98a5a37a8c364c1281890042ec0a10e7cbe379cf4db525a363beb1fb6dcd7c5f130e4c081ca06d6d83b9bc05edc34cd5515a3bd675c729f0226da04bbd5b9858ecf95133925e976c0604ef1b5ce0b52ca512975983c898bcba3343eae88fbb51b077277c66aa821a75513b6c98f72b0cd8cbea3605cd31787a59604fd2cb2c743332f4a4c388a140e2a4303154cad8b9292b5578d6892c68d2f86e53fd764e6fc3a8c00f6887e28264c4b015f3c77293300fad91b6a2c11d4da3d191254b64364683934f8d4d1ef985039d05dbe9d5560a982195f01fd1b050544c92d98e1871309ae6af60a29a105e098f468417019855fec333dbbb1d08f98ee694b1f6475c45c6490e82e487be6a87c369b7d8292141fea241f7e80770a1b38a91d431a28ee323023efe93392482d03390be4834fa9be37a11daff7577b31064adeec2126a88dc3670b885aad6b5caed268b0e4e29180e0d283b4b3b6b07a2019dce3a322e985185fd9f52872b23e77d09ea80b618851d12fa7d7f1973f6201fac5dbccb67bfd79b78d0fb6fbc011ce0ade8a4b6f1c758bbd7d0867c660b8c2506a533bb1db457f1935812b9acd376b75cc2b963b5df43ad869e2ce419ea9ceeeb8ea971284db346e2348590cff912459f208cd22eade4f0c3d7d7938f970537dabafe3291efd03e2d8a6155731cb15d6fbda43fe66885db605f93bc36ae76cc01e8ff0beffd8034acdd43fc400993ffad16f2e0d35c4c03841e406ea352f079ba17b5354aa872369140d05eec110d2172d777b68c665cd84bef2ef28aaac3abf614fea8fc80206ba5c8baea5209306595420070a497cfce82d5c3698d9fac2b485613ab671b953406d786516936dd6121708d31f04888ecee6fb91f7d493fedb38635d9f8fe842a036e558278f55fed138289a7190a1d281a4d80fbed2cba60b41c8b0d06d0a5309cf9a29eb8c357f4f75842c8adad57be77c21d3d7e1c22e44efcf6a06da6aec652d4eb13f400f1be03baf8e22c3ef111766830e454f844b9299389eb4ae7241e2d79ec1d3fc8a9e83c7cfd7216b68479885350272fc5085df6ec0e5bf6e3ed2902a852d208f06deb4c67ded89d0271e0b089fb3dd069f1eab57670d75a983b25aafcca68d412165ed891015a44100aa5392c07980ac758e9b6c35fd32143851487492daa0687a1a5050ec24aa3fc065e4407dc5ed1fa2e07fc1c305fe18bac51b2cf6fc6730e765185a736d4e89d68cfd7481731dd02ea9e6358e96813ac75d1d96dd73215957cc0da06408c5637a202fe57c8db68c9bd67256845554a828dd331c053766aa2c5dc61ebe54dad05ccf411f410b6f50c069db522f3ca9d65e80622947a95416c92ca8269382bd27e3232c0e0010e29f3cb9a536a88c1357b8ed551efd6213c1a07c9d6d2831a04f8eed2cc6a22244783cc7e6e44f21835453ec886cc5c2e98799395bc76e5a3990d5b6e3ed61886f32aebfd72c4a709f2c0d8ac0e6bd64f8307fd1e055d772d69d44b7c36323d6595005f8ca00a11161dcb3326e6d68f9675a35eb9d68bff68df2bf9e1b3764412bbfa666d005a7b5ae499d4b14e798e714ea66db156c5de302cf1346bfad55b8b75c06699dfa6e1f8006d24c3b020574206c1f025e7df6223025aa98653029accbf9cbc02ae38767f15d7f0d0fba12b05a41f06130ec6f548fea3dd695eaa37c391a11b7fe4941460df43095959f422823a5d2ca723cee763ed304117d05997e4966efdac67d4433b77f701fb1e0bcc8fc7de90ba62271fba690aeb8136e4bc43e90d55020d7c03ab53890a467446988a4f40eeac19a579d7b091aa8fef616e5a562444e09decf931bc031664238a692346c586483966affeeef537d529b0b4e9b3deaa4b9ebc8d0676129defce9304a6acb6fd80f2f701785360f612ebf36baae7a9176a02573793033fa27bb34453f36d52a1bb36e388b38fcdc8d4a5c76d7419df881aa837586cb74d8c68fd4589945f9cebbc3f0f375a61e6a235a6a4fc9a75db5074aa942106dccdd984a4514f39c219a395f2505c6dffc183d2b7a5a007462e918eb45d004fa746fa6a8f3aaa735b3bb10d413e94b94f74df5772ec23c38b681442906929f8cfbd27f3b5d122c58da3149885583aa061e3221371f7dcd44b8d62504a70c98bd3f1f48b994ed237d07d3a851f441cf592fc1e56d44dd882bde744464abf94f9c5dbaa1eb7e3ab582f1371081e8ef452c0cdcb4a4137efabfb1265f54e6cb33b54756732f84e123d4190d576c9e806857c66ef68c07a3d19880d1d0c133fe78cfd3ea54826d3c09e746623a5c6ed3a5f324ea572422028396156b40bb107970773775df25b004baae6265b46d70f05adbdc30fda4f165cc770635d23b9cadac405a1cef2f2305635ca3c89c303083e1b084b3d19233340ac84df30cbb1122cea1bb628a3c8b0bc6f52b752a85bc87faedf761208e63c0419d31d6179ab2bff9c88df00f25d5ca4849d60821323a9abed54532450c923c63a785f84aac1e09b3461293899fbe60a74288ddf056f64332d66bc4d91d6e4309524fca6502892cd12cfe5315b79f89122bfcd6c3dbdbd6480dcbe067f6d5c99765886232be3a1f80a10aab051c80d4038bd75d7cf8d1d6bc76115bf0bae4ea7946faed43945900420b503204e1bcbadd0abf4a41e6462f91cc36e4db15c2fb3cde1be656d85873f253719265afa2d32538cb3a34f8a66175803454b034a95a90fec92b1313647a2d3cd16849f42ca57644cc07b8ee1f6c08e4afc8d5592056ebd7c7b4d688e60425d552392f469f1ee3082106f300727fbd84b4887059914ac3891b68ca5e5843eacd069317340ac98ca3590a89ae6a6ab3c4a792dc66f87200f194cb0041a1b2b07a58e11f0da541cc10ab14ee76ac069054ea25d017c01b2490bda05ac787cb402b4836ed142b93f318bd8282e11d76fc6bf6e4590e16d87c858c593f908cbb75c9682a655923db7cf88d3bc17914b5de5976e142dd37ae4611d9001f772de5c0eae4445c7b9e2f71a3d52d18790f1191774ba8f4fc0dda4182d3c5c31a70dcf4680402c85c25a08e27bda790d9287c96f489f88f5b8df92ae17cdb0bc128912bdeff7da6e9594295a1f51ef5fb6f01d76155019cbe6a16271dc4e6c6ccc6fe237196a1800e6f2eed9321b3e828d8c68c1c8788c9fd7a3c8baeaafe9b74ea84a47cb7f41271f8ad6c406b61df79681a7a35de7c7855c498eb75a6634ebd57f935b5826644f371236febfc2c4947934a154cb9650520bd06537133f4fafe654be04fac54b12a6f5970dbd03b29eb6b066c779d5cf759106cc42cff32ecbc6d9227f9350cafa97a74bf5d1e5f12f12c2c89250158ffb5aff45343c8984bafcf2312e3913722c66655ce0b8e5325c3cea4f6178e5678b00774bb0579deeabe2055b24b1f63fd9ff9fd15c8f37f9eec7589042cecfcb841a018b34d833716523cb72350c18817a71a518f424899a3eff6d50fa3b94fb3bd5ca1c7f872ac65b752db56c3ed9179aed955c46033287bc4e19d1613b097200fc67b3322fe9f6120387c9250d71ffac03ff030f1e8278bdb098f7cec04d6e5d05def5b6c7d682f5473bca57145867d51c57a3a45015e87f73604b471784bb3e6cff30c8a424d349321dcc04256cc587d562cffad0b3779b08c711680ed52eb0646f0aa4d18910d1c31378dab8129f0567ede9d4fc603251eda00991f832e5dff59ef5751145db138bd8b8786dae806776cc8631de226695d5a21e68f6ef284d5d66874728cfe4367c3b805f49d9dfa4f976be790cf744dbeed2e6525e4a4c9aaa64f76f8b300110534a8fd9bfaf7b81565c3bbdacf7a177a15a30f76b18fee1df22e6e3c83add12e8e82189ee6633039abd52c87c91243f4065b04d37f94bffd9f9ab197bd5fcbcde8e0f6f45bab52e02e5f555f07fc04cd0841fac601643c57b454936ddc3a81c17c25907540a2dde943c943b506638610115656482b5f098a0e15d65c4945cc7a6f86333563ad516550a21711a4dc5317cf1ece13cdb3cf69b66568dcd358e17c1201c807b634d34ff705cc6d808c35531be3daf9f76273320bdb9a0a6ca45617e3be164ae93d6d64cec1294f2b040b099297cbc6b18dba54bb7455732cc7add9157d158c22458793d8b8737239866a76f87df4ab2bef3d55fbd10b5a911152dd000699c9a37d88d094d6fdfe294802f68bda30d59c99eccd0fb6387031a69e390e8aa73e52b1151059012ea5d9daa950ec1de3c7e6258ec0030e61c0ac420b50926f3af96b8dccd6666721c68212eb47579f433da59f11d35396ac636352d892f67ba604b7dca3e6dec14782a79cd9c53837aa07e41aaea5f96edab02223d7de9ba15d90a6da6c045d3f15d1d8675ea530e1515ec88dd6a477410e637b98f39ed78235599d831a248ae98c5fc649c2540ccebebbe9ae90b390411dabc531574f1d22e3ce5d5903483297a3c3820231c8dedb8b82ce81596a3fba25a27dadd14e560af26daafc38f2cbdca996e7822e4fcfbe0020b1e06988f63b86c2f7ace3821c6bc2f5f75a982f0f35d0ddee85b9e6062e54264182cdf27980da123239e0fa8a5e70703a5ea5749e1b6a50c9a0ffcb7d18bb8345b0675eb6b2942f09aec2cb9595d9bda2b58442562ceea359671f04adf6d71bbae100a93b771ed33f6c1d18c723cce1bcba9c9c4151795bd76fbb62d801a8ce9eb927863ba28f24c6b7e73980ec436e93e2308a37c28c337e21012954b3a814ac6bbb3e7c883c4e8b5ba3d48c40b57c863731843044ae7150f05a6070537a7cc9b5d3a509d27a0fe91833a7481c4a9a37107bc11eac022bf957a053a4c7c95a657fcfa3ef23d02fd7377086c7592136e0b1e79595b38695a3edffb95fedb01e8a5b3b30c28e53cc6f9c70daa2e5422e35aea0b2640bb1c7a389c4f7fd013f622fe0f548b5f1df861388ec0263e5bacf68543bebc119b1caa31b22a835aa1c8004ff82c4c2c8f6cf5527d2a6c81030eefaa6c700a99c8bf2e56948a11eb14fb8a90ccabf96c7efef31bdd145cb470556a0e49a8bb3d9a0748c12e83f3c3d265b17b33386b4ebf2ae749793366a36ef49406aff2014af4c5bcbb773ce73c1c312d02760820d2c907a5ce9d6954c41d66912934b09e397408f0b120e9b1faeaafb0e52e7cecb2d02b922df7c71b796bff5d400122a9859b41539b14d6510312f133b5efcdc7062de1b7374ba4d3391a621729950ab7a1d6d331a3ef0b7a973ef9ddb0813e86735869a2ba47bd07cb06a7093ed8156b6159a70ac47e420acc5819d0aecf71da37c3bba101ac3b104ea57c89b50a16955f7e74c41587bd31c2db1cf1deef1d30b01bb05ebeef4165cbeba14186744f8f319a059bd33463c112dcc244738a1801e129edcc7d79969929bf3b7456e22d43f9d68bfa242214ef23f881859679596ecf3edeecb4dcb645127b6df45fcacc5b4c8df7d56f629c9b0d1234e83344dd54c480cb7159104d45dd7b532d04f05db537b4f17d2dbde654c61c779ef4fd088cd3f840724a2e67562e3514e8b571d9ee118a60ef5a7dbf684fa0c6a243fe804d70b6f7cc165f3a107adb83bb369f34cdefd2058cdfbc61732cfd1902ac5fe05cf842ed55edbe6080be97ec8180fd03f7391dadcfc33ea20aa5daee4b9bf6c92ab3b9bfe2b1c045d38015c5f4fdaa980890f3a62e36910f6d58ab1ad882c4c43007056eec0cf8dc0b160107d8d26e6664aff3bd01472859ca15d0218b4e2908c1effd46ab0bc3ea9f6f9c22a97f9fd5b0a3891245051b13373d91ae2a960c4e29c13f4715415df233d5e8552b7351821af05401e4a86a8f777d957fadc2aa4c74dfe6fe9aa0bc3ff97bdc702687b78e87b8281f2d11118d162ed56280e9947753958c168cf10d7d5dbf25be504be95dcc6aa7060055a904859e075b89ede332b5f11fdaa7dd87ec8c77cea844bd85adc22e85498aab6ca24fb2b6d08327943fef410a9e813c73f66fae56e8931045a84dfdca5b869a85282c779712f57a3ab1636920f197f87ec5971f8d61c6d0f1c5dd8ffaea2b9be044a26c63335dd5d6f8b72afd110d0b849b773bc834d4b71f521a670e5ca34cd7d9d7bccf14364e7dde1b92be813ae4efdd3573d28c1fc2cf3daa73581206c32859b7098fdbd15a19cc667c43c3a7869f261352e1e3541816b6d8473fe10d467012c800c0f2169389afe79cc42556b4b654f89ad9a862c93655cfeccac05d4a92106caec370d5b043aaa1cc1919651a56a5851eaeb7d579c09d27e9406871d156c1c8dbfac4fa9402be60fc02c4236019474abe25afc949e2d6b56eb100a7075d68e97aa2e529936a77e4116a181911a93665f229560cba7d07a96f049797f99a5ec4e1264adfe5ebdf9f0a9bacf197b6e3269ff1e6cddbec13f88a62958fe0ad71a8043e9db6acd140ec6da253ebda535ad3c84295737678483b2210d146f4249aa7d8a21f54665160b104aaff5832a59669daa05fe6577b765a4f328ce22371115694fa5c91f29b0d03642717bf6ef09f75893a910cb499a7a57b4af1ee7e0604d0cefe20d1c7733eacb68e718a4643b76a59435ceb836c967b9e428d1e65bd4c3b2130299c4d589101649410b1d3ff3a2b276c5c7a93492d57b3e70a27efb7b5cec0c10abdfebb8960bd417df9f1d31f46a941b6ff1480332afb43bccfec67ff69d924c45900789658db8876d4d0310997f18c7eb72d4a8ed1f251eccde3f5ce7955ef4de48197a9b23ec5049869599ab0598bc0df0054e44d2ff65e07ebcf72b744f40f7edcc95a7a8199ba735b6d8e3f8bf18a68ffb6649671beec4310d4f3374e43401df5dfd79f72080388d54414ff98e549b3a7055cae04478c8313c6429f2eac1a92dfff1a2100c5080fc0a08ddde9b64fc46727635e7ace64b76a2927d0c580ba5f61bd7d902ef8fffae87da809137beaf4e9a62c122104454dd1da6060cbef041a922fe36966b53eeaf1ac19b20fb6bca7c8c57e4f8d0e52454e7fdccc423ea0d1a8476189246aa17b58bff0f8ef2052795ab022e824aa2bfa837abf8d38baf88fbe9e3ceec2e614f8a8259f85460437396a068063b906befb2ee89a0dd133ef55143e11ec40bbddf78411affea333fb67c22e77f0d36b943c53d15fe7aed60a748b6b5cfcea0b022e6c3ad30fd3b80dcaea2d5d39a958fdf9675074b84b3cff19b9aa1b56374d1a26f7a148ca480cc4fa95023a32d7785af2c8f17986ae62677d0b070c04f3f45c2bd132f360e08f906fbaa333c919737027fafb451b94c0b3fe8c8ae4c1a3ea73ff15d9e0ba91c485bb44ff9e26e80a867074f5d06501c6d5a69f7dead4e0231f12c60ffe2455d99e2bb77d08c78842434a9b3bb6b229de4d9fcdd217924f72e3196d434d6fba558426cb026dd51894cd7bfa6290d1158c7ddb0c29685e446684b904e6e97fafeb36a61e66270a4278b0732330abb5bde8a1cce3f9d01d096dde3c325cd6ab823ad4c6b4732a571408a3be7d4b61ac611ddfd92d6e2e5c1947618ec5ae9c34ae11b846b8524cdc6e53e5f1a8431a0f0579e49642398498d76d6b76a8f58286b5eaabb0b3388323d9aed093cfebcb170d2b1d786573a7f26fe64e887916ce63728a565afb83987a9c6fccc923fbef9d0fb857511095e3e3a98742dfc292bab90293741a41ef09d3c6be4543aae8b0fd516f3f449dde32a7dafceed","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"cb4dac17dd2d3b658155eb3f63bb6c40"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
