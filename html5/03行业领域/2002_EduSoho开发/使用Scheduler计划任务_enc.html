<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"b3427a8b4036be20643c5618eb822922876bfc82176bfe0aee4f14377aa20c13bd6ac08d2a5034cb99acf12060e17f86dab9ff0390bf50f6470deaced6a7c3a938e2652bb88f5cad9d630cafcbac799fad85def9433d15045ef6bd585c5ce7e4d45b7259c8562374cab103ba1d376acec8dc1015674cebbcbb6fd005e99f401c47d4ad4225559951c163256c7a537b7e56eebab4e0bc43f4bf0ad57ef8df76a50e2f13576586e7012a190fd5fb311e25b9008b4ef78bd41d868993337869108e287df182eacb97394b0d4cf68a4a1fba7f3df68e786a98b8e2023e48af8a6bcb1945914a03563e46bfebed14582ca41ff963efc66008b956b5904d3f970d9ee6abe8ac6b386737fe6dee9bf2072bfae77819f3da907ecb0af48a29916f79a1e9c80c95885269df346c148a91ddcdec1ac4e5dfd8aa433d9f0e5057d95a39ccad5339cfa178ab580d6d947c9a96d38be5321565cf46657fbbe9cb71a40115283df9fe4026f081d5542f0529c5c47ebb4a6fd1887370a02b0abe288b2d688f55fa986b791b53a5929090a8a394588e008178b31a3d0696c176a4c5ed98eabf60e6fa4221d6c00bfc1528d4c79ce3d3e757db919708bffe6be59e6941dadcd3e1d7fa55a285dabcbfca9c70219d1df4be047cff7a7b8a94c55da39e21c18b87f9c2fa50a0893dcbe50af9d9b58509f86715f2250231bd3d2f2aafa4dc58b7fc06ff39f009dbf7e366964aa2886b07b486308c65b1bd8f277074596a86ca78207ac3fcdfa248f4aa198ef2910077b9ac9a62915c0b81e43b6ebab2a5de22538b139d5998d518b28a63ab99523b852354c281c50083606903e2ffee272a9500ac54702bfa2ef5a0e6b13393af6aa19183c5f52519c014de123fbfcfa69126a7a94139b0f79fb31ef230a67756fdb911a15fe6cc7717ec3a26632a64cc6960112085d2c810e02278b9cb39daca306618204fa48000798fb5e95462c0adf3bc053bcf42f73c99f4796c5e9266210c84850f3786ddbf76cdccb2e15e8755245fb12f675ee82e0cdca2711d8b2f04bb909a6b308ddc7374465d94a700905dc756423ac24576bd7c045ed498b020b9d017951c47bb99189127f9c1b94692f5c251a0494ed5a782da5e5d352458228da4d71886cbeac09389b6a04859c6dbec142c194aed045e33484509b2fc7b24b8c1d87239d52e2519b8f74ab5eb249881e80e76bf85db03602152f3df56515e8d6663dd0330de2637eb8a1adf33851c9f4d5548964d1ddcb2a95dd65e10aeb3f54f9acbb759b31423ba6f2c6df757bc75a4a637c4782d8990cc10a1547e263151b8195da09bc02e2729892464abd2cda60518cb7597c9be4949475decf64075ec1bfffd1126932e52979df8dcd4b259fbcedabe00c51acbc64b2f31a6cd2aec3e4a994cfb5111e6708486f90d427bab3e454f34182291ad026a7690dfc4024a8f4c9360bfbd58b9fdf0381e3c7da44bf8ef400acc39c8f2008e00d46510b4f8f81db3f2926eb31585177de0d65e95d060ee4fd7a11e72d19b1529ac77825123ca6df6b56d40aa4cb6a01d06ad00effc0cc225ce34649c2fe493f8365d3799b01f482d7040e9a39238702e1d55f0fdddf998c09ced34313851ac69c064daed9b09220fbe0e4649e1830e7dedd30cd9b733ef033ac873a8a33f9b4661d599d45ae771daea9633a87bc218eecbfa0dd1ad1bbb784998017c7b31fd0e6fa66ccca9c3b8569fa2eae267afff8c74c8f6ca0da9d06afb063d34860e24f4fe04afbcee362df2c0dca1c688f253c8e3dd59381d34edbd23e4f68efed20aa3c82e500adf15df841e99b222f8713e4a0106e8366450e4fa2b160f41991784d2e63ec7fbf44ceffee419049eaa6284459115a471d93c58992e5f3ff1c780fd688827651f7fe9d113ca55addfeea538819c3d652c093850a37271b1c33a3cdf22f67d6d5a978576138e2edf1b55817c758cbef0ba95587c87a7ca5ffa1a755203c56f3af2c427934df1167c976a048ba9b41b9bb6fc8f4474d0d5e487d1702ebc77cde05a1f03e064260145e2c41ed1b50b478608131ce9e851dd82e2895f88563068b449a4464ca27b335f69d79dae2dbb08f2a7d3c72dc7ea9f36824423e98169b58752bd3af12b908ddabdfc31247b7382ddaa646a475135d751d84b935aebad88e49bf2bc623be07cbf00d4ded454b508cf9e62d438b72f449cd97c8084d65d9917f2acef0d33186756a21c8d7da966a7a29ef26c99620a22e1ec3a86978808a62fdb17ab8690904f1a4092978f87a5c0f0640af36cd651a8661504243222efb60a977de37c5a2ac39598fdd894446547791f51b6e87839acc4c34387b11423f77d0a6e9e3631210f277b0718e7ff907ae58fdbe9c0b868655445a3dd26c32fd92207ad6697afba40fdc57425f806d6e7873b76f47b6001589aac2fb4fd509478d569f23d1bbbcd4d8de431c89825e756fdf72889850f6d261eba18def9aad15343a05f197a62538e90b895d284314daee98bcbd59e290f4feb999820621cabdd344c6e9b36fe7b473fabd953ab8fb58aadb1c6d7c1387f2c31024e26e286cb3984223f52aab6ad1aa7298078f1c656310f350896d10f00d2a972ddbabd001727f43107f1252b5f8e0d4a1a12bf977f0933d51ee1171046b32e605e768949056e7b56b4a86ad2e72aa88e20f54156079241f52e5f6af782ed8c64ba57bea46d75e682316035b762cd2007edf1ced0637482a6ed4dd7c05b99fa232b9e6458a81a83e1ef8e3306058b5c2a02640c7b3a9efc4b9138d20c0335f68ab49b7eae84b0c457262b44f38c1d1ac18138e7c08c5e32d6616ed7065d0d88f773905bed7637e2d99584a79c2254f582c6ff2694378d979fb014f7a8e3384889112b123482c2c9f7e01ebf237ace96cabf68bf6cb6e08ca32a86e230a93fc1d69de7d38b9a6e7d791e143acce2224d4301b69139f09632722bee034a7329b625a6f2ff141167d41a14541460c413ee7e4493a74fc8e5b6dc320f7bb3966a8d6e5bb2b9603511b02642b405dee3ef7014664542b315179cca7679b7317bafff4d90a7835054f154699c630c66acacfa3784654c6110c8949f73f4409c7d7376aaf163193bb4b1b663101d5abde222c0872f48113155dbf42aa20e907d2b53950855ec46dd3c2936a0c915e4b920b73cb7fd45f40b0e02f244612f53b43dba61af1c690bb22a74eb8102fe6e456a659dfb17368b9dbffa2d5ce700186722a880b1b9b4789f1253b00bea881b1e478e19fb89130af4806705fc05f77b6e8a3df57f2f99a91c63c04356c6220dc185529c5cc6eeef2630354dddca1aa05fd1b34d5bbf97d09bbe6f2244a27ffafb37de4ba7a3f3147abc1b67c0f7879552539a1405445f70867ab6a036f10f7081ec5f684ebeb48f7b31665033bdf2b7a99c01789847dd0b91ab2454bafa6f054f3cca3358d39065ca1ad2ced47e326e16e98acac763a158da31c7450d06574bee8cfdf0fde760fa03df09f950d8563f1ded6b48d7313aa6727e8f698e62a2d4a295bbc631b3d3d034c03c5ef7980cdca484a969d33fc49a8181e48028dfa271d8531192c417d913968a629faa29885818d1fe678334a8d85a3f4b09605925ed2f56b287c008613f245a7fe704935e937df68bff9bbdf95f662e403c0f27d51e4f5cc02d498ff73af70b59b4a0238d9cc58c1da1c121076dbd68247afab22fd0cdb2131a5706fcff78dee6eb4385f203286b9f115f22313d6081acf470a7a395fe1ffe0c052b4ba400a22af8df99410ed27d5284d2244b78f55d69f78704acd1f961f2e16c961a8dafdb4a98d6a850d92a1abcb12e5b5a5da85acd6e4ef2641647f96e06c88f55155f0e3c2f061fbfcfda2ced6ae08fd32af9aabcdb0399117f1fed51c4c98bd80e6991492947be0f2a7c5bc8ab47049f0b3ec6cf58b235404217daaaf4ae203e1d2bc595a8d1cfe6fb34b7a74930ab12addcb388c73f9aa95dc0011e3116ed231f1c2dcf851e4ea2c7746584a56ca26818b403d4d96c5501c0ea67ebafeba478ce135834d24f5d8c4a655c78930a44d71ba9d245d5bb370177d48144d338edf087bc65659e049c546de61921129b8df86b106b12643e0c1acd304ed88236a0df9c0ce05c5ffa8f6f487b36f012e5b614d23aafaf2a0acf9957c8f32f933cbccded47fbd878f910d66cc4efa1ed267929dad765e724ebc6a564a29bfe028393d0e64907548c73b59c7ba96008aac481fdf0b926b2c1588c5e8d72191d378b2a46a198b2b329907cd8e4365083e776b4a61e5642b208809bcc65c3184b5160ebaf663f4e871b2e0ad993574b12260a7ee9d147d43a17b20de8ed57c7c721081cfc2f34f80e8703e25f7e42eb55fd2bc5155aafc307dc6e8b32a736d4a6477fb5ae6cf74d6b0813573e1f9656577f1e4a679dfffa645445f3746cdb1e7431736fdd049693651de960083410b68f1172bd5d9a265104704b5a74b13d4d6949ac1d7a76ebcb2ea67af8a119ce9d21496747edebdb6f8ae66208ed2733188f5dcd23789ea0fc1c52d2aa3008f9914b103b8540c99c292a64858bff9a81ea8e40373ee648bd69f55dad0ae20adbe6585fc84ed3d4b2182b66026ed4a55c06a12f1548b7926e492adc76e243672496b8e6a109beafc3697ba582a54260290a7a6ec47eeaf68e46c1c04cee11d5c354a90ccdf00dbfc3e1d187e4c4b07edf3ad02b061e5859a03007419ca10a141e02e0d6b4f56bb7c3a37f2bad1d8880eddfcd50089fc855c0b55f0ac6575dc44ec589033c3351c8a45a25bc43c84f7e6efe334c7961584daecb4eb6f2a2d78d93e2e3d10abdce3fd090ec9e0b764d9f956a11ea8f297990cc39f4f43125cb3a5ff82166dfd8b07b508a251faa15c43ccb93ea426369045516cf5c3be90eaaf505251250b2118258afa3f6950335ca05f58b671a628d8b29ff6e5183e50e2e2690e68394e7954bd9d3048ecaa5a88c892d1be7b69999213dbf694251c8721f365746e16f9f795685258e68715b694a876d00307a83b0a4aeb87e06227368aff96cee80863e78b01b3e791736c7ab04299114100b28bd491b1aff5d15124cda21f833b5fe0494ad0e191cbb8e259b91417228e950f2d47ad1caebc662f91a66b8d20a14270fdf8ff82b4031c508ec9cba0eddbbbe06ec7ba38ca6efba7f2051611281dbc505cf99db27cd0a0867d9a6e910095e67b54f74cb6f505c4a0b7df0d07bb4855421c8f2a9dfb2ae64aaef428077d40237f3cab196339124c4195ca5954af982f7e1865d9bd796d75c632c53b119c8742f49ed72f0237b4305c718b7deacd812d38ec4975dcdeda8ebb387e82034e22ffdf6b8c65f3f843c9a20b75dab3acdce7905a9feefdcbd942035b6cfad0cea7997fd254b7ef15a585733015f5e7e584b5ad6c419a5f0b6055e757ca09fa93c3d2f48a577b6a7bfc8eadafefb114961810e5013e68f0089abb7a14df3717c44642f8f4db84126e18fca4b7fdbdf6878a90cf1fd1e6ff58129893461e236bcf5e871109c1403abb320fe5320befec21afc83dbee9752789c3d9468118fc2c0724c01d66bad446a61611ca1440e9ab1c041755a03578c0ebf3ad667d657e70e36e43e137a0afc88734a99f0c7b9a98325e33d9e6c05a3b7d452a924510f99f7c138da9a7d95ffb7ca3b722eecbb49a9c9e02a4d89856598e50b61234c3c488898c66c9cfe55f3f076fecaddc336db4da85be0f3f653ee00fbb723e15e3b17196169b8fc78970b9636f0e36882f76b218543ad0650de1e79ca4f0be460245bfc3552066341cd87daa1f0cd972b9b3fec4370eade0bbc3b4d7cbe13269a86e872b79edabd9b8f10174f73316918ade7a7747e8cad1820ddbc3a8724f3b5ee8865a293b1df94ed8db2617cbeeeb96979c5f13377734fa36d3d01bbbb1ea619a18649b9eb8b3f4b5a9c4d09c72ce2e5d90d1b5e0f7dcdf35d2af5bc29d8bb3f03a408b23b04472e5e7a0b0d61a8e28edef1e1d02dada1040f4b0b057776b94013ba09eaf264eff684fe36745cb42c2920ba41bc963fda371372e3aa76351c95640807132483670ad7048fd115c44f910a6b32d0adb013f6dacb064f8d8ef0635b5be868a7856282dd23e8bed47b9b4c11bfc0d35222f45afd9e85f8522cf5ceb6ebaf4f28151951e5e27db7186f09d7478567356a1c71a1034faa8a8f82ab5b1d2ebfa338db217f50796bdbe32c767e0b90f5bf4f160b1ed2342860cfde2f62cee1ef0582e5e5371b8dde588fc4b5baed2ffac392963d9221cad4265b0c37765648d8e6b6fbfee1d297918f390488bbf6fb125a919e9fbe0af1e554089db6b186b8f40b1d2cab937bddbf776608ea9d5beb36d4a724cdc04bc98e4b0d60b3bab3171e4c849f293a1357e58da830d130a159a039034de77963e6cb840ddbc0e7545026da5b5b1518645580a96043ba3b91726c32a781b4a9c25c54499d84149a91267a15a27923c8fafe9f1f3a896fa589aa06268b025cd823e4098c9b3bf5b4315c3205e6a3c251af89d60c6b89ddf3a27594eb751acb86acd78c22cc241949730faa22a18f9346f60fea8a06a8fb504f0b504014f4e73e45b36c7499a0925ee3887082630f82d09b21beb4b1cfd95174ba62f9f0639b025c3257317154945e8c0b0f5fbf333d055bc6145caa20dfe7d8ad582348e9da1e99b7faca71931c2c1722146c8d94f7afe2531a12b4a60269fbd2308d139bacdab1d2fd01b298f52066c4cb4bd02604211726ab573d2ac0853f74dbab048ae89fc009de711ab2eae9e03069633756143c1c4feade451a8ba3aabcd29bb874ffff0f1e186dcca36f95d05be726f26536e2100be900a5d1bac8e6427871ab019e21b1cfe6e1bb55c32f2df22574f58172bd52566306958703207dd36f016c6be68efccec6bc92466484719370e64f38e6f4c5024e2c873272c48a2cf56e5d5e20f8668b9f241c6149d61c03627113cfcd8104a7f43f3ff0cc2017affdfc8231ecef02793f361372a3875733d7dc3f8d568959ff8ebcaae6deb7d5aa6ea42f601704efda012d8e42351a8434adb6758e0bcce0b906adb4c3a48e49e5687dd20fbd7b94ed5b89eb6fc716c3bfd28226315ef59366a72d9b5bfe159e261775c93a62c097d33e636b874f3018610cc0fbd302300f41daf4f083c6a229e13be8b1bd9620a70e91698e269b9c2ef2cb4b0c8104b49015bdafeed6ef22f6064b844033508cfe3536da5256779b8c8d532c57529071debdeaba8bbbff63003f183c59f0f542763e590fcf23200ea38655edcb843851dc6983fe7f652b961a46642581bf0a9c7d8586587990700bee614ac4e614baec4abc1ebc0f2b35998d8461dd88d2c3308dce8d3505dbcbc61944f4a0058a3b7101e550340786662a924a10c1c5d8cf5e3e2823f185fbf792a1c89f07b4ae49fe7c7585e21428f7780fddb9dd07fa857262f04cc89089cf631677580ab29b77ee080f5bdcc7344e8319968c512654f61969dd7fd11a8462b9c3c82a42fe3fd1468c4d332040eaf6b0c6ac859261e2edfea43e87b20f265617c9cacfbaa733700cf3be4ec907b3d2070d30c42bdeb4c333ebfbe3bd4f837df4bb6c26450071bc2f866df86e0fc89d8da15c14663b575ebe800da4f556be69335e321cba3a9817fd72bb26f292009402da69aa9ab2149d7b93067eafc36761dfdfed066f890f451a7424195a41a3a06c36fc5b137773663825a535f9deb60d4672921b7b5080a4cf5fa7b7d88d531a4e26452b9330d83e49fd00b075954013491213c58ecfef41c7365ca37e4a462993631821d2cddff57bed47d3486a1f75cd15f334373840ae142c984560a5f7fba9fd1a6e2fb2b4e71990ec13f60edbf6375c4fc70a8f093869bc506fe20e2c750d079beff3b539b8a5b438b739f5a29c0483f0aa27495815a9868ea2a6468c0414b9567c4e9f83e4de7c8a5b18d4bb8183ca69b4881f6bb443c4fc4af7977a6f5086f7b9638cf14caa897b7dae96ad05434d8bb8200053883b156069e607558a6643bc806c1123486f5c2378823611c3b3d18eed5cccc8323fb652a7e348c7e466d6e35fa672316dbb566a9bfb7d6eda4172d1659f5f093de90d169ae9c7a2cfe181f3d5d04c6b655180213052e0e64a0aa97c9d63fbfa89fa8e7c99cefb8f30090c962163d9eba48026ed1d1de0cd57ffa5519ff0325efcb1beb0b2e4238968424b52d5d4c9b6ad28e2b8466c83818861a85d5612e1215fa5f607a92cc4164f45ecc8220e233972525e1d821cbeed4e92e5f70d20ea666647c73aa39fa7a0cc64c22ff3a048dbc7dda0820bc91bf76b7290f15d55cca50f2295d0e396f9c90a6c70b6bfb23e3f232285f98d23991757a89f746e987eea203b0dfb8a202a945b0c70f599d9d280f665fb2c4f285d2edadbd1aec6bc567acf3c50e3638bdcc5c27ed7b13a0f5ba3a41b929b86c950e9ab969b8b98c315083655493eaac597699c7effd23d175d59b83cd3beb40028f99a8ec0392f6e537cb18bcef5cf06cf2cefb94424fdd5f1df443145b4ceb9b0bfe031f81a53a3560a8c8635ba0bbdfdc1743be30f5ea8d2fbd6fde43f0775f12796245c23a3740f2ab1da822ac6140eb82190701c07f1f95246bd3cc87daad542ed3bce3dd4045ee678816debd28fc3a5173ecdc183a60e4292c6be37430f97114acb28b156bde44949a852cf5b08212708f1d79df66811c8f8e4cb894ee0c8ddb8f09ece887e3a03ff7ea38d0ed1b31b06905ca283e5ed730852af9491bc77b3890138eae47b5b99f92b59bc49b6441cb8d05871a6b30fc61bd278d32bd5c1bfd2c2952a928aec0200b52c51ac3550a8fa805b00a398d0a0bd23d2d671df164f0961af90976f79dd34adf53701a6b1fe86eca7810643fbdca5b2cd5194856399a4d7c8d62cc5d0fd64d5b11a90bc96226cb0a98959bab65e8197fdbb7f9e4b60768251a0a18e8df35e42c8850212c07f6a3b0232c2b41a7cf493ebae42f591132694f838e0bbff679626a20db63f8b76589b5d708983b0402b1ed654f1f98295052f2b478e9a6a2883400a706a9378ec971a8ae2ff981282198f96b415bd46d7cb1122162786a8369ccc32a13ae05160d2ba6645987a5173d76a862c9069933340a90cced7a6682cf4fb3d457ec7e5ab1d48f3fbccb233ff80ad4ab89607fd68f50292d7322beb2de229c92fc8af14e871c23f7fe64aa70b8c21094d7118268853f4197cda7b64bab08ec42dc401df8689a6873e6416f2268c4fbf1a5c42454fb71b13488d83654613580d37cb5708a8d5a5f9708704bb972a66b33596ae423d546269439720056cfb1359ded1bb3aba377e1cafcfd7b4efd55346818c49c4bb76c6ce680571e3ef430b8ee5bbc8cc3e1a610016709d56aad298a7cd9e7643dcf5a908a16c08e9cc94d789c79ff215d2dea05a4e651396eb81c9f2fbcf13788ebec4b9873978eeb65e82c411a0d567cca22dbd337e8ae50890f80030587624b6e503990551ffebb8b8320783115596f37f98059939415a5edbd8d7f2c2a3c05cc2ef476ee13e24b31436b30b6ff02b2c4fafb1308d47516f861cf64b732ab53364e3395552a95ea4192db7295b046ab734344725e8f3e60cd88e689b912298d27d6b85d362cd2944c90375a5e6785da6dc4b095a347cce8e6e73e1240ad3d68bbed95b525af4c0142fc2be48d0e3d9689030415279423c39d9f1e8c1a81351e3e2ab54d4769b1e02e8baca841ff096a48c66ee9401407e767d832db762f5499a185ebfe6390d59903ad89b373f6a09f97823d92e78534998322cdfeec04f8074e441a4cbd08ad3bcb2341dfd9b9fb824d2ed485e8d6626f62b586714b8162a997bcb04fbb584e55dd6faf5af7c6439b182677ed07f9382abc93f85b1ba6f575f5152bc69d66beffc3dc769f4ead088b97ff6c2fdd6d6e62e2939ae7dff821b661d365ead6dd40d9f784099d62d447fb43adf3c46fbd48c2e1b76ac32c15c3309756283013d55ef146012cee96dbf2e591f33ed868dcae8c3f34742bd8d1e6c8531d1bac80f6689b3698f12ead0c509664c340ddce84a3b1bd085da3718d48a6c92b16e25235051256f8648921057b4f60b7dbc11c37356f2a23fe882a94879b5744bb72033e8efbd811e27ca01eb4fa54dd8afdef3f97440b631398ff4e37651e247c733d7202a8f42669705bb372fa1f4b2cbfeb503c73b7875f39078ab0ba8f8a5edc91aec41c4aa66e70e0aab86e5e63ae5ce8a43c94025c3497cb2ed92428d6b816bce857f5639b1313c367acb0f31b0d71a50dba7bcef572cca0134a799b98cf5c4877cd169746a0b2b0217919090b048c3c218cd7b47eb88c24a054803c7ed71d524b1665ab6868a8f5b3e180c35b3b1cac7e3ad901c0441ece5e39583d9ef270eee1c7626db37efb2c3baf26042bcb909dc8f51b0ecd5b4cb7ecb1bdc8d2631773531585ad91d7a59e3bd45079f101ae509e8af8c7e41fe42a3aa8c5d00226fa159201c2fd2f1b4bd9cf4b2cd9ea3ef6c11053356e5bef93607446065beace5220df6c01bcde6e83c6ecc1027414878ab991e185f0a826c113ec8b1109e613093e2dd0d113199f361427dec47db693848a083402d6d3db9221175bd46579a99e4738cb5da3e564309b49c765d8e80165bd6db901f22d7e9c47fe75bfe71c87821b90356d81d5b9ac4e5e26e0d67719782e615cd8ad4547c0f21c2cea76dbb65b7c24ba8ecdab6eff085bc6c81fa5188b8faac40d6e7ca4de69e2a03ff9b798c2a212deb5ca29c9ab9f859b0ba71f41ae2854084d4430fd679d2aa29fd35746f1c50cfbbbbd13a41e75ee4f424218575f0eb59245a9ceceb11c7f7d01f2eeb33c3133490a0304024cec548e213c0f88582c3cb55cc806e07d854e0708a70925e109019f46b9b8ea39379be83e182a4acbeaa3335d5e3e522dd3d8117da6b617ec02fd80c867e2188bcb943ea0d2494874f5a1d31f43d050a60ddd09b836f09a8c72c4e9773234246ee6726cfe4f1efb24d9dd11199c87d575761afa32b7aeb8a7320ce4c51418b3f3766789267150a36523b56381e4373d2a77d76e39f0ad0825cc8fa4fca84b4721980d44f2a04a456a9b0d409f277df3d92e5bc5b7ac933d0fdc653c378d436d8025c718308584dfff618a23f516542c1572c9766e829fd302c659217df09f24d7f3e8112fe7ba4c01f5c65e438da9a9c4dddbe841256cf9bcc0fd41fad0f5a979a9ff11a4570d930eef7c58480abaa06539fb9a07459fddcdd47843258adef2f359748b5d3c88419e1648364474c6c5c7983eddd35044f59c35b7a858e7b60e1cf6d9c1daf1cfbf80a6b54f7c6428606d8ca1da6e72180fda2da3d3dd5cf38939f23ab5b4dcdd85691e4559a3cd55e2b0a11ea4f33a1bc38ab0be5992a3cb930c1fb01a6c07286f9c1a4a75a93c82fc9e59c25dcea0e6159112bc1de80f0291c8cdea18fb6f3432c278a6754818f9b47ac75af30d899045428cd4b118879b1a6354c5b77fc0e4bdd2c79fcd66e29e1a09fd4e991a13ebdd5da40c24fc96bc6be1124ba16c2ffbdbbb27abd6018f4e40039098ba3219b933e07f01e4cce5f9bf778a1a95cfaa1e36fb843ba2194203e9138f7911ce11ebbf2fbaf96bddfcafbc646e5a8a7150c80c68f86bd8ffc2c2853470ed4436ad122a3ae372a94078648cb9c55ce81b0cbdd520cee84441aa49a67a26f1c32fd6b1fbe42d7cbfcd4c8cf396d977adb09af2b581c128aebcd5f358514b24df5aae85c13b890c97009a513ed2e05c72c053a759becd2d231b42077c9b8d2a34b01e778bd1cc77806dd97fa60790319808eaea271184e3665c686e6768c141a00f5f48bf67c3cfdad94d2a06239cb0d72e9f0c26c3d59cb8c0f7da03404da0d1c62cc1218fe619a200c86add19b831fcb438752e82efd7fe212f9ce0e0e04bc5d0eefe31f994f843048ee1011b8eae825788d14db2283e8f2cdfc805022ee290140ab39aae0c9f3ee0520e4fba9a4147337d4b11b71c5e0a13413d3041344b9d46d9af45ee10bee31468db33e95d2189967c9cd800c5344d56ff26b35161c13861d9ae69e49a8c22be2768cd9c18412c9d6489a0ff2744d03bff63d67e2f9d5bf0ebe0dd436ecf6d82ccb0b7b6ad59cf4c61afd44bb4bbac7f4fc99e7f8b6dace954e04063ba25ebb1575c5d2d22e2c997be994257c5bf9a81cab2227e06104baea43202a017a25276dd21ea013a8bee232c12d02235236098b051d1aae090894af9cbf60d3a5a59436fe1be09408f9a61d19df70cd0c1e8155820ea834c8335356653f1c5fab6010029617451e5f4f16f82e1635e35fd6c3bafa8e15f44f1c79e4679efa45dc1df1befd72ecc508b6512a46c6cfe2fdb46be273576b1a8e7254edf040deee4dd1f96639a6b53e18295fbaaa396338d6b6ec7cdc3efe855c4d7f17ea93a28c8482984cd7dd6f0a71144cdfe1cf84c8fa087b936496e7806dd4c7a4139ed54bbb597eafb70800eae242d495a29cfea0294268b76bafd8b35201e7c0dfd569743e4616ca061a09ffb79eb0a08fda743276a92e3a7c9004f8ce1a29f20152ec39c94598a5986e224e1bc70c9a0aced0e04b4f38ae10482ba003bc94be9c9202c897b2aafb45b5d5c0cfcfccd7148ba4fa82aa6598cb476df7797d70a2af5f60248f54be3be6eb37c62d31afea58a37d3e450c5d68570b9b91be937930611d099981c952e4cd467a9fd46e2fdf276d07c7973d9e3ebd256420380294dad8eaf2271c0909247db8e51889a93732956bc9e978eb19bf545da594a9658d4fba6eb789e87ea4263fcf8a7cec6f47c9088b5dafa451a88172e9d39e08c215d7e4933f29542a90dcebf5fc35309ed9946da78b66ad372ef0118ea8f1d28c6fd958d81016720b6db227a9d921f1a61d0f8e92f9f18d16d278cc9d116dcc60849d416fa6c6c0c5d74d163457d3e228b47241455dd7a666371a09497498ebc67034cbc1a5c20875e3e7f7b2060907e3991ae2637317e6314b199304fbdf8e1e1d95b018664c27f4bd70c2879f70fc8c62557284a3ab79fa1bd1d72a4c3b233cc800189bfbd8a0d8b52a735e9c2a018dd2c107d4753d421f28a2e18bf15427dd4755552b4682718c40d333d2fc503a78b7e362046e1c3c80b19aa88deea31b719eabd332f46971060b52c2320d8030f4e5f22aba186099d4e7603557e357dd36f2ceb061c8cc1173e4e30fd25058508200a3d5ce324d3deb029f6fe5f0ca067ba7f49864091691d7a63739b5dbc5c5538435cad258396fd200a9bd8c45ce73fcb4f944a7832d614c8a887053ee0b68f6ad667130f21a120b30d3490b798b4dbbf6022fbf606eba76566263ef81d4725b91d80defabdff20d83d56da8d7f47ad6eb9232c5c208984f2528b89e2eaf37d4b2af0b4d49702a827b1a632340668c5010e4307fdf6c976e3082a78333639f4e2e3f9e9035582d504bde09aae422048dadb98f1f0ed2ffb1ec0ba1489bf9a7b0bbebf2673f015c1087b6ddaeb8fa671c078a4474aba448b3ae9b292cc672f0e83526387cff838aecb6fc11a3137efcdde1af9c1166a22138cf205eb9810bef2658e634b1c34fa31809024e86845b1ef7671ad4852601dd223bbde354955c72462d072ff3c23f3ece9fd6c078c3cb15b8610d2264df05563bc49604bdd0832012fd8a94c40ceed902642fa2368b52f960dd32d60453cbd1f936b446a9183a53f539acd32f36432d716051c17443f5d445faaae6a5f2c01a20f1c0d69e1056a4236b0aa3d5e5d920557da2f4c4fb7d6734c41042d434c5e91c509f5827ddf5a53a5592851ead56d8d5c8229065a26bd05e9bc04b8bda70756cf86fdd944ce37201a00893b4762b5a341cb91e0e4b692afe75e6e582a7e25b23e4d8359482bb4483acfef52de65f201192b844eef11ff365baf19ef90051a940e178c4e4dd1215810170dc9989e18a89439895ea83376e24d94dfc227e520e140098d83f3868cf16957cc8386151f94c8192f9c705641837c4e12d2a712e099dd290a283578aec6f68f7a26b023581b7113ee265b66e7cdb53dc08c6d5fba517b166d5dcaacb8343c9f76e531196844a1ea8230bb5e17e27e64752e01f797ab2742f18a546f1d4ccf9a804e62c428931069b8fe08987e53f15dfd5ad8676fdf8c8ba577b1c0f44c12863d7decb980d308e8daf6cbc28b81412e3301938049f13aa024fa26b95bf38b867ed975414d6a2a62776ad1ffcaec5210316be8bbdf6d9adff966f0d2d48dac9bd258734cb5f519d1bc68e5be51982d1fdfba33e33a8e2b30a67347e5e6c268984fe5e779c7934d7c1ff7ea14fb653ee1ffabfb843f8f1f6d7b03f1f042dd6d77f2b4c7500d6d83727e5e11aaf5fa87f89f6d338fdc210eea8534cc4f1cd4c114043f99d7c0c1cdbe624847635efb70bf98fcfd86b209912eeb3eb3e91eb02cf8136eba40da8e9d8d27a91cf45202eab30b45c654e576f538a4db074fc0ca9401806a8c00fd0cd55110ac23b97f2809543c1796a4a8351d324e9eb6eb5fda900c153215ce4afe967687b0ff6d8e535eabfa06880b3d095e376b796f7303694379cf421406f5ae3376c97f4e460d9b2e4ace453bf9ea487c4d5a8116228fe149ee3029dd3a467d49def13a8b9c388546b025f7b9b510cac61622c5185aa068b8c59f71f9b132798037348a29589ecee91da15ec846d5a1b665a7c5b5391a4fd9d9521506c8dde0d1efaff771f724b7f59a7d294bd395891b3fa25094f9bd81679fd87d129af9531807274adf5d1bfdcc62cd44b792862369002a29c7e1db4f8ccde1fb4cc1508de07de617bada66c5e2718966cdb9447fccfe72c009c25efda0dc6e555074fa6a0c5908476192411ba80d0150bd72f349c6410479fb2224e733c17bbd5deb31f0cf121dec2c0b06ba8598ad30511288f870d3d8b1e9370d6e24e10197ac6e6b6e21e7d10c4c5937a83d77a876fa8c2047f88dc8ff21ec05230cfd7bf63797ffa70965aaea8ca04162fdba234ab0bd23e4fad790148d6ae121f8bd6e5b0fe89db5ec5befb9ebac877c0fa6e5cff78b8a611c04ea450ad91c00dcb6a19944ec477f83e324ffc6c60872353de33d48136b5a0f59c07b37aa6787911c686ded6582fc7155a27b44cead4a0d8e6ff6d8eae5962a9d67a52beee7fc6bd04bf175d0cfeb140fdd171ffe0c87d787933db17d483989e91b1e733cccc6003e42b05f92cf78597c76553eaa6c3f782875efb5e00057f5386bbf556198d68b80ce2c94067001d132849d67c4e4a4de7bdf4ca2c3c55502f2d9dd7a56126296f0217bfdb3dae58ed81d2348ae1a41d927cf5353f1bdae55c86f45a87a1d8cfa73e5d20b111320014ef4447d26c1989ecab5aec3912d5168358129ffd8d21ff308d8de635995c934af2f8b8a8f578a6b728436520887c2fe078c0e38a1b27edfd5c9c31c0538facce4e8d2c2f832a489baeba85c8ace35fcf61c43b55a92044f7030d62e0ece71139d6650fb8219c318c6d8a20a18c202fbd8423ef3c910bdd50b738c9b03df7860c5372cb634a0153294f1e870945a98eecd9521c3897e69bb3c5dde900ab8ea5d75a2ef0df2b565f82894806cc844f81959b97f58fdc63bbd5ea9f4db530d2cdd1d12800572ca12ef8e0f26eb036522ebbbfdaf5dd5b6bcdbc651d92f075b0e2be7ca785d425d63e5ef1e0ffeb4ea0b7d808a4dc3cb7b0b399b38042eae468861e63bd58d00ab8a7afe02a3344336e6be9c6091ca4849f3adfd6cde4fd3fc63d2c220c9ef83e3701a98f4d9546a361711b77f8f3590bec48ed4e5ba1b01cc38e6f9b66f4ed4a27e427468b8f2ec9cbe831529cb5a42af9fcf691cef4b4c08fd95143b434d37364a6cd085ad39d4ca0ab6f35a7476cbb70cd7fabc2530cef69bbe342adb8bd1d9a6ddf60cd81920faec6c204cafc04ed0aad543375de9c3e819efeb7f1014fbe702af7ef127f2da64db0b11847f8148872d1c6dfd2383c2ab208fa0481b89477681fe684c7c43b7bf3a88a4d233206f0cf3170b5d6d1165879a0cde7d1e6645a4a6554c12e149186d19edce4552dc517d15435c13378cf69d9b00a2586683cd131a94ee890a55cc7cd2cccca6d040a738f2eee7d5bf3435c65921be1466d26239f57ecf61b4afdcd3ec93057fad96237d3a977006082d83515a2653e4caf1c71b61101bde103fee7d28f993c2453dade99cf49617018032defbb18de80c57ffb346fc45eb963ab5ac4f11ee01d1336c5059f21eaac45eb394864a51c14e4bb1dd25f89419120d9bafb12b87a41996afccb2696c08a6f95a0615726ac585eecf379614eb3202370e4e55f906a0b1d0ad4192a3fa33e9ad61d5e967b86bca249bba2d77c9b9b703f8fbd0aacfb","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"db2470865aa068691185dcd60d0115ec"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
