<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="zh-cn"><head><meta charset="UTF-8"><meta name="copyright" content="(C) 版权 2024"><meta name="generator" content="DITA-OT"><meta name="description" content=""><title>vbscript基础</title><link rel="stylesheet" type="text/css" href="../../commonltr.css">
<link rel="stylesheet" type="text/css" href="../../common-extended.css"></head><body id="Vbscript基础-350BDBA8"><main role="main"><article role="article" aria-labelledby="ariaid-title1">
<h1 class="title topictitle1" id="ariaid-title1">vbscript基础</h1>


<div class="body conbody"><p class="shortdesc"></p>
<p class="p">一，概述</p>
<p class="p">VBScript 与www浏览器集成在一起。开发者可以免费使用 VBScript 源(Microsoft 为 32 位 Windows&amp;#174;
API、16 位 Windows&nbsp;API&nbsp;和 Macintosh&amp;#174; 提供 VBscript 的二进制实现程序)实现程序。VBScript(Microsoft
Visual Basic Scripting Edition)广泛应用于 Ms&nbsp;IE(客户端脚本)和 Ms&nbsp;IIS(服务器脚本)。它易学易用，和VB/VBA互通。</p>
<p class="p">它使用 Windows 脚本与宿主应用程序对话。使用 Windows 脚本，浏览器和其他宿主应用程序不再需要每个脚本部件的特殊集成代码。Windows
脚本使宿主可以编译脚本、获取和调用入口点及管理开发者可用的命名空间。通过 Windows 脚本，语言厂商可以建立标准脚本运行时语言。Microsoft提供
VBScript的运行支持，并与其它组织协商定义 Windows 脚本标准以使脚本引擎可以互换。Windows 脚本可用在Ms IE和
Ms IIS中。VBScript 和 Windows 脚本也可以在其他应用程序中作为普通脚本语言使用。</p>
<p class="p">二，基本语法规则</p>
<p class="p">１，VBS的开始标记：VBS块可以出现在&nbsp;HTML&nbsp;页面的任何地方（BODY 或 HEAD 部分之中）。然而最好将所有的一般目标脚本代码放在
HEAD 部分中，以使所有脚本代码集中放置。这样可以确保在 BODY 部分调用代码之前所有脚本代码都被读取并解码。其它脚本代码尽量遵循[ASP的代码分离]的原则。</p>
<p class="p">A:大多数脚本代码在 Sub 或 Function 过程中，仅在其他代码要调用它时执行：</p>
<p class="p">＜SCRIPT LANGUAGE=<strong class="ph b">"VBScript"</strong>&nbsp; &nbsp; &nbsp; ＜!--<strong class="ph b">'注释标记，避免不能识别&lt;SCRIPT&gt;的浏览器暴露代码。</strong>&nbsp; &nbsp; VBS语句 &nbsp; &nbsp; &nbsp; --&gt;<strong class="ph b">'注释标记</strong> &nbsp; &nbsp;
＜/SCRIPT&gt; &nbsp; &nbsp; &nbsp; 例： &nbsp; &nbsp; &nbsp; ＜HTML&gt; &nbsp;
&nbsp; &nbsp; ＜HEAD&gt;＜TITLE&gt;简单的首页＜/TITLE&gt; &nbsp; &nbsp; &nbsp; ＜SCRIPT
LANGUAGE=<strong class="ph b">"VBScript"</strong> &nbsp; &nbsp; &nbsp; ＜!-- &nbsp; &nbsp;
&nbsp; <strong class="ph b">Sub</strong> Button1_OnClick &nbsp;   　　 MsgBox <strong class="ph b">"Hello, world!"</strong> &nbsp; &nbsp; &nbsp; <strong class="ph b">End</strong> <strong class="ph b">Sub</strong> &nbsp; &nbsp; &nbsp;
--&gt; &nbsp; &nbsp; &nbsp; ＜/SCRIPT&gt; &nbsp; &nbsp; &nbsp; ＜/HEAD&gt; &nbsp;
&nbsp; &nbsp; ＜BODY&gt; &nbsp; &nbsp; &nbsp; ＜H3&gt;简单的首页＜/H3&gt;＜HR&gt; &nbsp;
&nbsp; &nbsp; ＜FORM&gt;＜<strong class="ph b">INPUT</strong> NAME=<strong class="ph b">"Button1"</strong> <strong class="ph b">TYPE</strong>=<strong class="ph b">"BUTTON"</strong> VALUE=<strong class="ph b">"单击此处"</strong>＜/FORM&gt; &nbsp; &nbsp; &nbsp;
＜/BODY&gt; &nbsp; &nbsp; &nbsp; ＜/HTML&gt;</p>
<p class="p">B:可在程与函数外如在窗体中嵌入脚本代码以响应窗体中按钮的单击事件。该代码仅在页面加载时执行一次。这样就实现客户端脚本一些功能(可在加载页面时初始化数据或动态改变外观等)</p>
<p class="p">例一：代码直接加到控件标签中：</p>
<p class="p">＜INPUT NAME=“Button1” TYPE=“BUTTON” VALUE=“单击此处” OnClick='MsgBox
“Mirabile visu.”'&gt; '只要用冒号 (:) 分隔语句，就可以使用多条语句</p>
<p class="p">例二：代码加到＜script&gt;标签中：</p>
<p class="p">＜FORM NAME=<strong class="ph b">"Form1"</strong> &nbsp;   　　 ＜<strong class="ph b">INPUT</strong> <strong class="ph b">TYPE</strong>=<strong class="ph b">"Button"</strong> NAME=<strong class="ph b">"Button1"</strong> VALUE=<strong class="ph b">"单击"</strong> &nbsp; 
  　　＜SCRIPT <strong class="ph b">FOR</strong>=<strong class="ph b">"Button1"</strong> EVENT=<strong class="ph b">"onClick"</strong> LANGUAGE=<strong class="ph b">"VBScript"</strong> &nbsp;      　　 MsgBox <strong class="ph b">"按钮被单击！"</strong> &nbsp;    　　＜/SCRIPT&gt;
&nbsp; &nbsp; &nbsp; ＜/FORM&gt;</p>
<p class="p">２，数据类型</p>
<p class="p">VBS只有一种特殊的数据类型Variant，根据最适用于其包含的数据信息类型（子类型）的方式进行操作。如用于数字上下文中时作为数字处理，用于字符串上下文中时作为字符串处理。</p>
<p class="p">子类型：Empty（0或者””) ，Null(不包含任何有效数据) ，Boolean，Byte，Integer，Currency，Long，Single，Double，Date
(Time)，String，Object，Error</p>
<p class="p">３，变量：</p>
<p class="p">显式声明变量： Dim 语句、Public 语句和 Private</p>
<p class="p">隐式声明变量：是不良编程习惯，可用 Option Explicit 防止</p>
<p class="p">变量的作用域由声明它的位置决定。如果在过程中声明变量，就是过程级变量，只有局部作用域，相当于临时存储空间，存活期仅是该过程运行的时间，变量随过程结束而消失。因此可在不同过程中使用同名的局部变量。如果在过程之外声明变量，则该变量可以被脚本中所有过程所识别，称为Script级变量，具有脚本级作用域。存活期从被声明的一刻起，直到脚本运行结束。</p>
<p class="p">变量赋值：变量 = 要赋的值</p>
<p class="p">数组变量（维数⇐60）：相对单值的标量变量而言。</p>
<p class="p">Dim aryArray(10)　定义大小11的数组</p>
<p class="p">Dim aryMyArray()　动态定义数组，随后必须要有ReDim定义大小</p>
<p class="p">ReDim aryAnotherArray()　动态定义数组</p>
<p class="p">ReDim aryMyArray(25)　将动态数组初始大小设置为 25</p>
<p class="p">ReDim Preserve aryMyArray(30)重调大小为30并保留数组原内容。</p>
<p class="p">４，常量：</p>
<p class="p">创建用户自定义常数并给它们赋原义值。例如：</p>
<p class="p">字符串型常数：Const conMyString = “这是一个字符串。”</p>
<p class="p">数值型常数：Const conMyAge = 49</p>
<p class="p">日期时间文字：Const conCutoffDate = #6-1-97#</p>
<p class="p">最好用con作常量前缀或将常量所有字母大写。以区别于变量。</p>
<p class="p">５，运算符：按优先级顺序排列</p>
<p class="p">算术运算符：求幂 ^ 负号 - 乘 * 除 / 整除 \ 求余 Mod 加 + 减 - 字符串连接 &amp;</p>
<p class="p">比较运算符：等于 = 不等于 &lt;&gt; 小于 &lt; 大于 &gt; 小于等于 ⇐ 大于等于 &gt;= 对象引用比较 Is</p>
<p class="p">逻辑运算符：逻辑非 Not 逻辑与 And 逻辑或 Or 逻辑异或 Xor 逻辑等价 Eqv 逻辑隐含 Imp</p>
<p class="p">6，条件语句</p>
<p class="p">Ａ，If语句：通用判断</p>
<p class="p">　　<strong class="ph b">If</strong> ... <strong class="ph b">Then</strong> &nbsp; &nbsp; &nbsp; 　　　 ...  &nbsp;
&nbsp; &nbsp; 　　<strong class="ph b">ElseIf</strong> ... <strong class="ph b">Then</strong> &nbsp;       　　... 
&nbsp; &nbsp; &nbsp; 　　<strong class="ph b">ElseIf</strong> ... <strong class="ph b">then</strong> &nbsp;      　　
...  &nbsp; &nbsp; &nbsp; 　　<strong class="ph b">Else</strong> &nbsp;       　　...  &nbsp;
&nbsp; &nbsp; 　　<strong class="ph b">End</strong> <strong class="ph b">If</strong></p>
<p class="p">Ｂ，Case语句：用于同条件多结果判断</p>
<p class="p">　　<strong class="ph b">Select</strong> <strong class="ph b">Case</strong>...  &nbsp; &nbsp; &nbsp; 　　　<strong class="ph b">Case</strong> <strong class="ph b">" ... "</strong> &nbsp; &nbsp; &nbsp; 　　　　...  &nbsp; &nbsp; &nbsp;
　　　<strong class="ph b">Case</strong> <strong class="ph b">" ... "</strong> &nbsp; &nbsp; &nbsp; 　　　　...  &nbsp;
&nbsp; &nbsp; 　　　<strong class="ph b">Case</strong> <strong class="ph b">Else</strong> &nbsp; &nbsp; &nbsp; 　　　　...
 &nbsp; &nbsp; &nbsp; 　　<strong class="ph b">End</strong> <strong class="ph b">Select</strong></p>
<p class="p">7，循环语句：</p>
<p class="p">Ａ，Do…Loop： 当/直到 条件为True/False时循环。</p>
<p class="p">　　<strong class="ph b">Do</strong> <strong class="ph b">While</strong>/<strong class="ph b">Until</strong> ... &nbsp; &nbsp; &nbsp;
　　　　...  &nbsp; &nbsp; &nbsp; 　　　　<strong class="ph b">If</strong>...<strong class="ph b">Then</strong> <strong class="ph b">Exit</strong> <strong class="ph b">Do</strong>　<strong class="ph b">'用于防止死循环</strong> &nbsp; &nbsp; 　　<strong class="ph b">Loop</strong> (<strong class="ph b">While</strong>/<strong class="ph b">Until</strong>)</p>
<p class="p">Ｂ，While…Wend： 当条件为 True 时循环。缺少灵活性。不建议使用。</p>
<p class="p">Ｃ，For…Next： 指定循环次数，使用计数器重复运行语句。</p>
<p class="p">　　<strong class="ph b">Dim</strong> j &nbsp; &nbsp; &nbsp; 　　<strong class="ph b">For</strong> j = 2 <strong class="ph b">To</strong> 10 <strong class="ph b">Step</strong> 2 &nbsp; &nbsp; &nbsp; 　　　　...  &nbsp; &nbsp; &nbsp;
　　　　<strong class="ph b">If</strong>...<strong class="ph b">Then</strong> <strong class="ph b">Exit</strong> <strong class="ph b">For</strong>　<strong class="ph b">'用于防止死循环等出错</strong> &nbsp; &nbsp; 　　<strong class="ph b">Next</strong></p>
<p class="p">Ｄ，For Each…Next：对于集合中的每项或数组中的每个元素，重复执行一组语句。这在不知道集合中元素的数目时非常有用。</p>
<p class="p">&nbsp; &nbsp; <strong class="ph b">Sub</strong> cmdChange_OnClick &nbsp;    　　<strong class="ph b">Dim</strong>d<strong class="ph b">'创建一个变量</strong>    　　<strong class="ph b">Set</strong> d = <strong class="ph b">CreateObject</strong>(<strong class="ph b">"Scripting.Dictionary"</strong>) &nbsp;   　　 d.Add <strong class="ph b">"0"</strong>, <strong class="ph b">"Athens"</strong><strong class="ph b">'添加键和项目</strong>   　　
d.Add <strong class="ph b">"1"</strong>, <strong class="ph b">"Belgrade"</strong> &nbsp;    　　d.Add <strong class="ph b">"2"</strong>, <strong class="ph b">"Cairo"</strong> &nbsp; &nbsp; &nbsp;    　　<strong class="ph b">For</strong> <strong class="ph b">Each</strong> I <strong class="ph b">in</strong>d<strong class="ph b">'I不用Dim定义</strong>       　　 Document.frmForm.Elements(I).Value
= D.Item(I) &nbsp;   　　 <strong class="ph b">Next</strong> &nbsp; &nbsp; &nbsp; <strong class="ph b">End</strong> <strong class="ph b">Sub</strong></p>
<p class="p">8，过程：</p>
<p class="p">A，定义：</p>
<p class="p">Sub过程:不返回值。sub xxx()/(a,b,c)…end sub</p>
<p class="p">Function过程：返回一个Variant值。function xxx()/(a,b,c)…end funciton</p>
<p class="p">B，调用：</p>
<p class="p">可用call xxx(a,b,c)调用，也可直接xxxx a,b,c</p>
<p class="p">9, 自定义对象:</p>
<p class="p">一个服务器脚本可以生成和使用对象，生成一个活动服务器组件的实例，对象是状态和操作的组合，状态由一套属性定义而操作则由一套方法定义。类(
class )是你用来生成对象的模板， 由模板定义属性和方法。</p>
<p class="p">A，定义对象：CreateObject 函数生成一个对象并返回一个该对象的引用， 格式如下：class是所生成对象的类</p>
<p class="p">CreateObject( class )</p>
<p class="p">B，使用对象：</p>
<p class="p">格式为：application是应用程序的名字，而className是类的名字。</p>
<p class="p">application.className</p>
<p class="p">如果你要用Set语句把一个对象的引用赋给一个变量，格式为：VarName是含有对象引用的变量名。</p>
<p class="p">Set VarName = CreateObject(Class)</p>
<p class="p">三，Microsoft Visual Basic Scripting Edition编码规范</p>
<p class="p">使用一致的编码规范可使脚本或脚本集的结构和编码样式标准化，而易于阅读和理解，更加直观且与其他语言约定保持一致。</p>
<p class="p">对象、变量和过程的命名规则</p>
<p class="p">注释约定</p>
<p class="p">文本格式和缩进指南</p>
<p class="p">１，常数命名规则</p>
<p class="p">旧版本以变量形式实现常量，命名规范用：USER_LIST_MAX</p>
<p class="p">新版本用Const语句创建真正的常数。命名规范用：大小写混合的格式，并以“con”作为常数名的前缀。例如：conYourOwnConstant</p>
<p class="p">２，变量命名规则</p>
<p class="p">为提高易读和一致性，请在 VBScript 代码中使用以下变量命名规则：</p>
<table class="table"><caption></caption><colgroup><col><col><col><col><col><col></colgroup><tbody class="tbody">
<tr class="row">
<td class="entry" rowspan="1" colspan="2"><p class="p">子类型</p></td>
<td class="entry" rowspan="1" colspan="2"><p class="p">前缀</p></td>
<td class="entry" rowspan="1" colspan="2"><p class="p">示例</p></td>
</tr>
</tbody></table>
<table class="table"><caption></caption><colgroup><col><col><col><col><col><col></colgroup><tbody class="tbody">
<tr class="row">
<td class="entry" rowspan="1" colspan="2"><p class="p">Boolean</p></td>
<td class="entry" rowspan="1" colspan="2"><p class="p">bln</p></td>
<td class="entry" rowspan="1" colspan="2"><p class="p">blnFound</p></td>
</tr>
</tbody></table>
<table class="table"><caption></caption><colgroup><col><col><col><col><col><col></colgroup><tbody class="tbody">
<tr class="row">
<td class="entry" rowspan="1" colspan="2"><p class="p">Byte</p></td>
<td class="entry" rowspan="1" colspan="2"><p class="p">by</p></td>
<td class="entry" rowspan="1" colspan="2"><p class="p">bytRasterData</p></td>
</tr>
</tbody></table>
<table class="table"><caption></caption><colgroup><col><col><col><col><col><col></colgroup><tbody class="tbody">
<tr class="row">
<td class="entry" rowspan="1" colspan="2"><p class="p">Date(Time)</p></td>
<td class="entry" rowspan="1" colspan="2"><p class="p">dtm</p></td>
<td class="entry" rowspan="1" colspan="2"><p class="p">dtmStart</p></td>
</tr>
</tbody></table>
<table class="table"><caption></caption><colgroup><col><col><col><col><col><col></colgroup><tbody class="tbody">
<tr class="row">
<td class="entry" rowspan="1" colspan="2"><p class="p">Double</p></td>
<td class="entry" rowspan="1" colspan="2"><p class="p">dbl</p></td>
<td class="entry" rowspan="1" colspan="2"><p class="p">dblTolerance</p></td>
</tr>
</tbody></table>
<table class="table"><caption></caption><colgroup><col><col><col><col><col><col></colgroup><tbody class="tbody">
<tr class="row">
<td class="entry" rowspan="1" colspan="2"><p class="p">Error</p></td>
<td class="entry" rowspan="1" colspan="2"><p class="p">err</p></td>
<td class="entry" rowspan="1" colspan="2"><p class="p">errOrderNum</p></td>
</tr>
</tbody></table>
<table class="table"><caption></caption><colgroup><col><col><col><col><col><col></colgroup><tbody class="tbody">
<tr class="row">
<td class="entry" rowspan="1" colspan="2"><p class="p">Integer</p></td>
<td class="entry" rowspan="1" colspan="2"><p class="p">int</p></td>
<td class="entry" rowspan="1" colspan="2"><p class="p">intQuantity</p></td>
</tr>
</tbody></table>
<table class="table"><caption></caption><colgroup><col><col><col><col><col><col></colgroup><tbody class="tbody">
<tr class="row">
<td class="entry" rowspan="1" colspan="2"><p class="p">Long</p></td>
<td class="entry" rowspan="1" colspan="2"><p class="p">lng</p></td>
<td class="entry" rowspan="1" colspan="2"><p class="p">lngDistance</p></td>
</tr>
</tbody></table>
<table class="table"><caption></caption><colgroup><col><col><col><col><col><col></colgroup><tbody class="tbody">
<tr class="row">
<td class="entry" rowspan="1" colspan="2"><p class="p">Object</p></td>
<td class="entry" rowspan="1" colspan="2"><p class="p">obj</p></td>
<td class="entry" rowspan="1" colspan="2"><p class="p">objCurrent</p></td>
</tr>
</tbody></table>
<table class="table"><caption></caption><colgroup><col><col><col><col><col><col></colgroup><tbody class="tbody">
<tr class="row">
<td class="entry" rowspan="1" colspan="2"><p class="p">Single</p></td>
<td class="entry" rowspan="1" colspan="2"><p class="p">sng</p></td>
<td class="entry" rowspan="1" colspan="2"><p class="p">sngAverage</p></td>
</tr>
</tbody></table>
<table class="table"><caption></caption><colgroup><col><col><col><col><col><col></colgroup><tbody class="tbody">
<tr class="row">
<td class="entry" rowspan="1" colspan="2"><p class="p">String</p></td>
<td class="entry" rowspan="1" colspan="2"><p class="p">str</p></td>
<td class="entry" rowspan="1" colspan="2"><p class="p">strFirstName</p></td>
</tr>
</tbody></table>
<p class="p">３，变量作用域前缀</p>
<p class="p">变量应定义在尽量小的作用域中。在类型前缀前面添加一个单字符前缀可以实现快速区分变量的作用域，而不致使变量名过长。</p>
<p class="p">作用域 　前缀 　示例</p>
<p class="p">过程级 　无 　　dblVelocity</p>
<p class="p">Script级 s 　　sblnCalcInProgress</p>
<p class="p">４，描述性变量名和过程名</p>
<p class="p">变量名或过程名的主体应使用大小写混合格式，并且尽量完整地描述其目的。另外，过程名应以动词开始，例如 InitNameArray
或 CloseDialog。</p>
<p class="p">对于经常使用的或较长的名称，推荐使用标准缩写以使名称保持在适当的长度内。通常多于 32 个字符的变量名会变得难以阅读。使用缩写时，应确保在整个脚本中保持一致。例如，在一个脚本或脚本集中随意切换
Cnt 和 Count 将造成混乱。</p>
<p class="p">５，对象命名规则</p>
<p class="p">下表列出了 VBScript 中可能用到的对象命名规则（推荐）：</p>
<p class="p">对象类型　　前缀　　示例  &nbsp; 3D面板　　　pnl　　pnlGroup  &nbsp; 动画按钮　　ani　　aniMailBox
 &nbsp; 复选框　　　chk　　chkReadOnly  &nbsp; 组合框、 &nbsp; 下拉列表框　cbo　　cboEnglish
 &nbsp; 命令按钮　　cmd　　cmdExit  &nbsp; 公共对话框　dlg　　dlgFileOpen  &nbsp;
框架　　　　fra　　fraLanguage  &nbsp; 水平滚动条　hsb　　hsbVolume  &nbsp; 图像　　　　img　　imgIcon
 &nbsp; 标签　　　　lbl　　lblHelpMessage  &nbsp; 直线　　　　lin　　linVertical 
&nbsp; 列表框　　　lst　　lstPolicyCodes  &nbsp; 旋钮　　　　spn　　spnPages  &nbsp;
文本框　　　txt　　txtLastName  &nbsp; 垂直滚动条　vsb　　vsbRate  &nbsp; 滑块　　　　sld　　sldScale</p>
<p class="p">６，代码注释约定</p>
<p class="p">所有过程的开始部分都应有描述其功能的简要注释。这些注释并不描述细节信息（如何实现功能），这是因为细节有时要频繁更改。这样就可以避免不必要的注释维护工作以及错误的注释。细节信息由代码本身及必要的内部注释来描述。</p>
<p class="p">当传递给过程的参数的用途不明显，或过程对参数的取值范围有要求时，应加以说明。如果过程改变了函数和变量的返回值（特别是通过参数引用来改变），也应在过程的开始部分描述该返回值。</p>
<p class="p">过程开始部分的注释应包含以下区段标题。相关样例，请参阅后面的“格式化代码”部分。</p>
<p class="p">区段标题 注释内容</p>
<p class="p">目的 过程的功能（不是实现功能的方法）。</p>
<p class="p">假设 其状态影响此过程的外部变量、控件或其他元素的列表。</p>
<p class="p">效果 过程对每个外部变量、控件或其他元素的影响效果的列表。</p>
<p class="p">输入 每个目的不明显的参数的解释。每个参数都应占据单独一行并有其内部注释。</p>
<p class="p">返回 返回值的解释。</p>
<p class="p">请记住以下几点：</p>
<p class="p">每个重要的变量声明都应有内部注释，描述变量的用途。</p>
<p class="p">应清楚地命名变量、控件和过程，仅在说明复杂细节时需要内部注释。</p>
<p class="p">应在脚本的开始部分包含描述该脚本的概述，列举对象、过程、运算法则、对话框和其他系统从属物。有时一段描述运算法则的假码是很有用的。</p>
<p class="p">７，格式化代码</p>
<p class="p">应尽可能多地保留屏幕空间，但仍允许用代码格式反映逻辑结构和嵌套。以下为几点提示：</p>
<p class="p">标准嵌套块应缩进 4 个空格。</p>
<p class="p">过程的概述注释应缩进 1 个空格。</p>
<p class="p">概述注释后的最高层语句应缩进 4 个空格，每一层嵌套块再缩进 4 个空格。</p>
<p class="p">下列代码符合 VBScript 编码规范。</p>
<p class="p">'*********************************************************<strong class="ph b"> </strong>' 目的：在 UserList 数组中<strong class="ph b"> </strong>'          定位指定用户的首次出现。<strong class="ph b"> </strong>' 输入：strUserList()：要搜索的用户列表。<strong class="ph b"> </strong>'         strTargetUser：要搜索的用户名。<strong class="ph b"> </strong>' 返回：索引 strUserList
数组中<strong class="ph b"> </strong>'          strTargetUser 的首次出现。<strong class="ph b"> </strong>'          如果找不到目标用户，则返回
-1。<strong class="ph b"> </strong>'*********************************************************<strong class="ph b"> </strong><strong class="ph b">Function</strong><strong class="ph b">intFindUser (strUserList(), strTargetUser)
&nbsp;</strong><strong class="ph b">Dim</strong><strong class="ph b">i</strong>' Loop counter.<strong class="ph b"></strong><strong class="ph b">Dim</strong><strong class="ph b">blnFound</strong>' 找到目标标志<strong class="ph b">intFindUser = -1 &nbsp;     i = 0</strong>' 初始化循环计数器<strong class="ph b"></strong><strong class="ph b">Do</strong><strong class="ph b"> </strong><strong class="ph b">While</strong><strong class="ph b"> i &lt;= </strong><strong class="ph b">Ubound</strong><strong class="ph b">(strUserList) </strong><strong class="ph b">and</strong><strong class="ph b"> </strong><strong class="ph b">Not</strong><strong class="ph b">blnFound &nbsp;</strong><strong class="ph b">If</strong><strong class="ph b"> strUserList(i)
= strTargetUser </strong><strong class="ph b">Then</strong><strong class="ph b">  &nbsp;          blnFound = </strong><strong class="ph b">True</strong><strong class="ph b">' 将标志设置为</strong></p>
</div>
<nav role="navigation" class="related-links"><div class="familylinks"><div class="parentlink"><strong>父主题：</strong> <a class="link" href="ASP.html">ASP</a></div></div></nav></article></main></body></html>