<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"f05f18dfb65cdd2cdf4f5e0f36a0491b65cc30926255f5da0857fa329c7a293f4d493f2cf1a58b52bff5704bde9f2fdf0f2376175edcab7e3fc52d12b8e4972c9baae5119d3d4fea56e2a8e03498bb3a73eb60465e8f2b650928e76a9e55aba0300ec91b754b5ce1fecbb5b8b15a94f6c6437f51d23ae9a015d2a538927877c468e9990fb9b6c13ddaace98c0c5b42c7242533256b5aea34111accd3278e90286dba9f45770279802e15965158d0dba769978ff5e90293f1ec55d079a834c91c8690ef830b63088ef0c504f661231079c1439a0f7354c742016200e0769eb264d09c446388ae5d4412437e63967b2c673352c3223964c592bd7ca691864c33621c84f16cc7670892c2f9bac4aa9d336cca3291fb129034af873d563aaa6a0825e2c1d2c56f7365b80be08d1f3cba016bc9b62d9986c27ae1407dbf94705e5cbbd4ad6b34d194c78efec90311b3c82ea971d57f2d105e9796f5324d42aefc5e0dbd2e4857eefac428e8ac93c410067916df6126bc4c3b7e831108657db7b28b3367da78a7d561f658db10d6471b45a3374b09c09238e684cb8c478021b7c1f6d3b572d9c1cbb13fcb47a9d619596e957a18becf67780c79e82aa754b45a20c7bdcdb527f115a90cdf8bfc2130c0815b1c94225d89f51ca765ed62c767c71c1e80149dec573a1452f65ddbde34f90930928b188ea4101ebf935e9bd7f40bfa060d8a9919ac46ab51ca0bdba7c6a686b1575d62612ffd7d4173fda49b72147fdfb2eadd36757c60fa7109c49165e5a04a8c17974cf6825abfc32694d22360a66c8b4a40a4621778003aa5d9e3af66a6800307ecd225faf89bd9ebfa84b796ea3b9932bd2563f9f8ad7246ab9f919a46a636c49e5cb35d35ae84cd0f448d3a8f8e16ec00916ecb21ec052f7da088d9925c67e89ca2a8ba63cda0acdff52a0421d6faf0c6895d4f0ad8cc6baa16586023b45c8af12875eaba48e2ae2d0dbc7e20005317e78b89886dcf468bc709d924b1f842c8dfaccec118f95ff32928fee38a8fac82120d0ebc81ab12e48df6098fc2ed070ad726fbc6e17d7586165d3f8b202f44e9883280d9103ffd25e66ca4ffe9c800769fe33c7f2578360e667723748221f7abfebdfa0e1a755b455dd29da50d584289feeb92b70dfa9f4bf7ca2aabe0928903fcdfd4a1b8bf6c05e530f8c8edc857a7d570786c30843ac353777df48e472f2c5b49a69ee149f924ec2330e8b60c23c027eddb816324ac2d5febccfbddb7a02963085276120e27e347a797738e6523ddb1c6a73c15932b9c0248a2fe01f7afed51d08b6bcb2c7ed152d41cc53f2853d2b95073b37d2446a3ed312523a473e2fa8cb3d1c9001b24e152de3ef717c2219bf7ed982b3904d405b1e8a6ae72ac18db6c2e1f00a3850b50c83e4db8589b8c9c9087e4689cfb35df7c1b9d0686ca5d4217051b9db689d1324eb500972a7e8b22e110e7d39bbaf8e9fd4b81695d221b3c455d4a0299e939a691b66e11fff2ce2778d038a1d02666bd56da25b4f04ab7458f418a8946a4c42b2fb648773feda9f4f65e8fab71d23272118ebfc93b192cc1cfcb1721575e2db1d5b9af9e4414e3da6e9f06f6433e8d22a119c144b049db8a93dd699e678c24fbc751fd57ab6bee920ce9da3d0d9d3a111a4f712bb37810366c8ae6f7703d41135f959529df6802e455da343109adfb8c201217122436f5de918874b95ed797df5a3496d6af221d2863af6357312934a63840c6d55f13d375edc6572ea52b52480c051adeb584c2cdd1fb51347c17739632b56c83283dea5ae309afbecd5770ca30736020727f9bcf7e7ebc93ea8219fdbf895554c5cfda5116d65b5eba43f71dac6f30cecf5e6e120b3693762c87bef0c309eae2eae22672b27779300b27e30209c9b283d1fe6ee60b30599a74d463691bd5a91bdc5e738a307e56c89e7acc17f6e609acc3cb9d8e1a189829a2b7533a4ae0788e61c97c33211900e02ac3c1a03c11855c1d44b4f6583d89bd51ed560d09a26cb8cfc32836e77ed966ce2ebe97d8ad6b537bfbeafa5218825de3d24c9ef1cd97cae8c13cfb7c2e4433d204b4f936f385324a64a2a0f96a80d03f3c21431ec52411759cb5875b67b5e60ec3fc75547e2b0eddfbde05cacfa4581a69435fa2915bf0c38b02ddc3c7650c0486744978db5f23099c9c7eb3449a13ebce6cf1f8dbddcfe1ccf531241ea9a271bd2c57cdf1d785cd483cddf2e30a705c983c719ee80036ecc0b6d7c9c8478fbf9ab744f8e757ad6e52fefe85970625cfa61fdb2222d1b6ff2e3d92bb0a2827e0ded50dcd828c9a41b3eaec960fbb77ab268997491ae15fc1b2368527b65f6e020ae07ac43291ba5f524cf82ea6cd9c80b6c635e7d9667c8a8759c65735b2fb84f47021aa8ae067353aaa1fce0fcf1b829bacca74d828f4acef5bd81067a2afedfd6e6d454946987ad8f7db2672a5c62311879a8be4f64b6204309a29b22de0fe51ec5bf6304812f4a1b0f810b7b2190eb57035bff1437cf7b309e387fce587e9df7a1df084cde545fceb39efec214c2c304b4b8345bd45340d94fd9e761fea7968e1bf51d45c69294dcf7d9c6df1487ba0cd3ba856f6ed38f27620af15d4605c60ed18e448dfe0719ef91b9db320c8158348d23dbb2237ce0ae0f963e185e3c16b92d29c2a26abd5046b6c34d21a76bdbb9750af0577fd6b745fe6714256cc8a6fcf48f311083b7c758a26b308c71f14e33cbe466659d337e1bd4d1161085a0846654971633edb68e21fbab173edf833ba51a8bafd97f0b6abbda8d242ab63af3e740013ed17e0d53dd2f1ebff623ba2f5bb91dee396705b07b3ae9a6de8d2e6dc48b0e7e50f694e262eb5a03190fa5750dc62fb5dd31e9b8c7cc5969b794cb80f90f91d5a17fc762865a7c63ed5b48d964994f02a5433c9bed15c09bd7ae2d49d6f075cf017ad3c64db348c6fa65e93990e4f56285f6c5d68fc50bbfbf2797650b6dfe26d7f4cd03053de13a542a9257931bc53e9007a658b87a7f81993168acc65046fea1134e45fd9c571bf409567320dd49cb93acb3578c6dcee43314d68f20bfd51db8934000aebd938ace0b47e81b9fb741b4ae9e8e3c0870f7243862ff89e4ea65d2287d63ac4981884160948498d5dc4c6a88c9be4a937a28ad9f8b036088efb60cbcf4f352f9f2bc9ea7dd433695c246282635bf7619dc2d1d87ce0d9a2f454651bf7f22262815a93643c8395a683290dcbc8a191cef60b9c5cb77d583f5790f0574cdcdee08da370be07407875f0b2e1222dfcee16b3bd020a935a387e22aadc14897d3d6f6ac664b51eae3ce65025c03e760689ab603ca4434e3ae0b6fd540497fa15fc5ecbfcde3f2030a4cb803ac8d4f2e810df5e9322882c31dfac722efe4a70b116816a131373a47febaa361b513d65c13a6de0347efc761c6a5bcb6f34b02b4e0d8b21582a5a485711f0d6f2739ab1e45e7b635bb64aa72a99449cd629803f6a30886644ba8ff3c7858489aab4027281d84c6e5aa9a7ab314f585722d917563857424a31f5325dd5912438afd461a65eee5394ddd02991e8d92ef67d7798aefa8f916786fd17a01819274102cc4abc8059b5a4988b6d58666b371b5c74186cfc1b719452c392b131c69fb8eb5fb912146fdc54cd9dc7620ae481783234200778a8c517b7db142bfef26a2271870537be1167d6b9f8fc9902be36c522e3144dc7c4c14f5006205bcc3c05b0de9d008fac9c8ba55c198adcb3da4f9178484251cb34161a67df70e80500a49390b21d8efe52c14c663679b656024f14cd09bec96f0bb82da61697f1af1fbdd11236954b3e64a3b1008451d3d7ec5e5de44244087db442cfeb67a840259abd0e1e6b09d2b9414a589cda3f220889e44aa01eec461c3ce107902110102d1496c876187bb12cec31382ca4172231ae6e32d080aa1630373c4f35ff78b9d64b3a63e417812f95dd4e79d73dded367e54228580a419552e0fe61143ab51b1356c3bf5b25799f5870852bea9350eee1fe19473be542d69bf96ec9864de825b8b1c3e07ea4decd95965dc2672b5a1a46bb8fcebf2f696e46190bce8a383517a7e73650901dfa64df337c10349655c04d484eacef3bf7e3e2d96d7f0dbb7b3f65329951d92b5199662976d74b36373c4b4cc756adaa1d456cd3abec8ed6897561ced6e62edeae83a013e4bbdfaf36527eb99470529337166d2b020756f6b07f183d7cc206a561a5123a0ea2fc630acfc4480fb829d38020b49e2f2e3b2063381ec6be80d5b66f703061b7f6deca3a52c8b1cc8bee6744b3272c8215c637e4418a7191daed4115ba89cf8e8acb9d6374b6278bcf60a586b36edf844b679bb35c2dcd437775b3c608ac822db52447585bc29cec14482aa90be97155d2874293411676f47af9f1c9b0caa4ada684450c7672a24403f7648e4f69df55ed38cec514ce0ec0a25d5bec1921d079e415834b7ebff234d2c7a305785f4f3257a7d03934c93d1ce47bbc0820baab19cc7e756dd1c6182d9d12f1fa4ca058b280de71837023ee7da1953edb686173fe94d76775211f091d43524b02e43b3ba2bb197acece0b1b402fd2d26168eeacc0864e4ec82dc675651d3f25db0a3556bf1be51782378793ee77939d5bcfafcd6d16f70a3be7df0c8756e43d09c15e2d127f91a21171921f9a60eec123f81a97b459020ceb1cd476688a5328d08f19dd0569318d46e3de3ba2e579254c1020724d8a52cdb8142a851109ef8c3fd7eed7b35180800f9121c04e4c44452dc09a783ac3e47b8891c5751c71aca5f4485388689f1bd7932c1e746c81bd4b1a0bc9b834137676a2d0845322a859672f9a4630a4a1f9d6c8711a5ed5a8a547489e41ee687739c4a2d47dafeaec4a6f8af18c0e78c30a2bc6eb352b58df3c20d5c3acec419147f60fde30b3f0045450289d81f0cd1c707ad2105280c886fb8df3deae4879358cfad9e8dcfc89d2110930b729944ce2cb00947080ef858c058f48fa8c9cd56f414be4098ec11dfd6394f32f4431ae5eecca576112dd24ff60a5dbf99aab4a8e34ef5c57a8e8927ead2e1c89f06c542719777e7cd03ad1fb733a24269fcd131f7a447b504223c2e14c5e7ee490cff455c75e5d514c1044b1ffce8f376ccc0e20d7d39c93a70d18671a419b162373ba777369faa22ba2edae27959de1f414d292b0b08e31baccb8cb2d499b71dd7920d23ec3d3fca4d90e02bc04ce2e8722da63e4f7d8a473cc1c5d46158594ef12f76e7a19c609cf1d7081df34d736c754e002f7fa2db7c3785d6f39ac3f01f45fb7c9e84eb8f69cec2ff602cf407769516636ffaea407f229d9aa4a82178a04dd71b7330cd8d924408257de51ba7d1f5ef4f0d54008e6f5b323f34eb16ab9d786ffa44a9165d58a8eed815ef2cb1c677379d6d9c4583a8816c66412d296a440bca0b2c331ecc614035870fce3c0b6e69edc24c8766da70ec41d3486b591ec2bec4da3c70d59c83d6c4a8833cb6847ab6575d1731cf829f01b53e19acb6d443fc0dbd36854851206394c86dcaa6854045c587fb3675a0005ebe3c22a94c810150e6bdc4a8b81d22649eaf91957dd358cd85867fe7abc98ed92d70585d81c4a3339bd5787e4844ee4e368cf5b6cb439bc471d6eaa3b96aabec504791b6e8949d14402b45239d4ce83d0d73415bb8d7f354196e2dc8a0133aeb54c3b7349f2e01c00f7555601d49c9771965056c8e20bbc6c35e8592b732646638b0359994d474d6571b128d6540ab96a720bb0df407e87314d96896957051c79daf32cae729ada7b634269e52beb83fb449acc6ae499dc11d53dd32ea2186efdabc75313f99010ec02b436842455142b538798c03e3ff72463cca1ea606472a443662d75291c50c17714f3a23816350e410d50e0315b0fffded6907b00b8b9ded85718861d08e2321f4ada6cb74eaa877b81352db110352056f6b165555dd8dc27827d39ec9406dff3b0877b9150046e334c89a6a9934ee80cddbb7cc288199cd31ad8608d35f8e9e60b90a2d7559bc67a414a030f345851694a33d85ec854f48a70a93e7853e780924cb0adeffd52465b2df849a6f5a6733b9d4cda8c21f940d1ac38c5d2194247f329c2509859baba96f91efe5fdf740f669965c69e36f8ce20b7084e13fe79dfde98f7e6f02c830ba1db83bd49c0736602cc4d418cce6d61a0e39661d45bc0e3f763206996a6ddd28add79b15904e92b9a1b9ca6de7ba00358514384109f4775e259e4619ac9ab279db57cfd447d7cc00cdbbc0259e86c86e74d4dc9c64aca30d88b992d020a245639e6ac78a734fddaf0062328dfccaa2d30ec728e2d3819b53b32da394c378a796ea814849f601df0d6306002068b21298b68acb3550d1a4e8fb053f33486eafe7ba92af251be8b4a7d3f742674dde7884c3f2a54984256d8765d9d4466cafca3d3ae1d1f8506daa4c02abe021795c3465a225b695dbaae95b49e8c9ef79ca048f35973ebdff3e98fccafb38ee4cacfebbe50ade521d5294b42f9715bcd593c1e9d0be0f87bc2b84a1b18e9b9b389577e1a3b7e9a55c957c8a4c1081b35a163fe881c18a671e2736c5ce1129c110af67a52b1124831f0e7ecd7703d5f56f42a7e62f6de7443b42f7dcaab26e0560251fcb0675e4ff33f81e7ad1faa0b349d354ffadef76dee114e4172efa4a2592677e4ca8f332868585e998c351b9ef7ebba6222897dbff7e2fbf79500eca04c1c7a1fe1f58bf840eb15e33dff9f0d76612275c174dad75b8def0db5978f885875e73b929b3ef983332ad09700dbe1aaa8456f82742600bde02683a018488e95faa94bedf6812c1dc6fec0fbd8a822d75afd9828faf35557445d3c11682e7ab82f245d63fefc7ac79d823f903620519dfc047a7a3e022a87e8da007023b57a78f7d774cf047118963e2bb6d0dc72f0d05c2aab7e443c4d4a2fed7c5210f2f8a9d3e4a8118fc8de81db925877ef5d5558674b8aa766ee37d13ce9986afa6363b29c275d03808860472572237aff67f37f1f0579cbc90432e0388d8e72469106798c6cbb2f753f966c693455662dcb691aeaca6950b3efa80a6aefd1c8ed039b85c7ae1ba403cfa0ef8af9c0256c983d334dd5ecbcd4a35eca02415c24d19329ecd5928db4bd8f09b13acb1401519717698c3c1263c7cbce470ae49c1663f1cc24f113e1a2da3a71db464bc04a80f7707b4da579415ca0a7f2670e817d7d58d551296938e4e16da630b02a12b3518153c2c1560c04254e79ed5112892dbd69fed7f1d1628132390335e84c5139f3624e434e7b0bc5639dfbb4bd970afd954af78b968c4877d8d4848ece323bb947910a739d36cd55450a5ff1e415319f4ac8dbda501ca31936c47b94076ee956de15d6588dcab6aae1c4779f712df40a9110c45b76331e54f624b551aa57413bff7ca70134951cb2d9f28ad129fa8dc28ef98e731aa4a76ab3ddff151cda90cc3c81d3c1043f3ab4f54116ce593ee82b0820fba7bd5d8507ffeb37d40be7c3e7574c425ece3ac3cd285aa614eaef53d8e4f1441d112e1d5c1a64b6c2c3cb552101715faafc535455ddb3405d50920c463da0ee8363c81f1a5771cd11c16d515e7197c6faa43bf91de56fc713db84e2bf826ec5e1eb26768594fccd4e6b472c8aff288caa3fd8e655b83b1d1b19c24b98e7d65f87c0c7268dd07e1a7d5a1d97ecc282656563318fec9da031345d5118fa1e9b33c87025cb6c75e38b44a04e3301dc7e0340884d11ca9adc2a4d0b7b6f5e80750814f81a87c5cb6a09342d4e0e84cb87278a2c66cde02b4ec77856184c4150348eae6640c023fb25ff13799f55af3377ba969d184fb8bdff1750f58c450eaebd015e8371883c9a8816d87b3a72336394a3a4892d1a067e17b16b830212363c437bb76712f5f0535a2edb6aa36d96e93db47f92f1a703e64b8ed59adfeaec5b981e5023df2caf279abcc8877c4191b2e45c7a1639853140082f927034823e435d6a9c30fce541e586ffc12b62923ab6fe17936c3dd5a5d2ed7b226701059eee3cd0e7803269f799e2775bd884ae2a9b4d9966f5b8e5a04d3215e750db30a23a4e39229e3bd94ce217046f2d1d6e358d3baf9b2ff3516a37c3edb159f4b2e85150a73c0aaa2923f470b29a5046ff0ccd4172deff8618c611c939ae8c668890c782b198c96fbef73f451d0bd5c64ead1fffa9a7a01ba52a1548906d76f9baca2594b2af425cf46155b52cc0ebe592b31dd34ee454cc7bfb8f3a93d5d9a9df8ef394284f4426886edd29bdd897be062776483a5e493b1d16b4cc64cf5ec42ede632e77ad482297fb133e38a9e16cdc3e368b24e70370df93befe8c4ffd2727ef3e8f40540cd26c1429c1fb5b5f0ea72dcadbb8deebfe1f48f59663b3b6d0fa94771dcee5ce042c8964ae3ed567eda8f189ffa93836c104f06a4810d74b217b0afbe388661841046658415c6b1fcdca0c115b1fd0f112c7b444242f0fb35e7684ec1104e1d0da78a0b9c54baa03b31b8f50f1df55bbf47bec66aac1ee654199ea83681a88e916e4d3940486113a9852a6996a6a20d42ff4b52c9ca24b5f4e5db4d479108baf16e7a38bb0637eccc7076164467cd317b8c43d8033b046d769ec6c68a1a3b861fd78796e81dcbd44918c56a088e404ca09f6a1a51086be0baa5d460bd3654e1debfd4e05db819c22fb1230e8be133678beacf7942243823dfa3ecd1e8c8704347f9cab63d52e864c9746f3889b6ddf24075a63d17baa70129252e0415bc8239cea0ac92998d1bc75903bc5c09e211c918e625da151b18dd671f18a5987a283382fd91603c768e0e68ee1186680394fd0992d72280bb1727f968c7383e08ef1fd4cd9a2c42ec0d2d41922abce17c4a30093564e8805c3cde3da6521e2701ff777a63662d314ee7e066601cfa48ef3447157bc4797331da770cdbcd9164b0666a8106b173b66e59703433c537afda1e8f5499873ccf34e48bb170feda0cefc5dda0be7aa6a1a14fd60828dbe229b56d66055068d8c13b6548680ed9fa51533094255647cb7f14a8b9b2c9aca50e03b1c6d3e594811836b39cae736156e43967dfa3efec6c21dceebdf9d36f8c8ab9de977bbecd60a589b9162f39d6d8c4773524eaf6ada4e408de1c6ac804b6f9332adf7f5660ced63b9197cb2645e10d80e909f2f3725e9ff9e4637cf3aa28fdb06e4717194ea628c619ecb5ebf8d72c3ad12d5e4f6d221079013cbb8f73f18121c0ceae462b7d16cbc5b0fa7b98a5a78fd08bb0e56138ac1525f08c121841581afbe7bae7511f29412e33679cc766d5c5b5043d4562f94683f3ae0764abee25e4bb7cea5f864f6d07755c8f9756d8f72171485f1c678503ac21d2488af300d50d1aabed3e7f4344b406469a3c7fc9ab2435102a2d20105d0bd7c7c3a207f1fcbd9d36f13b05b4507156d83ae279e3110c2d49ee34a9c5851f1316606eb500f66a040541d362c21d4a44efb090d0e82cdeb4af4168f838078763519a7ec975995f8ad382bf286206db62481ec326d74fb95def956a3fe431bb586f1ae515aa230ad35f9679fed1debfdb9f3d7042312fb5e3efad681ba55878584a37269f67d1f7fb2163ae908a6c60ed88a1cc8506fca120b26d4bc33da021ba639da009129ba40046ada79077da6512da52e3d18e824c4d7d654b9d32ee38b083c40f4f9c5a71fac592f27eb4040f32084f2aba5cfa241134267f9c310542252932b39925a0633abdcea2fa3a0dffddf2e0e35446900930267c1ac0c50443980cdd20f6d84d01e548b12e6aef93b2022e4f8702fbd960a0d12955c933e3ff5b6d8f5aa726da3547d726c234108e570df1ed068c57896695ed2b435e37333ca9250f33073ab36bd33c7a48ff54f391c16302482b530086c7cda9d07c7b8fe0314130f503b492213ebfce4acc446c08bb4e6401f0cb11afba285e91dccc24971261e443289d5b6319870a1fa65c579c88e7088f8633dccb8413cf06336dcfe69c07f7b08026f10de097d0a0190cb87bb56ef1fc3aca014d5bcda4130d5afc98c628b7a7566b6680b721cada630045b563707311b273bd185b94ba666e374409e5bab0bdfebdd956b8ea0ae926274ad88250c14102c7a8f91b45fd489a3ffe73fa45600f929edc8b5d81299d5f4357f5fdbff55d858416e8f3efaf64ef1a90f806b98af8e962b3cae7e999bdf21daf6d0d80f97edb13c5cdb3d60df5a7b30a52bc0fbd3dc7da70c632431bdfd103c0c18d7f9adad518802c65818414242dc8f0469b30caaa9f76d041eae390d97cf4e90cfdf571440ea8c6961d3c4aae26c37292c2fa2316bd12d3d2feb2e7285db3bbb5bb5fa7bf026fe8fb603cd588a60f363dab24322f7a11822750c20bd5aabf3ee7a450bd316547b15f781f479037e2cf888d53fac7012e50f307345a67e0e8ad0ab657ccd7453e91958e4b5335755c04b4e3dd14f7712edccc9f750719f2d7a982ee82bd60c74d8162b35ac37d76c97df9cb1c362d4a20d28065df655ccd7f5ccdd3efd7d52308931fd20771399f2f7f2aed97bf1394b313e54c9cd812587f378415f5e1255f946d5aee4e036fe33038af03cc11f732e4a4266488268c376ddec70ab68305b6b5b0d4903839ca0aabf5fea6f5b18667ed22a85824b8e1d13067d561d10849a6d76b857ae8df65e1a0571f518b5e57cdc5f784cbc08b503f0d1bc59e2ba10932e86fc02c38f5d5c001084309130c32b9eef9a7f3ca6c2f977793ac1088a04d392abf054e813eb839c3d46d35c92ca60e1bf7e16856a16d9343fd4af8c92abf10c35e31fe4fa9477122d2281014d07eb17e45d4cc134f3a72b7e32fb83758c079fb5d3094070e57a0ef6cf4c7634dcccd702349f04e12e9aa1392bf2105874390b5ae5ebbb4bd89f233f29db5bc5a26e64fdce01fd78e06aa1eeacf365577957c4400b675d003bdf3cc2e91b6830ba9a702611ded0b73267e52ebaf01d8f69a5c1b58cbfe4acfccd872da30c3a8c6fae6dff34b15d0062c6fbbd4251c45bc695b9c3b8a1feeedca930d9f224983d3df1c0d9fb97b5027c3c5d7aa66bda356e7d016c95b2991ed6a07bdf80e449adc098bf3968f77c3e658c1dab367e1b2de40d275d09cc9876eca10283b490d0fa039ea11b02537a85bf296cbc48d19acf18c2d8542ff58ce758922d9144ea55e717a543baacb72e77f32344e9754a65662b0a224f177bbf4dad8887ddfc734b76e60e606e33ffd4a35ff464e1298d12ce68ef22375763cf39423bd8ff4fa625a09c555be7c3f1c9a07b251ac093cedf0776afe54209d2f3e0db9eb037721ba3f8c685a911784236cc0fd5192b72b1a750e16d60e34dc0d49e041f3ccd9e8ff2dcdeed9fb278fd5c6ce7004bab5bf03619a8b74e19186368573c7062882663f226aa1a8b34f70e97a71d4dcfb06287e24152d484e91a1340847b2fb7229d389a76a3e2fac1ed51d49bda411317435a38086a19f1993cb526497f0b0bea426b01390f994d6fe0d2fe9ddccf0f5d5cc077f0f7a98dde909ddb68a38292b8ce74d5b0f65766fad6587440fa5b51d49a5fb286687ae6ff84477def3e8edb81730f719a8a97ce045b0008c4f5c5bd156bb787dfcf3023f9b9bd057757b8eb33ccb9f4979d50daf9f5c598abdd5aafdb5f397fa042cd12e868f7f9f568f70d9000dd22514cdd9b5185843ad25732746d84a72974a1a30d0295d2853be51fa90ed579d2dc560a45018757d9ba594599577f04454fe3030c1388f652f1722bc905c0b3f5a90cf1ef07b2aac2e4c8b9d9c617050573d6e97cc44bbb780cdb2f493729865fe5fa2163bca25938fae8b78abdca23e053cde9168818ce1af11a1856a3a4c36a95f0349d030780a5772c92ba32cd71f750542f22d9d9d20128b3d44b76aa2e1ef8d1c3107802da097f2058696715fdba8135cab57ac04049f82a4971a65b42c73f15a954cbc171cb0b3d1f4b19ddeaf045ee80004067863605610c95f143d9d4bd11903a2cfd11442b57acb8f3698616754ecedc508f82048844b3f14800e4c45b0dba9fc962f5b8c23928b04d976e466ddcc5dc3ee61a55178475908569273be997f031d9a3de4fb362b57a831342cd50e22f73cfe4fc3dfbc5128d315a146e713a6712621d42b0f7300282aa2c8960c600eac282e094c2a026d300cf6e13b299475f2347a4571b7b40e82aee1e6cf15ae57a03e2651fea22299be2accf3e02c6b86fa799395beeea8c9c84829846bd23abae9f992ae39065b0126876cea7e6af4b7743a415f53fa389b94fb68c2e0ac28e322eae022cb615cfb3a696a015a37fada97adc01bd28b8190dbff2608594052423f29252dc9f19502dd70548521de2654eef161de65d292f5a1308b80bd51b26f291dd360164bb8cd8d77a74ad4e42711277860c943ae6f1c797845cd2815f9ac4a4e9aca236d5f168138a85afa6241992f655043dc6c9164684dceece36b27d1d8870d97f5c1cd45aea244995f1c45f347a43ce1dc6b0e8d6b92491b3f637bb4c4152d40604090d9ef5e11b5dc2009a99543598631c87ec69a736297db1983e8285e4010abc6c6632843210fb1d4514565a7433f2744fb4745a96632d99e22fe0ebd6a22d794b29f27f534826843cb983dcb1ebe85e140b5821bb18d8161ec598aacc16a2c547c0aaa6dddb647262ee16e35e148d50fdfd09cd94131aae9af9e4264216431002891b4861a7755bc5ced3c577071b6e54074dc2bd05dce1dfc4b945951ccf5ee9f3d2654d120f98a0233c166eafedd71432b8f54205cd4b1ef2e1d6038253066e0949c0dd59bdec33404d97957630b04c1131698497d1a67fc58f4157d0f2d0e7a217036a1daed340b72b602aafdcd9a8635ef9be56e1e61d427730adf37ba01b09e6566c2790fb056d299b027701950c92ee830a58dd86367448a6cca1f954a0f4bf5a1f959421b280ba40bb60b7807164d2de1480c6948d06211cf1ad6f703b1296b01a482cc7259e0f9f73ac2c9bac20eae68b80ce20a90009ab4161c63dad51f52d06cf73efa56c727d572a21d29ee470683e524afdfc2fa5cc0cadf3303698ce53d79fabc3c809497e8ec8dd77b9bf30ddbd80aed19c62c9fc3f01ebf25c8c753fb058efdbe87265244157bca953010e0ad575fed4e48514fecfe18bf08ca498dafca22c29e7b0c45069db6a8c8ab85a570d5f8ddb091518e9cf5f7a5ff32faae0d2f915039c588adedc4838fd959b477f2bdf89d92f4910f80a0a3b22a29de59bcb5ca79fd5ed7934203a2ef0b0ee105f08e4722c72e97d3a0b96991169c555f74124df1fcdb5082d6cd82c6b438353f27a2970501e4ebf5a23925e267a96113cb013c867efc2e27a30382ffffd63596f723b95ddeaab1e08d0bd6b0b1995b874922fcc55774e64a51103744fb837a6f5d26fa4790c51881dc648f3a68445560c57d05bd52c50cd59c117ce3ce521fe109db85a27d87dea41a6127434e7bdf3287b4372b117434c845063d92aea01152ef53b6f0140f46fdda8a053e01581d90f5b249844bbebc1d4707e8679c26d806d76718e66b4ffd5473202a8b0c62198b2dde95eceea77a6f92090761e3c7e4d4096da71c2a44acf09a2afa36a32e6bcebb9eaba955efbf18a5ca181f003117de766a5a234ad6e4fdc7710d0189ab2c163a2cab30e9485c508319b4761fe2a88cce7088b556dd3582d4203a1c507ef616a81e2c33dad917b48570c8a762a5d3cf4c5a82060fadea2fddbe5f998b9a48be368704132425f3015fd8172e3259c1a78dc5839ff4984c5d5f0addb83cc32a70a4c2f23bb96147e2706bf74ec73188007b54a4a7eec1111843b93ce0afb87f656d4965b05175e000fd749cda729c757485a5fe7d1f63a8c26763fbf337196f77e790fec1e6237dba21ae4d635f55a68cf35cbf0d5569c0520bbfa50d369c16a373e97e8f03ee45b4992343d62eb1bdde88f10593fee671ce9af3e8681317333ace927458da4d80e4374b379fe43e528bc05549ba5a334821ba90996574d58af44b4797b4c28b875335f2dadbcbdbf01c411777901d82715763d29417d0591955c66998a18925ec5ccdb56dfb8e00facc356d6055ad00a0bfb6d2aecb42f32a45f02df5a040e7ee34e16d0236cc0fceb6d3a2bb6c904042921b6269e036448c7a9397a72374f2927c9fff3b482c9af4dc94746535b658a7f68e284d66b6660cd27365d139f62445cd2b6c5bab061bbbf9bb0491e9b43747be9c68361d5d82df3d9fb7eeb13c9ad6a293b45e3206094e3809f4c7b1ce1060e05b47ad7a9b5f2809b5d107396b9b54d547e45c98a377dc4f0289cb984cfe6ef9304953c5e58a6411c4b4536d377a0ac20bc4503600d4e09d6bdba95bb968871ae399453699e01d3119d5f76859709165e770e1691388e060eff1d24327575c35ece803a1cd4f023a4771c15a5795fb9973c280c7609bd0323f9d79f098a9860a3dd918a8b5657f390532b41aa8e63dce3d57b1c645f5195ec1c6cd9ed2b7c92834bd3a75501cc3a4a69b2766a515a5f149e0340a5927befbe458ba7f1d936e462095c0ebc094ca702abe7b64e94775cbb0c6fe2288280153f821dbdac19dde456263169af389e911fb1b641236ccbde09391851b1cb6a53cd25f5ca3aed3c1459edad5a2a3d0639381fa5d1775617f911fe3f88ece61b849fc11d8398710a5a88c9f7ff7170b694c0eb290b6d321292b621cc9a9d23e814720a51725833ced671f7ce6961960dbf6cf9a1586b739e15505cd3510dcc8c9a148150450774ef78333f3f43a7e9098f1304330f33911de708cc8e7d66225795e95e85f48e38e7d121bb47efd18347875c5ab5232f5e68c98300731433612e5734272937ba2f8669739afd2dfed1930f0db5874590262f9323c8397fc3bb7516ea60e49e1a6b4f178090c2809f6505a305e940a987c55735f2ae84f753ea16a1146a674765afa190c3b9bcea3cbdf0b14fd5b3a6b99693ac0b2e5a32b66dff87f9757d82a30b1d491a6db47000ada08c9f7ed492b0d05a7190c2464f6040f44bd8cdbb4dfae8516d989f700c862f3b6ff422007650f704f59a43ab7b6153160b9109e23aef1be0f5c5f1d1c4a3be8d7f443d7f5a683194b1bac5a7d59aad932eeb2b17acf40113d01d5f697daf32f1eea8fbb76ba0a2b8c08bedafb620319d5a6a0a53052ab96ff9d92124c962770a8c01c81621aeb8db969da3ba701309b5c579f2308dc179fc558b1481ff6a6e2ae506e0443b2e01edb9851e999c7048375ac66e5c25a62b819aa8fcc97348ef3af27df729deea44a5b97807b63484b392ef52869c28cbadda94aa15aeb0484d691a8ed33148e0d2a8711002bfbea518c306fd382f329486a529e993c9df66608315c7a5105a8cbdb81044ccfa78b5ca675d9396062687ef8d1e6726ebb6822a06ac84d380bad7b113710a8327060f5d99920f91db95f2a34efb7f3551df4749a64040a8cb3d344d94a7a8b5c91e08194be1d772f4b746ecc8279fad1462116a2e7c0f63719f34bfcf7b5c8dd0ad8d7a5ad6304d7581f89676514b18cbd2b99d4a0b8c65e123898a855928654086d65438a598eafa2eefdffb89f7abffb287425c8c2b533610ae713608ce3ac1d8a427edbf447338332d7c225bdbd00e6d8d7de24087f15e409fe3db8701314ea86b46a4e169ebfcdc10f2dc6e1706061a8db2b15cf7c7d62b9d217844455d3f4dc182aed282ae284fe255201dfb39069e865fe7c448222cd2a3b0db6654fa419b8c562fd0905e7c177b23a542d47c3c017e924e600b8242a51d46ddf953b6306f4c3b8bd1917afc7de06d4bb41a9373814bf381ba9db9dd9172f892188fb4cbe459d8492d82a71016f11438eae1a01790248994fb1bda859eaa4498f51d7f6f8c35164c1278351a8ac44f5339effce2625e62053c3e941bbc37f635062891678edd3a114f9e330650aa931ca380809701bb31997125dce8135242683e892b132a84fa9a59659968cce077b3f9cfadc16d22cba887bca511218c34b54a538fe3413d2779399257c9e6f11b13a313872446b1e52123a8f32591b4283b4f35e2a78f5bdab8f0430935ce0d8de9b937b590ef3abdd7f381f315a75b263e943a3cddd5eb8f7747d56e44588fffa21583a39c42afb7a6d525d46ab54c9d14f7a723286037945e600a45334436e972dac566a945d300fdce06262c5ab076748fdb7b1d4f7133299deeb6714ad41fe49548d2e67984951a431a357e95308f52722d5b473f7479dc454a38d8bafdd875c2","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"cb4dac17dd2d3b658155eb3f63bb6c40"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
