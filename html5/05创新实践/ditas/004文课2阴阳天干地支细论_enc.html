<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"b555bf412fa25e31001a4730f14ece9359f3f0538a2a35f0ff5fbd2e7a3b3646eaf19b977e7ef8ee014dbebca82caa1577bbc746efd584012aff2d61948fc6d173559d0dda1e795f0e080a840f0d959358f6a8d96f8e80ca89254f2e117f6ddb4f065528a8ea2024365fb92dbf65d66d9c56c9c765e48f3ad6c0197f40c628722d6f06b37f9e26b0b6a1cbc3bb661221585178b90c144ac106411651ede59040f59a893b733e967a26133660a1bc74aef97515075a5564f3acacc48732c3a2719c0823e53f710e98f671d24b62ccad60b4d1b57274bd5488af5ad82c0792d15698289758f352c794f56bf2cdb5948af064eaf5a0c6ffe239202d92f5836b121d04308165e15f737742877b88d535cced05ba28775d14817f3693bbe327e4e61d59fa32bde0419d8bc02386425736f3a355d08da07d95aaf2d4bf749cc4d8e587aabeb5926def97a0a6d070a9dddb89ae45ef31a8f24e2154440e411d774119beb2df2418c8c5bf0a1027cf11c1c44a3c0e0fa4b900b431eedff337ed93261c87f6213ef978c54242d8646819303f4757d09efbbbc7d381a0dc966c1200d5bb5e773f00b8221f2cf1a0ba6e8205552cdd031182d85af2586d41441b1b7c4e2807c05bc494c9bc8a4dddfadfca6522c55a1645f78007549547f603d9bb92c2ec366ed55eca64ebf8dd583400c84cf8cdcbbb3f06d008e4e20e105a86721a786bacb130f3ad6236be9cbf96143aba3894075d7f32601f6694a1c7e8bc9533226160bb70621653a60fc6c83f296ca0c0322c7e5f025b76210188a25110ec795521cffd9cec166eb274b6f834167d1f601e459bfd129c695ad5e70248d3b4427f14123e26bed4fb1fb34dfe8a13c69fe4fc76faf21efd40381627736e44cbdadc5c6ce1cf6d86c2b27b5f927e7b0703ef3623e08b0807283095c9c9c3261b067a38a398c3bd94a024810912e82efd7ac44a835d850c57a6f5c4ed87c4529dec3d4a9e2a20b2cd3488bd5c61eea2db953b59ae18e5be7ee6f1a187738f33802ce9612ac188b5a09d5c582c0e6ff5fa5d4121b70f4ef7594461b49daeaf5378ef25559e3b0b61ae450a930b5e84232360ea6f1684ea555c874e01a03b815d4324c47f64071dd084c6e637b4477cbac44c8cc27871a831fee6d4fe5d8255770498852cb1dbd984a480311105333f7cdfc9cd321fb2983833643ecf0d4ed3038c5381edeaba2ca37bc6552b684d764f18f11956f72cbe503eef7494d6df2d9f395efe98601432354c2d5f0e6b7b3bbab0634fb0f2e3f824ab1b5fccd47b4632a881f9e513825376fc11e5607c47d3a538527f803e0b2a25b28a2e2a293d5a81c737733fe283018e419c658fcea755fa9bb8f9a9612f844ab262d747aa1171299ab25bb9bc9372b27f7abfa2bf17f1e00ca21e5edab7245854f9b25131fd22b6fec33d059b341d9318e15bb4f24242fe887b43991d25987854e4b1035fede7ad0c9cb74199329cae5b28569f291258c6621c9da6ce0f11c6859f45ff8f6ad20355b1dd7af79a6247f83994e7433b470efd2c97cf9b62e4090f925d100334d946894e95befe823a846fbcbd1e70b80a0219d0f3582e2cec5fac6f51a95941f08dcae796b551a7b27f455fe0d748794482673b3f08a85a6d3189650a10e3f143fb58f1ba191080972b5cfd6158cc60dcae7ed436e6f76bf6388bc06b04a1c431a15d28cdaf58a9e41394cad0539d56403e02cb9047341ee3bb209346a77d399bbf13e39b46aeb0e66a018ad3f6e06345cd99ad6c4f56cedaac9831ac8f7cfad3610fd33171bf6e34b0f254dcf9510d12a6ae5186988cfe8e02e2689759fb77e21e1fc4a98957f77f6e4d69a58e2469dae07ebb401178d8616a03710c41512cdd7ff40f6d3d5dfbd1800250b28fdfc896cc78c019a7b314b773f60d8eed2ec4a329634f375ddcd54cb4a07e1bad46c41323e3160d7a5898302404ab3b9f0f484716d1a25e81a944dc6868958967a693c83f98676106cd4b6282f98bdc6a74c95e86e92b614131df833985de970256abb6d04c9e3444d0fc1973b5f47c1071f0766a0b9cf358203597698fab566c8b5c039d1310312a98c57feba4dcb9f4e6883b4f2b5149368954caf785b49b7bed5111795983999a32afb5bc19a5338aad6b2730cff8b2a5f4f5fedcac7c867734bb55405769f8fd44f8347bab16ef5b59e5ebb50d9d070b32bde2a9859cbeb07499744a164be25facb49f30adc5f43b26f6344a19254050e107968ab78213cb1e9590aa11a3f3c4e7d31f52d6146a74ea4547b9901e9a857999d05038e18a6cd47d96c08b392379077e2e28d47f3d232d7c6f9d28eb6e6b7559a4c45e70dcf0dc26428af9229ff9b08c5288e39fd6726b2b741f921f6414e09557488976a0f51afb2dcb0062c0d2284d33c041077c14219127ef26e2a4afc2ca2722f0c7bb6171a741bcb7ba06a0cf3d0774390543cde3ad0649b980842578ee93e94f6f4cfe4ee14cc40b63ef761ed36a2582ef20873c70bdc0448d2019099d3603c06d577c3ee0e7ad82066738792c246a01e0108315ebeb8283bc9b8cefc52dee95e244861dc6512f87766d37a2075b5dd93e8aeb8f03e8a83043cddfc069ee3c0c5260afea6f296f8519c38283a00db411a643ad4ec326968ab4b100ff66a0e2a4944f1c0cc485d6ecb19ff56c574b5581db3388fa1efda59407560db47e18b370d41f297cbc855f3c5c05ea996fa771d44700bc1a739ad773219b32fe353eec6056fcc752fdd4f17c3870e814aa360623ee0e894003c1c86dad276340d4a4002d075bea8536334f5f8144378f3a14e540d344df44ed069aa2fa1e38c33c4e1af077cd20b0ebc811abc6f5b9fe51baeb280a5c767ef3360eb513ce2323221beeeae4ad3fd43969f223fabb6e573c634982aacdf3642d87d8b330d2fafb4de0c16985caf9786f81269937bdc972d30421d86cc9121ab87586688f8f8e803ff6434be031129adb9af74d96f50a2efbfde833c5987f8a3d177e909f45cc9bb8900b1bfd62abbc91b8b6318993ba53ae8eee50adcfee5b5a005d13f7500a7350369eb307c1a1068db1ddd6358540517c08d1bd43d0cd5fb40c1ec887014c55a904b2d1be2b09db5a0c580e30bdf9900af49db551a7efd642bde0f9827fffab38a5ffc9aa68b6639b5af573494da7c9460e4e27d7872f75e4cfdc9a30c0b58077b1c1d257261501274b79a408366f59b94b9f8bd6d9cf3a3425eaca27fc37102a870b3da9837e8c8501718ec1b072b5a9135220be65a425b4566d7df2571384853057e07723ec2753cd42084361afb9e3f5adc86dea1b6a9f009ce84be1e33322190a3323a0cb1edb1f093a4c34b597f2c1483c2142389b6173b7dd844ec75bd61260bf7c296bb6f07e3c64d586f87939f084f2a373d92265b69ee6b632af95acf26493e0db2ef311c9758f24f8395a5247975f75cab092b54b8c77df4b81e9e94449c239183c400cb32255e2b0b65b322a4d6e5b83b29ba0e887612d5425501ac3e20d21ff456c24915fdf4dc8cd43ec7d8d28cbd6f5c95d99c8ad1f1d1169b4c2eb7bf193b77d9b2de5d145a508056078d83488b264dcc504ab68fb07b38f5b9725d47cb0b1154e0bba801bfc985e7c53f7a20738661fed0380fdf36c3b7988d1480b2c76f3857a733edeb14c11f0e4e267e7be435b7e2458cd47922c203c34607c4502ec96484f919b4414e9f472a59d6d938a47c46f536f9a4891b92a1853b9c929b2b2f6e4ffb87b519c0864655ddc638b94c3315984528cce4cae1d9200e5d901138a71a85bdd2221354cf385bdaf85ea6fd17fde5857a6ea6dc63e3e4d2fcb2f4b9b6f93b4d5429f8705a4e823397efd2902e6168348cf16c12dd22fbd0282a5e32d7a31a77600a77f0ca21fefce3af33b159e48cdee96a6754d66070d9a7aef8086b7e6ad207a897693a1f61fb8055465cfe32abf098271923140862be572b0782905ae7774abe529b18bbb2c6d41698f8705b79fcaa2ff48f3b816b2a200760e7156806c729700a68432a4543789aba5540cb29dbae149788379bfc4b440944548b83414d7d6d7130b5aff0fc9e831461ee8940b3b41473f20093cde99485f82b0ef0fcade7c4f6aa195458e7b043bae004c7316afaecf7707d7a39a8c55f112b6dd36630901a45ee0a9f6843b319e9340a4169376865f6c2bc6106c516ebd92594161ab5c104bf7d62f2e45218fbc251c10115305f06aea6df6e502068b9ee9fa04575206773642678c8e00b1137298f77a212ccf0e2a31c680504f2dcd936f0c40c2fab8d6acc3054062c0482ca6ec09d263946e2a4b6b83e431bcf6906358e7a219259b0bb771024323bd47b4490363201d3fbe13a948e791ccdcb5c0d94fa47584ad755205d8af03a0033cc18df3dd8302bd4e3234f7c8536db68f1d80bb745ac5bdd45c4514fc737b6fc09d4ecccf43c30a64b7bb915388fe60378966379c060761964ee69c4777a55c95d9e5de84147bbfee8b7d754c0c8588c4bd2edbd2cdefe5a811caffbade71192a3b8ec973689dceba60a672284bf8bf8b949c4365acef2d32840a097eac4e4d1017343432bd9b23400224d827f4699a071b0857fd806cfc06c791568b434813aba0b9ab902ffa1b3a99293b16c1ef396844812053332a86c7f024e2719fefafb7540fe5e343c525d36d6181751bd28c21c68946968e4de1a589135c12c25a41bf4c709c3983cadfeddaa4bc18586b1785d2b8fefa6f23c1c4ec7ff1539f8c03e06cd80be55fa43e2b18a403be07d59d38295bec9c21b228ad00dae4e5ecb98918bbfb74ae05a618e07f6c8204b7f03b78211fcbb6bf5d8f73d419f9b1b1a5d168f84e22d20c041ea74ab7b3bd4ed4fc8b51611c4343244d5f49cc80574ab83deb90d76b01b09a120fa4ceabe44149932e7944f3386bbcfe8e841d68febf86955ec55c1574b8dca6b346b5888d33b37196daf175c049c2974772dec03abe5453a860eda521d5ed1d0e564354924cff81a22c53acff1c3048d0ceb543757d6d222d176c556ce9b372a240ce5f27fa7230e125103a526ce1a0f7aac1b198054a9905afce656db8406ea267b4720d9314b979633bdf3e137ea81992dd5b95ce68cf8bf672486b911efb53da94d9aa47927d6ab266aa09aa22cde7a587ee4c1040d3618c42efddfd8b991db2acf7c403d159bfc53f32957baf1a46dd8a1026fe2cb43283eb6852f7aafbb98435a96aa6eebb553ca7a78b3cb9e421770a2b1c20e66d6a79b1598393a43f32b6b003b621d59ee98f3c200e6385da195cd815840e3d2493d83f8b1bda27d721ed23cd1587db97390f3a0840c6fe963488335714caa5c80b6983540fa6e7b864898c2b68c3248c0a49324f6b0e79efa0b39fca33b47f27827a23ee0dd097471c5069970b861c6090f6f9bf53b1bf218c53570f3ff00df22457bbdf73e89ad6f1717dc7f2db36e56d40c191d7ab47aa4064aa778b1bb65c963435dbf92b59165123aa30a8180fa8a2145c4171abd5132d54560056a305916caddf91c66956a491924bd3f5b21af1084c45d03e1ac44c72e2f518633b6fee9982b31595bb6479e410603b6c8f8c8bd233d29071786f1b34c3cb3f77282b0ae4c817a3d49ad3b59b50866c16f7e896f6b585c1840bafdd139e42dee38cbeea17740ab181512e253d35abf8177db49b1a4034e801ea446190e76ffa8480c0b306aad4fd743ff024cc8be0324f141d8a7cf715958cebaea8e90aae76795b7b86a96060f410614e7c500bbdb8301a4aaa88c6d709c3012e1886bffefd309a14b610a358470ceab1735b97ae1dd69535d599dfb2602f2ad278db44030edd5214c040b2a59ab525b383bdfb3ae5119d94ca863e68f7395fadc034eb7b22b0f19f5d88823f60add702c1cb5cc4230ad1af9ee7c1a93726ec9065279658a344502005d402177ba5da79d93d96754f7f7377beba39bdea007582ab85e34733fdf77fece131aa811c714b4d115bfca8675f6af1775e7ea96dcc6c55c106c8ce72016cb135b2c07645305fb66fcba28f3c9300d28a0651574cfa1260afee0ae04e4a4f3f0c48339b8efee7a767969871dca03deeff9a4380679c5fba057489ec40449855636a07caeabdcf6b64704cda41c14157b7563689d26d29d11de701fd4aed7fc8117e90ee5e5ff8e4feba85e9e334881bed1303d035dada5ac877dff7251a1ef483076b3d7d383e588209dd40305e50bbadd715daa8afa9333de040e2dea62fc75652078bb69536c1724c428d8fdf8ffcb12f75954f815f91ebf77fbc984e5d43a9a7d8a6e213b95e393d4f3838876a270e54470f4c93a2df549741415a8dc6a30452d9686df38011b18e7aa42ea66d66defe7b691e8b44d3b3aee6e040a49579ecd6f58b1bd2d0145a70bced002d280c09f80813668890a6e691824ba1ce7110ff4c08cd05f6ab36693f2b1e2322b7c47497f31208f24a9b6fc584dfa54aa0950069b3f6563704e480767ac224229a8f5fca8c50bceabecb596cdbcee6ca3b0e1be244541fddb3324a57cafbcb3b48e51d57ccf46d1f9fe04401728f77673b78d5eeb002ec1009ae9c3b76dd265d145243fcd984d378ecd5495c5f8f6f0cde331769ffc81d957d3c4a4d05f8f9732a81582206615d70d8e4d4b33f83ef335c413ca50a78895bf7276a87d9e99d92a1576a5beecee904a83903d85edce00dfa034462a2462e78fff1d30b1e78b34e20ac32e965ec2584a7df81b234e4ed687b388bff0001fe19ef3c3026d14c12cc549e1bed2cb7f668a8b5071ece41bc75354eb210789ce4265140e710941eb9e0676459a32a9a03e34b43ec16463b12ec7c937ac3951d6d85788c275bc1bfba59aa9f424efd7797ef8bfb0f80a4bff19274af7e3929fea3b9c5f12f2eaccbcdcf63d3372d15de917b3b0e54bdd2f0d0d9dd09bf5d554ba8b41e771f83c19d3e838071234fe1a4e9f47f5940d3730bacf777185b9730f397a45eac9c047a103cdde54e7f1789f867c2f5a46eb66ee616fc1f6f5d150bf438b457b93ef641cb77638f32a64a8ee337705a7f8598f56e0f1b510128a198ce8cf0c2da8c17deb7d9507664ebb51c4452c48e1fc0de57a8434235f160f3d368ff754945281a617cba6fe834c2df6aae524769b6d25a2d11f6046f40f950e9003950f70c391e16db876add04d5041ced279c8668ac3e3f289b1b1ba48757984976fc74b933b3b3a5d934d6497371cb211302ff3d988c284e4f496e8030467c6b979ab5b1dfb44004d190da75a9c971297bd4b1bd3601fc14e73af759040e11a34be210732a9a3d9d8581dc249d8a10d9b335afdc1046669867da5e893933d45bf3d1f0ee9419479a1e86dbae3a5bbc9d8b167e36c939e52d166708991a69423a2fdd9630c6645449df9ad3798c92566120bcb6ad428f58f499e812b3354c90f09324b326edd417b00c8ee37eac7fc3ee904ad756ec394ca5b0153618e80c4a2a78db3f3aad948ccdd60d28f0f9872bccee4da4c48c50443ea3ae33ee96ef6cb7de266680f8a091728a599f8308649a9ec36f2bb366bd231927ec71b1bc74e1403b4db6c972309edef0568589cda993da5530982ce701503757bdfc896424e83a66c9e500cfef3ff3c3555b8eeb4971c58b9398981057e39405e5852befcba3acf28a298ed00fc6c806cb1239b9850ad529c5a456ffc1fbb8250cfa4657e9d082573d1fdeaa35312d66161f7161f33b5d3f70fd28cbe8750ae4ecc59bf6abd78358c4768e9b82cbe24f473f7b1bb79384d152da1cf9c7157353514bde8199d76573291c17543e075ef3ff4c692dc236ded14a1573daa7e35fe3c08a0b93f797afbd252a58eee931dc69a9e7c582e414c7f1b65657655096dd2cde8c1b95bb291434d568c3ff2b94b4d88ec480b63add35530ad76fb80fb2bdcec35a127c40c8ed2bb9c79aee5edcef7db4dd0eace942c2baa1d9e5d2df3e89edd6dcc37b436e9052e3e363918dcd68573090917671c0c798484bebecfe18ae353ebb834055fc77b8cf1b973c4487267ec573f547f8f8a8874b13fdbca8728bdd95712955eed130fd083e2caf632e4b980477a5aa1ed74e9d3924b00fb027440bf26decd6693f0804f5dd930e836329ec72437614720c5c14bd8529a6da232426cbea0c753332aa2474d00f3bea69cb38df0c19cdc91111985797389c2a83f6a1739b7b0436dc6d9a4892670a18ea99775860eeb27c99f2c8212d0a734fcc0044e8d51ee81d585f7bb1df98d60b54227f2462ff7ad23ce7a5834533786ff03808acd8d98626aac6d9628213f68c5a4b74163890fd943a744dedd4b4ef3e50d6d0e8c1d3ffc4201ce3bd84ba3c4678c4864254952f58e7fd11d140b2071edd88a6ed61e4c6134b9461d49f6858aa5fc3268929e2c25d74b279f9066859622a10dcdadaae621f18cc0194e0a21d6823d9f88190434a813492737b89c832837cef1522c22b1f9049c164d9e21a818726f83f07de925068468d8466be662c03944a33017e651bc597590fc50dfb169d03ba0e814c5cfde0c5869c36e4b2ec65ddd1beed2da27f98894df90c16f6167fb999f1c5bb795df8b42ec6a1c830e81a8d78d4f9bd562b6cb4a6c2b0f0da42493d965a207eeb103ddbc3bb907353ec460dfe405ef2dd8cd418f804853093ac2d36c5dc726d2bc703da8c15ea045e49c6fd3f3fab7674fc21b2a42493930e6d4b845dca305092ecd961d0ad665feddf52a2d370331f460e257113ed10f916a31910d32b4066af8f954640ef2f8a8aafbf4e42f7052a631c65b3e875fd3423bf5480c62e59bd177f11fd0b34710096fec7e5b78006a3117971fa07c3ef761a05fe4dfc1575184c83d29a6198b16ad3cbdcbe6eb74dbc0bda20b7fc69cd2dc1305cdddf82c300729cc98ae8803c4289e266bd270e87b23f650a143e2696487d3e62583baccfd74632d6812f24e6aaaf213897befd882e3a34e8dbde622dd49c60ad7bdcff3de871b6919940c3fbe3385b22cf7dcc7dfd54848fb2bb439dc1cc76f28a6186e01845f5c41f83ac977155bbe7cc6f567b8ab10d75e2e0fd84f7281669cbc8184ce019986e7450258640340b6a2173a0383e518388ec217a1cf11e5d31268cfda8d080efe5369962ecee810ead1c4c6ce9918b68ee60717ba68bbb20617604599c3074024c194d535f636f8d1620b30a5f8d14bfec987fe6aa8901c00e3e6832213656aaa1efd5e79fa6d3a6e8219da0d3ca06b2de45e43ffb9e11520ce5c73921e3bc652c8fa01cfafb005035fda50af319d594ce3d3963eeaa8b274cbcde14a3f8b7ee0873fb630c62ad9f49fef362240f1dad069b7eefc7ae85949ce4cc6494ac73d8e3f3df5ade45cc54d36f1128c55694d524e3b7659b4829ee36d3b9c137945e266c740f148cb91ea237e291c3a72561e74879b40bfad5582932da3ca4e1e08e4ea494dd3fac739da99c94cb30db51cf559772dca31abc2d4113070b1a80d3632d528dbff31ffe80e11f2b44c93357e1bfdb2b09a4821d7823748d6aa168f71c21c1abcc6751f3003ccaddc39338c5e354a5ad216ba6a13958c61fa6e25e8b65cf0c5354561af087cd51da6283cdf727d020bd75b835388abae4dded0dd0b21ea555be8688b41a1e0a1e07b0d6158ae8be55182779ccc9581ee24096f64f740da5175d0089980d6bc87f825a915ef08dff28fa9b254b882a96c88594214f9496fead69d453d50356007fa16c8945200b565fa6fedd3723f5c5e16e313f622f07ab5e5785e643d0653c97971812feaf37d51d516e9c180e5deecd078dc153d656a4bda369fe396234b84613175ea2cd895242b5ac982d1d815fb782b3d506ecdce83c7d459c9ec8aa1d04e5af2af9818de16c6a56f279652aa088d9968334804072e1b19af0b4758af64d9a56dbc37afcd8a3234eb07eed56355ace946b3bfcd3f46fa261f82b509ff0ae73a36f6fd085eab7d19e859da77bcd2d4b28b1d85b919dc7b3bd97b5af450e8a606bdcd95314e15c816cc659eeedd4ec5a733c9bc67866402d105edbee87dd8c29d9e807e7f41dbb25165699fb7989dfa74337503d43e56ce998a44c4c16a645c31eada1efdf2e31136c12a502055227f07a4598003d8ea0d97644e3a4f140596841c487c729780941405557dbedf9b346a25d83ea0615d50d428a1d6c0690434cc10205717c7fd150f47488b1e9b5ac5f9831061b0f90d1b4f690751e225fe4f4c90034804517c56995cf7200ad64cc388203141cd57b291286f9e326061b969d658334ebacdfb013ac7d69bbcc40ec06b2963b20f40f1d2cc170e78370f4800e4f79b7e35817457462e8fa3ed1cfe9cda95e643eb327844f5b36c15b103e498efe9dbf73880c40079ca4a38979d6031128a2cc89110b23c2094df0e5da17c0b2a525309d869e69325cc3206ad66f214e47d9dda1fd5ee6151d5438740152ee5d00f91b46d155b90adf5d20849b27a3ed5fb092b98cff3d1ff7bfe3b8f0596cbbf3ce1ba4b935ba31a6e997ff66efe93f472772d84d38ba3361428a04608131966c752893927c813368dc0f08b68619af927c5b1f2f73f8f414ff07258391571cfa3438222625784f62e435dc077cd00e402cad672954345fca69903dd1103d79dc95198c44161f3197cd46f64fcca4b0099657ec5bb9c28a8ee9942c1a4ffb952a545bc566b1e923bb02d88e0ba7f43b5c536023f340ae299ab5886254d91382468a107254e534500520c7c9d03c8b2435ee7c3869b918777c1275395e21b0a3570c5753e321e801e78112c2049362760caa77258e58fd017d5f2035d5d0e0f1cb520426716c2eb39d9feaa579cd8bbe25cd34a1c71609308e888c47033491a57734e8a7769fe568ed1cd67cfdf21151cf7108483cb966b0171df9c3852c1af6e1ff40e323a3ebb50d8c52033525973f5d789a8545ff010a5dfe4292ed1e036d4e783464af643805e3415dede2296e1ca3332ee75864fa18994e73724ebce7ff9972d9e6bde41c4fc4a6c98d763503ba0cf9acb71712f4b7ebc2bbb3407fe1f86787768e638179fd44e2fa3896def31f1fd1a983c64755835e19329ea1dcf97a1a2c0f680b8fc4db94cd2911ef7d2f0df06a69e70dddefd1b1aaff21bb57f16e5e314dc20e15be94340b16e389cd366467c1d33799c31cf0cd59ae3f89add6545f54d3b3c902d01b29371ebc219eccd4195d263b08e9253d9a3b23a45328320e17da8b6cf1d95311345051b225a7991bfb28450748c013625801599cb94d2cec903830977c502f593791ec66dac70ab4971f528930ae29f6d182d8dd36d07717a18a50f4aa2c9b5cba270b39c5ed3962be64edf8959a2df36342bea16c3b2ceeead6eb960acf6279bf31396f13272ad812ab24a7194c28152c9f748dec305d4ea90b66db33fa47f3dd850b55524f9d573370a654f25ba7487bdb38c78aa4079f1a4288446f4bdd43303058e63abb9e7353504ecd154155986175f5df60c66a95b08cf4cc962b08b23e086507c29a8f96340649e8657ae4bc6d03fc0f65d0fd9098d76b2e3290e1c9dc2d5a0848708e555876cfb471b1669760960dcf788aac995baf42e7f46729fc975050374b74444455fdbeff0f5edc959f4d012dbdffb6d6bfc9aa00a8b25064d42c9d31edbf49d79cb9797e0297f870daed0dd111ad26dfc14eac3c4d5ea59d8464a80600d44baed4dc46a0c8b5972774369873c4f173a9a4177fb88c50630bf43939c74585655843153eb184478c1f373d9dd84814d4060f65a4c8e3c988c07c512561e615d13c223553c90b18d9e9af31a59bf7d4f952e686643ae3061d6a5c62364932a7c6701961c2b05c46de8fcf542b9fe0a3498411bb83668339883013c8f149efbc0e82af56f54983ed993898d8625e069d77ac196c1f14b0bb3f91918851b9c6d4f1ba6e2553721f1d3d9866b908c40b60eb5649318495f9b4ea489c1d96f37ca1119023c20019b9e2cb40ab5510a49ba407c06c8575469b9108dafde93aa50f7d2d2e3fe5082d518f1b3736593d788e0a29472ea39d62f3ea13aeda6977eabcd77ee9f0f912f6f0f1773bbfd08706e7fef195ed16039df06b6e23ad946f8e1d3d715ae746d1cd13623f60444e7875e1c17420516a424128d48cf794270442c02a7cec6a91fd8f3e4c249c475246421b20f85deb1953b9d49162ea63c8d7f8c97f8269e0507d0d0a4327d3de28f29d364733502a1d0f1a55640e45856ef7e378acbfbc8c59e8ce3a57bb36458c6c132f0a55a3586a4eadb030230d9aeda83fa4e7e11b97665260d7a9a74509355508c1bea55e66d5e82bde46fab250d7ba686c4e3e7d77db208bc7a5f1889812eab21fe088a36417f8337b4d510e5c8cfec643787a1e93b71d6480575cb51624543f085ef9bc911e98ef5a4615b2feff2a6000a3007929b1a51f6fd328947bc68ab290aed113c084a453672ddb83402d8a893d74d536fa956f281b10ae78d297dd369c8d84875117cca2d78be73b44c49ec37be17ffccad896af01799f043ec3be2461d245677e4b6cde12e13eab383319b4f0cbae339b516483b74baff4e5472bf011a2b8d557867e69b0e478c46df7514c8a1389d97536c5fae01afe56bb1e1346bfeb19f1072f18e7ea1ff588605bb093ec565a3a4038d07165cfbf797ee0b13fb045bb7c9b0534344f2a9729a0b85368f1b251745906d6a7cf9dfbd53d021a11861b53bc43bc3586831b7b5f55d79a32b25939d5450d6e0e4af7c2cd3cefdb7796d2acabd20100241ed60b28c9ec27f3466269410c414991d336723caa1d3388b9bb02c074eceb5cf8bd502ea8887b8510f7d251d4273d1e44599dc8b234c109012dc90b67a2d1e61c626ac211c98f64018d6dd76cb0fdded16e8492d3424751207305f5087af901c126eddd3ccc42e1f1dbd54941e0f978be7edccdc968c95c73c261e40d5c96164f436327a6db1b1741ad22057c81af4db6fb4f17d2aeb56b024c3700760296d5a1633c0ec7a45dd530199fe09efd352969e6c1ce2074334c3945eb4436c062777207ba31305bac4e81b24a7e080da9782f7ad7430ec964624346f2cafd41e5a415ef91da19fb4f91e8bd17cece391525a2023daa85ff0138c04970d3904c951ca148d63b373826aeea30c231f13ebc3c03b73d7697ee6e950c3476c3cb4d36a0b7da7e5ab27b797acfef5d18c32427f558f2005f808253f7f659c2e884c67a029e557144b8e1e6038ca6082cfba4730ce5f0e259f611c0eb2653f0444c6cb623c1f4802500670edd78abf85b383226c2c743842097f2a025150c6342bd8d1da94b3f30ca5e803e252e538f2ef48e518eb059cc791c7b64e6c1cee08b9130bc3d12c275a158de68bc509d8206fe67fa112609fb714050dac849bb5f0fb9ce907a40bc5109688bade1629931326d384033cd3a8e7be33e33e5deb3e8084dfe1dd75025b4747a89a574605d5e12ab14abfcd4227c4f1efe2665fbc8708a7599e9c620550693e08a191dcfd526c078f945a05733cdfd1a6fa4408665688e35273849a16e8929fd79309cffd82eeb4a176ea444245b4d7433433dc27635d5528efda6d74353dbd91212b1e6c388a079845a3975476fc06ec37f9bfbbcb8b0831e49e03fddb307fe5f38e51974429509460497f170753dda50d110a3afeeeb75727788e7cd9ab2b351175c18e7be4b5f851b01b9c9df3a94f173cffd970f827602f4ea5bc90f426675314ce29f0de957b2e5778d2abd05f899793d50110453a35e94a6db1b60d9969aa5e669cb6567054e4bb10ceb4f2187a64853059e2d0c5717a594ada197ef6c6f078e961b310eb232393d8b4fbfba19daf91266fbdbeebf4bddb086f73a3d96067ffcf28dc548c54e0b287f3f41d73e2a3a70c69f6c6f4675c3ddf2c142666d0d01b0382c94d9df62ed6923b82701881a1bbe869e3158ca136e387a7337c18d1f88ce1107436186e313112eaf8e35e407900847353bf022cb41a6ba705f45387f4659f2cd58c89712def5fe2791759c52089c73a6dc417ca7d17aba821367a13c41ef720f2020a944c5c8bb7793597c11d22a86a2dc48a597c076926109ea6f5abd65d4605633d5595739f9fe38b378129e543a394c031d63e1953f2cf8dea5760f919dd8c03b1e9d3893d2f1c63ab76d8ae42ad4ca609523d34032ff102ea0cc3ca03ab88a9680881944eaf5a2c82372cb966f8a2670ebcdc9fd37ad43509119b0b0bc49733fb477727024366a6bdba2152d559d5e60b293e61f0e1a88356b7cf4e2541fd066e3777c5587a52e2144cf877168a289f83543144684c8f651c58728b99e5a871651b2870214f12d617404b4ffc15f6705fea1ca5332e59e709266c41444382f937430c5587edfd399c5145a6bcd68c1411d5b42c1b1b0b3e8a7f76f0cd49d062175793b50b3d2aa78f3940549630594f185c9463b72d72351d2d8e45be1cd884777bc5b231f79a43af50bc065e34d0f6cf5b2e3464555ea6aed4705b0ece8671552c18d8012b41d53b8a7332bf62ff1067a23f00a42fc0c1e5f749aa9b2c576ee811da93d2c5485538e203a7b0f0647a4dea9ac3c84c262c1c6fcf5d77e2d5ae8cac446197f76790078ea65d0889db01e4fba9c9e70a5827cdef0610c865fea42259aae8fb871391e89d71c5e69c61076d5e9132e9bde859090ffe77a09b788fb617e14e8b48d14ed63c550f840d7c94118e8382b13da85310fd796d03cd881edef7c78000ee39c2e871aef730b6e574a2cf34d32bbe3933aa656e75d85f4dbcf0a8d36f08b49ea5443b385374610c5bf1a3ecbfa9ab9087578dedd53f26563e86a49527a4e327cd41d094dd30eb1f9f010e82946381456c64df5f8d60a2138d25663fb4ce82beaa7fb7135f1fe18f59905d96cfdf08cce2f0e72ab1299ece94aceb6c76aed82934425ec49f70d939d3d68412158d27849153f97f02243dc696ad1436e758bfc5cdecc2f0f2943dea206aca65bbc460988052658dd9066f58b4ba414bb3d280e7e1a256293c04a3615dc334b6087954149204a761732e29f0d703bbf688490d5f556ddb04b741d4f96a1378c95c9d2d2f7b4d3841f7030285e7e84b513e3c8871ba82474029db794dcc784c47ae3dd96b1eb4310cd3a2f58f22a5270f7adfcc0ec81ed7f01a0aa775294e6c37f363b2b87a991df718d86ef7cce6c5c54b9b6659c4247f8a49b8b0472208d34f0c91b1c9d41cb693b5d3e1b1e249779933fbb7eecf5c37615651f318772108a5f50f2352ae621bdc049feafe51e2e31dcc49bfc9f1214c3f8943765a3d1f90074fbd0a0f54d151a438132061bb41a0fc07efbd77002dadca753b3606881d44f8ac6aaea465180722f31eb1b4d9b28b2e99133f12f6ec5842637922fac6779c34ccacdcbcac0d929fe5ae007a0200b1237222ad8f2c152b6b6614d21405b7fb22efec6321d306ce1bb5391940e00fea5a46058249bac8cc3e58b12c755f1359ca7d8e7e12b7c0127ce95500b21b2d1e55d6ebf6012f6e854f145a2817f9c089bfd719d6f41d6faf41f25345a20e06387937a77d1412ecf9bac956a8da902336c0b39084534f92016ad7752e0f74e09369f4da4e349729c6bc682d9bb337ee7f3dcef3e82db82bd269ae0c66b6871926ef1edf7e3bdd5f5b1ac46ed567426f2b3ce77cbba021bee38e93c227aa5a17e424d4387bbb9078418694f34dd18bc7de996e2d2e4a2a996a92573c4fef2ff2e0240a597f2eca9041d091ec19d85f63c59c61ba174549e8065a919fe5abb7a10cb2c600a55e1050bfd3d8ff0832c4685ba73543ed3676c1c87163c281a0cc7be2ae51fd2b3027d72fa090b96c8c9674fa04b40c54f0f8098f621574ebe2cff40ef7257b9dfb313f59f95bc1c9e434171cf9a13337d215aa09ea97102a630fcd183046f0f6baf32e7efba5d2d8e526b99079d6d6154a10cf30460c4b4b6d6e8048ecea7370418191af03f8f5fe99efab862652960b6f4392afb7bd8fed33a6fe139ac54f1539547636ff8a8700ee03430eb9e707a42d061fcd0db1ef708950f92a332a273906629ab9b343a5b00905324ee9190ae348a3d20499fd9008ec2ebb21bb3fa2cbea4ec3494f603528c5ce36eb3772214551b328f0e2daf57dd8bbb50604e8f9c911834e199d741385b2c7df74fd2690972de4448c4f51798a62ee4d2ca44c0cdc719466ddb72d70437c6dd12626a46b11d14341976c803537ad8c5efe900cdf2f5a52523377799ddd6594d99339003067e4d4fecd6918f72200bcf5bdad8607a417ebee76ca84b29a525a90d0115e8338793cca21879ed588bface8ba8e9c00d08f9dff1edd481f11e1481f63242c9979ba52fe804c23425f840fb697a626e2353b8e3889aa691b9cc4ecd3edcc70ba41d352ba38ce95dbc8edaa4dded11b87ae60a5e9174441ea540445e686b9c16dcd2912efea7d3d4c83f3cc706b014463c83841ab8590e52ab83b490317522477f71f81ec438d5e0a645acbe93df9848b1b798f1bcd3c0304a301442b8fbf6b09a1fcdc157551af92490b5577d66a6b77ca8640d90e84b7cee7afce956d17284f9363f440a4734eb537735d4bfe07046c2127d2721fae716adc61b41eb9b13c20822ffb977c399f3f3957ca1a0ff6017137f7dd314c747e3c7c13018bec3e883a17596ddeb109731abaaddcda152ae2c93cce2db2a54e1775cb04561078763d097c753ff7dae59a9073d2d16436654618f787da56beef142a5397ea464ce246ccd32de48c167d2815c1c041c77c8e49e30e7afc61c3d3fc99be2cd1678c3f0d4b0a77cc81596af706badb2d5569e92ca66f31691ed72721a41b6bb91b54a78fcf46cd0e9a15ff6bf0f6b5117f7881c36367deadc5478fad05b06e77e0884b82682766ad96c03a88d8c8645b8a4e8ce9f3965f1d02e869279cbabb67370ee89952d63b0516892b1db83cc9f71a07d31fbcc501e3d480b61452b330697f1f861f747d75fe2cafab4f6238d6627b6cd93ccfe8791b86f7766b01a6da657ff8c72509f82d38af4d153794d82f8ad08ba7b50e82a0567ba8fa9cd37a310f3a5f92e8772c9b1d809c759f883c940dee4fbb6175399919b781e2971fe7ccc0ebca2646d7eb22b8abc6557c1a8f77eb72e8632d57df25b0c380d56f95974fc417b37e8550b71eab7bc73e54ab72932e25e747136f4bc2a40859c0650eebcba2391c3939fa292d1ea05103cb64015ed4ea3f3ace33f4f1bcb1e99724eff26393affd500cd879cb2dff53690c672de7b35e1fa1429de04a69b88e6d4bb73054c35e1054588a6ac7d13793b90926bb31fee7492d1333fc794eba29eb199adbf02e7e7a27c57e3c2bca707f9d5daa16087587db7975d4e2d923744906ae0a9a12c61c2c822b2","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"a04e2aebb4f065114c065b7fbf49759e"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
