<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"ee698b8f17094abd079efa73be54823d8063e1b951cfaaaff5fb57c5d9538bc51bd312dee30b79d56dafb053c9667adfd48856df35135c31799978eb1b12d3fb3d2252fb9cb2a22a337ce8176c314537f7740161764c67ed5f33ca5c58945be9f4f41e8a2d50f1e3f064b55324862e7295449a93de3dd9b2b1ab1cb6f8358dd1e0cd27df53f3bb7726becbba5a68eec05c670a16c4d4da585e90e88c784e7ad37cca2ce0e1ef762ab89c555d006bd4d2b7003b79d06870b9674f401416ba4c5765437b6cc626d03f7f2db30b261a6412924af2ba956b03cc4ddf0aad4b536438cd7ab0b6f8747f5be2fef62215a8757b23f030d8b093eba953075b0144377a3e018e2af240d2b66c61441b978530aa3bcb7c7f9dde4cb70722388a5cc254efdcf9fc1f555e1dd327de06ff7266a90020665b3d6492187d25c74990b09ad815f4f2fffdc97a025551c4896c88bd7b200f82285a2f2e5b2ca04ed34c98f7b7bba36c81325421fe4256fb8a931eca9d8f6ec74a73845b8f84150679220bb2a26f60729cdb522f11670a5d2ec8a9f6961be86a68b1330a61860274ecd5af8512671df54256750d7fda785c36bbc6f4476e834d34a87973c8842c8aef915cbe4c73874e2f54f28f536dfda2595122492f0bd38ae895c101846c608daafe2ad5f81fab5b10f62999e44e54fa9ea1d0734a3eda243ee244b4f9fee183c9bc7b4138ee02053c77a3e21b6ffe1e8a31d19437ea5c9300929b2fb9f41466a692dba96a660598e816f034806117c0906453e1726a13e86384de28e8274de083691cdbfb5383a6423a724e5064d7747dd9855e275abf2f0b610803606182d5d13d41ab0b6085dea7cafb9238f56cc63a9dd950fb02ddef0b4a9f2c3cbfc50a0d2260f521f8c96fc46befd765c38536a5ef5eb8ef34439908a012f579de2fa061d6c40950b5a263d9332191830857e9bbc7ed6aa90441d687210cf0da5be15320209612e5e1e1d8c978c2202043ff102ba6fb59482a98c65b7ae9c10666acf437510fc3b1ef21d89384aa1c4077d0f7be7aa05b2fd0cdb4ce96f8617c3a1994a3c9147e3abf4406c1ec9158de5b0fbfe5c1b1b033abd27194e7689dc3c1f6177455401b77a215e5cf2646c1519713472c6081a7bd1a1f1b4a69babbe37b2594147fc2e910f5dec7234fe1065ad1c6d157863d65d9f8cae470c3477f1395a67428596942f94e52554bfd33563577848773dddf65ccf35f59376347fe4bc9f72b439d4b3d7b61813a06a184d323a59199ebebe358c6c6123aabceda005e562ae6756f97a1e7d2687c70473fc01cc38548e59244665b9953a7e23a19fd0a35657a27659287b2f6b65a1b117255131fabe0355e1a294ed88ded36ca947b52354a8976f459a6f0117cd3094c058e7e4c10a36733d11429eb1135dd94ee91a2bfd61158988d30c3b7b3cffcce145ba3335347fabef5444e99d5c751c2445b8d7dc21e2a9efceeb99067f2bbd432217a484cb0a17823f451667c404b936d8893e49cca581510f700acd0c153ef01b8312a76df3e90500abc0ad21cebfa422bb593da209bcdb6cf8d2cc68012368a7885f47a6856b3754fd8e88c5ad10df6f43df6b61bbcc11e1a9871dd6935a37540b4e3803926b9d51bd6bd62e6ed36cb5227dc9c79bdec406afe517c17b47f39eeb6cd472b0a34ae52f2317c8329f2e7fa38fd5c6c13c4dda6208ba3ccbc9c6bddc4198547d1014d6722ea486222c42edfa82b96f2177ef3dfc37f48da31e820780fa87fa5b7834f8ff3e62ebe708205cd47626da942874520fc53a166506382d112a564317fc80215da8076f88dd429569ec086f3824ca7319d2afec363de174b5469f4b3fd47c32fa29c9592d019e19c6a74b199b80b82e6134efb6d346a09a6c418200fda8d681d3eed07aa1fc777dce6114aa36a1ff2e68df766f742928884844fae656d97ce3c3824cdd1f258f33752be4c516af5a5f8c661b8da1e868c45d8d064ffa41b7768eade2ddd64f11a31148ee742cdd02601a6b23a09d4fdc5faef912c1b91b5a9c50f6ca31fb0d588d823e53515727c92182c025cf3186b641cb9b258084720dca2ad585e8e5609db95751775bfac080c7665dc15a56137bbca0a77c468cf3bc571f773b62b4303ffd7507bf100a0260ad4002539ffa9d187f87d4af871a3278c560c442c3b97643e69fcc837bf0504c0406dfb7392f7c8ad81b430e0dc5091b083463f2c7edbf83abdc2a9f6d52a214ab5f1850aa58a74b38b4dd7ba7ea921e5f9b1a73d70fae4da4255ae419860a902c8348d4913b1df19fd1f6e2de4718370a6028aabcac82792abd561f16241b984fe5f7f26ca860dc12644fe58f78c15b27dcd2604b6caae413519b856bc1f4485eb64dc594c9fabcc3770a142bee613a4689d964176fefddb325ccd36f99245ab0f3f25989f74361736b4520b3df7613d58583855b971640837577e54931328306e1480be16e94e6e761555d74595ad68eb026cbb8a4a12a37472771a78dd7b369cb1f3bfa97962b609899ff37b4c955f19a4e81059208f8a323995d65be6a5d544a037e2f4177c356237a09b5ef635c9e1e9aebf686f5456de7195eec8da39240f686a299fdf61862ec946f2e68e12144e1b103179e75c1d06eed0646fe1b79c0c6ac37a9558f73d073aa72f3870669044f5251951919200eb54e3f95613ca289913a62013de3ea783cdd83d99ee709bd216b35c80ce6f4e3d2f3ac3f7c65da6d676c0cb3a2d3f7bf4b53be5724677a745cd2c83a94b8ba2cf5a8744192b38ba5bd70110a5888f2ae2658af45d2b8d1604cd74306e2c0d27ddc72c7ee4e4e0aefd44d41801f164be94bf791c976a83313533898b9ce728c9dfe09b2a3a160d14933a7b1d788c2b40f47f500368fc09eab203f19772aea54d2f20dfa016bb6f321e8fa552bc48a0697e675576d0f2eb24c5447110e28617f8bd439ae36e9c1707637e839b1808562c8429cf1560b4259133b3b4ac8dccd140052e786d9c417dc7da362056d462e6ebd9f915475a79d5892bf6ee62a5f53811bf93e23138a131d01f0d06851bd98e07dd8fd3a6a74f8291d34cabc7be9049c754c4031e894b7b5fbdbe5d5ef6bd2db700d67ad5d52cd8255bc116aa5087d79a54c585bdf3c42991667095ede8583c49ce60dbdc70126cc875acabf628fb281e58895585828864f4286ee5b308ea9ed7b1507083f62737c43311fc62255b456465970f354258d65962c304276b58d0ad03937e5085387ed768ca5a0469b78ed706d66403b66eb34b787ca1a9825475e4881bff626fa2d19b4f40cca43d5f8690388c8ba85d9c11f98b528150a8ba281c26be3dd198f6e547aab027d5fd76c64b59cd8fa07fbd86bf6e293e8236eaa31b3f9566aaa1f622a08c52637cc170e208a8615cda02d0af230058fe80fa90b48b9a8b9827176a81bb27dff52621b8a91079a5b2f19c771d6f0860fe6d97545b8a8a4d512ccec96d500cc498d0b90c641a1e9c8ecf0b87e8becbaabe040bbec7daee41f3eab5d7e5fac4007f8fcadcef871977da6d23d8261719cd36ee0d6494725339a70f5b01bc392f951505de1aea4a5c9af8701b88647f05e006dab942eb553ae2165ddca93f5eba2eea1f60e13139ebe130b166d2a614e537123a794a4d2bd299bd0ce057f3d83964777b0c9e787d925f6a44c961b8b8af3ca06a4d5666ebf140cf886068433a6cd56d7953fee17bb2a0bb7a81110defff8e4c255c459bbb76f93a0b17db6561bd1505808150ca0d69daac22d6d8c7563313cc0bbbc55c99c2e10624b9941856faf347fc6778a5d5c6a57b5bc1c5ba0a94aa08a8abe0d653f60b91ac17efed5ccd3759bee2b21caef81b7e089cdf313f11de38aa62ad194bfff6a55da927bff472c90bb29a31e00e1e92a39455e8af529e4998a05a72afd3eefd113ceb00331b8888f04f588c6b87bdbeebe320abbb3fcf597ad89622dcad72170dac1e9222f920c1476e1c7f0b9a6e04db0308f006888592a26591c584ab7b673c87a349e99d76d8e8c71561cf3f4b3cbcd4afdfbb3536548ae64fb06ed5c77d8d656c0bb0d60a6fd9d34abeeb905725a42b2d2e1e906e2d9bc48bca0c56183ddef7c01b1377817b4772796055121798bf8d366aa67a68a5c54b957d72728cdf9a97cf9d729a062e97e16abdfe09b3320eea64590d841611811a752058f2ae607ee69f88217bec3c1e2d4af1a255bec5c752ea9e6b7f9f894e3f2a6428f456235cdc75bd6a6daf6d7dffc55dd579f81a0b92527fa74628b32b5c0d407fb31ccdd6383a7e8d2e9a4de37dcfc62d10357cbb26df213b7077933e0d4e146f6482c2bbb722746cb651b493cf4bea041a0e5a8f691a216caf6b158ec34b86a30a136ffb4b3f1e2a6c2f9a725e1d6a8a161065bece70dcde45291b8457b6f1a424ee851c52823d113034da5ae23b7d9a0104a6729969c006bfd6ac899e911c89d3913a7193e6b0d8a10d95016db9550256ceaaec7a8877672b8318ee810101a86f480e4a9425fd6bb014e686db1529457eceb8bf3812a0d0fc853149408fe4d1459baae7ef4a92c0ee666f85a29bab23635cd5755c69304e2b0459972917462536066ecaa642d1fc49ebc16b8059d12ea5cf4c6a204b38ba79bbd9bb20d092f38b7fd2a2b7bc1753d59a8cbebd00de8582dc27ffdc673f965026a52493b06966dedb78acb78d80e47107216f6cc795789c4323b8b96dccd0dad8acc42fd932b3052a79ec2e266b1ae101dd74492be25ebef851c003adf386437162bd28f7ff3e0ffbc017c4fb594ee25aaf63833d9082cda755d25f54a74c80ae747de61e0b40b0b8d6bb7c6bda785149fc4f8a6f78092f56831cd83fe8464ea805eb8f591bb805fa0562b8c270eee019f55f9c469963f9458e57650ade619c1c1549ef619374a3f86486c8659b00b0917682b65b060afabc37706ea6e3a6001e513332f554642336caf177f45701e781c760fcd981b058ae3f9a4e088e1fe4f014e3c2e44558529244d630643c3210770737d866c528473537cba32d97abdbc1a38de828ef7378794d4d59ebba235935b8932b510988913aedec9acc2dc7acc9e73ec89500518f09712dc40ca244a747b47acdff4c36565d602993d26ee5064645c6bef6cba80d98c538089a1df3f1614488f44dac78424159901655f1c97880235066dc6e87bfeae2dfc45430bdafbedda77968cd882fbf461eb35ff7ae1598f42e4d785a8b14331e9e4186125999e0de7ac5f690817f850dd65b849315925af17c9e934a70b80c7727fce10647836c5b9dea0f33dbd03a83431c4fa64208d1630c1edc4f911d660da626fbb2715c5934a9ca962da5fb48e98dc802eba2db215ecf52c1b9d60a59f7635b9082c80d4473b0a43f8255b3ed03014d9d9309f5263daf55d9136ea2995498572d978285899e8ca6b5c2b5e3de9c6168a7f0fd27546e0adbc8f935aa88ffebdf74d5b1a7bbe720390a2b2e6e08287a61ef0c32a75221705f732f4d85569c1920b5aae9afb57d274edf1e2f90eac0b61c180b8564912f786b408a8cc28d2d411093420a0df5e740d5a3632b3e4d6dfacfd184429982f2480c9472eddeaa3d3c236d55d28e8778835c9ff4c62d86290dcbfffeb750083178cc910a053e9bac873c68997dc57d28278595c314b8c03a14b26b3ffc64ada324061f6ee6ed0a11a7367e0f738baddaf63db853bb95086f39c8cfd6a6286ac68d56887d39bce48f3e13236b5d59593e66aa99c52e709d321125e85817f4518fc9b9dc0c0a68960eaa439f253d285b9aea396c11ba0a774b3b8197149090fdfbfefca3fa033a63a6c12707f887901aa268b2bcc859323dd5e724f4490a9378d74f85ec56e59a9676a4b76a3428871b8f097f88b428e43d7308d1c90ff11ea91b58cbeba9b15ca3e1f2eb11e51e3126b5713b8522a94be4a0e7d80d6f4fa694d3704cf84068acfdcc4030b9e656a03bf97de4096520ada911fa8883d84ce10ddbf3c97257bb9aae7baaf30bb27d92e25cd8922250bf54765a7e507879469de5f59e7ced1f6ec80b15ce84207b0b7f244835a749fc14667038eecd11f190f723ea11031ca3924abf4d7bab74844b2fc75879fcf73f6e3ba690f6a1c23b53f421f3763a1a63dab01c128a5ac11ed81a856e2d5e085b9fdb94bb4a592a7ee2b6ffea356bb7eaa7a0e82a3963739faca6f512c0910aaf8f23fa609ce2065c53c1c16f270006eb1328f4e71c1c0c85fb533420088164033b75bc9920247dddd2ad54f426b82faccab4a9f7fd7f11be28015a04aff1fda123b14dc413d79f65becf3960dbc15c13b891d49cd63f8a82515e0456141a9c4b2834e773e8cffbf8da7f0c10c676d2aa6920fc02efebc377c37c5897b3ed008679c77ecb9de9dd1d445c1714c198c799a7b6b775091530d02e2a81afb803a1be657b2746630a9889117ca5af871c49b292d3d60eee136e46801f47d515dcf9d4226e31f3edce21412f770e7ba6c0369d2607c60d904adbd10a001d40928eb9b7c311d276dd969906b6334102f01e6b5d764bd1498db985bd99266dba40aa065cb6df8853b1a74aeadc5680c07ad404e03b53100937f5cd3f37f1de3d8d5926ff0562324a33439803ef5bae943357a3463efe9b8fd51f9480554954969dc07797001eadaafa0c6a4c06d72337b5a8d9840ed92479954b6abd1c620bd13a862536f59afdf0b76509ad01ddcc12b5a3471db0d32ae3318ad20387ea35177217423bdda0c0912bf51d1352aa6a5ac710388881afadf1fce62b9a786ba9bdf9ae50e5d885cf1956ea67ab27186068015d5f43377c2b1413bc96406fceb06d9bc9b8394cf5bba97aefec27f84929ed397af34cb2fc29b3a4afd7f34536f9084519a64f0562eb79e51e2d5bdc7757c3cf6814b9f2669d3331fa97019ad21fb890b113bb7926ecf9509e65472e156e628158ec406579cf831a1a755742a0a976c129b7e71e4102591883336bcce298511a89f172ba146577ca38dedf808c0d7e038e20aed59d532aaea4eb5e522a8bcb66b8c3f3e497697807aea5c7617e1d0182fc77b3311064885e635ddc277e9a5ee0f2a6be97cda7dcd45f43726b4c2f96ca90243f7199d099e89e53f2e15e174155e11bc18cc9c55fdbdbedb0c7657524c2ab2f1b01501991f8b85a0383ccc7bd5b4e8960ff8d873cf6cb6c054bab651d6d4624df4678f5df20c0ad68eadb4ef63d38c67270043db12a086a7ecbb593f026be7a4e50f148d89ecae08f8233fc1a899c76d4ca0d0bcf39bd62d4fa221cf4f04f71d0e11ea2e190a48024ab725fe1b2b9af6fb696d0700013d19ece7bec5d8111603315af11203ce692a34233e4d5f6ac3f68e56de90cc8baa75236f8bbe707a79c76011a0fbf4447a6b2caeb42bdf63e37c499dd0fb18e11b13ad802c49ca6cafe1a78715b79c67a18e74e9df587c11cd97af041e033ab4351c1dfbca96803d2f4cc2bfdd052fc704d3833c578f9c0474ec265f399f4403d818e5c840c918cbf0d1bf234249f0bc5a858a9618a131ee19768453dbb8b1e29f41a8027fe315cf10b2f4042cc6fdfd412da7e83f4043856ce94b7f85b4407242c8aaafd60081235ae693948925d2dd0d1ae01daddb1a2f2f735a03891df5623dec5c50de88668ec56978c90b6eff50b3e9bb085c053ad657f9ba081eedc420151750edfd80196b151805c81e0b0660c5b92da514da8210e2d7e8fb5586136b062b8b3c381d0a59a1a0fa2503504e776424d3fa2f7288602cf8cb0820008996e17485ff10d7fd004ca4504a893ba70c7a6d513b3581183e381dca66f90ea0e1c8bf2f7dd9e2b6f0a47feca61a590a3ac5038d20f49a800960f6a91e26f64e3e8d1fea97ae871b4191eb39720ba7284a142055c198d3e6fb681e9fd17dddc392ce70715a54d37a488345ca2608fc1bf26b125058130b378eb8a65d0face70ccbfbbf6468c4c70e8af8ff8bde1a628a6e404900ac47b80c51c6ced30d89a2825428916ee7309b23040aecc284424afc66d59ed65bd8d3e55a4f03cab0dc022f76da6ddb8eee48c3a6beae9082d999e09ad1f4d44ee3d78c6c937498e81220f03a8ab7be0d35588d5a53438c3bb451d7e2bcfde109559ace7d1f432b759886134d47f97e2a4101483e31de7d2219ac1acbd260c9cfa67b0801d2e77ada5c970e437087af4f6e32408b23e0e7882418a66d36a398684ce75aef10edb5845d69c97b558ee19eb6be40b7edaebc91371599e9acb08ff97a197d8f0b081acb81dbc7d7c2d04695170a547bb9e3725f153b5101cf94acfde23988351bd763f1a7564ed35e18a3985bedbbe7b645aca00ad929d9928b3b235b47c265ef0312b381c290b296a6fe264700c2f22502bae4a3fb58cbd1edae670f771229d8e0c20124981010f834c8fd3f31a2b00f5be426d67f3d57c940c6b17c6109d1467be005ca2e9c2106ce5d6dc3533aaad790bbf5605e6d14491ddb381a0130338ada45d183b7fdbdefcc936eb9dcdb4fbcbe112973e8082c1a5fc92a5f8bbfa76119f998341787cf36c5dc6d189a859cdc94f6ffb7edf803ae092fccd06f4a14e210f00e7c37222a242d46a177fa2e6d83b412ce55e75346a2210bb696db447b19033396cba989f846988af55ef6e80e57d38642322840598b719acfb9c6b0f366c555228a21ce0ea7484fa24706f12f13dc8187b4f66a2f00567a8b2b36bc27446e591054989ddf191c6373eaaf5df7fd1301ee9243cf81d66464ca0f3ad4d39ebd8a9f85e9f80c532679a90b726dceed551471ea62c872de5a7e3c2b478ee19ddfb1b00c06042433d92fa6cd55bd5942fd78483fdb2eeab80a9f431d475d466202b6282e76d7dd072d3cec53f8983ffc57186b8c2e13a34cd75f7d673c526985b7768ba43ddcfd5f65483c62c6593f8adc2e12988c8c0c754d9a9469e65068916fbd6e33c8ec10cc8b5190f59c8f9099ec9295be7123fa5e09f7331cc558d0244b41e68ea7f136605fdd2fd9055590b10b4299953dde053a3712b484df5c6b32e3fcae4b3b8977adbbc7060c0d451f3621ce59323128ad98ffc3baf6eca583edf007643ee54a2d7de22fd77ed3c9dd2e2cc11a336719e94f5bd5124a472b46b956b45cb18406caf2f9e4ad0e1d026e3729ea75b1aca84e858eb55594d985827cfe76f3b22496572f870ca950bb9a35abd12e9f8660ff4f6ed28175e9fa675c913fea11eddde2f054251486e456647f9d8894af6900e7e27a3fe2ac0654bce7d408727e54eaa0bdcd504c0cf08986a9e6869c69d02af9c717e788b48724c7ef966f6d9a80213a898631e961988314b366f01696a80f823e639c8083d0634ba4a403cc4ddf0b62f2147fde467ca2792994f5d38f7fe1b57eab18ebf2d91572d7d1718e1f1fe49af3d22b2cdf4b3cd213e0ac83ef1051a0c1fef4889c6b3a867eb1cc671f4a27e488522e438083fb9bfa7694263fcebd22b8486b384c8fb9f7563b9207ff976e3aa68222188441f08cd1e4060ddb7d105e4932f1d0564317d366d02f9693a636a345061e34ab6f5e1788941f50b18c986655da42c10ded7964b8aefada1a519c193c0af6f0cb3bfb442d54640c0477e66309c0120a2825dd9c78a577e4ec7008290254de07ea34cf0f0eb64225a457550d926cba72d63aca6191f2b8aafd7f321ae8f96bc8f5e0514a4cf28d2b765f1aff389359877123c5e6bf0f3f4e4f91132addff9f4f7aeaa44f393e9c865e513cce4a4ce9248d3fa08d7296d08e2de614e95315b2a38601fb2f8d79d76d07b8fbc256f603ec56bbb029dde83bebdc71c576d7a22789ee1aa4ff23314f0b7add5273f27d828a7e9bfd7226c6705667bfd67fdcf1085c42adb671efb37817f9f6f41b77c11358bdd3280456796681c147f42a661893b852057205f8ab5e2e828db2a24d1561fa5d881c8d3205a7d566b673785e09bb41eaf712f3d05262690af56d17df02d3c99dc850793e05eee8ae451b62fdd280665a5faac1d13dc5cb49221b17f7bc7da04e4be672b1ad5d1a3561e555f2c02be46a4c46de5cf0979546704ddff5101136d2656e160868362123c9dff3de963b30a2ce759eda5664d7c53bc4de33e9039cd7e8bccddb20ddb1d74d6d72e486bd79443c1d631701f94d2268e2735ecfc7a59b3c9956dd6c7037314d03b3250834175f6a03fa93b5e2a260a0330fc3aa6ae39f7e77fb3e291075f709e59acc7e3a393b61e8eb3d78cf8b254454416b52ccf8feebb6d2c78964c887ba9575717b9bf8f977c4f47296791272f4c464ae3ec4a4bbbdb4751c5eb1fd13e5883aee49c427eea2632d38d437a3705c0cb022f790460e8c8881edb4f99eabb48093eaeb2c1fa642e60095eba8fd060c7ed1b4f3d738541f4e6450ee22aff174ee0fc77b6bb2dd34a624d0d4211dcf1274b1d295f25a5bf7837ba0500f7368373553df87cc2da460b06af5c984128e53e84860bf2e49b21aaf52a0d820d8f6e7c06a9be7f056f2a27808a148d258b53b15122cee288ef2136e170ec5eab1c0d966e9933fc1126fe65af1a4d6a3e9fa7d4a92a736b70c98c5dd9eb2fb32a6648407be18ddef0d52743a56fe76a552b901a1c445b4662a6f989909fe63ae026acd87dae4cd7d3e13f4608d47261d376eb9814c261d53562057ddf614e086edac3783d1c91e3bd44d44464b369f5030c18fab1c88bfec7f0188ff429818eb1dc9bf00d13a9e4a85df28cbfc2fa85fd2c78cd241eded2d35b8d337b9b060e3934a3fe615e66905adc08b75a47ad32251f319b6280fa7f3f5486cd6ba8b4a17ce9c1f71de693b3bac0d3cbed04720ea1e7669bc56641d47444cbb38c5e88b2d6566b4ba75e0f4cf35459f98021631a72ad9f85a82d0405dc9c2a5613198d7b0c09ccc4e6c02c35ab0cad4f9766aef8c297a470ea1d940a43546844423b12219c70f827d369b622da897c62cc56b873be0771efcf9db3ebe50ec9db6e2683db939fe3c9f90efddf965d7750011b2922181eb6f8701ac7454425d9f4d11de05d55ef190ef167db2f549651c7d1cb4ade0b3a1ffe9ff5200556d8f0846fc770d0a0fe64952ec4d740794c26dbfb498850ad21b24cfee890f580ad82c96b82e51950aab1bc4231f5e3f66dadf6550f75aa48c7666a6f5345aba068c25cfe43c403ebb7dc8fbf61c3ffd7b6841425664e53cf7a9de027f822f1adba3a8129e3a785292c3e1a8afa736aa828e8c370cdfef3063c7b0a38c1a8453146480b11fcf747792e2d2ee41890643e15f8418ac16443a4b5315e9f8384d3e57d8f84496a6c382cbb0bdc93657cca482e56f6f83eff7b9e106fb902b3aebb0af192c98b59e623ec4c39f0374064f64cad3620b452016d030cf46a3e71b7468d2320bee5ff3f8468e922ee7bf894f86e708d08e13fed92a0dc62995a242d4627065bfa194cc8ad1929b622413caccf89feae815ca835fd55282fd647b7d33fb1d368d069ae2c27ff78459c72048664befe02ed4d8d60efceeb1d751fecf12a2cd636cc534eb1998778802b781a3c9c304c28d57aec136698916afa927c53cd624b5165621cdd6a461821e7893b7693a0a19868ea5fd7ec37d533526e8abda2a05f5565b0bdc7709502779db2b6a13f826cb64eb60690398f2438e51d7826de1f157dbd92c4a476b1a8b2e323d2f41c4b3617765cb3027e754b5a9fffe56e51e50880212529bc422f4cef30898becd8a1096022475f5d7f1795cdc5edd8fd184d2fdc5322f58cae862f98715bf368069736a7fd477bacf59c27ed563cd7ee74ce56c69d97dca916bd4d45c7a28c4e6a14877a2a5fb8b2244c66ab33324a2e9b0246b358f890161a654d1d0d871456be9c178eaffd6226d84abf0355e6023d2ee642c81bfc1884794e1a9d168737dc9732407f01bfb55677b37998e57896b311f0df659d067885835ba64ff9755d1868aef6b24d6dda6973f35cd8fb882a0fb926fbdec3279fd622e0eb8dfb68625f2cea945dca0917fe0a89f9c9d73e2aaefa6b42cd1d07be95ab36ede17a7370821237355055ff6c04187f9cb10c6edeedb27f1264463d44444fdbca26c5db1afe14c3163ff8d60a471bf16aa16f8af0b7a8f4a26e53d95a0e6aec67685fc28b109af0972005fdf2ad582ce55b45c82c92d40b7b1544c834afdeea5f445fe9a7f6f002a9636713d0b92e372c40a2ded69a0e83435cf0aeb4c37a495c708d91403d60d403fccbe556804b2c183eb39a2feadb8518b42c2c89ae4d3d4f76e0f82bbf0345c2ed5c46315ca6b85db7df63d665766c853f5843b21c1848c7c92dae06b5869cd5d3007dcdcf801d6c344f0873515ecf362a38883c6e3886b5f230a96a10454341cb6bcc53f3fec375cf05af1bf764ee2e6d7dbbd135eaa4e285c9f7966fee99e6fb1fc9909a6ff10951a98f91451b0c54f751dfbbe660d143a1d2dc2534a22db7758a0cbf6accabec6cf88992d290054d3f76e935db9dc0759eeb232c7d606cdc03b6922b6388c633790463f215ec0ea8651303eda67d542788cc2df1db06afb6df19ce94aa8de420af2840430e05480e49fadc2afa887aaea6a4d30065d6333f66c32195a9a26c4b4d8ba9abb453544019fcf8cd4647d5d4ed666109078c218b25428caaf08587adabd2b669abd552ef1ae750d9fa374527afc2df4c0249febb253fa17cc6b002ed4469a8ad8172cd3a727e92e9cf8002f9940465e71a391931e97d0e1dbc0a24865c99e1fb63bdb416ffe99c26eeaddf2fd6c1ab79e5bc936c89471de89661172eef92684618fec9f808f8e57d88ed22d0aa940c2b5e57e6a1bdd881a0e7de9734eb18b93d0fa730711d1797e9a4a745e775356ba1f54e2cc660be8fb563c5662437b2ffa873d75f89b3500293da7daa667cf769bcf1a92aedeb8c229167678902fb8429f30c52f1efff244498ca11301469039a13d71329855eae698e667d97be8ab9912d61d9d5854ff79b34db2f52373e29b1e24746c1827bb6804bc67b5df3adf83533b384f95f8c391d4c6f251eab395eb1c1c214cca6784885c4d104b877732d5bc61d4d5b4004ea085ceed23d1f3280f019804dd4f6f8aaf3968d237cad6d46954b6b57328e430efc26d5f2516ae21ee127191456e9751cd4e97784704537863940816fc1e3dda9d07d5f86e94a35c9b6536238b504b535f19326d735a8c1694b34ae460ae963ae6bc7bafac07f0458c88bf3a5132264bdc35ed71a05a705a43f733ee6157f8922426d7d398fe2128ee213385c2dccbedd09fb8cecadfae465533123cab02aa261c3aa7d1cb5f4cb00345a961c9bf481c31d502368641282a11a617fe3960478b077352d34ece50f8433d948e276b7bc0ec95dbe5df985276bacbcd822e4a68b4db96a57d8621fe3f8f88507f3486997484b7d85a7d3c744f042d41dd7de228380d859230ac26bf604553e58d6fe6c8b76f1bb1ec5d9da4b7e732307f5af5bddeac213393fba2d1b60379626f4b4eba258be2a007260fb3ecea5378baf16b3db7f6c315f5c63db1306c7ac61bdaecea4459c9a74c4a2d490110fe86a400a8cffa3dc59a90642de940e93cb6543d4807c69611944b519d7c1dd898772c1c6df0ec531d2683b9d8d467aa96decd70713c780e447ae52e3b7d36ce6248217ecf866d57fad03075c17cb8a3d4f32103b076888b8d6ab44bce041e2beaa21cbd56731e64445bc65d750f8ced7730e940ba19effe9c93b4b0beae0efc9ddb98cbe6d7bae44d9f5bc81f795a99c61f3f58e4fa2fefebfc70f5fefdcca3584161b250981ac109aa4772155b8b41c7c7e16966d904ad406c9688f9d5d03f3a0f568dfedb545a5df91394757298c6012aa8dd4f5b9eeda45a9ae4fda206159f8342de76781b62b7a9036c8e39a1aee308855cea8c18e2363c3db077d4bc710f390fe62aa5c244ece5c164d68d51de8244246c482efff3e77b8841985ae9d8c11e4c394ae89344e540c98dec8694bac5f8b2457065f165f8b50be9eb9487ac80ed1b7dfd0c3c55dc684eee8de920482188b34dfb4b8f684fa9da0d3776e979e44436bceca86ebc12a7609d475ff876f9061c09d190928a0ef81a435766f5a31315fe2bb5e3ed9d2f556f1bf4a75c7e649224b32992526a2b1ed0afce5e3a2c2ce28cac496b705b83219bb310844cb3756a1450f83dcf2bf981d6ed6f204c6047ca365f9facfe24841fdd2d31044bc93f68b767e9ebf50a0867d28457ec3a0236dccf788e2c1bdd41788f8d8b5c61a4cea5f9c36f03341604f9b69612b18ca993702d6c26f29f04e1aa7ac832ab135116c83a17167557852c10da21f51619fc30221f13b143566940cdefd1e7ecf06276d4b1ebe6fc7347ab86769371195a66f813a7d37965e58f919c975817de5f9360250088a56a8eb6add427c83376cf3160049c6225e4859219800b69bb65dbc0c582f0e2ac1ee6fa1eb3d2d2145b5f9a3afd3365a41cedec53b008743e06eadf323cf47e822249e8996dd4f28ec4409ee22560a47b61e931b7a78dff2ed922479a964c63aa4f2588bedeb7df493fe20d09d5a8ef3a57ffd76e525d30dd2775160a95ad7b80eae046c9e62bda4b65f2b9f2956dfade7360d2618972d96c3a2742931473b327f02d4e283083090798714991412f5b7cae7c55f2529868b39032abc729070cc77b4e7e7ada770d63a399a869be0133221f4a7a7a0218b1a4dc8d6acc324b4772e0478f41934e20e4a48896196895cf912a63272e29637fc42f1b1ecbc4dceea708e8bd9ab4e9e9318c3293ded062106cabc179d9388f86aa266d64c6ce4eb48929714d78ef3a86979477b66abce77bd842ef8b3a43524763e770b1e26f0afabe0e415f247275c912645e60e5ba9264dd27d47940b34d52ee7ae6acdb5d6032126b2103fbaad4d11be1b0d3d393755f1d0d8b645364dbcdceadf7bfacc7a305513f2b9df9aa86e912a658fc9056acc1dcc8bbeeb02f0ab7005b3c8b32dbb8800feabae1d343841092db589b8355f8004d77a3430dd429484e3ac87bdee47a1c72e724fc0783d7f97650b9cd457f08e98a9127b949ca109335b9ffcc050e9911f87edf3bf4fabc49fc2b492c851199383a4a4ea2780179c8931ec42be37d3a4f3996792e4ce9a32721299331f8d877da04991aa3a7862ed6c8c0808442b41559402699c578f2d52df8f47c1be7def06b5c6912aec5a40f8fda8ada6112e57d8ea13d68849560d6696aac01772292c874ee7623ae456b9fba618dcdaa61196ab4f9c376e9d950e8c6b85b0f5bc01aa502c70d9756662c874cd16973e5e4cdcecadbeba87b6bc7874fef14f616f83c75d1da976651ff51e816f0e57dc13bfbeeef974266d760c6f3e7b2343970268a85dea0794925309bac5217c6d4d62aebc7a029278dfca915509427a720fe5a1e3cc6335669e93adf0c26bf120cc4528d02b610b288dbcc9282877fe377c50e01fec8a25b481783e71785ddd1fffffa99ec42d7d625c90c5bb05649a629d7000564f1fa72be59468d6d723fd873e397424d463d1f882297fec940b9e48b0f8de4a2807ca293f137e52ebfd98faf396e2fc3558e584b18e900fa8867a31e3c64abf1486b902cd34eeeab6350157b6d2f53bede213a65ed804cbee2df18d907cc9de0905639d075298ef64b4e64a623e1d5ae875790bafb975a71adca399e6de8275999eb8e3656c80b7376d67c755a643b9bf1fe0492fcce38c9b2888aeff3d64ab37f2fdbff47abfcd10057c77ddb4a3e1876311a342ff2f1c7f8b37c7046477e253607bf6772f9264e4fd8ba7e855adfed2d04e467401a504c7f6bd7e58d05696b57707c9bd50f32602a633642ec0bb043b0e2b5efe8d2b38c9f5d5fa83038da9a7d69bb142f1723f07797072bb60fc7b6facaab5006fd11c1d648c42a8da4f2b4bfe34628c21f2bd074707e828b28a8babfb609a586df53391653a3a689bf8b2f531a3630f558bc3ef2112a66ddbe0d11953fe6f02a2c2d9839035959b45cb9af75e547e421b117532bc5161cd234400f7e356f8a2fe3773b0aa742246537b5d3389ad4bebc5a9fe1d059fb3036f4a3cf5b1ba1f33d18b69e0ad2d0ebc036cf0186c07363b6eae43bc3b1460e641a7028f14ddeefea6e4b84dba2d70a79c745186e7bfaa2bf8c17a3a21d5336cc1a202b0d7dc49542fe24935fb10d40d401fcaed59b28d5c1d3477","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"3b65e88fb4aad2a4dfb95b4861d2091a"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
