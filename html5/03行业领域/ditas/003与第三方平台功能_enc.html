<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"c6d4548d8991b0cc49d900c0bd28dee7a9c3f1e36b48d92dbc1a19fdf363a9f14a747aeea283cc28d52d1d45a1875d52b4e1d808f93954df01972a1d71d65ebb543194b3c7a0c2bc29230a1bb956bee3a5aa78f818afde1f137b7fa4bc6e2507a172e93282d276f80c6ab25b130aedf407bc9d77a02a7a7a8341669fd23cc55b39918beb35b01aab6fc91ceb7fc65c842fff904c3b0fae1067f8409860172164ba54d72da13055b6c68dd2f739001661cefc3b24297ccd1221186d1c2e1a833b55873ff6f70ea1c5da5a2e39fd17f0b6faf15677f41869d82e24fd3e351026171aeee3402723b30048a768b613feee836ab4074c03e994699684748ebca298f1c675ba778b18aee1ee64a8fb6491863bc9cf8a6d6b3f4c6fb6cdebf19695b388d047fc5446eb35fcdc04beb1952f648f19413406569a13b14474f859dcba8bb775e55b58e729282894ffb4fc97d7a99865ff3471f8c3a2cba4dce8915cc1a74874caa8535bbdd4746ccc0270503d843aa0d1042cf2efcd0fdfb0b9a8510050063c028cbcb44031a24ad01434b1f46e311ef5830609e7d955ab48cf2db0c743e5c8ab626c2648219629a85e4cf9d68c64eb6ab7ad06ed8976a8cbbee95eb95fdade8489dd9b031289162e6f7aa3b935a8e7df3ca67ae3495f85ce58d9ffca72f82ce4c12ba1ca23e595dbb47eb3df9382db60b6614464681ce41882db47abea192f40c5017d685259aa12f1db08927891a5a2c4ca43668c55db17c1a31e01e6d26d074a1fe5025200b407fdb49929042a63dfb14180408ef63020830a3b8a0e476f18481673abdf32b92d7d46aed959332436ae733ada7ccafbb2a657e14455bbdcf19669113281037a24cb8c586ee3dabb4b69240d5a19d0d5f4fb74c58c984a794d3e180cd027c2f1fe221ba4824da89f4e363d63e4dd48487792fd9077e985217615fb0f01f8bcbe905500276b9f9d35e4485ee30a1cc1f5bef0dcc928f9a74845f0f151f81cae81b3ee5c7038f7713daec4fb3d94b1ee6ad1d8454e9f9ab20f61e242d1351b34ad6ef62e67721c0e40f1383fd01d63d5f8b26e4b6bcff70a493664e7d4cec41cc4314df7dd39947e67a7f337af0de3584be140d5e7b3646a4f25dc50c36946e9654b65379f0b36dedebba973acd8425a1c0cf03ccfc23f06ea9c82f718544992a906c733ba82e132790664004b64873a72bcd5dc2411e48f449b3e5e594ac655fc10c4309de6c29ff847485af8bac62e07490484bf92035c339de94c34eb9cf7b90641bb967eb65bb6b413ce4475829e7e9c1b9e4c20374c894ca77efb1eeb0caf8eef3bd00e9817670dbe0834c9b25c721bc9a55b4cfe13445ae6cb19e135557fbcdc8336eda2b7b42873191cacf7ff651f34801bc66be054dfb0d44e5cd91616ca8bed7d8d337269f828a63622ecb984164a9065b2a2d236371c08adaca5cdf6bc8ef71496384c3faa43e2341c87fcc3742cbe3ffd5a0c693d32948af30621a7a05b55309bf01b7bc1220749649fe0ab152f31194c7063311c9bc8a012c90b97b041d8ace76f4a0d5544c7e0735ee693e27a229e0fb81dd8298ee6651b64163196b7c6393c6ee7d10c7a5fbdae4bd65ca8814cbcaffd714f8694ff84a13b93bcd1171550352b0134e1e51f2b9a44fac5cfeee03b8c50c03d3cce0fdeaa86eac78e02c5c316362ecd7244dfe0e324013b137b2c62a50e16f4bef3bf4bcf48004fe0de0d1161c99fc24e6c5e5a6573e2f66a753a204076d72ead0f3dae24615e1c74844311017f2e4a689ce3907fe76e33716f212c19b24a349acf84968914aeaee193eb404903b99eb9fe82178708c9665861b4d4682d3607653ad9eeca4505b2e07cdd840bb67b514261c3bc62c1b5d985d2c59ad85f3e4f38c95c4c09a3073ee0271806896fe57d2b3b99887eaf469088dd1c6bc0eebfecc11c8d1a070089b2dcd097c0457f7b4f506be4ec2215427b8601cfa9a5c424278965e21581f54428d7d4341bc80c6df212edd85a5a4fe69ac7bcd027c4252157e0aaf6d3a282638c92922a1b5c8d695d13727090747bc84a31a5fef063a8222f67ee229ecf7cef69d1961f3ed44cfbfa9563e99621884ed9b1b6454819dbf3f81143a0f9ef98cd82a12aab7b2efc88c62acf4f6a9a71acc11b5e85777096bd2762ae94a75dccff316c62f13705cfe639d9a93cc925257c0e21dfea2d865ae3a6a79f41e9db503e971e8da6e99e15adfc418a76c5d25055023e39e5b9c4bcbafd0c3e7fe5c811d789ddcc5d8d71cb84b5120b99c2b71be67bce622c1835f4034b30fa38e2b20ffa0675626e850ea23a1f681160ece07bb018a9ede7b093afacd1c0b5a6dfe3218fa1c8f6f2d8beac35414832b0f7f7e585fd5913b2cd79b854c7438a3a79e1098aab2c6a10974c2197b1a2e0e8c951d37f764bb5ac4d0b1fbd336004b481def06fa394fbac107ef416ba7e5a70c39fb04c081e12921748624a7e54103027f6febd637ab8f4be7f123b7399163f126c821486e07b8854eac0774985667c1db636b21470bd5447af280529af490bf5ca617676fa8c39912a84569f50da9a3a9250a747ad9f532866b7340b23509b5a5caae9e327bd6c9670caed74401c2f250245fd31d0dc330311d9becc1181f6b61deba087ce522539e06dcc9de3665ec49722ff68ed64287212ee8761e444d93b335fbc662810a4a9c4eefa67028b5c68af27aeab2549fb1d7794b4169327f501fe789692fcd94bbc5807e5afa408f3809715660ad957080421142ed5d031ef603cc22429e4ef8d2d90774f37141baef34d6bdc5b4779d8609c5ab98773cba1abb52f6e4d11f19d013c08522d7940d68d6d01aa2cce9c8096c1285cee16237dcfc77f786e74ef34146f14dc80c5aef5a71e0036aaf58f0dcfdb562903c928689f14f43a321ae1ce93dc6681457d44f4723bc0e291cbb96b14ddc82d38133c32b108210885c9276c78bf334a5a47fd1d8362bbeb1e1224db577d3ea09abd17394387d1a1bb12e7e2e0970ef33895785666fb633eb775c3f0124775ebc570f0c94c10802331a660222c98884d43f4a79cccc5a5271f27958985b79e62640c794300fad0d08c26b186da1556f9660e3ad6de4a961aebef3fcc1480b127272f90f6b3a62506d8e4613e422641c4a9a6e2c458899b67c0c8960b81681c65f548b1e70d8a1f57e0fb368f4a6e899d387411b1b9e14c6e4252f810c5c15787aff64ef7d2fe72a8e9bada0500b6326ada9f8e5ec84d844f3533cd6cab3e9e6592eb11b83928452e15380cb82b14d3fd1eeb4d8e7a15c53b2fb40622e2b943db133f7dc11ed8c3193a6a78b3c34dacd16652fa555862d3715c98ae2fa025f464a523e5c524b3a3100d2e7a0d58b782fdbbcce7094c3a4f7943bd10eed53078347f95f53dbc2cd75da79aa58115dbd49ec673d35d4964640f1950d05cb0d0439e009ce59b0d80b9a3f6429c843acfc5ee27e2ef2444d61e7a4ee88b543090a35d900a86ab9ef7a1c53d28c3273857e0afd66957446a3d10d3b73c8e0ec0418a2dda2da4d3338bba08f2f6aa50df27b839c5bd4deb2df3a2f4da50b8aae048ae9e71b273af5e24c769add7ea38d2329bd5323324634ac0fc4bb7bf4cb6d1a6f91657a355ef266458149be96a82ec6545fa1e1f9d16a397eaa05e27a62d50e3aab85d0cf0ca9edd3b37c3e0f1a6a81dd05e15b70d9dcd30fdf3db91524206cabe35a8612be3c83f3c9c22d7f84aa95a088d60be4d92b6b269ca05be3b87d163056225eab3aae9ab0e3a3903d61ab46e27582d57cc5523b127fbe9165aa7fde571b0ebd63d8da9901f8635b67c2fb576f7e35c01d31a89432dfe8f2714603cba60c9f19cbaaf980f19c557a3f0d5eed2932197f5672686e25e1f953653a0bb798fc259e99f2cb17a9a1cbb3a3a5aa5ffc93191b20b3c5ba9533e07143ceb960c01d9e3c9d1cf10acdb9963f884281ddceb40d9562de5677c88c2d77c2269ed3ac044e5d98b5cb25ca4fa6514c7a660e42d752c7214f487c3d11590430a01352e5e1536028cdbffac81fa8acf6b95fb9f756ea34d90d063dcdc8868e22e10837ce75932d948b8e5f0d7a2d2842b707f519a3114ec8d638b74795ed10dff023eb70f91aa23dbe172aeaa3334718d9d1a236766bd335ae9c455838f5cefc634ab1c73556002ba16c02e681db18164814311e2bde3d9d44faa46ea6b80241b691f7b78834d538d3444d0cfd25fb71ecf78748afb2a63b146dfa2263ab3417abf5f5f0af0b71d8e4343ee3674925c2ce56f329b5712cc2265c7f55b4307581294adeb028f8d4f8e644101a930f3b59c7644e64ff02a7a8797567839c1c5974b53125d582aff4ee476bde99280db87abeeda8cf3e0eb20122a258d05088b859fe427242d256db4216699f1311c6515e83eab628334f555ad9a3f58fbc10705598029509c1e392af5cdb44acb114f11a62ffbe7725c39f33e1989ba45b9b5fec4999ac46830709c2fb66e85150dbd336e025baff9642ce9b7f97ec90709d1d1518fcb5806e85ec2d001a9232933cf3bbc6c47d4716194df010ee062b23174eeeb559faae7be38425e1b5d5f819bf04ce695c6d0627df503debcd84625d7b52c1f54aee4b737387b98778fe528d884bdc1a235bce99fd2305bffc09668be29502721f822f63b941352395e82b8c1fe1de890f91f8cec67e4cde080565fa2bfb945740249efc8a499018f3242cf802147ccc3ca558dd719da393387ef253abf651d8257fde1ff42c8db27c3d9b0fd54165d5793a14204fdcf583c35514639ec242821da9a5ca328675b0139610cb44dcfb1ebb20913729012e44779aff7e34dd03a06da2c838e403836e30182f4eb33e3d1f70717e659a49e352bd17946355568beda3d50489526039429011582bbdafcd6b407b7b8482d76a4dabcc5d9b8796b184e3fe2639f813ec37930eb54004806e2ee00f7068333157ec14dab7445476e19a01530fcf0dbbc021544cf3008cb2e91c5cb5d18e13506273435f017cfcc4e576e8dfa6475c60a86a4930c2b6f861636cc86225618c2f1ba734b00d4c8ff178dee0bdcc945a57dc561d53f2887783dae504f082e0f3c85bbf52ebeb43705121e9f5e8a2ebf708888f6570fccc326cb70d6507785feda96f268bfd093aaff763a227604a6169a6d9db7666bbc3375aa56cf7f4b96848e43f0c9a3a4fe5441b9daa22719b01cfc9c485b7b7f4d3a1c168f72eb16b57de6ed229bbf1b5dc4518f43f99824d0b1aa96d9a59ab373fdd786f229637c4190fa662c10027d7f6f59e8e1b187793b20fd6eb1745ed38155aba18b447d49c60f1a138053691e793008fa55d1aaa3b71a3a33079195af3046a166f21c240bb076095e56adea076340e86caf426310c44a062c4c7fc202dd44016c3df46bddc702b2f85f7201954d5bb4d16d2ab1f8d8fbf736af8c7908a6a4dda9e2f8075977bb94a1ae93bbeeadb5747a4f18195b1bfc6225e64a56d03f173fc3baff97ecb09437a8ec82f70b716b1775d4467ec49a844146c6b0147a99f168941a23e85fd7802a45f806c880b4f804c7e406ebdb997d34db4651f91a080c19d0206009459cc30b3e1ea65c5b106a46733f47a609668331a204de62839882f4fd4bf2361673343edf566c8c789c7d24e256589e797be44ba90c0b77765b398375fdedf9a269bba08f2da2396c28478746148f35defad82f6fd4c9f0641f8d93847b4012b2f5a6c089bb3600f9025b72d154f4d61051f19055dad234fc0de1d89afa18451086c0df4042334ee3f5a0d9e5c44f48008c26bb439f57002e989ca6da8f6fe08d432676df3fdd5fb37b1e7f71985dfa9c393fdf303b1af2dcfcf1720ea4fa0660685936da2adfffb8fc18f334f11bec89375c6167ee5a127ce60a71ba053012dc3fd7ebb53bd2ea1e7de8d1bde9a7c6127087737638df2f31414f3bdf60d5be4e554db8c62453790d1a364c85a8f6dbe52fe379f41bea0f209b3952560d11861ed903f381d21f4db2d30402a560ac4796f1e3de5466627950678a28ef3713099a8dcf178969882a6f560827710f81699fce26b81657f87c7b2c267848d1bde6778ac2a8bb828621b4b0911d4e52fbcc3de74b012f67dbf854053961ed0d074a122ed615cda31aba2d52b21721032aac64c1bfc313cf3353858090c108b08ad18cbd39678b7398b58f46628c7c45d9792f8121ccf626b16c4dd52b97bffe59ae6ca612104c3f6207f846cca8ac57384ebf421d9d563e11f41886f591b5a6d24cf4b5127a6ad9763bd0b7ca94510abff766d57ee6a642148cc5b203b6a6ae9cf382362bd31692346d0ed13d454bccbf9ad6968e6763a109465aab4f2d15ae7335adf04c777d024b03afbd16b79a540dd9ec8a5566c6ebeb7a62568857b411941194ec656fae75d3902a007ac7ee42b8cd671aa9212c42a80d550f44b3fd64b346c1d3dd88238776d461e257b4ae339fa5c70c592ccdd27e6cab5a92edbd567dc3cc3dac878da9c90e7b7e34ce2c8973a4febe6470d50d781e1a2d32d4afee41d47e70703027f0a7665895cd6b7bbb0c4138074135e1ffaf2278ebf4df231e5a525a506fc55e69540960622a143eaafff2d5167e2c88233fb79d19df96b34903e2dbc236f1b1fd94a8938db11b5c7c1e27fbe2ecf6d90dd5ba88f681779a0518e887b5d59d102be3471345835c24718a6b563add75c88119dce315346beda8c48f2482761098405def75a56e4b4da35e1d2382e474dfa15ff1b1e58e7d76530f4f3f0e74692379bd9fd308791ce93e4d628b60b640460bd828ff5fc104e0f0ccad7d3f5eb28528d06c934882cc83197c1206bc15166dfc9e5f3e042c0c7d915a859383f01b421c77a902842a9bc9e5b66c9d132864e16a423266ceb8d29d3327ab9fdc59ec1759b461ae68558a3a580116faf05710a941f690eda9c44dc95c2634d57e1eefd40568aa442e58e88187af6aca6ef7d0eb0cb88e8024423d7de52b836caebe95c10e411182a199b791a1e84114d0edd004e9e7b3a1b4f05dd3bb00ec351fa2a6aef1f26cd22fca6d575a99b84ff788bbe44152670a98c3cbb810363bb5a709a042569c6b2227620347b7b1bee5898bb2e2f45a6b6dd3321538c508e1e03509655751049150ad7f3a6c750b544aeff6062571393d8bf45ee49b112e91f47afa77081092857b19d2bf67b2183ce2b7f4e7072eddf0e2167263f84673336208a0eceb3195f0ed0941437f8f9182664ae5b8f3fcaab122805bcf8c928b947933dd980ed966059438683553e0465922f03683d81c37220f270c5a740f775f4309ff29646ced26164dc77c7ac5052f50c7c5f236decdd873f1860425119843b932fbcad98991938e6f9117d731bf1b0c183da8e99dbacd5ac55af38e49ccd2a537b3bbd669943f4b19678e2b653ccefbe79da354864620e610cf195a7283b38281ee0be06c9bda359ad0baa5018feadcf3712e0e0c6a48ca5122cf8e3434525055917a3902f269ed80ed724918405cf8d2c89073ad18b0dbfb28d20e48a012dc7b37c4872d2472d34aceac00d9febf92f77d6b6d27b7bb7caaf4dd38b7c809742bc89982a60d52fd700aa3b47bbf101fa97e4222134228ac658be4181c527c6301530aeb00fff6ca73a60ae07cccca1351beb96c4e946a93cc80756e7cce0baa5ce9ad9901b002781940fe52341e3cd5f5125c49fa4128eaa533767515c88ba07d05b9ead970ab4c13c7a8bd35835f691b64cc26e66340c2e677076cbb1d1fe1322746c7830a38b4f7f28507fd9920c6bd69eec1decfe38432a22ac0787d35c4cb627a77a99b80bf7e64f925b4e0e2bbb1b24105c02dcd3858e264f6f70ce7dda24b49a1a2b57aead66935179c1619caf35b0da7d0e3b98a8a75dc3057da960ec2eb5a4f1d05f7f0ba8f61d3ea146176975546d9bdc18c7620d5aa7135dfbab817400c831d41b6b39ca0990904c6c7ba9b60b859224bfb43338200759e3f39befa4c29f92a547d61639509e59697567177329e06d86bc262ffc6b784f6c5e3691b839ddf06a71f410056368f3f35b2b345a8c9ecab9d5fd1390d97207c9c9d7d9ea653edeee37fc7c93863776bc35b55a96f38edc0296fcfb685e79ee392e9e737264010cc7712b4958578f7324557b5745d6b6ba342edfb55b88496dcf793a6bf4e75a0f00395f96345fc94064888255841f7c9210d6d073600ab60dd207fe7af0a207d39dd5bfaccbfc9eafabfaf51eb38029d5fb416a04c674eef008ef9a9cc4de46280376db5018233f03b3f68e34cb96a3664604c1ce995916610c6838be6ec0351cde55d242c799731b98c6bef8bc761656a614529b84f65e0b19bdb0fee616bd1b11f635264e3165de117334067b6790ee7de33c21efc6ca88fb11cbdc085c713ce47af6f2f4a011bd6e82ff4480b70f5031eb10191fc70de171d208e2b1b6dba61e9d3ccd4426d40afaa7d7ea8a97f290fc22e366c506f10d8dd952f5998a3b5ac5990e25eb4a33f6b4e7854a65a124758a91631e0861ea0e5221f43705ef2678ee80c0a69b6c8af408d7239919d81bf960d1d59c12de6bb770ba85fdbdda74546aab0d155faa7b35e58212574cbd01dd54d431f900a37bb80ff9efc6925a44dc493cfccdcd23ad6e5351572a51b00682964399734eb19d2485c5b2511695d820cd2003e682490fb8ec101ce1b99df0a66f4ba00faa071c683d211eb93aaafedd8017392598299e9ec3d599cc13b62190eb640be30da5ca325abee2939225c168d4616254b8f9b32ffec64beb61c5c9595908c33eff86890f7908d72ade9e7732d46420c967c4dbf75759f8adacc3d59d0c855b9d03e2626e30fb4ed63818d9ce613197f7905b4b9a6e2392f166ad5bde1327a216aaa62fbab497374e19f1da6bd53bda50163f984e672323fe56fa236cbd4953c0faa0a9c6f282b1958fe8065da80ef5ca0e08bb7d6ba482e7cf75f3b2e01084b5869a87ed8ba31b4f6028385c2354eefbaa8fe70f179ebf80d39ca5a65b112f8703452e56a7ef0eba3d4338098a3d422bcb93171a939cddef2481b26d5a8a13cae623bd260465b2472d5d8943c6e35128a0fa333ddd6467d57d46459e65ac784f5108f56ad0edd13fc18811a33ad9f49ac7e163f5407ace3dc1390645ab1b01c81547969b2fc7db2049c8d7b9d79c6bad0ac3d8eb7e54a5239ab12319b99f4d0bd8b8e23086b05f7c3e748aead47ebb8c921338fed1152ddd62f2168d41bb94e0c3d8fa37a57678ba34bf7ceb934b485c220b500216932f88d411fc9b074a7d299b5623a8605638dd1f7e8ef33cabe4579d6b23feadf9f1ab7e31a82346bb1fafddedca94ed8e178dfa2a9db21572b6396138752159cd990cd1823726bf57d9d467b7c96b66971093990f2737965e39f55d552f29906a7ea52900eeb771a2d4f1d3ecc1043b16e4f57ed531ce549f3c2004d981080abe9e838b82a6ad944f3b1e6a5f3a39e453f7eb69ef378785775d45d5f0927d5b55422f9bdb2c41e4e72ad9c290e86a30a6bf7acaae977e7b3145888fd4860c07b158c3d35ae5b1eca69afee6142fe057f01933d3506f10ce2c1c0485d4b7a9940201932c992bc038c2957285d27bff1ecd726b856777ec45c69a4d500d672839a3e6ec037be30067a2a3f2662ebd04a60653a576ec01722f43ec75983600dcb7aa8bbe7133516678e7c0c0ae718f311f34ad9285af979b13caf92d23538534b416fa3b43bf5845be38fc98333646ab4730fd40f46657c63cb13fb347bc948482d2bd4d03ceb3eb4012235221a3313d723e2136c7a4324266922feb384c9f5a0071334db58801aa847f02f4ff9fd8945267fcb37e3f84ff894637f6dae9e2e5f629df633522d00ba306bee415093b26ecac1c5382197c885ca2da63198aab4516aef99d3542d0df6510b5c81c72c8c88e5b29efe7a16285c1bcdf66abddedba9e90dd5814d0e3169dbac25fd987088ad003dd08822f8fa95bc02c4f4bc557865b76f7a11f3880c07079fa0ce4e1c30301c984c1aad6e7e91c5c865462fec3ef00e551fc2769299832c86dcd0f191e8c6d14aeba94d81175b83dc5766400e3baa204ab1686eef224fb4263fe18a381c6d89a2650e519a9e3cacdd723f028bc94bef1ff8e0b861a43ecf2253bdf2f45294a5899beee04f7271b4077ad852e35627b08cc7c6acd674ec2678971c46f906dbbd2bc2d5bb2b084b86a3e9bf5bd919a2780dbe810154a8f2e808b7d3c6d10a8081e0612c00f9b889e268c6e66bfd985819df4ec7629a129010a1ec904dfed8ae150e7a76dbce65d6dacb8a605a6ec02ea654928d0d24763c0f1dd3fc7ef4f7357c2a07e2cd7cbf75f6ae51ee6fb2bd17d53177a8051e934a1962250a3d2b1e66551c8c254f5159daa5e6a25af08e5aadd967cc0690d8c8260093d4429d5a44af4134420694ec0b2bbcce58693a88fbcaa612b77c8352f218c1f9c7460a0acf82dfe6a516d8b524fd2fa149ac63bcee920209e490af2b8bc0ca2060529884820ecbcd47d1440bc6a4e0c667dd3c0567933fd827441317bafaa39bb87657131991d19c02631aea538ddd67b7fa601c6b85bfe99d93cfebfc1e594e942651d77d6808f7adccac719e81f4917259d24cae70b127fa156d9bb32f0922c126c48c6ab72d5b1e7f8b01a1016105744a222cad7f2fbafe741b84ef85dc12aa26cce45308046060dd947760d2a3564f603da718f5371e9fefe79cd0253af4adbe88ac8f88ea5d316b070080b5ff9453e0a20a55759ae433387216f7e60b64b4c4f80b05119efc68013acebd6b6acb6e5316dd82190bbd4012cbc716d89f7c29a55cfd38b3ef9f7f6a886947e383d4a16d85ca2ae543a39faf56844c1f1568d298663f6798c46f18b7022fa6056fc93527e887e55efb1a33918f4db638c62f660cdda6357e7b4b384d9e6d32647799e80869a4ac37c08eca4ef15067f475f4b64ea2a96e3fddee7d28a015f500028c82eeb246a4bdd0ac368b913e5bd48819bccd12c78f2097cea524afd85e315953eaff61fdea10a516884cd7167e9d4b3c52d9c2405a01684358251cc7e9c5932abdf46c92890bf924a7ddef7efc2f63fc66f1f924f63581ff24526b74d7cfb63876ede6bea929e0c75f5ad4c0985d8d22e7d093da99589bb9e12e91c90668e8328e3e4802e02bfb5dfaeddad2cb37575d08a3a0bd355a312c74f641e3ac6489d2032748aa729412d4b4c5a03f935712ec656bd24218f5a5c51149fab722d6bee35cab59e735325c51ef92891ea2ae4a51228b8ebf52a95e43ecc4271d28a69cd8ddba498aa4f2051f4446c89f6f76f0468ecccc17cefabee24cf1fe9d285cf358d9811fee0d0eee98c96e3874c0a4c8a1df4f99da060e5201d567619d4aeeb1864aa2a16a7eef0c9fd6822205278595c05b13d3457274b35acb28cdfeb3a4a0b5411b7c29138a9d8f573dff8beaf9e7b4fc40e04197b948cfe5d6b0866ee8a0a79bb70e51990bc0d2bea3a40ec264c9050461e668a8a1383174a770b394fb0bead8a1d042b394ddb1a49d2897b3bcc6f91d2b24ee55ea2bd8943fd64233ea8fb1991d2c2fedc1e94ccb13bec41b8c3be6e03fec93d884eb18e51e44a324839fc0fdb9a2398d2a76e73db14668b5060bccb60639201194477f1e707bb6c5f98b487f47a2fb78b89e5bb68985919de023ba03748f2b8a9d9090bf0a7833d8f8590b7321517448a41501a0f1ff44a4df91962effee8008f6eb8e3287cd1c1b7823af3bb229422d5b3970449095b42e4dc273d15c3bf697301834a3b1523d1c42769002ca8d4ea669bc06159076f9d898522da40b6c6328c3bbf31666a8bef79daf7d58f6255203c5dd20380a3e5890dfbf315b3dc1dc93caab3b757d2a06ba6b55efbc234385e1f9a0934af53f4ca14582baf9e6b6839ae6b9d5faa3d994e08a43db06165066bd0502940bed9db28caffe700dac619cd885dfae89f2b6b619ca528af389e1ffbc72924d38665a273a0632930f976557c17a2d8d70ca5bc8f8883cd90c24100e88781faeeb335a76f6c059c603f192274297be45d65090c852679018310754e00f5faa36deb18f9b9ab1968e428f747dd76053dde2d95eb572dae9a1683f3595767572d7d43163f9ff8b03b7545be56ac0b22117e24001f9c42dfca2e5750ed586c3589829ddd8e5b2e1a6331b8c6827952a593ec54c71264306993209e06c8a4bc3e3a8c1aef8fc04ce4965732e12dbc6c1020656d2f6d527eeca04685abaeef3fd7ffd8596f3952a444b1eeb0f4a564e321f5c66e095afb172a4b482814832551562b7dff05399b349a59e4ce09ebeedae5d0d7f21059a92ec707716fafaa009b9cbe9f37e7fc1caa0c55a2982b33c727a94ca67077a500d3b80cf3a5a02745efb6beb9d1f69267b43b23bc341b18592ba12be9e9e9d75a54cb7ad4847bcce5a7ade6c52abc0a3020920eb619d92e0d5ecd579852ab78af5faf0f1166a43a15d7a015ddb91f7b15c35ca9623f92200360c44a96228d252e3dcf4e219aa08c7062a79f337a3eeb01facd2bdbfef5139dbd94d23bf2060f22e3a41860d6a6a51a99a9d356524c672a37272da82d3cbe439e7e9e2202d2ae081ca0e933baafc02fdb986c58858190db837b837e5a34bee6f145637ec646f9e4476b206fee7f2ca936f0742ac0c7374263de3fb5e137696b29638b355f77b495ec596d155afaf24555704bc341db8b0a17427f59fdc4140c38012e3791c99d104812dc287c8b09ae0be20f1d588f5564a1292d9ba6f510eb0abf6321941d1d6d55fdf9b8c4119ab535878bb8ba123304be3b9a4cdd9a7f974614d5f317f3a3207576231a5bf7414618a6553f22c6084ef7bd58c6a2d891ba882569f3098ea3d33bf35485688f93936dd3b35fed1c1022c9869c54352cd9b2005f62aec60b835850915d7f8eff13939812e4e125eae1d78ceeed2cba34178fc27e7fd8ceb336b57c3f4531d34e9cd7706bb6924980b904b4ae89bcafa63a555fc63e830dac4b9996cb2627228b57d54ef84012cd7bc32b1db9de8576b3a2f7f9e315ac4d63c49558c4123bf4beba6a702961ed8d65d854fef1f66109ff2226d82e6bfc1b2f07a2be2cb4e4bbef39e3adc23c707aa3dc84827d5b44cada1bd824502ea44bdbf746f3ee792ca8df7a83bb20099092418100b23951df5133c4e78c1c6a6d611a2e95ae84e8bf72e6df82245683ff4c55a794e96f9c08b4a4ab8891ce6ec6ed03db705d85d0d56184f839b379d245d5ff0b4e1f4c6ecfc6f9d7d7c17e4db2d332d28d4a4fd1d7e03f88a59d67f56877ef57fdc429af2052b41fe3d66d0943363be95eb5f43da9a3f1399edfaae2a7d23e0b1146fbfa335614a35883b749fc2a7b9ca7d47242e81083b8f5c5ec4f60b056d4b591298a49b9efba8f8c140e34de361cbfeff8a372f59ddccf3c0c56c132fd04465774a1703f96d8e6b8bb72f96f42d627194855a086a7c91fe0ae6612c85866c4492718eeb08ee89fbf018a7f21302fe01f6ca032f8df421cbcd951a83f492527db9ff96981d3c4a8a6cc285e16fd5ce0167f614dd6a01d3ef40258d2011f2e747cba5f781005b8f1c8889ea0d789ea1bfc281dff10065d258fc8937f616ec61d6715b1bc3a11c0e544b042b51cff9ec9c1ccad97d5dee6c730516ad25eb773e2df5a09e056f756e5b9c4d4e5eff5326d1c45d83f269ab5ff41541e4fad088f0b2f0d8a127c6a7129feb1d1c7cb7ed201aa65ffe3e12033c7ed263c21981af3ac3c2d553efe3525838055923a4af8ac5bba761cf997ea33724ccc66060dc61dda44f5694f206eb0c6377f33e302eac49b860a32686c9db0b85ea6ed08530a356884a97c2f3870284be5087ec0c18458e95513328e26f6473be100b07deb0e0ce8e3a5841a4b2b68f29806ad12dbdebd253069a04dc8fc008633b2fdb7f3eb49bc8ee9b9b2f14ea223833d9b22a412bb6f692e1842822eee03fa2b88b81c491932d2e06b98af2bb51600532ce65fd5757fc8658905e2f8ae7b2edefa3410db6c24ccbdd64dbf837c273d21653c6752bf338d99ae11295ed5d0a7e78fedf5c368af5cb0174d82feeb2fadddfd8662524373e0e866196631fd599fd2068f32e15b9ad72cdbe5a19e5337cb9d64396be38b41f119720e852321b3fa063cb0c95196e9780946f326713d860e37812fc040a8ec147625c0a9c39297f4f6ef41f1e7bb4c4d4ad96180d80cf3dead68f6ca4b7d3c9336814d78292dbd381bc3fe9ee9ed7daf1635d5fc9d6d0201435ae57d250a0f964b3b4165a6705c2ffdcdc2c3f7430d068db80fe6a46dc8081fdb83e15096c765167de25d48a11d53f56de2264fc55d7cd74eb425c26cb1411acd40cd70bdeed5f79ee77cd94aae242ad43451e113548b9721dbe7e211202f5319d2bf4873ebc635ba1ff7706bfe9a65bffda7415ab1cd5e86429d607fdab4ac3ea23e3f29846a779fe1f7545d4aafaa2594127670d4898216f9951638a7cb681e80f8447d09e7b2ad9ab0c93149981f4bd416c245f818758e5ee62631f1e204a025dd8a6174139709449c116977d6f4d493fe99e940a0c663be94d8209e32c37be9b8fab178bbeab7e69f4815651b9652e0cc4a6be69f651b6e17755fd42b2bc90a60b3748acd53746272cae4a259aa269e7f08b2fa51a3e14e79c7921996e833a9b1adf301b4f89fcf606c8882d10d3cad48c46643087dd4ad25589fa8fcabae87ec0b9ee4c52e06063085ce9441135e702163d1387c584290d47a78b911f06983f90124d38fafb87f15aed16028f7ce6952484b5ca45ff7ddc217e55ff28ec286ff546dfc64def758b1c6f1c771aa66dd70efa8f503c2c53b75d2905e30bea262781c32c0ffbc3dd6cf4ba8cd2cb7bffc7df0dd2a7b59ef57927859af38d2fc4387b819cafde4a416840981b808ea87a11a7e0b7a068012adc450b74f0bff1d7ff22cbc562cde46fd6473dc6b423574c511d29453c9a706a656a195cce8ce3a72ac5d4042b97d2c31c30351a5f881c4f7f79cfb6eeab650eaebc6b4c724eb9900d4017cc241d0179b4d159bc39ae3b32a9ca8157aebf05fe01054bd452265c5ea94d06796b20475daa996fd9eb1f84b125afe76a98dad98e084d8dd63d53ce2bf8abf9a279c7cefe407b7beb108b4da482e0758a0b24a38af81ed91e3c4cefe5a62446bc399a9b5a6f9a965904b1ffb00e10a04c829b8f21ea8c3c205e58acdb36a58f0c89c3764b292a55063124e833c3f49c86a8e249850e3ca8fd7f893885d125ba6908ae1355f0bb2efccfc9588b7e8fbc33e2929be798af3d0d9c8e6f1636b564e3330c0013b8f35821603d000ca5644910547b11702bffb5fb47f6c763ba34caf3a346d3cdd189853d56d46efbc9d47fd539f8a9f616f639d1880e9d267d379b543eb97af1a2074fb1cae30d1189622e7605d7941342acd9f9002c5d1b274abba53fbf006ebef9c313ff18cd8685f6856f5df0f4ef1b384a9b8eb3f0b3ec125e89f773a92536718ecc7a8fcab74882ea602c3e964a3fd3eb5f5d931175f7fd66eb04800b94d6831633086ba1fc9f5523d5aaa5ee866bb3b4e6854de5c9f7e16f856d40a36d1d88a239b27403afc5a11af581fd67e7879180d0ce2b0bb037c0ddf1196e9e0499afb63d99fdc3190604b93d6515f9944489a590436f40bc5a29afe8bb1a522d02e72c9960904414ae3d8f1d3e3573c91895f655df88cdf37fadb0fca2824a1decd48ad44f69140e2b50acd64abc814aa70b8cccd6eef936bc8cac4a7afaff698c752f4c35f53df93e044a594c1a0675fec89e6c2ad554605aae844e16c4fff41a0b2db340718bd052523cb272a5fdb5d72d09329962377be6cb35c9b943a4bb9f8b684576844ee170dfc821319a24ac182159494a26552890ee79e68560e59ab3ecfe9d3b77ad673712abc6c29980632910eed399f01b6f86b82455fc29a555285189455aef32650b7927d95b253b55e1135517998e2a7dc973ee2f768f2f9f2127fd9cb8f9fc142be269eff4d17dc7053336234020a98d9f3d88b5344e22bd4c9b74961c2e10e2ad301b8e6a297fe4a6aceec9f40658d0a481302908c5353456f2d002b07abe78cc5399a070266cbb042c5b62b8c5160b5ee30c08d2a567581a4f22f486ba8f761a6c157f9b80b0ff1366e1a04b74e7ca2f5b3e1bc5f665b808d10cb783ac78994bf18092e9149a4f11959ffb492fdc28437f4076428455a1b804b61667b9411363901e135c98163e4fa16e7a13c8a363561cc867e50e4e2bee97b12c617c6f52885ba6d028aa326f2d9ed7c8bedb016e56001cbaf5380e3f86277c99a0d15689645d5b8d61f2fc72192abc9043121732554e47579fc6e76a43f9103e9b58a519eb804bdfdb37c61653df19216f01122521b81b2604178dc13127d79d2e978edf7c91d4b0a79aa947e2d4d6f996808a2e88c32bdd63b4ec982e3f3157305f53b89c5c7f141c7ce9c2cedca1aad0bebf372d5bf961c37512edc3b973dd896b66bdf76c5e473168992ba6de9a032d41323abc29f9a4d5c624d3d0ec4ddd56ebd01e0c5a873322fa642ea73142a91ae36252083be14bddedd60b0c987a1d298b4ec0d370c5ad8b7859b47ea9ad3dbc34edfb5f45e226805becc5c2e9bc26db188044ee704cb23747a91da95d5b0e11b2e7c49ffa52","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"db2470865aa068691185dcd60d0115ec"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
