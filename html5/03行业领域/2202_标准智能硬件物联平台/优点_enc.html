<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"93869c5d274fa0246ad39c3725c1f3f5aedbb1aee903ca3d618a8961b03d91c246035bb39510cbc226bc3be27a75bdf9bba1714df80c6f9d4de3a42c05bb13141e9d4fce80769297305ccf04a5b167ddd81910f3bbfe346bc5983a1c0ea0f5ed73806ee8a32589d2f06fbb7c1e8898377ab1142cabaffd2d6656c7b8ada006ff1ad2b499e2b788e35faba236596e54655d8d1e6058af6b1ad1b59ed7ca875dcb4eb9a2400d6025931d61f5c50c934313e913c87893997ada2843a747be27d5ebe27aecfbebaf247b53d62c5d49a6823b7482c1b5fd2ff1b05a791e52add6f258928db135586aa94678ffc049e92d59191ecaf6307b4d5eaa71fef28f6ca332f5a3bbe43de7e35120269236cb58de4907526482abb4a46aec8d91b029f7e15a1b9a7f5c1817447c86ab361751037ef39f545e53fad7bfc4e159d6d9bbe63f7eb9fc3c02032d24c560aa52747257e5f1e2bc9b3d4cc4c215c465582ff3ce59d3eaefb0fd146a5a9f368f06c9caea95879911ecb0a56d05ac3988c68fa1ed713e1dd0a5a89334e624e4738ba2d9ae3fb6b80dbb028a515489a2a78029e86a1b6922e7a612bb7c6dd7fca14423b067c07ef6b81fa2115c4704f12c2461f8fa0f935d5cd0da940d62b1bef73b69b06b52a2205dce44840cf3e625c9c79076acb6a965682eb8148d250b8cb009ed87d0f167fae57e73b865bb3da4ba3facac14d6b18c4bcda81c2f811cff4a42406d8e9aeec06d18049aea27740a086fc46b7bd1b540dada9a4e2b256bf76e66e81737492b7fad20c1afd62da17101481f577155e306016f7c857e9d5593b6c4b0d82c3c31e3c0a0c84fb36c8b3fbadde68992362c33d9a259ce1fb251c9a5938f76cf5c7cc08f4e8b005ea32885355b412761430133e7ae75d10fc1368cd37ad861e6ec4a8122bebfe33485fbbb178fdad7a7f2130c76b54fc7d3cd0a2e5b033871154c2fdd6dfdc96f04eb792f02a580b7a9e93be5deb75f96cdeb76877a3240720ff727f7200652be895ed17585bd85397a5e2945f178e67aaff63a1cccdb59b7882508b0e83d33b97a7f167678fb36bbda2fd9be8e660c3e4da67a318c8a09f4b96bd062f8c247afd7f9dfb648d3a8646fa903ecc0be29f690f7553fb5efea154721daf55fe7f3c5d35abdea7feccf25f99cbcac38f28a070fd707c6455ec7d0de4929f4aa84641153544721f172f7526f0489cd0e2fe40ea693e6704550021f29457ccac41980338c97052ca13193d53e87abae6bf9422f2517c74426268e73916a2a07ebe42489c8d07acb6ed79840786ff8cb11f3f204a02e254ff5320b5d53bed8151810cffba4dc9310df63ea4689bee959aa130239e9c3d8db54c62a637b1ffe36cbfa953f36db24eb5ed241fbc1f4ff63a2f4f20bdb55feb9cfc6b1afef9b26b2bb5d56c156b38fc8f74d7afc413be69e961c7e07ac7a001f302faacfc1a108e25f335d0df77fce4e48b31ae75c04c53528b5f950e16dcb67811b84767f804ffb4a489c450e60a1d4d1bb983734b0a90ad690b6deb3beb49d577c7533f7e5dfe653f44e07f4182a9e17bf8fae28d2c084b1fbe3444b21651af5883314f30a5630e87a4326a770ac9889380875e2bbe2a672626426602227f004ce1f0d745444adca5ff79033ff35c2db87572eb298e0676fcf7915e289e47e5bc4446e02be902836745137dda3434768055aa2901dc94379f2cb8006c86d037d7f814cb8a4a1ba19cde3e5b302425a906ddfd591dd4b268b0784ca6595a26107312e6897b5bed14ff829157c7c8d634332e01df6b72f64a3f2e573261f1c26232f74ea1003847c284588a5df03b4318ce11b38d174c06b874a5795ac4084a96e9e351b4f6c6787c0e448a72b71ed5d47a1f99e5d1acb65fe7bed3b607f76599e8bb1e78d899eb0a324f7879ab42992fdf5efbdbd5aa81b2ce02dddc51d21f8e085a7b5c104b4f18a1393265edf11e5c3442b633b7a1f435614b3d7f9fd98b4f1238a8217e15bd326c8b20500c4863e4409dbaa29cd89cad47277d098ca70c645ea3f7a0eb04702fa90bae3f7a2a5f1c988abfc781bd2a0cb1be5a19f2985365ced1253e963e39b63cc715d67eb1aac719fbb6f8eca6a8b6df4e4323014f87b901a0319483a3972ec60c0114ced3e9f296d1ac59d637cbf8ab560af760b6fdb01b3daa52b7a88006b8a38bcae9af5c9a7b91f877257bd5a1d4b3379963aa824f1c7aa7051aff847c797ed0be84f52857f635750dccc8437819814c6a246aae42c49245d6b36628ca1671944ac7b5146f5a98f5971c0cabcad6e1f2a832fbe501c8f5260ab57c0f2272aabf8301b6a6dee3ed7a6c8694ea589d521217d6877f5bcd317e48d776a2529ce61587aeb23261a60acbecd20e44728eb1b3ab177f9d99439d508b02d2679e20b6ff6cd01ee1a0c9036f3f7a0337bc4e1453d248fc226bc666f038f6be9a8a5974d398364b01b649b06cde3b2fd4658245f5e1dbac2d55fea4dde3d88a15145a3b4d19a27f7f79d915b5c2be25acd087d8a243aac2026c1589d749033209a59bb785f48536d8ef6cdc075dde6158055c50e657ab1915e687a1bb9137e2da6f202308f877c2c3bdd60964f62d90374310c4b6abb45bbe2e2a02df0b3c185c3f67991325cf751721df907f99406d411f17824ab5945e0c0dc616bc8e7636367c78763515aa12c30636c02942adf04074bcd4db6d08223fe680b4d60e3305e9ecfcff64f6964fb1a4a001add0f1123d74f8f003911f5397d4d7354d7db071e8776d46b4bc4bda7baea9e53402749daa6b9dc9017c6217084eda2c4005898d9a171a01c8278c94d4096f77a351cbdfabeb2fbdf9811d514adb0f8b1dc29aa1db8990b802271c9976df173b37db99ed6bccb392fa6da527c66eaaf26a6cce1ae9d2b96294f5434f6658cba8687c818c13da34ba6b7b7c27952b58f7bf6c458bfad659fa61b7f928d2b5305dbcd912ac8fe04cba1f0c5ea708d026a75e6b96e28788f4fc4cc3ffc335e95db6040eb498b2a247090c1b7fcef39bd4daa7be3441ed4faaf597f7c656bed27f3520720834d783ee589b9b86300f57172c4b66a3bd4c962a21ed4dc6f60367f0e6f31140372d75be365b187cbd829728f45c6dd36efa56b78a256d7b666263c18ee396bad1153864b9f25d42409ac588f615d63777e0a5ff77457549866dd60aac7d28af320b1ad2e9938318c522827659daf6502756b585d785ac56eb8d74d181c541aca9bed3887c884ca920d6eb77f3b7d5634613167064e51e25a11c471afaae984e12f4fb59a3e682bb862b3ac9985c038685b0daafb8662e9ad8d14ddba3b13c8b77542bbd9dae360b2889f3002c51913b7b9ac802d94de7be8947a5f88ccec378177337e234ee8ea990d43070a5e8631c88b146621d46f126ca9c1fa91332a187b65be83b047263b2827a46389cf5e0612f35b3f6061c2253ea3ab644363fc48d2d888f1e243eb03adfcf994eeca7739df7c19919d562716f70110542ce5d2d0b25d7df766eaefb59208ff6b66cf4624b9f5e15ff743868b40cc053a1b4d44147eb9f7d581e1403ded719ab469e3355367b39e1bfa363cd00beba932764c6d9d969c477237591d598ee6a727d321c6bd3d48b501dc471df99daeb9ea1eb931613afd640715a20969b1a4f5570d443bc90ff01f6b4d91f53e6d5b04d4c0b899952d3bf56477b4b0dae6cfb5c2cc3359be0eaa81d4322e784998f60197bc4bc3c656f125f267b0a249f5f80fa6c19692505dbd06620239fa306f6a91ed04453d475333da4a14df251bf84148fbebe4a17d9c893c458bacd0de59e6b4c31ce41218af5a04280f615bb92a61f4c4575c4211b438dd0240474b34be94c4bd37f0f08e92c2e7989cb66f5f2651a44a626462e44b50eea91c52cb7cf02b7f36bc33deb8e9757471e8cc47ba1c7f31cb0c9d8668ea3183ede229a463d726a92e1cbc1d869d89575d30ecb286039f537042e91855f66828fccbc78fe1eaebd5c0e5cae80023fabe28d1ad4637d0387525551c779d557e6a50c6875c5913dc12c79ba181ee2e36004c1ee3220eecc914fc3fe1f242dea42c1efa3defa950ce6c46901d5583ca06fbafa786c42be1bdc751830cfaf80d8dc3bd8bb6286641971202697a7902066c6e7cda39388fafbd925568696d2fbbfd9da94c54f7a00d6e9a5c0114fed13c7a8f5a5bee83aa4757ce4d2682a2cbbb9adfc33c94f6594a5acd440c1325de5d7da1630c76144dd9a08e050a2688ab89f3aa44c4f4d86c92d3cb3f20615f18311c0107fadabc54f6947d1128985a979911893814cb04c43bd947d96c75d88dc782107c78f31cf5631f80070a268419f3fb45f7adc5b14cf6981ed832eebc6cc92a51d1aeab0bd53b673f1dcba8e796a38fdc04c08e66b68dd1564a59e885d0e53c4c9fd8b096209381119a346c680e7914a662a22645e856b49faee00791c500882b1450766b01da065aefb4a45fbad3d3b3e891aefb3173e85c31145724dfc0ca89c5f549923dc183aaa9ade21ee1625a91db8b939548fff116a8ca040737791b879b9f2a401f3ffb01811584d60c5f637021244576bf79a68e536db3f2274ef7daae5eec70a800e5f2bfb52ec68cee4e3629ec3246aa05fc0fcee2e602928526f417e726da0e7e4318f15b95d4bb776e134e4b903c8fa18a69d3e11a28850eb4f9134092b9668333af7ae2b5245d1670a87ae2bf5dbc45c1105265df4fc60021e2d1bcba060993f032f2648a538dafc3773a8ed84d8770d1b41b57d86263507146a017a2c608efc7cb5847b863adb165c2ea7046003b0381f3604bba621fb46a521e3298fb7a9617a9873c9d689dbcd179e83f4328d13b9c5d68230ea150bb57a56b3d521465d1164d99fbb744cc5189f26e4ea9873c84649b893a28b90c6f45adafff00a6d866c020d3eb96e91b4816d5f5cb9524efc837d4608cb84d6d0aec04103f229cb9e506164558652e67889cf0ed4d1887cb6a488cf4b532f25e0881b527c54ed0bd279907c270aaaa943b61b291b6fa3bfeb7b146ae96498dd6757469cd714f8f3de240266473161a591a2b8d684d297f54256d61de09784deca1e180450fd46e2f514dd08250c0c3c10852cda7bae0ada0c22688d5c6f5c626b052e76b7fd61d32d299b04a496d059b920b5e5e8d876de7656dd83c67db2e52bacb93133778515b715039c127a8be5d89fbbe29cfef6add4f6ae9258bcd62d8474e1953d5dcbeea00e8ccfc14359f3cb39cd851437303d03c78872bfa4e4bae677067a51bb2fe6843419fe4f0cccda42dd1c5996812725b0c9c9e028e474c55ae78739b5c42b07240d1d8f2095a292a6c33423df877a2395d470ea56bc296e63eb413af2a8bfea4e1037e8706dfdf717d590b5bc27c135d9fc7c38c7c3db5a679d46930c4795df425083603b89320b2184980b3676f9dcfb0d5b6fc515bab577d07a62c3308ab72fd56782504e3b3130e075045f0f55370a25907130379be929aff465c9d10c57d38817596d2def012b41a2fb951d59ccb1270987fda5f560acec880b51de7703f214a526ad96b84116e77cc19eb4fa4b12c8335c97b50f486be9c90be63e609a4a88d6f36a5c01fbf8aaca769f71066851552c1e8cffacb24367bcaf6e4b2aa94ccccf49180f2f794a20daa661baa5d83f13748d3ae09f4ec786a55bbf8eefaa4a268fd65408332d32452e969641addaef2aed210808b618af8eb18299f932f092efaa961a4afe6b6f24ef4563181aa9598f19b82f5afca6f204a5bf493d328ef1f5bef15e535119a733356a070d6d59c74a2d03a83f7a760e4a77b7da310ad7470a1f34178fb5c73aeac3a6055905194c7f2ed7e4c3016c03e0e2aa5101d4d63c66ed027c921fe072d0c443deb633e6a4093977da8c4a784a6a35390d3a20914f8be0b34bc62f93cf93cc822f6ccb6ea0875cc99b5c0aee8fe5493e251ccc9e4813d62651eeb58ed7d14d68c01b5f4b686377d0e564ea1839a7905f04e7a097470fd9cff7ecf955087219dde15b0c9394c14f8aa6d96021a1b7245b3fb8456156e526778d8c63cfb132cddedfc03da4962ac06dc5352f8b144ad68e8c12a29cea4aa90df03282951eae7844893bde2f9071de886550f56a9db6544e30f31d8706e4e25658442cda205dd0fd47ff8c4914bf31361bcd738cff4acc5847ad5faa7ac60ffcc17ba51ee119e108c0a124c303819628ddef439a77c773192556a7663970b1c73ddf36f7f75982022c9520ee0464e23bf4a2543d5133243fb79ca192162edd963bce34cf3c0ef69d8f5f7e67b3706bd7ca0a0553bc5e17a462b3113802c6e2394ca855102a745d615e08ed3d217aa3465e702d95e455898cf68b7b95271662b190537299637ddfc01e8efa28978c8058e87074e3b787ff0f23e3a9530fd6743dfcafaba034e7b4d83d381b3b6e12aa534b6d3ebffaa9a457f4b581a4c4d46f56feccb2bfc69295a7ea0eb9e6c3f147f93e75d592f616e94f6e14425336e8b9fe8a9edc3815b4c76919fdfa8832757630ec46a3b57fd2b4a1ec04f1b30d4968e64ac201dbc296276cbc3dd39e3f9c9b5ad99ae57857a884356f5e0cd61d5c7a30903cdd763df87252a2981acb73ce1e35b5620f1103dc8a840ba624dd8138d0a214c50f69b59ea1152d14a4282a0ec5ab63115ec356402306cd8df0f7c57b6c19c30774d52180e70dff590a09f620a4a4f0b025077f17c9f3762ebff0a7aba0ef2b045f5a0592aa937548ce397750ea3cec623f52c4b2fe850ae32940a0930b13fa1e38fd18ca054dcdbba5f9c843c4946eeec290e2a4273ae114e0d5a331ba0909e8390efb1c5f721046fab82915f19efccaa6444159dfbb3b8dfbdd0b5ae53c333fd13baca2941cf9ebe5b013700009c4aa10766fb8821c60c4c863ebb1501069fd830818cabcdf37b19b2541392b1f9c32873b93eb68f4b3c316076b3048bb8928e5c8648ce516fabea222dcbb88f5e62eb93336bae49fd13346b11307c41ce75af4e4a20d82a802cd48c0e21eb1aeab6134433c73d8c09086fbc25395ebbdd0c524d33a212f431ef24c88c5f908662acc47c218a745dedb97f29df0463e8f2abce6bfd61f5d099603427ada483caa108b2de0fdac708a3d6e90233e3d4ec6fde2f50683aa0a7e0f616217fd55bb929571c3c38753aec804e0d7cdeadec7df21f8ddf2b7158591b84311b338643f051838130cbdeaeabd05be61a7ce98145154fca501525d476719147d652a637a495c2407a32d014d8d0983d3905370a6f6d5926d535965023e4da07e3f3996969e99ad3fe67330c326f95b5e25f2b6e00dcec30fb2d3d5a62f1e0260409143f109ef2613a650e7f09232af8718c93b6cf6a80354e77dd37f1f439fef441da49c20850cdecdc036c966cd944e7c144f92b7f56fe57bd5f63981e75e15d220dc96b6b51a6d84a9a618b936913a2e968d164b0ee7fc09e4f89b12db9c3c7c22e2e2b7fa19c95a035571d16df67fa0eb4cba7e5e419d9ba3548e9d461b3412a8702a247689620c7a13646437d1ed2eb5843ca1812b0d1e93a3cebd6b5a176a4a6d9351890d582f50bae085a8914e47ad4a6caa0d6115c3d5e02c056f9bc988315f35760b05ce4540abb3249f588618b73d85357a5300ebc079782060b6e053f0e148ddc15c47ed996d2f2bd3d0789a339800fb86a09471adadcaf9a74be73f11f74d18a685eefc6c4c9f063e491966ce63b4dcf105432ffc96b349fd575a9e6ed0b40fb683f6591f956ac73756211e34a4f3508032a03d67f860a473248df1323da75aeb2f11d265aef0a377e8fd800e4352599a1949ecad45549685393fa0e0bfb6d8cc49ac558665ad9d8cc2c72bad6b046179f77be8fb4a85170eb33b78740b8481ee62acce2fcd11899221f536edd3f930b72587e38bc89f03d18010feb1fce17dd1a5537c58ef16d8428e38249dc01d6dbdaa1e23bfaffc793509fde485c7bc2b06c9ccc731f23856d9248d1ca722bb6ff07be267380fdd933705bbdadef3bdb104b6eed4584b05f8f80a0588563a48fce6fc67d957efb168f441d0f0a65976ce6c80023672f15e0edffabddb509922012c246deaa7af1d5d65dd44f1918cf1aa20c920099f857940ac88fc9f190021f390f29b4845f41edbc57c3ed668aa541b9b85163713fca301c5edd96eccb031805b580c34987f861b9cccbd29c3654b4dba3534d2fd5285fbe656696707c271bcb11b5cee768a8c3b7a1de87ff66c5b285b54030938818bb9f0dd722b048c7741e9889f811159edff0782fd96a1a7c7755f67dfb32199dbfc6d59c3e7f53b95009b42e4f48f5295ca143cb5cf23570cd03c70042237e083614c31f3b676d9f66e8fa6eb81d40ef9ccc62566b4e8c95f59cf8fa8bcb90391261b93e8a3160aa227b5ee810763661997803a814776dbb2664d31303dadf9130cc561b9799abd6426420b18b692c7c7a07de28f4bcbfad3aedc7ca39103feafc5e3c36612aa140f864fe72f30fb500a0bb51b86d902f61b46038ac64c67a9cffc000d599ab269adab5eff9149d1b5da64c734927b2d251692ab8f4f5fcec5a9ce12555922c1d10fdb77b35505611a4eadee18c78dec270a6e03339ef36cde8009f797ea3625e20a6aaea3578d5800634f2a41f6e0c63272305f8098e1aa3f7b9032d195df206c80fb8e16bb61ab1bc794d4a6fda94d6c2243e37a59504f3cb01c90a8eaecf5b507406b0974786417f23440edf3edb69ad227a66fd946ef8e3abf487419d74feb7b3d22997b1ea985cd2689d7ea34ae6a9927bf35bf37d957a84a72f383580f29f4346c307101b438a9410574ee2005f5a8739e36f04e3579116726a50f92ad168d6d75a782145e4a930c315a0ace7a9ee468a0b8a6ee8787d861fc38abfb42ea2627f4f4e0707e30280691c4d953074c202fdf5cf0261478b54415020f8d45aa4db7f7e7dd6cedde0e7c21daf57fa5dc9ad762861d81d5d8dcc32aed54d8f44c5bf07db7cf3adc360eff3ef3e4ef56f62529a962d7081961ec9dacd19d1530b60531ce42ddf9679fa9183a6dd340721b81f68ea71960296a35692de1fae91a760c37333cd12ce6f771db2bb49de01d8c9feb97b75df346512e379b3e5cfd32ca57b95e13e2a76b250942c87f0831393785cba939d69c7213cf1a45075c6e1a747633875d18fb101949815dd1305417dd84958c7ca7a902267659d96e94ad0779cf6a27372f5411eb4a8d804fcae160354f45b7b731e90a19f3c75b0bb779ff487cf89fc730605bfae25ec0113942fbf310fe58ecae703f3fbc2df9a3b62af8cdcc8ec09fd03f5b2a4c8e597a41e440c98088f568cb66fd3ea4c17f116373abea0fe3327f067ada503bd0ccb1155c0d4262f55ad140b6598a6ebe17755d682537e21b3afd96548abe4e1d24200d148ee60aa6da6f25b7548232e3224779c50f65219352df98cca9a19ffecc27663bec7b301b5980fd0db26d8a0cf518e3eae693c6bac46554ac26f77823e9e62e6ec030e164dcc3134889826931f775c97e87c6c7c6a77621643daf6ec3534e33bafc8bebfa07acaf3418b2078e35ce2dd2a56f9386cc5640db5250f78cca1ee461b6e1aee21b5c4fddbffb8d5c7d84a1dc85cf8b21a33fc295a0f6abcd9b607a111836d7d72bc3b18e22148aba3d7fc1033d77a6876ab04039796a8c6efb11dd9d88eebacb5d376cd52dff5102f4b7f1769e23b9adb287b4535591477beac6410afcf52ad37ccc3009d7160af8fbd8167940e76c5e365aa280f08e42d0a3056c1c755328482afafd5c7e79d02d391fe5b1df0a0a663c37414e2ec94b5f29e0d897a1418b14dacabf2bfac57d862ef7b8595064c524d79262f90bf9759b91859f886967f82e4c785981ce0ecbe364e0373d8d967e4021853cd0f4f7dec7dbf349fd7e60b3690bcccb109256416c2f11e4899fcdf330426c61534910c72c4378ac9c3fd720dc0f1e5cb2d920ec443c7276c5485b45cf65a2b95e6ebc6a461043055948f889fd940f4a219a1f0cb073957260ac4d4897f52deecc46dbcfeee481df89dfac0c9e85335aec0c619924b7cf65dadc89ad4baa809c569c2015f03aedf140c6634724fbd9bf147f2942b02920f1d2a56864979ac5ac37c7fbc3d1a487361eea0ed8d41d2345d5e98b04a753f8e9e1fb50d00e796fc89173e3388da687338003438af18b259cae3e9a8ae431ec045f9435842be7e758f99ccadb63f20aa82351220848d6cae3956cb10bd4d4f4b362c2f8cd649b28cc2786a126ad5b76e175a1e4c723113ace584f6eeee2a68814ba074354cdda1d978f50296f12556fd782d9b07a8a031d1cc09c734325f9aff6b6344e4cc12a7e68d6a68b6f7236429c1d9d0b58ce95f6b6e439fb8c0ffc7b6c127d386f7d008b14b16eefac170ec60257e6e6b045a834ad040486c37a8a6c3c7cb3d0b34480b88dff809ba705a3dc6b572aba44c86909bca82bf87f73c2623fd3a246183891242da9b597f9fd136f8a72566f1eff7b3f87dd8edfd41f262741aa01fce0310c988713c49dfeef6cccfee705da535085c48a659c8ea3797cfab3f68c6add08117ca4fb0307bae5aa9e4066830c37e76f85d7448eac1f3dc7043d980c16d670674e7126e062c285a4eb725bf352556958edc0091e0a4768e2d9bbaaa2c9118ff157ca9dea813abc4b9da6347240db1e782f0f8738b3e47a72175be1f58c2cf10c165fe82efb85dfc22c9ff4d9c98aa3f8aab312c3a3b287bfba3a88db040e53362e3d304fb466762ed00a714fae4cb8da7031805d945355db772aba15d7567b3fb1352dbb1543b67297bfdf59111069c81ee4e842604e95b0105eb3f5f7a8cf76b8b859c0d5925509e288064f3e25dc3f6d33d4c92d5c4ba2629e3097b52aef5b756a21bf8f4cf4a8343ed2a14da40a7d7a62d2c13620ecac0fabf4c212d37af2a27dbee95f02a3734e09183bef899ea8504618c7e4a7d3f413488cf0d2d531de69903b4d8397bcc417230b82d5d71ad4ba29b5bde1d7ac50f93bf8bb4ae4cfedcbb4d8a617b90528f67c15c7103628e971c2ce27a610ab984396f70404eebecf202fbe51583b9a187fcfabe9ad0cd92431b808ad647bac37b33989bb1b99a0c84a04482697616d0c27ed5ee7b3f2df090c11e769ffee1c177fdb2d60a8691984e7fd37f5b0616239a11cbc6034c6e28b79a6e63c76a1408f52633b4fb3c71872ce6dba97294bf4affcdde41351ccc145180db8e099a67da4dcee904c270c6c4633870465f85513fbe9633a54843807137ec98d10dd7618d9eef992625db55b8d74cd60d8fca036e75b5663def107237968ad7fa9b1a2519a823acb2894439ab56aa0c7ee507b35df29108a059fae6240a4c9db2a012c7e06ca19d8bb48f74fd6e14fc6267bb5769022569b58ef1d30da3110497d93f0976d910348e8b5849b01fe6ecda2478bbf11ca3a32a4eb1f2e83fd906fd2f162a3cafe16068e403d47abf7d6f0673b69e0f8775f96abc91c2bbb9aa76f654c844799fc0956ab735c521ce0079fbee9ff4ab9494ec58628766116506ee06c9dbf4749f65005ab49916a7354de5c1ac3cd6af9dfe196f6b389e6756ccca46019bd4aa1515e28eb5216a49a2276a9cf7c3aeb3d7a131fd269a441b55a36a31a7b343e4dbfcb08406423dfa62d73b32c2fe76746ae053f8a9ae0b5ec0b6bc3b8c9e7d4b0b851069e2969e057836ae28a432daee80bf34b2720e13ab1b02c89236928b297b2ba223c4d6ce8a5d65592d4e20bf21dbb9183a462d013070c8b54c65d36cda904f44b49b47735adf84e3681d958e0cf276d7f7a0cd2506dda9b1c89929a139e68a36c8a24761710a7533637f4fdda5adb36254f066e6a0727784aeb1667ac1e0bce9866f6bb8bde5cf94096d387c184b0a3deaf3c9559e865018eef0a6eb2bdb247fc46dbaf460e676d2657093c7ff497c93e85f5bee120088c6f7ec1a68cdd441842f09443dd08d68879b1b96b0e2179a3dd53aab8eb4e149dd6cd27ff64da70fca0f3f9827d36b4218429f139be91feeace9e4bdaa8ea520e09e9d81a1d7a8482ac22cf280bdf63b12fcf36ad8a61f0f97cf8616024d9211f239cdee0d57504a7a12904d36b94b036b5c8b675e93549b2f8fa41674f7b63e49b2ac88a5e16724c0550efa08fff1fc9b2f0d69ab3f33c6c2c3fc248eca1f4ba8335aaea5e293d06ff828e6d5877d6ce08e2ae1ad6a22ad63a4f9cd4e861d1163cead8c8bdc12426ee13f810ccf5e4b52d03f93744d79a64fe2e3cde692d5729968a9a375571d9a32b614ddb59b7c44c3c05af3f1d32d96fa101400a3cc9cd0b6fccecff808d1f7861efcb0d7af006f643b32b1fa0977d75a6fcf4357274a61d4b45f87685931dab3087b77b4157c57290574de2fda4981363354889b63ed5a188ae68eca596db51ed0ae71b42e52f84953d62b01f94d6369f2f7e8fb348d6af3a41cc15e37947d7ac8495e25dfea43330c8808916c4ea9cf68800c9bc9deae0c398ccb376ca807a0765c88130f8651a0802619902febf51f488ae25b8686736465e97650dc62c9558e63f3bcd3ef013dbcfafb7146a0d9d93635aaec74ad534db71f8360c33b26240f1684275429043d865e87293acd3032e92d326ae67be511d4816a4e64fd036eb7cd62b3e367c51d2e177692550b13287c197f790c051809f8aff7ae635084a23140e474eeb9f35048da1a0c21c2833037374e868fc726d25276e27032724b74d0b9487592f97d553b9e0e05804823dee790c2422916bd0ae7110ef881117dce9727cf777f108ec573d30d33e4f0ce379c6306102b6f3d056afa34174b74357f4c6196dd7e26a76b3df8e495387aede65c63051ee042efa33cfbd6dc54ec5cbd7b21ae8adec7f9e49b638391419818915817b7f6b9480c9e51d0658862446644f87c33ff119f4a3bf314bfb84ba7dde68ebfd3d43ead928981403e03fe07d7ae6ff5a8f7aead32c4773a3fc6f6760943f92b9e987cd19ae663e1aad1067b412cf7696ec97ce114466afa0990da67c5203432434a63cae9a06b06d0d0d907a929b62b31c2dad86277ab72685da3f1c09b42c01798a009852abfa89cad7330e5c095933dfb218a2bd2d17b11baf7262a79eb32f4739d7f84c1f7513a31c041c9214718c35e354404aa331c696949d0983388d984723b2b63093e00001acb2813485c873fa3048ad175a648b875a530022a51293914c69b1509e682b7076583cb9abe668225d9a9b8a60878fdf04c1489461ca7d01ec0f8b5428bdc1799602e01c760bcd104115edaeb8b326f2b9b72009c84ffe582fdadd24b4729608930807313490d162b75d1afcef976b0e1b69212fdf999088c38db49394a6494b597699691bc6be2e89ab67dd008319d8f1be81f3c552401db5cbf591869afebb418d2ce4f3f8f9004f6e706d9c8e5217bd25d18cba50e17c73b2f1df8842555f1f0fecec6bb7ce95f462450691deed20299dddcb49c4489659f3891591a5f1458ec71c1042fdb0a9afa0daa8f9c515f8cfcfdcaec2531e516221990796260f9b8aa1753573e042e84878aca2d0385c0373299b07b3d3f300540e41918273626f6cfe65aa5960fa231b1545d3da1441b62c431164cc129841164ee8458e139a6e93b4874de17ef762e1e9971e419c2d84ace572ba66633c3b40f07d47de6081161a90b9e812900f97a6d64ccc0cd748be99048f5900c683cce4a0700a28fb7509f06f3dbcaecde952bf36314cea2bc1e30b2b97791704ea42b06021bc2070b6e4b4d90cc862d9a6a37f4ea8a89a15fd9cdd3ebaa909687120c055f69789f2cf40516db30189884e1cdb270b1286f6f9647018c73a4c71ecbebc392c5ce16c29afe3cb541816e8dffae5d7d149342c01b8accddd40cb964fe363d744cb1dc8897bca6fe90d34d3ad6a176e7ca8bea32262429c2e57d7c3c7f6705c3156b852c1cef7116677723456b9ecd5ca9b3bab1a4fab5244c5cde0d8781f71898a34f0468d6abc426e5d0260756869ac4db989b1baa6c3569eca0b2439a97c7075c6700737506c5bacaa1d6da76751bd076e92f66f46ba9b46d345ee8180e6bc29861ce88c6ea632e502d398d61ca714f91ac9e5c779ad0b0807183395c930d2582636bd832bf9874858f72ce747a37663763aa417cc65efb6cd29ebfd580f9d2ca0492131f21d139807c79fd1724a93eb75cdca352fbca7883b7644236ded1355108d090eaffb0d8ba85f3122c1084e0ce09871d9187b1cdd961568550528a0d511bf83a4bba8310728fc609c3204852eae574defc707b1617d24193762b74d9690b7e031eada4a256c7cebf9bbbb82994bbfe50f453633e5170333d42eb2123f4cbcccc0eeb4af4b102384190189645654b4238f68666cad98e2c0ee51f64b147aaa5c5db2ff897b0fd48bbaf615c44a0fec228002b2b34227a528dfbdff3aeedc11716ad0c9df7de6d578326eb0ebadd2bf12c3d4eb2462b6648049af1354e07c44aca770f816fdae728422c300b05dcac40c470099094595d301b488351bf87a940b950df53fccf6976f1f8ec74f41d67f8313f8ea851dd78bde64facfb746b991733a71bc05394ee4f57e036c0f745a1fbd76b006c70c6f0966f6468f2d934100014351eb676491a6b092e03b9b66b2f1ebf6ea7400cb8591fbecaaaee8b9da5173fa857bb804dafdefe103d85e8b53806813f959896b7c009b4a3a5ec0673ff1db74ac3e16fff8d8914509192e1a12d1020272d5f6542358615384df9453eff2a2436d1f38f59d4ca53cf4fadb1ff15bb22802c6d6b23ce348ffe031e2b598bf5c1854ba2e844dce021f5e27536944d8db19a0f478b3c369c1e67eaf022df9da0d03a808a1fc3547a813dd23c8518240a8ca74c106ccfde0618d253917a8913351f538cfe0db2b00b5a92cc53597a79c5c207000d2a1df01dfe0ea8db7bb224f20b59a6a96f1e2258eaa3072f8735434efaa9212947c76559ea5752abb0186603fd41","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"e51cb6d05ed027db058edc159e71b81e"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
