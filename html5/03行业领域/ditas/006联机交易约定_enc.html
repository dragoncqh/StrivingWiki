<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"a72ce1183137ca718904021a849ee9c49e0d606a6ce8907b71c25ec35f0a820ce7d3ddb2cfbfc1e75f0aa85b555fea3cc879c2c8202aae03bebf55dd5dd04336506cdb04f78e304b2af54096160e70a020b3791b9a5aa9dc5eb9e2649a6810a2df395e92de4d15d402f5e40a33325a53cc6356c0e2a558c94de5906f0c448fa67f95acee4b26984bbf9a1c8c47e9cb4252e5f6d090d7144828e9204f04eac6372066335b65f5ecb92ebd201d929d81b166dc74e2ebac6df98d84965060438f40953aeee10be56a01cb766f8480f2b8d5d14a118c0c87481bd92f907a62211b8952d36f21684faa7e350d85d974f2fac5603db4f62c9f3a726aca754fe03ff73392fd69a83d9343e3118d2a51661a3c4f343f71b5636d27baeb5f14a680a2a34ffa2e63004b87466c6135a4ab656d0cb3db9b778d7f659c86b407e3d85cd3c79f97c959a47dbde83c2a85fddb7a45361b6002da44f03ae575b734559de92d42ae4b184301020d381c92b2ad13f40faad5ecbd4b6ea2e334d8fd009534eeeff10b28aa06ae3cc04e8a87361955e5e91538d88cb4f7812659abbe5bcfe4bcad0e67cab8a89f946a394ec5799570d355e923097fa651bd5715208b27f4955949438eb78f531309e14f6f5c6756b5cf92398ab629ba18d0e39d263c9944bca3d7cd8f0d5c08bba34e315c1fed121e659d290b21b08318bed3837cc4dfd57d44096a2371322b9295dbe97135cd814630d855d74271f1a33f48e8c55d83cf028b5c5c8285916e4cca3ed0d4915d37ac5d1f343507824be2d810a7406396fee9f12ddf13757c58c0d443950989ae04dd393a4f2591b3ec05cb059939baf5e701ba4ccb9884d0e673f52d2c9521894bd149e26dcd95cb26ee63c344c61e72ed554ed35b9ca08cac68f477e2fd0697d0152ae9f9e1d022ce6e7b2ce9be841049f3a4ec6301d76b173070eef487349d0e2b4a03ef9e8befeaec8421693166ad8051d870f28e28ece3db9ac2a2b0458b8231c02a8aee94e04ffad2452ea8cd9eb7345e86733a7e66927f33cc3c91e1942300bb34d85faa68059ac3cdae25aa035df18172d912880cf4dfb80e4cb6321526d9225532c3e7b343848ccbe5b7056f8d1d7ca1eb3b14adb56e49d2a7a65a653fbf48a7c35a5b83df6f6073d6aa44dc3e6f730606a2a1283072b40a7377321fe0f945e519d08ac605d18ad47626e08fc247c63ac10ddd88933c7c94bcdeb868c64f108e45374be4325c06f437d2e44d56a06ea722dc6abfc7a257e6d34bc818842f1358eeae1a6f07360013746d0ff96a69dae303562a30ce5a3f404c413954f3656c899db9df75744d233bac365ffff520deeb0331d76aa41bd5ee0478e4d3234e81e511c8cc6e3dc37a8b62cc05f82ce5aa8e3c3de0c92091186c379a739ede902f5b20894bf4eb433654c2dd456bb3280e8d8bfc72fe5724cf0339a41a58e4ce175e29b220732e1b95b0bd3a8449fccd372c969adda54fef2fca9c8e5a4662f60e0b35b387e63a24d0a30325147c35b6e1a42a1778bc217ad018f013aab43fe995476064033ad26082418b0c8d8b591bb685b64820185fbfe29b8203aa6c0cd793280e5150b3b2219d8b1cbc04d7aeb65e3364823037b41c91d7f26109f0f91a38191a97305c5491e1f8ec48b213ec9b4b62e6744cb4b631e1b8657e1b7a36ed11a51a2d7f4dc3bcc87218645c20861199af0d89d869c327dd48e69034f9cb19540337d988529716840f8737678e5926ac56a796a0141753aad4449225f7d78befe17fe1d0eaf53deb534ee6885820ffbaa8db97d930e467b6590d75a65ab69bd1a7f3395f0890b4e3f143f9612a037c6b20afc9a3ffd7c7c7d035b4a6c55f5b69aea5fed74c522a87a0b3a3d34aa2c26137a5ade471f9e928c9f1d5fa54b5835eb06ae3833df2015cbf673e82f9c7e9ac784f56878640e36ca6cd287dd30e37867c108aa359e1b209371a7825f90c0d52eac30f2540b72f050f78bea3729fec58f6653f6b0cbc8b9a462bb74d3958ff4b19c0177858422bf8606485fc93068b4e447a513407978049920e5343c4591877abe5791fa960bb3192c3a2bd293a12686a7f3d4f7e1c75bde5e393d02dd53163ee4af0883fd7cbcf40d865897576e3dc682bef5d298416bfa3d32e8b6f47c74e283a03f01dac9d808ceadb610b558e68e8411d930c1eaa926b709ee1328391447fa6017288128d1e453b7f40cdc04953379b71939bced6d93e77560af1f3969fd738765341744a6a0bf27c3d94fc184a55a0c672ecc6311433fac8c95319d5f3e047ceca627d0273d2b48991d880d7d21188c9b3bf42a8ec82d59f1e9ca71e6baeff8c8ced9a42a3b155a6ddddd0c4c8e4b0c09299dd9c2ef896b09544c4b2ee6464ac60afb75c1f47f96cf005dc4852e0397bc2fb6d6e0b2c1eae769781b60a7968602392a4f116b208e5574265cc544c47bd13bcc7923b55f1e3a435f286ed46a43d4947ee0ea2dac2950f749a2ef212439041d9e37433b929f219aed6f8448882441494c56f31a176fe7c9342b02a3d2b5b0e77f0cdec79983e7fcf80d57fa6d75edc88179a947c846d5a9df338283a44e6395d79755b4726dffd1d570af0200e9fef76a72024c8e5a32f30b7f3b31ae46edd281445c8baed20a96c275271d7dd17ce3b3ed60436814c58192d8f141969a8cf60d2f2c6a1097d9062cca4754921c56cfee4f9e1222f25388eaa3afeea3cb9139e5756911610bfb91da2d4cb6f4a4f7c80369217fb39e0c221782d55063bdf2dae1544a55b3e31559ab32942f24c858db49887ea8074476c6776d2e658e912f1b786a184847623ba20c67fe06230e52c5a5f4d435336226cd5aa09fe87259e54ee259366b089fd385612b20cf5575b6a00d8e9e10bfc44811ab4b2ee922b2cf01b5d968bef7f27e58e0cfa84dc3283eb0f98c17b8e46a466de55772ded8162cb97a575d37b4035db1b25a6f2b21f4b487ba908a3e7a8b37fffdef22d2517b73f22c2a5a8d03f164707d9519bed6c85388418ede1796e5722142aacde4049f11a1398e728329f198ff52a9f096f84ebbe4df28cc96f8b8611e0d8307bb2f81b5fdbefa841f9ff3d55cb90ba71a08f6716aead12ff54f7cbaa7fbb60b80eaf2f8c9fdee27484b6e16ff704ada0eba2d515454e6d93f7e274886d61d13f915b9c250f513840a97aa695a81ede47ba81667c2c7daad5a8abdf6a00974a8bb8db19ed06eb0369adb1f3f587b3966cd6fa49cbb7044de46ac5d9bd0a2b33fc95cc97ae020fa8c3132bba8fb206f21f039cdcf660e9fe5e8c7a91e7155f812504a54029c0b17178a1d260e32c07a547fcbb2bbdaf6cff4041ac44cb81f99805cf54eebdb5c9338edfe1f40fcb5267cd48b92d8ac0fda6397463177041a7a6264fdc6a2a81a59e867055b3aaa66f0c75baf51ff8ad77ad9bc46159216f0dc7054c79b61c1656b1d5c9272f1eb254eeb4a345c5566e424d586865533df9dbd3c080842e68929d31218ddf1a96963048979508396ae93bb4e8c3268eee5505bfa9d60d37fc8981fdf3bfe3555fdc5498ba9a26ba9965f25092a77d0e0f7a0010fe7fb8b9226fc61c7514576e7c484a752a22c384cb8c2a8795b7a0581c77c95421302fd070abf946c3b147b2c5db606c0058119eaa89732f6f075baff40cf588c7a2e1beae62f5a2f2590de08f5a453b23de0954440e1abea85c71616f2dc00a70a24da5393a090773830cbfef85629da34f16b92ffab40969ed087ec52198527885807bf48198446feb936ca73f4b81a9be70658b2bfae4139c0720048e632685be42b0139aaf8748f007c8faf0bddf1124e4d384e1505688d41ffb5286bf5284de3c7231bdef95ae7549384787725092f00498e0b5fb202b4d323465f8856b1007b87c77e10b977d70779ce95a4b8db3203d044b99cd3cc52949b201acbb83aa71a02440cdf605e069daa8f665bafc5ad71f47dec674a4c31532ad8cd82c163a036eb32cfb322ab02dabaad30bcb55c20ef63ce11ee7edd79847be6f68025b3c0b4f74bce2713e5b52a296a205f940e4a8a84efa3ea806c51d5c40bc87929ac7ccb503012a61eca42f4dc425c2dfbc01ef2e3f5d805a1169919773a105e57bff4a1fbb5c81037a586f7888424f15fc4245fa3bc4ad72fbd077c87205919a646f0cc066223c5f96719a20a01e880802fc33aa43136b6c50f375d1a13d8199c683f4b9dbf6c6d3500510114bc9f8524658b773334eda7b6338c3f3439f693c7d177996b4bd24e77ef8158b4c887e0b630d07d7bb7620bad32d445ae66268f66c2f5171acd8a83b7d3a016adbc4f2f3b39ac167fce006e0f76e8793017898bcb08359415b6b925381c575d329790093b527296fc4a0925a11bbc78bd41b4931b25743ce101aeeeed549a15fd3507809311e8e86edca0bee8b809bed14ddcd82c0a83d49bed56a4031f312921123f72c798ac17085a3433da3a1d45d9c29f5de5ed98a5d5769b43989b98de90e53da2024100c89098980154569a19b9e1248242a0c1f98270bd1678e90d53caed1152ccc19b17c28581ef9dd4f5b341fcdbd0393aad3fc1d1971e9ad7f36a09e5654197386bf663299948993486f552f7960b193f633fa250376f0a20d0638cfad3d89314b2bc8bf768d5eeeae298d897376194f2b89d6f3a39ed0d93616360b4492fb419a5daeecd190df8bf0b27952a345d78505e515036df6e4ab383e0e4fae4be6396c3779675d7cf237d3fdd83aec56566853ea527be81c613077856f6ce6fa45f1ce354be719a7f627ec042b415f884cf2bd5f06ae8a3638ca8c883ec240fc43b35f5f25a44b99bab0e0752697fab7fa7f18484ec6f8f21ece7a986bfcf191e9895b40dadfd0b7cc4dfb6caa91b321f2cd52b141cab39ec39cb661c49882924c16155a27bc985a26529d8049d3c6797fa6f347912f72a6448573e852198b9d26fdab082d29bb1fa5c9dfd87807c8911647f1bb37e45768ab34cf222aa5cab27d65fef64cc7ebe5ae52906b4532a3f323f7b49bad6931ff25b8e5a323357ab3923858d9f263d4f34efe1de3946901a6b7c6a151bac71ba32b8db57e5476444184ea9458da35ee6c539c451440d4aa88540d40793192a71a5aa9af5223d2f3f9fbd9ff18d062db04cba66495123ef875771d07a66a4d2146a8c8fcbc638d341fc947c6b5d8cf6b4aeb4d8643b119cac6ad85574bc4e8b836306a9c8ab722992792521182ba12b1075c31357e996e2017a3f1fc905200c433a063ba6f90f309ae116b48775219ede3e395889e0e7f62ddda63f9a7314a64a88c318167cad9fd5731f73914fe093c27ce5681c98a6b4affa08908dd6764460417076e4339584164b0e3576d65768e858acf6d307c6b79c8af7571ddc632c18939d2c162e86aed11e8597fea82ed00a8e3a10098f84bf67b366916a96a76a9684d8695b1a5348a3ff71a69577450baefc6a4c98a8d9fc422c5337962cb2768a44c96043e819c34d8c7f5dde9924474694ea8e1bae951d1c1f9b2585abdfb89a73ac4eae9b6b9aaccd390b2191d28cdbf82a71e5958184cff30402ca7636c75ade57d6d35a5e370bd172000a77b852155d977e936c507c7a791a7c7a6d8be6adaed241a1172976d51b7603d8eaa31ddf4cec7613d24f89b831ca3067fd5aada9dbe58c2838b2873979546317a7e4a7c668b588743dbf57f90df0ee0121215a30267273e2769c37299a36ec41f66107a22fb9fa5b82961882d3d6c21c902efd9ac9ca53c5d07f5378b9b4bddbf3a46552b1047fd818385aaedc36b32b8ccdc984486c64213ed76e894c2e4af14e22b34f7ae545e07f1898d6243bd302a987a5f4d521a614dc71ef6f4ed2dfa9634052b84783a6f0b1fb0b9a7651b7193093a5f4cde4572c7d8bcaca0adcef143a57eb62b75ef089c99c12d5ab10555d95c659a083fa93a7d1be55e6a1627d8389badbae8172ce80a337d7bbc7cc384fbc969bf7d9769ad14c722a0cc69b2bfeabd47795d6ff7b8887152c4a2d67885ffd2c0cb376966bf5b27cffde3d98e16fb64fd9b9eeaeac7a91c35c0eb54fee4c233bc34596aad6bf9d72b532930198084384ee17e6931faf861e2e2114a86a9e7d8d36d05d5f09c4e49ff2fb072540cb5a6b84311be6ef00e24d2e12098422ff875f8f940af241d522767451f6412311b467f0cec7642b7a4424ce27240ac8aacbc62a95b175dd31230ad0e2b6c5ab83d7f97643809b32e3f0f6028d7de5abc56a086cc53a17297c4e529c15a376092112c2971bde98ec607f27181325ee20b5c1422a5c5c33fd66b3ad1042f005b5efea92bc30ac876354c3db2821f760285cb4cc23141a860d28bd970c8d7bb06c1c55c98caa08659bf2ccb4c5db7b54ecd118d8d4742909705e7aabe23658885ddd2bfc2f9de15afa955368fbeb22bdf27ce95474f75cbe06d6baa083d74ded5ada53f3e1b1afbeac485784608ab363acfc6ce4fb6cf33158667a8807565b97df4a66a5589ee7dfcdf692d0285aa62195e87ef6b7df9ae3dfcce78c6e5fc72944d8aec620cb1370f946006006d2459575a5ab56c536bd2dc60a1aa174d053c434c42e791b4e6bd2b33a3840608cac6c2136b0bad3af3e8b8e87e95dd2c5bffa08685127d5272363db712c36434afc2c67e9d26d4dcfe1769b974b53139e32717151a719e40e3edd035b87340e6f2d42622e9af225437cfd191604e54a7731b5fc6a6c80f9209b77e1d3490a258bdb8bfd0f5743048b052ca34a5622b2575789b19079ef6c27bb71411911fb13c9d0ec3700dd76ffee943aee6dbb663c465247b8c059bfe7dd634e8db6a06cab516d1c5f08ffdac5f1ebe8ef92146c7f071a7cad98289e37d6a1bf36996e65d1203364c767b63d2f9c3492f94ffc0325557f1b1c28fe4c5be14f97abe3b951a047f2547d6d6c1d6e9a7379bf3c98095e7e612274d8f1132bd97e2acfdb4487e38cbb8c74a64a22f0583909d6873fe14bbcaefdbe6400c659d47a4f7acc7ef16eef136bfeed74536f247f17f723f10b5ca84cfaae28c43ccfd564233389a969432146e3d33ba064600e9eab21ef91dcda5afea696030047dbf1d1b5a1d0e14c13ff9835e346aad0ceadb574cc1939aec57dc654abd9226cf9c86097308a0ddc2541220ea8a6dfccb3d7fa779f6e4ffb6578fa2febd37b4286f785a89235fde7f9869f10a2eb12d78bc889c2a5e7e2ddc8a2f4628bb509a0fa64c0d7fb097c9fffd49e06595da9a1521cef4be46640487897d900023bf50dc6edb69eb8d12a1486195cbadfd6e8126fa6e8afce3c220576284eb100b50dcb05aadf44719f44360c04dc401505faa682e4afdc26b8150b4ec3e28238dc9d9455b830b8b4ead71bfd96a9d54aa18a1599495641cfa343b91841ccc931f7dc1aa9a8ed7d7604f9fac16645cbdf1d1140600603664e90ad991bae69983d0c848925a20a5a0b82a46e5e8efd2ce4246c77a56a95e76a932bbbce2b652a6b3630b3e61cf194382ef2656b5532d2034c35a2c831fb384f8712e4617521842b0a3c33168b4c4bcc22ec06fc511d55fbc35b930f9f4823ec3b3c7be5b24caaca6519f105e36859ea0fcc946339cc413d68600e0c0db4dfb01ac19dc6bb8cd6455fd8c0ace29b18d80c6a0242d3866bba71ccc4bead99d95f0b045813b576d64e89e6f31d3a076538c498c4a9b641ba2ce3caab0d2b7cc525a65fe5b7ec55a841e37de81f187a8c8d0ef43f4837c3b36ccb40e63d9cfe17f843b4cfeb9ffabfd37d48071b5c5c738154384b6ab75994a37a3ee55cf8e7cf7d48a5db1c21558c04b6f1fa268a12f79e2e9179dd7d3942fc830a77ecc3ff73a0778a4c61dad622f30e793f2121c9c421357c8ddee57aeeacd56b0dcf468066ef41b898d8bf0634c0bb974dbb40e33dca2c6636dff61fa1cd3c8662727d963b9c49c24a258ff7247fb48a9ec89f5d2bd48ab6ed171baf7de9007b4919e308bf57f905f697ed15518d565c0d82ce89d8057a635a4a3a2fdf5fe1f88d2a008ea8f286123d142a87a36fd28d8a09b451f8cd8d7ee5a072f0a9b9d05309b5b9c8b7e6d417d650034976edb827c3874c4b193cb01c27035b369a404eae357f3be46f6a38905cab6c203f8d414a007b419211ebe2f95f8d126f7f82cd17e6f942b6538a16876250342d5bf6717945fff68a8211b605cb42e3f3fbda961595059686ff81750d5dbc41fddb8ccbcedc50f5bdac608cc41ee7879d22d21c7e392ffc7841262fbbc9b90f8bcdc4d14af41c64e9c8f351fe1d4912fc4f99004057e42d1d976a53f0a7fd2e4731e50bce9137e8f0ba6d0e94cebba6c58d7378d85ded77aff5b300e7e964c2f9e265b6fae22171979b35f2b1615aa547d1c40d32f61d4c2e6c3b2d1b77ba7f43eddfa7a6e8d1705fbbd01e3f21feedd2c45a44f0b9d51b9ba51ab5d1bf82e78954384dc55e7cfb7e0621a12aa94974cd4bb4a91f63f28f3fcafe5ab5b5e7793c85f2fe8b99636655d3452b8e1ee033998fb643c62db00e478aec32eb7e3af83579390ea6b8aa55d4fb7cee0bc14afce8c233532f6d2c8236011403cfe8236f35c1a3c64af5cc5010125154a39b8dfefb049345c6c3b9e25e84d17dcd7bc8288294bfe3d2e2b41265aa242f54e2ca6d1fdc51ad86c1401fb48af91e7c8ba8554c3b492cda019fe1e9938ed64ad5e40e5a3ebfc0275210c6bb85d4db869494364612249f30de50f78a1c8e3afdab11c3200c952e659ae8569e75c9c0e6a4530843c5ddd1e38253b50c5a6bf9d754b8256fae0274e940db1e8e5b2589b3552dd4424f073c0585d99eff9d089378f5d2ae2a784e7512bcd26e9e21f7c6fd6374abefe75491ae87c043614a8d65e4f8b4df3c69d23768d10257336c56553c7f13f0769150e455fecfc047b15da31acd7776b6024f3b2806b49e06ea7ea9246b2c0e17e6cf0e28b569b03900b181dc616905ac5b2dcce4a0ea6a7184bb4f2c35e3f42781d37a7e976b5ec8feb51ce6d90bfc9dfb915fade357ed044a4cabd430f31017be3891893dce59450222b1d4d46034855e52360d0a2bdac61453be84e620cb6a99fc22d75a44c31994716ccf5575f9cc0ac651ca3be77b033c04e52383d8e211d59bf0a30a5ddcadcbea1f89d1c74d343d4d3b90ad38346292d2011c30168cc043b3501d56fdeec03708db8d3f07c56f7f015ff8cd374c57be821b0f6c79dcda0fba3b9de2ce3df9c60ac502580fb7d47159ffef2ebe045bf8c9090373aa5e2c5c1741e24d6c3383a42b734e3b5c54022280bb14641769f73389809bb29b6cdba868e6281d1f0796c881c0f2c7228788de78e2d08b1da55d835357ce6b24d8c0f68ad2f1985d54ee5e4651e72cb92c7f1543cc49a590d2461760bd47378258bc0e69d4a7b7dfaae37153ee80af0d975d1fe0c4f931d8ac70f999eafa48d0c30f8d4917b1d73bb4d20c6ad7dac815b254ae03c3492682d4349583a62f519c4a81b4739c1e2a640d732605ceb672f420bdae3a615b7f5951f4a329d1eaee92fff3dea269730ecde13b15e25db7e630fa1bde0090989b9c31a1a9cc0757b347f4aedccc2b3eeebaeaa0bddfe3e8eb41db6dd92b0c0ecc859891a1abad7d411bbafe27e42590afa2b1e9db444c4983e6057bc2cc19cd35a175e90a28029e66ff54925f1f25c1e369057932082627024c2a5417cac2dd45b65574ebe9aa9fe0f5e8019abf1ed35d49bc47743d9bb268373b3933e03e4b9b0a753c646d82aaae224eb251804707f6b9751d2fbcd76bb30c6ea1eacee8eae3d50cacc5da6eefb2fbbf3a436ff4e2c54dcfb2c919ed93528b59d61188dff325285db5b11a7ed935afe093f356c1a8b6be96d327f502cd2bf8762bb3f8e24f4953f1c12a495b35563f404f5e553199c47c529a57423d39900c093add928aa55a2481e062a725636a338c2c39f4e792ae43e1f76c65f531d75116288fdf30a7e8ce4fe2e4b004b9d390b727f11c717b5129158ed084675473e875836b4fdb36b6a8ba4bf379133ea0bf6f3cf6ced97e7457f34e6c8391aaafd38970eed58e3a861b62408f6a804858234a6fd673beb53581f5f2f0d17dd78fb70fed1a9d256671a9ed5b45e0ce87d4396fc56ba5b1498e707fc185735b2dbafc7d9add8d6ba5ae11607c80bd1e05084b47805d932f297c20899c33867df43fdda955210eac36f0294f1647c1885b9a1c0af314a792c82f881b541ec2d337d0971e53b4266e7bfe7b275a41b689ea014221dc48fa4024f724443bc8210caa70f2b50725ca3d6f5e211506fb440d5959a0b72ef1c47e985e833e86a6a1c700a89569356f0075c0372e3ffeb34ef6046215ff665e6a141b00dc6bc690a4f89b1f5f7e69093e2e54fa7ab99232d468d2f9c03add33e90bbdbbf827bc8b8422121003760faed6741cf1b5e45c44dd51e4a03155d853880f791482a52327e6759976bc088164e1c7568c837b29476852e375b72227a409abcfe993f65346e5fd599db6bc3c26ac03955b35c20158c91fd17cd65109cdb3061fb74b10bb230f3b710c925ac4445964274a9e98286f98349875916a71489d23195070db518c129c0bcb8c97bc0826c4893fd4ec90ba0e41d0f869b038d59a922615945f79514b486746ccb1285e3c6e3b82d60d46c5e9a6cad97d706abd703186c1e5beb66586ebf57d299e85de1d23fdc03dd996f3197fda2a588bd85ef76ab3d3c2a2f6591a655c82254740cc1227cb91939525c0a6cc86e553f75dde4e02454b14f53832fc1861ddb18570e96a64df12c6fce471308e678bedea505ab0d85ce92d2295e147994a5aa01666f2619f081519f06c9bb68dd18956f837573f351370a19d7dd2632595da4fdaadccc5d3fe4af752ad9e3c6c6d75381ea5700ebfca6630634dc1c887790511d2974f22625f81219a11e67f936ddd3551209008a85a196508bc635d52b05b27a541b7d6db56b85c8b4c039c39d2678101e3771ed63e30a2505fa1660c8caeb06f9d927b263c7f64c458e1864a619cce3a70a0a5086a7b2644574f791674acde3b32d6612e3b295a8c1b765a167de858182c758a49a1d818f12febb45de588ed4ad548b14ef9a19ecd0564b4328b72a8d6bde3b5244ed4555808bacaacde4daaf55b345d75357ecb2a1be08974172c478ff850e33e4eff6efd312e65762d265fcf9d4af4cf7ef1c8dd97552b0bb064fd9dd77929b1af6ae2b9174f63611d38983e69ad2b25455f8d1846a3167c33d2aa3988840080732a34a02f4a6fb0f35e98798e6c6bfa2c4b96b4bee06832f4a881dfe3d27b898f1553bc7057a3f9c79d045ae68821b8aec81e0d30216bb919a6577f24603eb3e4f174ab742dc2f748bf06a3f41d07850020e7e808c4e2cc807baf38be72740f971a0b7693c4fa1e06ff3bcfa23cd00f25a5c1432a2fcbf3d844640aad6d4bdac05195d32dade822abe91f768307642fe3f57274be44edadfdf08680631fba5ca4a0ab1d74c7a92ab0c58fab7964b4267e6e904678d2eb6122bdd87185f39ec82efdf06c3c439567cd09154517057ba7aa510d363f1f0ea1f4b1312d613b326ee424447d38b98b6b31221cc81b0c33363eeabcd72856eec53d564e34a3ba32c46208af16b4b3e65151e8d04a0e715883aa236d607653eb7fa164e6014c6d830b325a4642ae75a7b4296a04cf8596e36b4274b9395c4366d08c8a80ca8d5fae5938f7fab707415398644eda53d0460d87029ab7c54d5a916dd6711a9ee0ea8a418ed22390ee8396452f30c6e2c82ef94476cdc647e3714bb30e34b1c927024c179265867900f7facc1dec5187802ed7661a0a11900b16583fc4f88a47ba0f760480bd5444187ac0392b6c53b455d19ca42490d381a1771cac1d5e022afbccbd2ab55f508afe7ad3a123515663075c560a475d683610202ff8e0e603064498c76045f0d086c2fe423798e72ee2c8ac8dd5b43266fa376d215b98a841c2df0ebf6833c8ea219d9bef845def0ae502a26caf76136d308bbe5b3666d6969e93c179863cb3c3b0cecef70c8544398fc4c9af1f3039e2b29a45f16d61ec26a0c2a30b7f75a1d5aa58dae352ddab3bde9f2aa0b6ecc3d60d6ed135384418e109628685a16e0789aa516ce0db3f243584108008138f8264b1940f8dff3203c34d0085cac4e6fc819afe9c69838bfdb181e0461763aa40e1d183c487e51e1f88b27e3fdef0ebca47f262ef5dc98cdb51d4910eb3b9ca8c30b77b586b0978ca14adfdfefa86d5166cc22ed4013dfc26de8ed7f2f25b195adb50419b8027aa51554c0fe8acbf2652e054d734052d0f52e726a3071c15a136979956a159ba3374687509979cb4ccbd1a780a0817a9072f158560ac55c61b809a1c5b98559bf2e856a925bf3fded7c608e2ee988db579a7850ade6b72bf33bb3b9908047c0d3d0654dcabefd0cd1f186a61e0db9de8a59b2a2165ffbb2f0e6fb77930b36dfc678ed6595384382a37b4db9265d50a432ebe53d6a8dcaa7e47364d3091ae650b2914bd3e8b6a3adc9f4ef2a2af58f43ac43c20d8391a1b9167afe72abe410758c3c279a72befe2454fec6189fd17dba4048ab433a03b983ec6f605af0cc45effb109a595c6dfff63fd3c47e95084d6bd47d44f6525c2a848f704020395e5e22f2dd4661016fedd4891b258a23084ee9522173a54a0d459ac41ad99ad368db7fb1fa517af58670a503de9eed20a4b8823413f7a66ce61ec9456e12b7990823f74797021d5f796ae6fb9dd27bb5639386bc69d4fc4992387796441c328d4199a74ed712e71c91918a13a7071fdcdda2bc6ebff9b7a72f48b6ff03105368baf556627baa4f0ac0b082f3137f7819f21f6264124f24384294935ef052ea8adbfb871a2404260ae306f16fb650b1df9f4a9f6b599c8df648889ef853c773261ecce50826525f0b1df68027cebe739c0efaeb86ebb0cfe506750a2ea11bfc2a7b2298281a68ed4b42ef9d0ada3e8f0942db120750a0b192d1fe505dd462bc8a6d9ad0309a76a5c303891e9df8cfaf4dbfdbaad042a71ca837497b1f4c9b3185b66c4a3fa021e1b979e2527451ecdc64e5f050943b00f8afc3f012b86155a2c8db8d6a3853983eef6c91eca41172d506607bf92af172132b5a4f46111a4e545c0ed1a3234d94295ee7eda2802f3a1ecacb9d25c3fcf7a9443fdf9147b43c1c646553ca537c51bb1e0911dcdc1bd71d8611241b9dd20d696fcc134f75da66533cf3c0236652b8bf17537042af2c34784b08f25d7bc7ea5c56838cfc0ce1fe57f7715be626f2919a7503717f77928f5b39f9338691cbe9e66d70d5b2f8993d1609f8116329b2e8ab2e18326366bf4d8b2729963ffdf893c53361960a384dd6a942f945d316b8da49890c4d786eee84342637c0ab09c43db1c0db1502d46494299f409b1fb4a4957299bce8469a68f1acbae0234509494ebf3201384710f3724b4aa1bc73ddcf02b7fb9a780e7474014243e4901ae48c330a652638e71615bc4d9e929db07d701d8e7d4235c139dbd5984f11c05892c0fe94e7954b0ed8fb161777cdd63a2fd45cff79b4db182f2327c1e6d7417c6bf4566143ee48c82a3e7e5b202242c26f7291365921d7aa9ed950733c19daa73214feb5dc54adc51eb43f7922172d1ae690682ee8bc5bd8992053619ee44f88d712a1c18ecef6b319a6fa983ce5b0352f14161050550a2f534f4c3cdad1a24fb89837e519d8513af2e13632de32035f7af8814acb52f2b16980a7dd6f65443c443f19c080a630a03668f3d0eb98708c7f4b53cca6b1f3b209244ee2f9d889e55caa4ed466cffdb71e2d953715e5ed4d63992e5e957699ee5bfdd70e2b87e7a6253e7e5d60f386106923ca792058b171eda8c49507b9d31db343da3045da8e1ba5bcd498259eb4ecefb0c812c83b6e1fe08302af7c4d714695a33ab0c0e7854f850985e365a0c7416cecf0a9badad592ca5f156d7b8c642ed4598fc39be572fdef2db7e4e541009b1cec28faa149a6d1939cc6eb771c149c3292f082a37170ef2eb1c433eca1f0d3249ae8848a04facc329204a2e43a42b787e8193372e8d9bd39bc1061bf6ce54fead89750d9c2710f1653cbf068220602ea561e613eaf8bc0bff0d09d4a44d413eb09eba95cb34949b004db0f5ae6ac8ce48b9c9356e740dcc00960c2920e198f7503ee5c3b67feaf07eb07542715129848640e7de409dbb979089f5a53ba88f8adbc415a7276fcbe4a60b05495e748c8384be0ba6dce57e6d52499bec9fbf41c277da13025613db2ab302754c9403d2c8d0794f70a58f2e2e9a5310507c4ee0d52fc81c10682e84b1a424b0e3d0d933639a403a3048659e3d7851e679ef6847e30217ab24f574eba6aedf70e623e72818e81b5d437a995f59c2266e56078ba21a040e09d494ec77ccd038c22ccebd8025319fc00b5a0e459054b4955ff704522215212cb7c0fbacbd85ca091765c4226f8891c5dd671b5ac8fbbc27f633c14d41358c2c9fe5f9ca5c9806b177051e2eb0209df9792db6c00e0abe101cba558fe9f03d9d7c09f86e37b554f0a3bd7c5a60879be84f8516b835b2dc9d14e0c545e22a0c95acdc3d38f9d27f7bae18de4b98970f2e52ae0de322706102cd9ee9515e0915890c007b84c29a93595178461451413f8f540365cc60ffc23f7c0b012324a5bec76d0f4dd92941fe7a365036f0a6b4aa8df2eca406848b4bcbef105075ba28393cd168f1edc2427dafd9ecce68d8a63c528200d7b8dcf3bb9870d654b32ce62751d9829692e8427274b899d19f1f153b89e155deab70bd8db68854def8743efc09d958aed62454651e9857289358a137df0d15bf070cc71f676953ef8825376e69dae4365b144131a2a02b1c96e1ba9ea5bee464690314eaa090fa963ce1da3f35f224a2548602f43ccc6f365b0ba05f71ec99ebb684d7eb579d62af18f6cf48e38d2a525c99b95e8b7a63855eab955341f15fe22a217c38743a8b616180e9e2bae6eeeb082e9f6d9d4e68fc90c72d812eb7564f50da2f08d3f18f1a52390eb76eda2c5b1bcda7e34dae23a6625a20e391c415a0adabe4e475bba377d5e0d8715591fcc16db4fd0a60965f2505c51c74e260b764b2ee67c33d1a81d3ed8e56e4eac85449d15cd9ffb6b24e716d3d510c1cf67a4998333f7e6959ba36903d971d81e81c425eb6af747f9e110f19c881d21a8d15ac5f448ee62b8e9abd664ccac08ceffa3ac9a4e6e29ae8a7215840396485ba183b5b8aa65c2de1e09deacbdf444bfb2a4cb933a675f9d722753b06883e937ed1f84215617076f48f61135384a3bcd7583ba154a0302d0bf32c83e6bc0c467733aad72772cd59076d39aea9b84d7ab94a6bcc7e6ef24c3904047b02bdec40c2528aff5cf867b66d36d497f653354e8121e0595c39499bd02dd7a39db901184ea05ffdaf4f5c887349ec403abb0503314376b3796c170b06d90bc6742a9c3004704158b911334c0a2a2617282ab2a1f634ce87876d0850b327cba5f04852d807a9b16f7429598396b144406fa524b81ed3b47cfdfa864a0cb894520eba8b3255c547daf10d748190af6224ba58308fe6cddcfcf4bfd33dfe0ccc832ba396a88826ccc5cc7993900d7c26657ec96040a3409c5fd4be87dc769112720cb05b12706586f7717ad6fd0460315506f9cd7a03bcade94179acb4ef46b0e099a019d7a3367819c712849ac34e13b99ab6cac73a2c0648de39daf0e01fe621b9f0e05460bc9a3a7c7d9de87b479539e7eff11c93214461609c1ec8533e3277afc1c654580a66e7a493a2ecd7ff8f7f27c815553870bce94fcf3efb0d1b58eb4b6fd49f5355e7ac5c2c99ee12462a0fd071dd4e3d370dfc76fec3fc0206fa0ed29e49ba0fa7513e038482e9c1503b7d9e69c75ccf1dffba1959a5156a403478793043a7e97e17918620bb4996ec4d2490bb18771d46099707cfdff6d116c037d9b8de3698f01e8e3531f76cf4aecf866e69e5e8defeb5e75315ed54f56b34314087ae053c12fcae9508b9251d0b4cadae1e7fc12fe592fe2e75a7effb94bc37375ba6f58ba85e6ccac8a8373b0b081bfcd70c606de6d01c107956df58c7ed7aa9083e0f20acc15f98d4baf8da58bfa4de8d154205b69dca8014b64284e7e82b079018531adeb93d28f465337f4b7b5b4aad2ae7526e3e101bf6f88ee9d966e61d02759af870c5cb9f4575e47a4363006e953290915178804345813c8b7bc305afc255cfac56daf486e105c155a161ecb3d2000fa55361af879fed42479906696a75454f5a1b0adbc5330883732ec8bb7b46009d29d1cdb612fd81e20231df46651d708d1ad4524cb4b602c7a4fc06bb972d549dd5843493bfb0df5f6616ffd9f74ce778e6c9a922703eab8cd6a2d6cebd4452efb7d994c5bef05853587920faae4ebdb5858d244fa8c5b610235cb4393a13405e290bd4856b98719b409e719e247597aa8db338441844267fb1d8051fd1b6a644401f9e4774935547baa2539e1500ae3987ee39f30498dc02fa7475c3192b9b4c601d270358bb7c963e4ff9b9eff8a104753717533752ce91927055b03a4ef95e93dc132176281aa2da4869cff498e66b58bbe48f7ff768409a91cee1c959838871a22895981c55aba91171022427a60","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"fe727b3ec2446f3e9140a7a09442f679"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
