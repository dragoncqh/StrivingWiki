<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"90d7d9af94ee66e94bbfe9fbc4e125ea4f9ce6894b6257ca2c356ab6e9b7b98d623efe37c32d61ad538a1b9c24e4d929c3ae9c3a333163242d08339bb3242ed2831cf9944edc62575ed049501cb1f35887b08225b188df42bbda114760b45c1be15e5c7c4d93a167ca798fa7c4c8b056738e8d015d92238c36084afd189bcb8eac6fa611893cdc07dae99de6c46fc80e59d760c34378ec162bdaa5447bd227eb02f7167e9bfc0757637cf5d6b23b5f6c72bcccefb691a6862bec97f5b86b36c7771f30f2cff7a899332fc6acd9db941f2cbd7eeb349fde58cc418e86934ed848aaf6253482f6a0a39496bd7ebab90d778e4d31ae8eb9800c2c012e8b510bb9a07fa288ded02fc22660474429903edca7030afb84820fd667bd5f57ee46026089c0982dad99b37901292ea14ec4a9b9e1d00c12fee58b4912198e0d377ba420527ecfe511b000bcbb45fa5be9beace8e3fab6b542a05811551d8f5aba562444c784439f50e848a941d6cb6bed10be485097158c61fe6f309cb53b44ab6f022d8d3e12bc2f0bc39ef7e782d178e5fe96bec80c9c0b02c8a25c43c7de7bb750d8eebb3d5f87c35e87ebbcc6d7540c285314955dd6900f35c7f011dd1fca801ba94618fe9d22750a0748d2c5ca28d78ac5aed5ce11aebc0ab5360ecc5d8a28ddcb5c095bacffde8ee668d1259157ee6206e6514eac8788582d2453338de00beedf477ca5147c0b49b4b667f6ee01c7057182211df103f7d2b7bb585d2c65b712f7a42c4ec84d9b7c0fe95fe1307bed339b0dbdd46efa85f4e8fad0fb3b73d05aa751b8d67a9405c574183e0aea68c80f9acacde4699abc7b8c8154d372404462712035c39b861590aefd270e3c478295a2d3bbb1bee8228b1403ccd9f5b67b8e697dccb8e40173d2545897e19c9e0597d2173348fe419af1e189e58edf610aa32f5cf74935b654746d1dad8966f97be610f0c0ab778e2045cd471b2b993d134a77c3c5a2db485b0c738aba68c5b7c2fda47cc68f8967d4e5ef787c5d3a9e0d4ac0938fc01bf63e602efcf3829dff9cd31f32f66c506432d12d6dd394194e11e1e707644cd1ce378089c93713444f170445761308e28dfd8caf5fc81c9cb63daa5f8d282c9fb9217e9df14a3822439c98bb6de09d2fffcddf4188cde02a5399d96e38dae7decb9979b823736e2ada442107dbdf47dc3501a6dd0b313732836501dee6280f073dfa687b70ad6e202cc3781f5e510ea84c078cb2932a9753805211aa866f2205847e76e942e9bd5e0f20e8aa2c14037ba9cc5fe23a9685b2cb612df4633d8694d9e50d05d03362b01b4584f6d91a06d2b9e13b05467c65eb4c5d88c410188ba9fa6137e86599edb2c7a764d544a38c6a71a51512fe538358f41607c27bdd655dbf018a54f260ee046642fb3d18d2c0a68073de4efd23536a8d1c4a9aee170f7dd96c56b3eb7524662de8df4214ab46461816f26e11938fbbd9c2c938e28f06a06d14f9fb083d92361925ddff091f2abbbe0c71431c7142fe979c033ad120953382193598c6e06bf70b5c2deb6a6c88b351b5ac7123dffe55319bde9e75d8b67a2f536f6438bbbabd13884ddd756c8573be48ca4edae9dfb20e730f36170385fe6c3658fb52ac71a535be0ede2c68a722ad3e2ac62d71ceb3e2a40c624d436e8b10bcc2c2557f8cdaab30ae4fb78a3b4e6438283aae6a7a35cd096966557bffb53e800e4110e4aceb0ca6ed19f513b5ff396152d0c3e7011aa74778c493cc400c78d8346579030304488b2583c634b4eeeda97bcfd526e38cc25c3d7471b951b11a989b6575db53d68cae655d40b298df5797d872abd349afccece2ba4217c41126fe05da84f1a8f8ece41310ca883d5e6dc30f74bf530c810bbfc339b32eb440b4bfe36b63ad0f3688ca503eb46ec0241c5f0c413360989b471d3ccd18ecf5a3698a0613c71654fddf0b3751c6c41252b3f6fa5542095a51a58a9c75637a4626168d0516499c6f50ad59a58c2f341438e26d8dbc2471359d314d5f1285b12b336a5c3f272dfcb8f6b97cd80624e541a619fb96e233456e6bbcd6dd83857a18f063314441ed4a2f7fd579dd8084a1bc69ee4de520d0e7b8cd282e1737c41032a43c160a0c54c1374ab7e58954e85e61bb5f5f5abf07b0877eeee9389e6dc6e10c19f67fd09360db443f8ed511f0aead9d6d1eb1226160c824a2327d7cd7739730a71f000e9aba723e1248cddcdf0ca28209243eb09bcc02c3f0e332513d51abdbcd19ad64660eaa1c30f2c032cdf3c0007e0e59aabe38dbd4711c21c04aecd10fdce480241202e0897c194b2cbf8b6004e1820bc13d086b51f2423f48bae774dcd9c2f5427f8d84ad0d3040c7045d5c93181e0f78614418aa0b78880f11c4309d88f6635226867faf317e180e15685d9cbe38007781fa47e54b98601325e2df45d721c004a5bb5a693ae5effc0e21e99b23fed6ed932dd1ec7b35bf992c2cec8f2c50a24c976dba44440f1c9bf09eaaa73496c435feff72314fc4da748074f2411342d7c2b66fb80396ff9e37c99eb228a581e2c5a7d1c069b1e2ef28df92680f845968b1369e99279c9d6c83129cd6415e8d525e636a7d1655e42f28c4ce394ce5cf97255475a8e4f83db7bea4c57bba7de1449c36182d0fb4a8d67a89e17267dbaa8360868413559785da5b31a40a7b8de6831cd411305d9e44388081feaf8b39b4bcc64c05ab62c74b178fdf72f9fd0039780754e816f1fb1a04f60b505bec0f75ace189c5d7bc8c420e43de5e52ef4aa0092c0a1c278d9fd03d48470fc959e694b4ada2d886fa0b7799a5add5548c689235724b5d2c745dd617c4be36fbf47a025e3e1e338df821bfe802bd86344367e92ceb668bb23a79f08eccf03dae38ec1f4ec3551d20edb2c4c268a9bc033051c6f3c588b9c362fc8065017b12163de6b7f015f7917ee83c0f33d7111038bfeee2369cd95637c05c8132e6432fbbbc021e41c41d1222622b3c2c7369ec7fb1b86604d010aee8013e6a06fb882c035d8b8539cf9ffbc0e1c504fb4f777a0cb07a275e5d23bc689a8daa7fd2c8eaad995e28a9d15a77b63969adca865ce414e9afc57685289f560e775ec1d9b75729245c22b549428101a605583e03c833cde7a7e52c625186b958ac4287afae40bb558e7937bd74fd4e2df2a0e14113730a6459b06cddd2a5c26e41577612965c69463bee4c1c6bd8b35f5b0e381da979863759bf20e84d38d4c8d22b1d26f79508da7ee1208eb5939453aec93271ad0f267e22da42c0bb01cf09c467b4d471ac627eba356103a760a81efdcc284de02d95402628e20bc938493e2cf3629b22c4a628c52369bd6a34684aeec3591e9cd0584ebf168f6ee3ac0d6038001b41208af7e62e14e659800f8730099720d3df77a73901b125b9b9cc3ba831610c0b11b231098abcedfaf476a97c368af6707cb9f97d2e1358bfb917c411899ff68f534df1e3e39b3d05732b7cfd34b2a3448f5c270fd13e3d8d2942b5a4a8a29cbb1a8561a9b9ef0166cf37465c3ebfdc9036dba7893db98c5c47fffc491854ab0d0c801fa9d307bb963271d8eede3c22c4e66190da081064dc8c34fd2e720f9d71ec359216785f7a0a7904580e3801f00b1a0ccd6e9e5a80c0a92322efb66e308b3c310b52fae3367b354af2512fc8feb00d9b9e76857a1b328dcbb43a2681c7e15651735c1db2272ce3352adf15a26606b3ecf225d5659f0b33716c57cd808164dd2325261301012c05f3e181a290f20300bb5fdeedb6aa940f3ec4f46c344a3473a9055e91090c01be0945d17f748bd452541d0d510715a40a4fed3203343be727993d702d46e2d898e7dc0264007430d890c0b392dd5ebc3dee94da7d76b496f6587a4cd398cb675c0acd4c4760e4fde27c6c884544aaa44d5cb8185f6a9113216fbe3a68b02276d33d4c3b90fb62c0597936489c7d4d52484b20adfd7e18e7f10fcca23dea7d5d0142940a8c9a7cb2715590285f7a2271bedc3c961e9ad39d44035401cb4212c3f5706c0d96170c71b2cc135de393691e4d258150821aa1874da802b58b212787f4b64280322df6f9f88cc7156c6b53f8e71a9714089104a12f4609e9d1540b0239fc53315c4babea1d48483fbdad8c81a40624ef4ebb81dc1c8721970d9a15f2a1714e4623f7fcea3971814fc8f4d41aa1d5bca1089d7ebb22c27ba867ff5b6e6d9e834072116fb6e4eb641cba4f5084932c7e8c926072e30fc8a3b0546a4086cbbcb83871c417db2fcd32594f877c661303cfa0a853cf47f1a4d4b88fa1df727865c1b991276f25c6fcd20312ff3cc8da99257a3f8eb3913db6accb5f53333e56bc41d2267792739e3ea7ea69c1f06adf90982e076a46b81ec61a3f09276b9037373eaf74187f83c5e09a66a1b1478edaf8983948d2c88dae209828139d4af617b3d96357595de008a41340c38d03d16124da0835505dc8468014bda4a0fdd7fcdcef8891768430d9c6151f1e97aa287a1fea2474cfce6d1c8dbd6b6e34b3e2769df368671c74f88007a4cd7c3207ecce6b5f818d4aac4dcec0dc161dd5b4e61f09278673261a0da50fcef1a8874c85b841ac5c5b67e20f47f9bcd117eaa7af86c5a4b299d95e87dd621c42a46d8b32859a6d2ac7edda027f04304521d928cbc6b0fa5d828111de6f6df043a3c91b8fb5bf766209c3dc7bff36ff9f295612511c2545580da22378b6cff644da66ee3c29a310705783c12c1da2fa0a8271d02b15c5d0d446d3dfdfd8d71669f78e2421bc2e59aa4664b681370b750e9ae050a0c2d8847a65c698933bc9442d78b80cea4a372abccd177b4c3769413daef4816fbbd2699a4864e7d01e5771be1a9d822c4c283eba6d830d5ba70b444602b3944c021996a64c0c18bb94e75b94ecf190582d5745df3947a5c1922bda3e4e775070bde7d02c72d3bfd56e6a650adddecde804669d1be067f2f2736f7611dbef5400e8f018cccb7b6a808b01abf333040a34175401101807cd89a2d75f9e5d39e0e72ebc43b932b1d27488aec1e856e0f367ae72d3376e6418ee4a1c68011e5ed24ef531c0e331a34465a353196e0de39cfc3c610fe6fd54811529fee6ae6c7b745cd77becc20753723afce15e84b52efae2e4450d4b9959f982bea3f345d86fa3867c5838e8e53568dbecae87e45faf8f2b0cada80e44431f33ec18d371752076dbc041b32e3ef2ef942736ea98ee2d758f875dae3b07be65dc978ac809cc825c8ee9358217c529b29334f1721018a562dc78492c513df7849d32a7a45be6d1b6784dc9e20af1b6a7d09d3d8c2a945457b5750901847b0dff5d5abc54f28187f68d0fce3b513959a38220d6c45289e549186391ba9fb23841f8a71683f32acc2a7e9ae251d3ed914d23f546431addc111b37a8c3ec4d0bfd5520e397073f2be99cf30f191bbdaa782c1588ade9e091aed892e42bff0588c6c16a47c3e7fcb17e14a8dbbb76a2a7464600efa88d40c35417dcffa5fffbeb693f50bb0fb026c54e0278f4c5802d96e6d7529e915475d9be0d9c6062dd100b0cece81acea858edfdb85103914187e5496554b4813ebdfe46f7a370c8e67e4fdb68216b6b37a6a5ccacdcf22846200434c99ef30416d0f560cd9c058fa068aa395dfbb653dfefeacace195ecc70a2078112143dc8147360c3cc4515fe6eba94621a0c64f91fb042f9599340fa3950b4b5f1fbe8dcd00a7d468213d837d561705acdbab14bdbffd05d337fb8f8bb6a183ea3d81be670d603fc55e15c7d3f22049a0d2f8ce59eab5514450347a0c321a8056ae01d6cdf6d52d6ee40e4d9294b43c8bbf2f2e26d8b23519c75164ad78182d5dfed221cb1fead3334b9a8b768cc0e9b9caf347acf4281cb29c2edf19c401c310a8b6757865b376373bbba7426c492545fd5706088db6478b7f3afa827b59a279057023be5e0ef42fd1e54f63657dc0b99c917f1c3cce2fb07721614d2cd4220ea867126d9c4293749d38d55206dca8e7b73c0f5f748461a9e55a1b8e7dea772d19224e753b19aa28f69a83c9bb0e7a929e7e8b8d856d902e75e210992f933cfee815335eaf2811ad661762e28d51466f84380faf775c4766c29f601754dff306990ba2b7bc6677452500994fa14aaf1ee03bd6747da4c38c529d22af4376b31673242109b88e74d7e3fc47a7bca7ab617f54e8886fa8779136405482ca942468d9bb22a1bc2de1032a1db728d57ad724d594f031a65f2ecf88db6a761aa8cf55071621dfcd825165523a74794aa3bf6189ea374623dd05d019470acb58a41d72ca161b48d565bf5d68fda822fc5505e342064610189a5d2325c0ef5d52c26ebbcf0d56f62ec98268b0c0d9e4e4e5298683678288f1e1342fd6467627dacc778dfa3fb45d3f83f1b12afec72b86c027471d76626273421e412847448ba790170f26bb3f016e9ca12be049df4c7347e8ccbdecc3877d1b1a2c829311df25e0f2d484d59d772a01becfabdb9c8710a97412e5b7935ed0fb1d7ece38ed36e0379237dd839c93fbd01a454d4bb6591cc931a88cfd053097c46a2f96e600a3b1b61f87d59cb395a151d4fcb9c5217cf3ab47445d109a996ca81dfedc00fc07271622c6e7027dfe053171b2fe5a691f6c627017b86a8d935d78ef3eb9085a81d68a521adbac68c232f7f25414131ed56762dc2ef9cd0dacfef124e7d91bc58bd851d173808ee86b708892d8adfe78686837a083600796642c1a0c7a92352bdd13e086a298b12581efd267b1c555b5fdf980d639d26cabdee1decd3d462627dd25bb0d95872dea4b21bdaca3b5ac57d7f3ec70b95068c790795a9799fb9c80ece846be6ea7abe3f277d8c83e7b5febff01a0addfe5498cd1702488415c59220e7da39916d94966b805c114d80e8755748b1766b8b621c5b4c08794d5177948b38c982fa9dbb730b20a1af83a269b0f8993e739ff4f1c82b0f3eacf32192696f61c63cd761b5228926b456e9187db4e4843e7a3ffb73bc7ed1ef42752e362e8d7ad85362a4147860428b494e90fe3dc5a6f69e1b3cd91e0f06f181c92949b67936dd022a0881c0590be4e7cce1a3291c626f983b0e6af79e4a10e151ebebd0c4314108cf3228b4bac2190ec22f632668783470081a87152376f48227d6448299cef1ca22ff897f02be82376fad7f906264629ec9f91e5f56202f2457b63fce54a1251062acaec92225870b43857e9e7957e5e2d731fcf8d0d50525e3e13ec64d8a99f304f98ed93e1695e76127c1ca75ea670cb84968888d7b6153c0782fdf8a99ce28078ae711997b521278b4d950feb2225611cef1f95d05465a5d936802c43e1bcb6d702bfff3ef9e9c6994155dedd4a4115fb630f15200278575fca01ca1af1f5b3868d545395420558b8cbd12365ad23bad5e06a4fde11c2bf0feef34a642ab3e400da71f9fcfb6e167f84a033fae3ffd2776a872ed8bd415fcd6e23ef6b443d7a3b1b95fd9dcd05d71e2162a6474f36a34b28e2c93d6bb20f39dab04336e1dc427523ba3befdf7baaed71f63a172474659bb370af44ca370273325c7c2258d86d59b9746e05038929b867ba10660af7b4b2ef079ac6822a052600ba8902ec66dec73410cb00e2b386088ca821b2aa06861505884f956370b179face5d9faab19b23b6507232b573ea73ca8fd93e6e12ce98e429ad79797b0c1c1447860346e2559e6fb3e23d976709c9eae13589d6b1bb55876e6d904e899944f5abc490fa59ce62d4e6fb5a08f393db88eab5ae1371931c581032ce3a6b09c79e804dcc29932c2cbb2d4b6a745f8390f43f3c7cf05a226e15bb7a93f48e7bc8b1d660e36240db50cac307ca607e4ba6a0573196e41de8c04f1cc4737cc926ac2f2a749d49af594c7aa8c9ecca6b7e928429c91474a6fb83e6c2c52060c9e1f77bc8a47881bfb27768da5be98abcd077f68aca5bd27b041d186e8499534c8f75c6fefb64eeabed2fbd14bb968033fe0dd0fc8cd06bb1e07a32d326a14100a659a0dbcefa255ba7564bd2098b985c278cd854141b57c2d1730ae0020c305fc939374a739b95237d316fd3c8f01f12f98022f9868fbd1f0863ab481283a4daef42fa6ebb06a2f107704a9d200c4fbc2378b0834f7e879e90951e65077e4464b00ead72ac8c465695e003027db5bbfab67cf3915630465d4d881a7bd59013a248990573ed20f96216594cd79adf3199e5f118918573c9eeaad448a266251619cb3b2ea6eaecd890de5d03cb785d574c6d4e9721d7967b717789f668e3f2a425bc1701ac84e344835cebebb8b37be58b2a93671573f6337a181cb9d5be8eba51099159e47287b7194300165292e787f4a9efbc13356f9e8f3fbb108b49f4fcc9d67c5768227a22d7c914bfafbd57bc5dfd59ec4eddc7ef21fcce2ac422b7399f06e8934158f62256e6ba50ecfadb266035b30ea117d4845c86af2175d6f66d2efb102ab785dc22522ffa0d82a342fc2b2560c450472e91a37927d1de195e12d234763752ac8c80e0e3e38611216ca40f50396cf8102b6d0544d0de22451531fe0b356a50ed679ddfb5e1dfcd2940673660e6551a6072aef7d38103bcecc3847840aa826c2f5251b952a18743929fd67b01ea4b041cc09dc59a941bdeca194b529dc8c1cf7d875f6155f0dcebea55533353068335d954f7ddb77cf1b2f0124bc2ad2c2210938393e7f0b7fe743ed0d8357aac1de95ea407939782eb007bcc239ccc3c2f53f2c16c8ad892fb4daf732c525562f77bf66a0f5aba8e8d32d793e0a8e0281653b8848bf4e5364d62e7e14a962591a7e39b5a395c7a0380f787d30cad77366ad6fd305120df4a7782e8c356c9c27c569721f8be032141a7dd69017c010b070cabad99fa4a8e2ee1a4c37434a99d41db0c66cefb30173d55c3da3a4b6322e26d299939194a98c5a11bf74433e328e18e784f24869e80acd5534aa5f7e1207666511568acada72e0e2810a47b303d4b136e6cf88225422b4bfe95fb699747d484ca39053b1098e509ec9450afce0d628988fd168cb5767afb56d0f68102f44c10b8b296e6763b7bd0d2a393f36de1f1d3ec5f86830c5e1d7aae6a29e1bf4bb0d226427199b4b618d4f1adce68274f2b546d62134e04d3b6ccc2de857e79f654200d03d13bf700a3903c7429d8ec49b684d27b179e0719a4a8ab1a322781adb1cbf18cb7bd78d60904c1e535c299ab3ef2ee1247f9ff458f05e97e2b1ab666c6567fcb8246de616c314ca54716ee2740207883ec0fa8f315c1d09a11d50560d6ea624a18525bc3798b2bd8d48cc304c34e4894a44519ab94237b7c0df5eb0ff9fa86a01a13f1277fbab6dd78aed29dd49fdbd55c36c65435da6f6063d10a750b444654077ea5c54c472430824bd946a6fd4a33c44297a460db36983bf414927b0d668641f337cc46f8f260ea4592d1f3f81cbcc7f8487ea7a5b7398c17e4d57fe84f5456f4e053533f16655b107c7fff58448adc87289eb6ead92a724995007b8c343d5539aacd7d1ab5c810890bb499533d0772869dc151d834814073d6ee3db7ea202adfdb592f2ef147edece3c719d0052543c24b0c4f754c6598e6ec18d633d6e9e70801b5d3340972e6e9d42a4521624cd2ac718d8370b4a3e19cd96e5fea09a1ff585048aee4d574803d808e28a88b9db88ecb98e39530be0060ff4821ecbceb69f851a7aef5923e5c8180a9bd1cf56b85e50e1f64d5f965356b4dfe4133d6efac81a8fc212bb791cca4bb1cfbe715cc691895a33938c5090649def878365a77fa34c18bb8e167ca2fa1a5a58b2ab480e1b5bc0eee6d42ccf640252e6ea27c9cb69aece4c1c5fe8b195895f504cf84b11b1b92e9cabb490146b8a48c1c94de9998a873b29cf611eb41fca4b2afbb16db3a20433d30a4d2023252c41b429c39ba9c1ef2db72c365b3ae05cc4aa18a4b6faa98ee2c10af581d35cda9efab1b5c9497cfca59d3bde6b678c6cb898defdca4dcc72f7975e6de539f43a2dbdbdb935052f9afad88ad5f7df5e5e027f998fcd4f7f1129fc190ffe0c9dee1878b7629a45bb6820e3dd772b58c95cd952fd16ffa60af55499a5d5f5d9ced3504b91f5bcef5fe88ba4fbcaad48d1fa9a3da4054a33e9e42efa561b129b353446954cc0a41137d563068cc8c95b8f5773429f83080fbe9b1036acbd9d9483084ec1b98f52f67e28abdb7a691eb82afe9b0e48869071c6e3f35120e52f362555e66f4adf6263b3b02b8bd29e651b6df10bf424b875fe593d98f5e67106a53ba908a6bf762cf290403f504fd4905748bb60c097737b29e5713a80d311652f1afa86970b3e387af2d4c4b1f6f85ec61ce618e40213ba61a4fddc5c32961897d8d8624991a90489d2bdb9fd27b29ff1d1d6f3c3a2afe90f1b896cc77d4af566f3feb78920597081329cdade464774b358f15f946321df7da6e96205e8b15911edc5e647cbdd8af9189f1247f5fdd8d5bfa8761ed5be218c422bb508320e0039465b8c5f4342ce9d8d03482505ed4458a6610e1a328fbd58edd89dfda1e0362f514c2ae98fc583a62bfbde36c3b60f924aedc5be5e535ffaff592e98293bdbaf64a3c5b1db268592b824b82d4455c61eab2285a07ca98425ddf99dbe98b91e2968d94f8e1d4563bd5f32d445daa4b61decaebf822a07408e86ec61b273e22f009ef214fb867ea79677dc8c91f7fad1f43e63dcb9af001b1319e8ff64396fda094e5164d69524dcd7379667036da14cd07cbe0ea1e8705bbb2fede202a0d5a199e2c225ebfa12adccb1479371926c79ec70e80f664b963a5e18f950833a55828bff684fbbfc1fd94326df1aaa0895a3247b10da49b2170464a3834ba3803d2834a1f49e50a3a3fe0373141f9396fdb39e4daa60e5ed8c5c90782e7efc6fc682fbc790d06b7e8e3f1c82e7cf6cbc8ee9b5ae19fb643b75b5db30b136e3185b35f9e96d14e43b20f09a9c56a71b8f3b6fe2e1f473103ae0cf087ea1a70facde9b65d42c03ff8f5b8e6301b6f15fc69f9f57db1ab72476f2b278222e901866ec34ec703ce091845130a63489fcf94a4d44d162f9d9535cf40bfb56c7a4809ff18553bb3be4f81daa53eee1bcd16668ce666c7ed2fdb6dd4473d4e5881921873b9a2b11bca82f87fb135119d1cc04fe3b2bb9e86ceab8d52470f75d21b518d0ce3743e1f6e17253b8545dcb2142fc1b4625545f1d2a89d8633d0c11a86073e8a0da52ef36bb256ac74bc9e1d895f4b46f7d691f4a115cd304340048a8ab0d5400af04bbf0e280780fd1344290df22d20526b825c626d2c669cdaf728e0bb585b92f2f88b1c910ce848c24ff35b628b78609d474539349c158b29d686b4dccf6fd011346c34ffd9635050cde5c6697d3cfdeb054ab7d2fee77065e7f0874f9dc3a84a346e07c364aedb35cbf6fcc0efac5cb33a2b5327b96481bc6bb6c0cb61300b1ebf7fc7b0b1cbf2e7bf000366e55c617a31ac107ee4d3fddd969333599679c241ab5fdb5c47ba087ba324d2afce33f646ba603d7df8d0568181f20985474e415a3a69c827dd49186a87c93039d3fd055834927c0e2243bc96e00d2272f5b2b7ff509246683a4461acf72fd92c86db98ea5142c11964302db87cf01e1acff52a1450be2c323b55d04d276b48645c999bb0aed114210f840ec5e6d20151ef6eb43f345421118544609f643fb8e2649ff6ea6a7bc8deaaa92433514221fe29e4e43f5be2eb5afb9a8d54d7e2f7f66bfa553c6d8c472cd1bd6ffdb90292f367b00b88816dadfcea4c61f51ae6d80f7d32330ac33378f3c134e8ddeea1e4bc7dcf6267bc0cdf2dbf26a6e669e8b60a25fab9e8b49cc8b6419e384c5c1851211f5378eb42bf130501a6606f14a801dda047fd74a3ebf9ce04f460079622fc5d57e9f22a71c7908719303cd3a7a3ae76f24d67b8552d934d9d964a0cacb5782495d28d3adcc351d48a1718bf81b4f64b09b9d697a402bc64f05b117fa9243661cd2319e3f559133e2c769e041f2979bc68407bd6aa9e64828c1d4a8d58ab0bf1701035a09984cc6ac19030598d3a5e92e08e76c55dd072449a12f7dbf3b741d37457aed161778249690060ff7d6b4f822a79f83034c07a4365e697f76813c51e7ac8eff624742ee50212a14a0730efb624606a99de9eaf76d1be359e30fadc48257b8f9443df5074f41e3362048d5b6a1eb22f2322262775fde8181dcb2c2cdd66a8eac52ffa103339904f77210d15cf023b984fb69f63895b7af444e2868bbcf30a2d349947b49ac85d735f8027886ca882091dde6ba4ff83a01c5ec36a4d059b3aac5ce6bad1bed8f01cd382c73f4db2a9fd7350e4a2f6c8e1bb5f3f1f5f778520d6a50d2b3b27fa8bc59e75e2807d446b0279ba8e6a629c12b59745ff3e19b68524f7d9f89c9cd763f8d4a77216519f15964b7d886466b7d7071e6f1b6c080bdb757e3e812f58df58228f8760819c4281b4c2d856b7f53153bf25b38f2afb551671f1e972bdf0c765650b24303be42874fcb10d425536059aa7d9701ea2d162b51e92e379903048b3c7309cc9e8832de56bb0be452487cb7f4b9b9de0d9bbed2b306836f92721f93faec26b39adbf85600d7534f58acf349ac6740db58cae1196f21f029e1d77a169b7019972df0a1e5614ffc4fb2429ab8eebb18decce0ea21b207062ea3f7dc17888949b468b639e02c9df8847f60575adfa80f0dd92677ea306cb13caf0017fda5810e466fd130a03268041dd7e193dffb021c3f4820c75caa97716945cf0121990d1353a416d69195e13a776ff00c0cfc32eae29f0efda1990604094cee1604cb36f41e18abea748c2cf7716a4e5ee1fb9cec5a4d3f85bf919c3246f17e34058e1deca53ff9cfc55a9b329defbac9d26a0147d85955492068c2af653adc04629687dbf6b28bef0665b6ccfbd1b0414848010d874af35f41a44692af0417fdd9b739a6d38033e23b5d1cc4a29753d0fc1be938748710da531f95377d65e66285be2f0d1ed8040c6c6eb4cf9e5ed6d75263daf1efe64b58fa81e462c1d544f60034b81055610543bda4c05dec8962428bfb860149cfb8814951879f2ace21a56303c90ce6c1559a2f4eb1765090c1574a731423233946fc0b75be61897a989149c905d33ec70a9d06f18466badd1067f198a8f012792e0fa76f3f5ed6f284e787fee32dcc9f9753cffe3efbf4dead2d9b30ccb2593acac0a8d71f060a0da081dbe21b95782f92e26a0e252f91ea7f0dcd659edfc5cd147a510759876115a7859efd8527654bfba264299207380bed8aa13ada27c0d7fbe0f0d49153e52d701973eebc50a661efaac6963c34f5ac119cee77b5c03dc186f8a8f0eb5fd715ccea6d7c77d6689ee8cfef1c9bf6908be8791c858221a3440dc09fd700702a50c24f151135b06bd25e18990ebaba843bb4f872e327dc9d131d2419e0463b1c897e6ab1a4c8e5ff323256947f6b155846f93dd43a3936ddb81d0908dcc7276ca05a2c4399e68bd8d54c50411763ee9cfd39d2e0231457dcf7817e7a3864a7fb2a58402fd5e5a2bb6f1f6b8680ae79414b1e432f71398d405b65ccc96e41e1b872f0738ae4a4d1121931e9f7910edb9de62487c43c16bc1e356bb401d83ecec091c3234ee5510524c793a8d8fbecc870e83432d1c85b3755bc47a45b011fc9c96c361fa049b68fbaa716ee0189fb499d37907c82040395236e06566d1a919d1811c32f78e6eafe589ceba88c82b95fc5aad52c46c3c9d3496149decb0764ec71fb183107e0b0dda0877546cc988e777d07bc3e92c7e90fdc6da1e16c6d26058da773a975db7f2520170641f707469779f3c2a8cc25259da67a5f4a695cb11ffc38aeba868851da7a66726e033e60ca4e5c073c8ad51a15c1a7b1dccb0fd6e011c549acd0a8a40b682d306df699e6c888a0d52da9f93bccc005c99397f6b0567309e0137f92c7cee3d385d3471b18155b5a49d6b594a6fc9ed5f82df16b058c200f22077ca04fdb3a285e804b075f90b7b10c09602577bc921ead883c888c9902ed71b0ecf16276a67d95bbd14c02f19fccdbb3cbe3c4b39083bcf4d6507720cac3337c8da6497c8a2b0a2151208fcd8f5cc3da516cdd550237e063f956832ba2a727f2ffae2a51ecf8c72f8d67070084577550b2aecf09f1fb6f6e73bf52285fb697006f9775f2fa080b80505a42700a69455b0c047f37fb94ba1d3e63a83a79d9e0df9b97406db99124b75cf876a20f6d16874c396641fcae074490d3da4f70a8d050e2673e304504c3a48744e1d835f9ac4275ec5515b50586e15b4b23dfb32ac498119bf72237a5427ebed6cdc093eec2c4fe4dbde96cb5df6a6a3d541e84e6b1badd7efbab317aae6638509a68b35e9644e18dc4ec385094a132c71780fd3c437b1bcc1f18c4a901630ba48426af094c09ce7ef9798edf52490bc5a56ea2cb2f27a76d907d38683001ef3d55bb0454e7508bf58ba5bff78907ac93966f95bd83157b558a01330e71d47df39bdf30f998ca638d09c75c4632f7f4b2190b315eb127855780aed2fb98bb53a88665d383e92e513efe4951fdbcfa31200ea35ca07404a70ff8e0769a3acfce6c8bb3f294707f7cf2d34ce438dc2f3bd642d6e095ed69d4d2630b992b5a1db54093c63dd740b84121238ae7264e7ad0d3160f359285c2f770df449fd6c70e3696dbededccb5b81e40e9f01d4963b5f20775fc8d56f22d342eb9618c5fbef6ef93af3467f846ba9aadfbbe803914acb602b8ef5abd93742f094c882e7cc72af4ac09ff96daacc1feb8e362b627419d853270738f71ebf515a82ef5c4b28c2ee9191990d5b0531e54a90c60aa6c68a56038cad5b07b6f0483c9e64aaafe3791ea79d215a6c8eebbd7a4d30b20d9d0ea9dff7326d9e0661245b606e8c5237666db4e27e054cee589f3c784b6e41b74376985ad8bc89c36a005138334490c4835adf4da1fbbe989770ba42731976908b902ac566cd0ddf2a7e5af80c2e2c29031571bf3f3995246bb38748da06ceb9f25e387b4251e0c4d1c72ba1f5886a36eed08c7541b2090b22fade84fe710c5e3d6d1f6dba0ed4c81f351ce99322e06f9f743862c4a5d342ea6405b9e8b03e3901c1b9cbc8ddc76846feb42027b53667d738ccfee94c3d810fe2a43d14eebc4baa8e845f165515340f9c1b0bf0e8994e66a6d138b80c40387c39b9c4b34147a453112157d6001a3f0a3986b848dfcc1cd1401e3a6e6998469499c7510cfb8ab390fcde62aa81fb7ca013b797138284ce826df649c399970c8199a1b18ecd3ac55f5745637ae480ed12d2d09fe65ee6d6c07f67c4b24538ad2605adbda5f8b318421e832c4d63b834b603c321fadd6c231322e1ccb7292870939f8aa3283ed2e9d8f46afaf52d05c38cc13ec1f62fbd081fb30185e00d04e7a64c4d778f793f8e774786951d34041572b3d530e3c3a3c94432639f7ec6e92b7c086354c4c82ff9e41236d22ef24196e85e274dcd1e13e9bc192f0b1d8ce81f9d7b24dabfcced0bac5b0941b5c45af8bb47343c6328bf3f4045a3625558dac4cd01887738ce6c3751fa7b7749aa397e36c8904a39ca1e4be52d6498d86d0d3727d9019f2c5f8bdb4adf0d91a97c5c4bec0e6850c67730288e38b556744a9b16d551a4dad840ce3ca744007494284e7655dab2491603e7862ab71ec8b739680da55233548a117091e8eec30d4ec032557d2ca87fd6468228e8c800eb6b976f772eb6794a31d77da20d947dfe4541799f500a002c3aba79d02c2ab1819228d989cc6d18af81e7e0267fb02cd3ea16f918bf2b36733d7a821b3ddeee23da5108f87dca7b87d79324b1e60160a207f1c8faad2154367b2f98a982610156300ea16cdb85e4e3fe406288bcf068c3fdc00733e84f5d8bdd11bf7047c6bce2d7fb6651eeb0351a2a0990e1da8d98289767deec3ff44d74132eee956328a4baf557049fd3913d131fe53d803665320ff63f2b51d85ccd954bf857617c551c5ae1988bcc9d56c7b48409e306265b4ef0114f66a5c64478d1b53d74526f4cadb02d29635acdfe8d1d3ce4cd83b9f0e7cc30abf82eb1f4fdbafb88ff3edb7c5e5040062e6a83c889cee6d7ace03edcf93cfc2c14a34948978086cb7e0fbf491110afdbb82e9cd47f31f092f226399b215481dd9599c6807d049a15d696e0501e6fd6718d119490143db04f1f49ecafbe28af0415285c568e9ee7ed6b493800fd9293158cfca4c1a2382c6fcede9a31e4e7b7b96bfc9c74bb33576bd0f676b72e61d9a8a22efac428dc9f4c540f4ef041db51e69aa49894d044dc62cbfa4bd0926da4cdcc4f945e131dcd408f3b4f068d13d7d9cd36ef32a0b56db58a23e964ce6f427edbeebb118c0665cf68edab80d3012b39816281dba134759d547f3c24b009fdd57e6f0465c394d7dc07b34a0f78c678a6d0b301cf45a233bfc586d5ca638d91f7833813d9f66d215e63c90348057686b22092bfb47bc332b90eae91ba4b5b5b1083401a58611b3fd2f6e3e2f2cfdde281662464455ef5bf3f9cfd2cf114ec3aaee8944f6a6665a5a5d8375d4e3443a3bfff9939d82e69d10338c65484b2c8f3fdf11f83cf385f94fcb777ce2e4c95b6e34e0a2c7803e37ece1387fa59a6a785d71bfe2879c868c950fead2543d5034b9ebcc95059983b9288b15f83861a329990577ce38a9c96194ac9023d13c353","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"e51cb6d05ed027db058edc159e71b81e"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
