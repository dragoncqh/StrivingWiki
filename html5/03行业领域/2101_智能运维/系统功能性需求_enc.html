<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"b1fe315bf3d0210269d52b84c852581c83a4ff6bddb7e37717b129e535e2bc020c31482a54d07ced0ee467cfeffe3b92691a52ba8a5c9c5f4f7cb14231b2959c1e4061b62245432b17ceb1a1e82319517edc28a50025ab945cd423797c77eb980fe357e966cf63816f8a8600066f8a99181881e6ef22fb5406f7fccbc5be5c1df4068f17cd3d8ebb65b83412cde7ebb06f1287a87f138f5546432e35fb63c753b81a7a491ff8beeb5653d5d889fc53d09ea8d2b9a28fba2135436f1fae589b5350de7289e1ccd7bb42bab3590151cede015b39ddf4c77fd578c768c14f9914ee5fa7c461c4e6abd511b2a1cf8e070effcefa510213aab5d3c80049ccf44a0866f95d2d8d63ff5310ef4361cfaa62131a1b0bce69d46a50f4f90d532f8b1b69d41c7a37b02a51b20d30c67f4892a781fcff4c53428419c08a3a96f8857547d84b8f0ffd15826cfed191bea7b57f5e08b9d7784e979af15b94ca76cb0c9089c033bbea3ae54c43b569c2d1b9488c86bdb2fe97cece1ba02c4af9f268b72d2e1233757c18a2d3a295d258ffa514dc047af217b9069d022218f61d9b8c58bf333b572b7102d933a6bbf6836ab52e783c41312ee378c1cc795e3c615ebe41ed4e428680319dced1f013158252585546246aa840cfff176478369357ff4b7465e6b17c7ef08f0a9a8801efafb189b65d30948f9a28842f40d54193942fee5313f670af3b5634aedb9c2658e9ca75db3f804331cefb1695163f7130c99cc8781ed20f1221b08ec3f5b39dd6aab9dd464dc991369f936c8ab02bcf8ca882d6697daf9d3f3891d5f27a5040853195cd8401f7102b10810122a4e39f6f83414943da83fe9a8b07065186689d0fd2488ea2813564de089ad42a122cbc3c848fdb71bb1b749ec54a6e00d0e4dae53268fdb51b638dcff2fed20cd460e82bb3549662800daf741c574621afa5045dd0326f6a1eba7cb5be2b42e13dc4d19fbca2fc484efacb4709bcc48bb062775b1038649e10ad00535026f74c026795e1fac29537885d6a7a47146a87bbea6002e68bd7119a94b564c1bb2de8ad4d06cf048286fa1b236e05f0276d711c9de51d71c7aa8f0677df1108b2c7606cffb7bc89b4948433b9b4f5b7d7c22d0d58248893592cac63aed69db8f1e28622e427ae0f58d6c58dd72b2e454a281eb0d30592088d4beaa8ef6efbc39daa51ac6d9c3f6dcc591076a28b618f9627156409b70bcdc2c9ec5dd1719203733ab4b50adeb7c7dadc363e784540483ace46e21e28223abbd5d82fed2bc457577a7e184adcbcc6eab453c503cdb06ebd25459bdbcab38499087e0511d674cd9df430868a95d20fd8e38f118d234a708b7b39ffe5ae5e80e6a2629c1ab3c4ce49a49d2852717dcfc55d9e1efacab02f22f8f1822b6d82b46b455b318d552d75ba69c50e35604376241c900f4feb61400bd72f0c084b9c7e8bb0830133abc877a4a63adbb49240807516ab6979c877a8b2c66ffd671c264ba442b7035c34e5c27beeeeb76326db6c295fd2b7add021a287ea27a265c01ad5079902718afd356cf76c816bf0fe64fe4b42b4fdd7bf044bd0f07e10d4daf7851de2870199eef10b53cbd7737942ff792a81535618b186303894d48e13a91130a30a43ce77e5515f7f4438e173dde45de587f34d4bf7218d89edef2036e3e3bde2e662dce2960f0615534b41117464c4d6c48dca59f814451c4d4d9032428610ebc808a8d447b50308e01c12a4008aa570ec1ac6c5bac8e064a7e4715c26f69c020197c4ebef6faa8a11f0536bd1d6220f341348f02f8a93ffd714bf5706db51c5f6ce02ab7337ff00bdac120ade58e998408f00208334efc9bb7cbfeb2d624ef997441819fd15a4a58fd5877c3ead89e803cead43ab1b9353191a0afa6ed7cf7e5ea98ac116b346085f2e0c77f40a649cdf430fdb94e1a0654e3a09fbd22b93a38e9a6e8128048dbc966b23003184ba344606f976c68b52d625d94940eb13a1cb808f081aee182357f0ed262e02ec7b01f33fa28120af5a8167f0052caf1ed66f9a267566227c511122330b331b9e1b5fbde2243af5758027a8cb882387c5d0cbbcfec681ec9177e8f95454710b96d5c315c1c94d867aba49e1d570b0ccb7e9e18d8b874cbdd3e7ddf5101b620eb3948d50915692427cecbf4e83c6868b2082f30b2bbcf3c0aff2a44e9061421fbc42d3b0de01a7b76628c4d50860804e0a9f05adcb76f9f591e6e107e662625d11aaa954360ec5ea098be2847052a92eab0989532dc9105597ce81485913675f8806bc0c1a9dfb97e9b9afb5885f790d6574a7e9a93ef2607f4bea47e9f8e227ceb931c197c65182fc53b87c66cf53e74f0da4bb0409c9142380181c0cd658e44d4f536446d8c96e7ceb3b60c4b46e27bf481fb17c78be2f86b2dcb779205635852af7f12b5218f527d1092f888bf06f61cc096d221fc666f1ec3fcd88ce67212f8881debc16150e98eed2908f215b23ce2c1e0556c73d6d14ae53a02cbdf956e5cddc540ceb8531ee970471230e3effd8723e3fa0d6ad17dd3f4da13aa028495dd2e78affce7e2a02fd09f14a66fb9a85d3e0008db3038e81f45064bf786879a1c17cc6f715f7aa7164a98c5dba6b469981dc7fbc25b9baf73063ddef42d4b56be509508924b23cb39e6e3b4a4fb279fff5ecfca0066995bc17e88ad24580f746f965416f345b9c50cfdde55ce2eb54cefdc6f531b277a3c3520bbb36dab46895ac3a219945bb85305ef8bb032b95eb43b2f66c2341f8f7ad3826465e93cb726df0c80647809f2ce011bb667252d1214a286b903248e70be77d367ac352eb7628850ff85283618acfa116f450f88dda2f862df80994f3dffd60dd4d9ca209a413f7a98cfe2f5000aff1104b067d38b7c8f9889a01483e469280b1aee6b96567c4282cc2955de4a26be4a993af1c8436e801debbf998e682221d31d3be07a5e927ac5ae0dc6b546e1e09b7e318175659b775f144fa623d0233fb588edf98314ea4659f14a537cd5e0ff99c38a7c2049eb80d5544a6c8411e053624e34a2039ca04d56cef9f4868cdc17e1fc2d7d4e9e0131869cf30e3bb4a967576d6dac31ae0b1ee10b91cea1e692b237e679efa9919ba9d6a16975232998d4bc6a96443a141c5d43c8ac0b2c9787f7dc8359daf74389f8dea8fbdab4da1dc8cadbf161775d982c6b92db30623334f725a18fad6feb3b590cfdbeb079e9443e2cf7f2cc6342ccac0633eff9d7a287b98706f511b99364df1bc6fd78cc1628945c8eb65de84fe1d1ee94c41f784535108a584b979699e1bd92bb01ff4a1f02de7f28366b491e30bb79896c7f202ab2212dbe3deb067a49470d0e579c4475692d0d6d70e493ba26267719c6f3915156070e26cb03bc18fc84489ab5c0c9f8bfd2a6c8c42637a29512980e59592a1e4f42b8a8fcd4e5f614371838048c7fed870a9e6e5d633b2ef6b34cecef600a536b8b9c2f608506fea9aa488881d449f411313306e7bbdf6aa41190a4d37fb14e06ac6c559c46903ce5111d1bcb74c5f47b25649c041acec344821c47d2587ad6c3a76e926d5fc6c464fe1facfb8a883477931af59517bbc25c524a5e3dba1e0bc929f5dcd4f720d8b9733f69070c78a6bc5d7dc30df3cdccde93654ea636b427941957908e0af35cd22df7ef19e9e13e04dd36531a19d4446759c22e03ca87d03e801c481b2c49b13b11b4b2b66d4e7a19b15c6c0320bbc0f4827185954aef57d142d4a68d1aa121ae2fb357b44d836e28b54470717b240f38d4fd26961b2b301802b3d0cd8e83ec9f6f3f161a17667979f59989441385ba2a578ce84ac8e1edf39e1a95bf6b7f308fe4c0c0ab0bdbd03ff1ce7619f4e95f64d043877ffd903757208585fcf42dcc8aec417c399ba57ab24d692273693b0d41e89defd7e380979f716bc1f47efcf8ef81409f81c8c713cf9b9aaee88d7e7cd6883ea6f36b0fac97e9276600ef71430ef9e354ec2631f0382cf9aefa8bfc0cb34bb351a93c07947a3a1362c02b6859d21e71057e1ec9d9d2d280143f07af0a65ef8e59f41457d02535346ff6418d9591f6a8641310639e672f7f9398d71a23fc83607c971be4123307004aec274f22bf22a33069a266a07db3b981f56590a311d88e6bf12e088f1e2fcd242db91a48c6adc0b78ef20a9e510891185ec3e0f42a35f1ce57593ef02b2ac5a21cbe2a4eba13faeb18ac580922193f2f7990ec4cb5a2001f84bbc761f2d223d2c6f2a9b2681d3e83c9155490efbb5e0f3d0b35dc1e47e9dbe7d26ef0ecf573cf5a64f70ddf26e1c8f43c4078f27657bb2f5aee5f7f7d893aa345400357f1012bc943981a2695ce416b27e1a71fb860804d0c77c830f86d6eeda5f012703e87470fe4036e19b8cdcde43e1b133246c04ff2a0042bfc46dbb5950e5d34d096f82085bb9e7605c2fa97c803e7439504a046ca9c250e030c195bc6474a826755c511c7e2502278ea5201cb7209e61c6253aad3b15579a1976f8c68f7334672fd4608e3eb6d4ebed6119d31672d5291259fb10406ce04ca63def6814efbe873640e35e4dafe55cad454a41e59134a7c6c58c2ffe1494ab3daf22b85d96da6bba382022363f2aa384f69c5cf9015252191942cab64c323cd9a20e2e6e1b70b9a218975a03216b9e9f25e70d9a5ea02306f733e5e7fa09d59c084bbc48eded7d17e0ccb61504c97cc4cf118c5900fe17aa94eb8327cefa95355f5c8ed75f590e64612950dab91195ae370d182576d2985783d9cf394562767bdc9d2cece2e45276e9f04c63565d10ef886f8d016172cb769c4000a8e7f3232be8791636ee19cbd4d1ae8e43b72f274788b55e34c4c138da5fafbdc7dfdd1f7644cf9d46edf3e6e0e4851e7cd5b1df48c5e9fe234324d59c8d107ac0f10f5d94fd65d23df434bb8cf013c2e29dc208654e2d9586f9d9f3e94973e8166dbedb7644226795fe24c6a0bc37a8ea57e68bf7481009d0f232a6238a00920fa95140b4949b21904471397c4cb907cde52607e38979ace8f8b357e463a14fd24238c5533c774983819e522dd90700af8c5a34a98075d3fd2a54a906fc691b73036846ef53277b086bfba33d29080fce711e96e32da883a5c1b7b2d7e15c1b0652a3f7a0e1b59c8d6ef3bbbe2fd989c7e2248f42c5ab3e3572c4aab82fdc3717b31b542e1fa9d939c2bf20e66772cddc8a94020d50c646ae1ceff4a120e94656696a22bea64b5cfc4df46487791fb7cd3d4504bea32104ba77e40373d3a05c990321ccd448010e2f79930a26e6685b1e7edbc9aec998637690792b36424759e48366ab3c10b241a5bd082abe1d38086e427d213f28e5432a12e56f439b18a03378c439a71c75104b63451c695229c79061e38d0dcc9b862472395e142ab6f138d91ab1867134e0d4d405c0eee3f95fd6d150062ddd44b13d1ba45df584c44254e919f2b9537036d2e9f8de600b48997056a048a338f251172510afad0c9c23ad9ec9ceb1296a63c1841e63184dbd9647cf9ee87149648421f5584a6c3be2fbd55360859e3ad330cdf07697ecb4897735319c0aeac806d987e449409611bc680a4d9cf0017f2d8f0ef4d4d2a13572efc2309aca0eb52facc0aceb8c2e7d4a75b765e185fb933b65ebc9b74ec0f1344e3ad8fdea581124b180541149358319acb66cabed2f6d36bc7b9be5987b6f94b7dee01d6de1a12d041e7bde34989a0f69d24ee97393279aceec6a09e2b8e09735b8bfdfbcc64c6337f952d022b4769e371c9b4e56f845b770d8d1279f3f4feb83128c4121aa29bd88d89e1b3e177ab8dd7be6f14157c2b04b2843828c13dfe3ddbba2965f6daf13b8fc35208f3e203af96d1ad61f5e0699d2b482681c5c6f1453f8eea99d4346d51cfd7d95e69df46fb60f54cf95c94e0c9d139c158e20cee1339bbb16ba90e9bcee63cb8969237822f7de6e26f8b88c5eef1f85b781384aac48a8b31b01a3d712ceae9433050f15ca7b7939495c53ad46113abc148d13e6ac8cb0a4e0ddd4ea69f01d5f09cd43cd50da1ad2417bc5e83d42682ba65c6bb1c00701fa9055d6760125c0d6ed6b021d5fe1ab577b07ec43cafb874b6810baef93c205738de0c1bea3d98b453fb97b86c8f09b61c76595de5ce34be299086921c96145e1c1ed451d6992e4ed222b99586cdcf628a5bde40a9c645e51335b9164119e259307f06cb5c1b69b8f6a2a787b2f6e96e813115d01b8628116c95a21a94ee7c2f3b653191483e8234f9adc8a0847dd622a2ff84ef361be8bc46dbba08aba70b782ca325700a345ef9cb6f5d209ce51d01f3e0bf6be18a671834d396079ea47ba260e444f8d46888b5402160c61a4b9c25b99ffb12098d13d6908c8f3a62f64d5e5b933f458cc0029e0869859519fb5e3219ff067fe1a3b0da8b0201b40d851a2300c47abd8c859dbf304ae3c4b812f326b8f2c02f56b7bdcef8b5e8dd6cf57c1a9b7f1821038bd918d5076b87b2920b5a9c2245f78c7f9f83500afe12dd81537568a0d9f49ed27c967d2e516eae5ba9a151759768be8814b41b47f7bd510a976393f6fdee0d89a83107473012cd8edc6acd34c1ce8f03df4d444603e9b262d7f1d8b42e7f20ea1e9976891baa72e791421803065c761823237e538602d99e99bf4619c023ac0db3ee52dd4132e0e6bb0a57d8659fbc5a5f5bdaaf0301d39320235a0b14deb67cef595c453b8aa686590099cfb46e31b4ce63c74a7b113d177e53137cab254b5f5f44add0b5168aa7ba9a5bdaa4f19a41d84eaa6537c46bc26ca8453f35a240c9068530151451fa3209d8277abe7baf3a06adf54ffaa50057415dd0277e850e1c551f627ae8886b69988474e4693a239c5f93fcc006a68f8e97b7eb936f0b30e747432755409f8880602ce0428c8083e1694640816ad6b209d286fd4fe6cf916ebd3212acf682cf440da05eab0fc6863ebd906630c513ce5926dd9e50f2d0792b23d44d4941ab5b2986cde94adb9d8ae2bc320e8f37bfbb5ef50e38bca73cc7a7c9853cb571e44765f123d7940653be9d4c6e4a319bb72c7e926a011aab077a0d269e25c86d90e9a9ba7eaf6089f89a1f9eec3de800aa94abfc03084e6d515e9550c6b7ec731c5f49dc036d037622643cb3f92f238ae2b056f23312dcce4e18130690a374eda063f7e11816f7fda8aac68012f04f03573df3266ea49c6513f394f66b735ccd00d37adcb3870ff1e87d542c29d2b493b2c42df70973672497651d2e4bf89fab1f02c7d8a99f35cf0c3affae99d3c24361af905a2ead4e313f5b373aae4d1a4d6fc4853e2cb2bbb2d1b0b25ae77319823a43c032359109c61d1e96767db67c1628dbbb294d8b154f25931fb98a8c4be2466a36a47848739d6d820ebd6472a13ff68bc8aab5ff0c0762bf89956557a52f8ff76536734f49a124f6ef6dece161ce59d32ecb7d2845003485739460b0380abc057bed453f90fad9ed9196ad59be4ba3cf570d792e5c604d7d279ff9d6020aebce36bc7c9cc441715bdfb41dbc18fcd271eac8382a635c5af0e9c90ce35b5941cfb0594b4154e92489db66560c58ff8cd985956aed9d398825b38ed955b44204ecc2852e8a13920c831b2781ceb1dc1e2aaa34a585c36c4a9c72e75e03196f5ebed30cf12c494ce8cc16ede9579205398122dfc9d1a1ad9b2b4de1ebe483441d400f6d4cd1c9e061802a9a92be3a2e48b56d8a508b9f38078adc2f7e7c41d1a8cebbcc6d8d9c032f39021c65d17a1efbd61b0fe02c54ed9dd76267ce68a74ce33a1fb4aeb1063706ac5d91ed87f6af8835e1b997d91b931e3241beec047bc5c21b41a6ef61736f33ef384e27ff2d713dd3865720c34dd7bb082ba117960e1d5367ffefbc88e5dd9409dd9ee34cae580d248325c69ca94a13f01c3c882d9f50f76d83a0bc3394a24fa4c56f32c473934c5126d9084cc14147b648ae0d735c2091991f56744ac3472b7f4c5eabdc132dd0c5450f3d9667b1fa497067d64f41d51376b3e9c83d8544d16c2db1680b207bfdfece50fdf746cdfcb1bd3f2db1d9738ea2275664a4316f7b5cb82967afa656969263424e378c4a5e7231a31085c266a621700c4ef8444dce8f7f98e99348ae664af23e114d039d8397546a177db906b38b325636427fb0ec32df04e1affd5be575168d0d1c9a6b703c56915df132553e093a4aa3a17c7d353a6806fbc0bb75f88721af40f29694e4ed4f38947eba4a96c02c01f39c39da07bd1faea2897c2b2bf48407456568a74b92c09d68ffa4c0660efd7a0b5afac3aa5c5cafd86f6d41a04fa04696ca4c3a96ce6488f2b4a998e4a889b38413f68026b77afc5993f6202d3971a9245275c622933317c229fa3354feeb525675fd101447ca2a8f13e16d549c8cd39ccb0d365876be35216c7b562f9a4413945976e57532180f5c2a746356fc8b49c5613ecf73052e4225ec496618610d2915ce3ce9005a6665009b4180d82ab4c3c32770ee44f9cc68deeca66e1929485834e3b30f8acc556a3ff5fd67e8543609e881a7c36784f4388bb5ae2bb2dcc76ca9cbbbb290eb4c6f75dbd02e347a1da49f4ce80d18a6af4ed4fc3ac687eb96f883e915bd22e2b3e62cfb73d8bf394f0048c945850165aff84f0459cebd960e5223d1354dae4945726f5e4a90504e46dc5d55f8494c4a364d103c9b1c5fe28a4f199d441492d3dd4d3744d409ae1b33477f0cc53b4a6e3606db02a2034955c06bf85c12e6c2e4505596ec0017923c21971cd415a4ec80a1d986121596f2b3e89d7e9735b4c1c66a3c789e2c77231596ed474a233fafdb42c901676852893aaa1d5bf5ed77383869b4d648a745ecc468ba51ca68f6e42fc0c793df0cbdfe34dec41f5619412e680a6d966e0194b462db4d82b845f01a309af88fc36b3290439438e99eb2336d846d85cb4dd36d5c2e9a718360db251ffb8b886f502d951d4bd49b016394a9a7548d67ed791f8dd35b91f0eac65b7e1af6f1def6168d5779399398ca5a1c06050e0ea674b08fb8e11fa8de0ffb11e5aa01fe381abd3f146c8767eeee6284b4163c74eca0a5b2b908fabb780d40d5acf273315fb5e6a98d6f42281ca00947ea72163a4dde7f63af31e9bb867403aa8aae56568ca6fcc97a0a457af5496df4b77b744c608d126772785da38addbed628251c86fb7bcc41502a101c2221d3a8823abaaed0a631d9442769484ef6035334d8d601ea5e0e254a6617f08276ec0d565f0d137615a4cc632a5e267f9b97624498fb0528509f21c9db1206349ef10f42cf64a86bdf54dd35cc8d50f73e4ceef729ec81fced24ef6bcdfbcf2114859ac0dc253c6f73e28a31ec1327511a59a08f868a5c3c021038bd47c2740e5c9899b5f77199d60ffa0f16cf3702e040d1e3f6d6068827ca056254990229d1b66e38f31cf937fc750267a9d95236b7bae892742778d294d858e6431c7aace608dbd31f78b16ed5027fa7ce064513871ad895a2658e88cbf0e9ffd5a0a5784b7da403e0783959163dcc9f03db95c71404a5089a4c3186dc90b5a0c0369490542f236c8322ffcb6ae9f68a6cfd9d62e0bd843bcec010b45eecf1f3cb7b9df7a99b5813830fd69adc384f64ee2e5b89a5c4e0fb5efc641a7c0f8e28bbd3840f04af4f58fbc57dd0ba9aed4a0859a170b73fdc5da848c3d8443aa5ceb7fa717b37bd9ce3c5758cc476ff3871e9ecbcda23f8f4a3cffa6da0da3ad2bf5993f237b5d47ce3d398a331af0fed32b64c24cdca422a13529f4ee911b5c68ce4da783b89a3d1b6fa36b100cddc3462f966de5f32f14bb2acb2c09dd0b38fad03628330b2caa13ee1a061274875f689926007d1dd124ebf2665e88cead82310f88a96cd6c8e51ffefe225e7991691d4b0d07a5db3044fe1beabc05fcdaebf41983606806db171b894fb803886ec924d531e253450d6bf349e1f6b0e59485172c1692a9e1552c900505ee0a89343f455e382f96cffe5b45db22d835af9a86e9304ff16376ee6147fba0082ba88e7036bb698d67c11f3d361d964323041c190333573266ab12d506e1f7af93429d3af8bc283f07e5f51759ca496945b133484a33ddc3446c898ee6e34ee7d009535a8d054b00c78fb98ef43d44e4b6f5d17d39be265f6d42afd4ed74ab029f5ab3e71e3a35656efb961ab1586745028e7cf5533c7036faaa491b6116296b13cf825fed317d45eac3347edddff11692f71dfacbadc6f6357e27dfb09a5032f2d8261b1e68b9fd105078074e68a6eda3c82ed0aedac2423f85ecc0772bb4602e9681775396a412659b250180dc9e60aa79d6f70908bb17134f26827dbfa5d5fc02e5281b95284324ea3c046048c59b16ac19052ac05e5bcee4f022062f914c84177b449c6021cf7a9c15a2e6641c1fd5087e95af8dd8f2d01ace056427c53564d1dd0b10569f2f008ec8155635cf6f94708dfd02bf82280c59a5265eb0d95078510d5fa98fbf3a73a391a092ba5b19001d6822120b38e08ad8bb18f851a4c3a2ab75302fb529bc7ba29110789a99ccabd5984e06b8e0dafe2c30047ec9cf54f2a84e8bbc5196a84811a37b950407e5b97f20389a045e4ad41001fac4135acf5893e09d5a510e024400cdad84e7e606fda673ed1c806944adbb4e1586ce68e38c3c82a41b962d196d615fa1460b3b58752244c993529fb5e248d75ddf0db3407ce8a37b3c311591f5f85b7550623f51e7785389a9339979bce9e67d9f24f51de4ca660106cf854af11a8592d3263995978f6859e769f6deb3e191c6bcb3f365c131dc0040af184b19c6371380ed2b40485d3d962b39284caae3be1fcdeed29547818c8b2f8071b60b468c103f7322be465327e05b26c1ab97b1f2c125ecebd139e97bb95c227c8a4ecd1055d2d1ad37a9775b9f48195a7a991ec7663b294045a986082d2d0f745c41dab837b4f943307709227bd5781b50b98213131669972301e52a29543390c5062756fc7e1590a1c6d022e3c7566ba6c6291c8a5a01225580dd041cae8c6d8435e946176db7330d849789285c82149d10aad81601f8b0b63c9c08cf3ca6e7e79b0c35ce24ac810153b5125cb927a954465bcbc2d3f7e519d97387034c7af33c698b3a6d44ddd16739e5a1a65cfc7f95769eee903de09a71cf4e8fbae17f48aa79dcd7c3257bb8d06c9ba23be3efa0aa5553996c7ff73aeffde4fb8a45efcc6f02878d24d531c5020a541b8ee1be0f529ad43e2d6f3ca4cc028cd5165537b2cd75c166002f59b59615235056789fa3042bfa37ffe71b62fb6567d1406edc4ac35e323a50cbbf7cd44a20443a9e0c70ab11ed83b482b47c3eebbb1a01845bdfd60df442cbca7e7f6791cfa7c96161c00f2c458e6dd2cf491642f5a0900da8b68bbb60ce0523b4354bebf7eeda06b197eb067d4562c41a9f0b5c34284c1ab5f9a104a539283cfaf6c66c68a40a6b4e354bfbbe83e14997ca34a06e1d00cc2f405b8a3d4f6488ca1d5b7342e19d78da14ba0b388071c94631873034ba86d4399b1dad6c5f268417a65efe34788225700943dc6cd97e272eed4b3a98b1e4bc406f9e285a58c322fdff09cd9bbb11812ab6f9e34167a07c09687fc2b5944822ac36c1bee0d51f1f980c07a0b527e2f1718242056b642292c629131d4c646c9128e4f03969da72345c22b4cb814d072c6eb1cb60ec561d5601df16851a8b9b1d11f7b327f31b5d91e1e0cf68e3d5938058ed7528e402a5b9a1990a3e62487669f90e1098c8205530f0945d349a8b9cb434ffb27494148c1338be1b960bb8b34b63e3e84f1f5e732350346bc30a1b9b8a4486249f580ad421b1fa978ebfcc76c090196b47b3c574425142e51818652f1921e9b4250dfe194f32a31119c54bab9fc7395b0f098630582fa74160706e50627f165b6aae448b8e9b3cfe5a580f4252070a46c50e6c59241dcf9ecc1eccd920341e62a09db29b118625f7f54c1f48d900ac977bed4c4dd179eaf2c7ef19c413224c76e2acf07b7da601974ca6ef7362bb4a446e336d7b26338b251b108861f1ab513d5a8bccbde351b8c057c9b1e5aa69a9a914b2f28f22fdde92098e3994eee5dfa551b9826d0df63b750b11560f861661b655dc7b90583c108de64a6e37a228b49a8dd11aaf0f25a19b68049fd51f606b05fdd9ba8e8e2d92e2f17eb7fca5abccdd709dd35b9f6aa0461705a613392bf88935fa1beee669e5eb0cfd2888b047064f4a69f0f61121e7dbf96d09415b4af41e26e26648ccf3e680a8c6818089b925b9db369c960e0cb242cf532293c887511e67b76f26e925e0a411334ae8758be041e95f195c683dc19b3d972eff547e120efbf7c7fc5e02a3ba2646b6d309a5c868400f70e8a0864931be23021136ff0f25f6d042c05ee4066d76ab296151613f6f0e75e63b85efbba04638e2e3dc4ac19f719f60384096589e43ceacf933ffa1442d59fc72dd7ea14ff467562be4e683a3b0fe1926cf9a1ac2f01acbf3b1196d403c9308f0857babc7f54d2e35b0ddc77009530a29cebb6d70359791183e79d3602ec4e5de8122ea97e500e7aeb17df37beb9caf6da298063792057104a4395509e8fb41581d3ac89e983df7d09a5880eacd821d6ab17d647e1ea685a91bc3e8762eafa9d8b3bae82d59ccd20b7de019e13ef75fa5df76bb4bd648d2fcf5e18ac19be91b48b62a086d136737dd8767c8a19274fed4dcc95a0aa1ddc4a9a94dc4528fd6b7314806c5561fda7654a5e291a47cabb844e909dd4a495dfd0a68bd8ac41e924e9aac98cd79a86b123395c6407327720cd130fd2da3015e17aa1eac936bf8a71e84b1ecb5199dd38653a401688e7f2ad5c7a7852f31fde5192d67dbf4e22da1073c0f5bf93638f6c41a548fab5ca8e31eda42b7628c20fbb440329cb027b0281edd5d459050e8b60ee4276836b3ff568f2bfcec6dd59d52eb7d4b8c0c04cfffc2adf258960a4aac9481876468c41a5d66ad77822e2e75d26c3521483cbae2e502e82a0d160b65a2184751bacc3964154826be65185458d1865dff88db64b1e8dad86955e0328979f39fbd329dff45eb669d90929ed9b0adc9aed7eb030524442e8dd4e713ec984301cb9f3ce0194bdda98f174f330956678f48b66f91b823a4efd124ee540fc97175f3625c211932dd953d3219368b54532ca35e0c3a173de51252e876aad47410e18b2f2a14fcfda9fbbf20e20e3c70255a8e53461f0c668e9bf4c20a113a3a09dd1e9eb922ea12c34747df7f46ff42cd44669282d14b2a73675e0ec40193033752cf95641319bb66814014264269e5cb0111b79efb9a4287f72ac4d9e836887a3621f07a047705835d399ad0d75326ffddb3afff636a539087335f3e36a74fc5b1b422fc1aecead81ce05736f655a4c1191d326d157f05a441b5c34ab9853ca361994285a9e7eb1d807fa8c9664ec829cfeb38488b3b7014282ca9503bbf0b8c1379a45127c5e515389975a937e22bf3c12a0c0c386d6fa5f77fa03d166a7cf7a3b1ac164e1e3a1adec5471c6c6bcd5efbf3e7b23341fcb3f28b975427c20d3308854db2097251bc9c0cb940403a36ac635b2ad9231d3f6e19513f3f2ca15923b898b8d74ba6ff14a9c4604d7c8fd5207b80f8897305ba5997eed8fbd77340ec53377dda07c891f79326f95adfa8cd78bda86f9ed406612ab8f680f6400d3f204f5e95063127c5b059b1997f6e007acb582ac4bd280de0fd19f7765fde87e95caf5c0f2eba70b3f3e59919903849f055efe99fdeb730fdaa7fc2a120a4405e57b8869e50cc97506b6fa2d20ea3008b776fa44a00f4e95e55a99244ced7e95190b57af364abaabf7160ee42ce47c634508f30b2ddbfa1536353771ae76a12e987800fd8bc64c08d9a3a772d9c3d29fc69f5e081e577a3fd35f21355bc15fbc4460598523a577110c27465ee82e6a83c9822b863fb4eb78f0e9652360439457406b72900610b3d81396dee0131ea3485dc1ba53d51a3955b8ed2d7b8b85e8be84b1cfa2e3b80f15a6887d2a46acfd9d3a4d7ab91786db8a0291342b84450fb893fff7736a4a1a42028048ea6ea953c8108636e090b1f56c340f77ed5edcc76881be9f016553453ef30f1d6cc3066563f2fbf45e750305d341c8d934030f69653fa36b85341d78161297fc265ab84f517b42519024dcba618c81a1b354618f6755a9a29e4a2fbc6e44e2060acdab4e3100ca9645f4cac24f8f9f18ab0590ca3c532fa321d86db577b9344237b14f95caaa8921b08099ff03092e8cea4450a819f33e9311531ac14397820dca4f9981fd81dce3d906b6f6beedf7daad55dcb7e4c912039d57c17f831cc6512d44185d6e5e8aff4d452019ec95ddf05fb6d1c31ea35526dd011c3c24d49d6b042344b846c83f3f8636ee1c91175db4efe56673bc0279e3357fb34d99ee5d5d212c287a5cb08224b5308acadd23d800ccc2430a65f42480dcb2145fcbcd8e46158cad5157729f718da32c80d55455a921155a42567479230996836b87eb3a83072a20453f24b4e1f316078059cb7d8f26047276fc6cedfb9513a4eef64469186672388d135fca52990d6735d9d030f8ff16dc3bbe10f9946c3c51645a410f67ea9cf475076211cc37755ec20f777181326433f0392066630a8a26ca833209d4869ba964af523aa66771b9830a32d904f05eaceacfa10bb106a5ce7672da19114a8a09eb1b8b060c550e0aba2f5f27e4aadc83c0b39c84fcefe0e2f0ecc0ec23a2b9449c2c6439369c072eee815dfb352b6ea03fb285c6b031efaca21ad4c1323a423a1d441fd61f29ea62fbef096d4649b0a6f7e5c1a95164f69d3cbe1d70a01228c954487f545da7f1a40f1f8e3555e35f56452e6de9d658cd33c6f6eb5eee1b059c79127c4b3d48908409060d7296d1fbb287ca4ce6ded4b145870ca1d294da4255582d1fed17745ea13d09475eb8ab45fec9294301a8e1ede95b54bc3aca311096fa976ac49a092871c3e209422f53706b64a68dcf01a80eb9ac01ef2d77faf220901b23ca9db34dada3a0d4cd855b8a49ca164768042004ba298d317343646ee4dd7ca7b39dc959589c75089a3c941aafaf867ffcad21d1adcd8437a428be60daeb19d64eb7697619457046b960bf37e672539b8f563c4eac44a1ca98a6f8ab23cdd3c5bb816aaa8db6c014a6a9e333395276e491321adb7b561e9df779e9e35939562a07e348587f7853fb35a701fb262708b156ec2b742fcaef3f622830451910738b6e5fdc7e4b42be26ff9df5f388559a7fd9806e163394f0f4f9d4036655ed4b2cefa38532180cbd502b8ebef2b1258a1b1b7c5b1c566917cf9c9f47e40b7f04871c059450bcc0ca103822301bd31f5d79da56f4f98c440c3b739a97cbe7eaf549d150777500c090d8c2c001bc0bd5eb0408c7e5907a3821834f95df49583fb051658b65800c093cde1b602da825c56d0cc5c9c3892abde1c83ec1181b90a8e1611dfee2ae3da0a4716c5654f348aa33be942657513a12d7a47837a929e70c6ea85badc524048c55a787c9edec49c3d2337cdb12f27721927ed63597e05a68fd92109f3c27a150c61d4e2f1698222deefb1a6dada0433fbef9440729b3e5ddabc497a1813adc695c4d65df9415e5f3e418d2d3ea1530e67f312c8fe675b2dbc0a4280895205a9455bc7fb6ae1661aaf67af327908dd1c9306b67904342f41349cb4a4a40d31d80e4168caa799e920e709dfcd6ad497335ba4068def6988193561992f94da562e3edcd677f6dbeabac874b96bbf25143615f8702acb2fd5486cf60c5fd402b618e143a72c84635f72660938eaf438a344b12eb89389dd9547fd94ac36329c93eacf523c213e673eea050b66f44ee8e912e784a05e55ba868acfeded9c78f5d33110977fce233177591f8c2e01c99a9fb285fc2f7a5c6ac3a069e9339c422200b0b3bb4603d1e166ed68f47f1a4746d127d170749bdd7380af8bd06913d090b95ea38849d77dc2cb3eb14575d7c6524717349e7f7cb046f17302ce4b8dc900104dd81991380022f4a0821f21b3ae473efbbab7e74d9957dd23b907a90b7b80e0d5175c82468d6a736d5d545946c14164a9f5fddf009cb01e5af594bb2eb2b94faf10ca61c349e67af3bd9c969077e517c09883d6be968e56322e8e474c63f4ce424d07a34447658d854dfb79a2114d944e27c6ff070fd2dfc8a202d58c647988232d8d526f81ac83e5788d77d047fc5390b269ddd91268eb757b93f3c05e40e721fe0622df0d4c2e0458603fe2a0ace08db25065082b0399ef8c3ca45cbc7d94ae39099c36bd938dc5525e8549339310b1cbb07b265185d5361599dc170229fcb6ff0429abca79e46e23b762342ff781bac7ee6a9adefc3bf795804025f5c19cdced9cf61c1fe510d59e95af6ee39027970f431e674ff8a3b0af663872ffbfe31e98d53d4dec8150e846b6a4101ed11f7e22e43f2c82d2964cc04357617ee154e9822bf1558484b9b80e84a548c734b9f6f0ebbc7211f0bbe20a16fa310fb43386e0e9d4974437e00faefd02f0865630ac6a2f338c70218179a2de45d0e7a876de92841c8123aab6fe88e14e4c36cddd293de2aeca191bc3709f03214cac2a2ba7627b12b329df9e96f8833b3594cfdc9b7b356acb26c57d3e655799115fca60de1ec19cac29ec50f0c0f3d546edf354da2a217efc29331d6cc79242ff78879d015052c07a8880e2b55a62bb1c53e750ded3fab886cad4d9746d9aabc8579c457b488659676820844d618976a2e88a5992410ed893c43a7373c4d753957f85d00c4ee0ae9a373e63e1ce0d161ff8a7828a39e37b572bcbd50ec88623608546af56f47d9ad33855c25be83313392401d31d5eebcacdad6c83825682a4aa76a8b8ce79388302c9447db1559a7417e6d69599d0de9f1788b192cac909a9f96ee1571896983adbbfddca5e98514660a10f4cdf6646734e1e55206eaa66555b98aff7753d7f59ae79373b132a251ed7d8893701f2b051a0efef9d2a3859e4537fab7bfc22255dc5b1334f49086dd8d0b0e9767fca253d8a8f809ecab9eec9d44771fc8300df50680951b520796a0c66acfb7bb8359abcc17bcc0a80bacc39947b2a9f01c6e29b240eeef178e2cbd90356de0b938093345022220f5fff1cb946433269da767dd0b9cc8d77e8d9bbe4b15bfecdc2c40e9125379d326dd60bab332800bb6cbaf3098f40078bec45f565a50b052c9833c11ad294f69db0cc4324231e30d91fd238b8a8e079aa267429977613ea64e4bea88ddbe6de1a755f571da9bbd822d5b8c01c7797d2ea93ca77d85165d3f867cbb65b0eea1e90b58d4ddc1657b637ce4b35289d6a0463ba752abe684919f9f29cfae45c4fce93fb348bc42857e973dd16a50aeaf07069f9caff406a788255c924b62acc9e78ab1cbe4175b89664a8038626c8c7227e439f41300f42be6f121bb0371eeb8528a436d753b166c4869380b3dee6177a182ba134be743084c69a802020b464739b749737d8c6e531ebe7cfeda98bf843a280db2178115a3b011ba6e0e9ceda5e3b804d3e8eaad4844bc57955785ef88601f805c042089859550449b4f047a196bcff67a20ca7a15315469785252bac838154be84a47f687ece26dc9d29129f1b56caa44ba68449bcc65589e625d960f336c1c6451aee03c8a7b42d3ef4e1ee0845b125e67d76bc5b5d6ed476f3ac26374db0ac1a7573cafeb5074c88ce4952c5fb8a28e225ce0f9b13e27786538a0be0ed6985206fda93b39296223bbbe21cf076c46cb9cb8a64d97e1b50f327fd3a2bf3958994b776149de5530ace5e188eced9142ecbf53a81bc7a408d8dd2394f48f96e56852f126cbf837b94ba8a997fa9116f0b817e63555b3f42bdca11a17997f1daba372cfa677bd8b002d338d96958a3b12f0a6e4cc675e9229f21de36dcbfeaab4017d3ea03e1e42bd740a6045abeae78adb997ef3ec077ab2d846c4e4f35595db49691dae298780cd734192b890fa578c461c4ff5810c07320b63488a6ecc9cc23a3e5a13f65ef13516f7ec3068220e4b492d1f140624cedf9ce6a4fe9166fee52b2a0d7fc2af66c25be50b2ec9f9425238bfdec69cfa5ffe06a340fa586de804964048f721fea702022824aab3a3d02426a859711576649bb64a4dcac2ad79b1c266499ab22c38971c736aacd572be29f25f3e303473f5720157fadfdfd4e54b3f1fee7ceaf595d362624ed32fb2637e6c0c79d6f940f42f4eab042fe4c4ea1832e16e5e380e11a05c0cd953bcd0d52d422bc6e361f9203fb0e7169d956298049375d2c837cdc0e082145b6ca3d6ff3a9e4ff227dca85aea6e350c1714a60f394b3acf856c296ceb1e7270e3d2110c00ca3fb7192e406bb9bcbcf11c5ea6e837d5deb9ced33b0bb131cef0ac624e26fa5bd9d15a3f08ffbf93cad5da97e5e915a494ec24e0618b19ffacd4a729b626676062fe69516785bf0548969cd9ce44ee7918f222b2f78a9a0341a18167183df595100d1f6ea5cb8866f08e6fca70d396571d11de01191e16fe97091497920e29e0d012290522db7c67db95e35a3dc1f093afbfd874cdbce60925d6877e2da6f551df7e70f5627096646228d7fb27424957748595c4f9d5b7283bd348ec41d7f6bec3d417dc389166ea9d81ae4e7becf8c4568540126f8d69ef2ed833d7a71ae58cb1d06a5c7abf5733d3c5cf134ade4addc2e78d22f775d421c0a9a6bdd7f3bd92da9bc3b75605fd1aa1db6e01d30c2649c6524046dbb9aa70abf6ac6094292995224b66a1fe98d979ec7c36c4da0d1ef22842b09fa27b9d557bb4f441d14a18590d6d6add79923fe59211d792e16d613c6943190958806fd11a5596e7ad1578e5b643b35407fdc0cc3104775bbf7784e062d7628208008bc3817f178e0dfabac91fe0a89823b0c0afa0906ee48c1185b71f378f6215029e4b29109a31c46407f2bc85ae54b53167cf312609b6ecb5b175c24d9482f92da5cf3b5460185db680861fde2d7c2ba6e4ae09ff715ae100a0f2abdeee114f4abdbc835a215e58fe02735a14266adcabaa31bc808dfec736df2c69646db9b6d83801a16e534d35a8077b2ba9991570c351943e1987ce2019a3f63a387e38a4e69eb53e4ba7cb0de7a737d726bd3e90d9127ef87eaf391d468ca91d2703c5c63286b1c57fac309b008352722ad1fa4551e19f17b82b57a856d85c6ab329be92dbb90044cb587eff4998cd2ac032cff6d3fe2fcebd40db735fea0961e1ca1c12e1625d257b7979b60475ab1b7daee55cb979033a151eda54f67a5dcd64ca37970ff8376828019ca7b65ca65765fe51c3f5765c149ebe4c2152c4cdb8acaa08a9dd2a770e1ca69e22b4062063c4693cacd7f5dfd731fb487ed24ea70acb3b8e1bb1f450caf863c5270a9a7868ad632bedef58f86df4c76f94fea7343e60384462acecb2ea6bf68609b63443f6c12c7f7d8444e65be1b7663b901280dc9591da414fd5c60873c29a28ad1d303a5876eaa9e61f3277b40b0a262c43e13b0c6aad5d9e1ffa5f4a794073e1224489fe562924e6246b67f7c1595b5aa500005336445cc22c08e96b1304bea6384eff39660bbd34e9927d67a219958bfafd650cdc767c7b074a7b32f057996df1ab56f127cf2278fe750b27f30d7974ebdf5f452b01859afd7d086469f9082502cf152f8235116185be2953527ff23b7415377bd891e4ce117ed6efc4242e2351be2ff2c9a9065a670915f7cf89652ac001ed48be00d49fc9eddd3bc5c2234f37f4aab310606b226aa9b4ffbb97bde6875f47c8b317e6ccbfd49c7c32e244be6aa995dfb053f4b605543f4d96f4af3def172cfbf5c3d7b8bbb002cd766a6efa18ed4b0edec06e88672dec9b8cc617f5f41aabd697678d76c01084511b42ba14a3f4a020b9a98d4567bca9498698ced711dc43c800b60dca8b3014e6c308521090619659faa865db543f120d81a4c585d7d8f37ff216764b48954558636f284e8a49e78adfaac3a54b89534ab9f400b514aa831b88a0dc42806c4b9cd6038b68f5a4a15c13bde4bb6819194792551472bf3ffda6281303311385b23de41ca49a7caf59a251eb09168b17a1c7af48ae34b4212b806c5b0ed9cfe590337bc4870d1ee7648bd62f4b63f7f7b7caabe4cd6b4050e51f77dbd8f5b6502bfcc2b28be6e715f58fe57502f6960f638d8d2cfe61cf8f604d8f8b8dafcdb37ba380a9cf77190b8680f979bbdda2f53daa57ff75492d9eb3760d947f930cd52a050539d237a4ede90593510c9333a7789e3bcbb151730646360ee2094cd44b98958e745739ffd49cbbe2b6baf757fa5d25c42a867a73ca962ae77a455b4ee1b5c3d3c0d153eee778b634f7dc72bb2c7330e3fea5bcf84b1765866860558adce94136ca6bbaceadcfd480186bb27e90c3babead66b8b9948f1f46941a7c9985d92adc4948908f6fa71362555a00b10d908134ed8e58a278d62e3e8e3fefa2cc7f9b41f5cc3baa8525fd1b04f6a4d090cc195d81337ac4f9cd8212646abfa3f3f2984a3423b1006525e71a33bcedc95e2b6e72ea1cdcb572f53bb3c3a52f877b1ceb25124ba9e1da20b7365bf91f33e228e74c3976a2ac30f96e97128e62064632dc9631451fd897eff9f8d0ad1cab6d66315402ed932abaee95f954a11859bc1c5085bf55d7320ade5fe91a96b96b515750abdbd897b07a7a52d9fe80f47164f5fd5244bb7d846ceb8b1e8e8747d6f672a1473288380285dfeb281dfeaf1f5","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"e51cb6d05ed027db058edc159e71b81e"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
