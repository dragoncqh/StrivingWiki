<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"ffee7dfbbca81400f0bb7307adb105e23af79e6bb3f59d742b0e8d655350c66b214278c3302fb2eb91a1fd7c8cec34e3f78403df167e6906f9331d02ac050d49dbee54eaab72c7336cd63551364d46db74e9468feeb0d11804b7c535ddaae548d01be4c1426cbc8bd438f665c2ffbf8778a21f24dacc49c0168324d27f1a35d58c749ee76cdbe420b877822ed674ddabb02ec96d70b582954513ca60b8414421b666025096cc696a9c08c880c1036298727979bf71ea2224a28d38160c2045ea5529b00f0ce67354be488aefa5546157e3a3c9df717c4df3906270ab8eb18a341d73cc7172d708d7fb49f73fb7eb9476408fd74ae492b0ff7d3acf4239ff9a3bb037f64179263b61292a0c7a227e0ac42b0878d91b7e2e28038072c4c939cb1b629ebdbcff87b7ff58141f7831c566298dfda58685ce0f5a407d80aae14cf2d706434cf93ac07574aeb2849f2774f96732cafe1c6215370cd9d0ef661804c1f42dc9656707db98263a26dbda2fb4843cc67e08d65abf9aaaa43de649f8dc9cf83daf726b058c9ae3ff6fe0af71bfc9a5dba98d3954e39dc436cd5185ac8dc342fe7e48bca5ebf013c5a27d155a995418cb0c6576b828fb99e5ea8eadb548ad8a88be73f99fa7876dd86e30556af590d73863721b7dc1df21f81fb540fa74c866930309f1690d9db565e5b5d8e3ad2caa4bcf5eb6be5fae86dc7402f1269c3a48d1a1316cb5182c4eb51f7c7e572c09551f34c63c478e7dcd73953eee2dfdbac2b4ccae3d6efa4677383a3f06076d6d7adf1fc15776ecee39d6736d69c496b582043bb5f753ec73c37a8e25988ed2380e7f6af2bd9aeb128f6f93d5e5ce53f8c6d830cc3fd287ba08ec15967fb05c3454fd2a266e309852f6979172bc12d0ed373694c0a332254bc30e7136722ec82a57d7e1372905db49e1ef2206e7f916522c8b9fe37e640436483341c11329c50e24ecafad1f5c608ebcfe8c499006c952a341da2c4c9f1382151503ba1c6a159f233448924f4719cf6f0870a14bac5ff536b7894b4042e5a3ad9f6f91354ac3f86c33f3128d14aebd36447707d91f664d5f05bf8749df7dc33924e89065f943093ae0bd913ba3efaf75285dbedc1176d58803719f421a5c721765d8be4d2f54f030fe2fd69dc462c1ba93ff7b4edbfb0dde1e49b696c6da9cd86d85dae282d9b2d198db51c7629f70f7fb29c031ef852d95b4405d907ae48ce26246d0a649dd00bd16a712956b9995f1a88d66783ec296cb4b0e076679ec5738556dfcefce7348e9ca301c0a015833e50ed3d94220005ee5a41e5eec15ddd61b047f83fa9e1ba7ff7a8066dcc0531c7f68c468d2823501be43a911b22ef2fa284aeee5acfe3314efc0df1992997b2b99f00313a9e38f5870b0a6a62efe50f0b4c057e1a95112124be3ca99a562613e1320e477ac1650e3249b136fb75e152c47b7b483564c2ab5026da471e2d79dc615de57195d4f94b21b53b99e25bd8ffdbfff00ddcd8530efaf73cfdca8ba7673f67025fce56d4fd5626dd91bcee8d879e376f2a1649abeb7e739f8f67d83b35c2d2e61c6d510840ef9b14d5a7e2dbc9473bf9d4dfa80fb6cebfde618a13585ce4404b5c30144b9a132c2d5e1f4c3b020e6f6d9c53afa71dd11a864f04ce4d77b7753e2c5de087c3564244c290735b38db58e4b20adc4f3537640499bc43b9d8bc230f71e04b2a8b1a929a67b4a21aa33e07fe01c8e927607acbb418f3210b348e01097bbd5c0a350091ca5d9e903731b2c80b728ce35bef32982e686a1636189d945e75669593e4d7c000ebe010f93df2f10e7679820e00e43c910b833bba6fe5733637e504583173d49db683c2a382a94debc600f4e43d2111061d86023362adf4ff4ab6818489e5dbf1c29ad6fd118357b8a9123888ef7c733ed78ee98f9e4ee36ca62a86c700f882e975eff39eb209e27c64841b3a617d0aafe11fae6f9181541ab46cc4b14f2fc5403c6b2f9ea181c49ed1744ce31466f76e8eaae2d1e2640197e6e40b3143fd28d18261811dbe7d9ae115d309e6a5885591a5992656bd6afbad1f3da36ba98654287687b84650f198c90c010dbda549031e71f0908eb10f6c40c354d003af257ed9c2f523a17b2c112c92b8d72345867d2e214ef227a67b301a6cfa12777f5d7e201f08f4ff0ee27649bed3a6b56b62155a7b98d031d7913c617622496393d2bb90d6e8f842238cf3afaadb60145da07cfaac7a953777b27e0499c03857071417400dd9b7b9c692340d8f66af81f7bbc93dd0ee17c3d2a998969a2dad7ab2290ca0264574479b7773ab54c8110a6187a636372f64d3dd7e6b1e82ae1e50b8ee20e00205f661dc25bca2106e18280e5fba55c23d535c1fd5253c839b315d5087142f9af2210c57653804945e75c957f8cea5660e81e40a5a9ab57a5435973c92131251e5c35acac4f7c929554e135575073ca483e50fab53ca50e8589c073332aa3bbd8293b08a75ef219def5b46be9522049c9c97d24e35a7b8ad181c29b069c7b8256c64523ff396f022e88802a834020cd8f491c1554c4ef0c501c9aafec43ec6c86bb76bcdecc49fe9cb70a4b3fe654d62df15600837c61718fb88cb1e6772cd9f166ffe13453a565c91321d27f81321c013ff56bf5d4ad07e15b170ad6801e7e8b2054f36757b2743b53b1af58235df83325ca455a62ecbbbe664aa8b62a1bd896d670edd713d21b086ea3af963727855f1f61569d5f34fa4b843e03ac937858f855ab22d224a28297acc025628543abbb911061304237e3e64048ae5eeb1d02b379fea00e5ea07151cdf44071f44b0f9678d26c996de69fada23369bad582a51ee2c005fdec1d2d2fc7fde35e2b1555ab9594f790beab490e9a618e94117779a2891e095edad3884c6f056ec517554f2b67ac6767946932f7188c0c415baddeb714a7e9457f68d9da3de80d9e6ac8c68634c8c0c36321b0d2c4251ad62f46bd18e04d8e6ecb1220fc8d5394603da42ad87378c55813d0a1562d289b884df01baf931ead5dda34353518fa7cf43f12dfbb46ff9941f673c1e25ae4132c49ee28b7d8fb68df0b12c06ca575d29130b5dec1b5e783f93585d2a0b9ed5e61d93fd5fbb18353c90c469eb55d5d39685a5026fda4f2466feddd01950473d055e235398ad4e73156571f1999bf96d42b3d061498f94147ab69a44d73075b642aa7b64e31961d51c128bc11f96e92be67613d2a7d7de334fff9b5a91e9a75c23c80640087642654d5f284400dffd21283afe26088fd2a4e4c3ab62efdf2de045afdd5ce2feb65344e9f33fda2c32bc2a2d95301736611fd479c64f02509cb36a438fc98441a7090ae97f5613d80c23695aeb1948d98ad785240fd675c4a33fe03b5c0969088b2c6d3581a125993d2c0c55c6ad991eb8a553bec3c9c7f3a9568794d6e0918f24ff3ce40aaeab1d8f9acc1e7bdc1030bb3def1eb1362c8eadc9fc24def7ddfa5201220ef6845453e966b3370a624198037fbcf7585f76191cb950ba1589a0351d4e33f2a371fc3886f3ae9135dfba527c8e06c5f93a1d7b9e7cdf674f7a972c74c4a3940de422861f7cfcf34ccf321856b864a0a2bb5e40f119c1c2e0c0a05b77a187ca3c29b4e9bdcbe0d0a952b6df71d099a76329a081355a397b0543365dd92e9d8545cf5a987f1f6d225cf3f9cde683071566899ab4a6a53588048000b62af916438572718c753b98564626d652c8d16ff55f0998d16b74323ddaf613535ce7b8397e9ad20780f3a4283015a46d41f15955236eff9a216d0b19433bd870a8f7f78e32882a8133173cbffa300941b75e737d2b4a5f2a1ab6bf33bc58f599d4d9019999da0807af6d35c825c36cf383c3a33296992c0b9c9e1721c1cb5b9c25bbee89cc724bd3f6ec97b734b87f25c05cd7144ab2254db99430b48246ea53cb5780e9475dc9c3592e2fdabf495aa1662c28adeee13b9f8914260a18751001816a67b893bc8a43eedc8fd9b3461e3cad20701bf2c200ef82827618e566a1e1e722666c9cbd8f29c2728bd2a1d0bf777ae9b073213e4d607616e1d2657a54587f8970f3acec2fda18fc9f455a4a4a08588fca43203e91fc9b67542588733810f57af4e4ef895a9dd300f234fb664563099a0a47414fac80957992a6ddc6e0d7752daec34919f0a2696eb47d0039ae842b4d0b448c0577007915bfee05195126f1f0a743b3fb5bf47886c76fe115887a75bdee29bb5754ebf538d784b8b8888a3efa193e02db714cf4a5ba69ff9e0fead4312a26f6b3a3bd09562dae62064a731c207d815eafa61454b8fcc2fba4c23c5c5952549bfb0f43121625773b2cd41706ef44fffe390244facbf70eb994908fba8e6612b26641c460fec22973cd411da6eed53a79755a91ff7319b2a8b990a85b182799e83760cce0d7b8bd437ce6ef740bc533c3bc16d5b9ed0afbd47b575bf9aa50c238177230d0b16c38065d9916b2a408eb6fd7da69d8f9c5be41f8f432bd2d3ad14fcc1a3e9f197129a07eda51fb636ddf4b50d350a2265329bf8e6230a14fde44f8f1838f356be0a16999502805387852438245a024b575fe14244a26522139bfea6bc21c669ac52f17a9435d3a3daf7764161fafc1fa6fd1e2b3bf1e6ce298af1469695cc67884b8d988dd36c733b9ba163557a2344d349d59478fec608d5f245fcb72a4b38b56943678fffded8e72dec24221a3498377854462d19a1d3dadbd26449c58cc6d1132ba086109755e72a44c28ca221528c1958face0bdcfb0b6cd367fa91768bc56dcfd9d497e6b73cecd7ab630dd5910315b5dadfacbbf8bce9cfa79085be127761da88603bd3e63bc2a690ecc4e0d13fa9f3f151e123a12ea078b99bd2c1fd7859b7c59bfeba7ced7edef1438af7ea96d5200d103bb59f4d50a4bd01a6af19b2ce7cba24247d7bc1b1d8079c7df814633333cb2003d3ef72a4d240a5b060deb78f436403b4b27709c44fcc96061970c2cc035edc2dbf0f74787aebfa975a62a8b9055e6b80fe665cf224faf9dcd5222f2e8a9615b9b34e8e3f265191afc37ac01e7b539a325127ae1db3f61eb5eb40d008af5ad002f3ddb5463e2196c2eb2cc68a6d2513714fd4777e005ecbc95b129c0c82cbea47b23bcdcb9abff483a19366482c64e2f801c4d5364dbc536a2262a03757f5d876a0e143d7a164b6c80f28a227b58141ea256a936a1f4d6ab5b807de159099a8c86d03e34dc27a7c793e28793545516e0adf1c8915da83803ed79284630e932daa39b0852236d6ef6f8b5fc78055ca06740bd5f38a3b64d5f01a1ac3322dfa48c55c5280d3220fa62d0207c382b4849606bc9b5aef1313568a8a5a858af78046594d240d37d9d78c248d29e82cd9e1b2c5223c14511e12fc14a32218c30efca9d36defdcf4754092c0fbe950fd1b3f0861f3c2a8e41e12f4d67a3dc2c300566db30cb41a459d28f5512b9c8e47e82f2e49c07e43c935aaef3d2015c35c0e7661caabaaa8c4d25b31237c09f0d3adb211c75b4681cb135b6ce4cbd0120e63d1ca164a07199212b6618fa774491df2c74cebf50b668f3f3be41aedb144da6c6eacdc32b6ec67f95be9e035ff417df828ca4dea25f33374a2dea63d61946184af3438f816b3fa9a6ddabf8d483e467fcde9670c4350425e722c96d625730c0d6259e5f802e23ca82e57957ce581e269a214e7eccd21a8af115b8ae0887ce76f66248bc3b5b2cb37ec93d5a53e1b7d7b61b834d4c987b8f24daf80f7b1efcadfca00b78a423e2235a69997259607382fa9155252e6ca16163e2b8eae18928a065a0e2fcee5aa76252ab0e757029faf92c9f834e513ed57dac16f2751c9ef055bcec842ad7197d0bcca4322aedd44ed584c1631bffe4d16d0f8831210ffa92c893bd486f58d1b4c5e2c9f56c6885ffb2293683855fae55047bbbd0ee8b4ce9c4c568411a45a45163c4bd7cc3e0156a0919d68438f1adcc1b2cb106db9118b4b6a71c27fa49c8804c505ba7be09aef12869850c57b8592c44a25391d697fa46ff7f7ff44b76bc2dd28c3503c98bfce908036e85fd0ba201bc05d88e40a8c6186c96f4f8ff4827ecd8756c5ea398dcb4e447b9fc84c50c7031ccf02654f87c3566f81b2b5c1aea3dcdfccc16f6ab7da3733b70d8510d43dd59e02be44c4dbdb90e6b898bcf1232f3eb369c22afcff4ad542dc0e86e494d0a7df2c137ea54c7db0d87877942a1edb2489db120fc6e1ccab2b7d71c8b387ef5b72444f780187ecad9d8cd2af2869a4ae15a28a62d6fa6e6bdfc9e9fa493e459e6b37bd4767bc280b2a0ddfb026c4339f36231edd8e4d3b65f431c96a2fe289b06dea3475b691a26510c849f6585bd1ff24971ec58ed9645d72c7ec94a0746789689a2277e2d59ebed7652d08f1508022542674fb66aced761f0e5f0f659a1bc4a3453eeb4247fe442ffc0988181160ccd4d70b9b0becce62cd698fee41cbebd0c80ec86197e0a7dc655b108ff9c7dea808cc716343352e2b93a77b986a4201d90ffff1facc1e9925c78bfdb8d93c5b6828728599a8d553f03dddf809e2bdc09cb8a4f5f730a7c29bfbc845d5b38ee0428f57bd3b818ca2ee92be40adb71510a3f1b5334f4e70c3e1f18f310c015de10a5808d12a8c1e4619c23c2f0f352102be20370579f888954ac3d2c87cebaf33079f7b802c070f07c4a566f60391efac2b9e7f2610317f271d7e32ef50822581143db46760b1e48d845ef35783e29b58f4a0c1cb8db392b5550440dd5bdaeff31fc94545ab469fd83f540677da05c18ddd621a458214f5465c692c7fcd20ab082e0fc1f9d4e668bf30521ee2d7d605333458f83c785d4b8159f40d3954458bd8af96560e32249553dc0cb724495f13c53c06ca36a166321bbd34135739024b42bab19cbe4f000f8cab4a62663d85a7eda3722a196989ae384a65b90de8573a5b33b8289735ac0920afd7d22ec9cc82cf7e199ae28f1e166108a2b11c71fe8162ed0e24e2a21b923e524b76a3fcb22fe35ab109d03e38ab901266186cecead89bc1b8c47b018c78e3c16b47adeea3b66c51a3e6f97bceeeb86e4233983417dfde9c7fdb97e2e1ea61ddfb1d1dfcbbd5e3520f251a8d86be2495ff1e160bb6705124b267e2191dd56a34c480206da5d6bc0320205816b3dcd2289c23c76029b73d827b447aa390f2727f71028904e586b857ca77f5eb13f844c004e5da6c5c6a26efd588e401ffbbb55bd574e118f930bbda0bd25b4545a0c8c4116a032dcf1803c7d01f80bb68c890982cc1a63d7d6798db62971933a6d107c8a26ae6d25661857782352f89dda1b9a3fd024e8515b0afa83d18df6e390a5a1ac631b0cba93e3557dda510e11191f9470bfede68c38a91af3416dddeb2cd7af0f26074891235fbb8e649085d3c1c64059683d7a2485e03bbb16d24303554db281fd2c6fa8aea2df1052a5e1b69f7cefc0eec3b35caa413290acf51ac0fd56ec3673834a62f7725f0f64a3087c4ce65cf3ec5b63452c11dc8d3ed8628b6e75094a72c9f0b48cfe5f02e209db2ba007ca43dc52e62ca215c636acf84c6a2a718169e11de8f16bea1aaef9a0c8197aef7b8a62875d94c68b5b174adad0ef7e74f4e223e7878d34a08f4be4c1b3d3daec918b65722aa22a7322c56bb54332baefacf88a482187ed815245aa04f94599eb0f3ca4c878451406957b9d513338b74d0d9ecc1e7e7f4382f50995e3cc9d8854b7ac18fbd68b48052bea86924a691c60faddac1d8bf6dc4735f4791919f0860e431bd9a41eb738ac3b0c17507fdd83f8812d4cfa853e70d56dadd8c6281f7c4cc4f061df29d7f2fd7555448cd5dfcd19ce71c54c1ea70b347bbf32a877cd0d83d568cba0c5567dce4d14d4d19852dee23aa0d0a5aebb91aaddd643b213f1ff2460d1a497e6b0bffc788f47ebe122e8b24a0af9385d4466e78e11834c31bc6ed5aee1a7f22d9b19d2476bf2f431d8142d74e3a63c80f762e690f0a8de687baa0775b8f8ce88f38354ab742dfa497094705d2212946db99356317963d5afb247e4fde76922cc9810eef45a50b7b2099aa036d1cc91bb547540b236041fae951ee2fe28d66658f4f3876ca5008852ef5561dba43cda4ee9190d6bb3350568975dceddb42b838c57725c0f3889b275a148bbc61182b48d62d32853439885908c52c0dc44fae5f9608824a08202bf17b265d1e7c83eb6bda978318ab1330490754fef9d9c86c82ffdcf5798754af03880cd688ade6422b873ccb47a1ae2a7c9c5c001a014fd49f5b5a3906407ebddde69e696e594fd4de6ce07fc129c1e7c5bec4ba85887f575fda4e405ab49d8b650fb6299cddcb771ef40fa5cc15ed74f09b101c66d9b7a2f7310c3c7b90d7fd0a7bc4b4e7f7e2cfc4379122a92552e075f56d072405baeacc6f106b7faa55243f89beacece7e65cbec298f89b80cbe653328a4a2db3cd5a1cfa43c7c912a3292c4edc9d0effbfbafda6ad2a3bfe16c8bb0da1d7fbc82b746202f3972bc497a0a754a99864892d04b56c71128b5052dc070b167c6270223cae77963816b067c5f77820d713251ef71571211dd813894b0b85e70844a72f917c8fa78afb1752d3ec85361e00faabec00db42e59de61a57d6cf817f93f505e1f2f139683142e03b11bfdce0e70138b028f7e0e6c7f9cba5c697748991bb9e212fdfdb2a3111064129fe7feed4e9be86106e4101b885db7166e65f0a264e91af938b283f4309761e5841d8dc212bdb4ed144e88265b0696f3d98e4aaecd6152068d15ac840e3c148eed44fb1b0c0f5613f960138d7e6f6b7dc679513da40669db4cdd5f399ce85a8329e25c431d8cf540e512ceb3b1444b6101605d076ecff620071c83454a93703c2aa2149bc7eed0d2dd7f3f90f3c5bc334e60af35e24b47e18cc19fd5bf70409b04c913504d7c2c0d232d64b953de74c9d3613939f1642d116de1ced8703e96117636d80202a8261c4640d071946d59c49d36810a8b251979b4d9831a3533ed1744266322f537b16aac7c5202b609656371c4af41d9a994c3792ec31bd08076f9305aaf0b195a9bb33396d661a34c77e082b36ea5462a520ccb0b74319d777ae2a52eb811f025496399638b3a275d92780b66061d69bf7ba50e4d1371987e58e14f7b520f733dee65f01f6bea4950c1a1d2db1babfaf9df04708d377bc2b9b465505765947529c290b5b9553ea1edd16adb934363e2ddf0e76c1d9c6e295f7c3880f06963f4355abd023875af460c0ec075482f16b49d75319c0960148a47f4ba1c20d52e0ab422f0075f5b28826554faf1f015f132c8a8ba2e657742c2f3a6c639e032ee0bea775a4182e04c6fc45f24d6b292b9effeada28111d81a3b1894b46057e98c058205d1723da08bb3a0e1e805b2cf9cca35ed883f7da0fefefa80e787695900539e6bdd016ea8b8ed7e92a3a9691ec06f7c00deebb789bbb57f482f97cdc0477e80c8bffc076fed46f95b42278cb076032dba769700004ff7b9707fcb9dccc1932545eced90b878e1d6885ff28faa4aff127cd498ffe7658a789cfa94b0afad2f78e18f4956115b86377b93ca0ae1421e4ddaf9187e55a4cf012a3115e83a3cc332f1e1e918e9942c543c5edf8c4b507ed91da6fa5e39b647018e2b7c9935df4521b6d15bac103b623320f2e96b15b7a3000bf10b6e75812e23b40ef54c9efc36ec6c25a010e8c7ced73787ed7c6fe0b713c29530d3bda0ecc73afc4801fc2d4c6c1785e5faef07427cdaed2bbcb28be646583567f51dcfb0f5f5c73406e493de2c4c8cee9fa64f5b26e598241dc93504ec17148cbe53cdab768c0c2d1cf31ad36d3407cf5b8dcaceabfff477bc8b5b71453de4948f5b509787f4707ad98a9dc3a6ff3be27009d125aa1be17fb8bc859f2acdbf6753c8a9bfbdc136f44f51066c78fb5e12cd3a03ec022ce4dcf00ab4d0fe22453ee0efd8144293849fce109d4515c0e4382d88d1420f1bae457d34e79d37b711707b9641ae1bfb9e50caf0c7a059e8bc143a5e0c8b684d8bb9654e61a0b3a7455247e428779918e928d248153a53f0d72cd2909e01c96966218e9a4390af61420d7e354002b304455086669f3ae25d4de160dcc98dbc5b7d8b8a2d63b20662daa57cb796d8a9fcc8392c55f840b138a359f0c2cd55fe2b8a6074b859566a317a38f9b01ca4b5619e6fa96ff157b8381c644c3b22acc126e18d1118588ca52dc36ffb2aaca6f680b75e9dc2c065304b86313cd1695494679f0df2adcfb2d5603ea41362e83ffe24dc3c98d5ab2820b332b179c0f0f528a9390dfa21e0bb763e4fbba38c41e7b356ae5331dd2f73f7dc674af59e5f61828a0e1d7c9eee4ba5d31ebb7297a30b4b59e03fcf6dd3843abe62ae7dda6022570277eef5c4c91884d0a67d122432d48a83bd3b5abf1bfbd99733b4d4d3322e510e418399defd7f956aa64e3f7f52c1833dd8436c81792b4e5188b48eb94d4c7eb4d49dff48737dc27d4928e3897c39c8af4672d54fafb85ba3532a46ee1b28b7fe7dbe4c3dc61fc35b99d37f2632462a4bed3d0c7063c0064cf4fac1a1e185d28dcc216ea7c48fcc76a59ea295a76c3efcc0c035abf096602a25cd937b5d671ef44a5309f0fcff86011fd1243f5273c6bed32d487fce8a4c09a1466b8bdaa69998c9e8cf0336d30a68c6c6860247169a1cd81d3ce10f4da01abb90e7ea984133adbd87ac0c7b5c986dcb7da27d5c8b708a4e4e05d0466bec2ffe3eeec1ccf9186379eb4b721bc285005e380f83f1c6e14570bf9654323fec137e2471b74745c14f7b47e95e1d553773afcc5b6de2836ab13675e1258e25755c5337ead73e5dc4e33e75995e9b7fcf61d96775e1404a074246e8feb33da99dbc83ddd9f89bb5d9abba99ca1429d0fc8a343e3d37d85dc949cac8f61e87e2ce696bb88b731b98b57b320882b9c436fdd8c15f3e3ed87813fee4eb3a47daf01409acdac6fb8ddfc87fc87613df77c2a05882a911ad2386f8c2539f39db426bd8d5e29a9deedcb966787a6238de8a704885bb08c6e54e98054e4408d76128835b7a9b399736c7777e61f6e0b5ee019bfe1ff0d83a3788ddf316fb1a8a9287364515c6d6311880ac37cfb8a93e31ac5784987b829170f46ce25442f1262198a13bd84192c62373e33f7fb6e463b751eca0572397033612a14add97830660ffe3313e36a0ff372d5024594d82e2957f41982b96f8c69c09010425fce222147f6e0062aa427fca1cde7b8da3ae91349be22eb626bd581c6bf260efdc27d109baacd1bdbb32939919c27119d2ddbbc9f4fcb49576037003b66b96bee5840067cf57ffa95fb6f2992c5a95f56cf6190b6ba723c6475c0664c9ad5bfd28f37134c1c53190895300726900bfccd65f0b0cea458210d55077e8d54e54e61afbbca9c8beb361810b9caf539c0fce42f888fc1a42992b7a6f19b38dc66dbc3b41fae34ed529c99b2e983881f44c867ce1cc97e0ed065e932abaa98e4a095340e4571fdb75618f895a1fdc5e9e41a7ffcf9a64918db65c310bd0d71d12b1fbb3fcec1ed38b526d8d211e41e617e115ca3c15067c92295fdf61b955b58c268241bb1e44034cb0ea654aa6da5464f7fd47ed3842a343056041b170d5423a0999d33375860a1929aad1790e1f9b3b4f05b50aeae189d2e018593fe81234fdc51fe75d6366008dd1dd304d6f4d08dbc82cd3955c89ef31ca5b2ddddf4031ff9d8e4298554b11fcf2a65a661717fcfaf4885569758bf6e46c744659c7f97d290fb5b4d0f1b6137dee31f0571db911380c47f6276963efb1675977291202c7f88305c806fe430bfb34c459431b0e5d84b5732e52119ec61f078c0de97cca572fd8a9c87dbe63b126117db338bb7135dd7d3da1e0408e96aea8125ef448e83a410e0cdbc7786ebc8c9fd849ac6ec56989ca5400d7fa6358dd51506650a59cce67592ccc72d596a5afb2628c8489854160b784453f49f70a8689a0da8d68c3868e71adc5fea801c69eb14a5bc0bfd68fa7123a6f6899c5e5c1d66cd8c906ad95dd19c294c582825240185be23a6acad727f32e23a0fd1928328dae7ab4bf32c334890d0b8727f1ea4ab4375902eef3aea91c2a3cf4078ec2b937739685351f03206fea97e21f03c983dd3b4061e9e887ea11cec5c90c5a645932f827e07ab072aaa00d3214803ead9addb3b1daba48f365f59daa079b74d4bc349138b7447d5930c311122320d76f23e06588286ed002146e946098dc8ba8c08d38f94f4024d39b734bd52053e2b61885f15149b4cea6b1d09afbb2fd664da3f5b9151042347f1f56e5ced8902cb4e64352204b5d5540a9c3208a375b7de8906593072622ea5e5ab38c9f7c2596d87268918fb51f14f9a28bc243050ab35451384d51522977d1e53d84927120730bcdce371a2f6b37cab053ce2e69e2642162bced385032e6591914095389c3568391a6118c5a436a81198c69cb5efa02b144931e7f8b66c091684f0b3c2ced5f1c841405c8df06888eaac36a180e246e72d7873ea9326ef42650e50279190e8184338ac7c7cf1998e93b7ed0ca8876e61221b20608948f7201674afdca89b412502b3e577bc76bfc187979dedd6a8616366ddd664f257d698bb05b2ea9951a855f708468c4c73d552fd9125d81a382394147a0a1b534cd4c99fe002f6fd517bddb6156577875968d85ac2c259372a0ea2d9288883ac58c0ef925980a6df5fb33733f6618e89f7c3a0e6ed69591613b027ad5a94026cf535a0206d07db38074a848ad448f639c6992b639d0020542c29e92f896c1cf123c77a04e9862b00f56f4b57924ba8da88754bddb8ce54597182c3345135e356b2c02ea2dc6397e65b8b43fcd6fc728e3ab5d47669dcda31b976ead71cb33c0142060449a8b0f19a2375ab564ccc882556af947788cbab91c8965105b9065f3de6325d0f2f3925c06d1611e2d185ec71fcd1734e968535d712821d4457db91d8e05605eabaccc9aa77030b153437a252ce7e6a47146fdccf33f2e5e97dcb0e63f44bf33bc7de5e40fef29dc45914ff75abc0ed9e761cf1a04bafc187d72085e428f2adc22587ed3bc06e016d2b1c06bbeb0d94b2c25612bbfa6651f4a566d910b8d3571fff53c85e36fc9204e98d187a0715d13b6fa11bb687c4d0a57da73650b19b4cc93e70af7676278f62b31614e52af5ee7af99e23f7e5808dd31a49fd665c09da9b646a657d7a8c4de204b1c244162781e314e3a2ed41ca61a82d723cd233043808ba852b506ae48796d0e9a82530a8b7837b39f031e5e863d6cdbcf84b309b48d67a0233f300e1ff0d97fb346d0f5bdad61d0093a606a4e6b5cab85ffa4d081d609d69708cc0fecce9664d0b1341657b3bd8d392818f58346dd30d9426bec464b4b72b33ebf395cbfb6049d0960081fcc948abdab9d0865ce9755b5b5cc57b02033d917ff0713c27dcb0e5336f1412fd96c120206ce4dd497b6c23ec7214ab9829327a6e4ee136c3b8423c4f98eeb4b26aae31a39b3391f297e0955bbb59474224a534ac59b4d7f529c0c2e75e11b5428cd994f79f41db0030060ce01e97bf3f3131bc1007daeb5e9c845470bf46f78a1324241b37b56c6180bc68304ceb7aaa8682fc3e0ea4314f36d6f837e634312b98f476333f8ebed0ab14357dfd983c102d21bcb7d2af7d40345c667a4a37c2b2c10f50ebe5f12d1c7871f26091db8ea20e577605202b99271773a3cb6bb4731ba1203b7a10ad43f407c663a8cfc1151d3bfabc444f8ff831b5ebdf3cbc2f541900b2997b43191440059bff678594dcee2afc689c9fc7f586d0541a971f6860dc4fbabca11ab553fc443dcbe1aa2eb97762cb1229b585194c814d532e301263f510841e4f7eb806626b5c9b2974bb7299f949a0561ee9373a41ad69aad4b7406db4ae90bdeae8fd32dd082482b34117b3dddc39927d97d3c3eceaab93d66d727bafc7158f8413309c9411a6cf85f369b037a4b25f6f5d708464dd97aaaeba92bc56961be8cd97ac099ee8dbe648b852aa913c002dad18395e5f0a1376d2067180ee7019ed7c4ef646c686eea1d66210ea3df7c3ab6af14d1bbbc2dcc22f5a4623223ba5207e4c8a74133adaaa4a0b2b0acb84b3d52b109c16b9ee6af2539cdd1670fa18146858476a2abdc478188a932725895661489e19ebd90ee58bbb657a0fe0e253c45b60dcf39b110349b0a75ae341660aace5980c1155bbe4f9ed8f222562b2ea30e830a9064e7bb983265f264d9ecdff1358e2028724a3b053156103396ef19441f5f234e893dfd1e39c16b83e33840744ef843d7e7dfb7bfe1863d95febff8bab53087981491a8a728048ed01defb042200753a6512a8ab6a28253510ee102dbf6331ba96da7b514cd55c6a3cb837a26474485083fae6b8773ac15752bb4cd3fd867bcb25a454f70314adddfd55856c3b47afd5f0aef047527b17df0ef181dc31aa5a1dd58c4bc5abb7adbb6375db3aedee61d967df43f598cbb28c3b828dc332a0f465b3c5d73e5ea02cf8f0ce98ac7c0412c3d8e0cc021d175797c8dd08bf4e79debe9464d67ea2408c49b0acc9d0608a817da65ae7bc09b5a36e2f9031eaac8062a9692127c30bdd35b32b503c886f1581fcaa424d1423a22d16413fe188349b717f7ee6bf65efe2b725f8111a3372b9e5b4e62f8988e62265538e0471370d8e41e717bb6f6f4315166dbc2b7281225719b1d33a45ea97dca72972ecff5487f5c48b03fe22b7a72a879ff40f82abca437441f6bc5808366d625873be4251389d3483d4a6ab8e2ab38de6fa7fe333e90d45f3bddcd292766d2c92827cde84b82b6c5a02114974a14898c2c61fb0687c02d291fb967f629872f36587771d251795ca7c68368cbe790c95ea4ef67daf651e3cd97af8424f644cea58db974399979737f7e2f5d5d290a8b0ab18137cfa8ea824f9133da8a461775d7c06353b930b15fa1febe01ece3d00b4b85f6e0fe0d0c54ee7856c9c9bcfaf4a69e7530f6fe44613ae546e811c62c141dcfef8f2fcd7f631343534336b87162daa402e7fde33e67d62dbc8f2a7344b55ffec43aee7dbee5c4d0134608ee48c7278ddf5f73730ece4a126e943f6b79ed69b2290ec7409b5aeaf47bf107f9aa647a2094e3e55ff60e2c774a88535fd371af25a602c5adce5658e9aeccb01b7a5f947c65c028adb336cd92ee5a781ec00807e11b01170d2bcc74fad9634db9a7d675c9ad0d5d3b1e4a82126f3130ee0ee658fa9d2fa1f516d3983e57cba0bf207ca8f512fcbc4004ac68addf2c8abf5ceada4d7d84ff3b63fb158818f42bcd8e9d7e598fa3b2e1a9cc1c308a98cb384fedef85899c1aa0cc3c156d0dd22fac16eb11e95e6febf9cdcd27e5b1e0054dd3a249365952429bac8ac1ee68896f2ac12b5017eec0925a7acfe5abd8957d73eb871ddc740ae1a1b50361c043ddc853a5c01083bb7f262c4b9c9fcb72c2b7b83f373973e5ad45d17e6fa3317914848f5be65fe2e6802f0af1cf21fed570ea92151ead78f16cc7b525ad4dd51b43cbd6d262638971dbb4925f9ebeef77e97a32d055ea56df97430fb87d665c25f088da6ed2c86cd36633c4a22a43cd0f4bd8311be07dab3d14526ff8db73b9ceafb59e24ab7b10979f4b0f4a5c1cdc63bda954822eb0f044b138432ebfef235edf9e648aa6c887ed497a731101d3b1b696d06ed80c8e41f41aec06f27135759dc1a0f8ebaecc89bd4be7efcf77b642b708000313dd9c2943f1380d1d02c68047a7d5e5e7120a4efb0e340bfe0fe7a0fa73fa36fff9faa03a4f3480cd3e9791aeb46f17b7265dc8e2719509b9a836b234ca751d330b3e26c6b9c68d6789e47ad1e3c14fb4ac976c1b65d0245dbe86c77d544559a1018c3665025ad04ab8f50c795060bf4b12a8a9a00df8d5b7e142436a47de3c15705e1eee018896ef61445378a018bb0d60cca2cb510f128b3775b619f4f6d101833441cd5f4cf29511f2c37a57cbfe01360e9a5e6cd9cf53dfd6631778e8c5d98e2ed5a5c454b7b5208ab2b1f30b866ea2130b51b69fd3064338ce40d6eb9bc3c7ac445b3a8cb7f89c8946737634bcbc5702567b3a7eca434649de7e24ee3bb2abbe40846a7f21d8b9e782ac10b769d75b1dea63da9dc659e48724a0231ef901104e6738e5dfac34f113d75291554b011e5c759c41b60616ef21c7514dda380d9c85796e1f33d212f4cdf8408c6dd0144573005596bc2eba83bb6f123fa5a58626e24e807d3641dcbf1beebaf791df7d2062d88085133a1e15a8b9a09f456","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"db2470865aa068691185dcd60d0115ec"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
