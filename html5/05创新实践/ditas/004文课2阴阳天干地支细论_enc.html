<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"f6f9f9802fc90d1efd9e97275899b8e71be2eed16b8543bb96c075066a52efb4ff0ffd78bd8a28934ee0958b92606044e94e7199b790ba613c4a1a904a934ee429fb3ec6fd9f9bffaf6168e618a6bbcfda7cd8f218f02ea670d03adbde6de993cdf28898cd592ac08959d77020fe67d3fa916bae69d7e5cb7c5edbf716b07ae22a962ce597a7c47e5bd08f4418d703c35568b8dd71a96315a754d89d97df5d63f1c039432f1e7b760470475876fd5aee2f4c72e9ef3a881d5d652a4f05abaede4b430cd555681e06e36ca951af04c756fb738c92d0f0ee1e8428385b05b47f0cb61c62527912cee1546451235ba51e1639747bd403d92b595f340b22a196d8a7d98cfe564095506ad94ce837e81b6ad7ba703b6a88a9fee3eda187079cb87cc913f6a04c442825a1afba037b9d8e1ec25520bb53d85780f619ba0b013f264ad0a6e3958d5fc6065f5881be5bf648edff774e788493a70d3d17d00e190706744514043daf098b2e5ced2d479704946a5d759597d0c4fc768858e55abd159e8d776a8b06ca47b67f3c896ce0dcf20673b7fb0c47faf81cb65fa62bb44ce1e782b86fe97e0295044c96948b9705b3883ed45ac7ad0da4b3a1889df729217b7e479df470817939405dbfff884c57ef18870c9c2a7341ee527e461681441b287c835ab58146a1df462e776346e443f1911d3e6aaa8d00e3304beba58d3daae0fdea4f0d24eb550dda6c2c58877328a8e939e904c42e2886af6b135c3b1552b00322f50c956cec5827fc6a8a86ec633153b9fecb581213741de51ddc4ed47741539be5c6140fab6cedb1fef02f4dbed160bef702fa964a5edc058a7362323a6088a334f644f1f8133322ca30c1bc31f419d7e6f45ddc23cfaa12d90c5988820eca0e7b4b3c09f953715afab377c8f980b4b60d6193f7a495522f475c8b9073e4ce4f0c793906a6950de9310532f99d2ceb70e957aab2ad722724822cddaa4b02cb5b2753a2ea66136922266b3dca67577e5641045544a9d9111181579f8b32e7ef112b20881bfe6b1435ce1f997ce4d09aa31c0ce2b0cdb19255bea998b7474f48d790d17a70564db361143ca48455f645d81d112d2a37bd10d17e1d0c578f4cb2d47506e9789cba28d2a9c342fc27309595d5dccd1e95d9078748aed86a23b2dc4bc191ea753f8cc8f8baae9130d0a5d48b54a9c270a07bf003bd3552d2f178e7971d8e4ca5087b69b2e40316e2128991e7a61a4ae84dd722825c031709909ccf9fafd3ea224dc36ce6af91a41cad046038db7198a811984eeb40c3b443b234c5fd91c10e7d871ac6d10400d527cd05d6c5dedc79b9c010cadb668ddca46c6ca10cb124739681723cff7b1b1ac55fa563926822cb876b7df0303b8be5f588e70121d0ee43389969805c375b092ed5bd5b3199b3af9dc08a9114b55654d1019fc100da4a6741fa8d5e7e350e9c9665a54ddac241edf1dd965d4456496fc2ff6c5c6567d0fe33f66e263f54f2792028698e6765aa7801710642df7ac0ba9b34181569b0ccee1c1282a10f58dcad4745fef049f8a46e2b475486cf14f8d2005556e2124c3abb521de5ab1199ec5f9b0ce963fc5de90a5a87409ee343841c9fa5e49fbd2463b6d15cde75138e79258dbd4ffdbbfde4b8a7e9a0f1feb9cfceb23f29d80bd6f6d762de40814403f00504536b7ed4d320a0d9f8084c98f35544debfffac99a9f8bbbf21334249dfbcdfa91868ea51e44ed63be03f4300f4fb95d34593c41686863b20a1cf25fac7b025bb6001e9942a2bc9c997d6c68176f162e3478cc5570a7bd9ef448e7d5e419abbca95b741ca0b936fb689cc0420cc1b5ada6cdc2d732c1702d81c39725bd45ea29e6d312320fa53d0e8481b5eea2f12239a7b6f0b3b1650e1335a05b88b4e1fb0d6849d282f1a40db36ce2133443a78fe365953564335e9d6820b07492d3a8da627e033d415c5f1d90d02afbec75751d331a39fb1922d945e2e2e392d4b6760adf0a20f952e977b9a4ddf297d0ff9289880edd05fb09cce64fba141455adbfa2cd7862fa61976cd2db03d5e558ce1814c9e1ba62634dba007dfc06fa881fbed6610cb5dddf9496da0a2b67dc5227f4b4e78301c865f36fd175829c0c6560f7bd8f803f9da11ab54ddc4e8dffbbaad3ecfc0861d53c45c8a7fcaf24f0070ffa5146953a06d68f7c1dae17a5f3347817e9f966604459e4b82f8d57ea1548ecbf65f862c08546520136a4acc9ef53c0d0760184e7bf7bad2ed37dd3b15c42bfb9b3b9548275f81256425555dd01c64a3b702d575d8364c60359e5e40fbdeff53a74903ccbb79255c9f688818de88fc21aede7083a12e288e9fd94bb0270e26f3bd27be2508acb7a2b28204e36da60e2d84c359b67afad1d32e3b6150b9cf5a4abac8317704f3e265cb5cf4d2cf387009b51fa3cf0a29ca9f0b8e38e87b107cc8e7f7b0566b866bf6bfda59032f28d05cc2d152e02b54b78aa69abc73598b874a374509c961ce6db0847f8ac59bf80d5094d04d3f9428534c603830a25703fe11633f59fbd55aff84876b4dc0e6f49a8a1655718266b57f1fb2889f878dae55f2f90e3ed60af0b8b20d62869f225dab91ffb184ca3b438f59761dc185ea89e297b12cd1354fca993396058c9d9d882230e6823af7ed26bab7295e329bafe9e8ad14621fb4f8e14e9bc123fa6b47cbffe939c551e4a2ea8d25bfb0f3fbe20af8323cf4e89c567c7c8b0f9cad3caf298d6f18d65be62147858ddda95e186ed034777eac626624bc098819a2a5ab00e898c5e8156d83f133fc5c3be91950a837be31d239335138be99cef4604559d778c2745ebe93d25e9ae1072441279243a9ded2442ec0b89d4d12b179a8031a3dea6de162a7a87d32389b8a01bce30d2f2b25fb1ac6fa6b37c5168acf2956ab2b19b488ec70dc086dd7e025458f42fd7dc3f8c15a68dd62948b511f8350d6c1dca0beb4a4ea652af3b7657f7fd46b735713b7dbbb8a61bf2ede321d0011c3a4f187f5495b07023100af55663a1bd70d727938fd8e0fd2c0f9557220e011d07a99ebb6fdb81f5a723f9e57a86ef38c0b158555aabc9dc3766c7fea18283ee54610de1f5678b2cdeba833e5ac34f15ec50c22efd46fe225563c2aab720380360fcf297d05a5286fa5e18587e53b16c88b9342755c4de33f977728d91f99c4c7563e731bfd380b4fac214965c13261aed8293f4a410a06915cea2507ec04f6338fdf62f5907483b74ae2b93c7d4d14f50a5936133265aec7f72194091427e714837775aab9a6829aaad58a9b4ab592ebcd79f4d29be45ac0c3fe2bf7e2ea96f8408a90f5e58f1ef71e06802cae42b4ed21b9dca5cd0654d27a78d15298b12660eb5a625ed0c23bb2754b69054dfc606eb3c1f782d149fad44bbdaa8a894a51804e3ee52dbbe3215df65a072b7ef9a0b23ecc8166648f7ff3a28ac0a9e06e7300b8acf73e8e5a2c20d9b3c0c0eafcc8e119e3e4bfa80d1f5cbefa8aab494e69cbfc8e8ec68f9a559b319403f60b7b35f57d3432a9b376337f5a7d5bbf49074ae1f2960731e6ec202d35ef1b6aa22dd7cc1ca5e9d136fd2965633f4e035d38778dd47ee018df8f20d1ca24aec8989df083270d8037bca3793ac93335f45730b5638dadd58b5cf7f617fdf9f4435658d640a2f0a9aa4dc4c7df11c56a918a31a5a665997446f83e6bd9388e7f68d7884ac47ee0d983f977942a7e6970d2b7fd36c3b768dcb73da88668af76f9fd3d82840b12e51779fcd89dd76f8438cff1ef497537bb44314274b4d9e0b4f3e7868a44aaf9113b904cf226f4b2c99d285d56a2730fd7a2d0c419e926097fc29fb5cdc105e4c220d1ba29c1fad5a3ac21dc2888161a2853b9eb17f678f67d6e3d07ce9f8e4f89b5bca9f6bfa19215ac1828134bf4c65cdde110292a70176f5078bf81ab71ea8d4a5de18ba4504ef3cdd1a8cbe65c79586d3e4b5aded682b70b400b18f2d9e7b5643dc8e8044d30766f1db3046e6e96bcd023a1e756b6df5d2796a235ce553e522c84758a1a6f9d5fb50105ce1c282f2c733f9ee6338cdacbb5686c1602130acfb526fa763036fed3c03e265216fa6baf1977882c5ce9b5280d80ae42199cbb4268214a316c0d2fcc823800ad1b4b6670d692745810653ced54f72fea93312d6aebbc32efa507cd9d8a5a40facaf289b063adefcd0d65535e48cd3c2bb341fbbfdf1cca4d9fbd5dbed500e5b4163ad7cc74025c3ed8fc5ba4735a1d2930021f4458070336e5c1bdcc387d2320f18e6621939b2562e7ddc9bdb307a6e1cb61a16812ac19abb78fdbd2295569b58917ac133430298120fd68ed14321c7c9a3585b404197f5c0b1e727cec5280d48b4c2675e2ce4a11b76b670650429b68ef180c7e851d78d7bcec049f280a88a6908777f2ed8c7d62281532c52bd3e04b2a5dc90487d091660c2473ad5da5bcccebf31485ccda0ad4177006903aa9059868aa7fded04d1636512f6b5653a528fe3b7ab9695992ead5a823cdb1b2b9b5889ea074553c4a862f60d8b830c32c1ba6fcb47ecb0cfb14fe86e146d950f76d0abc2a7ee04c0d58d5cecaca34e1bee54427e2e6267ae36171083687190837c836d56dd7bc017e7615d7c5d1e20ebc7434be19dd18dfd9ab4d3c23c27a77bb3236941525bf83e5c5e3c80417f3eb25ae23a0dad3712117ef5aee6667b237601fcb8b98bb7856032da1e5b57702b9535a80bcec035b128c22cd1018948c3fd3aabe4bf7ac9b3dbb19dcabd765c90f8534702f875201303fb965ec98f859bcdbb219834eba4cf9cc66a33beb1ea2b360f0cc207fedfa46d6d8986b0908f5db8ca714ea25242532f288bf20a5aee451807b58a60a4a7962b6a226df79b01ca5c810f90f2e74d3e3882657aecdffde4f8efdf16bdcef86f7a514865fc2e3b38fc2794fbd6fce1ce7d8e8ce376c0937734ee4f4d582be4b7ec205d47333e5dba8231c9342629f14a6258bcb4ad18f5cc8379b104019aba03dab033b69a411f27230f64211229d69591e661f63f2e736c8340b4240ea75e21a88bde0b8426c227a94d49afcd1c3e4204de7a52f8bb01b15cc3e80c1ce784781e4d47c73887b5df1420cb95d6f166ecb42a48d5f7dbd895ade69e5f747cf46b313b8ec9d519d2b5447c9e5c6c732603e0322d0c818f3ade077f3575b8a37ca2f83e05aaf4630e102cd72afeb319d4be2c1b3b1e8168c0391841a923594c9e19cc4dcaba26fd3eb6d29820e11a45717e4056ba24b01c99fc6339a204eb5a8ba80fb3798176d56eb2da19eaa9fa4e9662f12e62f0d284b30a751a2d9cb68ef15f83f4709574c539f3acad8b93caec33fd57a2f0f4e7f45aa18a89fb46aaa453271115384d2a2d3e9ac6e10ebb0d3d9859ecfe8aafa78d6107bfb50a9c52877de9c5db10ecf209565db056a28bb65933d553f0774741f936d802ff15bda4b878ad1fb048a5253de3d549d1eeb14e39536b0454b8dfdf802a872e2feae61a2c2cc02cbe310ba1d361c26c1f76209b929cbd53e9f87420f2b04832c62c729d8d1da55fc1bfbdb178ba8f516ebbb05aacf643951570e90ca14f9d86ef955f8cf750bd4cd4026343f9c62c8217f3e9648d47e61421d100e1283e7078b6042f6626b9eb2f349838f27ebbfe63bc2540a1d3fb793c427db2ed928513dd2690b3e1d270f8a538cfde55786fd185235f1fa590aef8fb0855485da87433088b3b7889a0a2cb38156594c2fda8e15ad5b7949e1f69a1e01e3d772d1b48d26fca7f025fc48334795ddad1ab1b7d7936f7c6b290181382daa9eae8ed0f8e17aa1927868f490a870d76e11ba98df3988d4ba71520efb5532ef533e65bf5cfda8b8fa5321394f5b6f3afdc883ea6e4cbc9152d6e13f082ffa5f46f7c398eb5d360b71087d1d42bce19d39b89aea6f516ba15af702feec3327763c2b10862f01451366e7ad2ac2815e6667f728afd6f371df624fd9cc0604d76b7299faa098f5e12f9950245f9eea1f219df34f4c85df67bc1f6d344736ab4000519a18e4f30ac1bb3dff1ce52f70ade5ba53407f4a229209549fbc864f3bed2da7591dcdfb63b911673d6fcbce899d6b6a1160ac008adf8e871a31ab548343102c6d68c6ae21a68c259b9d7c234ee954e7c5ae7a62f158cae7dfe4d693dfa5b270d9f435b20c2ef1ad69d66a7257e46e26bf6bcf05c374f5f22da62b9954fb153f76f4bcb693ef34cb73619ad93d9d72ff053b25a15f59e982f14b5e1bd9e0a502f3ca720d9b556412f9a514f032347271a019e25b3ea2933eb1a901da6450ab6b8bb2abb406973423153fee730085c2bf81d591965eacb0035b841f42d724ceaf0bb919b2acc61ae8b0560ada42878b8cf46b526f7e17b1c3a643a8931e1ee23363fc26355dea9b1690ec4f13a46d75f57ef2b162e09161e44b7b9d52db8c682566aa6a1054d75631c795490705bf98607ffa3c58c8a2b3acbc784ac8b557d706be4659c1279b27b35eb86a79f2c63751dd600e3023239f6258a42c3032f338a04e0cbac3e59869597009b23dc326e82ed7d3ef4e3f34ad7cfcaf3d44f3368bc9e7a32cbaf3ec9c4d8f6912badf32158513d86a58c1a0d73a63aff0cdfa2f8efc2f8f88d3046cf46cca1a46548937d045b52b87cb90d3048b123e5b05593a42606348aa1675d232e17734aa3ef6b4271c81ab0a40871fa9d0252b3ebae26fcefcd6a2d037b7ddd7aae48425715b86a8ab34095dff17ce4d4b1df84e51dfba9a14d55d76198fb03fa9fd63bcc4d95de4f6dd0c8502f36f23622929d0ac89416e1fcfc42d43c1cf05d2a00f417b1c188f71e12a9e355e6f05307c7595aacdeb2bbbb91545bc30a4538886d0b5360338df78eb7133a46de5055c9b76e19c28312a482165b267c3930865d089692a5a8443a07e9177d2fab49228b0a16195850c26e7990e3d0b7f1c58e83c8f61c337384fe718bc3adb2c3ac82aafb15d6d525921abd18eef33be29858343091e4aec937e1500f5f8f0d7fa40d3955c7d6d55521908abbc0677cb894fbefc0c23a58f70648d5d334b728bd6bd69fe9dffb27489c53e8603b785bcdaad19f4501f00c4e7ad406369c6bc214fc0a92b8cf958746da59dd9135d1bdbe196b0eb4357a9081e2391aa862e9d57ea07c2a2679b78e5994b4dd24e68ee0e34cb5844d4d2e203c391fa55fedc39f12b55d6459f19f6f29fdf158ddfb09a7565fa2709675852c3b88f40b71d44650f66782d1b8f83e873379f888679723c70f85e7df6b83f42b0a843facc1670004db1be486a802b77d8d669080f96cce2281f7231d9dc5f8ef6e03dc5577b4197a60dc9ff877c671670d94ebe3f235737b7f79885e80d40a48e50f55d2fb2535e61ce025a18c0cdde3495ea81143025741e330b2ee1a54f7b09d3bbbc8a3d7579e71efb9459f0be4898353b1a0e28659650b6eac59bf75c86ef969c0c615306b6d325125085d93eb913f4f6540ac5261b4634284f69d01e63cee45f58cc6b3ab5bec1d44d1a5cacac71a0c557f86926b8d9df2473c89ab66b1594e2ce68884d9fcc72e629776c92c8959bcc24d3a3820e12a422c3d37d436f33514ae822255298da797db4b7af5891ea4f3595b298824ae42bd12163aa0e27ee2888324d2a95a29cbd865a6e7b3c0601aa869bf1a3c1364c5c08a7bcfbf7712302e6379d2f74c81aa40e3cd165ec0f1e287d5398622d937254cb2f8e886fff711ee415964ca6cdbb471d0b45d026d13fc076c8b99f396360af61df84de6d7446ac51e8b4221835fc96ae58ffbd754ea0dea78be99a5f4399754470256e55ef378cfbda0cf972c9fe013420befce4d6490c0c152357147f294d5f8ca267099047d44990b7fa6ccee1e1494489dd95cb626360c99fea72fe01f645fc058257811836699b79481dbb684e61ced8fbd062d987eafdba0a588206963b51c6ec119eaf4380a8352dc8067ddaf58189938c1111c3ad5e57235934a484be4dd5f1aed8206c7c2183f7f19e16f776c3bb5faa868adc601662d17d06f2075124e7d7fb4612fca074db1729e85ef1a25fcbd5bd8e6f2abfac20f9b9f6075863a0cfb82a8130cac1a407833dfc1c7aa28ad5f77848c842e7ff10883910bfcd703855c94c015dcf70d8b3e79b89b76e96e133e252b2dd726ab0b2ec9d79d034eb166f2426ab1401829fa83db60e791237687211f1f83b3f18c6751c1f5181280fca8415bebecc623c73ea7e7ae1afbe0b897ef03a28197843ac7097344b29139326ed37ce5c86ccfa85e5f49c4e545d03dbe5f3398a1232fcfdf6f0da14961561d42218c564e63404c3bbe2ab5115d675c701d8b0e7262169894f317ead8850588b0d77ea3c707a83e654baa13c0ae4df3c66cd7821ee65c5b77e6ebdec76f0294b4f831b1c1007551e32850b10ab4a136f1bd8392e17ea8730d149d1f98679d31024636a6b36b1fddda04431d8d7685436352c211f86498ddf858ed00d6e06ffd6cefd68113e5ce20044b9137f5620197b2a38433a6305790638090c29231af820091ae4e2be00b12bfdaf9f9eef86c020244cf8aac48627c14365a3e7a2d793a63e553156aae006dc74efe9c988c45f3d7a1782f6015295fa43105a44d7a01e66a5148b820fe8ef6b909af952c6073fde5c582872eccc9daf136aa94db78255e7cbef118ba6b66185df5b510080ea18f760fc98db7335cb5619824d03a8b6aab6d19ccb1c43ea5585bcf724f7cfba3aba9596e5314d0104cf469989c7a7f28ee91768ecf05ef821cf03a81a4df010486b22c1387f2aa3a6d427a7c30da55ee86112efee3fd9f2a5b2d0a3b9f2c0af5ced498548a72e53a0bc1a4c50eab8c92a6c1bce96a8ec9c4e15f81efce9e9456421a6654385fd191e87d504e8cca590339cb768b769452846eee92b38701cd6c703ae78cf802acaff9fbac02d43a10bab6629eb5e9b1a3185c9836d2eaf026f5edc98a2d77d0ba1a97e004b3038630de0039050f43cf3beb913bde024fd163c23f4b070499e2baae0b86dfb564ad5725adcda1fefd06b2f93759cc899d2b86ef0165c12835dc35652471709cfd325718be1fd88c714d0ad24ec10d99d1f4092c8ff483670b64f6ebcc24273392fb8a365ae728e55b787cd625785ba67f568e1da38d6664bacae4cb2031108a09ceb8a6db2ba93929a19245f09bdec16899b3857a2aad4e4dcb9b060c9e115644616abce5b282ba03335c647c968ac882e75c264a24800c0502c213b85e4ad3b7a502c951e334a1f02fdddd3a8a08e27158aecc1a30e0c0a0171ec7e28583082e249be3a3758bd73126084fcce6cac8bad3e10486e4d889ca561a9e71f1b75c2407a4142b3b7148d133f1e8e08c78826a6ed2628e5dfe9f5f117951818844b9a8e723f854960dda1a8a848436625a9e7f762dbc34947428e51e784d4d86de7999312840dc6856047321762c85c95fea2cf03f6587e25a25a60955dbd5e05af92aeeb9113fc33e730ee037f96cd9b008aa5b018e1d1526e1b042aaa6b2ae6b8d314fc29a53d629611339ec16ee63dcd6631485f7115bed4a6565d84f8222ed58f331c2d5c291571e423918b33db5e0ee63e97f86cfff1b05c7211e3adebf9791127f6a0145479bb747e582a855b9623bf16fcbafaf481f9825f057161ef9002ebe262eea38f5288b4039b46deaa03493478a33991332924e79c7c105de330c2f32f6dece6dc638f48239e713bd6343c8c43e921724c063142f2f8c5b273e314da1cce7631425e676ea1db104e398c485b9e8f3fb6aa6ce3f84f259a9a7302ddb03ed87567c32e42e1679f97e7760ffb0316fca97365304bee5d7ed0429166d837486b3a95139d7e2077002f15c3026b47b046ccd7e539e36bf8cf008ab5453abe67d32110790d9e97a6a4b6339afa64ba955926a1903d3a5bf04c482b3dee55f729da09d0f6026e201fb9a048c84002bd95c7edb043ca9bae953e31fe7c3abeecff3e573f770f0dfeb23ca84e9f5e76087669dd06dc58bd00ff1e5ba53334121cd7071fd04f9486c0dd00b49783cbe4119e1240aba662c654c50642df425bad99045aed0a9b732ad55bd00d99a068617a048ef0a0c790ebacaa4e409f62edddd6053d4478f409ad10387e3cb767440a3bc1fed24b36209e270e129a8b0dc43282a2ce649a192eadaa1d48bbea2aec945cc64d62535d58b27d20d1b4d3dc1d693ff8b72cd27154328edfa574dc0b60a6ac63e69e499fb899f772eb086bf61fd909da1c5d7625db5d15dbb358df81952400f2d3c07fd6e911a1c4cdf829b5f13c8debc6445853014db17e07b97a03e5acc125c5a8725dfcd00174e6a400e8ff908eab6fac6c5dd3aa4772c544128e73a46389b4776ddf870a80697132e9de1b9564533ee7b8aa12961a3e10e86d06a418c0fd36770509549c7d427fb4d2d1e222c889af88aabe989447f44b525a83b3865ecd37c7bfd52c760da17c898d1e78b19b07ca14d043ceca84a83f37c2c1a92bf23dfc17c7752ca050e3e26c9c3df010087f265acd1024a329b640f82f4ba106d81102069b9671c60e182866a70610a8b7b894bb5e83b0dc4e8bfcab8678e3e66c8ef9ed5b357bbffb0a3d7784ec73e783837748e81a62b61ce77a2f77cb552f6422082c07ce87426efdd6dd4122eddf721c3e5036cd332d442165b6602884e9fb9397aa291047ba799b437449e73febbbbef2dba334025504e9a92ca5fddf934ad5427286bb0f6fc64d91ee0db12efc717c866ef6dda35445011dc754de9200d25f8f49d106f5cb4bd2723a36e8e41188a2ff044f925ccd9f3576ad63afe1257d41a7236c447c757572a8ae94e5a1a2a78e1fddd6ff6d76accbbaa0516259ad2bfd44c62cfa3769f276a9b6cbf9262cfb8d96ec02ec5e3da8f34327c08cbe15bb85f816187cf2aa44e86afdeafc51eeabaac6fbb0a01a05c8a8034487dfa81ef6548260f44883e01af6cd37a6989a51c938b7a69319282c1b6d4b90f4c25b05b8503f8ddd2c9ec49325c0f67622af830c610826597c1679dd35adf223a318736d777092fb0a9ba5fe55754eebe9c7d9dfdeaf664547072b6f097ce0e296c0c7b8980bee3494a1d9aaf4df938d315d2273e73d841550913bb4047ba986dc0bdd96b22717854dbb787ab6e8398e6906ac85a734a144755b41587056b99d19b2a0d94babe562574549c77232b737955d6e31cfb8138e4765c75a523e262c0f82fc793dfa3053f26af2c726c948d205259ed36113cb540f5d70291807d0c7d7ac07753b76c3fb9c752757c0682702b131420464f92142cd9ad2df924ec84bc56958cc89bfe541e2535cf4c1acedfbfe1eb7f900c3e37d391d599ae6da88255337f876dba92275bf3d8467afbdfda73e8ddd361c8b48930385823d98c43755fde70f2a0ec54b451f0127152bf312a7f21e480ec0952f722b8245273415e5df5437307bdaa77247d4bf20865606c9e0290e1fa4a17148756aa91def181d585cabe8883b140251cf337434afff023dc1c094cf288a1169f587a75144bd649da89575e9db44cb2665fc19a802a0f1a615ff0fb9947ef5563648e32bf83a059ae8a47f88b61570c46164e5f04e2c707261839ac5654aa39798edc0c1d2d244a3ea8dda3293385ab64c13a29cc85a6307028da1c1a81938b6b4da4ae170ad131178fb0719679effd868ee546a2118b16fd4adc333aeaa6b892fd8f935fabf2f073ac1b0302b0f8f848899796221dda7e0ca5f580aeba5c2fce0d0a6d5750fc86762c0391da8ed15dfddf2d93bcad8ec01390889be7c420d642cce2c6b1a2a406d34a20592eb73dc5aa229bd3ca5d89e3c6c585566eca1cbdfaf5a7faf9f1033ebd4b8e41ec6df2f3200ede9695a5f8cd344417fda9d299a074ea6cc22dc20092c56f2735cea2329d4bce1f00bec0756c80f05187cd22468e393a239cabe4a9007e1e76bf433cd27d16d42a1e013da63226396b6767a471615987bebc9482bcf62f8705bd43fdbf6d7b0308ffa92d1935e79344ef172db0146988a15d71b6aa4a5533a0ceafb23fa64453e8f152b898e5aeed0868064dd6b9c061bd39d3b7005b6a8ba70779ccc9cc0730aed6cc9bb1f8542e109bfe422ae663d4ad524ce9c188570e51e8460c20df4bea25caec4474ac71bec965e6b2bb02d839f3d680172e8f6d13f6f2ad35e0c158dadf17c74c6989ae353d48816048f0fffd441cf3dc6e40792712da4e2b638ed407b7f5306ce0beb7ef39fb04d62b7ff26b383ec01c4d071e3a96737dcc927cec9981c04d33d625d77439366068c6a2fbce30879638607e24ae9f6284fa627b93d43e839b5fdc4086a80e7fda093d4074809fea44d887b24d388baa234bb143fe81e4e57a592634c36535964661ac967a5688ef5f06e454947b4125e94403692da6743c0bf6f311b6ca7a756aa614a467b4e462e73e5c7627cdaf2629ebdd7470f78befb40741a3730a179e9bc691e0996b330c374f897bca32b68d45477b99b68da73c5e39e2b9bb6a939ddc73dfd9304d83dc8a6c605a01c73cea577f65248977c349ae075e6621510d34c46ce7932fec73cdc75c17d2ea302b58c55cae7e69c65ed5f75e2dc7a89dc7797616d52a15dbcb040350899931ecfadc62d6b8706a64e6e5c91ee27d61256cae80f04cbee157b51f8749fe6c1b055a018f137c5645acf243ce8719bd33bc96de1f4a8d4761fd5d36f93d248708928494e44520f36ce46bdd3802703d69f1d016a13976b15d76759fc13cfdb4b93f734ad739148f90895ab1f3e3168ca24e3ec9e4e58ec20c0a8cc3c61d88eb5a8a6d0c3a945cbd1dbd2218e7334fe735ee266f55169ad8cbae50af7fe2a4e514a0802913b78cdd8778340a1cc15e84275fc4f9a21f0e062da88d297b8d67c74d1069427c88c594b2a24a5278d62163851797313637c5f1a6458306fdf87c53ae7687f8b6e6991b4c5d6a730bf569f20c72a071b699deb11cb2d906b59f342aafec5f70b43abc564681d270da4037bc68659eedd842e07b609cba80234938b9c000724208d529749a0a18a8d125f096de1f544e943ef8e837811f7e0f466dfc9aaffdfce62d4fbba458da63460992d0505be7fb30d86c068d40a442af8864ecba93779d747bc44dcccf7c8d5928b1d3065c5fd65fb51a9de73677ea33a45fbc05f9d928d988550e5aa00f437b3b299e014defbc2990f652808f21d62e990dd14f489d18a36450cf46691dd2bb6a3f33f3e38847b43dc52339dc279ce16b6e081a6fb211eb213a9f784805971405b057bc18a6a16a2dd0e440daae50f5653527f5db5f7f43d66670457dea0732120944e3058427de926c32a02b643cf74d6126100c34c8257d3531ec6ea6a78d39c1ef3abd1862593e4da7041f0c569091a7f692306e4e208697ef581a37e6b70beac2785313043505476d8c5303bc1cb6c46498da4adbbeaa597bcd149a8ae1d118c28fe4ac582a04750855e33fbd750f0eecba63ff9d0f34483ed7539415a7130ac81e77efb406395cff56da054bdf4a6f31987aee032cbd5eea8c14711a438bc0786b7a0e3fddd68e828085bb2b839f0c6cf45cd9f1a7546231430072f12fea766aa4d276ab5bd208eda21e994e125b308ad73b7d272002b396338d2204954396d6d7453a6d3a637b570c3f267b149d18cada8af1e11a305e037dd54d1dc696c1b464fd016832a5ddec8af22283e602b8a578670645856b26d9c0a6e74edaef5189c436a014d741a07fa779e9913528c5042d1f1df4cc760d5d29bd41257b948fd73c7c4bc42709299df547e1caf98c0611f87f7449f91a25440d98b6bf16c1ef8cddd9228aca911268871e4fb36b20d4f7186f1b2bdb040d47f0e6a5a7ab2b7d4994abb381a16882b52e08892f4284d7d351fc28bee6f5ea6df1232346c38f673d07e343945a6802713f688fc3ecabaf920126791214359c17b5747e2d658f64327f47a8cd9385100ee9bbd300acef9db46d6646bbd59285fcef154b8310a57f24b64c60b2692920c3367ec40e81a3ff06541c8a0f891e9d65fe33abb65ddaef7fe261399a85362829f6aadbe766cc4f5989ce0bb6701ed3f7563c5b857b920e469df2855457d18f051557ebd002cd641dfca92ef7e7ccd911bccb96fb96e9d1c1b03c040c0015ab421153d0c18d1a03021976be56c31039735ac8d46826f9af7947514b179e288955bcd5027644b767ae9190d43110928f3deffba3ef2dac57805f3861d6f6f1ad6d8ed1fc33c4cda545a696ab81b85bed68596877776dbdbbff851ff718575930086c1f3fc219b845ff71b77deabc630670a4a8050fcf2cf3868e37629a817c9cfd008f3bfe61a46e625ab124d61b4f1e485f37e6ba93daeac0b5d9252a906dea58e76f42256854bb4dc2bdff6b46c34d1f94d32c19300247ae4347afa17f8fa1816b6759ac0c24f8ae48a249114c9a06a9707e8471c602f153afa5d7c75702d9aeeb3264700114403cb31f900e0e158be57b720d89f80d8866f84daba99b8c76b8cc7f1c6fd155b5905e50cc98a458863964f395af1eb1fcf287eb8a36e2252e3370077bcc88bfc88edd7fecb4792f19397150bfcb7807f95236e98f7e14a5d0695d4c8a9bb80dd57aa182f62e0f511194c4d90a58b160014dc1c5acaea9d5fb57730a8b457590e1265b4dd2c94ba197fe0c3a7816b3ce4ed9a79378bc555e9bb597e7d1458d488c81b37b24b7256894617b934fd0ab86ce850b57095a683d51cef67ea07f469614f53bda960cb4385e6022df90057cfbad97dc37310d6da82c6a9f720b850b7d6f21dd66d7a277568ad9d1b4c5aa95f145763e20ce0b06e9d2af9ebbe1142132194c95b09c2e5326ab1b97c9b92e4f8faec4b923d7525b4881870e32ca1e7ccbf856f1de62fb63deca8dca30c4e7e067288339d8900b028f1feda378ee27fe0570f8bfbef73b55ec5bf4dce12298a14483ffa84b06f48f4d3c43fa2bce144453ddce2c221ca2f64cbc41f9062c2a02e30ca8b186eb7aa4ba71277de5ba94545f284e1457a3e56f0fae61ce578ed79e41f6b81329ff23ed20565685c4ef143dcc2860f5ba2ce2d425e7fb015e60805ec47a7476c9c0ecea20af822c6be1856c70e684a6942359b0db87bfc7b1e53675132a8b9683e6ee6d07567150361a75074c3438fca02f4fcbf0dfee4a7f5acda83002d35eb76a114072888c7bcf287f6b4cc79150346d0445014f2c2239a6c0b1aec6ea97a6910ec6850cf41194df8f51f26753c77eaec6ce43875191580eb0d6ab5e9ec3a63397b7c6a21a212ba064686a1e4abed8ce23c48009fe6c455992ea82512a7673fdf80912ba04b0f1ddc86ecd0e972d56d86d8b4c4655921d6cff2e920c483d47a5f4a05b2737d2b1ee42f45df31f7f26bd77bffdb066c17cb7dddca3c5bdbbc9a40fabc7312ab384bbabed8142725aa652edd3cb23eda443fd18661b1b6c0ca324783fb239d94e0ec41947be31979461281e853a0bdfcc03c47a6e4e90a72e3ce6c5475c8d36264d27c79ea7d96094e166b1f2d512dc7bd4eae83ad4486e1eb46465f0839d9240e37f850b006b29e55bcee6bebb6b806e39de7828d5cddaeb2ea440d03b8aff83e4fbb19276a839ec317070d9e7b80748090ffad6e610371729646908faee9e207129937f993e3bc8f1e11acfb5eb46ff6036d06578c581d130d37951e1d2683a75b66f8d28c7e17aefe0f4e49af553b30d2ab661724f9865547ebc8d560aed349cbb5808839c1ffbd349b003079a77ae44af569a21b331130c572b908fde52ec7ea032c97b1f7a5a77e0f291adc3b3b5b0881c705ccaf5cbcef509d29102d3d107e99281ee86ecc10ed506e2d8098188fd071cc3200e30b4b41a2f1aa31163d2c74d535bd52f37063de007cccbf8fbf68fe230561dd41353a4021637848d53d8cb91bc5c17d3fa6eff5603ff1e6d7876b104a0dbbc1d45a8a8dd43fc75fc479d4c8f3e012ec249831da7db3fac84413f66b1e407b2bb0916d76bbffcc8cfcf168ac464b6f083526e137437315746910a53160f3c60579dd8d4c6afa9137ec0189c98c0b908d4c9f6f54fd05ff3109e775ab84d3a35a6a25903d4d7e8bc8cccc08688b5845bd14cb6a60014855425dad998c26a6ff95fd95eb55a6f0a2aee07b2073f0456814922309a7113e556b19d1a2410f3f65ee5fd755d5a2ac22170e9eff3d73c259adb64b16e6eb715d45b87b7c344e4a22c14010ff50d6b83faf6cbe00a927e723cc6829ecbfc7c248b52a213c6348345d14d6adb8f6a4cee3a50ba5fc260822e8731ab9062e0be0348f19d7ffb513fc5e116c042896aaf24d1d7b2b1449f8149f32b4643759196a2461033e99ce0612ae419a0f531c96b4302165673125a53419c3507ff90ae0191cb2c2fe1df7e822d1f7d7f44c5e97fead1b4ea164dd85c98533bbea7555b065eb4aa2b2bbbf0839f8369a272be9ea5be7825460e75c7d4ec2231a667b9ea773a5ff46c2c1e878637fe199a2b96dc327b549b48e983940dc160b9fabf45a0251b2345802c487addaba82b39fa35a66ad1af47b352ff8ae32127fd085a175a9e6ed5b3ba911ed58977b637f7859a363d8c40a5bdbea2b85dfb398cdeff680228a5bd84058c6927270178881e331a183747f58bd3e8ac305a060d601000eced394c3a0792933bd8a85c38ba1a43b70343407c5945f35f3b6516fe1f38d75d99824e5d663cfa8ff256f889b44f10a98ef03b7ffa729c7cd47a2cb3240cea4b797897563689039688fcac56ca36f85d4f0c93f76729c9c15d8fda1c8de8aa1e4c22d3d21fce6b014b05847213ffd2b63c8db634a5f7486b646408d3dcf5f1aa15c6a5ccd40902b5c3976d8ee53eb13996aa77f16e624e9221f5b29907692332dc0e48393b98aaeb730ad84624ab90f7b92ae8169cfdb9fad337d6d3afd6d58d2514deaaa5d7dabd2e7fb575d52a147defca3865f7a0464e34350c301b85c73d0bbb72fe012945048b790cf8e6ccfd07990b80ce21fe537cece576b4dd5778b16249d8f30cb3e0c893db53dc9ce2936ee386fffde0e07f42dec756a838abc8e1ea00587ec9ffba218c89c065b2c76b80f4d92428db54198716952d2acfa1038455ace970615edacefe49754f7bcc87ab3d9fde97f293d40051d705f95d912cb026f0c6ff44dd121053f7d07d5ea19f92d29ece896c30971a07afa1f42edfb9ef3067ce5ce101a3b041d15f770bb75a9b0aa18ae47b2de1ee3ef27e2d08c87fdd2adbf1abfa096fb44c62cc75c8c352b76a43ea658f1b0b9e03f92ddfa64caf160cc30966d57dc619900273c56448cd1f3657df2245b6325cca3675be2ae3db1a9ed3a2c52827f707efab9d677a3e024050693748c4a4654df15481a77ab7500983b20867e0fdde75bae63ed85a7739b99431e5b7e02ae813a","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"cb4dac17dd2d3b658155eb3f63bb6c40"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
