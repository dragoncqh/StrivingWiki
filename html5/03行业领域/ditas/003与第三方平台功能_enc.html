<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"eb280b62d6adfd8ec43b7e9cb304e7fe4109ca67a6006a104d1464d207e7424eba88f344e66f0dc6983f90d05ae971cd23d19561bcc7a1da740e11090da7525b0ebcd44aaa49af851070e38d5d5a586bbf4181bc23a1ee0bf891ca9399d1a1abad056b0fbf6e4106f022cdf0b676ce770f5e82f26cc699ac12ab4dafb6d0ad440a882ac4632cedb98fd4d80df300496a4e887ad6b0c7fa29e6ce80ea5ab58eaaf12dab3ce51a6c7967d1c1d2c7042773e8fac822d6f4f4b9f0a2abd5e602fc82bbf93c56f9d0b6230028829a38950d72c47781789d6db6ac609bb432940d8cb2ae1972d15938647de7305823cdb299fa4db74fbc0660147eaed99f067551c20bc20bf0342028b374c8a6b8253edf007bf2ba3639b7a72f4a6133e9880ba64e81f3153797e0364769d7aabd84e426254e3ff0502b77600660943fda005af23321a448d4bd0974d857a7a8dcd1ac0bef940e96c310c40723b52db0cbc28a7e3dd68e98ea6ae766c233b8fb635ea1f52de61ea75054ea2cadf4461763b42cccf31a5a258b86e98b45f948306e475f9eedbb27adb7dbc0e7dca5cf0c03e3f43da2a4745bce9b45049234e9a2360114628ff33dcb2d4ce149a24dcda395c72bd6cdd8a1e123ba2ed4c36247b8c999eb3d16edd050fa436caadaa3ff41e5575396c55c76fae19e6c0c1ddf750a391c7c36495233e2e939bd3a49058d2f4b8c3b7667d23b1fd13fabf58db0c450cbfe6409083b33e812bd383156bf2c6908455b7cacb2132803a52c5e4c8a53d7f8282ea14b9eb576805a374d718f82ff3ee97e24d462d59c7499972dd61ff9d42b78f72bad196e1816b5b4b8ded2efa2ea6528b6f856eab3e545a2cb7b797ed1004d9f2d15e4ea9e0e1ca08b5e6b4a696991f5a0807c81382ef50b1c07a4cf8b3a990ab30409e412dbb871656515ec74fb4e5eaa982ee23ae17d71d01c32b5b0a95521f746022c1e030c85e6957f3baf9f7ec5b0d3cc5d4424abbdc6fa6822ab0aa08ed86948601fa8fd0f7ef74f0bbb12edbd012bdd41c7cde83414b0c4a3c36a254d52b09d844f1adebc4442e675e4b85ebc265f9d70403428ebd05d4f821f021847367eb67d9577ebba5811e6287cf1ce5cc3fe3f20a324dc5a1557625e39fdd8d1585ccab361d847a31ad7bf8589cf3f130481674a994d2ec958204aaa727e4db5be254dc0bbbec2c1426021c2905512e738bb9f189af74e6840324ca14a7fb198b786038f370c598ad5d865d3dd9d1d4a6aa688fa2c43bcf918149539e8765b4a8bc20958bdcd0e546550baa20a09d9f196d4cff09977c13cd14d209353b737a71656f7a2eae5c14f9bd7d2666e4bdbff5db3ef5d439b38370667bdeae9d005e20bf20afd600711266fc5626aea596d6e2d2d9763927c2c87231924e62a4438e94a60320a9ba106ab1f254b91c70e73250a096f36c0e9666d985d81d2be3fba8349d3541f637628543d0f4a0f9a049882e6dc22bb0ca46b2d19834a9d9b3ac1e3a3873c835ec72d0cd79d4872a9ddfaa7531b981269aaea91c5d8c4b8b86e2a985a035fecfb4c93bf1a6466cfba52e8a1a41ec877dd7c38ad2a5637cf2bfa19d00d5bfaa8b0b21d326f52ae753154f8d7e307610a0a6dd68e7690badd04ef6713956cecda87277b7bf7a67bb8999dbbb2c509a70d39e69fa7a394963c14ed0bfcc579a4edb96e351d455371ce68d48c6911c424ce0a6be62f6478ccc345a73ad98691bfb91dd445e787a9416dce5f1d677204cae812ee2fd7788d4643cbdc188a69aa368c03f70ba2419363ef00379e51235835a58dc90d8509cdb31a92d51222edb46008e7500f331fa558841e1d7ff2e7267c01e1164a8f98e7b9231ed2fdd2a7cd908ace95e68043312d906d070e78c2d6112e676883a36325ea6d330260812104e20c05aae7706842bf5a5a52642193409e7e2025a01b1dd180b78e7ef7c236f29dec10076377dad390951ec13a844a3a4f48be242dd60a815ca9ca7f84681e2d099bb0ed4c4168f8cf97b9d332fc1588ae817e91c5ced248cf3475815b9f78eca0f289bc3f31ee41c3fc9956b0886fb374ba7b72cd04abefc00338006b02e06c7c148b647dc16822b33dc16be5584a274e34dffc22e05f1cf3d318d34d604fadddec3526abf163e12dc30cf85b160285cd20ac5c40966c73d510644788c663437e6548d64d2eaae2a3f1cc0332046a267c499ca7b2f5c244f88671e4d1b47214464ad2ced5f3c4075a4b0719031c0308b64323691dd025acff8ef5970e421e702d256540996c1392bb6fa1cde24339af94d8df0ff2bee3fe85815652e89c0996fd05f73f5d600291625b6919d8e59bc54a4589688c86bea23400de1e058387d2eea6063af2724f1facf56aab6fae01c687e48e7b617084ac3ea794797ea59da5d03b694e5f4bcb67860d0e524897f3d3d100820f295c6df29184d3dce873d867c8ff68c686229063c1752caf8c5e1de1813dd8ec5fc00a0cb55633eb0e8a9f323321ffb83b53301efde442efd4cbdf594e7c5610c8413c0d268480b5eb539adbdb5b083e452a9b5012056c292c5c3f0185beb147be9fc5df6b046ac4f120c746d02d2e66d63258e13ab050091edc88e2a391309edd64fc7ee15afe8d013b82167e534c55f63606b1c6c6b4004ed798d85ffa047cc0060ff2ab7a42825a7207e0abfe66938d7d6a7e9bcbf60a63c11ae6fabcc798da43eb67e42f92eb0fd8965d25870b785321645e5b0bdff38c3e49b023cd584df31adacfd784794ff2b59807c1f4aba5f7129fc06a669f544a0e4dc018e6eeabb8c6c6db92bd2069fe4fc775e7a553b10506b6d613cb60b0c28ccb651928f09ebee80dcb43dacf85fdcf59c59280734776504ee6e112737ed2badc2a31709504dc6b205ef206789789be0a89625695c8267ce9ff57b66d94c310b791288bd544b5eef7c2ec41b2522e46c082f762faaec0d633ea609ecb0dd5c0afba5bd9c5d76a55fbaf32f660570c856c7362056a1038c63f90165cec99175d4dd63712af49b98c855615c42890c8cbf357b0ef5dab23ceb5bbc28c5fee11e8ed73dcaa129e79e6618ab280d7fbf4a23b07ad9415962cf6e7d1fece1ad116379810fb0ab073838c41521d37ffed96d5f5273abb12b2c2e6c61144877b587ae47db834c1319fa957774fd86b70a17b7547412676905927c5e6f3c9f61f09d99512a342aaf753d1a3706a9e448966e86bac757a7a3e1c665b934ec57a2be6e78c7512915e236dbade20253e49a91f6aa08e218fe6242f4317e12ed9a0893bf04c7a4d6deb966a2e1b5624fe7f719cd19f7e0b2e9be437565ed69f6d5257e4358c388393d77169f2e0d5d7e871d8bf889d4562e643cd3e2f6e5200e3654ebd027b9c7601f83ca6d4e4e83b6f8708f7ce54e083f034c0cebd7e34534161641bb1ae3297e644f6ede1929497806c7476f5d3df0608dcb4bb155c6217ec8c9921e3811b9b78b2bfe88ade2e58c920f9674abc4fda9a428145fd89d8b25ff9b217ddd283bc2a43059f0faf2343063425f612785183f48560d0011410d572f3d7597fa21a1853a345167a5be186deab8765e8632db424a60f6eddd25e4e61442d040bd22836c774830ce4f579fe4529e21f567399291d3be63d2a6d46ecbabcfb07448262ce3bb2b4cf15867a534c18f45886d0b128b157d0e409d894d4689db3e10264a81f26d10c23a27207118445c559290198de95739dbc99e7949c7dbd046bfd3498aef0955ce3699fd04e18db6f5a257e808e6e062524e2c3a038edf53ed2e3f67067cd12cc9a5ac70fef7f8084a5d2787a39d68a49d879b7ccd1e481cf0e2f690b87055dfdd94ab22ac0d79d9ca4d523e566bd7b511b07c345b5d21b1f0166738277c3d249f70cda2e6d420adcc5a6ea6fab2482a7d824f7b8be52f3307230dddc184ef47cd20ec2272b672b5278c48f7860a57b59643060c8f3f362f247b6758fac153ea6c38718458b8f3f07f73415dcdfbde6c930b9b254b726a71e03e14a08ddcdde05596d303681c8684570f502aef532f2668d0de2ced6c7763339d78409400e28d235e53789a356c374ab404b29c4e2523c97f8e5c567095ca392761de7092cd0a4384c9b26380566ef376b7868162dae01c937cf25bafdf27fa500c7a1cc246d355e9b9174ea4bdc2896772113b6bc5035419dbd7fee7916327bda7944521dfa302f2565e38781d8f3533924d9520949498d470543b512a3ae10141e5b97c412fff7b6b7a2b7b52aa6ac8580826a7af3710b4f846d82ac195c89e6b7d4e7edd913546cefdb596658a3830c2654343f557c59d35d9c4cf13ec35b2ba072c1b1e6522dbbfa53fd9678f27606004b8d0c8512bdb9adc887f8d0aeaae4f0f910a31a15e0c0aac5b20f3043078a3a0e13ef7cdc50ff344e9aa56f819f522742e936198f0b1f8b5c982bc521b668bcec85f157385faa765e1f860f03c620769a62fa1ed8dde416366aaa65046723ba8b4cddbc5ec768f509be30f19c9850caddde54632822bb46747b6ff9a6874318cb956be9ce348709429033ff7ca70878ed0825697bce3fe2f334a46c1134825f0cb6eda3ede1b8a5a81aa83a992eb74861e8685dee302052dab89022fddfbc8054b938ad91e3ddd5b27a7ae573e6f908dfd622ad9f49b6fc37d834e72131ee07646cd81a1cc07f5a233f8aaeef81512882342636f03e94a57fef5a194254522fe6be741da753d9a677d788e8f3a8e43ebea4317bfb2a3810e17fa65333e45acd7f978bb693e87bdb2823e19b7244971f851af6c1801165a73f7035cb4b549b8ce3fbd0ec708e871e6a2c39e7ccabf178e32a6c8b292ab49c95972bd237a338c9f3a94d5791f6e0a8260f13f822d899c5d2f007e4683a308de100bb1e801c43ec1759c83162fadc08536847c9c7c10d33916108ed946c2fc795f7d8f17468738a9668c1f68ce1ccd324c0b13bc90eee510552bc34e4a2c596dddabec2d13b1fbacb04662d2058a1f68ee913255a5e0aecd1a714c385b687626ffc3f128ac615407706758275689b0426c533d02365f42f852db21078f87f7d6403818ab6409b70a1ac188855df0272d630206fe854aa1c072a95fa438b89f6cc02b502b06be6f2212ff75f4e06fc23aaeedf7cb55c2ec146797d478ea4a6931fd9bc7a33d5b96c8acd9c5361753b91e53482ef4733cb474ba68b2048ad4ec59c4bbca0de76fd57c1d643c9d4f22c6926e44c179b81831bf58b55ad016a844bf9c9567c950048d3955686bb350c85fda4061e1d5e7487f77f3194fb740cf627a1b9c04aa6898ba2b9d3ace01cf5b26d6c6ec30713313f58206bf4d1c5ed55809e07367b904d9b409000b4d42ebeef09916384ba87f3b0abaa6a13e60c3a1b012aac3c1849691dadb8b2615f15a10bb8ce50091b0d7395e6889a14ea09d302ed5c25e0939190905f998632c62c77a70879e73c3817edf8b4adc64b99b4002b8392c974ffc6bd8458013870f73fded4dfc91c6a2843c3ba408b5eae089141a0629e9712a0dbe04026f8a89e4e082f32bb14b0c6c4540e3d4a3a8560b163f68da03f682b17b4b5a7dda52e821c45aeaa5e93450d29c8b2da4343a9800d764f6c367a905042920ab5f3d63c4540638724fa6909e35725117e1dc2091f82f2b334e1ae434d421e58abc2bbcfa92c07306fd077b68d0fd9c20f735a585c258f2a5eb5ee0f792d3b5f585dff1a2be44361bd004f33f65a1a4ac1bff65578803a4c68638aeb42b6902b88896f5fa1df45f6ef4074d94875755531f3b02947666b75311debf3ed7933663458d561dcd8410dc308d81d0046b675005db2ee00b0c3220742bb835f704a0af77b3c549921afddea672b822a626cf91ff13651579f3c660f46ff599ab55bbdc9328892a06344f654a4352ebc84392c8d6a90be208186f38f661a473838875b426b0d77ee4c5c4293bfcaf7f64797f50be91d6718062277ed122b12eb5e1b618c8882fd64acd35c3021807e0f6a3454d7f8b830a1314b2e32c159eb022ee2d4648b8c21fc4d4344699e579eddaa7fd12c15b3277ec479fccb54d2b11166c97f4c04b22596257aeae63a648a395fc179bbe95e90009f94d24e06db71e2d8b69671f7784a80bc2a04ed76a3cb4aeb1e9c3e7616b82b3455f44638602d772f6ec7ca8b9c63ef4ba7770fbabf00dc6f1af356830535bd106cf8c588ddae8ddc3de8e11af6a27fc722b89cf5dada210adc19e8266020f82dbbfab300a950ad8ec105d3dc9798930f864da981e1a38e18bcd6b4c5ee29e2b106f606a8ad5bde15aa74115c6a49235dd73ec45457dfdefd54ee5e87d43fd971639dd146f0ceff37c8434e0d9244bd151e56c049e0acec8697bc1d528eb5d9b084973348f7b231624698dedd50c466bc1e12ccf6d24cff05a180f47f1201c94ce6046d1fcaa8666669f9b8130567b3e98d8152dbf2b4361c684b1a2d5992fa9aad32676f512f6ce20173d15adf7b3acd320ad59732a7902ecc3d73df4a613fb33d670799ee732e522339acc407f8828fdca28435312db98138266b4880b5e5408d4fb0e8628f665e963c90fe814f8850137da1de283581ced72cf773cbba321ff86bda589e39fadccbce3daeff7c22804065baebbbc3ebfc57ad40e984628f2bc069a410545364b4fe16cf1580d73b912068486faead55ab55147579b72039910214d4c74702ee8ba21212bd80e8b3f0073c68d100d5ff976d05fde1112638beb3549345dd4fc4ac1d25bcb2a759ec085e2824a5de21877af906ae4ef37304a7452411cba64a6f86645a242657967a37a87cbf692d7bed647eca7b90389b0fb0eb8f7f9bc7f03f09c9f6e4589a7c4f3378306fd6ed9195b62cb594ddef067b8dc2f79fe8e73689127c5f6f8c86ddc5ff85706dcf1599a3bdc16bd006b67b9363b67c803deb64dc5fbafd8e41c47af7248ee8bdde50d7e0335b13e1e090adcab73a2af82749eaf3356ee457a05909e7129926c6180b456975faa0b54ffe721fd0c085d74046195da45d7f1b377d210289c094e5c23d136c1ec698783d8bc308f9cae21a35b8fc3a43d4e11ecde08dca7c4419ab1fc07bdcfec2dd3ed521e1e83596d18dc65f583372b365b76b456a38ad1451b1892c87b40466b5aa30b047cdcbd511533fc01f3d0f1b181b09ea3ba1d9c6255bd1c101d056d640a0727132a0aae8ab60cb4fdf8ad0c1defa0cf4907b61b18eceb2833cc5b93551170699be9402a068820f2211d0dfa27f02a90e97040d18cbac4b998c10fc29569f2a746a9c1e2d4753695651d64d69f8de6f2f81130a3088ca53c3efcb7167994f430c3d55c84c8b1b4b23b99176cdb53121105198ed37fc1743bf4707b7851a2257603a116063dc8384d07b27d5247141ffc1811a19114be90c59f9ba217880a0435e7da801b7130a6aa7f8221de265b4451c00dd4fa09d1edd017f74b4412bf7816035aef1a30b3bc39912ad5d4fc51daa46715f81f418c23b76853e6daff2d4b3b3e1fd1a66c1cf5e15fe113243ef6a6765932732405515b78bfedced771307f91763807c62837e572dc25ee0e1cfaddf56b8fc4c99fac6cc0c29a16cac9020c3995e970788d994cfa34c22c7044f428f06271518fe8083238280c8dd25b38051b96b46f873235e1faf9d3dda94f67326415ba3e844376b569232ebb8e4f64f44c4da53b51dae529fe8584c64300abfcb972a7b91263f1f5692d18d161a3269571b9cea1b97338dcef7c00be9f89c5434cb9972dbba3eb97e76a34d629ce07876636d6b5980fc085a8b65e72a30eb0368b2065f23bbc04a6e3e2919e417e2dac3833f1f8fdc2049e3eaf09baa8d64306667bcc60cbd9e0bd2b6e2e779141a4bf99aeb0ebe11945f19f653834c15f36bdd9756b50a41be7b5cc85cd0ddbc12d52e3b47a4976951e0b7cad3f143fb6a7a8f0deb46d1db9bcf716d362b8bf13698242b11c2fa510fee7f25aa6462c7e4921735e2c969bcddd0f31a661c92c079abbb28c739ec1263b0a710d33ba4817e14350a85352258bf22f529c54ec9a26a3f3a34b9a82cbfb0c01652d3ddb0be4670a9014e4ec0198fcdb676b2dd3fc9861c9668f172fca99ac0dfdd2a8286af2f4aba6a630a2cdd2b40da61c91abadb76e0883d15d54d509a8ce2d2a34c2539b7356e47c08d3c74a938ebeac305606e78c63412ca1ea0543a93efa1c94268a25f759a08d78b43a523be02fcd1d9791b4f1e6905ac8f1744e26c4b424b39e46c87734c19961643f03f177c2744c5b05faab4b1630ae247573c02fe82114338571c90eb22e7e95a2f5dfbdb022abf5c082481a8e74b99fd104e6480f67785b1cc144a4d79ad4a09357be4c557be6e4caa3a48c1325e10df46d6b5b9607c8b6b6d31caa4f57521cf5fb98c5a57f2c20c4e4acdda321aa79e4010cc9a3b11df2c959bd80369385003c1be413da63584d4c922bbf4e06ea8da45d35574892aef7edd600582c365bce075142366d5e992df3b39d30e7cc24d6a3f9b4bca9956756fbf5a4616cdf408dbe54c4154ac9678a57269ea0bbbc1461bd41d420345722a6a5dd7272042b26aa22e0150e7216d0144601e32bab85b90c9264d23b01b2de69cae5caa4973da6f5b984b22076a7790c7924a0105936a9ba38b8099e10e1ab832f1f569f1f1357834960d849ef705fa7cad0d88837a17d757efa256f62832cba6989a0f811f4b229c581fc409ed82197349f2ca39417a700d9d7e0bf0b2d2dec974f3f578fce9006f1325feeb2bc6e50712a4a90d908b7835ccffc8a4390d442db82e372b0d7377c7c6ce52233ef532ac88eda7a6c983b8106e70626acfd4134e01cdcc76bb6e0ad61a3aa716927c36cad23f671a65e25ae2ca47afde89e584a1ce2e713cbc13e869906a6578d12c51db0f51f57aec83c9a43f8e2a873e506b7a073465dc941e1dd3b36298ce6b00e4ced8fd6fdaf3a78364b50727ba350b0232e0eb60025d09d1c0a198e18ddab1f49d2447784dc959145c74a14d334ed27b92e87bee1ded2148c7604002387a96aaf88ccc76460df2d0810b4aea50e0dd52519227f3561a59e520dbda59855a331359dbf67f6276b1ad42faaac27eb4e2bc4878bba3715a4fb9e192161530b83a1b2971464410d304f036ddbf6b1e1a2ca4cf184861464cd7ea5738b652e37bf7dc838488d8034cca344ac706d46f012b35f548d36618bcc8387faae15f52d5b132dfb261e6d694aa819b5ac313012deb5d8bb59a0f3ae6114f7fb13c9db1845eefdda3bd0c33aa614fad2e65b49ceede92a90fd8a6a25b2b17a7dced08548ae592475c2e0a678352ef4725b404ad7078ee6c85b2db8a1a3fdcbe2254224aec08359500f08ae015a59e8d15444b272eaceb87f5f10b5451331474843731b85730b2e8ea36b913bd6201837d93246c0643ba5caa6f1ba0d7d46939cb26af3dcf3aeaf7a91b48961b15b21e995e01cb6fabdd00f45d96cb63f0123610b484d9e464be205a2d09c6234c2ea0d6f19dc458dbe50b02ed246e7d99c67259766da1c3a9d53b251eadbcf4f1c77183d0739dfe570cd3a22e8eb9f84993b184cc31c7f4d7561a7501b9e9a461923b5eafca778c600a9333d00435e3bb5e7dba3b3e05092cd6901bf6fd2184ae3f533c859bfebbbd1c2ddb33f567638178ba8d7658f6144d47ad83984c06715d212fed5c625ed343fcc2b319c402f76a2238423ac2621c7fba1619be854605e2e2ae2d614b9eb067da4818198cbb1651e845c6dfd022e6a971dd4c6f7f6c1e8ad2bda50ec7d0d12b4744cfc62bbc40ec006af1ccbf93f591042dc6ed84eae69bb945214ce93766bc4f77cd7132fa36ce281a23a1098e9a23ef8ed948145403dbc01d2c9f823d946bb3b1a9d2e1a064b4bba260e306a90ece7fa06e3c6d99f3735f03272f132e7b010999e67b3370d835d720d1c09b7762661cd68ab5086d591074abc5ac940e5336e1910409ca26304cf28fb75b79c06e21c0873f2b1de442d2ec8e5d8a2a5e754ca673d80ae64198f1a612215ed3d25c3319bac67cf98affdb91bc07d7c50ce13728affa9ffb9df48402425f5b96420d8847bfeb9997f88c255b3e45ff2670d1b9f0baf86e38670b5b3d3ab8632bbbd517a128c612fa8f6e47feea2dc225fec35181c96ef297e4d381e9ac02fa7fb87d13e54ea2ce59c57a23ff5b054fa59c8f2561d41302cf1166d78f8b064381e620c38ff30c5693639e86a6f156ec5b871edfd913d49ab239c1e4431c69363dd254bbbfbc035d49e9356acd4e19f752cca4415f4691d9f03dccdeb48e1c3558cebd4927b976ae169a96763682877eb0b4b58e3d12cea1373f4bb464548fd07582e231b17bc9073421e0a1636d51177fa1792128f304a05c6ca2cd275c2ee49dac790f4ed74c4a95d35f7d71e24034355291274460b705e8cf28817f6ad51b5d6e92bcfd07016aac5866d28547931af45f168717d780e9c36a43bbae3817b66e7913d41c20e8d6a4d172bad772b0fe62321afbe741f32d5a7f3afe95e02d21809b18483557a11558a7f56269205df152d4c14cc61e5a6a2e7fac39525474bd94ed0f45048c6d2ab0d88cec9e759383cea0d691e6f6c53751e3d38b69cdabf091d6f15dbde6e6b74eba0afce3e482a2777314b90599856c910a5f4a41724d41f79861aad01fb7ef25067df4fb09af8e8e2b9533e035e0a1aa92eb2cb24851e7ddb13be797e977872e3c2231572c4cd2506dd3cb6ef45b7d1f899360f1bfbef5cf0d8ede234c75105b18b3ad609b8e9c95f2e48d57c3d287da4b8e76a7dec8abeace54f08d30ccce4ee7a919ae1b10db58a866b8e8be5859bacad8a8d5beac4b876b24bd32c35d4a70fb74d2728f5a7c45fa1264c371ec02cee9a6bca5b0ac7a6fb4ce18cdbbce4b2e117e2e7fbc016b8cb83734cc2f250de77f6867a9f25a2dccfcf302fbcbde1854032d04f4b50ca8ac37b3c0e48b76388d35ff0621c0c44933aa095e039ad75942420aa12c4c9415e8185fcc59ea02fe9f42a6e82426ec4d0546648c8a5668dde2fe239e1461887908938e99afc31a28401da9b327777adab7d55640754937fd592da4311a4f4fa23ad9bc92bf37a7f4dc4b2337cc4e2f1b3008ca05733658db6264eec13510b502b73bc04cc20eda7de1ba7c6409f95e7c102b6dacdcbdad3b4a6e4363f9cb3dd805920690499bcf4562970f1ceaa86de3725c0f4fd652fc635bd58b0f7af3fe75b51123bfced2f8cae729dabc6c431aee5ce4e81afefbec6b75b66aebe57ae2af408dd94c3363934292724d033729494ba3c78207ffad0fe50f2d08ffb4298ef4853ecf957d8ddbc7e586f8bc98c6ea13470288a271575892450a5f33c2c7cdfe095398a45a5edec46e9a2838501a5cba0ea2119f4d0c801c53f3e4534875b3497343569a30cd2f85b782c0a3c87031752fe6718760698adfd6d38779106a8f5dfb8bd0927d1254867edffcbdcf2586df0879a9b0ed857ce728d3cf3e9667a1c5bc36917b0ba62efc0f4f9c8643331ccf53b7c5ee2fd672a190fc190ebb888cbd9541483f1467952310598bd1de5851be796aed28a21a306b3b72cc1aab72484a8fe7b5486cef640393d55e9669fca4a58b8e0ade1f1c46580037a8b93d3fef41facee5493fc8e8303aa7c9a6f13887ab3e03df3588e043fdadb5d80c96e32494ce868b1b15f4b687862380340bb3584efdda08de95f45e292a3a6baedec141c969fa01fdab668cca423078bb6223ef8c192461530ac5715bb9959072189eaf3d41b911cfb5cd44a5e2ef72616460ba759c4dce40ed317813294d51253f01c7b74aa687a6b43b82cebbff7cb49cd5a54bd5b411b779dbce620143c63c1fec35322ccb869d6f15c6ea04d9ebc0afc336601fec8714bf2ecb34b2db28bd3f49e2c4192c455f7a2fd1bab8090d3fb6c94a502d2f391ab022188de15d616d3716619ef2f5c958692ec9d63bb43827c733c885dcdea2a65eafba37aa9fa46b1a585edf86c348a44c770f6b823fedf5caf7da0a2c698b3078fb476f4b0135f953d241ff9559177d5d753e353fd5eb51dfc1035916b3199d6a13aa0b8c26592aa74ea4c265ea50602e2e2f4d9d0a99976d5b2b37e958dacdfdfa922ba447c8c225b9d6ec0100a2adea57159680b3f1e0a7300738a5c21c7ebf3805b91405939932144152ba965634b6397b72cb14c94fee160e1076c89e5c562d193c7e70c0b6530e56910d4eb212525d011262095af2b150ce771d3aa90aab370a04a03f91742cfe85f13fea143451e491a4618cb6b005c957dec8a307cf88ebc0c424af389fa7273c2a50b8d55f4d3e84bfee600e10393f00b03884cb088a6e88af32ed88f36774be38222751af5fe18cbcc2ac02f8eff8c1ad34d57f5ef26e05ca2dbb23abe08cca0bd168c337ce3f06dd688feac9203dcd7a58ba48bebc2ea033d7a7fddbddc675946fca2766255d88e1ab520aaf30a57fd27845cd32d637db5c8dcf0e5ff29e43d2242a1206e1fe18987f021c4db22f3bcafd8a85c4b2ed1c7db065be02e874255a5a6969adcea1e337196a5d23d7bb4676c739e1428bb414e71916da07b151b9531f7af2399d38173b6536cf40d09f246170513161e773f0f8996a725dcdcc80e06ef3f3ddbefd9d63b97b3da17bc7a24a3e8e7f87e52e8bebc056e1257166806de2ac95a219695cd3b77aa8ce91a358ac66b7e80ff127897450b5d6f0220e7b43f920fa93ce278f45083a75ee4522b07c1d86f507ce8e4da231919615bd50cb941b78555e249870f56c71f712a030272367a06d70db5ffcbf8c567ba7081226817e7baff8a3e6f05da22fed7a96023eb59ddfa60c0deb0ef4911093ab71032b55a2c02ad2c166a8e5e2ee91fee1616a5dbe8c5f7b4190db5c336143c52b8586b28d91442abb822d87d801a27b4e064cf41ac24171a114855c24d9832c861ab28efd009827ea38a1800ed3a86f0184f4b772c62630b91f8d44453799d3ed50453ece65531dfe2de065b29353d07a392c049be83032ccfa1366f6c8f9a2df7fbdaaffcc35bb5cac50cf3731b24053311faa692a2a6dbc4f539d8128e9b3db266d8ce559b2fd13c5b621f8fa7ced5e39d310492d9fd866be12c7223e0a7888c4ccbf09cececb176a6c925782c3a573fb3ed87ecf18ec41ef91425801bce4c59c6a8e20bf56aed78bbf33d3638a8676d2619f03daabfb6c8fa180aa5a84bdd2df64d0798351022db037aa91db0398e44deb78fac00959a939d8dbed7dc52524edeffdaf48c17377ab8d2feac8808e2737fc293f5dc1090ac3bcfbf238412c49b865e5456270758d4aec34fb52deaa689f33f6163f808dfd64bfba0f72d7267f8ebcf68d1d9df7aae976c1039df15d478fc5f8ff4de34aaca73a013856c3564a17d88a38e6a559975ea4c2c9db0dac60b3d8135799808dca8fd8a608f8b66b6cbb83c436a40d93eca34ed73aaf6fc0cb14a80bfd6f2c055456b5e274a45288011334b425fb4c6e43155afc83f7347f3681d530c92cef2cc275f02a51aabed0a58817a3392faf5c0c84e8cb41ced154912b7264eb7a7fd2414a45d7604960bc5f976ebf68997c03bf2f311bc492f6a1f472a73f2541d1ffa612b6233b624c97060b737f9fa031334f2034bf2335d343c12e2870527c22fead2d9cc943c93ca75d55248911ae76fd17762a37f4711d5872acd62208b05bbcb4251cd948e028aef466a04ae63cd52806fe8fa842db888d5e7afbc2ea39478a1ff371def5a529e2f12fc46478651389a797cf1914986e302760aa896c47b8fb024f1315d0825bdfac83268d8516916439ade5851646a7de7f038727f171f14c5dc2fa4e6d77bb62942b7c5f0d72f69d16abe631c4a27e6b608bdfaa267b634b48f485d5c3b1f6cb451664acdc9e7c66fd8e5ffe493d0fa05b03c827b288755d1c66494d16bd23af743f1c5d31516f200fe5f7967091d9c8230754a5b96b1a40c2668efdf255d77d07a83bac95e9a6b26bfee26c47513f4c99706d99e15ebbda40dd988648e9290460c16e225290974a8d9c81bc850fe2528711cdd6cf1f2e8964b29634e540fae0e511cff7a462a2627bbba89fc8300dcf27e836cf5fd5bb32b5494ff2466b4e0fa9569c3a71d202e694b7fe9024ee7326c0ed5e6a836a8e22891b03a7a1b9f65fd68297606010fc7b2bb6317f7801fc2612cca2db5f60629d7905f917a52c29c72894901ca01ae3cfdfd1f3101013d6d78fa334912ca24f7a918f337e0591c2814dbd2b8e74ea49dcd232a2cd09fc6fe5e1d504baec15d84d3ce79d34d107aff85322aeb4a7f1b83d2c7ace6ca81bc4446c9480a9e866e762e9bfb518bb5be0d553b0e2f1ea273ac40e5e5b1459921d3aa6622ea8d4c489b82be64c37b67fcce6d1d672876e20b32eaecbb1c65e577568168db4df501a27071fd17be35cdc9ce407637823b9f8552f0d2a8594523111a6d29a88d8416556d0c13d3b40c97b95ef319fa226d205f49a8c25b07eda86f37e5674ae56156997948359002d7636cb8e4bc53b24c478046e0a6e130d25f3dad7395f428dfaee94663f240a354ba9d5e77262439f38a302f798bb81df2e4345e7d826df1c3a6a625fdf6ac6f4bacb31f84b38f31954f7cc84c29616efa5f92e6a5f1a1b4c0c21ba8d2c64d27bc051634503b84b120475165b4a371bc889b69dd0177758fbbbbcd927c800f73677ec9dead14dc57b39662ecab72814f5de13ca17549c482609e0a8f74936ee6cadb431dcb3c4c107843dc522bbea937cb71c539029692ec079307120d2c8b0599931db021a5eb9fc73c98edd181805745b6b2d7a11640184086f518626bea9561e2c9dcdd5e190943e1a7edca3027b845ed7d2019d2370924188c1884758bb0ecaf876d181a2b90144db3230ce235257722335cbadd0245f34f5d8844e149f1142e7ce12b734ff1db4d1de4831d7c397d2908c50757eabcd99a1a68ece81b658b9812ac807216adfb9afe089f55bbbb6c2d70c1b2de68bf5fd224708309691d55797b38a306b673a41187bed8bf2ce5f6fb5f6f996cb6119d9f55c2626cd74b08a22d120ae512746e4a3a35245473f15d6b41b4a71eed66a0f6efdd95b6c9ec745125cea5347e0d18de0bed929cc27b0889f9652ab92ff749be9c16f4bd9eec363a82f310a16e5c4ce3f1479fc266198c31ee56a99c1bba4454c6240ca544f5a2ddf85a4c065f4c8ab3e5a9afd9548c6e28038a8e03cb41cab716666cbf1c0789af41f116d30475ad5dc72d6129184b2873271054b8a8e62adb5a3df06fde640decbc72b0032f4768066a205fe4707c26b97e0cecaf0a881f61df269dfb92c2c617b4a7088b3b21f93d0143174ab34f3423a0603c6923a77f3cd98a026630fd71ab439acdd23cd5b02ae838489d411f01c9fa609bc600f9c8f29e8594b5419a733e4a77620a1705be32e3e6306aa8931438398c73f9aa50deb2e1327fd22c7b219d994c46a7a6f5b0bd07b7014720c853825a01b2c9339d9349ed1e221d8c4533400aa94272828adf30f71ea53984521c11a2332be62fddd19f06443f1c5569c1682721729c5e5bce79e1f9c0add5808f89c316a3118769225602ccd8babfc0e18dd688f9d7cf66166d37eec85f2bece8c2877f40d17c44e168381e9bbd02372dfd8dac671f8b238c2d12bd69cce3452c42c5fa5c3cfb8e8d1935f92cbe7f397133519c062d77568d4506bf6076e96a7a0164e421352794bb15812f3439251002d4ccb840ac003dee923d6f56dacb8aea00b61a5cf6872a59a2971489550d357c68e4d569b28d319a2f84a002a01cce93531c02b7ab455e900008cfb308675c28afecc7dd82dca7b3df1a6813ba38bc80c387d91736b8813a4a6ced8c8f64ea0103c00b67fdb8f76653580a14dc44b7065c32be0052233002c9a29193eba0b15d583f144cb29a5d28028f2e62a1044eaf187a37772e8788cb781424f9ff132958c2949e5a35cabb3a5a7b5d55cd55fdb25b235e5c9c14eb0f8737acc4ccbf630bd112ac1b7a6de907bc512a4612c2c5e01cd39a80715ce471150cfb6b111430b2c2833452c73b7129e499e11cbea5c9de65e88a362e29dd8394808f072e4631dea3748dcf3f028cf5e8be9408a925732fe0ed98b295db1d2209f8335ff781069e5698177c576056144dc793bc4504dc443217188c45edd36a8c163373bcd5c7eaa193b48c6b17b148de9705a6933cad37f64d9c297c16bf0fbf235d1c62fe29b6e74a178db9b7c6412c364603b849d7745b4f2d6df73f6dcdc1f8cefd94da5af52408e05d6f0f51a1d203afe091f90e0e6797cfb416c79cbbbed1169a1b05cc4b33fb07ac84bf6681485d27c6afc7b24aebcad2553b9ced0a75fdbbcae812ae24f5e6e1c57a98f77eb53cc50f1325bdb426d14cb42981de9f3b871aa713a0e9af8c3a1e2918cce860442e4df09c9b4d227c82c58a5063d46a0557d080d9d258b44358f94610538ebab73faf3aafb21312553ab2c1b53945c84da644a45e9758938c50741b2819eaa0194b21c12f215c18210d2661cbb4684d79f9c77422aa5c4b6695d0f8cf3786251297722df8c60b1d735b780b2dc4b137befac20e1e05b30ae6c524cccd6197d5851fd299e63092f621970c7299119dec65f107a17a6688cf31ec7ddd730f07694d0265c7a50b2ef532633f999edcee00648725deef95843bf711a52ea","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"3b65e88fb4aad2a4dfb95b4861d2091a"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
