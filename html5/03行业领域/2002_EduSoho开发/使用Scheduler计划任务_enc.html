<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"e71fc112e979608174c8d4cd28a476e2ec42e76ef2bc3a58b8b4c5163d8663daf6df3fa04032796224d9d9614553667e2658361fb43e8e746733cec813bd9aadf6a375030e58615557fd16b556027a281e62e360bce92b7135c46f506c46d4430f1308045cee53b32d76b6cd55e3216a9b1958eca357846014fc06ea7a2afe77f30faafd23642f58bb2ca25687c49407d9160540d7eb121def060778e37c58ecf72df8f36cdafc427b608c2cbb5b6d6a55c69e8a1fa42e5a57a01e4f36414712c183fb9ec51963c9b7b95c16bdbf3dbdea8c4d67571948e335768f33c91e54e17263b9c61944481d5ef73046883993d8a34aa91d1ecb636295947e32582b4127805b61cc11529d217a3398774eb5fe9ee15703ae72f51c88123987527e6d8c9717b2595beddbf78c9a4a9b0b1a87025e18e8daf4a4224f2de09a578fb8007c55acf0b0ea4e0719f4fd77023254f55d2bfd3d89cdf4bd6ff7912e140e191bd855c44e45ea53bfe8700f91ef82c3d2b033cf7d74d9ed8039edb5a8caaf79e64f78387d386e7b90ce4cbd143013cde1255343e403f0ee45c7f7804a27c7ca6ec7afe1bff03ff3523910b86ea15fea8a3dd28b6832dbed75d22858b1b06fc09867053830a6562e18bbf15443350f24ae40806e501bbb4884c9dc5c92a1646dadc6beb1128fa20a186ed39d1ad861d012e9ba8eae2d5430fd0a3e077391ee9c3dc91b9f40394d6cfa43de7ad71c38e9f527ee9042436870783bc0791b8f08c4885998d1215b665e7538980f5c50f0a5473b34ca19316660f6d7b71cb7e1b56ea01d89170696f5a119f7f249ac4795a1659e114ac595d37d0ab56a20531fb7502aaddfcf435a046f39aaa20650feeb44ca197dce350a8a7227845853a0135d1f8db6033826bf4f5f13d837c9ce9fb54643d22e1dbbadb579fad966ae641cda37ee86f4ad9c7511574572b58f544e0d84d185c19341f6801bb0a74bea6cbd3630c9df90dde0745b1c411b0794a14e18ed9b81cc15fa2021e92215e7261ee095630f9e8880143805bdb08236efa105b409eb26e2b33d2ae98b35bcea5b311d5cb53a911d448bae5cdbf063a8246a4d4de06a8c274a04c9661af7fcb97d2177386e57fa491a7e926fd0bac3c52783e88dca965c46a312d75a4e426ec68c56dd5ef6e71aaafbae07dd6eed1b0d5827448e0b90db3c667aed4b0192f7a0f1fd79e70110e1f2251d71848b91624ab0c355c01eb9c9a9c3255736b605c0608016ad4cc097b647b909ad3b89724f2da09c9089647460b58371d259babcba99e0c075b7b226b812b3269067de1c3fabe6cf64875066439a316965830a413672e5d4eae55f07fc8b507ad9e843eb15348ed31ffb2d8ebedb545a46546c6a6d298ee82293c971183ba3941c7bde199fadd5916943fd8312334624723e42305d260c73692aaae2c3c0f396b31da382befd50000834401843035983b924f50295062e0f9652b6f5fdbf8d4bce261213f84e73ae2a270b2633d1b9bf724f90ff62cc8f5973f35d33656ab20480ecacb71aed1279dee0706a99b77042a5eed14cd7e320cc5f8af1098503bc74e79d7d03dd81310ca58ac8c261028683b30bba62c0ba9b2bf2c87a89457fccce3efaf795fc1b82f2ae1c47f54eb5a7eab2d913162f931115ba72f2f87bf11d30a58a46a6682760a42f99f2855fa8a6a1876c6d1e03d137769da318ede42fa7fd078f8a4f100ad36fbea17c59855b61a83a4de5c988245a1f95195a66d2ef5f2b9e51ec3fa1e97851203642970d27b93ac6548c228e9a8811c01e2b48c12757b8ac0139a88321c52dea85165d02d6b6a3f291d96081125632fa2647828c146a255c54e6def70338e0c6d405bf726b603d2ffa663d31c418ac3021f2cb5e37f70ca85ceffb17d56980f621b9c8f08f35fe0a803ac07df05abe62233c4c92dd9f1f5fa0e576cc1aa2ef579b43edd199c1b67fc312c3fedbe4beaf341bd313b81db6fcafe99ce54ac8c1273ed04723faeb6c95728e581945d23a5776af28e262e81a2335c783b03fb72e5a195e6a5783c7366c3aac17e483a50377da42d3ca5f79caec73cd88b2cbe26442e97f3145546606713ec77a033d33d73ede451b3bbf90164e2fc10667c701800425137f349e732eff03fd0d8c93fcf8319b42ff4a132da8f21e32cccc7666cebc9160d696ba45338b37eacea188c3561fd2d436d8a397f27b8fe5fd2ad222fac968b43774b4ae8480d01fd9cb3f23666ad6a5b5760088dda0ff78897df4034f2a93eb163165ccdf71ef94111b4f57b53de6d81e4a0cb67876ae0575ae6942ff8172051e78c05b34b9c38b4e0829ef42d2b569beff08622c6ca59afcecfbcceb645662c556a6fd45777ce8a212021d78216a62899f110877afd0a29d5c96d8ce183819b9087bcf95e91309e933979727bffee8133f59eb5f2522ca1af7ba5d0a39668916d14f9f164ee4426e42ace29e45fbc7c4d463c6f86db666fe5f97ce07bfd3edcb732c1ad236831f17ddf2fde55d227885bfe8534442ec5da592254a7ec8892683bd34670101656eaf47c7db8789c7bd3ae400cb370244e3888f38f0a8aa24012096c5cc4a20ee413b4980fec0eb1bca8889d7aeac8be72adbcdab02b448978ee1c399a3f9f930c46d33ba070a23111c25a3fe24d171dc0a6afb2e0ab43f0cf1932fab56f4958f2214c0e3fbc097759e68fe61976a3ee1f2c93ddd87cfaaa0d75cab82693a9f0f426f48d60d28ae14f451e012f9ffbdbdd95324a98e63aea13797e3137f022a64e908bf2dc0b9d7f02cb3d875ff69866bc9100054254d480cd18e82290fba444837ffa527a5b21f979f71100f5a673b683dbf12f241c3db1b2f34188ee6bfc6736a061ca7b39ec490182ccc2359605459ccbc403b00ad234b07fb52142557dee884d8fe759ad0d54b7b315f07fde8584e997e1c058793fa06974a3cb4a4323ba396b136da71770121dc2636d6208c41442fe10a6f711ab985dccaf674e0ccc74df7f317786fcec461f556f36113cd2fb84e8447b55f0b1bcfa18766f88d226f554ce6c457f603b05cb1a5118d92d7450ad6c3ae8a026edae0e6efdd60a91ddd046d4b461a1320dd5ed7b84aa0bf70543ef47e56e5a48a24e8ee33f210c91eade8c4bd63b8baef601192cf8a5b68ed5eceb94b8018aa819fd914080ba88de7cd2935272ade9fd64fbbb75d1b6f6c328f1a8a9432b4348095a595cc229a5abe878975e2e84c1adb97e1cf720101c73ac3a40e7eac980737940dfaaec8da62804dccc72c363eb3259d35c83a4d6645894fed94314dcf4cb05c2b2c8504eff0fa56bbd4e0e725c2ecfee1fa701bf99fcb62131dbfd9bb4c5decf36d86d8b1f18e292ae37b2e6e22f2ac96b98f68d9a3924d63d5faf6b6d0a30d74283bb03019234c3779b5fa4120e83d1e24cd7f5084c67da6b35ae6c5031452345cde06b67cf9a498b74b6e8d714d6893e0ac10664dda077b8b479dd3540439dd9eaea4698f4bcc9d5b58789326728cbd2e3cea0d9b08c9525b07b5c64683cc3b9217e39e1ab19c60c571fb87986ad570494b774485942ec13d67e7d83e0118ae6256e384a939c6c3c9a043e508ffef2e647a743cc242f0c7a694510d352f12e08c0412ae7acbb1f227b1bb5368d30e6ae9663a7c65d17ce2f2f13cf5c03f160ed5f0b4ebbabcc06b2029133b4fa3b4cc49c66bd168fa77e412021552e218b4cc487b81989eb75048f1b8d7d7c20185c9d4e8970476db737f7c23705f4cb007f2675347f7d1f9595b09982b483f47d4fc2e1d2fabfe624f40cd5284c1d7bd99854d8801cd4669599c4f96c8f4beaf2afc6c9707f2311bc0841da8de78715f56d158f339db3013ff30010fd1e1a4fd1c2b19def7c91fd7f2d39f093d8a75e4a765103e5d4221785c8b13d12161c9b35e10201e3106e0151c0f330ae0781e932024b6045dfceaec2f5f82bb255a1a9b030f14e7b697219df7537aa4b5646b36602f3911f5ab6513c14d65e620804da19f4d3896fded7359bc2a5c5c7aa6946e1172666e832fd912625238ad055d0293b46e6f36bb62a31d5684a84baa8cf346b5ebbd7ad74b566b2c6da2be310bfab56f6761b32cf842ab6f6d7e3d8b1df099f5299cebc5060abe827893d43efed5b32e9e2aa67390008b0f99a852478b0147d02a28124ab5a9362f6e18725c5748d50f5697a18eeb0e37cb44c1b80777e33871ff7b2c8876be098900b81c5a1d11eed2734161c45b352d60dca553a0069b870c128167914e1411b5363bb2b06014fc69b543a725fcc77fc23a525d47750951d05cf8ffa6d10fb67c0040559a81d68f528eefab8b221bf1ecffd9edc96fb37e438c0413b921147ce8fe08dfaf1ccbcc0e352e53d2f6f4fec8937cc8bb6aea4f093016f903c56b69bc29e1cb502d60cabc3170098756c6b278d3c953ef5312b95238f94b85e220cdec5241d551b3e1f10bcc618840c0d09ff68049d7ead4f15abd13258650ed3df471a76c16218a33856b39e3a7bb8ffca67030ee922dc35f65323defa9790105b3db3d42e66bf6ba6c5cbabe06a26dfbfd5343cc4aabc558381b13dfa798ddbbbcee524e299515f92118e02b2f754bbd433e06b914f2a88051174d4b5ff2e80fbd2e4ed3463676d693f9b6004f7a14d91cb2081767defb16b912933fdf9dd7fd23069df137113c83cbd8985f552bcca13b4f74d2cf0d7f11f4f34bcdb0a4b419fea44281576e2790e873054e865ecf5aff0b7860d57f610c46ac1abd27345e780cf1d0ca48ec052788a817fb891adf545611315aebed0fb27274eca7d00632903d133df479c2e90f1ce273ef8d860315e6a752475ac2745e20f4c6c46700e1518a1067cab38769f49d2ff6c00e5839b30160d33065e642c40c78bf5af1ce131925c45b4fe5c69645d42b4dbdf942900ea00271ca20b5493e560e89685cbcac05b594acbe0c4d5f80f22e415214c693461077c4c3eaddd6c282c5d97afc3f43756733be6c6fe0298d343eed9c2fe661a90317b395569c02d2f5a771f02ec8f89aee3f316821b30013b753aad50da2da2b8cb927183422d5bf0cfa925c3aa60077fc1f1a08f38b0f23212f98824722d782d6b8df1ac658aacd33acc50c4fa332905038ce9570435f67a6294a68c6f99e8e8c2ba8c4ba31690c32505cb8875550d5e89f559a345f1b44e6bc29cb12452bd51ef2d56e4517477a9d61615384504a179d5a833cc0fee394e60a55784550713b2dc57f46282f9432f3736a33f6b3ccd6030d24135fb471d6eddb3f589780e975f62324db89a3143596edd78111f879dc99f8983630ecf7e6a728620e11a8123e27979e839d592cc07e8ea66267a0883afea685a6b6691bb52c53f5ad9ec1573389103be62334c7dbaf1d602fe82aa54355e2ddbbf88e4b221c214efba55d9118b7ca4d7d65afe85453f8133a404b5b1c5c01f9b7b1cf6f7ecb6dd70ac43a84239329ec70e4fb9390ec3519c4e92d590ab88873a240bdf000ab360f07e3da318b47f673cbbc151d75ce30096dade158ad8fb83db1b0f4876ce6f50ff8abc7e6a9a250c395ef03ce437292cbdd0ddf920c767c63df05f9507c732080ee881c2bf8519c9ad2d2bbddd4bdc7ee4c01c6e01baccbd96206c2a3cea943bb176b85341219205ff0aa0783ca9014b88d145271c15079907535249c5924227aef6a9eaea3c9d30981ce25c70872346ee9061dfcc1ff545d1825e967a91e80c88b2f5a77d67722e91e983c79996fae39f03c2d2d9472a3ec68f550d6718ff6763368007268338d2a5a744eda2458aa46eae40fdad7f39bd168b37aaef5cce57ae0c95e74da822277fd446e199efff8b2c0a44ae080736319ec6c6e3ea6d1c00e23f8761b88f5306873d2528fa8b1aa1df9726881c113dbc65af13b4e85dce501800e60c60d098997a8a036f3b4c5d6b543790914d654829599a19ec8c37fa3cf3dcf504bcf488b08478ada90b53ce43363f0a93f36ad2f277a85e33f7a72c6102899b549b8eb6d975623e71d2d0bd2816d70cc5bd98fdfa9f85c213a8127ba16c0f407448b4e12913630da3cf2c6e9607bbf3b738d83af99d3cb7b82a1dcb495d35368216341f0e929d8ad9ce612f4193e9da5f3f9e51306d35be25508aa4cb973b47456d43d8cca71d3a5cbfa81b9522ee1158bbe666bf85e80d99b6c77b37d3edf679c333d062d6b4362256e3ddd03b6d1a754e5be933e6c8592709d17bce4e9de3b4f3172fe8bfe4e143154dc1d986d058f576a3857695265a82fc4e8764deb2fe33ec5542ed765b8b6dd82137cc724b8615dbbbade257be8ba3ea845c740a85771bc46ddcddaa6db41de6cfd4d0b4bb40de98baa402bdd6f678ce69fc77beef6c76d2467e5dd54448a03f5e038fec1e4d38627235877f1b9fb807fca363f6b5657e970d9773a83281ce48522eae1d690627f886109242a5ec14380fb70e5704db2decca4c5150244bff7c71ff12df6dad0d05ca57a3b366a81a6b9908b4abbbc2c1cf2430bc934e4c776b7daa1d7728ba71f0b1b437fb50a37bed6f8cd34482ee3d2f1944dfafe653a0ee2b14f56eb99e7094db995abde1763f1be2244f75fb25130839a07cbf360abfaa158861d0442f697fe4820add5b16021534fcd53b3579e89adc2c7f7bf56f0da3c49a47bed342d234e680650396ef4a0ba71a1281af72ac37fbef8c0d94e12595169b71b46e2b74f6b59e3d0707cb3f7e309f67e4908e5f54b4aed258dd9dc89b5110bafa5162e7427a6977351d1637ffd51676537e9c6ea006e173473be66a669221fff5b7f5947f97930f0c25cd592554781e93668ca24ab25a58b4a7dfa3c85456ab692f05536f4fde61ef8f7eca904c1826af36df1f9e0c716ccaae5ed41ebc6e02a55ce4150ef0c91152e46967c05b6ed651080b2eefef6d4ffce773837329a23eff17d2108866ea9f31879a62a8f12ffe34ec2219ab68dc37c8f710a18c50cba511c279b55b284ae0b62198a2f752525aaaa94b03882bfcaf01aadb608be9e4fbb30b267379569d3e4be3c9dd778885a5c5ec3a5f62f54b190c0a96efc22fb1a019a7ceb9e557e60fd026a288cd143aab2e6e96015894d53b1da3d0977e1e7c36866ab337e91212cb8b4a0a3e3c7f73f6d00ca47c0d796e94f5788965ef33d1a95823325d55713a528a58d58fdebc7b72ba71730ae72da95bc1f1089e10d1ce8a3cf41d0875a7b79c65625b3a078d94f17b06e85dc2eaa9db53c204146ed7ffd199734bc643a9152baee281b178f0c80e85498b0ab18cdf0b6e1828ec0ed7a7c79f36dfec7623e697a8b4c6d3c5b1e10a3430798eec1bb5e8be94ef55a87984fb2a736e0b50f35b9fc40627c87a3ba28b4a4d4fa071a349b9d285e9aaa92dc166b0b8f59db2167cde3fa43b5fa50ebc17465fec0b8262e085018e225b7878d7fe2cfcbb5e2b078e3f7dff5856584eefa7eea0efdb95060d7a747fc9a8212ec84ab89e2da80700c3d5f3f792c0d6337c211fbde8447324eade0012e78b07f0d9063555b0bef4d97ac2a64b1d589669928b63572c5af08db522659e2fbb3bb5c619c912e7012167b1d769a28776477ec9cdfad5b42ea24e5e5037d05ed0ef21745811f38e73a8a9e8f6d9afbba6a15778cc05632b5f9210db1f5312be916f1a8837b6fc4fe663b11f3c04e23dbbbe9220a968e56507d5cee140264c93718ebfa777656889cfe9fd347dac7eec652723276dc856544419a6a6f082e330f30d5433a682119af65a9d8f91f3bf7759005c0631e17fb8bb57c7435419ccec04a3af667a0aabdea308a09c54818ea19068ac399ab8a248f0440f175f26f8e3463c6fa78834c522f882c795f12e9605e9ecb6014ea2bb5d994fdae23e8531aa935294810e4e0b2444475859aff9bb67f210b530cdd39bef28c55a24e3489919426a7c98e4ba401824ed47757b96814310c5ab9082c3eedb6cfe364fc8c2ddca091ff7cc4c55126676aade03c621a3bf9aeb3ae9c855f82e019103ec8b0262a36d5d32622ab787291e62a566d73e3beb7d3f53ce8fd70c81e308feb6b7a71012f959b3bf51bb3ff5ce77b285415d959000dc50a05669a0d2d0bc63990025a9c066031793d57926ceacca2147e2a782a4c993bb6d76979fdd27b2b57ed4c4f28b5528011b545dc2594f62369d5fffee6881c9aae020552cf80212944ae5bb5ce73b61ace88533c88fcf76b90386b3c57c312fdcfff27bab44e7a6ba6209478e5badeb74a757505e4797a3b1411d1814619e0dc787ee47ef2181024ce43e71ee188deb5efe38a6ea9851391e0da15646dc7ea5e03b65a672cd34035aa46a46cc628afad0236a8f340b41b0244c6321fb2bc1ea73cff5ec0648543cde7ac9b61ad89d139d792ae798d76ddf627454c6df2f69ec4562dde1b12830a6f35c15587f19fa10e086f702fb34b8d04ded840d861c0f361181a1d38517ae98aa650d6756e5c4da03bb68b2cb692c6353a5d5b89645160e220fbd9e952ea142b6d656f426e6a6bc53c88e6453dc88b332ce9f1b1097b41b9023cc3c25b2494ef56529645bafae3c5e99ad0814b8889b7912a5acc44e6aa6e0305ea3d379c622bddce19808d344a938b51876fac8151d5ea5a1e6524fa7bafe6792ef329153236737d6b7ab4b49ba676148ce5f932c8edfe468d1b53aa941465135721b462703808443250fca714e5f1634b50df6baa62cd009bbf7986eee0a720c5d49be2ad9a47307d5f7232981e4f2ea7c14bba0e6e52029cb2ffaf8c3cdc3dfbfd79c54859194d99f6f613c8af37f820b8f2c6cdb4d3d8e330cd8305a0714929b1a083e85e55a570cef7f2a92a24762eb8f37888e73538a800dc7b463e8e3c445036396f7fbdd1314b05d670f5c63d9dc860382bdfca4c5a5090a852ecd58efff81bf51d2e41d080a1038245261dea8a04698f45f6f84d8ab4ef2b6e5ab8091085d802734380def89c7a92c651dbefe6d74ed50392e32ca967e7ee0cea9e32ad8ffeaec695556686a9f36f932c24b7e7a48fb109bf385a9fed274d0a89afbd9e02d26aa643eb60c89188fb17521c5365bb5b6f66087dec40071e21b5e9a9e3a1706b688a5c4fba1f6158359af38adb2a10c482082844cb42753af731f665ba6b78114c08eb1a18931eaf257064a2e3d847b119f615bec70469132be32103d72179ce18d507b86fe65ea1cc226735bedfc69dc8ad41b205cb082f3b7e171b51e0fb974e33847ae33dcb7cfbd69d75da178dc78c7934b6a243905c575db3e2d25ced9de47b9989e1b5b9e3b31cd95ca86354b0a923fbd4a2d0e736f0b4511c5aa01938e0e91b1e79a745299b27b959be46d138b7566905d6a3c4b646868be6f79bfe9ed73189179a01ecc898effdec7258c9541e6a4ab1ac2f6a11d1aa9278a6172b52498bfa1cdc9e8ab6b0d10aba58fee19001ff7354c2d37a9875ad57aa676a521ce45c7b9f31e76261f282b0b5f24ef72cb1207ebad2248f6d7a9132340d21e737723b993f5724330f7093f84290ff29f577e898442197a1aa8ee88c0068a85303bb664703c59cd98d7261ee55bf8063d2f61e288a42d27dbaeade1f6ee29da11bc15ea529e60b42db3e74f1389638e68fc83af49e7b9c918e3a9c9fa057e11623bc4d1510b10dea0b57129f2abd712ea9cd1febb209fb4c97093a7fe630bc86144e22729eff6037d6ace62da7b783eff1d8a35228d1d940644fff7f921f5e6f3cd8708f451c9f0a2be05533eda4d3ac3c47f7e347db83f2fe27a1dc50af5aeb53a916ee406965b2e093911c8575fa00f60c904b0c622f11770d607bf6c32a211dcc73dea02ad9812352eb843312a3fdadea90225c993a58695eb35f2969fc27a0c9479db22ad18da0eda37ee8fdfc66001917a32d44817fcad789d9bf27c1707cd0e7de1124f792b6d9281fc9cdaff6dfd613e642956611c2af14460ca7db73436efba7cc33ff02115ac31e79584577fa186e2baa0db87839155cf2e1fb5e3ddec1d780fa2c2af2670d988560675d2b9483d9cbcb7ee192d61b12797949a3a8612f97120999866397bff06550d3faac690262a7f33d7c1799d28f07e02e9cbabe99b47084ffb9676fb7376ef07a9c06dc535cf7ae9a8419dc7583a019710eacfbdef2647da597682fa21bad490715d67880021c922a41637110d1936d3cef38c585adb42546c725af826372ac15935eebfb6659e6d2c84533fb1d12f259a515984423bdbb8e00542616132425722878525b27df2913ec484cf4687cf166ec87875f4bafb39dc62605439876e77c167f046fc9db8f7d5c65699fbe4583e791204a8c9d478611e2e5d034c6ff02e999cc30fa646c1a186b05814cd4d8063c9da384ec806286d0e1547bb2239a12da78ae9d55b35b3b812007899b6f0c8717469cce9817ad88f3b7552cdeb389b8f36ae9d2f69e4502577dcdf9681db9f03e2286de1474eefd671ea9b69ba3c9031aaf2092097b0c2669c1f5c9f7e58e6e756ab94f3ec484f47951d7b94d29c1eebeb9e699dba0aaa4cdbe7259b9043a09d9fb7ef16995c4a4ebeb5a1f2a90304e949ef6e0ec6a80e4d429c69f6f428b7db01086a1c93d32c9b2c4e1cd703a1b029e37af3df20d355723456473ad0db839d5371f402040a494f335cd62b774e8858bddc23fd3a8a086059ad6e01843fda8306007cbca6a4ce26e31973bed28cade1be56c7a46ab00f8e7aba7e7700ac6bef3a1f1f99a7b9796f6540f1d6ad1c2aecaa26b7db4710b27962b65a3ae54d1346f5926e338208b781160e6f69ce3a0fca9d89a5dd274fa595c0d758e76b02fa7a84a10dd9614639fda3eae6ba8166bdc5d660a073d42ff93cabb7403093caf57afc6957ce9f7541b04f0f1379f7276061f66a4806346719a2c8ef65ae48db86a317cfa183fee9f3b763268ceb9646665016dd1b79271be7f37422468f516242f23d0796aaad920570d33478e4a63fbdf077cb7f568df421615a691a9635bf9de10a6dc312a89ed178739a8dc30ae2cee342e07b547f0bc2264a8df5579c937c2fc343da6e2432dc4410dde53904455da05987ce0b21614afcd0cdabebaf4067b5c91e8a09f9980b17ac4a102224b63df84e2fcbd6b14394f3d0cdde2abe93c97044b20de1ed834809a1158c224fa8b340472abefbf648ca6be5eea4880bb0a983672c751aeea56b857968142426bff94fa25958bff784e547f41ebec960537d7315ff96579b9df5446883851141bceed01296e485906b66a165399ace21b981bc2286e894ec183f3d34ab68584cf66ab44fd654d3497eb396d1ada83d274ee027878b5e4a9a17c5180be08d46536eb85145d82572447d25b015c511b8679f36ba5a4b5cb4168dfb98fc61b3369434b32281d488cef03633dbdbc00bcac9cd4f9a6a6cb61fd34d15c48ea613c52054746684ea6da5a318e3ad5b09bba2509bb1a7692dd1af63e3175c2708181283e632826ce1fdacca2697f529cf8dddb6de4f609560f50230fc98ee192d7931845eea5f3fefdd22256ea3395f68100a8aac86b193470da4013c934c52751c57ba75245feb844bb30dde05a655a232738be67fb3ef4d5bf564183b70839ddfad32860e64412f709ba72999bb3d7ae13def64ecbb0752232a5bcf76d0e578b609628b18a4d81fe092e6c28277445c407c95396109cb08ed97cf60fe1200048c1cdccce58486d7ac7b6533d8f2a3b6dda690bcda74cb3d87263f86056fb6e6bfccbedc88975cc1a03a9c4fe7a680e653a8d91eeacb00539ec44f3cebb942a968f1636e6e189404a090262083d0c397e902f1a6b1b2bd4399fea01b0321b33f1c02f2e77fea760e581a504d573bc37fef962de76fc677369d3f40b6d71bab762cb889a6c3851b4573b914d7dcd2f3000dc14cc3dc39004c786f4fbb0b06584b2f2eda7d836074da971f5beb1f131153a98811e1b1c4a9c70e54809c4b34078332cc33799b8f1c17e4144cb4576f250e4a18dbb50ed91f4096739be5bc9281a526fa520b08b62d7a8398ba0922cd7b1b6671b8340f9c9f1908ce0e4d0c8974f08e88a094537ba7840ce62f724f4d0944e021f4dceb0f594772e7c0ac5dd550029e64eb38c37fc4d1193c0b24e4b690cc05902ab7fbe09090c558fd1150344bf3aeb0e1b44e9cd496527d22071c3c4638de984ac1dcb3ce90b6a2eec5e44d2be7ce4029a8854212b241c090faee7442162f2dc126e74ed81675da04d516762d426a9631482c6b5fb2ca7e020408fc74f9358a469c8da257eba1ec8488bf512498494000daa8d15274b7fe6a5b676f1068db864ca6d91166bf7e094ee6b522aea8d13b68f942e5d25dc1fed4007c398afb0f57446af352170eae1072e2d026177a81783da57879257bc90d2bcfd0347800097e097d4df03647383fd2521058ba8f244efd85c5131644e8b7eb51e075cc9d4c6ddbf54d568425ec297e7a4cac053f1cb785743ec1833484385ae133a157caf95a76429d1751471153e1b73076505242bf21f790ef9e86435877a86636428fe7666cd42f71858eb4c26d8cb8fe499a4b63540c86c52ec420cdaebab9ec92a37aa7507c7cdbec197470998fa27e3e28c46bc43a1f5570ea69dc1d11507884d9ab2a1c55bd7a124bef08d0cd49081d94288e889602ec49bedc8114179471da07b60f199151efae0678dd0927ec7a57a5649b5be903306b83426f2e1538ae1eb949b56357f3b220e30d503963990194a47e7a0af719bcafe542ad74a054b152d1a5b365436d8a3b17f3a3844c9566cfa2f11c2b62ccc6e4986533850c3ed872abd58c067b6e5b1149037adcfc23d00e6d708831e4da1e9e67ee9a705cd857f24ab0e5b31c8291e3dde79e4fa735569160b89b3d94405e3e0947c3fbe9dfa0535f0a86676dfe99577050b7e76508930fdb96bba93839836bfc8c7c9b51ef6c401e3ff304304417c8bf81c7378f3ab3d0735591392b0ba87ac78986711c2303927b59e34fd6a227d2172b32e7566a743973090ce802b1ba61b53129370174cff26808fec422daf020899ad545d5a856b28304402a41c2091604751cbe659673b8a327811cca0b5154722692d71067996deda17e4d46e522364167c7e5c268437060aca4d9676a3a89f886f8ed6e3a1c9e1add911c9b140bc8c8abd920c2635ef5440e6ebfbddf30f0374f22f44c23725713155a6790c240d6ef469ee910bb20c84ed36f8675317623bf4c29d014c6fa36d3892f2f5798db1915029dc4aa31c9e31060525b0b7e5065f7a19fac4c147bdd9f930680fb8db58ca27aa06c93680f259ed97476a2723c22522dffcb69c95500f046d21f2e321f292e83e7d4b2715e4041f4f10b15de42ae23789d924114ceaded3621c19990794fd7eea48987f29173ca7751c8595902f16efe4e8667dd0aa94f579953b84b0e3ee57b106078cd747d654af64d425cc31e27d85b5fd3ad755c6e17000befe5d974c14b448492b29d04b89a17be5b9e43a5f534d13846d34bf11a35a17692b580d69319470b1f873bc0f78a92d686f0002795b6be93bb5da9ef17a7f5fd0a3805c9db1a24612535466cd3b83a016a5ddf38ccf2d62bbd11f4403dd16b95f7d93afe410860b5492f7f99bad850dad2bd17282f59f1f866988ace6abbbb2f64dc9c73983058d5631e37a3829c1017053f92c7971ed91ce7cc0bf9ad3f7a207da8dcbe8230b4f108123c1a79564f98ee8f2c902ddfeabf50caf7458958a600cd11cd1677260cc4f543923b1d72271cadad508cab17498a3baab565b78473fd3d3c1d0014614eb7d07750c8fc8a26755e193623268635513318a9ff608d75194dc3d13e0b597a970c488324f6a50e2de9a1f3e02710b597b6e5a45668de28a81b22c97e3bf42af5ba2c13e065d9fc09ba3b2370686d906d9263cc94c8bd2815031a4e3f47a53f5970aa38ed9cd3ea8b29e23c77498215de0ee7871f9fa2c886edec2ac1c9455ab4049a7bcd24f28d37e0da0af9f6fc58d8175da0aa6f1e28f46b49dacdb01c59d9368819b3b3b7bf5428038b543df6889bd41d8d5cea2a201c94383bb9f90446f956a8dd3e2410e483e6a60d480a1257e278d274192612fe6ab2796a5e0c53a258d6ec50d1a20f31de46ccb68440731a7561c285beb3c23102477fc1f4e4e2e9439b1a028fb13f8df30c79a7cf44edf0b6bd7f7318a56d1049548be63fc44cd7007902bc6ee494a2cf34c61d1aaa2c1856dcea9738f538b6957ab89f8b6ec096731d0a68d8c27d8af80b60c277899524288193306d2aa8ea7447cf8abf42a16f1ef1eccb05c1d51607a10586b9277379719cc09aad00fddeddf1f0bd8ce9a7f9e2cd30ac3db92b2305efbceaf837ed13e4088e6ad00fc356f6e6dd44fdb12d755f71ea96bb4d936a6ce95245ab87bdf31e74c487c54728012d7f01b45768fe84b11dc6bd39b6fdbdbf175061cd74b7725d08c76bce7fc301921ca5b203816872a2ced9e72463f9a808032887bf5baf5c36fd79be5abd8927428cd34dd41556f87ad0cbe19c033c077c246aa5eadc67a3dcdff7af31d22fad34a2a302d336d31bb135d3ab25ca837af64e8d7a4b2ae87cebe4ca4c35cd638336dc0f6ec4819e2a1c1f8aa50623cdd04305d70a6c9ae2b04bfb5cf10008dd2b23f2e604a34b2665dfe760a4d971cc832dafd0d88342656f74bbb521e102afd361d7e2695f3ed670b35d70f6c03fb0f8bc879ef052c0894d6251920d3d72a0163d7ebba244bf6b27b57f7f80aa22d2b89d6220ce3294fddd92632781878e544d331c6a889f61f56d5ca73a2a1e5bbe6657118c8be19dc9b2b5970c09f8cb62d02a17429efde7ff110a557a93c53562bc7b5fe1d4c82d9003f40315a4672598706b8f54d16ab4b39a90f5e249d2cc0143f9c584cec1a15cc8bb3c614ccbdcd496de38776f3c4016641972b4c9a6b134b5d4fa0075dae296035eb728529939ed984c871d7308872957549258b878ac5e7a9ec308692b47aea0a229b68ef6b5ec5427cc0284e7a8cc12fffa56a1f3fd588e4e428eb70d2ef5cf5a4355ce4510328e82a0b0fd68f188944d2c044125aca6c2052b16e6792ba279189d8fc895fa76e19a2a0bc07ac442d683ee4bb07a6a3abe253644a00b7dbcd9b63dcc491cc286405e07fd0d0551260436f444fe2c2424ca904dd0a8a40f2c018fed4a869fd8954ac0229d05511f15300948cbd32e2ce5ca46b1334e55d65d75278fc2535c8a435a2e6cf620659f4797d963783af134ec4272606d453fb988cd289830d67f6488a6f8cef63991ca1b19804aa1924a3f882e9f0d87a3e92ed62bb56931c940559f3cade987881a4672db67ba783488e62f468581e0f2c878fd049c80f9ca2a3616bfc1420a4e9c7d05c6ef1c81c7b7a5b34afa8a81ca23b9fc3f241b3ebef29c84aabaaa8f27aaaf2645ccf43d6951c021d4c9af9ad2feca2c84dabf254bbc30d2ebc24a1bdf326df052743d451e3ad5ed2ea91be2d897bd94c08a0543f2a492a8122f42d5a238c0aaca4496d4bb63da03b218f29634e3adc648a1cb463f690f5e32977502bf82ea384ed7dcadc042c04059dc19f71c955c32905dc1fc8e150226cebd8d0a92ec00d299f6352e787ae079507e03b3e17d5aba8f437863244724c5ff00c61f996d5da3e1c99d0cab0f85360e9b6f38eb11c6b689873f0d8b36c8694a28d672a98ebff31483c3a250c59adbdbdc8c1fb290074c519433a409fcf8370aada5c40b666f157ca88dcc21ce1d902bc06576e7c31b9d0d41d711a61528cdf2bc6c6131d06c716374cc5805e12f48778c0620d8a7a8ea04be26f3c340552481d8545a5d600148b7b07ec602e5213642e85f5b7464f8f82ae9f176ced6c793811b68261e28597ab472902fc9cf4b3de2a4a60abd32b70f55f892e5b992bb5383caf2e7443a9227a1f4a15198795939ac1227dad7f1bf2fc0a74bbb8516d8e8eb68542866178785103fea1aa5d8b94eadc623670b5e5ba591cedfdfe459f0a3ccb8738cc9ed6266fc6b42c45ce3eb7273bac09605b39c5c01d462d479a1c9105489ca553e298a74e7f47774723b57f779bba0d9803f77314b00ceffd71272fe948de7c5992d9953d62eb7e63f34b1488f0c049aafc30110c5330eeb9fe6e6d413b8e8de833cde00b5624694fb75afaa2ebdf3cc973d570a071f0f33b6f3b65e6d225a8116d0e4dc520740a76cd61b6a1ef9d970592e8520a4d4ef7b986821f51a1fbc2ffac03415cba882704d25d2fd3af5afd937d2aa3790e28460ffe171a214b0c72a326bcc5434d0c28d236b5f7fa2fe6fdc20c0c239ecb1c98f10b084badb9166f7ae9e9534b45ab3c0c5c2ee9ef5d2cb39271ed7b6a6bdf359d8a768990e8eac253be60b51968af53eebac436976874b55d2ddf7362954995a9a1fb5a8eef89baa6b20b2c5fedb3","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"fe727b3ec2446f3e9140a7a09442f679"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
