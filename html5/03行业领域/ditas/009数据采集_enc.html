<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"063354c196698cfc7b7a34ab2e57ca0e5bbdde7ef18df891e01081ee58fa3ca5ae60ed3615c3b99133be50df9ce0eca40a967fe48a6c7e1c3f180c7d0fb3da050cb8b2cca70502174c0db76f09a30f657120c4e60b3264249a15fd1fecab40ab87ab0ef01022e394f03ae268075e533ede1da4fd15bf84c61512e745c196b82bc233e51634cef6beb295e9e05b0f92b20ccf4601b1077228d6ae90508357fedcf313ee3a2fdcc959a033669a62f426a2d15821fab20a9ac722455bddcfe4e28cda2fcd2253a9a575081e11e980d7b32e12d886b876daf9e807936b913f91a6b7b48da934dcee09e650af4941753b07e13ef3c3b472747965cabdccccac44e53a8ea1bf56d97cdcd9a44ecdccc0cfecbea3473d1230c53a4c503cebc4c10d493bc3cc40f3849d57ef971c50de5bf0ed30e3eab8ede29ace307d7506f9ed82bebb79042158c873197943a8c552c96afee4e1fe7e0f4db30033df3fd6af782c573d7434c56ab42a376219a3456a47268624e1e8ddf0514dc802908e505d59a0aae857250c601c356e4adb0466b57a0e63313429f1fc6db83bd5402326eeaaf26f1655bc106531f90271e29c0ceb83462be53b38e2bb2b0beed3f5b25590bdece4d32ff40d831c7246011f4d696cdbbd882520c1c9b663cdd3cfae483bbf49fd8ce35308e44d301ee09504f9719987a16344dc8cddc45a148c17109115c910c283ce780c0537eb0b6bbdbc293a546371d6c0f010f9e973b79e30e8c7207b37ade57c08a02db415da3731d0f08410897f4e2da56e8da16264b64b9073ae51a1b17a1985517dd9b158ffc3a3bf7ed7b39fc44a8235bffbd57dcf2eb13d3d932d62bf4352e70902603199c343f4667333d58fa3a1d49a553b6394064160eeb0227c57002d171d350ca00e6a6bb0767b478e4233ffc57426cc28b5f0064ae449761d5d16ff99eb755d60382713eaa22c55c214ab219b04a92fc94023d47e20d1889a7e4832b84d63ccec3fb086d7ad9a77b50b9e53ffe9c20f44b9913541eaaf49f2bda770b2369c2088beb0b5dc9d8e430510027a4d55f9e8649b8b2af0876a1d20a4523adfa9259b9ecc46c26a46bb6bac8b1cb085d7020cbb09f120c41271153b10dd317c6fcaf6e5b4ae17dfc368d3664e604afe3ed666cc630ae8589160d2c53a6fca10a22d4c88a3e05eda7e9b6f1ae9711c0855b9a70561e646ef12655cdcabe6978ffffeca7ed9c04ec245f4b90315b0d63083c05653d6939ddf3dbf4024ea536841657453517a9053ab83b3e3532edc9fe41ba56c03527f45c475e1c3783c91d10091186fad69f6acc06de2eb49a6ebfa70d695f48d3e624c14e64ffb1cdf83bd926185797e28182765f0bd90ac79064a47858adc690746af5db7e3e8c5ebd8f9175c288069c633a8c756e629c67c840511c65015317b00904b457896f22a862013e6b0034a2c4d4837a3ab50b1ab58fdfeb0571a9cc5deea24e6233b29b5f19ddd3a5d1f86721933541c21a40d47dbeb7e14ed0e76c2f8121e624e2c96a899bfe613be1f3f3994cf7ac5c1843f9754e79c1a072fce86874c3617ef8f7b44d0a3804a270ea327999f3621ba94fbe4ff3922c3936674c6246a5b52aba59551eb6fc4d97052b9c1dc31b98f5c18a98c612e1e792f70cc7ca8399b160fded76c6284f1710ee149ae81647fdb7e7a6a88b2a58e20afab364de089d56d0007a7aab3bd31abd7015107928215f42a5f0edee4ae95b8c328457fe627c2f2c6bc29aebf7a126c8a5ca9d752108680cf25c0de337103680b56873fc570b056f973a70c20e5449ab6e2d31b7b93ff1aedfeaf6b7f74a5d92214018a60c0a4d56fafa8105fa6faa84f3ca5ae7112214ea7f10153c6be8faebf7fc0373cc82d4fc2125c7c046a297aae94b087e7255633dfabb475177f93acad086cdbf28b141a6310538024480a97fc271977266e410a09bd5c90cf579e68c2528d9df08b842ace686f70bc8fd72cdb79a5df5138f2494044cdcdfc5514529d0a09ce92b2e020faddaa74e10c0093bec1674a77779b0f8e0674f040380bc67183d9e36317b5bc973be39fa91759058a25426237b886fd75ea9f5bba4222cc48eaf73473f3a68cc81b59e37c0dc27b6d6d45a6376ffe09ed6bbf02070b453c968e7ad449ade0d26e5002e46d8e1da690a0026c3ac9b7022d5617a38e6e7e378b2cdebc140712566422563c306a5e0dab065f4f58146b96c6b320b33f0e8d555647f4bcb3fb2f5b280d6f902962947ea32c817c937a9d091d4fa4a39113cac2aefffcd7df2bfea6ba20bc886473b0e00fb681ed7e3e641ad45c5df1a1f7fab61800e87b54ba210d7f0b08c4aa76964446f8221540f915f24369ea03a16377e136f68d75eb94d5effedcdf7752a02dac64b023e70622ef26f7cb3a0d4254bec4e802ed4d0c4a79fec611ebe8748c2c9b7b2efc0df39285b575253bcbe53fb890c487f10f49802282f2fb6b699c8e98a5198a6ef797311fb0538898254a63c71ab6791526d6194d108b31ac8e1fa8da9427c233a8f6a4f965de79bc848699fcf51da34434242ca937960545d19b8a945d895b1a2569953ed06d50f432ef91a566df87e97611266ad1002cdcbc1322d7b6e0678ff1f39839ec688dfc55e5e82b16a1661aafeefe59c6ee2484dd6b34949179f014ddac5c98e6de7401c6807b739038e5d754f0700ed1b6ab83deb7c568db329e998905eb8044ff0d188f5288b582b31a14daed9e7eb1650ff9e6bb1c755d73858dd536448790a95e5d3161466332f7ac1173bf493fa87b2e0dd49836ac9abdd1b3c50ac60807d1dbb51aa955136cdd1423ef16fa216b8fe2225f94d2b6e84367cb28f72e0269936fa76c9e8c4a2af21618a28e4aa5991aee636756b21b66bed082c648419068f899a552daf0e692c940a11c1ec721256b850eacbfd1d39ad3a177f9e71d81e9b3278a527a2adab16d03c4e117b21435080027405f2005b268dba2ca667200552dedadc985876c466e1094fa818124e0b2f82e6617146f8f932a51c2ba6b1f1e7a633d23a838539e0c58ff820b0f4321dedb9fcd2aa49048e60a2e042c3d3f1fbcd06f6d85cd2bf32edfb8e7fba206a764e3e22c1668d2c8981706afe5cb8415afeb52cee916e3f3b265c26d3141e3cc7299373e07a7cdaa234da2b2d7501f517ca87cc03517e444f3c6d2e51efdc4288ce3b3a2dc08b98bc93c2b75dfdacbff2a4aea579d5e20b07e368780370b363aa53d8b096340b97fc3a6b5609d62fd36f1114e2fbb4dce9f21cee65d0ea23c246e7a6dc37185d91bed4269a7eeb3be62aabfa2ac39f555e5ee675cff04f817253dd03aa69d55077002116cd60e0a214a3969a1093c3dca130beea1e2809ad9681faa6814c180cd20df115ed786bfa896d4ccc74a207a384f43975ab3aae6e933281ccf077cac46dac0f28e85ade683c5a0f530ea9d461e3729e577aef403304bc39bb566a4dad21ab0450fa4d718659a8bc94de972703164745d3ca414192d6448b8fa1ca5e2aefd0d4b3f9bcfaf9f7bbfbefcfd17cdc897585c2f56869bf1c110752f177dfed3a57f4349bca294dbc7115825f211fe719adc9dce66469b71ddc0b15cd893f23d0811f3551dd3222674507ef1fad140ee2201a9439c4a87c53ea8dba9968afc23032471d3750ff8695af86acee1a32c86616d8317852fab3aea08506d7632645b87ea07ac6b2f132bc2e29768a8c0115e63595f1b56746379cbc800132bf0d46130357371f4f07230cd193c693403bc4b3b1e00604f43cac63eaba7f394db379490af5823e9fc5a02ff256a3977ed7a2dd947956ac496ae4386cdafa4d3cda5cb9a57724563b60b7343b74a379106e4b215efac3e83ae871342a030f8d87edb4544d0eda9f315dc9b3928f37fcfd1218aa0f20e0706cf38ef7e69faa8b0fe22208643d07b342210d94cd53edf13ccdb30d773627d29ca998b2fc54fb8331c8169b75cb7e57d0cfc48f92b6f95b863b48f6e7e1c2e6e35cd19fdc6a9fe55c023121f19486f1e81bfb475187943f41982a96486a3475a76bca97cc5bd14e77d10b5ffc08acc09e46a02a1b1e5c985266c36e6e95ddd3c9b834a4c7e61a676f9413b67b99e02e61bdd712018631c9e38c8f5b715799a887a8ba4bb0ae69e9d24a0192d61839c70e57a72d901dcaf65e52cf22d501b1697d55e80117e3015ffc7e2eb9d2e54235adc52cd3c568455ecbb252f7955d14cebded6a5fcc46bfe32bd7f10b99f85d27d2f5cb4d5f4838e07bd81c362c2fe15139feed3234f7d3dc79c22d5984cb4e128daeb80093ccdab5ef5909bb3adf510d5e7dd9b7180be54e56d272c594083185429194f925eec04dcc6c315577935a8d9d2559b2a2bd724192651a352e61a743467f6cd1a3e2c1303fd8786d3db2a6eb69b248bba6b6f7760c036d11450fc64cc7e20e8b69d05d2b9a55b5c56403ae9acbfb46cc223e54f623bc3b386b93de2a28501438ef8f90565a7b6875cbc9aa0eba75adf982fae944d5f7d1c49cdfe1ded847b71b34d8f34c64fcee5e2dee90f0e93419093b10532af45dd042809ef51660431657494dbc638fbe913af976a69766d744886ec24b5a80bb6423cc3ea23c252ca232e87b4879e538e8da379a1fa8a4f2c154bac7fedd61a165b053c06dc86d97794616da65eec6a186e9bad52a956b9b2544a194fe450693b40da8de8d8d94ac075712ff77db2a2cc4827e6516b2dddccfb69276959e8004f2691b7707b0c9633084fde6d1d440c71bf00547f2231a8d376dd6c5598e4c5d282f0479d5d53552925b2261be8b072967813744ccf2797bf902e094ef74169204c87e9129b83b6c09e3777d2d391db254503458682f847d9f20a614028e21de403163eec5920b5ae349359b59503f50c2a47817f60c1dad771d975f6620a69a06a6c21e31669fe3b1fc817523ccbfee4da72f2c9893e5c2813bcef0778602e45a986601a56d4522df980d1cdc1d807d9794e5d0220ca781e084e7204940ee682a7c3ad8cca8d0df32930511c109e74dd3616313b489a13fb9e273d96ec30cdc3b7e53ebebebc83f4292e42c1deaa31a2f9fba36c0455c70b8e3ccef3987bf3b58f67e88920944f409683f15597b40782577702b0aff0f7dad3ed4e31cc97fcf414c292f93f6868b6aca24a6b0062f387038b8a126ad69e824ab93ea3d0ec1b8c545d249260263f15a01fe25309c2d7269da251e822a2b250b446440807845aed63defc9e8c3963bf6082b1f38d56ef72d1aa1d354d342250da50b95b6ea6de6fc057b927ed2844abda23a430520fb43116bbeb886d0e4b8c511053979caf71129d2fc7f6a31338e6d6363dbd59d7355d72f4dd8f9f23c613c38b0a73e8374154c59674a4e817b52799f24dddbcb71ee67c6ca1f2c78b9ff36b50ea70698f438b4393f2944cc297d0410fe4b8380e72a2ece2885c18382c1245a9dfd923a4a808612a6d4fbfb278efda96584f0e9b63a51155ec26924752f730127dc79d0c5287d6e3207f8aea94b74ab7bae1ddf021b88d141617f92216c6399fe0071fbe30a47c76914ef22a713a4485b62f4e598d4b7ec7dcd929a5f8e49ea95631742b056574ae322cf10d727acd378817d92645e2a4af3c4e1087e68ebcfb9f6a9b2b1a5670ea93c899c0ab57382440c1af7c38dc0eb601cb5895fdc48316b5681aa814b32e262cbeaac981b59d6b58f444e4829652d5ce2dc1444793deec6effb8a7d0f9803af4acd51f781000df9b86374bb34739d2027404429dd95d21dc054110edbb34ca1ffedbb7ab398cbbc500cd0cc9b55bad4801073dba124b1cae76bb35a62cf8914317fa4b93768798b32ebf6bf3ab7b42cd71fc8eae3be4daebff58f9aeab009d0f8740a3c24f2643390142da7b79670e2d8373d35d6f26c1d4610ee97e5ac595b4ede879cf86be9ab4c37a7db9eb35019d7833ca60944c255985f115e683552841d28b0a1b242ddfeba406ca737434136723560f026d034888832919a53168c9ca7f232fb2b24d49c0aa9c5d542db0d7d671dac711b1a3e92adb1c41a905e7a40fd3480fcda46664a635311162695b4aa74ede6129e52bd97bb6d68cac0f7197ab5d3db26709768e7b197c02ef90b148e167263177ebe84c1e6dea7a47b434bea1425ad415e4c2127163ffcd3f48f4dc510a31370810a6009c6203d8aafcd0d21c291723e4bf586a4282dd71590bec464e9ed9e1a6fdd223f36b83f9c409bf5f5bec9e88cdb349b5643415afb937e4a15407b7827889e26c88fc5fab4fe0bad8676ae1f3f38c540369a14e79f520b145a9095cde1762bfa86b718e68b958934d41a20b01d856c07fd938ae87e730c3c6553ae26add487b29aab6806465421044156773dcba1e3995fa72f08d601db18315c435aac6609093c419fa6a6d342a5c5c45df298b28f7482e3bda267d7ad9361a23b2cad1085c6ba85521e02e3164a847c80edca9f2d32d7d639843fdece2fe24ab54f4c2a83f4704ada2b88c17de31682e4e76784197b69e79074e3f494e2f3a0003805ca6da97f67abee45fe3cbd2d3187c54ffcc1161eabc9dd6505782628ae3533645d662bfcd7c1e3aa85efdb8aa66119657e218bd919ddfe99a97da832f1126c472b13b5c0aa5eaa67ee7af9cd7afca12dff81cfae9b8423a2dd6bc225fb99725021ca9436660e240ccca98abe3d8fc3065749b8dbe8bc8a5908bef166cabb40a7256f43de91652e4635d9a024719438c354b965ab1a58e35e5ebec357b5a1e466666d00b6b7a66535423f196f9a3f45c8bc15620e0c0dfd0cd77bf3fabb0e1256ea5bbb43632e91f6bde3c8eee14ed08a8fa672a2cb166c04a26b904a9935050448f1edbfc8c3cc037e53d89a04c820cff4c877d053161e5f98860a47eb2f95733d481abf1c8b3cd1237ef274586c22a47d25776b94fb2d8e980d502756a7877b7820be40cc2f34634a3d41f7725706f7e42d41ba586a0787b80de28e471cadfd6096be4550b7037f70339ca18a477ade1f7e8ae72ad0e3bc978608ddbdb6a5f0ef6979fa1a0741afccde41414e7a4ae54b1f571ca47f2f74a1803ee1bd08fbaa0323874abbe2969ace7bdd9a090006a1a97cf5500920940fe09b481b3ea78b8038eaa5798d9465996d500bc9330ccfbaaa313c80cd7ea453368e5ac211edcb5457e5212eab5428664b5750eeb39880155e1a79371f87f5393e956a7890292f12bbd25129941a22fc093aa1e1ca702eb9fe216f3dc1874a6250bdb22b7a6f1eb9b9494c4e89cd120d4e25e4f56bb6c8956ef675999f752c90ace1e27eb388fc112ba1b6ae38359567b9114127811d2f8dfd325e851a3fa15b34c8b24b630134ec36d6e334719095d7afbb24614c493d3c0e497b1b3d3d6ce48a4bb19d443ca9b8130ee799eb1a5fb2c3b2aa51acc9c9c820f89aed6de00eea01ffdd4b9e5693cb3f3e4d262af9a239fa657f7dfb4c2a4df961f2dbc93390580849e31fbd55c54e91158ac993c0f6b04536d876968ae1f35a4232800501f910e528d24df9c6f42673e5365a8a9353c435ec6244f78f37fb00259b804619812743fae7e6dcc53225e6cc1a07b167722734ac2f2c3b8e8414f5fe5512a724de4e627223d839f3b0e79831d913b718c9950c3e2ef5d2e7cd039f05360648cafc202eb4cdac4be598fff75bf05c34295b8cf2b83dca29c02c08775eb0358ed3ff60855a3029ed98a879da16b9dce25061a5cb113a91f9da2cf824cef969c120a8a73057d080ce8c76123bdbd0e83e08be1662859c73cbfd6c5c57295e96c2b07d39a6040a902b728f18a7fd915b924a4557ad25d8b02c87de6bb401f5b0e52bf21c4f902634326fc69b9932f23844612a4aa94363a51073bfc37bf84f0bd5ba56e71ff418cc00a3cf5c222b6a696981edacab49c986ebb72803bf3b69983be3acc4b1efb709fd0b39269f80486acfed938fb273d4a936e82174e2773112239ab3abde326ac36ede448fdfb4e28d0d2a2104884ec79dfc248f93bbf87436599c3d01f17ee834cea6f17dff324a8b043ca0d0b5f97db39d99d6d452a2dc874f7d4898fa9777ba0269121164453c13c837de2ef9351b518e3acb0c14ad77639a8a83f9de499af43a49464a07d02c19f3126bc304cd36ca5821019bfade9d9ec200c41260047c40767eba2fcc69ed6d18b3ade5697c9dc86578b8333d5f1a482bea911bbf3f19bf2a08fa93501fdcf2348a214fbcc9ef669d1ef4929ba2d66024db75eb2b8c4b73edaa41b05bb0454d6e3e0e9fde6b59a612e876c70119681f79d1c09f8685ccbc655e74e8c25ac1e28fcc6feedbb8cf8997ea9b1c0f7ab1f18bdf6c6bf6278b65c821b191f7c76130b6a1da356c91fa1751482856b40dd0039d46e508e0606e309e4ce0e0edc59b6c2f17cb418136e2aa007444a3a957a3adc1955ae05965db6138ca117876dac742dad5c1b5e9566e822330d3ae253e35587e3252b73e3c075733bb67fcf9e87c8f5f25bdb1d0d05f8499a617e76d0f61b1f0663ee947321b1088cafae4c747c5b156c5ee65c3881a15b6d5ee197bfecd965b6ae5b628b8af93d10dedba1d0bf3cc5423cfcfd7ce3766db40e4566866447030456feaf5694f2a71019b3e4dec2dd7dc1aed6c7273d60e6e22b73d9eacf835bd2d2442af3470ab2b1cd01b14c43f20ae3a820c82bc3688c5cf8745f129144ce59692ee04700b96c77ea7bcb9725f8a24ce71ba4146c4e11df63b05e61c976d4e43faf47acb72f04229321a5438cf629067b19c3060b17e7e79dc9336ce4d6d36f91ef7e3004bcab9fce2f87dcb18df44f00d65965aaf4ae628bc765ac4410f932c1a29beda44aa198cb165e8977ab25539e76786c33bad5b2fc699cfe3f14ec7b498bdb88697d79e6bd231f80fd45bf90c1f458597a54117b5cc3c1c9d59e15c778388dfb45d7df619abf302b8da4a033ac2b6a980b599418c43d792519db72d2a3329f626f4ef81dfb7dd103b042604c70365e5f558e2d506c9b9640c682d7e09bbfccbbf7472b811f083476ac8d1d971b8ec2d60efd24be34a0219b1a8e728c598107fafe8c31b0617309945b87202e4bed8977d72c034ffad0dc8ef79b313eaa8d64256e07aa6a571c7d807b733ae5c8247dec09223d13724e6e79f2e3a4bbd52f05052987dbf7bde9431178a3042f0f8754a823714f7fa4ead08569856cf2445a7d44f660e4b9e6e49d41f0c2b3651e30956cfa78ca76c010f02b75669324acc3820c2e7081143fac1bb5fa48e20aeb7babc2a867399b4c3614f4d59f85ea929e3bab6ac68dbd36762c86761fd503d74232791c4dd6fa6a3e2fb46a0c5d8f7694e2b0824d04fe8111f8008b51713215651e8e5b7e93c23491120dcae415b9525eb3f9c86b9ccd4bc3dd5a7c4210ba2d3552a61645024c0b043837e9e9690b84e8bc32f7b90a94eb9826107d350b2659578612a177e562f0df55468d4164af075aba6b2a8a07ebcc83c4f23baff2659d0ef6c35fe3a3a89766d04ed2291e25257e6d863e85bd0b2d0458737d54d9da6873d7d4b1b5949c6f407a36b2b0ff3b14fbb21b62eda0dd8ff819e8c2b45f820c2e1d00b51b4df5bd7ef96b29f38e768dfe06677bf2d124d824fc976ea7a77d6fc2f281e4ce2ffd80976d776e85fdd21f586d01ae27d652d9c586fd2bd0b831bbdaa1f3e6f86d44619a15e0eda822e512f28fea9edf5ab71e84561e22ed3139b816ad6626eea551aeaa0c32c4f523ba6933b120d627d4c293cf3df9fa58473390a6b626f0c8985e6578a841fd22e53a9f84dbf8eedf5c095287e4251799c2b4d2722a9398d569812ebcfb2fe37332d938b8f97bdc4efb09aaf67248cee6b82ea7ff3d73c445cfd9ea6292cff3bcc8556a7b3a29f82a1d7913b8545eb854c578859484f3d0d63b012396361e947d2b82b96d2a79f0237ce744202ccaf2dee76b6b36fa98066c747f2a158be62a93ad0f50fd64c37e9b7fd0920f24f0963bd57d05cc5fb27f5ef1b84aa8b460648e765ab795d6948f892ce9f08f4c93cd1d7860d64535cc31fa9f9a4fbc9a7436cb780d27781b5da53c17334d12228c0400dfa0105cd5858a9bae499ca254a5ab46521b05cee279e2a963a4552d73b4e9ba7597cfe3ea4b9e0c3d315d84249e9e3542e224e1d85363aa7b8a661cba398a079318bd25eac2e9af2902316c5f4332a7805d41edb802fce73bbb3624ff1e363c970c6d992a83831340831823cbb2600599772e42bf517ce55d8b1e2adaf13248d09e4911a745b32a6ac265c5b13062386d11e70f8a9dbd4ad30b003093c4888b1827517039b62aed6ff7b2fcfd24c009d9bf9fcb5f8fc637194e2365d7f6e7e0d33271b0f775707cc16e7c8d0617d346295435ffd3ce1f331175a79dc42aad3c9276fdac4c1b4a0998357e608dead356d5b4b66a8230c22eca082899f914b21cbc4ef1b66cdcef09906a9ac90fde02148eb38bd8e8ac993e85cc3c242b231814d22815732d69e0b9efab7ed46af974cc92fb70249b244431c5c93ef2e05e420fafbd01072bb1530e7f800933026b4a33e8fd03354fd208f8daa5c460f9a630dd0ea92135cae7b527807feb88d1457b8c3b7fd1959358c85ce3e3022553b47ac42d5a8343fcb4728181f80e7106a48bb6763a4eba3e664d997a0dbcd7d6532e75f5dc420005f1fcfba36403e19803e97678a7c35caa406bf3bd8b1f5da2497ef7c1df87b52683c245b45ea042a65f273f800b1372ff83855e48837ceed1522198c5dbdb9ebc062b17c1ab26138ffd26a055455447323d076a1fcabb0a2520ccdd0ed264dde2365dcfb80b0a3e69c781182dfeccae3c27d828866964e4b483e651fec9cb0ad112dd4c8717701c41bf8e34dde2bb9fd114aa408098bf8b62320663e0f98199fcf29ac301694b6d21d633eb53909ad04589abdc48fde426d4cd9b0060b2fa3146f6167b61656a3bc8a1026459acfd5d0d6a99a60cc0e5ce3d42b25c3755a71087414796184291116838cb65d30577eb35663fb69f62dedea77448a6ad329a40cfc4397d5c1eb901675457b75fbd522b99e1b8035806a147b4c96de68de6d0788c7686819b3d0e10009550c2b1c053588fccffe7a89a427f3b9d80bfec53c47fdfed3df377127290e798ec68728618d919aeabac5668e0b07569e431ed6afa498da6d35e541baf94f8fc1f35ce0328ac7355a177dc4ea46aa52377d9e5aaaf4bbe1e18ff78579012c1461a7e0530a1fb5cc7dfe944e787305339f6532f8f10dd1c31c061d58248e186e53f78a501c838c673554455e7465ad8238c90c432094eb7bcf5cff25461a5de7a1016c9a2448cd99b012fe636c0f40aab1e659f13fbb9c3a70afdc38d9331ea0b1436bd6639d2558656e17567e31c7ea45e60d5f0d7061b283f141674b802addcbb0c5508896e9ceb9e70832827545516dd68626092d61aff36d8b949ee03bfa608eb0583c66b67605c8d7d6e3dbb6eae3219e9bdc8e05f32403af98ccd5c5ade5353bc4cfc974e54371b9cf4dd0b5fa6b55dc239fbddc9ee6a3c3263c810163543933d40838f2d1223a5ca9809d6fde714ed665b669409a9a6c6858cc47d374048382fdea6eff55275b809f5ac5b3b120790ca0ab77a6f358f205eb3bd58440717bb8df6935c413c02d68d91d8ecfd06ea83df9a6eb6391861d66ce85f4ae2339f4fd391df3359f8173925deb45fb534e404758d8b14be73e90e2cc67b2f0577cbe69307673e05ca46f0d2373e29296ecf70762dd9def21bccb8225b8ca50aa6dc37ae2a01a42950ae8cb4879f118e7597a0cd8d002467feddb138a7786fa8db545eb5e09e9c6fe2463f1a469d349bb6b0ab4051a01c3312ce2cd041a8c74bfd1834fb1d8e17e7b08f7d50655ef93629695976dd9cee04c8bebbf1aad7d01b599e7970017185adcb8bb8a3be3a5cc24edc32395c24b928a54a1857bc2767335146297a46c4ecbe8d3c6682db48c4e8d1b9f75cad159cb8ad5716017f5ec0fc9c0db91d7d81ccf0cb17e2f0d2d79a9f5c8fc9008b72c8e32d5c0a8597aca89f35cfb666ea3e9bc65f96db8ccc4d3091b2d4c7ef0307176d92017528f74506ad85406416c89f962e0fc9cc276ffe8d9b0a61bacab1bfec36719467de30d82a6946c34721ddae8a46f6f68fd97f349f185d4e4b1f744df2440176954f20db9a0e9e5a6bd5fc97f670db901c300575418eed3a8dd4d94b01de0b63d7b8f1ebb639f6d0a134b671581deb393cc5a8f3c4130adba253bcca8d827ed7836451b21420bc0a6afdbae6b979360c30d26b5b8539c32e38c74188b636d34823d30551a8459a73bdc5b20c22b05f84c763990427b62c62d616e6aa03575afcd1432f5010d36ffc26afc0280bdb02369ece5ca49ce89f5844bf819aa45e845a84f2a07ab6f5cd4066b820d5ed5522aba69a163cef35e1176377d8eb5cf1acef4276f748c4943feefbd0c2fc70cad0092f1d2afad81996fcaecff2738bfa6a427f20eabb3d3aa7c0538807aeb6b51f830bd0e08215b587f8c24415532c9ea067fa7140bb10850db6cc0f26e02bb9968e931cb8199229daa1dace4acfbd2a93abca2148690d6a56beac286ab5463895cc70ebbbe117189aacc841ded3e5d046b943dc533fddcda36c153fda91a6e0f0c3d117c6147d32bc995185545d1b0bc308aac9e830553804772ad303a3f85e4d1858454dcb19e090bbe909aaac61ccf1483af5f66ded3ee228627b6e877f52530b59b0820669746c0a2c107e98722188029dadb2fff656f6ccff3087b56830a003d0abd6f85748a3fd0dbb3122effe449986e13a6e71443e08249da8e8da0da941e98f7f3f6aff722123bdbbdc469467194551a20725004b8a4db130f3d859067f605c0682fda689eef0853514bd898c26696373f0f5a83c6d61a63ea094d7fd2348d55bc76bdf058a418f4ca9e9b6cb26298d8e19e9d03103395660d751e43967a272c912de45823e8497930b9434c13e39c90b908c738a8ff5b513e0e571239f2b382e286676b44d332a7ae4e8a388de48019164d553a0b8132880b439dc7652d973fec6101fceade48bdcc1f48ddc8130c747800c8f966186525bcf7bc383914ea5cff2cfba483dd2859935f37bc1451309acc10adc7913db3eaa5f41f4fb61ec0c68f02f8ef5358f85988cec7fa4f9ef0f917c35913b7ae95796380c0d92719cb57276101b679968a6f2b69cb9543a2bf7f3ff090abf34d45aa8dd861c3f48fb3a04da8c72400ff22512ee2396e8973fdf767e07f711ed3c2d29f831fa99329c16a680970b8d3d48bb578cae846807b5782cffb9f2164a78f95489efd6ee7030e34b84b2f6254a1144be47dd697bc9e670a064ac0a48f510f2afac8aa9bc70dd810485b587979855b3dfed37ad923aab654911a03b3f1a0aec22c0256110576426e9f7fd4ac36f50969648944d631d10cc91f63d5cc643d86c83ff3188b027a79b65ba1ce310a572df905685523b9d392dcce220252b25a5a7b5d368026dab48c3316ee578ce0b28a9be4da6db6e79644edeb6bc13b14310e8bdff59076e9da26233ac0e6f92da14043ffc1131299b0a7435b31e71414bff9b9a1233d4e043748c70853d94adf8c2f4f01cd34fe12509450ab22fe65050f551d3ff63f3428aff55614c2ef4072389550bac60e552653039612f2c8eb9665a3d0722ded92b5c75c3678e1ea2865b3111c171fb88210b3a8b7987b6c12b10105301be03b679963f86f0ab4378751784726de5ff10be1bbcf1b020a82f08cd90163bc3bebffe48b6e2b6c043c2215893bb1bd4c8daa1893ebd27899bf4cddff0e743fb7c2e6f9dcc6344533220b239f86f124eb94ef0c2d42a5f823c7a222eefb80afe264921587b4c123896035f7f9495c182971583be7abb6784bf87b480f24f7654ca89b9f6583aa3f60f698d822aa603f4e7087e686797a0f14303785d960dc3fb513ecf1b046a2fdacf36c0abb2c0e636aecca1cedcee3ccb77c582c73177f7724dfea680199e9799bdb15966ca9b1b8cd81011f8587eec7fbd2da3e05b6c59c40bc469d2724520c1347c4708b3796addc5de8b4100fc3bf438c54928b1277461e017c01a450d4e6438cb98f5c31378bcd54db470359bbbd281dedfc8d0264ea582e51a381d1c4cbf9d36c6c82fea37a933be945ed4292cf0c0b56cfecef542e1cb25f6e58e7f848a02165d23a8d1b16a0652e262257e8c128cf4a9e801076cff15b3cbe39daf9034bdb573d6dc17dd32bea8220359b950a55f1b827e0d74eba7d919ebd52c6c4b8bc1c9862bb35f0586dd5c136b24ab5e4d19977545ede2b9c867594a4e0d7e5cae15e281d80ec9765d4fa55bfef9a8cc1f35698b951e07370c1ae2b45aa5f5208ca609f13fb5c7888f747efd86a94cacd1533670edc085837af4245b6fc89586f95cb6cf8210562ccc2fa12731194a65d241bdc3a08939fd5feedef2f42fbe7c68b96350b071f31163ae1668b74e3613e2b53086ea470fbdd26825beceb28ecbde65657a09c446f51f80997c95bee227b356df62ddfe5d0f8c9693f322dbf9bc48982c512cddb3bb3c05f7c0f10b0af609cfc943f46d711425b3ef2a4defe5875a84499be6a90d1d8071ef4d71236b87b77f9a1abe742c40d3df5b373ce83553a54b924fb6a6a982b7b112b9e61abd67d609e827e2eccbcbadf42172f54ca1c830fe0de8f24553a0aa48a150a3ff453c16c0e3b9125e2a3108acd4d4696fd011acaa3e88facd83ca14c57ac106067ad0f36b08844f52eacf2404c487e53a7d5ba890d0ad3be1c1e4aec97ca9a4b0a0ab2aa9fcabefee15569a2fd8ca36278a5f4cd1da45055a5c6fab738664647aecfd01e3df496c275c78093aa745030246110b853522a50aae399329df7c299104df7b77289993aff131df9b018aafa5e22de67a8c1c75ef17b96515154a47b61f88547b67eb30872678a8c671797c2d6aa37db108f4f38f6e0fe0e2c5de3010b5478967dc3fae0e59a163b6b83e1c601713db0c8594b1fb3b1586fd43b453b547a32995a2b92d1095976b8a7050fa6ffefac37ad85bdce85e28a5f43dc560d15733708c1ed9326da050b00835d2e7499e39446a92f9fd6126c6c9cf48b357ef7d421b2a63cc1fe7948c166fa9a71a344ac63f5a4b4fcb3fb5618f3ff6650eabf06decf65caa96d69676369ade48ea195554d84af1f0026b2cbb5c8501b38444917effaba5729dcadd457f994751bf4e5ecff913aceec18218ca66f9f9e2a863536a44e69e00c0914e5b41e65f12a6d6e6c7411b026a099b7c7eb7a622c18e05cc53418a45f6d3c39c1b5fef5808d44160ebfe410620b8b06804e9c729e0804ebab57d8b75e34fd413d0cb53243d6d9cfb13d864a34b8d022a09cdf03e3cdafdda3415c16b5bb8c35246ed4bbe075244c008591cd7a3ada455069122ec4f847d10d54b6e5875d6ade85b2eabcb81121adc76a3f7fc842283da07115f98362f0c97af735692905d5f0f9aa4e6f403717bac481e40b8379a5d63b938cd56fdf8a72be1229b01c18ba243bc1e65b35da227f739a02c2a4dac3791691b89f7d89ef0927eee08e82352c2e1da27fdf25707915abadffe4c143173f3d17779213e45f82e89442e8cdf92df4a59687cc10ebd5033561a14b911d45f1b9283cb8b09afe194263c80e0a83fc61dcdfb706e670aa71c55280a49eeedc741c8fa432a3072bb6df01b189fcb6475ee0be4257c4c064f232091441631abd1e5d045b033f24e775478b556f70f4be65daff8e3f4081bf05a3f85ba37abaee94cc1153df3e7caddecdad30d536cab5bef56339ba7b0a5b12b5631df0c4f407811e6ddb5a7b8d9d3e17fe04c063e49124b24bfef39af1613d9a6512ceb541d853054015c09fa9f24a4583b51bb1fcde50a0a1ca5dfcb25bca40ef0c1171e285b40147d189b3fc5ea1e7932272c312ff1c40b2ba250313f42c9a466e7428c2a34e197c8a293f1d1bff79df8c8824c4981020bf924b1bcdca103b3b9199a6973bccdf80c7fd2a55f7324c3898c841fb237c89499d77881c3196a073c5bd2813bef66160f15dd54dcc74a71e065286497d80718f1f23a58705b20e04e29a7c5947536477ce485bdc128dfcb1b0919950297308e4aae2a09d97fcfa2cb59989162dd9b749699a33cd3695f896de6955bb8fbb520e1ded6f0e228326193c4c68611a7db1020ffa66a5b9d2168b16eca1db98a21811bc36102e945775e9bac63265de1994d61ec9c927a8683d7af03e2acbda9c8ea49ae4c9c006a6f340fd3a879afc208f92ec647b6f7c98bfc89364028b1de635b06e3dda691376945bcf60b67cdadda8555826397df89407492c1fb5b36d9302380d7a40cbae8ae594cf67ea49774c04ba692780e4d98fdd45d9ed385c2eaea6390e6750e34329b244417660a24191fa280374847984a7f9235741f5dafe0e338561daf66c95c8137eb38817fa86f5918d74f6d361a113de0374b09d33e48638712d256284fe7fe172f80fb2131b1ca470b8c6d8771d4f2f2f65032e3fadab8a8f07d3223615e15b086a4cedf5d70f245594ebabfce50c87cf3d772a44d131efa5fb7c4c4ab81599062701e7b9d4ddd45178e3cb308363c51c200720c38cb0faafaeeab953b3da04d01f5c6aed19271071cc03e2ca15c6c536327bc0d15ca4167a46e0bc16cce05b0fef1e8d99982d213c2094c2a3915000a1497d2cc79894a729cac3b844794cb63418b062a15224c54f462020f443781b58f1b0df8645e608894b036c528aace256809bd284eeffafd14c0c0210d75b085a68f83521bef5f2c7b4f60a997e456b8920602befcba600c26b2ab8adf06344ee7dd607c03318870284d0fcc1f1b82c0f6b8314ddc2b968a98e1c20d15ba7153a42662e1a0a8e7309a244be8861782ef4f642b8c7486776f8a0f9cfe7bd9836092d1d36c0d258ecab6235c1d2cf50dd58289a93b0240153675cde2c980039ab26b8200d9976755a213b1f52598c9d4f859d5e779650bed0cff862539fbc507bcb30489d00c190e200331cc9ef42b5f148ea6b97903765515a01389e4b936ba87ed1ca5b7d09cd24feec799ae634510ae943519d1116a38859f951874408601d3715120d1cb035169ec8a54ab6168eb3f01201f58a7bcb43c62b36ddbd09c11ac5c30b42bb1c4a5ed87b69d3fa3e527f822fd6332c17c93cca6bc1e1f14aa8dd07012cba41ad579ed761a31b012e791ed41ea7ffd4db1bae1e7240421b88f104c9506e6d005c298548a5646f4cf55074a18ce3de6326867a19c5c49528fd5377ca85c7a5cbe5540cd8f4d8d9e9dcebeb3d518bc7c19df98df91d714b2a7702d4c1b1329474ebcbf589a5806b3d133c90fa1c5c7bf02893b2c5906e4e79683330e6ff723db72266e135f3aad","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"fe727b3ec2446f3e9140a7a09442f679"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
