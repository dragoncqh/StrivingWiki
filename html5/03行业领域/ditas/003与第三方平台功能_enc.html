<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"24de2b897807dfc3baf3c21cf5e0c6d79afed43de048e1372826ef8639ab633ad9e3516250ffb7ba29031b495d2d1888cbd4f1e82af3a9c246d0e2049c7cf9bea6fee2df4cb4496eff5602d42c9addb8d18a1044f354920415c8db24c791376e00d92a382d933bc3f84d805a448a2c0ffb1e48d9715070950c29b0f706278d47d8c8f878504357b27a188cdfe82e56f4af087164bc640683651bc7447a65b54cba2446469cd54a8933e7e647f8d99da9384c6024ba28fe9b9ad1a2a4f3a909c530387ce2cc1d01a337e1b0376aef4ec00adc2e929f09efe3faa6054824818085145a8b1b3d6d0694c9724559157ddd3bd9ee8b61ac2f543141bc72f2be6d7ee6b44332df7df55a841e9753a9d6aeff42e25d1acce8fb497e980ae3d547f4163173d4fcc7b8f0851169014cfb9e9ef033e523b6315de69d3f4f159b04bb1857cb11c2b822fc30ae3237d824d3380a6c49277a9a96175d41c577217b036c1b1b31bbcb5b222938c8e25af6d50b12575c3776cd378e8868532317eb0d8baff2f1d3364eb0e7d22fd67087b0d38283347633e51ba05140150840f98efe5925151f8b9808f20ceca9316f7652b42a8b57242e659f9f5e756e6897bdb2b15883e88ce2d52da4b794cfec231fa13c8e69126d2426a0bba18f640ebf1299872f3ca0e0f5427a3d961eec7d9c87e2b2222b2edb66b59e36b8cf3933da89769368bdd82ea67d2f236c3553b0cdcbb9a8785bda85d3f34745c886f770b06205aa455affa0a50664d78f3cf3954c897f52c73cb0bfb55a1f4a463dd5c3ed44e25d12acd78b908adea2ee4fde5b32d4b3ece7decd718d7e3eace741262bd5b80db11a80418c83b6575d4058cad7eb4223bd781d237e6ab262b3f84374c7197bbd8ee37655309424868cdf317b160ad36b78ccf2b3af46d3f63e925e51d43cf6ee68b263676aa111ad2327e8806c0511427715105689d47f1589a9c060d3617b3218c43ac24df7f2b917f7f1fba930de46031d36a7e693e4edac621853810746e2239cab163a86e9772ec3222e24a5f52e47640284e6ed0a8a8f1ad28e945a50da183eb2c6704cd48a87aaf74a776f50b50488505e23115f2ffae7f7f6f4911fdc652455103c1aa6bca77bfca19351f391d0528d4b98598a40e5e891e832c3f62a76aaf80a4a9e44e9cf40fc17a0557b196c9b0b93f068e7672387b1ac8a0a3e3043705f7053d3f5deef0477d9f4754b3aef27f7067bc75a3e676a988c552517a40bdc5f1bd09ccd671a86625fd139f68f09df9840695772fd3e237de5e28fca28ff7427e3ef85d2d2250d50c6160ad997a808b4e1e0e89d774765328013ce521762844c232e881325e18a29dbd4501dff36938f222e80156dce2e159498c79f561ae6774f1771c0e8cd5755a7561ce24b34438beba09fa578c2dfeac08f1cd29d8cf8c0c0935b6a906d343cefa6c17aac55fc7e78b22a8a6d3798815c87ae2487ab26533da785e3b6ab7b6e5422acfed694a5256a821597d6dc5d2207f9dada2dfd2af7525d74dd1569f8cc9a21424481ac1fe74199e0cd5349307581b6a9dab16275934bcb6917645536a2e51d7bad2120ef6eedd2ad3b8567e9be44ef0abd3953ac2621971e1881c5c40403ac7979361f7ec5869dd874cb0a70400c8eb9cb8cf2ef1a5525011b7c3b6f25cd0498338cca2c485ae00d9a2676a43444d6b6498f0898447449f6578376626a71f66523634135754b940fbfbd6ac113f4b9ff9dba06a02f7d908d6e6dcbc2565cf3acddb04f03fc342321892e469f919ea4c2234e4f11eef8c265b8317bd7d029ed59b0db36b26316f662de1644cb11ba2fd429daa9da1807a1cf70bb02b9310e0f09f26fd4bea970d02d3e6e410095b74314a116240bb549b814ecf4b1020cd13a41496dd129c5e1f046a47a8026b752331a7f52f98dc65dbce9237f3c7b63040ae25fb3c8cb89c83cc32c3805816b287602c65c0fcbdd363bc31e9adb75c9369e626a62a4826e6418cd2b13b5d1f67a41ba51d171f8a7a4b60594bd098cb5cad8f53488d419efefda677a708f524aa0d454a7b7b89d4d20811d31e384f5d2869ebfabb1e222744c778c2cbc665b7579a757504c456aece79bc98da70e77b27d7740366b926e5b99c037d37f145babf8f96f5ce80e916cd43ab36f79afd6024c797d515de1e289337cf9fa0e52f0bd21f0e90b1b16e5ecbea7cb0e03749b7076607083688b7e9ecf96f9dc7da8ec30f70935da03dd4c764a7c33038998e02f327d51fcb73779f97b094b36b7f712d30c42c3e1f8dede9c34e396314aa3661a33972c16e49be6a7153a417ed1331976f93308ffb088f0ca179866bd8dc624accbfe099f4798b7dd767693a999551b97097c892888049c0947c9300e34215115739b27bcda3fe74186fb3ab600e513bfe326e8b54f0694d3362cb829e1d6bc25be71fc92aa3314c54d32c9093bffd69db65ac28b937f09c42e762b0596d17644065fee1c4b604a81c5a497dde11ba48839dc399b840f86ef2d64cf4cca0b247c4f6d03a67e38ab5479c19de695e30f25b97d40ad4a2623d2a58961568e58ef09c0daee1128d8351b642ff419e92c138025fe19175f4c094ff9979448f9f5d50b619910ba56dfdb14d65274c333853aa1c41c9e15ee2fb08cff19f8b011f064030f9475ae6327b8e807f6103a43040875c83e2d8c44f32ef8601332c65ea83d85401565a35c0c6a1fa46c9d2e6d670b202c3b5c823b4906a173a40dfd294394ee11688d7b88d3276c4e8edaf3eb54b2045e6740cb9aeec3d70e5acd4b1691c2581af16dbf355d948a3773560a60fcc246b764d3604b3dc51ce140eb9565dd085037de3ea3605160d65d59e00c77135f01e47bb80794f7d0be1400f61476f88d0cbe5150ce9baceec2cbada0b82a367b682be6886fcfcc35b40a12f7c9daa9a7123c6d60b01cc882ba47c903e47f29aaa95e6a8c8d1fe54faea29223384cbb54a1d5a0c08c374f678c0d2ca8f7659cccef831b2070452fce32b8b3804fb1648ada425d846b16689160ba2aa4416d22c2fc123340ee6aaeda313405c7336e7412f96592456c924b80dae5c79c511d312ed06c291b16584a08ce232852f9b9a2fbfdeca9f3bf1559346110257ae446972f755c21a756a4cf9ba6a1fde8ad19b24b2aa6d2893cb5c61175be74c39e93e36584180933a5961df32ec94b62dba1e08d6984c3d514085f5ddb84350757f5a0b712b5b3dae2f2e9f0627c56037be12ad460c9fa55644ce9a47b97f2ba1db9e06a32824cc193b24b7c3be7102c4ad68809ef195ab3154160ce3cb60a1e0780d0f01f408e9753b3afb4e75547e80baa98822d6be86f7e08313bf1c8ca64396faf4d2fad147001c8c532c0d2daa023eabb7c1c9be7ae9a5244d30e89c8f3eb35dc04af9e7db69157662f3777ee9a65a80d9ff0f927cdf756640420e136b3b744616c0294ee6bab6baafba1426e11889a750c41dcf572a299cd9c80c713d3b6256bf9ee9a0d4616f47f90a4f0f566d410688adf57b844a118fcceb1d3f52bd111e1957c983d9c00d4ca077cc9299b71ee8b415e594dd3e91606ac9eceafbf57d369892bf031c8d2cf83b39a1a6ff199afe1af95cce0bea5aa7eac5f4ef634956299498bc94a6b7b25fb6ebfdef84478210992283d4996a1672b3b38e56167cf2dba477e453d735bcaea80235ccf99a0f72ffd1d1da2e55a3c81581c1dfbb5c72e028c2309150fd2f942891bb24521fb5aa5f6d313436b94e7b42e08ba4a92fd591541f0084fa7a2ed6c8e2954a2904f45100f5d95a280dc25575314f2ecdfd09ea128af2e5044884ba5587a0636643755cd791e38f2bd1484781d58f12ea15adac65a85b9954084589e96febfa02bb310ac9e42dc5814aaa7f8abaac91d3e40b5e1ce31ebd4bd292483ab2856f9f8f9a60fd93b62fbf6fb177fc5fe4a671d3564fa89a316cfe3c80d78ce744efe24619a7f86031263f0b8ecf0e12d298bcf075ea37d85a9afba652bbb9187cc7ff1b2659c704ed305154ea803ae5aa5f84bff9d60153e5b47b06e8444fce5238fe73ee9b04308a2d3dcb28061e456b8e9077798138706921472bf4392ace6a595b89e23634365fc79d7bff6fa8e8310dec736687cb2d48cc934ba6c40d752244b543aeb2727f02fa7129945dab31f0ed9a8d6b8408dd35ea4f3076720d752a745c23b3bce0c95e3d9646fab176bd1eacaecfbee1d05387ad915e2d9c7302877599c718011ffd007bdecae8ce699a9673026690b39562a292764320f423e7a633d4b2199049a310606d33360d81d39ea997916f01aefcd7ebaa798d7997fa178ed9f12ffcfeead46cd220804a0547fafbf5bda8a957c3fe4f7c9c43ea875a0d39b60f11eb7687ae0fd608345492f311ead889f8d26bb5d743d4c59cf8f7cc5280930c5b14f16772652b77b17807a56ba02acbb318c7dcf0d9b524091ab1d0d8ab7503bbae62ca9d77a696cfe86ccf170f269e4618f8ba665f3134ae01c67a9ea050030bd5650723be8af9e910707fcef948f8a09255f7fc49d964d373f74fc917811ca0a123b69f5336c628deed2f624f1eb6c775ca1b26faad1ee24f7a4f92295d822d493ecd677a047c46350a3ed641a823caf952f98f9ad92af5bce51bdb4cc3c732b076abb849745faef6fbf9c4770ba2de311af91ffce924cf7943cbb35737cb3832d409bfcd2c5f46b630f3b60ce8fe8043736acfc373a14d3ff9745f4183963d25a4425c71d0c47c2ddade795a3610f1aa6f4acbeb01b871169f0ff043fc92ac8d6597a5215918838692de37d4b491e673aa429f5b6fbe71334127e6fc53943e84caa1c917e26c28cdabdf3a54557b90be1d509796cd20edf5a75995b332ee78d7ac5ba23f52432dda0dbdb91e6e85ac72fdb0ca14be119744e6d71fdc16b6a4bbe82b13eeafb85fe7d98c7e487c1ca00f0f7cd31d5f018a4cdb7660c60396957b4afcfb3f4f7afc7b42641f0df2ee32ff87238dfe578c8a75d6fce5bd7620e7a20507a7a0f512ad48f8790db469aae88db1e1c6076fcb03bfa50437ff5f5a35b39b7818bec56231d33ead2deb752cf98486519568e56df109fea2c8dab451998e56923e335aab41639a66e14f9ded050f49e57ca22c0d4b87ef204f7cff613546d3ee74c201b9f38f554ac78fcb7d60d53ec2d753783e1951cff458ea7baf3b32c8a2407356964b5b0d3653814314382a2fb6fd4ab6eef9dc95a4a3af86f7cd60f41695424aa9ca1e9ad77d342f5a8c75235727fb2d8110bff191927f0ef81b5bca2bb4e4cb91ecb44a502652f0cbad699fa0a3a609c858563295c9e14700a2ea64ee37d35418652cae1641eef5747c776ef02af41a46d02f7e4dc399a3cbdd7caa2e65c37e74c22322c506d84455bf4c2d253475bdc5cfef9c779f1f6e43b3b65767a646d1f8c874fbce802ec067242c8ebef966d96c1a1421da5ab098e388f6eb759bef6c47d288aafc584dd4f31fa3a38a95e9ae475cd71f6e2092e7036ffc8a4091bd848787fe8b85f658ad965ed90acfa8da08e9f7408ce6769692545c443a3b088980e96113bf04e18dccc2ee3a97931053ce4265d9154165272002f50155cc10d2b0cbf38d463761eebabc3d662eedb953b082eefc1717903fd8425cad129f8aaee4770b3bb09ada7889ea65fb1143a266936f1b454404b5c94bfff7e688e852fc2637a5c707c9f790450baed8d87765baa806c07bc7ab9e227a7328ad5cf634ce8449be97a30cd48e62be6648064e03dd9035ba2ff67780169fd60ba3d6f711b06871654d367ee10c797c59f530c8b287cc39cf9c35f6f418e2d5118fb5450d5fe335a0035d69914e174b1d9c9a77297b957299a197c4c20208db65dabcdb700843dfd9e3abef4a3fe2a271be8aacfdb551f34581b4d3cfee81eed2beec63a6e1abc00efdba8bf68c36a44caf080a822d90da540ef18771ba150e814e3a0e828a888e1744686390b2b1c24867b8903bea8974b1cc8fca06a5dd756514253310984a8698c8171f2403e8cd4425bd2e847a312190ec8535952fa0290b6428372105ab6e27dab7af061f717cbdcc38cfb03fc5d64b6949b116ed9d9624b5267462491f7fa4045db40c87dbef7d5b664234517607ec9fe0b55b9a43c4775ea5533569cfb339419e980e0005ec92652db51d972654169abc0ec01cff8efeabf0a45c68eda046c256b10be4a2fe902e9c23ebb4baa132c95c55ef104ed2a7354e20405ceda18d5b6b9906181f70f03b119855143eccdadbfb3787e881621e7013dea4a3fba0d617eb71e60a210e74a3725bb4949843b975b9cf4ffe95f967455a0cfdbf8a4286ac1c96ba6d92b84d781d81e23828e72cfe974a7230d807490f962f6275f475458b0cc34d42f5184075be64f1383b2856fcdfe9d19f14d16e302e48547252c2a33d1bd421b26ee86a731c7dc2e9853f580b27263b44c713adf5a029779b12df647dc70ea456e5a1c7bb97126c9a882059c0bb277df96edcf28a92082b562b1b38283fb9e302708f9fd0f7680aae18927496f4348bdf09c96247aa8cf9522356472f9867792924f3836ed0b30519950d64a6da10473fd4d455c1c1f4eeb6d4707a355e63429fb8ab23d3b40c4e577e71483d5bbb19fa87c038231a32f26dce05e3e8bf37ae97e0b891f9e9a0ae841b589d08aa5b949b2ab21463e895d1df6f31579665fe913731c5a540890ebbdd586800928c72398ad87846d1ad96badcc2bb5a037dcadb2aa6454f4817d81a698e31ebc6b81b041abe5ae7f9dba51118827ad430a35b3b5bcab756a290273ee1acdee6b9f198a873d32b5bfb2733d9d156935cba9de301fe3e7d71898553cc2653951efd0cedd59077eb26b1da2b14533e70fb15423d15c73587ddc3f5296d2f9e394e15321e5b03744c819483b7bd052222e8e3c1e4e8edb3ae85edb5099860b9571409887b3cc50fddf0c8972953e4045b6fb1648423ad7c1d6d0d53bc5304ed6346e4c2ec971f027207c1f933fc094118c2952baa96629071f8b98b0fe4095bb0e5c0e83df828bb571f8f8b77342febf6a372fadc553f393f76fe4ea524f771e6f46ab80521fe2d56d74ef0af5ff80aa49a842a71d00c28ce2504f2cf97e2de9d3a73796a45527d6bdfb9797ccef0708b41984364e6352a491b6edb7519657d3b9173b9fc7b376e70382c0a74b293fbf7cc894090618f1838f05eafd9ed647f220eed3b5f357bac6fbf933d9a18800c13d411fbde3f5d6cb2cc4d0a741499c342523b9f56ce5f026c9ca765979ac706cb444d1195da20eeafd718c6ef919c338e95a17f27f80b0b36aece7c4b5ef743d34901ddf9499817911f55e193a1c06c850035489d987756221c7a430327b950dd6fc00876aec924d53bdc072dc495a1523d0ec1e150bd7a3c7d7eaffa0e5451ceb2adccd0b808ed3acaf43b3848478c3ad2c3f1ce6d0375246510f8136d4f6676fab60c79eecb7158607550efbf617ca69b289819c1af133316c285fedfb794fef92517c3f3fb466408c057e42b7500213e2d02f6288a20688829e5ae6faf2459a69393d63959e97ead29542cf455ded8abef584e68c5441396616ae9c1328f287ea4b00f8879268c8ba38b60f0f4db9c72ce1b17e06e454330a00f2ee7c3de3f9a68dd0439fb58f8b12941764a0128e7e5e5f7811892e799bd22965e6bb7429e1d614d4b4f71f08e304d6de7aa223d96a4df9f39857dc98dce5f033f9a214698822ee7cf754aedccec31d39a938d8c81d1600995f4898cdaa785e1c830a4f2e282fa29e20683e17e08d813b2bbbf735d1b1cf26f04433079b04e764f5dca7b5cc9f8d52291cad6aba68f9378021031c8a4631bfd82334f4628e41ba615fe3ac4b8fc84e4925688f4f89fe4e5b081f164206c0ccf8ab66014c31340f2cc611bb46f027d2d872192c12ebc82372b401b3884e208d6949c02e61993a18feb269a9979ebb6b7e6d30e17fbcd337f71481cbdd1a2bc6e738aaee5ac8a6e39f3979a24ee16d2da48eb166cd84901e2829640067fcd851dabb313e05052be4faf721330348de1a74b9356b52e452f20014feac6d192989dcc36dfa99a852fb99ba7aa269350921b2b62b8bc8725b6b2d8aa87066fcd0eaf54d223a99e67a3c4f8f15cd3c871215e8cf75fb105001dcbfe124d1f85fec1ea804c419daf753541e78849a9dd064a937bebde53c9aa1bf2d53258d2dfb0d858fa41273f97cdfd57a05ff5bedafa01561cc0b9cd2b017f483a7bc7ce9699468ef879418aeb3adda400348fb1e76d03227173ad75929f6c49cca428e663b21ddb88560cb61ad3aa6044dc2b352013112f4f8dc3088cf0d2ba96ed7f410f9b5fb0fe9f7a8723db7da32e9c2edc43f5b68844d916a55c7987be939b13f4e7f13b0fa57fc5ab9761648d6c04b50fe88d57876c37da03210c10425643f0ac21682ae85888d8e1ea86d6447bf124130df982bed41c7ae832510becd1063b2affa18456052083242d2e682cea4b45f5a2a20c2f2c3e43d0111a42ec946b0bac6c5f64a15743f871bbe77e2eca7932e37a2982869a96b7c9905bfdca63bc4c02e5035f064397ce7e75c98e2e9aba88fe337785adc0cb05bc4757f9c050c1de251fc1d9251677976d148bf44478d8a7db800ea68f498f41ce4cf10b88820f8390ace1ce078b95f977c9a69cac4f22726e834c8951968842aa4d0118df1d81e63e38f4a30a923e0f84c0335e067523b28b5deb1308fb63ad117d870d142054ce291f358b5573f5e1e6430413a416a771109f7cf58e356a97f971727d21ac6ea7a92bc74dcf587918679162d7e1bd847611fc2b2a02d58a973d0c6bce0e5704987c7ddeaf71bc74f9e682dd35d35fbf583a13f5d6d8d4a464e5270686a738271d04a5a96776e07cf8152a72eb1bbe4c05e1d1bb089141e71e1e170a750b12e3343c5611e3731ebf378b1a7d3421ccd29122d4f97b6a7d10d995a9540b32ab6b58301cf1a1b9d86ddb56e706898c726e6c87c2140f80fd4eb342babdcbbd7a13f94571498388304b971c4053f4c9403c9c4cb13326e0e8cee8cf49c4dd0ae81b5d8ae756a080d7fedd5c780a1eec011eb95f871b37c40c68bc314025f8042d5842e4955bf2bb6b92a6061fd66ab505b9d2ea3f1c1787dbc8f355d9d817096e8c0c39188a8536a7cce527f227dc61accdf9f190a3e05955e0f37d64673afbbde71b43b8663d0d702d312c78f09e0875b7206db2259c9441f535b78233bdde9da2dc8edff9d13928137624d8c6843148d7dc120c3cf323a95f51c5d09331dab0a98e9e52064d6eb5beb99f38412d1735a9a8da60635647e230621d231fdc7b8ef17e96fcb97ad7fadc377f54af0cb67764549b33aa157ad49cea860c176ab97ac69b568bb7a161ba9369243a60231ea77f741fc6d77fcb670cf8f7376feccf798040022128f4e3b0d6f7d1c0d1109160bd7449eb4108ce4be1f5f9e5a3981ce938913daa6f1128677d81e5f30c2c8b50a220a348fed45ce6c4467cd7e900e6edf01d99a8c1bf9bb7064771d639fd3a5a3a7478166f7407865cbdba18d7f157201dc5539f1b224343a8309970974b365ae5238f4462b434d1f1e939b1819b9c594ff4329ef1c86773f82c9cd99257b0e9d83d4c38f67a5ac9b43168b4d45aaf36eae68c218ec53a3866d47e927312363934473d767eb97557e351b31d510fd1d3ef3548a1b3a02f60db8ce30eb8f5d98c04b8a79a7ec4ac32250d1a70d42541ce13c0863daa390aa0229cc1b2e7d4cf23f24ccf4ff21ee619ae106f79211a3b03ddb8ed32bfbe8dac21fdb9d28db551a336b5a5835d9b42d272dfba8eceee33585025abc72a72bf69df1a4533d617fd50fb534a4346171aaf2af22290874b4feaecbe50b796c90a7ae7f2b247c1dd823e3421c15a98e985ce3138fd9f4696bc088e130a44b75e11eaefad244ea4e76e0ab940076de9839c6fed7b0c25a49576ac3c7e652a22a38d2059c35c9abb9864fb316a90ac3cfecb271ab5dab2d221a1fe923914ed13e584a74820402cae5d38d66e7f99f51ff9830eb63753d3cb9f9b219556c8ab60eb469f1ffdc4c6953878d72edc0a19a266bebaad3f2f22d4dcbb3f7b6ab566e69a8b25b951a2f2200ad448d3a454313dd3b8a02fa0580616c12a5f015c06c85a1a755d199437a8c3674f0b027b65a0c5af595eb3616a9efaab68668151396b96665fcc5c9c82f54828f089fa7586c6243f825caa73fa5caa81f92a1890507449926bb0f6d0fbd0bb283e6a9593fdf8e4a46d0046b3158448dae0c37c235df12c05ca24b04ab197ceaf1741d8254e4c5e050dcc37c216c664e0f63761d241f997111720bb15785a0a9e17a1cd6dc8905e7f8e79a5258b9a66331dc773fc71e222533bf3b6f75defdb0de05ce133c56439ec241fd1e3030e7e030513093b53b70072d24d0e834ceb8d1844b687e290530d186c0f312745ae59fad24b9ae45c101833c8f4511cafc64a19feaa3686626b1350a6ea20f73087a86e373789e08c8aff6ceafd40a64e14a554fb9e356255a0656aa33a453d6d1a2ff0ec84942208439e2f985e9acd7edfc953ef890964a2d80c14ef27eca51da866fbabd13fdee1c087692cf390e83009965bbb1bf8d09314584830e4dfc7b4da653440fcb45211c8b9c2a88fcc6741e7e88b362333bfebb3154eedd37ab2e9677617e9daa1e3984391166cbb6d324497bd26ceb1be901ee1004ee592bcc28bfcd81a435ba467387fad5adb0aaefa33d53caee21ca1ce5121134ddb6d9e2aa23e2ea0a26c95cce273877b6874adb777dd9e3c3c8dbecf031b11de6bde398b8d14176970b932bf5e451eb88172ad9cf7b42096dfdbae44d81740634e361821c25a027d7ee192192e35bb66ebc30a526355e4a29c1fcf2ddafefd2cb0918b9bbe99ee8dbe262e2faa93b37ed8eebe997905b1077276ff50aa96302861609637f7994a2e1fe9ab493231587e444e3a05ba4bdeaa093381fb911898b679f87947802a1293367bf4ecdf2d5731ca5cd75d0fcd12c433b234368384230f9084c4d64d815fc1b57aad9639d3bf03c770bfc0e77fd03e04b602d47c0d7e7d03802c91266017b25286b7d18e93b2cc6311168aedf6b9419036b74ec9e125441ce862b9b84b18473cb5a0d05f183afa8b5fa04c9488ac9821dac917e3a82c6c8b6634031fb829217287ad64d15d85b91103f49a2faeb3ae7416a5bff18e15f3a1fe9a75cb89299c7412c0a9bc5854c30f56b642fff975ba6cf582c7ae185e7a013f5ed02b5b1e49cc7a18859c518db83e3523b86c5c028a52342331b299a0f616047c23fe69b7548427db6b8a53d54996f8c4c154c6eba3024f6b162780e8d9bea3a7bab91532095749b60bae109553482e9e6d5fa3f927e3586d39643becde812d3248a98cbf2232106fb2400cafab6cd17830d0e08ab4f299482acb2d67aeea085ff4e49ba12445df1b21e5155190a789ae24b9d68b24f72fedce11ebebe5514e0c7496eac1191b460df1898c453f6acb69c6961ab6f9fbcf4c0b0867d22cc53115295f6021079e55fe5cddf25c474bf1eaa3102b1b1a10b8b53ec9e5d98d640c26157401526bfa5d2e22a5edbb26a8598c5b31d06367fa5c8f3e308243f2856c332bd85cbbb87b832d9536201609130c0f0dc37393d52e5395d0bb811df26ee88a831bf73d376c24c20b6efa5eb7f5c30e51756ced716a662d4dffaf410ceb3ceef9b27f769e6e515ffb00c46cb946e7d17fb1b86ed2f8d57acbc2c50a7f6aaf001b6eecce01d718e4c30dfc0c40c486ffc76c71f71d09ee23e4cb13ff37cf9711f39e6b2e2fe41f40f739df7e10691b96e2ac5053a784e4067575592b62a9f02f4c6fc6270f76cb11997ffe8b973f5316af969f64f5e6ad320509f7791aedb53d8fe396552b1c3cedc147d0128903107d88c5c1f5a5ced3c4fff167d4fc79784eee95770901ca3527466b8fa419a30619b401265d2c1cd7461b674aff8d5e38903c571dc66aebb99d611f77df0b67f265b45d427c9ec44bce86b8ea7f9560f3bfbc7a75398b9d98585b4073f92268c8e13e1074d1a22cce14224ddd20104cb98039ec8651584f5af111f4c633c73ea4859af8a5724fbfc012c3307373055dbe98b8a1fb1acc5c2d800d7db6e687b3f5ef26a91c43036aef9322e23337a3584a3e09ccdf3fe56ef795abee82a78ea961375e3ac63236bbe2c7ade10b9afbe7cd3efe16007721ff3c4fe9187ff0357fe427131d73babf9d55f386dc659c8ab8ed8f3cbd56a02c0c0ada118195c2a3afe38fdc3bfd278281232c956872bbc6b29d431b77e54a5c0986fdc7d8b8bcbe24be7cefc429f1ad2be22a6d67622c88d3b9ca4782b99aae592b7c5c4fb0c6102c3bc0c95d5321b105dc67f9d575aaef9ea6300546f8a8b359a4868fa7a6355c2469ee584d6340a22c874d3861bba26a6a08c947b0a3b4dffaa696004035c921af3bbd152c8693ac8127aa1cb46ed36b070e61451390f2a431b843a339e2835287a630af461ff59352bbab7082215529df1b77e2eb5c96fbda2dbc7432aa504db614f2b5ad3ab9715f2dcba95171189392d5618ab25ebd16d0b1e779c6238e0fc77c067088ec24e2b88b1de4fafe8a0a6966a81ae91f645e0ba1bc1ad8c96d5a67d98e65fa978878144771873e2eb734644d53854236ff8216d9be421d0eeb31c4b710e26c3a3901665f7852b20d6e8d178e91e3640ee092637ece73035a3fc1ccf8cb6ef88f8708de2ca9e4e9cefdac224a52b2944663962808af979a4d9678e957433c49d6ed87756e828b13ab9fc9808e1e35d2f8b08dea5df0f6f171d40cf37834e08d10f3fc0f7ad46482063b1fc8c95fb9534985448ce7dde854c0e859d569e5e9eba06d1dd69f3df79302bee8240dd166071429b55f6812f9389b6ecd9385ab849d8fbdcb778fee40732d5001503d42a5ce60d6112ced6b5c2ffb41723193aa535cdddd6a03d971b37e0f921945eec284bd75a10bf52b8ba3f55566c4776ab16d6fd95e734d85df59a37ffee9679d7562f85bdfe339f9c1f787b2b1a7daf47463ec51c2ed855fd1e514feafdc02c49a16bf322772ac3a737c583785a13549a7827143757550a4653599363242ae4996a3e0c4c760e9751250c867753458ae2ec5862b0ab255a2c976afe33b1ef593ace3d0c58701abf7dbd06035bebdf6644028d3e2a022ce51028c3c8dd651b0e7920675d6b2a7b0dde7dbbf93e908a250b83aa31b0573357f675b253cffe951f3f2815d154c4588673b27b41c0f7f1be4663193a0a7afbe09c92fafe8480e40468e5098da99beb6d40f4b3b2928fc43aa25ce923d8376fa5821209fbdc04288fabddb17a66f921d7d5268d094941b81c9a693986709d7e19aacf04307d2fda4047c55eb17ec14ffc21a70f8e1cf99b98dfb74a8c4b19368df4332339e8f23a73118d49339f8c57d51095d044dc49d5a412dad2bf30a713de974ca1b02162de4e19cb213e27f39d564711b53c4122452532cb9e084bce7bba3d6e8f7b60a90d48463a76b0763226a55799a8672691381173ff6ac9880618e14f868f96360be8322e1097cf8f0089909be205756035a2b29961dbe8196bf5aa7785fe37c6a8a9f0bda5df918b73bb05f81f1b8e2e5d37fc73f7caa7f811eb30a791abfba4e30cee819dbcf0175f61dbe66ee9f30ea6e56cf5f79473d9d77d355a1f25df2768874fd1d6663851a109465e8792859df41a952644a4b83edba678522dddebcf32e48bc760be3b126d63475adb2086bb61bffa375eee343979b96a24c8738b10399c615bee85e2e473292dec4bc4d25cd2dc8e9e67b0b6b7f4c78b96b9155b514e6c41ddcef80a6d606783e18f9a1d6c96b4d1b7b638a746962d2e0fdcc00c77de0247482e0776a2f056411c3d1181099a20996355d6f388bf3e96cfdf62653a6f258b44fe8b6eb1259d1c87387087a508d043b40a71815d6c86bc8b01439929d815d19338c32065df59376b4645caff1d43ea51b306ec93c7cb11f8fb45df14d9569f4cda95b88af3ea048b34b40a8fec1539449d32d77091e13836a4e71f74c38c55a02aafd17eaeaac52a90901573420f1060ab86965a9980148ccf7c9c5caf1cb5332a6cb407859c7544a629afd14abe5113e19c88f1afc8960c027def13f195d7b4988da9bca2701894a1366ec66f87debb2e84b53e3bd499ea78d1080330e98329cae8a937e5bca5cb6e7ce63adcf7a1d4392899db0680b382601b59a46e1ce5fa86235ea4857ac60fb11b45f84fb32509414f2faa3e7cd179f3f35fc760c8521874f4a75afcf0aa1e782c980ce9ba246d4c01ab24f01eb2fe0ca3d1fb213ac2435a5c03347787c97ca5555133e8b1d50de3e3c90c4206b4ab1013e5bb1f17331f8357c7d688afd50d07b5cf78f0b06836029682c50c9a866caaab940b2f130a0c4615b1698b1e463a8d9811d9c684a157f92fb7d850e9607d95d2e51f90875d90d891062389bc5b33dc96845d692b6eea7f965028467658336053c9df305242d098cffcb2d1c3fecb85cd8c350e84bf849f396b1ac7a6a9e91022ff1686b38f1f756ddab6a964ec7740b72de3130b2353830e07aa6e77987f7226dd8b32dc22237d71a1c515a6f27096a64e93b4bddd0e3481b02eba377431aaf979065ecd47527d80e471cee825c5116f1d576a9240e9822580cb1fb46d7255134cb010c639a801f3279f7347f7c521b8068259a0140e0e92958f68724acdb5b14e628e1642d2a6f50d1469582454a8df44a45da7c432685bcd8000d80c96c4a1f3d65a4fecf5f5bb6211f5a49d5cf81376ad93d3b0e72b3fa6e7a6d69c15dba95cb1e9aa63fb7bb2dd77f3f7f05aa65f276f02803fdccc40e6484a02c97e6babeef7d9895d6cbd808cd671c5cd9609499a119648ab52e092c459f39596ce0c48df2b91e0eb7ae137ba331a01574da7e939aaf98a9e2b152709f23610b053d9a07988bb1ce6945dc878fd4a8d0be6eead40c7d306323bd8df354cc1b776436234761f5eed80464cc0e7911234efdc80c24531e41f83700d4d8c3e5c5c238104f797a39d5438da665fa77a7576be48118641196f196d4648f648c9f2fd19d210ef23669a207d617f1b52dd239db0aca7589bacbd7f5848db34a60b33c65dd1016db5f2c37c08b125a3f302b3005bd88865226677ebfb05bd4d1704bf00bd9b6d7687a32c8f6406f52122c19eddc9407ec95455168364ef5f6bd303d20cd70da0bed0ebdc0da38b6814d3cde4cb54c49ec8cb8d3cd691f15a6f63128d4142a29144bbbe88603b3b0386825e91a132150be62998aa450505b48f5bf00f3301f0d0cc13f7111794ab5a611da2a7c106d2ef7db5bfe8835e71321325ba546a71c14336bd47b7136adad514b1f14a30e95a07ccc8bd06421f7754f85fc2f4d154e231f08f87baedfb8db6e66c9542db5d8ae10a951e3f978822db4fbb4fb397f4082516d16efede35fb0c72a27a1c822b1d59f69994b3f3b992e5c5047fcb272ff0e8eb329ac30daca14d172676d8363ab901a1f44a68bc30622a63c7c5bc4333d647610c11805a9ec0c1bce54733c15afd2c6576348070d4fcbbf9f2432dc9856257800efab7282bafe7a9a7760cc455f4a018cdc790756fce9cb8b786c2e5052d7ab8053413a4494e4894831a381104bcf946f499448e91a262c881d6574dfd6592a05958f46d4f1289398cb721135396c4adcb1431fe60eea173bb29552e61414f362deda0b35e7cb607f3aff03b01d5ad94c238ece81f50bd501e40454809a087030d5becb31c1c68267e22162a8d874ca9b35bc924d85195857dd91a85a7c5a39c4ec9d273b7587baa96aefc41249bceb1cffe6c7f788a1ded525bfee5617bf5167f02e2f26797293bbacf14cee4c8e8e8fc752cdc594f958bdcf7dd04946ebad7bebb4eb3823b8a09ddb87752aae7e2de6d5cd99d179d89bc9f4f51e22ae9d3b7fd70346ee33a5a69ef4cfbc18027b943359c2c106550e60e57bd210a85e4ab4e604a6f4006e7e5b80106b8e12a0fb9c6ae74a5b00651b0917b5145a49840e2e4230ab87f4cda04021a703255448778e501b7c788fcd717d210e4a6f20bdfb32a337f1e1abe04c85a09a3ab0787f719c9b7bdb45edc565c63da4e79a025212253cc08b9ac567bd9f6d3f31445d16228b9bcd47beca0036acf8400f18476770e819561341d900c7831d773cffdf139abef8b45a062e075b9c972441d6f19923da4430d1cb5db37aba91be0d8e9d5d94db0c001ae54f255b6e8e8075b83ce7120d76a6aff69ebe42e618a2bbf8a818ccc95fbef408105c32b63efa6b68ba121457a31e710c442e98bdee715870d7932d6bdb5a7e4b49cb2988923f85c050f3cf368fbfab85f982e9109066b388ea82b8a53164cb80ae683e2882820012108b5bdf454dfdbe96bbc9901de890ae742cbbb39cef1bbc8dc0ecfb9c0de23f5f0f6f6f6403b82a197a8a9ad0a0a62b236b5232d216a5010e14a8bb2d39b5e7646436404892b1d5ad976a6e3d17646e1759d9aa901adbee440dd46406475ef2275621b8fb74ae583fab39e07002a31c0e6d15cd3a28f46324254ae4960eb6d5fc545c0c90ebb72e8feeaed79d8667d26b4de45103529f21c2df8b2fdf94239d62222c01f308877e20fb1904acc1b8924244278bf90a9fb8573bf02e8","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"cb4dac17dd2d3b658155eb3f63bb6c40"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
