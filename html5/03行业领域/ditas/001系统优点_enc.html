<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"2d909cf70533b1b6aa4da8707e4ad4f5a98a50374e9c519188b97dcb68b63cf948d5ed440f521eb1a81649800bf9f2649332ea736e3b8490191eae4e83194015105cdfdb1e3c4b0cd06705fbd3fa08521189cba2b1209abf2b7e959c69ee87fa3635759f3785248bcd56c5b7ebc8a5316ad06ddd968ecfcef078bc1a905b40ec2ba86001f41ede15d77fdd23dd047e2704984bbb8aeb6b0827da0e9b170796300db68f858a007d186ac8ffeffecac16b17d4052cd0b9727cfe10df3c4eb6da294f5e23c55372fd13daff094f3ef1fd214f4eac68422e11b73bac43c2803dadd200be87da0ee858e73a7c496c8d29bdb9f6976d428755ea9877a6096dee8331994f30249f8e268a24e9ce4c0f42625d5e7954c7dceeb5a256d642dbbe6366748b214908eb207cc87da3081b69c62d5fb62123962ab37179446a45586f766db92de005215c501ccf7d1ea7edbc7e7d79c1b598c0e2ce8f60796b752976d24c05b30401ba6b0f921270e03adaf75540946fd9134caaf1f510eae45a9aede5bbce15e8b635ec4a9199237f70a31591a5fb49e4fbd06d4d92d6146b3f89db865606e9f88b6b23eab38a5d7fba59e874b407a6edc5a030ce1400de25a181b5140f1bd7327fcbb34a917a2cddda07ee008cf570a8cca183f486824837b7d48778ca359a117b602e9c4b0abda2cf294424c34b95a7900570eb102dfcb2685709bd135714d9a72c8fe07e9df0760b699741e97c8613ed0cf539c49f06c722c434f90278c9fbe0c364f25324d1e9548980d68dd45e2746967c8a26800b60fbc0c56e1dc94c3cfbe10fb80cac5f2540592846666b7f29585650598854462f931222dce95702fc90e6cfb3b421d03fd8f963205a12ea06fd857728cf3c533dbe2f4e71791ce712cb6429611f9d6d03b1e212a23ec6037f23b06ca8c832da301ec1b41155dbbf547253c92c93f5cb01688c62fb8dea57109ea89ca5337484cd91b129a29846cd5d72435b2b95d1e1537bb8b120e7f51eda70cd1b73905a3332167eb21bbef9f1df7d16de471eda9728d1f8d4f3f62af5d951f6f1e8548e135142871ea490d6a3739ee5b085da62b93058abd7a14e59a82266d1c9be215383a3ef07416b3eeba60a3da32bfe2537799416f4ca3dba1a3769ba9db4d770f96dad8c1693ec784cbd5d0a24fb3dc457fe1feecb6c0386602f6dc29692c34af7f41a0c0ac3a217c6b04ae419fe701cc56b5feb682f41758ada6acef75fa56bfed252e8a9678e078f5479ca9570d2d7fbfa465841a2737c925a4ec239fdfe4c5a4be7b3ed1ff802e5460f989bbd4961f782a69a40d8588d1c6b6fbf343fcbb25863f50a6bf031c6ce06aaa49e071e2f33e7ca95f726133372c7bf7ea83fab8820ffa826df8dd12de1e540a1ba80c7ebc493f5a40f471a24dd0156b09ca0c8f9cc6d69c34dcdea08958fd46129d4e3bf9945454a51e4fb94c8c1f74eff70bcff67adef8a8a7a8e620ed89bdf1fa578bc327560104d2e0b7d136d5a612ba1812f135c00816b6a03c984be9a3acb3b0c246fb7e76566b42054be51906242792b1b212cc61dfe6a1ca754d3bf23a7d23ce2cfefbeee162c10d7130a278db0d36c032657cfce717cff7efc38e0d71f443ecc1c2550e58af5475b14b451e932fe517fb7d5c078636873c3ae27e15c9ae077e33558c23e5db776977abf7056e60143ef09e9e0dcef7a26efe7c3a9289108e5ca6b61f12e573497886f95489aafd6338b67cdd3602b2949c149fec3a9c7fcd9bdf036731abe0824a3c859c3890b68f1bb22d46f70ad40a7949045265f40a1427fd21ac48c3f4cd30f48c7235d82e430c6723160b02f16b8cef5a7db9699a9609ead65b0e6d3cfe44651d7acd37d873edf75e439cc02fe5c1006825b56757e10eb65217517ef961ea21bb7397bf77a833630113a5e8056bf059647e1f2c5612ac1c2a4adcf3daa41723d886d6b14d48ae225f6d7283e37f5acb48f350a182b183594f85f7e3f8f52993fc8e772ce0f59582d98ca63a4ee7b0619000adbe7a6e6043d26911eb42d85a80a705ddf71931aa69588b766f77c61470723edba59345dfda8041f9b6c3d2d0ffc2966f197b3ac37ad87e14e0cd39ebe107f3ddfb7a12b21584158a1b227d0bdb1a8ae7de92e4b34844dc9bb9a7c21152aad79d87e0f9fe87c885bc1282e433e3f7b2f3e3b79045edcef67565919dbd9b486a8ccc87f2a21635e3c27a9270ae0bc25e59384787750482931ba1c0b5e323ee9248440fdc3fd233a73766d78682ac550a56db4159a6ea9356247f1fbf1adade41ec68b890eb61624d14e4d107e6280009962af858cecbe6ef9716189d5ef1fcc7cdd063cd5be3baf601bda6adbeae5b5aac8285f345a00ccf9c69767021891a243165a82b2353844607d799d02966867f02074c2cd13e4c066ca736883b86ad0ecf8c5772e93454f7205a27bfec8589f2ba6b9611fdbb707625436870032596ed9e2b6c7111a16ab1ba7e3da63b5f556b3fee0973a3bb7bd069213ccf662b060644294e157e3773c20d7f033b1974de3fce5130ee8bda2a98a896b7eaf9d877171d8caf765ed9466b1092dc7301dc7d5e2848e2a85783278313e17e7d7aa6a36be59e2978ded6823e42bb942ca6e94c74a38dde0923ff05d92920f598462ef2400da959364dfe575b5675b8a0307232896e76d1812af00ebf33daba7fbbeca7c9b92b937bea3f4fa5a3317edb588891871228926937a6acc7854892067a0f5df2d4feab546d9edd42ef3eb6e96cacfa686a351ecb0db2e0b493ef4130f1793b3373389a8be9387c7d37ee19531ecd1ebdf83c3b157c87059c443f8742b21403d22af51ef6e0bbe7fee1f959e0d6e570a50ff16725ae93ada99aeaa60d20c8716d92b42578a76956de0f45e6100be9aaf66084c6a3e537e7ce58c63fbc9372829cc5e55a2e27c3be0bd82fa32101b0e9c984140661d5ec9fece81bc6c4c335eaa5e55054220fe4491094c3d4b242cfa89f16968f567ae6101fc41aacf027d88f568252a450256cb2b2c4e552afdb67a990f85a8b31a05fdc60a6ad7b0b8d1a60ecac77cb3e1014e0248da29332288e3c3afe241baa086bce84dfe19951ecdf612a5bfa2e118608fbd4a662499128e67be9470e7b4b123f041cfa6afa171b1bf77143659a72448bfb08c43aa3899b2d45f2d332fa47bcecbb4b056ecac43cca1198781a050601cb24ee7d415556d835c710193b0d3417fe6568ca07a4c4663e9e616b7d8ec98b2c3a3e51d5f0c802589d01be2b4a017109a5568cfc351068a44760d948b25a7c1ef38cc3acad2d9a4a7bdaee3465bfff847ac148316a4a0dccb1406a75c5fca93ace615312375039473fec51b6bfc438d56a7ace1192f143d8860ab26700016fb199a8c0e0ea0278718e9db657a4f1d03eb863a7d6fb0cc8aa015a69856b7cbc0308611674a922ee1115681cb7218e0a5c5d65621664310d3f64641a6e6cf9a0b293e3d0fe6776b1c5c11bf6e1530da6657d91f3144782e3e3fce372e98771551936365b4e522a4357beecac44951d8588459a9f50e59877ba079de183ad7c6ced53c90839c0e236a5ade25bfb49c57ea2a5228da4d0d6891d1a6374e997e18231843275cd44b34dd0fc57604cd244b869b185121a83b7885ffad54ed9688c0879cc4ef4b7290c7caa83891095b01292382a1e97b1913299dd167d4a148fb551a6824b39f31eb45353efd18629cf661286de59f7fee5498ca7779fc1f5cc62d4e3a00516cce1bce6f14857f7a9ad428d5fc951d8b1c7b2c0c9f7ecab486c94be42bf4895a458600faff1897e9b644ce5086cca4d356c6ceefed45eac8849f73f9a9b5d0e972aad3b4330c04558ce6c9ab9df525598f366ddaa6018dbcfab10ca301fe3b8c3a86249cecd4d8ac2c3075e6ef3789de203b8d1600ef9aabef95228c8c9d674540a291f8e247936dacae031b9dc57473f99c7f278f852710fe5fefe06f3685cf4ae810e5911fe3c216e370ad97e608087de7ed8749cc3594ca42ec74f1acf05230bdf08c946ff097a8556e1440e5e114ca49473d5e06cee96b5272410d1d7c9f3a9b7a769e22ffb8983fe9f5c5ddebc845867924f1ff8607a881e91e0411c7376c6e280982e15e27847d37da5c4efeed98b2c3d4152dc4bd83b6b5610f843ee78c71c5e4ebbd1eb339aa97b54c016313e9d876000dca6146a9cc1aab5351e65e9fe8be120228bf351a22465284328b95047bee86b22329904de6e4c2622b8212deecd656fd1e2f28cfad3c468bc2ce9dd59a2d7faed57ffc90229c9705a354a6c3e0b0e539860c8386d326204ccc85bdf4f915b385357df4557a00422dac55c374b734d8b041df5ca46021c4c5d451621873db2ac6cf27b53abc29bf49306f951e21c1c520f94d25586fc1b56421a083a6a6b6a7f1d5cb4f71bdeddb361fc34ccce19cfb08cd3b053515001e4adbae51a2fc2ac06d1b9f34eabd60d9261cc2731db5d51d3da8bb3240b1fdcad1a2d5c5f8a87a8a995adab75013698aef92b732170664886df4f50800938c5edbbd8d26442e5876fd4959a43569548a304142739d56432c33872dfb303e8edb10c0248215b98eaa31e3ae70bf49068b457d02edf90082d268a74f718226f75e306edf735d40f9638e71a3628090dd2a382d39284b0e23e56a7855115c44c8e360c63fbcf8bcc3e4dc3c577de9a99f3cb89362712bbb9328046c72eb2399fa646d316575f0f3c42e7e3555a0fcff372015733c30b3aa9a812822ebc615b2938873822b448af4e4e5faed7a03be964a2a895b8f1c836f45d4950924fd956acac134e67e278ac05684034d9fe4b447676ca82251612b175030c748b6cc541d804fa4849bba7475f2d7526ff6c71d77eccb8f33e3f67a8a2664e9bfc70ab6edd59bbb99815ddf30efe08363d7baba30749ba4ecaf59b74369e6e90d8fa95377bf42b608568f7ee593179e43c87c4e3177b77b6bc84ec5798e29bc84b08c9e7361c72c53b2187f8c443427fbea633bd1c427ff118a4fe57614243b9ec43ae204a08d16fd91a70bcf7d9e7f8678e6bdcb8494294cc925a627c29b36fdc3384f3050a51b0bb3b7ebe0806cf4a24ac27152bff312f175674f673da7263aac9f67180b30ab0f867aa8d5421bebfc50043631b877fcc0f92e2daef662440d1e3861cac9abc8d170996687fa4ceb775369cc248f2721a0d923145520874d1d3de642c55ee62e82caca0c39b55dd5464fcf3afdbda584eb835c20d848e8107ea23d26827150bd7ff7dd2d6df28ac2d04e19decc6e783ac8adb6c419be9f74a28a8ae27f3c6a9dbb8e29f4c587505944b4adc9e37fa38bf8d3faa50087a33cf583aad369adac526c49554761fc1fa5194efa659f5b8f7673bf73bb00fe3b7d74ff5a17c85efdecc838dd7761e6429e7f1b8c76b444fe14fbd66cbd1881277c7236085b5eb533689179e0da42754a0b17abbf2980d372ff420a09d9f9f84c1454120a81235b9239944aa676cfedbb680b31648aa69e2472c87ae2a7ebaa7e3e0625b093832b4fb58ecb34300ef976889647433dc3967eaea33941daf180d2a6c884e9d5607e213cb59b08fe52bbc8909a960fc351d3afaf24f10762781c76b14cf47f36ab555f33f01e9496340b8024d988c806b0ad20fc883e97ef09d49531ad8699cdef29e9dfa06e0595cf2ba57f3c4b67bb97c6da62552a5778bc633a1e8e5d419aab05efd1a33d3a82ee6763dd18f2d09f0561088d9e2ac4a78eca3e1f2d78232651bc65b357b36e6c3ce1909b6143ef71f4133d77e64390da81bdfa3e622c340af1ad6af6e31911b850b74dca1284adfda2baee477a30683ae29b88e1320d5eb9ed48fc70a84b111ac381110d1647381b7db87996a99063c03ac096b0f8cdbab6145c77af159df879262ad7d9cbee93c62033256b0a21bec342ad0c7d4b1479a9a44f65303ba8ffdb2f4827a31fedfee8c4abdbf0372448fca9df02b2cdc75cd04a69a27512fc1b2c8d416cc652f1ec018c266d036fa48e2309107ea9882057aa9d669e94b50a1cb299cfcd1b8fffff6dd70cfe4d6bc134fe191c277789b9af26d44f6886c9b570d049a3a2f74974e795de58916fb422c764b670480c93a3291a3cb813c290bdfbb439046d529401aa77544c92da44e8b2bcec45039b27073b6cac0dc6d7de1e0352b6a714622a6907e24a831c42a6b056b207de0678efdde758162beb82d0e2a5f2eeb424047dbe1c0e1d5179e51a2d71a6eb4a8894e8af7471754ac3f15fb689b0bcba4789d1d62f091f4e683630ac2ae61d0dacc5f25251dd7ce9f8f75d729d384fded0606055a850a94b29f73f3fc5c91f09b33aaa83348e1e389e29308dafae954b01335332906a3554eb285dd520bd72cb17bbdf6a45f25f0108b69b54336d3554df445a3349b082572951757af0f76a35f29baf277cd4d316e7627d4554b591d02200a22409bae4391fb4fa928faf629ff5fd624f63b120f01df83a6afd3132e5a9556ec1d544e31041f45df145c5b07d255cee6c07d47de6866403b37d4af78b3fc1dbf8e9baf0e533aab4f70283dfffc2a548fbdf5a4ca689f63116a9316ace0a838b867565b97dae186623e4e83c35d451bed5d684c9280655726db9b465463c3db0e7706818f3b843a9212887799fee40c2dfa674aadb685bd1884a60f1ec31af68dbd6021b25ae627ffe65d4c619f86af5952427055f50f9ee17b6555d2d917b78e77be7530941df7d15c260cbea257e7eab7dd87faf4114331740c4e3042b4eaefa8bfe26433641f7295d68034346595411ec85ad8559ec3d3608bcdc6bdca50fc584edacb3f21e8d0ae5691591fbae84c3d689a719919b942bb4e3404fc57af15999a1f3b4881995826b99248051bbdd28b9b7a4adc478bb4dc7e2448eaebfb08d5e68cbe68b252163e70f8d62d6757fde48a3e1a6cdaaae94f5e49d9241c036061df639485e7cfda5e1308bc1eb18a5cce8f63cd6f6e6d72b080b6db897cf57d4105d7ad0e000ee1c549031b943ba19467ef8fe22ea3e2ba3d7aae659857f0a8a3056269e409a0ecd40cfcba619cb5c755e942ab044b8e19e922a3c27922e1a5a6635c86f306337901c15c49e832a9f075e7cc022ce1b1779d4b8600ecf3186a84ed5bc18719711470a2a25573fa88cc3f2d99ad16fac2a80ff7d08d46d52d324b8b3918b925693ca902f962d4db90b8df733fe4e3b007815eee40e47ca6af9ef9d1a0364f760106190779fe002944ccc422fe689ccc6b0419aa64a470f5734780bef548112e2d8ff2dc1023352424f800ab6028f2d278a963c9292e472bce4f460984ad52803caf77d1dea0e3f8b232568afe395d3fd8e19d242980ad62c56b0e83deef81664cae2c92d5e098d23b5bac920ae152f087d6afc3889cbf342cb9f9347235625175d9d1bea650d4253950736e66250a22a6e1e51ef4fa5ee34cd0842e9ac4fa47e886be8b0372de3308142f560c5cddd1c80726ec755924ba5d9fef9d3319fdd2c771f50535e9499ba9bcd2040acdbf1c18682c38d5eb995cbc7ee47b69af86db163eb079b29cd09a0f280abc7f8cc24e0baa75956422f52dbff5fc8e33910101d59344fd0d40ba8debea36a184a48d3fff9f906218e57716cfa188fc909941070674c6060b725976382db3f30da7111e86504faddc73cd11d7e51e0bc155770ead14289788dd11ac3521eb37a55f3763c0ee540709316fc052cd68cef4c70acc16c3628ce0ffa24c8efee308af9a87e8000d170e74c2a5731127506e0e4e36695e758c18eab10dd4772cd35b59102728ea2d35d24d9afde8b0ef3a03e9be67bcc8c9561b01c8861c98b07c0f7057c4db26974afc1f192ab1d65a35607e2fb6c0a5f3c70ed221640c9d94df369ab6103e73b22e13180d23d347b69c5a703dce989088767ea92964dd84cc3f8fe6b72ef89e92bee286de08a2b4b063580547fdee4b1f43f10a3c25e960c4de1e17e732961a4996fb8a5a4e82b059d927235d59ea2a7d4a477026ab5c839afdc98f16de3f758456970b13749114c4e6fbeed82171b1a2018339cb08cf6b44be63910f6b871399c3167b998ef85ffd554871ff85c9d427d5d07b164c63619807cfc932ce2c5bf56dcb5e8d3003f9dcf03cc0b548f556c9750ee38d91ceb779ee7d7cf114ee1e9da977134de1347c121c0f29050084c1f0615b0346ba9d63ffc30fb2e65ee9df25f1a90fb7f88a63ccadf0732672d5a419cc27b9682db4d7a52b589e76dbfad51770e4edbec4a180e98194df6cc54336294d5b1690469d2316509d87cc2e4d10edf8db9a49014d06eda5d42393b537040887c7692c732265e8aa11064975d454eb0664b864197b22aa91b56af965ef91fbbb9f31b3d52eabc8687fd15ee7f6e47410ff2d303323bb4810e038b05a4629941c5f194d725533263be9caa6500e02e4fe24195d01db129d41620a75a271aa996a8a883471e3d11cdc90a20732f99b3f881bef2472a5cb843f711f596fd03debae2470363f315097c130ca8bddec5a20d5da64d3a212699e4e451b32c93443d1ec5f340e5e0d8fc9f6d9f5c33cd6387487568592c565cbb50682ae034799c2f9181c2b991a355479322331a2584fe980fa0c84cbc026a3f062ceabd7f6ef8ab79785d16c383f13b4a90ce16d125128fc03d7e30c027673b17ce514abb6a034333a783878ea7434bd5f349ef3ab4c1205dbb53e80763746b3236c0083fd1234c8b5b78a81dea2c2ed94650009e156a1a9594f30f09f0e654326a843e9277ad79be089ff56bf94903347bfc4de6ee70b582ec8fd8fd9ba65cae28dda3eced4b0f77332fdf67186aaa8440725615d725e6a0282fbbee972db77c2fe3915c1fb356a58b1f947f9e2f80a6fc9cf55a5e88267cfd44c8432b4a5e1f9a825775cec98242cff4195f0e6364467d8039a0dceae2cad8819b62825c5a3c73543b2f5746b777c29ae83839cb7e6e9700531004694d763eae0be9da0cf607c704bb50104a32365d7aade85560612c9fa4518845a68d322299e00dd33cc513a82fce495eedd63a4e236259e6b8ed6b2ef2fb86d5dc5d4c7bc66a1870f77951e88dcb1436389085e2a17eba056ed07859019274e9b6ea7cdab11553643a0e58956df7d96cc760cb6ed839c247ebc6d498fa106f2e415b8a63035486b35b6226615ccafaffb0ad0a8b761453cdaf9f6c49d67471c061e5ee6aff486b5a7e5bf4d97909b8ced981d8b3f62b6a3cb718241908c2a256a981aa05dd4b1df9efcb9aee546ca3ba4d1ae8093f5d466baaefe82482d00e1d40e9a5575074e71b0cc3287245f8c1f830dbab7c50cf125a602b1a04d0147619b9f086ae4665299c433bca4d4b5dcb81e306307de662a9ccd0bacc504da5d08a75933e9b6a0a3578e3fcb9be996b2b4437ca89a226c10f6a5f500678a871daf9b599cbc157e88d5685160cd1bd8dc56a28eba34af0954a6700addde62b77fde03847bd4693cd03aa256a6daa9a4d468350c6e0c086356ba9779e4f4a40781a0155da850a0da52c63ab629162785dd9d7a6b919c664c98d7ec3928a7ca0f24eb8930be2c9a2836fbafd3cf5119da42439ea5d157200ea23759cec987b0f86f6066609069f92724ac616041f2a18311780ca4b9fb25d42052308a09795b504916229bbcf27045fd3767700b05cb53d3533906b125827a2c980c78678778621a430112e3caf83db9ec46155e2c8abe10bea73b26513bfe1ac0ba41ee2e105381a3631ae9e0b156c2e801c75a42ad8e87460f52dd5eb3da3bbd78f5e8b044e7966a996cbb8a062b3dd030b5defc609f4637ab41e47a5e4e234008e67c1932d3892e6c7bda4da1ecc6aac61bf096af9e3e073de01235e07afd6f01a918892b8ae8cde3979905bd6902b2f20ce85078769cc6d3dd45b424a3dd0c0998549c50c1a0b39f65c55617c8aca786a2fa985f0121addf9db22b57b90bf8545395670fd012f913bc480eb109f04f02b97e948693c239e58f58bc1ba4de9e5935c579be94d2f15bf7f91bf2e22c8bfbd926f856d731489ccce37ec1320ef476e833d81d9fbb35d8b4dc409aefd799b9beb4a0dbed2143961b92bbbf5ea3b970a07a19cb7b38b0750459e01f38cb8185685523fe8b21cc172824fc6949fc548e2aa33f0a2f247db591ee151aa3d8b6b346f6b18d4c836d01ec121047d09fe2e36ef86239121c144b70e5f69b32ef4f0bfce05be140c69d291a4b1000760a9a41f24a396da0f1bbe4225bcd362caefa26f80660b2f37bee38c6e9b574958bb36249188786b2a8367ee6a406b49ccc4d7b72ea464fecddc625e542a75b7999c3b97c39e7cd6c8f4e49e70b60cb853262234f5f5ecdbb0db3d5734d9b8502d36c765daa751134c8e8e6c19397587cf1dbb084056dc254054b4490ea1a1572a721e85258f59b51b3bb6a395ca9dfd7a94fdd9ec89f9db30aac84a1ba692b3a160aa961e5423b2ccd5056f911cad75c4cd4e266a53ead76611c46a4d61c87307f2d922af5be3a784d1646bd3c375e04cd02c9747913f03d17458b539d13f4949dd2d8f425555a0ce51a1262f2fbebf81640d8e4c5425d68537a2f00b5b5315cd001222806a44ca98e9860efdc0a44198176921436c1490bbc458e8bf1c6e71bd5630130efdcc0b3cf44da8ca1c81718e6321dc99825c5e6c29f458892738b50877f242be3d658127e7fee7b3550fd0218d082de99464ff3f665f4975197b739c79e302c866b1eabfa4ef2991aafac41f88c4b08c49e4895171e4283cca0340d9f05e7dfeda4ef041f65db1f5752ecce169e50cbce0b162bf6c6b8a034d8b076d1d9a5796b060c29ea1753ea3b20849eb1cd9d89905ada79c36e9cc96ea3d539d36f9b2498bf317b3d1ec89775f9c07fa7da89ea0f10e9fe7adb8b712da04155dd9e62ed399bd10f9f56e4ae7e8ea67e493b42fccd054c6c4a09af5eaf91ea23eea6a70e73361b4f7997c6ba153571c235957108ac040726d7dcca842bbe5ca783187c482f5401df60790fa29c6e32524ff33102b61364b549ac0b7bbe5f300e6d2dfbd935bbd3c4ac80f564cfcecee2e09d975173c9421f6f63349f62e6f54b3cc84602c8af0ebe74c872784a469de83e92c2f89880c9b2db1ccc6f99283c891c18897c5a2e00f8a786504d3d98558f5f5250beeb1ed8e534615917b46531b51952434437e1998e5406709975b13356e3c8f1c84701d23bcb7b26fb5d4fb8be8a8726cb497de0455146648d62cc1955b0ac7c18102bf0b73c4697e9570649dd97da66ae0f935f6a31aa0f91d836721a98e9d17a7c0461af667b3baa35f03c217747688fc237c9b0e8ca4e6700151c9b5c43d19128ffa7682b4e050467bc14dd808898cdce91ebc2ae22b58c85bfeaa47ef1a8a13ded558409bea56a6accf04f02d940b64f4e9ce2a5cbd6cfa4c656dd56ac03631debc231294f959a2e840c7a3b966517ab4178f526b90e8c146fa9feb0f7ab0bb666995b9d9d59cda250bc6121054625f598c444ee8fa742cf217238db7b7ca2663beab52934ef88d74ac14d0591a2d7edf8a09bb3cf0ea903a9701ffafc6325dc07dd14c11f3d359392e87ec81d8d1bb8890d1ed268ebaf315a9ec16c361f1a2bf44ce3f70f73b24825de8f33ddc4e5f3324b44af4601f456761c34c3443c9a4be514442f7f42a066bbb46c2c0d0ff8f7432e21b1a7e49d8b84352c6ab8a71aa4321b20a6a88327578e6a5b016dc1c625a1259124e9172c5b27eb12c400ec6c326dbb7b37815fc8cd3006e1fbd6bc293457e3ef48d9c00524e3f821d0acbea1481209f48799744f0cad97b9392d5ebf4ee0dd239885efa2e683eb2974581116e1330deac07f7b23c448e91e3ffd50807e385756cabd7f5ee38fa996fc526430e16e189600d718a437caf30471df2cda838f1d2bf44a311144841b411e86c7cb597dbee7c33baecd0fe555e30fd4aaaae34e952fa62334ebe7cf2d2f20fd120957633d744529bd50536653300e53a57fa87714525fca8f4a8155d9fbe49b6124e8d8befb0846cd228fc0253aefe40e0e00b1b2c20f8a16469ec2e60fc1a36967f0e62307b57a46024bce538ece54c3c0dd59ed0a62e977ff1b83c7c069a85970c7498baadf89eb8a0b97a4ce9f010417bb3becaea0be4349c5ff753c0572877f7d44adb6d6e3ba7c2ffdce728e9cc69337ff1f5e4f655d2ff51b07ac8a4d86c0b4daa892c44791857686cd2536b6a0d9165795ccf21a9e3f7b1c27ddf12719e7a3549fca989e699337d4e7ca934b4dff265572aeb0330792eb0ccd62f1eaa43fe202798e9a8c7cb5f65d53597e0b3d316f36b9b9b255b0bd0ad4f054172a8fb6c29b1a97027502b8ab541804518c555b581c8e799f64aa9eb5b5426bcd40cba2736d6b97bc1b97822af7a3c228501e78a2cdb3d8f0d5ab7a6fda43a98132b201dc4d14ea6ada3255740baeb119092b6c6d2db93e7456bbfd72e652b2adc26a61153ad62065cb8b392bc3f94b1f2cb17e002f29fc4deba138edf8d7f0d7a713488bf5cba61ca806e325913addecb73973c1373041c050f482fe6477b932ad978a4fee51af152a4aa98418066fbe67203759926c99f46c4de5875c1e6a38ae6dc1eea9604040210ae42ab6a8b1709e399087033fd6550709adcca317fdf8f82c93d68beb789a99f5e787f0d7f39e8aa56b2c6838dbf2aed6db4102696d6b326927cc7e3845213a2f1ecfd96f9649c3293ca254e1011a18de9994c96f693fc3dfc32f5505cbdef3a28608436ab61476feec7430e336aa647d5fa75ef3140ca4d5c4775cd0f22a6b832a7ae874c99ee47e5a062556dcc7b5d92dbea0c67f2b8f8a7fe319c4e6c3073f2bef114820dcbc966310a9431dc42b4c746ec96b1dca02eb0b68bba6eb216c136fe5f6d4a60f1254d014cb15520e335b398029087f878f24cf5c240f7175d599f1f7fc176ddbe14f64ef4fef5a2f1c1f2bc46a2b023d0cd2b6de98a34646acfdf81896a4822aecfd29d7e0b62cb78c9e211c332bb3cd74f7e116e061e1fed05245bb272c4108a8d9bc9de9d98137af283cea32a338736b5f4c2b71616c1294b18f6af90ce88bdbb2ffec18a4081807f60138a50fbc00f25b0c660553f04f33703afc9a13b3ec6a493ebf85675d77ce3f4e045f12b06d13fe58ae7619f502bbd726d5f3442d74c623b18eec0b68218a6853f75b812e2d548aca00c4f72a2aa61b7ef8b924dea3c8d11179c629c6d61f9720ba73537489e4ad1f6475bf6f4ce296b3259b328d478999905778f361a06597d1723a908ea2e0d6ef20bc05a773624d384985e3beec8e0a3404ff217d6d814c1bc1a02b99c63d7f395e86a07079dd529ef6cf851c3e38eea83c53dc99e0972a910497868a4f86fdcd353d37920402acf1204756e1b1ebd3155282dbd85f4c6d8ba0d64b6baeb715ae120aaebc6622ea0d57f33e4e7cf149902c91656594e1da065141687c75cb6dc13c4c5545e47ff7c972d83ac2292019007ead7c017db9307175e8a1ee19485b4d244362f0b76caac46f01f13c60b072a0c328567debd44bb447df2703a71ab8e66b6ac13ffc01ff409de66697a6f3eb00318e0238181d318b2d4d2c2fbb6a14c4004ced36f42bbd2d7c7ba5676cb855d34526abd7cb5fbd55d39184849b8b91cbe663de920be4678f983749067a5e7ceb287d1784bfb21fba73ad51e7b003bfa407db2e85abbdf31a5daa12133913551adc4f375db30a7e2c6677d41952da40a7fd9eaa0f2905a6a3e6e2dd9b7e8e4e724f54fe85b25dc20f0c6f54893cec6a5aa5cb328999387fc0e6a28152110a033706d1277bb4139c5e017667a8eeb04a17b1e204664183b256d081a6a5e800f3ce0d07300ca3c671b66362980e367f076da9f02c17eea16723375d2f0cf1dab5937","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"fe727b3ec2446f3e9140a7a09442f679"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
