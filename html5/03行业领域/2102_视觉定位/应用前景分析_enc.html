<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"a23bd7ec77e9f51ebcc58f184891d4f94efe7f46249c0dcf04092ad77a14b2212d55369082f92d2b48ef8e3260b8cfb0b395fd21d98e03dd48d4950c8cddc22908a784ba6934a0555408a65eb4f757795e40d2d4727ac8824b2b70c3db62f0860cee83e1ed843c85dd5b0c185de82a17a11264570746de6347cc92ce8ab81cfa800ca8d664a251842c7c837bd2d29e89ce797ca6888281cf23bf0500b014e01eb15c8ca52b98a65b18ce355be957fd862e3da099b700192e4e173b490ec2a832e8f4950bb1b95d8b0a6c43bfdbb28b315f73fcf115804af3a4b75633b2db19df6688367edd6cd65e8bbb8f94749c1a52806698b205bdf5bc98ba66e0e796c6966c17ee9c87849aa49ef4ff0a6e408c8eefc16b0352d1faa4f597bc72cbe1525b854965540b9d04ff8f5fa55a884507c9d044e0d01b6acf5ac6e40ab604a971e690a82718e7e1b7acfe68a171bfa87fcadb989560488413a5ad66a655d5a90923f6257633ad0a9b46ef02881c2680743b8d4a15f376237163d2f21209086ecc614b9fefe3af153cad2c7c9ebe9a1675a32a834a12d7d079068d2c35a31b557082681466fb33b40d8805caa6818bf500e8db68479c0b8ad2cbd6f75e7dda2c9e88b0be545d25af228a10d2994b26260b1a0a0d706e2856eb1598252c71586f3cb310a38c2143390cfa0138b915a89d3e958ff0c36478c87baeb73f45537fc4ce47ca1d4c6488afc2899dc8d82fb9bef4a1d1b57048598d8bf04687b03fd67ec2a38ea1ab901f5e0b9723b4d3f2a13dbe8f912430d44849b48b2b292ee1dadab39a1a8d52ceac89dcfc75519f60b5d801f60be2421e4e62522fbeed5aff956ca34e63421917dd981b698cc29ba1b777f4b27a7c80f1214d49c63d2954007b8d6e773e4c76acdffe43cfb81e773b7722cb80bc13a60996571ccee05a78dde3a6e0dca0ef82ace4a826d8b7a66564d5fc8910dc1d7f111e6f527b58b5f3a2d30db5bf2ad688a74d94893112608c98048419f03bdeaf44c97f7caa5b792f62ed8e2a0dbe954a8d7cd180af6369e9599a14dd797b8f4fed50422d2c33d8550b8fd8a85f1fddac01378adfff45abfe2277a82009525cb0d17470854bdf0c55dcfc79e578b19697f390b2f408592a0c76e6213db9cb684cae9be3e657260c77185d56da24ceac8e3c8e94151ce3330bb09f1e0080a4b40fa368c8242ee306d670ed2a2c49b612f718895b6f450b7600e5584ad3adee93b8422ab7c0f1a49d8e2eb0fa7351d15904c14463303b0faa280595557680e9be00dc4670a9df0f116e82d70d0d3fc8048f7e6d3226742c728cdd2660fc31632c63f33c596359401ea0333c3cbe79afdad9b9894410d2ece7e72c39c70f9ea72d0932aab37069427927d1f90809f3c58ea4c4c1410a2b5af734f16716326387db7382b591b557f83ca281ca270ec0ad8214c237c510270342c2bc4ccead9131355026002111c8b402c5bc3116987c04988a90b6069cde782f72e5fa692a584c746b064cd1839eda7803e29577c28a3e15947c387f9b46ed6b0b8f353c421b2aa1e1642b144a9cc452a044dcf4c659196d4e94974fd444fd6fbaaf71d76dff7940bbf447d995dbde39b5ea35f100309711f66ce06e30221b1329d89029eeeb227300bef9898d4c9f8e8e3526f59671ac83e01ede8045491848ee4c7f29127e407d56cf5686177d7bff2d8b4643ea5c01ac0970c800bece12e1058e36ee1a3f2907798c0c573e802fca24a731e17cfb30af02b7d8c65640989680b9b6a5dc78bc0475283a67c35a192b9b010980bc57087f889c6d0927fc1ff4998abff6542d94b17efbdd37aa9e6886d02c46127ae6b62c195e5fce21e93751b79dda4cf83e7160391caaf653ced5ce2ac1337aad8bdae1c9d202ff5e78b7a9edd208b709ed5f11760bbdfed471e55503005d82ae790bde500d38f0550a9b2aac11be5f11d29d3abf16139975f9ae6c41051a73589377034ce1d1378d0fda8d4ff0d9f429db77b352e4b5617613f29b1bc1d0711134dd7ab035fe458bc7ba8983f818ecbebcd1af21e658ea8b0c781a5ef0fd53fabd52ab8b5d10bbeba79370f51f8381f637ee9f2f52e54be03514ff905dfa51a781cdb3dabe52020b19a901c11d0b7483e1100c44df67514d96e76b14e20a151cbe713be9b8e7bf3914a7490b0596a5f419981edb7da186d47cc2ba72fb5562fd674f0025d090097c29b110eda9a0b12f1eb9a26b7e839c0aad2eaf085191ea00b62275705e5dbb0fecd07707fb990d0ef3acbd54675abfb169a93f69f722680545c900ef4c11176874743186e6aa2ef53bdcb9271c24252c8602ec8b719d07e59806b317ac76b9e3d451e7cb483ab01a4d419d83e864219856618c3a31d84a2362960d8497fbd47a796c43fe1113087d1fb39bb9f87151cf851252eb94bf19fa99c4269f86b54ba649afa7846c634b3ca1652172a5d2da0e2d729246748f13efa0a80f674e6a291b53160f8e2629b1f77b6b7d473208e80f84380dfbdff33daf99bbafbaa9cc97645f68c5ef23b0cb114b7a722104ce7e4ca5d45f46fe8226fa7c299c66741f577198bed0ad84b4bb5a76d45b3cf397f2a48d1a419179666c581f90026e5827d89889a0cd6ff8cca2fb8ee3fca3f209a8ea70626f03d4379215b1255260760b7302f1b6a5e9e260036f8d4d21ac83ca3f1df5bd26ebd9412e99c689a42ee5efcbacc0a23712c91b79749781f828be9900e450318ca9b34c96a2d69a76034c014f4383c3edbead097fadd2474893095a828388e3e4c50285aab2dd35807229761bb8db943e8cedd8400f3a5edddab7fd707bd11b46912f683989bdfc79c6ad46e485ca633c877377ec4234cfe4e306193ba037e3d8c489241e4fabf874d8e104fb40c725fe04d97ea7c8f0d87d941ae7b2546a96719c7fb1b27eb7ed3c456b3407f6dca44a809253c99252b265e5d7e7cdf91ca48b8c8f3005ddd1b56ed64fc276ec6508d33f1b2ea639eaa6610713be013bdf22bb97c10c36fc5ea7ed4380cf279359e6bea39b90fd5c689d5898bf39bcb1e776141752ad8a2626ce9e5f6fd18066acb7d91d85ddae3aabf50a99a71ad8bc2aef4f4f305e28881a01f086ec18c644f1c42783bf7199eddea94f3afe2557d3076f34855a16b7e332fb3b7474b439bd9ad0377b4b62d8eca392d89acfcfb72b329bd95ba6d9ec5b68b7d725a0307abef6d1e72a4d2b574e97c05d45d76a41fc0528bad3fa4b3f5efb2d36cacf832bf739cc2608af3b888fe2a16c906790de08f0c6db7628803a64468c334e1f95c564bfc787fc5f63f5b4551755b3566b9b5592befd84d15a75ea315e97c75d109eb3c16be2309b2f832db32e43e0d9efd295f00f592fb266b0d8ced7c78f87661c94049723c396c792ca9d2f76ba96e150aa317a7b333e386285d432a79c33dc7a9b754619cdb21f797a7e0cf9b8a9d7a6fec54427836e4d5c5aa43a7f99d25e066eaf8d61b2f7bf61c552c087158f9569eaf93139fd3b8abf136bcff85f12995c43e010b72655797a23d17065b60bf2f81ff962d048812fd396b125787aef94bdce903ca115ae3035974b5b0d88957efda7b4ba5e88df5f0c43aeb5606dd35e4420872bcc9505ca6dbf5f647c2f1610f91785ede5a25c0f71a6edc9916a5c91f67e7cb51c51c906d81c5e4f079edd1d453b21c034885e13263d255f35bf92ec7ba72c5d69d42c8e55428fd148b17fb45ec9adbd3ba3220f0d28ade6713fdf2a546b353f3566b67be8c11888499b56c5577913461da9c09be01b474694a447e2f064f01c967d5d63c5090a5db03ed49ab3bcbc6c5bcb02223c5f916651fc1629bddfa7687c12431ec557f2f9e32da8ac1c3ae426715fbde84660ed9dfdfba9476772c84234f2a26df1126f165282b872c87fac9fad1eecab2a8cd4a54e0249a3b2baf83577397a0c39688b84fc0de9e423c402a53c5b03b384150ff81e3500424e96e473c4908403cb5ef646dcdaf955079fc74d6e3962ad3f8eb15aa0f7497fefd6d28dba48ca4289f8316f044fea32ec358738c57bcd3278d94d24475c2da104607f5333e5309025c997359f1d6b8ef970883a39aa38ee44faca6d01eab590fe9b88325b9f3e61b61ea1a501a27f5f0063fa58d91ff2a8225e018960d4f5cd141f8f3a3d48440fb06f3e2b02c14aed62d8f3e1f0221d96f7cb38c67087a9e4fe967ca691f190487ea46047471ada7cb197677d437321e5e84025ab360a3f51c6fee1a4001f2e27a45641e39fb8fe0ffa85fff0173ff2872bdbf5283bddabbe33b0d5c5ac50ca46f960082987bc9a5a461683cd19a173c7e218be3b5eb87a0949485eb7c036b3a682349dc3d01d2fbe0775eb2f560d25c193dfae5380668c57355c5c8508d3bc71fdcce4763252b576b6279fde5d39442eda12a9770166c92da3d3d67d65b6f2c972221ed6944774d669e2893b5cbab67561ab600ba81861815a80d9628708654a4f9ba833aeea134237dedf9f2fedb9e01998082dbe92b619d91d74685d4ad8c9d0128851d2e0f994da5e5c375ee6ed643315907336f59661041b9a1b34acda9bbff40c42bde98e6687ba123efc7d41c9e8b2f368e920e617a07b1792966bafb52d68975a79e70b2002c56f9c3d9a631a6dd01dfc149df77d07e3cb8c12468a038b59ecc85c79449fd99be73edfcdc3b768a5fec681d12d26d9c02e0d345717fb3e540e220e7497330aa4b1161890ed12af535080241514bf7902c557140c622c09c431ecce75f72980519d357c0da5d0a2d550103021ae68fa12b519a2cd2624af58669d189c69d16bd0d98b48d15bd9b5c0fab7d7e0d25c163244e55c2bf1e17b3ec1b0d4cf09c2266ccde6fe9b47ed3e3d3b8080b4dad88c2e7e81f240ecb198617be0cf0425ccab7ed8cd36a6d2eed0c22a10351344b778994f1a08594903213a65e22095d7d36bddcc4ad4b5c43661458abab70f858a64df3f2941f6843f9240bf2b5c2c6e7a34b032f9fb63f149945831e6f9167cfb828993d2e456cd23910df7005ca71f1d95b6f6cdee5ae2a138be10a0910d5dc04da35e1ec27751fba52156a1a778b8feff8e891c58d9cfd413bfe64467673b3d91896c4e7ce88678ca27b5c6783a967e1c4c91aebf6fd06f413992ff77acdf8b4d1931bfe5f5a6c0ed9384a59aa8975cb9da68b4de1baf626b5350a02f45937c716166a49473665332d6d3461e9a7b0ce2d309c517ba79631f35300f81b207bb55b27d273a0313deeff43b93b1142230a3bb50ac2afce8a42f39a813eb2fe8e500dff8ff8b7e5d9606a712b129b3e6f7d359ce8bcad5eb1ac24e0fd7f4d082c5dead8d05a7378c6e64e0f9bcf9c5f1b037db80f750495db26ff91d8c8131e750ebe2f40893cbe7be260f8b724d114451e8ea5c519ad22daccde53c3c011fefb8b1154abc6ee8046d1c90c807e1147c87a1516f104a397c89cdf3c62efbfb3c93b2c1b1a5dbcd75c2e9d25f9a24189a6e956ec2ede19a9191eb728b5b1733f17bf0f5d0e36751184ab50c936521dcb88ce524dfdfcd8c62d29ce49fb09b05d83233e2d3c26f15c64f51ae5a76c1cd581af2f7c0e939b02c2a08c41948c7c6600d23149393bb14528a5d804d73dd4d1a0c6e95f2759dc171b2fafd85f80a3d656e8fb07f87205db1e259c8b11469ec56e9da0d6eb08bfd7617ca53087cbad729741657ab21c6b01136409afa69791f355b1eb78daf90c92741101316f5ceb567b75f050f7b965b21df6be9151817fc6b3484f6379451929763724ee4d03c107d3a6500678da19339a7bc15bbf24bc5d5f52da7155a4560e44c794d18b05449dcac6d300a2203324f436affcb2fe54947b6fb583fc68ec18efc9d57ede98853fb2e9a1529cbf82ef09932bfd6a7fe6d4b884ad5968cd4ce4d7b879e0b3774287edefd0b179628f8c2c00e15a0785e94736ae9750e0369e22e55f6a084a92d89dae0786e4b974b419289b2b314fe088f8a5d977b1fefff3cd5e297a4683330188efd01bc0043fb8ccef96344f21df90be6ec2df83a6dc2231cff4f13ae70a21893d090009bb87f9a1efdc74cb09c04aef5700356fc8e73037109b583876b43f6441299b630f99439c3f3140da5b80d6db695ebea2e3f3045194a0f9a57ef347e6440d250bb82839a8b9b88b0bae975a835856ccbebe6085117108b6630be09ef1ab4ecaf1a39c02b7cfa1a27a274d413d13ab9b8bff456c518c06de53de5d1cd961dae8dc69cd54dc200fb39e2135b4c1ef4b816ddec6a9a3254bb168f2423cf8c9a3c2b9c75a0f97df4eefb7e5788687e04d67f281ffa4c21d536dae71dd935d18067367c4911d1946a2c21efe85e7c6481f9160aba5db3708e4eb7dfd4c89bbdf49a59b29fdb4d380ec326fa3971e63f77d05f238241c0a45c8a984ee5aadda4c0bdccbeea70572701fc996dcec8ceacdcfbb4944a1c20e713ca639e7636bd0bf9cd269b0103f956320c54ed63566ddc1dcc616d516a9e28d76164923395b8e6f273ec3a708739a9b1ceff6af3f1c54151d9cd87152d629e87bf1f0ed120b4ad6d820b1801232f0c35c5ec88e98501cd88360f1791e92387e5236f1286d7efd0a39622fff8323303993f2ea627ce1df0952436961a5f5e60ad84a28bab3f595c645cbf8c9aa72595d64765f708dd70481d6910509a76afbf1489be2e408077f023e89d7d40c1c0f34157f256ec23571d1cf004548d20084ac5dcf51372047f743cd732b274eaf52a3c7f4a6fe556ef4e1d0bf1734756b7dc79848386a08ccc4dbdb2f95daf09ed0662a21ed6389eccb06f73c4a314f10e5bf17b2566941fb38dfba2bc888b24feb1c00f8fdf8c72cac16227da17365c5dd851d118d49818dc4e644a02358d0c526ad1b47ca1e13dd8251833012eb702c6c08dc39f06e87fd0cd88a578e82d6073c6635cc6a1b693ba000a8b9e0413ea4d8f0f6c62c78bcf855cbab291f703fc999f2be41b4bf7e83f2f4fe1450f2118c07ced1c67b43d8bfcc76a0412d4f267f39cf3f13108e9262813a8095fcf577155dd40f85ef1f3387227317f2678b782abe5af8247f1b9fcc1a626512b871b4abefcc300eaa23a6df3ce497060659ec5a9158572117eebdc33246ee8983ed98ba61308479a7aa2d1a2c53bc6f1e513a74489488a83848fc37cfe965a4620d9c311fdfb205a213590b36dd4c6c843ec7596b9d2e13c9c1a7059632c2bbefe5fea22dc7f2a0d2ec8081dd3d9e3f808572bc41c5e2ae154a46b61696b78d3c30d6253847a47408f7aacf94a8eea7a5d47423fd94ac1ccfad0d7bd82a725e428dcb9fd5cb292eb04127ca68f08bc38999aa8a3e8f170831948a83f6d0f7f2163507099b2f7f35f6d16a6899066c81e43a37d88c5207f07ac7b5c60171d05184bec8a0a48f3bfeed8de9342cf05060e3cd7b19fd8bfa3d339b473ad5172bb4c97162281d51d4a1693d69360f6cebc16a056a95e1cae5b33166f0107794449ae6333411cb625ecd1c8414b35411abc6c4b77cbff339855c8c9993ab34724a78a66bf07276204d5b6b2c850b4d549354c4c0e236bc6629776e6e9e091795fa0fc0715930af8675f10c3da9257f46bf8b4dc1be56ac05427d95f4f7ea17f35ab01ff47da4ac68dfd593524bd660f5ad901dc3c6dd10536ac0c8de75b369b28e278ff8f6bc7cf8a5ac4a4377ea67e039ca6b5fb1abcf4b870f6bab97c4ca05ad2dd4c66b0d4ec838178da7d50e55327e318d89e4eb1b39791b7ada4dd0bc262794ad643ab537acaf7a7768fe5a810696972976558028949ac4b2e63b46fd2486b5a25ad96a4c76a04b37b45fa4de0e5e79f750b010f63c5c2a74ee176c4e758dabae5761b1e81f4ec2ef317c9f9a769a3f16b4e6f0b8742ac08180f2998b90176ff374905b565b4cbeeaa88268e39e3ffa991128ef54cca316f5da7157e8942a9a5230e4b51909a03f7c7f0e6b888a434b1cc4f1e9be3bc918e795c678b3d63963c92eb5c63db633e284faa5d213fd7f5142825b92281398cbc0ef32193dc60b574bfb63acb4b98808a30c7f703de49a62b71efe543f25e6027d0cdcc71a653636fa466207323e9916e1afe6ad7dbf7274426fabef50efff02c67b50230c408730a9988efd99118d7f3cf5e7af57d22ed5fac3a72761ad291b48b19863d5363c774f8e4fd82dce5c1f65ae855db1644cf20dd1cc709a84dbc36b87667d2296550f34b97db2349c08a677c4fe015f22b904eaedef5bf3aa944ec62d4b4a87a4b51d8abf060d641bd6790782d9dd53840d1fc92e8cbb1b6bd9414306796bf127cedb97a34ed9ae5c1f68600d810e712e2c1d05960dd85e55085f4631f49aaa011d1679e511e5ebb939dd13813287e500b1c328e05dda3150f6c48998039518dca4e0e0322b931c9795240f16161c268d1d1593464e66bf907873fd7b78fcfc4841bc2d485fdc1142453c013b35ce31ebf3673ac9c55d5c479ccd82040614c6fd36f3c8aa10ee0159004ba8ca0fee4a2964805613d996d16a0006e4410bc3e11e1efc1049f5c587d995467df36324087fd95c97a27f594a38d7b68f1e1b43d8caa38cdfc02ba76d5e4fedc2d1fea5c12d7c242a5cd1ae4d0e4c0ed607571868d689ad5e96d89398c64e0dc358d5100497cc095e4c3463fcce6a41af6d4a5e474108c112392ac10e8c6912ea10a0e6983a0bfeb13e5a283dd08b0a768fc048775a1a1e73e0a579e7a1bfcce8262e5e826a1f0796241e3df6a13e72edcf58f507b9df5e9a32ea6b12bd4f2f0b865fce08ed01ad5be0ed931256de538c22462ac6813e87158a402a71b3ce0fccc1c0727ab6c2c30b7248b4e68b9b907ce6faa0378ce354b81209297d4c7b3387c39a33fb11dab430d4e9e03641ec9ac602a8e135f5c89286503244c533f456cccfc8593501ea8f38849635f41cbaed30df230e169c7d561045e9da691d87edcdd7f824634ec54dd74341b34a650f20974c3ad08a87c6d7d53faf016e98b14178a291822b7712234d3b73b6fa3cea383e8d88cd994dab43ba8f32a48e0af67b6f1f48ae01dbf47fa424f52ca3e11d501a3415433da548808a6a2d313fd35d03e793a5281632b50b74bfa02b70fe082ed9faa2b08d514ae795085f74d3b02e6048db1734ece3bb62bae94447e19ef7bfae8b17edc7fc39c919b667180ef3ed6ca4da63cc50c19170870e3b63cf7eaa531ccf225a5f6922a950aa43f459743d662cebcb58050e14ee82684344dc7e2f86df1ca2d6231e67b1b33bde6d5c74a0c2ac3ab0f84f7a811d869bae59f22ce3ccffe8490ee0c58a2932c538dd2997461ac8f9acdcbeae2c9a80d16e7c985522da153105854122b1be3b7c9f8e273b34619b0fddd39520afc13eee14412c9884b78d4853513e93d008040b8d3d25ca5d30503637ac1692b76650b4f29fc6e03d6567d19b44a70f9d7d9388170aba2a0ff86840c9f055845e27a6c58108d8045344f8b787deaa03dc935fc2fe7cbe41d3dc9a5a4806d26eaf2a474b56ba7ddca613a2d66a6e541991ab67b2987f863ea3f8d866e4a139cb353e1561176d1701105a8b6c943bf37572a24b865f51a5acc4dac773108650a82083229e4a59b7e62392ebaa7e000d1462f5137b15a8c849befec999bfe2718c6e34c6f6dd05cc418ef92aeb82d37f9e4870c9292117ad50df8d72a8b508da662b50a08c39ffd011c80ecd41d610ccfc7c4e10c7b60a498a288f20d9394cbfc6023f318d51fede97039660c1b54babef67c513c2b1aa6dbb7c079027ed612b3bde2c5a540d3ed3d6d46fbf1271c5ab2b8036def4aed1b5b185065cd73ccd0a4069d260e6a263bb2ad5efa5b122a66f162dcfa56325afb548fab96c3491a7174ab48631cf1658e5abbff62012059d39c606e33294d935ae305c7e570c3f50cc3cbe03076df5bf821580307907ecfc411895f4e78af998734bb8dc6ec94128c000105ee8acfd43b614b426c7086186b7992d40d1cb641960746df334058aa15d3d4dcf27b37ee2d495608aa7dd31b4b86894686a1ffc1dcd503da186672b0f262f35464eefe903ea0f1dcac0d2ae33066e9a3d0a2f294a22e31727abcd1507f2e478ddea37823390c427a5ec3d9a1e65bfa728506242dca483304359e4836baee2a652d9e6501e2e622601cf002ce3c287c99eede07d41421127811a921e74606dee771fca728a73ae1059e6ef30d812a416f5cc6b5d2ddbc69b6cfa35dce37ea5a4b82bf188b4a4e31b9360bced81cecd0129706aa76b35d90110e5aa4fca4a5b76bf36d72430315a64356b1141ea0bb61e3318d6d322590e3717be7b414667730aad12fd552ed63627af9c65fe09ca9c4b4a1debb43ac3ec554c3c54b0875502a367ceab382f796b23e9e5c06c6c764d84555fb18faa86ea0ae93e8c848266b1d8775a8630443b079ca734eb99cb44ea37fa04030db38160e3a39eab5e0bbf59bfb92376461bb2f3bf43a70c08160a32a05d455b5a3608ce55a1277ee4b05ff902431bbce7e5b8c523d148bb4e7cdba8be669eee44e114dc2b4e4fae83ef918bbc8d07d1fbdf3e4b03b93bee59af63cf6704cd8f49bef65edf1d181da10ed3e32817df97fbd0d19033bfae1ca8af8681f858da2c4323bf61d7e5710f89f4bd05dab470a425432fcce4c570d3d0586d23a0cdbaa7ac5e77148acd715aabb1054bad78f350cfb01a9b208c15cf43f6f5d0f528d8338c83fd08d3840160b94aeca25b4c8041e4d2a2d6ad62405fc62b1309e9e27bef65f88071f9fd94b1205a86e53b18e7e3ec5386689067f24e77936ac3178abcc9515123a761da18b7f91fd1e5f3622de737bc9518ee6a14dd26a8b99facefc5c3e961435ef8c5eb0d393cdf3f2e18c46398a068e293a85b82076afdef3d1797bbed0869eb21e5ec7738cfe038120205553748746de6a3e05c29979e31fab5d0a992e4d904e53e637eeab38307c21e64a22fe2193db3efbda7b30448133b87381d3d4e8b8e8ef257133795735049e0a00db60f41a5733e447625661455f711190b2257c571c1a3b45859109ab8ff51b8db0c54f5cb49c5375f3633f75a4aa4c796da80283a4c084d3be7e547fb0f8180c438847ad81a2a79e4f8b0ba3744ed51219e005967ca8317a6aa1da93cbe42b3852d74ea322d743984ace6c94a73c298010665fc177f128401167664c14eb8741ab7ce99ffc26be99a55f769c97e64b8a1243f4c6ad6c9f3c394b983a9851c7eec473dd066c31bda4b215df6c06a3878d7ab6fd29ef01fe73c284b2863b38a2b302de167f6b9bf0e034a22615e06e6bcbe487e355cc5199bc53a6ef9d1abbd82fe76952ccbe1e7309971eb77d9b86ac7bc39ba2c8c1d55678f0633f3505dcc3681a3bde25e8307126798a87a273bb39518d5ae752ea56c28774af5e7d88e6ae4ab63b432c899e9ee92481351d5891afa9ca4ce3c9fb91cf3456f46d43370750edb8a38e89c1eda542c6f06a47d1c3080de67af7ed0764de1cb9440e14917a6864223eb0ad6841247571aea5054e568c37a70cb73659a4136b44ad3c822e09ebc749ada68d26414add5400a728d6e0636d0509e10be853bf5a14b112ffde56bc018e7a0ae6a1172d03f22d16cb429564e70abf59347d50228d1bca20b8051c74d4a43f417b583602054de09f4903f8da3e94795d883c4e0cc1d13bd686a50992feafb0001757e463685334820995d2677c767e442e6238a8d0057a4d54ddfc2b47cfbb32be01f54dadc13dccb0d2f5a3794931329dbefc6bc109724d93eab50fdb31894252b312a9706d5c8c5607fdb3e217bdc480f548ad5010315730a84eaf8208e5cd9db9a00241fc919782a0c50d77b8fa1ffcbe7a2d71a2178f1682934f04671dc6b18e87bdccd09c32a8f8da0ed80bcbc6ac3dc6c21314368d8078ba638790cfd7af7225f356c1f1b86960b1b0ed6215417db73832b4ae2bda8876012621b7b5ba29026554f2af95c88444e84d853e82be921e2eadb8cf546f988ea87f486555500d6860963abe26bcb52ee4adb7fc17507690992e0cfcfdf5099c38273caeb892e140daf5806f23ce13a9e4c277d5f9756e17b3a49668de619783814f3e7160a4d12e26f0e697db14c1859c25cc3ee0cd3d58ee5443ac5112fba63f858e25f8688679ff7e524f525f94f698b08b4a91dc6709840bf665870b2814b896a747a8440487ce78714a84d4aa1c7d2077f14ebdf5a34c5a9ad4fe660c1b6ee557db88416ef5ffa3c868adbb6ca687f7215d1ae17d569d440dc65985f65c6db02371330b7c9572cfc20930c1c9ea961639e83bb4a4d0b2ab1c8a4cfe40358580b16602012441a681663a19179d8351cddf5bd8a9446f02446419f7aeac3901badc538f9e6be187f139e42daf271836188bb65c2d279fc7c676466689051ab5229a2604ca56bf71df805b771976de3ec569f75363283a8ecb7fc94e695f17a6f7c4207e91e5959e4ea8b72246e94eaec3e96e8f2c7a51674e19f8822cdf28251e6975f584291e091bee84b1ea695b1be0da5cde8b15d09c0dba538582d2092558dba352470f270af7dd33b680bfebfbdda17e93265df91fa337eb8e2d7724022e3e57889ee7f60c04a03aaff57494f5091a1ed79af81a480f44a1a9622a614d145d3d987fa5d20782c240451121678efb17bd3f1b8c1c62a7c3bd6f20e0895e555bf0091bf1e7a70436cf273a41b7349c46a3a541a2ce4da2a4f2c3bfa1cf06eb13a4f260648dfc98f86bc2beafda96cf7ea118f719ee430145a53edfdcf9beb2f58e2a918c0b3c784afcd7697968c0eb64a98985e9ea830dc9b848ac38e8101e3ca32a280fc9bc39709acaf808357389b18e251591e47f851ce37000d64161b065af4478285b07f77802aa3c72e8c68d1d0c5a5e52b016654afbe80f631022d9b34b9dc5ebc9c56e14217cdb98bca9fb2142224e35aca1f35cea4455497af8b385cb37e7d3dba89e7bef3dc000580ebf55078b30131e4e123bf0c325f52e89069bdfb96c006ad6f6adea86d9633cb8eeb4f384c31889f654f37e6a62559f14b47ebeb312ce07da93795507be142059411dfd332620b43efa5330ce044aeae720fc1327db04479e506df39a49c59569b5c696b8570a27d5014f1dc1495e0a066ac608047f7ff69e716f6fdb5394d7cb99173a061725d3786801188063f3b656218a398f74736b50f1cecb955106489163f41be5cb50c4fa74fd1e0aa892923aeadb7d9fadb5ae436830a1972485d62b140c9609ffbd10018c547743d7683f5194a9280300557a51cb334a93058b950d5c8790f89adcf291f47184282773379e50b8ededfafe4f488591e26dd7c491648cfe8e273abc358564e012bc403d248009b55d438711b5f94b21060e9efc486b0211c35bbe05583aaaaa5a8671bccd02e97cfadbea507ad9ae062ab145a5209ba97b002cfd869594a7f5d5efa24d3ae880c3ae1b9b21eddc4f49e295ab5bf37767de7892c9a02317a696d8bd409b73c27df3c9cd8223a8ebce9d06eb296673d7d44f38742f9c4250608b6d115ac38885036050029a6501d83a52cd3f70198512558dde2de27140d5f9fc4ad575fe615e9fe6f007fbd0d513456caacc6051e99d20f3338f7786447c98a8c7ae198d0702127f0c90f265044f665ba5141e5158d22bbdd9379990529a88af5b92f4a33acaa9e9bfd54b9d7ef6166872d4cbd7a662ec8e421165ea31a57ada5551c53450e9777d6554dd1a2f786de11ad95d0ecc49c3d2831cff57083c9e16d39d28596d3e7688b5026c4f0cfeb12703b8266c5e08b8896201f34425b7d27b8029e4639f331506a2338a3201e10ab339226c02dcae3976d31d7f810ac388ded7e789ff12a4e258a54dc4c28c45ef85f545a27abeafba65fa75c68e7b41809d9d8cfacb334d5c601677828d8e54ea08114f27d1793b07a9d184192a6ab7fd77e0ec3be5a067bcc01cb841827ef44b2fa76af8a15853bfd63cf2560e03354246d40018150be85f59aa8d43e8a0640fe73a55d846f528229f77cb72dbbc526c0ae444876c6ffae9722ce0e59b7270297ecc0b4df16970318f55e0ae3d3e6860fa98e6b0d9773b192580bfd46c82ced1229eaaa5c846e30f7478658c5eef3bbf0505e03c391dbf62b74f92f3cff073f6d51758bac1c08e67f064475ad9eaa0ae79961aa3812880a72864cdeaf9f824cf8bcfe20589e2f24c673c435c44e8c8fa617ff6e4d6d9e50ea0e3dc3743dbed8b2458ab2581f7dbfb7274d28313de80a6e7674fbe532ced24b53bf9719088256b4e16d10797c51bfcf2382840475214475a98c52fd8a1031b275e36121cf74d37cb88e9b06b8f05cb3280e80417434eaf5de79b9dde13a76f56b5f3fad041b9ad8ff3b1b39de78ee771e945716b996ecc6cde8b7871b630ffa789cb194e2c5cb825e7cb3e5867084d494e4a49bc32c793f6774c9da4f3095f98ce8a18c938fd2e816125c1d8857c0c15017765aa0c5fcbb3264d67f64101aa84749e5ddf5b65ab283e20018b677c1448f67769a552948c7ba30643a618506acf3efeb93a54d3a91a0b6a926facb92b6d6cbf9b822acede2b3d46e026e21d11175cc3f75de24aece2c18d05e48318900708eaf754aef352f7d6256c333aed3e6ba9bdbac68bed2a29e91a7b91e69a19846c40691c6d386856280ff8dffc832199d3c1ee56e67b94b33e525f7a8c5bc2daa6a009a51a6af0f99cbe2fbeb50a5c30a4d40ff35df80a3e02bbcbfba125c99b905c5a012f15c73bad153f8e2394a34666da57cd4b5587e5c46e55780e36ebc83810fbba851eaf49ea7e09deb3b9b5232d01bf2c9185d6814e6fddfff68c14e17b3827884a73ecf1ce8ec4364886ee2ab638cb1c12df3a9342dd8debc79a6797279ff5b8062357f978951ea9f8356c9145bb9d9f00c41f77570bfa7e707f8ec56671b277093e21eb6aca1d4ad65a723b7abdf032fdde15ce8784b04dd3f66048ef809d4fbbd63396711bee13f7b1005b6ef5e5b5f4121319005a540ba5559fad5c07bf3d1bed24bd7c9f9c804011bae44456121dd996e610515474b58ddbf10d1d5787affa122ef8a55b4c44a1ee28362a0096aea91c0e685c83ae71c1d282d32f6c730ed5381bb1c9b280bf177f6fa73c275f2cb76dda9296850b1920a972c7b77b4e4fa91f3a35ecc55a2467c15fad9245c7735a83a91e96ad216a68f9f87362812975314088186e72c19049c729c605091e2d2679faf644ec1161e1e93f21589837f36ebca3588efa4cf01a4d4b92961621e881df4d7f59338bb17b6f3f9b1df959c37074f7752a09f06492a6ee40258d22163f85a2556c97cbf97b1f6ee82812318623b2dca4bde27a63ef4690df8dcc56a27f78a564bd3e30f06a3757a01bef81b09aea8324fee479aba628b732e0cea8159af2bb80618e6c251830566d17326fed4ab729cfdc681a450da2aaf60e50afd02cc61f82cdd75afa2d8f6927a98316ecc85a9955c05c304042b878172af193065afe38ec21c335dc14ed164c4013d15605b0bb42e0581cea6438d323d3fef03d077b3df14f9f3f358292c15aed2abcabea3677270f6dcf382aa185c5526335703ea40ddfb94bb835d9636912eb0aadbdbc22775fcfabcfebe8127906ef38fb6c8869f06d7a7745cddc2266684b54aa9a9e3dbad78f7b75ff12fd7d11f6d6bbd63387b6e0bb39637eedecb2149715baa603656933f01db40d677fe8f2815feefe2a7269e97ae6cdb0ae7095f28036c467c030e807617142ce3d4052277da7885c17e47bcac92345bba5d5cefd0f0e0d6aa3a2ad69e899310360d89ba9f820c2655f3fb541add5283d79bc9e7b4c4d66c1165cc3c8fa9e2ad89a9a76326cd05f99ad67dd461fc7b041c7612cbddbe7081695cfebf85e10c74ee390833a4ea0cdc555bbe02cef95cf118867b81ab527fe82220ef116","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"a04e2aebb4f065114c065b7fbf49759e"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
