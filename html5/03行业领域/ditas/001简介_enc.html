<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"9427cf5ec8b1d1c175871b6488ead372c15b45cea9e7d506dd358475c9da7d54655d2a840eabbc119abb31f2dabd3ec074d4d3e588a49200c6eb5a0bbcf494992c172b7a9bbf969412b5dbf2a32101a84b3012297a96d126d0b38b9a31c24fbce55f1bb87da1e7f1adb77a4216f0a9b91989f1b699af5cf99cd3fce9f01b502c21ed3d3a7e12b6863910888980becd816b83d7ff494dd3cde896bdb553a4b491441f5420b03a46a7d1241fd7a9f2f0500616e42a633318bec151aa6c95bbcfb01e6df746246e518b8f9c6fceb297fe1fcaf900084fa76ce8d1451782972beb0cf261ed7ee9442cd43effe0c011183e8152dc20492f6315461582894092adaee62cdbeaa8452707017868e6b58bbfb020e90553c0e095d0bddfd4d193e391232087eb0992dc6c8c9c833346a4103aee7ab88e13728b9a1118dd60c29107ca0b32eadb290da91b9224dfcb8e3f6887dac4877a64ca75bd2ef4e020e308f20849da3f0ad3ea71856f29d64e5dec262a3cfbc8995c61ee8d9382b26438c153e7070d11614d5523be86729de38cd9ee7bde92c5d0969fc4b7d1593ba4de5beb341e86473828d07b6652c5090c7d7991b18404590bf5962aaa0d8366a146612c32c4d69075794b7f7de2a77659781619a393bed07801ed1d8d0a9c93810afec5cc0aa2985119bdfc6a0591da44effecc76e034e1d8783eca9661339ac97b843a3166820cdd5ddf00edf36ce74aa7cc2c5a21584c8fde5d1a8db8af22c81505d51a06accc95fd9146f7abdea856c665760bdb4b40502e926ac9f8e2c7e6915d15c766c21d780c8e9605b61f1578d109514e2a43177ad46afcd1e89e3938e06731c5db921c49b808d0d91995dca4619e581cfb4dcd1abd5e3b0c8abcdb005a3a790516964b08dacb75f6354d70d347e69a029139056d0441ca35ef539cf651bbb8386134557adaffd6a8ec9afc4200e7da825e33bdc031c1d3c1ba11c9f741bdd933d58c922f83fb3f3e717a54ab3b27e92cfc3d1ef5cb206cb22a8710ee89ae6638416929ab974f953ebe9c6e9ff0d7b4248fefea35742538bd9dd74743309fdf895d13b637b019e2d978924efec06175088dfce2be5f77da54efa4f08591c998285126ed6141cddcdf7b240c15c35aa5a479db1b515f50c23a78493ba5c6112b82828c2c79907f7e8e9f1e77c0cbe478a37e17acc78a614f5f927bd26ebbe0174d34186df0925d58332a1bd4fd16307784ca65250b2a788aee3cb34541aee64dfb2e8987e3a6be9bd4db319974c3bbb9aff95c8eb6ed3bb2a8d7fce700b20edfc6681cbe50b230fef7ac249e79652d8bbe3e155be95e2fc056bcf1c54ec39aef240227de8d200c2c05541c0dbf2c57206e65f5b3736574385ec265ee37c1f072f519417051ef34fb018aab5bc1d5dd2f8c20d32ed4617eddc80a7fab239690958a954f8fb4f1c5ab7c491c850b7a6259c759919ae0c18e01b57d6ea54f1340c929ee64d705c503f6498d239a62dff4c41be488fd3a211b1621b2b12bc56e0e21c2382e586576fd5d9e887e782d6c4a6d74297367b9a8f1ebdf5ba95047fe175d7a7f753e40f27ae871649945919a82743025ef6c7a5321e40a19a84076e68e9d3b088ea960f8e59ac3e5b0fbcc0ee3ebc34ab04ab7fa05657f2d12a9964ae4915c061362199b00252c6e35886974f2068eadbf4678741bf06c4b4070aee270c3f5dd35f6b16ea17dc467f09850eac1052c6e69897e2e84b63ed29b95ee8bef9f7053fc5eabbf8d9bb9e75e403b6d0c9ca02afc5bb25dd885ab2a5a3e0455c9ed0231cf414770ad9495e962f7ffeaf155f2f40d4f58e02019ba84bacc58a48b24e4cbe4fd37af9af7e450596a5b143f2d1d2681038e60d25e06a84c9ed3787aa3364cce28384797c6a37205008f2e124e45a783c8b03a473cf326acce6ee529a1c52cdc3b32b10ca77378c47cee22a40644ab5089a74243c1c58414f2248d342691efb69852f0245460f704f41c8aea31716a661f2911e630b193ccd2f6132fedaf75f9b582c8fafcb8718e5e274e85c22cc2c9e937ec4a6abb5b0741694472f2717701e5a538bbc471301d18f890794a38b408f8bf8e34516adacf78f697f8a3435cc849f439ab74c77117ca32e43d17d006708de9fd003dc5fb6c7462e44edc27097a9299f3bc3f674d73640f6d77c5887fae6ca2ac564d69a957f2d6c738882f3dccb0938bbeb00c48b4cb9680c4683c7ec34a6661e39a5c1bba936f833495cb21ff17d1df98d66915907c1c36133fc1591882886e4714c9c1f7028b18a882db54387589bc99e5d134d57c0043f80c8c60cd712eeda45b7f96cdb7c9123fffe961255b62ba1bbc75e8f4326169d8fdbddfba658ceecc20d05dd6c6a3863406718b710e8ed085a1198f45f969151bf09e90a564c6ced87b9cd6f5d04e6670eb5d3829409ab33c80f18959a351a5e58b9518a5ab6b4a522f67ed6293ba14058979c841095f11fe337b8217cd816a3bada678fc9095f63f680c4bdab27d97670164bc66af898bdd4e91996f71e174bcec49f14569b03044c54e4d3f94b4c9067f2513516f30c7d64cb3b5045d4dfa6e734b88f02696bdf5e2ed8b77708ffab6ba7d5c659472e38576ce555ab0240df0947df1904fdf85ee89dde31ef182f0e2b2c83fd257ba7ac41d5de07faee0ba24dee99bc89e49deb1e66990950cb122dbf63510b6de829aea42eb0bebccca29e6a65429fbe144c988389ab04cf12ee111bd492fc294202dc834ef5f2c680c1040c9871aa0c2914f88d15e8942f2e11a806abf2fb0db7ccc092aa51b7348207c4229a7cdd5adb53586630956a77b72e91ecc1950e219c8c6303143f5d9afd6496ef13fc5d158b241129b37aaf0ba2ba7914b07975488cac22811f18466386866be5454e5cce01729bfd073fd360c7dc52e225e5078472f94302f9eccd85cc11fc68464f5b9b67e913abeb5c250539aa262da0655355d19b67bf69cae9a89360f80a322baaea53b1ea69cd42673fc0c15c0323f7e58588ed78cf1751e4b119d93941b4178fbef6adb8233ad4efc69dba3b2fd6f4e7a01ec72236119d8ce260bb948e2f68229659a0fa36f43bb16cb01684bc35b239531eab9cba77cb514697884ebf9178372faf58d48c4b02ca23bb3ae970209fceae34a9df470389e0e0c659bc3d6a49544b72c1dfefec8542fccfe3e6c63d222f3b48b2dafecd2815e6ed351de493038c446fd8a3b98460c869eea02d174eb38e28a04da79cea001dc5c98ecd9f41748ec8242a4181eb96bc2d2c2c062f027c75159cb530a17cef4013b065ae611d388091c469daa49896ca86b6dc5fd74e6e91fb007b0cf5dec8084951b31478ef6040f2f0bb435c77b6e74b7cc27459b256599d57cd2254d2a6033994ec473970e899ab36a3ae762273c2defb4d3b7f25591e4c522eb5dea7bd6b0dae3ac2dd0dc9eacc63d657a7a6f6f85a4b0475547c97a1aba8d6b0c5d7b7cc512a2b99bae3a3d22c789a364b3e2c2300f79deadc88f59717da48bfbf43396781bf2715d8748bebace81c4ca59213c4c1486b58aeda2ce0dbe6c0fd05efbd6a03b2579bc4227e753cf89e16d606d6d07efa4341fafcc231390c65922991736dfe2dec8ac8796cb8968f6813d73bd1e36ecd4aa74b112b9e3fdc4b27b7307041adc134459fe168d61616fca0cec95b3d042ae3f7ef43a092542039870fc597e349b4b0afb6c738cd049f1447fbd4c8fa2657a7e1ef0f2729a56f1752036d2d3695b3ce362eb3d8d899aa8ee9f42edf06fa4765de6c75bd50325978f3d752c780efa16a778668bf0e30b1039f2e2f2fa21fb1967b9f32296c36d859feb4ce38978894732e9804e4a200eea0cd1d077d94275dc32ef544f6d8849918792795aa5aaa4ffc813cfa44c00e6541b436a4819a9fae81521eaa0cf257dc491b8cc8ee7f5640dfd4a72e9b69fa2b9cd4ff1357df5b5c3de9868c75beb25d053ec8709d03858257c3dd661ebf45d38167b22daf808aa793d5df98d16746f792d46f0d88b3a4dd6549570534e9070e8e4771baaed8ed640d8badf2f9bbb33c2d47b43988349c8a9b981ffef1855c20ca804faeb71816af21adadf528f6bf637c19d32b2b31d41cd5fbfcaad6be346715633f6b1d03487016a016d4f483b996e693130cdb4e1d30f6939813f5352f2964dde72ac918eb70f0a1874d6543fb4ee305a8acc2654dcbab0ca5e97dc07ff352646235835cd1ebc99314f4845784a5572189727cce4a9563c9b09897b6d375bf580d2b9612519309a4b27dc92dde393f9ee3bd847f065f47b63d8bc52382dd3ee250a20a490119d0203cdf26f002a9656b2e96cbd59b584033ee779bef2c75246404313c6f9de19c2f97b234824881c7689c4ec600d181f93fbfd0bc66e84dbc1b38c6bbcb4d9b3098a5dbb7d00f19215cc47d2a723f7338b7d454d279ccbe1df10b2c7473e13789d6f198e782f8427d0fa9bdf37c1b945da431d5db22f51867d9049d94ff5460e8794988ccc67c5bc6be61ceeea1864ea7eeaf8b14ba6d9eea4edcd1cd0f16bdbe875d0edcad1852e06b75db72692d2fcda3cda813c3f7f587367f8391bc0e8a119c238d2af67b37bf87c8168a8aa5e70ca53369f7b2163b1c80d07d81fe9c1d9203b657e33f4e6a62e5b2b5eac212970f645e005b606cee5d110ca5be0fcfb61b1ccbdd63cbcd5405443b351b7a4fd109e09b95e3df6d05d9d7dc30fe899df36954404f9f1e7832b5093d5cfbaa0f10075d0c9d68ff95572248dd74384e91d2df0581bb02e3d62a5f9c78735b80c7cf1ef8a92a11e6db29a4f07d11b54b080076b7475e257df149822207234f9b59d6d830c0523ba019c51f5ab1220dd3ff2782e8aea7ee63a3c456a3b027e27120ea2e546df4d7ac72a5b6fc1ac08fdcddc89c324e245f9a2bb4affacb1be2ec07fc65fca01e958011dd36aafef564bca89d0261b4ff190958e1a7d61fb8547f95cda23f782e9ad33c65ccbf1d247de17755671b28f16b51e3b3bdb59eb57effd546a786b8928b052a60ab3791238a868ebf1b520ecc99b299d6a13275c9d10f98dfc3c45840a3c69a57b33153e2e2d5dbb2c4cb6e4a171c8259cbb483e8c8ec7279b1ca555576dc21dbc4b7546c4464b9bf6bc36b8482b6850a45953721a3572c14cf99c7b90a0d913df4ef490d84bcce8247010ce0161c6f5e96073c18c80a3bcc985a5f5037ea7f2948ec95ad24fec690ac24db8a9d825d5b08ef467ad6b0cef0d441078ff90313b4776df8fa9c6855c14147e77cfd01b7aa3d5585836fd49a5148b2b46ffb428d49fc20d291941bfacc6bb7301b2ed9a82992ee46aefe26e32236f53960a0c74ae873bb4f105f00f802f847d6cde0974c1cbe816f81c55e7de1655bd414dd99c3b850b7c3fb42c86acaf2e1f6361dd7a2544ace5f4776c13cd9215d52db92c51255b3a6d278ba8700adc45d8a4177b7b48bea34858533b3a7ac6217fd04019085192ba801648f5e0759249003f8ad84467a6ea2cecec68fef4a92ba763ff024fb32c5122048edcbb0323768c28dbfd41d7197313d24b6e0a46f962b541678b8bc9f1b607ff141199b82ff3b6adff0bc12c6892a5fda59c3ee43a905f7b9ecb3f7180c2e7a29e0acb7c3843d0c23b3f92d2b721869aff5928bd8d1547ac8e18b1622fb8f9c040b5fd1d4973793a86f5c7aaff3f34c1448d09ab2cbf456b78471d423518369b666efbfc4e33e61c98fa69c0f578f13fd9864a6774073a29c41eb34865862c2b965ab156ba7d0eb0ab383d9c4c93af550be8769f4a7d5a378e9c9cdf11bb0b4876c52c5e8d1f8f9ba0f1f75e8e0fb2d97924f65137993fed198c3bc2d753aef2bc9a163b7ba035bc3fe14c12d83daa6697ea34a276b2c7a3c293a2b2a5d412a6876ec3a1e567a847ada93597bb4bd239655911bf328917fbc7e8b766943cbfc486169548f3f13430a56a37afe688553e8d91485793ffe8dea8c295d5d89a791faadcc484cf27be051d02822ae0d8d457778aefc021f372cfc2eb5628a3b8177c15d2156f31a2f2f5c97bf6bec080d9114a77252058adbec7dbbb58be0ffb95e0cde8a7079a9d8a547b29c8c0bd970eb5c9dc4ce6edaba703a5854e26490535df564c48357979cedfb1ef255f27446f46c6b0a295e436904bc726b9ab8fb35f5fd233aa9126c0d77f5729b8de1fee5b3f8290eddc9c517d470bbf699f651170717d0b0275c20b74fb56506784c7d575eb6d6a159674c63ded17e34521470a87f6ab317e68d8943e2305aaa7c0b688efeb013d03b592ed8b27bb2d64266b452ee0533debd5c7820c7d7c5c437793f7f0da93cf80ccca1967a3e65155fbf00f2b275d0997a0e338e5c90707df3d803de37866c311ca6148f0a1e38c53ebb5e6b3993464e3e564cfb84cbee32984ce02f1a6bbd64cc2eed6eb1e7a52732c3e1762086fe34e99aaaed669caa2c943de38c8a2f8143bbd2668f00a65d27cf5320ee810525cab91686fd267e2f0d10a35900a7e9a915e176184a1ce19140bcdca1207de65e1796845e0cf8a3e175e431e6066d8a02d134bef58c851342597e0cd3d3d02f2aee61be92e7cc2e86dd7d842a7bac6179c333ee3d3a2e75be5d0bff77608b151327d58a2195c797a6f89d15e4d790685749f1a67066d3e548fb9d77bdea2e06e7bc706c5acedd93696dd62deef2d3da05258e0ef7263db96f6664f14ee094fdcb4c2f177b40a4d99ff1effa828e532a5ef70c540e91238cdc607136727352863d1f4e3cedd129e410ea04a639332f1675c9ec109f1223123fb3b149f1f986ddf852c85c1a01e05cb5b51e6569d1e6dfd744488dc2240920e2a49a8bd39ec10fe9f6dcca65e26af788a0ad1a9ee65cbc483cc54429445ecd4d6975588713d32961f3f43f62816e5389ed9708e50537ae47fb306cea3e716e586ead5ec2a8074d707939e00c8ac4ea59dc9eb7bffb0aba32f9229126cab4dc3563102d9a711b63bc8fb57d1512506fbe02545e69266e3a2cd0b417e1607626d055b9bbb7c0977fa88eae38aa105b2ca688834e665e65ed7e310d9db475b1ad6cdd59d5a4290d053f3becc6ad85870db7907deaaa9703f39ca1f61b1317a16cac3f8aa53f68a34bdd86889e51a7e0e4563162e35ad585a89a4c3292cccc0a6806f4acc5da344c3bc204f41c21c35d3e3f96db830cb5752d3e28b27dea807a499c8a28026d19d219cb7cb63889c28ddad2f3aa611498bd057b6ce89d7e589c0b1cafa7cbdb477122f0e3aec033c2a85d72e969dc659884827372bc31677432e72be6f4ec254102325d02734d72e8104d5c58ab67446833f5f70aee5b1936448414647945f7a65e4af2f7893316258cd609bf617b4db9aad5c951a988f599fd3a06dae640dfa8629ec60911bb5aa17d113feaf0d765cdbff002e44867d66f13d434f5c264211df90ef14252e6859565e29790d8f38ae0a0d25de63dc8ad78f8a52e8a088ba45d93188da19bdc6c6631f664df6f8137ab121ad80f53c98941424655a9349605249df820074aae2f9f1a1090b34f57b2b303bc5f74e5f0f35106e776b58ba13fb524380a051ac9b87f48a1cbc361d6451ff312f486b18066896d95404de383acd35003a57e1212f096d8a3a180117d78682d0a66c525200aebe3f5a0b62dcb3aa488b87d9e03d8ca652644e2d522b31bebd2e21f768ea26c0b2ae95ae22d46d71b2390f11ae519a301a966b3d2a404898167301334d3f18e80b78203f392299f1e145eda8b57c8b19adf9faf78e3a5828e664d0a495727284eb660ff69045c5608647184bb7924efaa2d973e481aebac59603c964b6378c376cacca57c4a83ac649599f693181daa76482a2504577327436f4e9eff40fb8fdd83dac6942fe4f3a2f4ae3a81abf17f89bfad194256eb5c7b6440379656e8cf5ae7dbfea48382282f7e4f0469bd9eb3f7961e07e2df8687a76a32e72640d62d2a9a526de1ff1386804287d7f529c67673337c0f9e2c83b74bd272f78cf6e94302087575132b2684bce32c18ed919fb8ad4ea98194abe1d9335de87217f615772110af60c4c121eada88932f6f1a64fb6b6263c1a028f5014005658c7aba4940574898168877f46aa03b77ce4e81bf1fadc7130f165721142f9e92ad16b7b51fc99f9ca072e1f99626583a43a235eb7bce08794527618e486aed143596f80c89af1289e70cbedbf798cfe3779eda87965be56cd5272aa8443cdc1a928c306b10c20e16df0a3acbf8521b0942bc9966ba0625b4733fd365c3136e501ed212df74ff3804348a14576b6782989db81eada027a1082c97a7a06860270363d2cfea1fdfe8a5521ec2f497c34ce3fa14b5906f80a1e9c5131c21414d130b9fd3c2ec60bfc1f8fe5f240d858776a871c7876a9cd3fbb47c411f03ae128bb5ec0d5988c4bc4f6f8cabee11d332df8da409078d2458f1a70aa68d6a8c8071d081ab7e9ce1657725797a03abaa1a7174c5065d0d01a5e1c3b9e1601a32ac18eda662b2341d52a7f9b5cfaa60cdf4886e77f1216c4e961a52113e01505e283cf4d1fefe58a5d9211ec09bc967e5c5ec4168a5fce44c6699fc99ac26be44a41731bedafeb3f9e79cd0437fe6d4c6f00a4dcd3f6fb05636517dc933d171b360266916ffb75b94eedf208e00b5ec48ea274e5ce312355439a480e1aedda5c546de065762a4266935e35363fafbbb789bcaa975fff9852df72531c5c44eef7098d027e45982f9dc7fdf86d595c3df7315fd3f52198b6af61f5f7ad82fba05c013645fc8f7e4dcf04681e5d8bca456ef489c15d5a81433650135f9e6def85e8ef8e296e784095ea32480921f2393fa472b5a4ee8d25fca2b821b5620d5da82cfd31356bb7cf43030ffba1dab4710bfbbb711d9e43f8b528bcfa0564137c854193e9fb912facc12052b07b06e8c36c4e21f1244ec190aed8ac5af8ded752057711b418ae573fd4c76cc084f8f1d02a55768699b94131005db7368280fd890dca088a04f133ef3dce8e4e69cccadd2ceae9627fc71288d1fcda33bbfaa26b943c38484454eb4bf49a245d6b6361dab5513d97d20d1cbfb29f7f979defc39a28b19051aaf36d1a926f65e518527577c1b2a36a0162f928b161c6dd8d89eb327d0a0ede6e7087215aa6a42b38f991ad5c33c11bdcb5422b46587ff3feb382fa0e83a8c7b273b881f39db22d243e7ae23406d8e99b37d6e53b88982764cb9c015c90cd59df21536cc44de5796715c5cace698368aa3fb94ba36e9c996e8adc4e273892a695b70037bccf74ff2c4773e6cec48bbb908a35f885c6cd5ac559cc0b08fd1ded0fe47a512254db72cb19cbe66e1cfc8f8089e91b679f5172f0f3f8eccc190cd4e9e74212141aec2cf227271c6939d89efe59489a436485b556c392180ccb164cd5213e63f7eaee4cd1037479d7ccc824e92ad7cd1d7c1afd8639005be9e821a28bf79cd4506e6b32cd287bf50124b6750e717ebc03d3e7df759daab12beee3ea2facd82ffecf83e2aa5049d4a182b08dad24111a4a63664bff1e34ecbadf56b6b8c0e179d95bec177b876d6772d4e675fdf0d43f905aa153fe9c804667d03f720fe1b4f4910cf297059d53592a83feb5cf15bf5085b91b68243a833483653a6eb346573e163c6fb2c9e5b1a2062159792bd5e332cc33779f9a312220e2fc453c576a687cd78f4db505f4097dbeecf75502327e3700b8efcb82de6d35ac349fd613adcda706117b09da3e98469fb3b843d2be2a2b0c22f54d9c27bd2365aaf5b439bee02b4bcbefa48b1e07d4862670caa4f74bfbdd7af4c386deba256a5ec16ad42838d9697d42cae4aabd3544cf4d68136dfc561da36e645bc6d8fbed202e1007293eabaf568fc5ba09ca49752d147fd14da2e9d3def2e3cf523655c6aade156ee2ead895c7b1b52d8d641285ad9fafe22e2b4fa523f3a829e9b5ad56282a56752b89d530938baf1a0dc86f225ac2864f0f1bbcc5f4f0cb3e3940e8476c9a7467998c7e1453bf55cfe292dba048190845197db87564247696589205ad59ae38f9888d3617f656094d36c12ff6fce280e8f1245301853f68714e3f00896518552edc19fa289914a85e5efaa225802f843a23e287e327b09ddd55ec0e527a60073497b7307aaa2802585a7c19deac1e926e12d5e16fa1240478282dff30878acf77a40866a4a58f87b26e62a5e70cec6a85aea15e501c8c12008c6528950e3a5c814b70a57dc386b732bbe579be398e8bf91e239f98d3859a21af7e83602bd2983d72db8d2240b9f0f6f0e92a760dd34d6191fed53690c206788e6357c995e0392f6b4ae6a94c932310ff15efcdf8078e2dc5724b959d6832f2c0e38061dd8a4930a4561aba647df8282bc98e9e33e8f5c69766e5fa795481ce3c3307dcc51c6211db5b19b3b4ed602e526c61c6f87c83bae0d33468337459b6337452158f1b161dbcedb1171f1295527910ce51c2b8098edada2e252c7edcaaa6b5440fca29f056a76f1b0963d054d2939f16ba4080ccadf416f3a920b68b01341ee914c4f69ea2864c33236738b84dfca9c76142844b7c1130621492e083de65feb747e5b3dd8bbd53f5494f164200dd244d06a466a0bf8a54ad0bd0bac277a2c4478df4eaefca1c7746476aa4e4abeff2632854fb6d86993abc4455c25895997dc8866a97dfc221e9bc2f021959794de2dd3368e3282b5b71d2aee96efda3f4a38b41027074bf986357a2b76a267d3992cbc873f15b0581e59e9da29e07ef3e57333c11a0a4279afc21332a094527f2e4264893da5fdda3d85863ac887e4c892aba101c23e8ddcbabc548a1b37d69f283c5656d1c2b28cb54a1cb06e0e9be89dadd982bad88fb6869826ab749ce463bc486288d9fffcf2e30b4623efbdcf09f17fb899ff04b2f362bc7fe2d3525bc1011c498344311d9c322b9d2401f1689527e5cf9d020d73c045e0d7a22d00c629cb94e72544f4e3f30bb0a2ab30ad98be0ad2ba9a9e2d12adc39fb63479984def388fb7cad286f55d2031424b495a3846749f585cc505da264a9f828ac07d5e1c9cbf14f80f3d7b290c8bc9afbab5cecd93ca81eaa3238b93a03897b00397371487af0d769e4cd8a539091f63a9e7f509185e71f2860aa1af86efb5180e9e66332d3d82729881bd0124a9b39f59eb8c0a42cd54e4328253fa6bd3598658fd8496da5f59993594cc6f15f38f497ed3d56e45a0c2c26bf4124f7ea471f3f50ace901c5b387d2920b1dc1a877221e993c53e33bc6dbbfb28ccdf0afe84284a2a53048d8afaa0d75ffcb0a3a0880e590af86e6ecabf0211e8038fc348d50bd2c682435adabed09956f93e5be304bc88ad02543c894500a805d56fefe522677445e0ba051a19bf402f99f6ac73d1ea35f63b4c67cb2b4b9d0af69df0b38312d4f76147950a38bcb41f12966c3063143807af8715f78728c83d518797e2c9939187e5c4ee412a2358f2756d4f406dfcb45eed0c3b66b3bce99046674577248bc9b689a0b1954f36a89f2a2c9b1a47680c0fc53d31bc02db1d5df3e5fa6491ee7b050aeb6d694c3c1cf5c26f97996e2d2bee4f5bcb651d13c6cfa4282c3994f9c83136de1ddd15dfbfa1b40ea6b50123381fc1c934d493f4a6a95eb18ba3f2bc8862ad8048143543344c57c9593354810c35c6b65ebc02bfb36f4b2be0f23b349fd70972c87c39e0304f433b1bd7958e3fd6627f22ef18732a1b7270b329b921f6bfce12399f3c6602a74b4ade75495e56bec25e5d068ef612a76ebdc3c7a787ef89f6aa1fa3a4e5339c483e30b5ca84db546edb10cb01030aa4193e8d1b33ba3a6cd77674ce105fc669812422db0f0f09ef834765b58d20e200a968d88e1a57e55c4c75ee81e39f5ac5013a51a7d67ce192102f953928904d50eeb625d67b3edc87fbbbca0b969ee53b99b91850d3f391b10d4b2ce0a9a82cbc2b59cd73fe28bf87ef911a8cec87273587a94ad7cc6bf29ddc84b80ad2dc6d5186f06acc990a4a91023c48b91cd99a7fe0d782db4c38197f32043817334cdc5ebc932db111d3adb4b0b3f4dfec6f6462cf44550d918cc63c85468a10d025ceaa29a4501067100bd4998b831dca7f2f48c2b403c401a844d8c39b4254cf0009ce0152cf831a7d3211bd9f4f21a7e7819bd4edcadbc555dde4cebb15deae8fa42ca32d9d90a7ec9ed26b82332d4132d30996e56cf32d3b8cc80c32c4e801b75467c2ca51a3a0b73ae415389d36eb5dfcc5a4d410aacb8b505a9da47a4d524110d795e2e15a15cd4facab0b4dd6f19729fa6de7e85b7ecad00b06f13e138a237b7a78fd65125a71e72df88fda0c3aa9292988cd81f955af5ae5dfe4fc45707f4a7c98332b32b5cfcb2ddff7edd0dfe3d13db90571f5004faeaae1244b716e44d54a0acfb6d282784df822f1487b67a80096b572d889d5471b1953400bcab686fb5aa4a5f3c4cac64cb03cb37d2f142a3e123c599f4aee2cc4ad37331a867ee7f6f1a8b53153d6ba6cf33b53d717299e7a638a2db6a1a8c53e4334cc06cf7984f8a29633372f62d14b9a02259fe88e04f8ff3ad5f86c9802e6d364addfd41cdf5dc9ab9ca1a7884dc7b2d4a492cf061e95296e74dd78c13d07bd4f3edd65775ba04bce144a089f2a191a8672732b6cadece01d3ac8c792f63e9ac854c5aa99a6b4532dd35d1ce7ccacbbcf64303031c77ba07685c703953d983f00858146622804c26526ca2a766e50aebdd5a0c37b28c78629e1882c0c74c317a0b785602a9943514a718834f46631f473c9f3ba45cae9187fc7ee252bbac54d3c0e14a08779a434170c1530ee1c0d7aea7ca92b9c27278405a2f053d8418363d2e5aa331fe0b4fe5e219d21da0e6cb660d72b200d592377773741d5b670e12b9af58e72a839db344b54031a1bf4cedbf15d48f35741da1c4e56101ecc654c221146f06ceb6c74028fc06ec7170da6edfd660e1f2735a4f59f3dac18db3e9c93cc201b48de1cc9ad4b1af21ed54955e994cc4aca9700b9cb2fe11087057498924422970ac6b627193e2548f9ddca9f2aa2de239607a46d2cfe7ae12d37157fd8d264fb1a51526086de627e9cf999f6a22ba5a025a8e03018e70ee3b32c92180370b9dccbf0683d81e0dd6e8e7cb238bd9512035061d6094815e98ed2745b2889b230e394ead16a2446f520f070e88939c803e1cbd9a0a34bcfef3bc6022bcdbc88e1e5ce81e2f4db04e112f7c87fb90a49a5e7361d561cab5d53eb719de61d172043e7d4abefad4109edf8070a23d2c76c65bbe1ccf8c54bf67b8dfd38cacc551c2444f68197bdf451bcfb641479a95159a31c973971960172318d48a55912ad6eddddb2f150acb27dbdaa07aacfb9e621baf4553939b9c4ee63fe89f5cff59f0593cd0e105ffd8c20ce867b92931686198a6013f863188da3a44316e81ccf9527811704ba1c2654f59e7ba975268908438aa5cd9865a95513743dddde406920d95a072707d5efaa889d4bdbc42c24bdf659b664c080aff4688d1fac746f4d671542ccb609eda482aa453939dc2ec8bff03f6777e209e062542a46ba90fc35c826879dc304e79ba176566368cf718b912b1ca5bd2ea1151c32328e6ae2947ebb7733c4434c8bcb5252bf9f747c63e0fba4f793d724c5825fd32390fb5767af5051604de138f7ff51e86c1e0e1f1dadb32e2f027e4256ef5c60c199a7f278e5847c4af78b23b88313ed58a3cabd4b9f25a45e62d6f5f05d1faffe7863e4f24f90b1cfc77e577a55909cc72e7b3225c993e8ea77b1ccbad49dfa13022eddd534084b0bde6f52d6d53c5790304957ccca96cfea9403bc86dbcb940ee6156786ee9ef5209d01c25ba3f9a62ba9a090b8d60f7ffe9066209309d6ae494f552883b5a7d82f0e33d2ef226f8e36369769a0b0fab799aabccb3e4e1d42d92148bd0af993016f59d9ff38410247d13d4faa2476654522baaeb42ad3d4ff60f78e20064dccdefaafe4e43436eea9ab18234c7556cbe0763a2b629e9857e14c4b2f7717680115d9ddfe544d0c00ea3f911477c49ed5e98dbceee31195460ed99879881f07613e26b0aa023deb127f22506e0d934782a9057f2b1c97894502c2175e008de03e8962951d35ccdb0e71e904112ca2df8927d5c4756cbe1a9db79c13e7cefd42ed3e2f945fb26961f7e779e73558ba156f8d15a1871617b08719c7b392fa48210952633fddd3ccef6254a5707a39ce60f25a9d4175751f9f673b01af8b56e51c9bedf4338c829775db70334235ea32dd46b14fb52cfebd7d022db3e9849f6ecd14b898f8d551e2ad07f96719f690184486304dda46c5b3b934ff15b8d229b77246a898e7239c1551e02ba06a990fbb55ad8eebb34cd9b26be46c0f42973379656f04122950361e4936f041d08af009e6d2bcb7ffb15d93bc60e7e7c5a07673aa0bbe659be67bd6fdbad29be69a838b4b26ba9dd719d8a12ad49884bc931936e49561218897c3efb769b84850d254165d43803d7231719297b2dca57a221f4411a961d6af1c2213ffec9818a8d05cdc2583aefa70de5a3b3a139d991a549a66d4e5461e7c7a63ca051adf2b83dd46b2dd54a518c96f42843db2f99c5d587075562ddeee7470fdf7a1e3840fa84637164683a099c89d6a5729c935cde8a7f4289ae0eebd24106a0cb379e4e380ddba3ab04bb74246a6924b35a0b9df64f5acad8c9642e48fc317d7de7c1404054f839ef95754b508969c9a40b9fada339c63eb2130c450f2ef5067eb09158fa26ea16d3210de1fe04a99ff7ba6b9715f2eaa6faf11f77b5ab959e86e9ac7880aecf8669a34404ba796ddb665d7ddadbdfdabf1c42c9d312b65413a7f18514d66daec2526dc8d36c66070d79eaf8f26c55debd0acfd5ed21d02cc97f557a1e5ac47eb26a7990a05d1d2cf718ed798d22dbdd309a10fed2c18bb65f4f07b930dfb605bbe43526e9c126d0140a022a32cf23994c651d77819492c3095ebee4cb804950655c140062fdfa7d39fcdde2bbac6ec4845ab95177f7eafcf38241d44b20ba76922683171c25cd72e2d775b5b00643c5e16f5e422cd99a3349f9d11ffd85555c62590c61bf900f9bfe6025c6be04afc53029094f62aeeecfdd52f8243575e823df5c8defc669b6c0f59b2c6036da392cf593b739b38ca79d9e22958c841aeed60e14a1f4ea0c2cf5f6881217283c76aba19d73d4c651c1e52a27e7b0aa3f8d79cc6a1fad7cc269a0b355a30b0a6cf086cb6b90e7d27a512d668bbaa26ec97d1c3bc1a8a1f4752509391039c73c2f5edd5b5d674aaff0ccb2ab0ee7893f056d448ff8f01b1eace129442c93541e673f76f55e5f1bc62c7469eeb944ceee2b26a6ed7a3751a5bf81ce916060b8fa6b38a22071bec6b7ab92aabafa66bb84a538a121f268584c7994e0db7f268f9937f7627dce6eabe364ae1e18abe069c1f2dc4f2e251de719905be3e9cdaaa791a39a38f651f28a31692ebe88b96f487b4cb279ef0667d88b04fcc20b3553d8f87aca1d69f3de5ccc6207ec2ad8e8367156dc9a0c533724deaa07bf9f8e327659bfc2dae7f52224acf3bfe0815d7c6baf23f08556f5cef0686fb836b1b29fa64576931eb93b02f94991c54d8b49748a2a7beae93e1411f5c682a725d161ee374fa20ce31278d6490a2143136e04bc25b96e0f85d616b7d713e79a06f2c30d3cda73e379628061bb7326133718a22282ab8087be19a8b56c6c2278d90e1088809921b0a67e03337f1e9bd790d2245638aff3c9d3b616130ea5a2dbd0585760b019eb0343f6f4f12525016d6c87817c9ee0b90c45c45927499dd4630d6c8ed7ace2449e40e8c41c4edb657b6a4e548c186a9b7fc010a8910e2e686c53b26045964e70124296d0bcf74d580032aceb35d776e9eb72cee77e6ae9b6924abed929ae2818bfa68b0c09ae2a27259a561abc2155d62b92436f8c5c6c981cf9666df8bf7eee6e6b9317b52f1ffc9fcea2fbd982324c4082729597b105daab0584b882817179a673927c21a42027f025d0a72535b96ab9ca77d6323c16655eaa56ded0a7110daa213242552b4875c07033160c8a39e954bee191d3a7a8d587a44c764c167f58703c530e64244af52fc8a3c4ea1a1e93c2d5a37c4d12411c059d7b34dd51cb552ceda2f17c11055bda9d982d633c56fa15e646e458098cca5b898f13295094e2344c1ec8348ca590661265956a79ae7e89e7454c49e605d19c8845347c1777ba48d70bda6b50555c95492c8d677bd282012ef84a7a745a3cdc1566d352fc8418819347427acc24e5d7504efa2f03287f8bbacdfd2982123ea236bbd56a4f7aadc60c616a5f4f2c5bd2f73861434ced6b12b01f37f8a52f7742042a6c5f4d4ed3b3027a708ea38f1ec90d98a2cc73f54fd63d0d16555ba218415eaa372aee9e16744db459b94918128131efc029ee2f847d79132a6dbf8ee3f911567bbaeb9ad4933e562cd6a630eff6a39910a0bcc168eee2d44c74b4ded66b917911c4882c158f1586a0a8753d8785d9c6b06741722902c64d2d8e484dbe43de35d9483ce469abe7cea8317a0818dfdd5cfbd406091ccbb4488e6e6953c8868c1190401169fa09e2170df8e64b6f24bf9f7c5bda3c6acc41a5469ea0304c7cd9","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"3b65e88fb4aad2a4dfb95b4861d2091a"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
