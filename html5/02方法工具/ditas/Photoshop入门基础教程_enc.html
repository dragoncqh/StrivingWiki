<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"74183a67b14ee945625b98a6f2553d0af9e15ac6faf575f3c217aacc8e9075b221804a7f64d966d51675bd00625b6b683b52c707db5270af2edb3c2426eb878d16f5aacf4c1bb1b86334afaddecc39cb9b50b7b8e08b76adf41edc1559e2c2e00b9e8984767bf7c7f6676f5f10d8112f42c3109afcb6492870041b6ab4c490a27b120fc63600a3c36c3738bb6229700517434a215b7f9bd5750c3e429a8de4f56d1da804802da7317f65431318d8497c928c097c475f03b679b3c5c16018a892e887a1aa13b00ff82a14336da13827cfd7fb88a44beb5c24c245f83212b4829fe6450c15534234ba03d86c60f8bbc2982cb60e5de2a1dd7ed374661e1751d934e173ebfc2598f395f002d5cc7205e82be0f7c7b9222bf9236d199fecb2892a314441140e4a1cbb756dcf2148c49808fb6418559e1f70934a97c11b50cb2d3b240d523f959b76e7e653f408c1d96bca769612603b52f5519f008eff7273352323827d43a357f9b0056702628cab1b5aafe4730f9171b6366c25bf72ab953b9b0ba506003c1a92d0776f0c44ee083336223a6e1ea0f69de984c7f935766e31268f80aaffbc5fc713e943444a29c59e415fa841cd344a0b86cb5e78dd28e8f9c648dc711c6e446fde7cc4e610b0d93c56730027029f87ee86c27f49a0c6748059b2a216aa1eacf3027be910ff969d4116db8ccee315e87f55a827d50c6bdd8b9d80608363a74b2f969ca8454e00f2c5993e14f1dfd16ab347f7d68f946dc30ca53ac9fa9e0682e12c4f0ec30715eb82d4f5fe36bdc90834e4a47be7054e4a4d4543a0bbdcf022bf74bd3131bd398e58bd0cddf19494bbb3de7ceb25946ccada7cb43a7af7d3f381d7347d4c408a1a32a2ca9884bd5a9ec9b5bbc0c12c5c0ecdc274ff7dbbac332c216f61f881fe63223b41f6021ad039f8077a3cb20d876e4ee31e89a5ec2aed3e9585c1fa80c3707e45360f68444b09eb50c3a7db02354d1b25da9d0b1f51d5335ced5646407612f864855d0cf19426072a711333cc0ffb257afd5ede5dab6bf6b9764098c685755e6bd65d82d6abe91db51631bcbe16d97b5b4670e23a332b935ef29032d4c45cbf8895bffdd277b9a4a2575b522b5b783b7bbfcd2ce3e76212d7970194bce49f581c0c9d88b3a3caf7d88fa619ad6f26e7bb2beca52f511d651adbfa47b208f9da90cf10484d5f0f101bef03d2de4c5c6e2ef9ff63dfa30d29cec95494add573e97d2ce1a91c8add843fa88ecf1900f489a9eacd911f4f17a8dd6f14c64dc2a654c6c04e1b76deaddf23faaf042e2312c13baa0c6f68134ff276104fd0323771f6d87b84be3e7c3f08bd4787920665b596d5d031af71a27bbb31fa9591b805ce7b3956405a1a713daa8b04d5119b494b3d13e05f171fcbeb30b1061c660a875e7551f4ca43d98f4da27b3d348a67b2aa626b6512716722154a7b5c61a81b5675bf43e531e3e53122af27b12cefb351fe99b1145ee21b74288383c29591cc3ee41bdf2ff3f811566b1efbcaa39abf9f55d42ba6fda12c5106105c383f21342c06219e31ff0a044c0edd9f354baaeb3c43534e610884f3fbd2ee9c5e87d000474b483d0933b5fef08265dfba2325c0984232d9bc98e56ae3c1aecb4ca03ab97a540e36dd04d786a2dbee8e2bd7ae163cda260cf01c5d497b4d9ea397cd409bf0c2b90a2832a756aba957e4f6a8b412f76fd7e023cf721d2c0013d4e3a037c2d911f1acfb09494d7ad66869ec9ebfee9a01c6e21264dbeb0d023d7f24b2e73244e7498a680dc1284a65ee7b6b0ead653a7a7967d7a4b2ed612abfa362538605e7704dab4a89a13970c5ca7d675934aaf0590eb5e2fed0e568f3626849f38f6a42d6bfac591526166739f49049604a97218c1ad8844a1b7b918d98796c7519fac10d02daee2c468afd66346dbe2016d1755de86372d214a3e337ad57666c5d637429565ca8aab67aba119c967e90d6321ff4a6d73980955ee9b40837ec806b3104815f54a2a66062b43154f0a67b316a0d71c2e47454f3856729cbd66782c6d0d44ba14111aa108367c44e3096e71323200c2b643c592d3045e41b770666b5c960fb09f2db7a8d95e64bbdb3c2bc9ef290c5a9398e7790907032f0b0fc67a1d8d4b5c5578e7d30a97545413491c164f454dce05c3e542a41712273e2bf102865a9d561666c4883f448ea0761b0c577656770494e82bb6de46914ee51cdb624ab5c5723477d77e7dbc9ae4f233e5d3f4a3f36b7dda26dd8e898ea41e5b422f3a529724890853a876aac1aaa67d3213537f46d908b4f88367681e4639bcd357e27921ed32da790212b2c6470dccd3089138af58898846f95bc0418f451b71ef4d7f7a40e1734e8f9159065866ac58cbc2a4aecdb9d373ff1388af8fdcc92b5817826af6a283e4cad6ea42324e460a6cd8f5d704da89ce9204fb82dbc6849160c3457f3b45f87680a555db21ce4bfb1773bc1f8625dcf778e67f88213b817f5a712afde820e3ad855a16b0ca1ed9ce63e1ccd3008877fe600f13dff66586d02cfda3546a129efe7beba7b60be4c8a660c28e889fe9da8ff2d787c0f3aea4710ec5922cd5c1911b0773ba8d953dd83046ee0ef777409db0f98b8337fdd3a78534cbbfa213a4831947bd1f3324262642bf85a2d19381522c02c9321b4f3c4eeab94cb454f18311c87d07b3a1d676dc00fa249d2977a23bf4b150f8d78a543235da11245bd98a43a6b5e213085cc73fb27e547ffb08680e406b9a624e7c2250d33a29c33ff5a1f6743b2b25310057f5c58bd749a1f203c73d8e086959ede539c4bc934ee28193a86050831be8be7cf55dc6d51c711fdbc5305cb339825e154da3b02701e8886d822c871414e59b20567ab52dd38a4aab1d008dcb0ce9ec3a21768a3f618505f48d50b21f91109c90f1959ebbc3104c4849d4bd090f6024323365f042c468c8cf2d53c2eac43030bca6f7906151d62b184312ac940faea42cf1fb686c61a2cca3e0735630572d09e577285349d64b134d126aa7f37d92407262b75f4992a97f6e1b51477afa0c0bebb22b737c2569515bdb07c701499ee8239393e684bebdcf4959a9a8b56428fa3e6c0983a90704fa72e663faf2693ffb4aa04663af0f7dac8edd0a4adcb13a63d452e9ed9103bcea8ffb7678e26e5923158c0f325f84cd7eb84f843c1cb2bb53b0ee37fcf8b70835fc62c9a0f37cdd46032565ed7767b882d8079741da2cef2056fbb48be877a53621752ff9b1c44e42671760b2eaedd5bbd6eaf9e8c16d5f257729236b81818286f622d82aae5398543c0e90df2ea7e5d2096df3ed163e0d872998a0e79a862588fc2226b06b5b4fce8f978f97cbe842878a77f3d313aff97d80449eefcfec43f54bbdd647e0c05c0573d5395d49159f003e4ae79efc534e5e2c407fbb233fb0f40a4186dea3db36ddbec972f8f86098ecbab9403bc643949383da05b8239d67e5161fbce2a8ef2695ebc0772f0038f80ab4c4a09744b6a352d3c1418a2c6d8025b3d0d1e115bb7158dbb024df330c7bbedcbbf6adf7f2f6eb34153d2d774bb00460d51dd0c70f9a389ad71f542e8c2ac8efd46d0b8449d943132e13cf8d7f27c436f7ceda1ce3a6e83f049de62128c23115cecce13948070dd5baa78b8718a3bec40d40c91fae49c9cdaf3dbcceae60fc2c13afa74c1f60b53cfeb12572ebd4e8fc479f4be74b235e0bce13d9de3bb0fec03a335e866b07a8f26d26f9c14c1d478331d76b78aba29af6466813e3aed6c6449fcef1f8761768fac9ffda3cc5fdb46d0a6cc228360d331ff2b907a771ddab4434a52470b86a5a405e7b75f0444077964a768f0a99f17d7b6d98b451f56218aef6701bfbc31d75240191f8e1356ca9444ac7ae4e29ec1c13a6137302c81a82ca661c0d071afebfabc6526b45bceef80cc02010e5cd229a2d26937b9fe826beadf319e19370ab48f3128cc7de77a37e215ea8e2bcad439198cdcfdfc76126f51f2482b07a56747b88ecb73a1d5b61af494b5524170a43bfada059bd99deac5b25212b79eccbd884196b127884f6a9dab2e054cb149a98d87795a38d01622514dbcc123caa2d9934d76aad9ed34f472df8b40d03f21e660d2d74410b5a98abad2c0248c4d26f190efb077bf12fa395a836b2ae6ec67e086d24ae3d40e51e668bd509e1df72f05030069f8879d50a05d330a4ee970cff44d652e22b13c25f553fdf25c8dac3a55339a62eb22e6914c31434e48c76bcfe0cbd650cb6ada59d348beb4cb85fc69fa51c332c57984e7e40d6622847158912af60071659ccf37975d1d6a8f05f7ca42612300ef147c887f5584904fe05deb906966a76c2d3a2a507562ae4de77e56ad36df4ac3af9fa9775bac78a7124379ccb4cb2fd6c80276df815a162daa377d47f876f005040f5a36ca0aa5f3191243765e02f2b8d15f3411599e93c89d6b206a1dcc35f1a65765725c47f9484384c6dae34bf2343b88451ce8b9a8d64df9d64caadd497e9df01ae06275e17b95c3b747a03abde2e90ac3d85ae1a484f054a6afbe48bce133bb84e94f9a2549a4121d1f5c439d22fd4c6f732a8a49cde30f97c50e7dcb346d59b6de2cd08987490ab9d1ddde2c36d043731fd320784fd3751a1f541912bcb543e4f3cab09643c700c821ee852fb69666d6880e56130a67aade14b9953e416e94e6a70e55178c6c80d2d67802f88bc6529773b5a97c0f7cd354ebd06988650442c909c37a5206828afbdc04f9e8572ba1a21f9ee23d39f0478afc73a5920902bd0249764265171ce1165fca604bffbdbb0ddff9a7310c20cfe57ffb1d88faed2b23eb8066ef2ecf6c96550b951adc517eb359425e578541257d7f5e5b376a99407440eb97b0976516bd51a9d4f14bc14456325f621e433e87f06bde710ca97c22167d9615305de0501c36d2fff83cbdcdbf7f04d5bc1257b2243abb28221981dd0dc8da0d45e259f1f0f5ed4d92ee402554b4e770eef5d26851f6d534926e26e66ec5006128bc6879407f072dfe9c630e5b9d3d8eb6be3a797ca00f12d7f8cafe752d581bf9af8d3d177cce1bda24f3a8ad8c94493ed2ce7343c0b6d76a95ca81243c04618e80c58728fa8303d4dc6bf7ae674d523b8af146665fdc17bb2c3328df84eb2feb9534a1a72d657d6d7c7a21342d20e9d1c4708b3a3b4c8672e71ea4488700063493566b3084f6f5082fe750fb24a5e43c75681047c8e1310def3e750932039297cde740035963b92908eafa8ddca8d33dc884a74890b1de74b9015b83430e199810dd8684b945aba64996d8096801d7016bbdb1e400db6723e9af027cbf10f60f6c0c37726db779d0390a35b568cea621812fe8ec33e737fd22a893d1a35640e055fbe94cb8b73d57a637652f80409b204aae5823946a7c539108790ea6623686caabb7405ff2a8101736932758209672d6cbdfe83d4f1ee29a4b7831908cb42aebff4cfeec07fceb007370471c9d46e1893b435a13a6a9bf9f479370fb111c4459a329b679e7bbfafc4e76688b2e61df775f78f6f8844980acfc3e6ef333dec60acacf4e735d126913bf395243e9525bfd2fda1c3d5852cf749fa9773b6ee7ddfe4058a11dabc503cb39ece7a05b98863f5c6c5820c2ac6b0ec69ed12085662860563f7b3694904454863d84ac6ff6bb20e2224be3a36f7ab5375ca0327f40490ff889afef7ef2bab0f9d3d3025901a1e685db678b580835b0a4d75397dff21358a7a5da9ef0ca10e43c5ef461fe7abca3285c14b02c43b6f40c09200356862680259d36ad2e3f6758a64c423d8c2c575b4d8c8d2af7ec315aad69c4d13a52e5b544ec5a11450dbf1dc537567674217e83269582725fcb7e9af83a5bb78110241d459ebbc023b6f70126a4981f84a611ebd2e4e0b8a04ffe1d590496003a69bc4cca7d88064193d3a9a821c8c22916a8f7bc2219c25368b5839222288358e753da3de0ebc9dff9cb845d0ed40e4b7fbaf7556db6423c24fd7367cf09922fa18b16204ac00dd02fc997df43e538b9212800458a510502c3f5ce88d7138a3a4e1939e4e220d8122c4b8f3cd3ab4c0b3ffa03b4faef05dcc6d7545e057781e637bffa0a0e12489ffe5d4db3cf4c90988ed192a4123a09e1db788e0365e017247adb593ca1d484d14dd67e75069585919c71359330e80498e99b3fa290d9f853577490c88d46816ccfc0e63b0802f9e6e04d9dd04afc348444816e5292381e05859be309fb1706ea86957d3069904f1b10ac1e8a718f2e61f71b450586c2a1e52307c982b274e45ed215e4eb199c3258d2de24203bc2aaf2f797f0933ddfd15405a53e34df3ffa65b817c0b604477b11aad55eefbfe9c5055fcc848f3c7a3b5ae92f0c682ef1dae837fd53ec8c9faebb26926c479d38b7e676484449d1b44c9e804099bd9b47fd7690c1c5bdaf2ca53af095b0f08b6cd4e2e762314f62fdc4e94bda97fd5901497192ed2bc82d9ca628ef3d356043b3f641da83c5492b4e9e061dfb4ebf94fc2a0b76722dcba597d92b4a784208255578061794181d822017bbfefc05a5e6e0c03681f8482e295bc5d4f56d105167e9ac509e004a55518d1dec22dd68b8f2110269f00c7112e2fbc9f99522add34dc27ac07af36a61475a54fc7c15f179d247175a764b94be3333456362252c457e3ccc7805072eedf948f0263eaf9bf3164fb36d364889cebf23a4987594a62e782f19006f983cc5fa10653e8a0c34f31973e65e6a3f7866a49f521142cafe8814de5d5e83a06b81b434f6715535074ab82b07353602bcf6802d48dc32e704d4d13da875414f54299004335f023fa94b5f0275aa363e260aa726d139033edadd49519209b922f5927c50d0ef34579a910a3116de86ba3bdb397e51972a67deba764ae725231580af94d7b6a532fdec972a098df40fbb3ab0a4673b0a0d4c129e89831cc6b9b823bdb4d592f74fad69e09e59fc001b546d81211b4a4f6760324580e3151def017de7215b2980f38d778077640e6069f641a1cafa0313dd969615fc6dddab6430d252144310b0c0d2700220f1f165eecb4900bbd4c3706b7e749d7b2461e4c0b5130feac827b7512e21cf3e10033421f681b99e1e0085b04c9bf586d61bfee4c36f2e92c2cc9890dc35a56882cad742f8bed6b263df313cbb7235eb46747076198ce448fb66ae3fb30425a43a246ce9ce4e3cf4f53efb968c9af42253fbebecbb1c6d43463d10e7d75cb0967d4264ffd0d202f9b9e7d5a9d7e42ea4627637026e9295ff09d028f27ce59ef779c30b4bf2afa1b00285de4d24c90de1033fc05585645f0ed5a6f5f792047413fe320ea9369cb111098dc65653d066a9a8302a925f41efcce73784a42217e971edfb67aee9830867250cc7b9e3daa27279a51efb9e38fa1c882157ac0471e52519130a3235967a38f1acb4d5825067733d35fda9e88ee38716d7dce2e7f9b0db1ac8764378e56b893a813fa754c1acdf43551dde9a2b5e5bc5ee3d5f71cf5b7a2f004d25aff3c51532dbd3c673f8aaf812902ca12620dfde08cfbdef28f43afa83bf80252a6e9f09ad9b5523360f63d1eb958336fd3183edbe3f6b19175b47c3c3af9ea60ecb5c540d96eeb8a2d1fc2bdb658035c9454cf634a1b4846e6026107b1073520e112acee42c34ee21c763eba69612a595f22b4409590940afa871a1eda9e10ddb3322875effe9fb86c4fc1a098fa8ec264eb26407d81c66eaa786b78d8739887fa41394a850bb9569f24ca3c680d11f67307485ecc4ce42ec08055e9fe0d371146c4de5cf27ec7aa72284b5a3d51d678ceb3c985695dfc251f1f031e164c7d0d520cf76945aa2659f5e6507d11d7c7a14bf43f1e9040950fde2b1581c71f932a3cbbd5262cdec68abbc81df522ea34279143fc60cf9eba3cdc57cf8c3747b81a2886c0b3b8179d8c60cb2191e227a12b284d9acea8a4f7acf97bc55d4fafcd57d11249536418cdca47c8d8c714d72b49f1a4cd579df8cca344813368502104271d0d65485490bccd832955f3923a5c6b9090f1854e84627857b78439d6a83af875be01a8abf9bdd1b3a57cec467f7b3480b892b04dafd1a62aa6653a8468bf8f25826d14d37876c1e59a42c6eaa2908b55aa7f59e2816a8ff1a9781684330488a451af660db7c4126a0f4dd7c25ce437c3ec71331c1f2bba984b4698f0dfa82a4644d74756e58ec0f4b18073a6c2b3cb8a39242d1caa22c39025fded912a21b1c2fd514983aaddc266a4003de0bc879ea2d5df93da9239e7a33eb332d3bfdc09e935b4bca8826db4024ed67d8fcca19a74046d7baf54417aa76bce936695af38da1db48e50db75cad7d24080af2250fbf290685d06174abe681a7f13cd5b96320fbf0f88ba8082166432d746080473db0a5fd57571f1768b38cfb3e509d54ff2ee6f717e2695266d4f88669bf2e77bad57104c66a92228ff45a37a388ae7d4bb067c232cfa62b2b69cf42e78220c1acfd29f8c7e07bb117605a8ae199470e1405c9892d525609c73c79e02e3e883ed778452ec10ec9efd315a6f6cf402f28a194a536251f7e5618d5f8f20ebc229eb68b2b579f3ce784668818aa6b8db9e40fae905c488ebfd665349719ba7481d45e4422da83f1e2f4b8ff3c30423adfbcc960e9925001f9dded582862d5b9f1be9bd78ab80263b746d34f5f8f7c6ada1e89df6c822ef6e358d1caf45788daf21447476ffba4870d22c172b79d597271a759209062297d94042c93ea8f7bbc0a6dd768fa9be312e09cd64f5def978c639ec854f455601865c60fa9867e36c969e2da3d77668c26365835f3d15c05b100d5f9c6bd50d0efc189c8beb9b08615fa22fd132700f1d93c7ceae74e628c78c58d7bd9e97c958454febb228aa1c0a7b12ca8c3d11dceb92120a10010e5ca23877890a05cdf52d126e52f0ef6085a5fce291d9f0012c19d80c6691032352f7fd1af2c7105d1e7940737e0772d14058509a4c60cdfe1fcef0192a5db575dc0765cd464eab16486b6ca2373f3a6e4162904cf0b499a64d6be330b8d0675b4555ae3fc8514a978c6ef5ec3c643474171e45585c04ceaa15bdd8fb81a1b4474cb0da933f3a7a65954ca9ad2699226469c8ca41724628eb3b394d97bdc2a441d135827597dc623ac5c09456e17988f1b8d4e7b39e5de2cadf70f726ea29dc41ca0be6fc244af0e0126d85fa93224d4f422e317792cf6183b107801234db2d30d2b4ce518617b951d530211c67774dc2b0001e4a59deeda4d4dc604e409de291cc86e15d10d67a523a33b094e6d5f6b78e20db73ddf22686b77dccdd488c07a34db200f4a26e0cf21e9acf8490e9b5241ca0866375ff56d511fc96ceb69cfa3f5cef18d1e6318d4e3f288d3d811dd447014cbd0323eafa7c526ae4a4902cceaaba5d410ae23c64efe7c9b1553972a82efdd06f6a7ec2a9ebc10631740870f8ee460da9ba48515345abd2db7b53e8207c542faba75d858ae595f79c20850743f635f74d19a1c80efbb5c1736932fd99d7df800e023d1aea0a2b1605eba5072b43f63cd25bb2b286c02e722c61a0e2aaa704065a6ed499d74be2535765adf58cb8136973c31c6624d43d7d37fe1e943dccc98d8dbd84fe1ba064eda76c12b2d559d44877a72fefe1691bf78e3dde525ad091ad3a180d3b7f27ed8316eeb78a7b989aa88c28cfed1b15c6124997efaa6ba76796fb74c5e02ac9e7e5577a187ec27b0d0785368e731014a9ed88711254673633b77187328968553ab10a9058bd1cc02c52bc906a3e50a2f534c265ab31a4e0166f3b648c5924dd6bbd23d28e8f7e951cc172e864833797941414693e63b08ca5ea8ea4dd7141859abfb9242e7bf114e64b32332418b4cf4264fe6f2d0df74350dbafe0eef11be2e94f5a59f6473cbbbca9d41d970f14256292411717173aed491784949f234e94baedada332c72d12aef28a4a4064cb975d85c52bb125046fef60380e5e03fa322a348aa0742935958f41d29a0dada2f7e97230b1eff37c9c211c8199e06e630cc16da0ce6f631d1640dbdda79654ffd9abbc25e797d0a97f6d7349dda5beab7c984a1f466f3955e05210e86f5ba8744b47425615963fc2be3a032099c0751ebe65f3514e0cd9b4cba40314dc93420a487278f4e81313c6ff671d2160f0a2c310370f818931ece2b5f3e3fe5749f0dc988cf634a9d9c47a5edae089b94320e8d7d3ce536cd2616b6504750fd3198500a8fe45b51736162a2a6be6d8af8fe9773195d3ee02481156c68c429745000a187b3560efbacffaf454cd3c47e492e6b08d2d82ab2e1b1f89559752d319be1de97527064d5de0fe7fe024b41c329e62d66aed11f9c2581497152b7771de8a3c327457c733b0dc9ba76c6ceb30aefea1ef5f0e356dd380b7e7f45b571391a6fd2e2cfa082ffd882b59e0c5928bc068d4877eb40074040212b897000c461a42f77c068a592dd0b5a5e61b43f773b0d18d520d6ae5b3b181eb2f774dabdd9bbc19ef010eceeba12dfabfb32b5e06cd2bc86e714bf3988ae639d0ec85d1fde35453e0e20b5189d1e0d4568285601c1c326c652ea35c9ee44c9b0715c44f7225b8e9d6130e8ceeec6c3243a19e42dc9736ee5552eacea63c1e2adbfa8f14f766758794d6cf159754d9e12a1024a5652cf86fadde11058c25c5689b3b976ccddfef17fbee6dc94a87cb50e50a93b034030fa53e21f7c775a41815e144f0cfd9145591d25046391a6bfbb1bc064901d68052f3f225f9571d58c9533eda2530c59be5874a271ea59786fcaa2bb9486ff92df5b7b08aae5138e656302151cd22334d95fdd17bf5cad3cb1226bb57e88af8dc4afe9e811369b810764b31faf5ebc552618032e4fe9b7d7c849c0bace2aaedd73cc731e3a3598cabc8a8a42351a378bfc651987cdf0f32abab85a9fc5161409e0f7f9f80ffdc96aaf17f6509dcdc695977b7809681d95cabe27afad9ab00a07fb79a1049fd8cffb3593249e46dd25b60e553a7390168bb0ef39a4fccb2b0a908fbde30298deb0836173c419c9ca8d63c99ab348c0e258772d6653233f1e903246aeb4ef7d3db2cdfd13c0868c38ae74aa962edf5df8ad0e7f604460986922e3daf3e678eced381a2296bd2727f32cc50d20b5cd66f1fe1132a864f8c2ea3d78b7c2708e17ae5670bb6fa5e74eeae0e01d812c101a2a1827eb9d2f80de62909100dafe16479dde13748cde4336907cff0bd10552261f41b669933fe48134390ebb2d3ca031e5532d36e1f3864cedaa4c7342b2070ed31ff38da34507ce46a1bd95e3ff3406423995cbe4257cc24fd376429508b439c4ce80dc2140cd17f65e672f1fa0b5d7ae0ed19dec6bf2ca015747e89786da0b717e093951a23ddca303a314ef5b78fb125db896a60a1d8f75c41f4a0e24c81e8dc60d0edc591a5537471e4fd08cad2b5d695fd004360ec1cb7904d7188c759f1c1f9dc14f2e0cf8403d9f345ba28a3c167c985c34d598d59636dff445fef6196d8bad6da1b396806342355e843fbddbe9cc3e620af336cfb12de0567a50357e3257fa0456a48c91489c1db2b7cd4d032f54dee44c44ae6aa4c84c2836a656d37cf279767ea1b20cc6d15461da5f470a011a21b348ec2f05bb0badc9d4e43a57611a6d401b940e95003f9391d18c1ee29a6a4915685e4ef567eb72c3df842b4e601dd86783099cfcef349cac3804eacd9ab34ad504c08ac2a7c4973046461b20fee35567fa97ed9b3441e04f534add8af5300fd1cfa7562a4cd2662058226a89bd64c9b63c6eadd000b0ab514cb2ee89aed18ef4eeab44d919a3c6ebdf01203926144fb888b033bf8773d705f7b412cc7a118b1a1fb5b7cbc98b06388db69c3a031c62842d981083f61dc4ec54a8b6a7750426e75bcdc08d2435f87067185a217dbd6021d81f1dea18efe8d8398ee49b0c8fbd49c7783e7308a7aa04b99c82b9b151f791fc401af095ed65b3fa51906b05d2ab775d6086b7bc3db1c82c17bea2e0190ecf2e10e10e29e73d465d7e8d0602f4b7fd43b704f807505f788c1e3555b8f40ce84f909970af51f5c4a2d458e888bfab1810129ca5c77d47b8dd6895454cb82cb635bb49415124b0a10efdfa7b5850d20b59cc4fddfffe7c43c3cda22babe864693fb122cc3f7a03313562ea37c69768e5b502c825a13a245b72e025bb631e0f9d3f8c2f6242f98eee221e3fb23ed7770c760d19489700b5d54f4efcdbef6880cc0df6563e8b3a65f31509d4375954c687d2f210c4372b80aa422063bff58ca936f44583fb92fd9851cbb580d3fb3456fafe9113086ca748df63135f2d10e4ffdfab7532c7c37ffff66d1c14f2337d258564b5a743c50cea7a5f9f941a8d1af4595b6b36f8f1b63817df45b9a6412a61ef66243228991c4059ff93694451db5ca1d23f283ab7f10d3ed9ddecef596504ca2eedc8503aad7c1ff38cd42c2cef6bd0d87715878be541500ba0448496db88517733e55d35a09e5a79a1349a05c422f3a39159761da8f5abcd07980dc82be536a6b88b6de1ca5d4ef3c8dd22012d2dac9f8d9019ad95012be0d3960a080274dc7fff26d41ec68083acac5f185c2165d4dac9e1c0c147d3555d9988da91e12654ce257f22011bbe369705997cfb427690203f3ee7d49222b226c2219e5aa18baed9cee814d84bc2c5b5fdeb2d46c2e770edd2b218e4833af6a4d29e64782c163d06c3cd373aafe3d28bfd98ea072172056c03ffdeea43245ab8ea4f6eff8d64c6fd5c6777d19dd675dc84dab3c3de868db7f2d5707f4b512f207523dd4f5f7251eb6553c0e1654178b7e22d4ca189931558124c0610223c14f99296c0e54208031c89eaf361be0806077ee915fe224bc4ad34e044da8f979046b06c8bce1430cbe618390a6590f9aca52a0ea45e0ce9147512e132e700de3fb9a34f2c6dc7047f657bda2363b20790ec4be9f337db304772839c64072da4f3a32252d22187ece14f58dbce6462f837f11f2ad2f1600297a21e87978cd6f4b3ef688928b5431055ee31b30c21ccf9bb5bde565b989de1a64c8f33d2c5427dfa15b029cc3817af7295b6bfc3da83f17936ed727bac06ce7a87dc7132a0872233007fd66a6d8393f265e05fc19ced0079dbfeacdf98fe60b86edaa53d1920973b757bdee1d422ef2a5ccf8cbf3fae836b2ff0f1f86c5bc9e786fddeb55cc79705aa429d5529aa95a16ada2d38405c3672487266531a2b39eb82dfdad7f965d27d6e22031c379f45f8e8dacf0f05b751dae1fc0e8e97b62baec95eb0144391b40f211f3897730cbf1b89ef6297610f7ae8fa1e53d715ba63c39148e3cc04afac1cb1c15493e436f206f456e54b9747538fb1aefd610587d9277272885fa544aa137bb1298d0a1c5857709050f537d8ee6dd3ffb8bf3db91efb4b507cd457ff4bf11e443b5e4530f1ac248b9bade6b817150fe0e2f66aebea635ba4e7d59e24253bf7ba8ee835081713c35822b6bca8851536fa87e4236cf62fc38d35c572191bc38239829e0735bf51cc43b9058367008eacf879ec32d741afe2f1b657588e730d22bb594c6dbc4862e9ca065dcd5ee08fc37f76cf53f5b7d2f5ba7e1a6a15f6b1a0518012b4177cbc565315b485c6fb73f32267838abdc87bc7490285abb69dd9529dbbdfb00e5539d2b93fdcef3b5cfb5939e9c12db0b23adafee0aa4b20c6904eac5d8cf5133f50cd0b0dda71003b58f537b9f483f2165ff770928f9f665b4072f373efddc4e6a0a71fd9375178a38aee6f8989c1e071f155a2e57f9febcc9455f70e5a326c70aed78ba4b7d0af0afb07fd658bc20bc50ca32f7fadbb425185245c4b5945fb347869026de8d8ce834dc87ab71312589ce6a424943359864839b99abb43658a0d3b5beda67585d83d86c04c5ebacbbd1b3aeeccbede2177d7d851733078bae1efc31e74dffec9ef6a4901ec92592bf035679f8ef06746711c28b3139e23006d91dd35808cd259363bdf58de3f4e8fbdee060f71ce24d661a6f1e2f6c19b0e32fb905a0f97cdc230cabb630181b0b86b04b49b2024c138995c38f6b028b9b1a06904638f9009d8617b75ebd91914bf22ab449779edfac8e61a326d69878e70a6af8fbb7f0088d4cac9bf7e24a5b9ace5c8cc9eb6b8de06e52292dc3db1c58d7d46ea304c0210af5cf60c04eca69de3aacaf70d8212a17e0b87385904c034522781e531ea9c067f295c97ec0600ff3409c42b43b7f11c93558b0ea85640785fc9a3df81b57d88f341803d7dfed16c2dc3a8b3a7b37f774937698e11f46c2db937c4e13f6ef236db8458221f59c6292e24ce6ae900830bf11901df121b95bdf1f9b897cb10fe2b09c7ccee6ed99aa79f679b952f31f94621fe240a2a15738e493f7b7c796f3b24fad4f6c36c5a8eeffb6fdc50fc626f6ae748195b8fc7450a46a90f8ad1957ddc765ebe686d34786c479ef1f89641fb8814ae073e13fd38df3dfa7421f53f5d821be96e8514b04ba2227228b41ffe8a867f07d679118513ece8e7aa0e320121869bc0da7702cc72650b0c8fb102c395637228e008c06a91c030d20e3690c6d00a1f8f23c50ee2b7d46fbfc509885b37523d860bfdc91af66e66ebfb87d25f40cb40e3f5e6a6b4fed353389a06227aedfc02cce0ab0164a2fe6522faffd4b7b94e05b6b075cf17fb99bc03f2b9f72426291fdeab83e7aff6c9364d62286d39395dd45c546280f4c220037ebb248381c2deb24a0d8ee53ed56f78b35b77d8c4a0e35a9c3f76db8fc4ddb8ac0a2972be58bc71dacc204297bec4957a22224bd87db0d8413ab94ac91823510b50b02153f0ecc84408b57993f490ee7b6aae58a23be68b5733160c6f771b7beb1a9631506b618078f4d35ea4514df00b040aa29aacb9477e14e5393a10d35e2eb084039d0fbf440c439d8247c2fd2c136125a5b3053dbaa863fc23d5c4990beba30a452a7ce151ceff4f051cdea0d2b717f4c86a20034f556b31a472110a5c623ca3273de496d56e4a6f33c27e31a0c21ce0bb2e11706c55b8f7af57567450f3829ac5108576c8ea93060c636dffd56759aeae2c3a6ad2d2e3824847f062b15a4e0eb29e0dd9621a1ab8be5ccd9e3ebc2e2894c22d0aa0ad7412be8236f0368cc1926706689c269f5e5b980aa68fb15bdafaf85da51f1f5a8600d5fab898d7c40cbbd2053be1bed41abc255509044cf41f5919d69778ba484bb8dc5bd7cf478e9fef18cebf574793194e3e0c902428e0fef7db80346aaa2a10d4530bb9875d387933bb2c5cb1e3d03a1e3990af9118abc72e9cd3aa1815b0703352c3fde30d349ad88a8402eaae2fe4dc051a62e163b1a7c3204a1efdbd7f2ab080467c5ee7a20cf36b858eeeeea426924e6b8b16b02dcb644c26094ecabcab496330bcd446cbbb3f9f3e03a30e65d90696bb6fd07f06a0411631d57cdb6182a2da5fcfe5e736570cfa0bad4be88c7ad06d8331645e3531bb934f73641cc2ef058d24193d34bb3b815ca163782d372108094a1d4d6ef6483ba1e3af88c68e52feec80dd7cdd264d61676820de8e50f313ebf1066691e48104bf4b3a7979cc2685d5bfb1125f8308acc184fd8e6ea98dc495cba106e8b69dad388d4cdf2718ea2d63ab1c58cc922ad2d69317bddb53e9ff3eaf3bfba056530e4883dda846e096f0979321f414ea73b65998548c9e9f6524a6f4467c645698edbb7c2ab75d23498e0b6552a6732aded8856d14a633dd94f2435a390d4267a61f63dcdc1e32c1c403cc6605b6ee133b5e7dd10c2cd86f6d511e872fc814c51ba6dff9a81dc317a2169dcd3eb184c851d60319b4b0fe14b9c6efd0a652fdd4a71ea6a0332d41f4026198c4d845c42144f2a57210a4f471d4f05ef94ab7f9178d0b940b26e1c862a4a0f7d452645cece8fd28d4ed580aa64d8a3b21c3c9feef6da23139fe4c44eeeda6bcd08be71369465f54b984b619c914fd68e36a6e2cc16072308a37b70a1da185f29b7ac31f2e8181f823365c3b43f76a9ac84ba5a4a51445bae82a80cd811bb8db27af36439eb71f1b5c505e4cf387eb07cbf8cab4553d638f60c8f6c4033857f4360b41066d210dfc561bfb74ee9e3bc33b9535999d79d170fc45779347348d51c00f7cc96651549eccbceffe6f8407a06a0b1a313a82bf9b09f996b14e0376329c37ea17a7f39341ca805f25542cf5536410ae9e450b5a83a205592f23297b140e5f6e852c0e52fc8caf15b094596d5e7a4bd8a3ac3882fdf43a804390fd61efcde75b7fbe17afd1d3fa9828bfa096d5313c9b65d9549412e14f38622c63fb177c3a21227f0b732cb1d7bf06b780b55e31412a8a82c91041c553973c5dca99b037b657d02fbd2eee3b83f38252f38fa143cfcefe41f6030505537409d8b1f4e2d9991345c5891694e0dd63dfd77c65f01c12b111af7860a5cf3d87ed3eb0aa9ffbe5d058f6a9ba607b289c04dd8dcbc6b56eb059237343b992bfb8112a767608667e8c5f9122755717de92e82f3ae704e6a972d225e310e5727dc3c95f74890496d2caf93129c2f922cbc95474a4d674066fe99537f6d6f5a20d","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"fe727b3ec2446f3e9140a7a09442f679"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
