<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"ee529fd4bf7baec899fd5c531a79293627eee6c8854dfe8006211a0dfebfae706d2be975fa9bed380be35d7dd884df8e4c8478db558d0ff70240ce7018f99ef90f695ef3dc9f51afd0ce8def9f7ff7e691194a79ef47111be9acf86ce2bf4ed5478bc0d1d9e93216cec794f1d2508fe139869fbb38db1331c952c775bf6fa631bc0a49d97e36bf6cb2c96e8b1a1af7d63e07b45cb7ede6e39f779c6cc59cba9fd82d1d063e3ffc894b3678db63b37eae31d6aece41068af122268e8c6b54a4af37961170ff2c9b3e0672dea997ef8e5e9032a7a871ba2d5f0ff52fe32a34eb9b346906e577663f0c9a5f0ae7b708b3393e4664c047560247fa0b5a98d6155a112ddc717d4b98941f28b143af21df840d0a6f411c40c2ddf54b2817426177a944dc3aad1b769727905b52586b30164f203a896832c480134025ad49aca50dfbbe72897891a97c4c93c5a1a6d16a883dcfcad2d08bf12b7e5e3ab5edf3611c17a107b7520452804f736118eef70d592c0786053138274de6188b2ba76bf4139109e0d93a62343993281f7cd8616af412b1c38fb3be8d3738d4dd6b9cc86220984f71be8c85ada3ee9e8254de19d42327d5aabefd2d6a29bac1af100ee1ed658978192e4148097b38c817ad3aabeefa9e942de3d82fb052aac40c98fb020274fa53cce79a6ecb22d88c4d1b00d8c5f63113c96b85dc904db7ccc61e737af3eb7081f9461c38d2045e212c19d72ebb3b846519c17198d4222c0dcfab2a82e380f9de2cad405aadb4bfd815ff36cf8c164278682ef869ea3279f3ab6001655b17a1b9ded160a21f0d5a25d17a81d692308a4243b0e1fa1ddc028987d1b8374216c63a0fc8a691b43487e544130547ab8b3ce179f3410a275ee062958a96b62723b0448dcac8c3703ff190d7c0245f4fec8dfe7f79f249d571353520b95d4a5a944f284843664e521c447819dcb9717aeafcd06c7cc27204c66b99f0e6a37c0f534831021868e0b1d94ef8e0d8ad6f25f6dd5c4ee770688bb0b63fd5b78f8775df28f7c5acd3a54518fcd8e88e14e3e70fcc4ca7d1097acc280db0ce41dddf79f73af8ad9a43bf6a49d26dc4e00dcf8bd8f4fe135a9f4365836374d579af269c34c662697bd10be7e34e630d738cca6daa73579561bbc6095ff4c3c1fcfc4d50bf39d90ca8851480bcf3f070b8d64f34c96e4cff304a95f5f8f5ddd2c4bcfd755ed2a78bc814cbcbeaff3e5adcd6db8288bfe683b583888d82d1953cedee8db23ef44225191798a7129a0a396060e438c511db1d129431b750981025b8087063ba50244214c64b92838a49b3162c47d786e7d9f21c1f8a86f6b4ca649781deb60f586d53b59ff320a91463fdb1e28538170e3309c7593b26288877b7fecfeb3c1179457fef1522b0f1a9589e242259f458ba53ce13ed8ba5b482324de8c136271e80715a7b26b62c610dd2ebdabba12a7111f74ac53692c9be284fa8c43f965e75f550cc26cbb2a17305ee5ddabb3955dc49eaf7f98c4ccec2aeceec4e19cbf18f6ddabb9dc13c749dcb3c0842e32496691fd24b78bc3e684c7a051b4a182843352454f1efa9575f930d6698783ed1577544071dc473f129c9d08de070884e219da83cf2069bfe48da6bee4050e8e835edbdd124726cf337e75a1eb4428e32033fc1229c61c64cbb3bb25d3dff9da637023c2a12e282e89537ad06f8d1f77d6e570ee5e0eac5eef7cf48c23e2f119d23b9c17504e13211a6a35066f423f9140d4dd892e47c91cda33e7742160265329537bf2ba09c7d6c2b7805efe001b445bd1a9607228cdc88d74569e518bbbd7ed5f8e8c9b15484d69dc001c7f0b38f2735d70b774b31a911ef65b54a549e74784bea73b459169cd10bc450383abc5c2ce4b641a8cac9613fb2fac60c8beb6312ea079f08090df9f57649b86baaa5526f7ccc1ed573e44b55bc889263a60da2e871ecdabc52ae5a3942d102e6936e139fd41612d48c03ce8064d4eb274792bc3b0fbd3174d4ae1e7281a9a888974aac08ee0cc772d4ef519f88e679fc6a91cd4f928e9ffb6a85ab7f0e7ec7dbb3cd24e25062ffae95d14ef347d4c8a1c76150a37a02ef0c19635990efabe4d7fd84dc14c319b429bcac0632db02eac30ca13790e5042b5b7793876bc5bb9bd60bc1c9b2ffdc4997d675308afe77b4719564458c8cec3704541ec55946217c8b551bc09960319288c2007cddaae363d04f11588ec1507fc58f564c58a159553c83bce5cd1937927cd83dcd3c94918191f6f0eb52d4e053c2a66435fb942e497825064a058028b0ef0243f61982581fc2fe44236d8fadeba18df66ebaefe201db093c91acd83fbc8a24ea349d6b33ce41e4016d074a9d75a2016a7ef3832fc894941247cfe198c64beae8f1a16d9bc8deded439189ae810aea1f6985a9a751dd616cc649638f62b0e7af0f844e086a75afcde6a688f220e304b76bca0bff52758853bd3d2deedb55474ddcf7adc83759d25d0d670e0a957e2a1e87dd90ce9091394a67398377bde6a82a46179d23d887a97037fdb3dc3a715ea8f0360d258e79fd2fc581e411e628706974721ce836db4d0e0194f57cd829a02e04a8bed3d3ad7d314be5ff75cc90cf95a13d21e84030f59ee1d16209aa10cea6b8242910ae1b00ff14f8232224942aec26b68153314989877911ad8f4dbaf77a1fe769bfbe0205d40be011354e673dc9c54ce861123256ecd6208992667dfa105e4ed18e8edf3e32e712ec4bd3b81defc2615e3a4686c0324f0bc58672d8b0075ef785cab1e577c1795e6d87b0c75c25216ab3ab77221196a9dcd2070f58c2ded0006cc7b476628090fe9bc4320a8fa22ec6da8b7af0f0d422aa17497d68c08db5df06d894375fe2b1e1dc3b108c71e808ca0627fbdb8b211544974bbfba92720f39594edf7d2ef74754639857e791242c79767ca479dffbe2e30400964c77e12a4482ee3e7733b3bc4d79037c510634728961c51db0e62bc6b3b31bdcc98d3e34d39b92ea3670860ef74e337c8de953c933076ffbc8ce7be0cca0840e33945f0b76de6374b774615d1dd55fcc41745714f57d0c653d17bfe70c6cddeafc519160c8288c9460500a1ade19452ba8dfb1fa983122519233743276944d918a901b7aa2217389c04097278fc1890a8556c420cc6599e02c28b198e20e9f8e6a18ce70906497fa4036b74954c3d50f5b7a98717da70949e38711aa16db67a47cffd001096973db3da0f7690c367a05c8f770d63513cd375c37d2e8a7f9ae5af902a2e4d735edccd53b31cebdffb84ee1daf212961db882d98b0be577e3d9a28e070779859932ee58c6ecb3a4f3721036daf308876a4fef46d944ccdd0eac1ba10d5da4a6f8bfa38635d18dff2d29b06fc3ad2419a4a6ecf5051b2e4b528e4f2598ce87f49eda1a1cab0c237a93a0d51a37f3b5d01667fb12e5d8897b27624d10baa51d17e62ffe3bc5f501655f34b1963c4dc40ac01b855a59c2c0b70c70c696b1e128952261998317949115775c2464285dfca3c8c53d9816f3a7e256a9314ef100d26b37ed7e999b48ac55a4969636aa405d3207f2f73a7e669b5e9d001553ff1a9e7ec79226dd4e9b5f790306387464ee25dddfb0b14896b887d7c45cb8745f9d090d3d8b4dc21b514a85b115df2980224df7f90c66de89ad2bb69046dac115e7289660e0bff7575862664388d49de4e7b1a373a04c444e1062c6d060892c11051a9a63942d4527c14d98120aeacf81f97f5a5172cdfa84c903724a5ac20286194f4a36ed21631044d48e489d9b196b297a2d2fb3882895e6861a60f8b5c251ec76104ad6d761ef6657f8923df1b31aff6f08baec55f4a0b8d729ddbcade1234b5093a6695cea0fff254dc894aa72d55527d5ebce4e3eb330c503e0006e7c725b09572cf78ff2f8e12c857c44139d3180519f8f782d013ccacb661a581cd710b325d74a642a86ca0ebabd664211fdd2e9e0173afa0599d24c3eefda160db51c95ab30e459fb7428c0e290bb4931e31ddf1623bf824c8e93af37fe5e91577957f8e96a1a742ca015e2f50c32040d7f7a64aad56cdca6a7d1e92964518995b08a713c2373c43d5f7b396ff8b1d758a3ae04e56730393bcf77d0d401a44c58c4d358e1156fcd855f0f0439048c7426e7f2d1bcaef2faae6548f567dc54a2faacd372ce6c70f61cde5a190af8064d22d6e9a4787ba4165cf395c3664cb10b29f7a37e1e94fe3a11707590bda23c10513b591f464a02f230613ce15df15d6f278cdacd2f55bce58153f3d8fd9cd4788c0f109ca94232ed951e7873e4e6487db42882f679a682561ef47971bdb0985956cfa131c35fb0d04620a87687300f84811c73b38ce1d9330135a7aeaa8f69000d6bac41c58509d4f626a6a7e0cec8f528b38dce4b9cab2f52b44c301f5e56b947107ac7990a82e71185c10b2a504f0d25d3af3c7fe7ff58938afaa6c91ecefade74cdb98a7439f27be5a6e659f1bb6facca3d804e1d42699c4a2b05fafcabe010099dd48374c480244f724b51e1dfc06882fa3d4110929cbce498b91780a1b249d29be0ba4b1a31c35f9aa9ab5d8291dd6498d2e697416fa8ad40481f72c45641eef07ce94a74d20f0b16e13079aa3fb73319d41777d35ca730e4c7b09f1b5eaabcc2205106e0237b1dcdc518980efde02e9d51012cd4aec265146425922984c04980d8e71a16941f1ece7220e19acf40f261c019f7acf1c98156df5665a231a754baccbe3d7874219125cd7b8e29cf23029bf186b9836cd26f5f22b198c897d823470d90da4f76217cc492722c6af93874bb637d19ff1668055b5e55f869874eceece5d3091ef4c15be9d46c41e67d97c41df139a390c791dcbdc1b0121e693378414d537e549d0271ff3fee8a7e4da74eed87312495b6d8f54ce25611c80fa77612f358562b1d370e90aa8563b8ffa072900df155a395024e85553ae67785e782b92f121ea1ad1bca2ed97faf19a1f214077ab274a6eaa7c4033eb68154cfdd96c172e8e81fc2272752f3fa07b6a8f5f4bfa26fe08cec67d29641c34c28558d804d544c60903801f1938cb8dc826a6e9ac148e6a9e4beecd767cb2bb411a886c049ef7067868fd80005e9a58c38447bbb1a1c5a696ffcaa37b650a947ae733781f56ee20d9d1801218b1e4141a72e4aba830d47252567b6d6055dfeec0bf84146726cd798a2a9ee810e6a957afb90b6b2a5e793a5cd9e7cf9ae583063c3eed90387755f5fdee7b4e7535f9fea12573e99c4c0f073f91fcd88e82202cc70e9b5bb62e56d8bfe5893083c351a8040ffdc753b42644c73799829ddd04ae70fd878a4a6dc9f6929aeffd1682b9ec48e08a5bfbb90a49563a7134f0075e5a14dc564a3d3da9870716026585d5a663ecfd7352523b8e6f5cf139d871d96753a5f9da4319449d9665287202388ee7caf45fac56905fe843fc522bb49bd5ad81040f8f08c31f6efe6701264b383970db243113a30c5dccbf09e0e0728861800beaa4c5adc7d2803895894b9f2451248f14c9801f3b325cdefe3713b0539a31b19dcf6f193e498809e7269706479b234ed0cdc027674155f7150b34b6114575f530cc59dd0f498229afee81de179f01ac4982931fc4a99beafce01336bae93e46a11fb8801a93c894e23990c79479556d69e72cb5a833e1435dc43a7414cc969c81edb0f0b54d91dcaaea832501156b2c26c55085121bb0a85fc10323b59f27e22a4c28f17b1cea5bde9da54851122ea7fd7c3e7ef424ab7e733bffd4aea063b9e18a34d7824d73979ccba1188eecbf59d0bfa44c1be60996e34bf10791c662a57aa5819988dadf5a84182aaf2c5c545fb4df536bcfeb27eeadf23e209e1d6365e8b6bed3d840d29e0ae2ebde5b773794c98e355deb0ec993c3f2bb9d246bc3f860adf98fcdc0c8b5990b111b3a5518fe607d1b7d011d789b005e3637029577f8ba6265ddc93c1a77474dd50e244afc9ea3696d9e3c36dd4bedfd25ef1728b02395721376e90f5c97eee94e53d8b1c941f2fa84ac4032ca6e591f8c24e8f0feab446d0d621224c0df7a8342ac33cbcdeb213f8973f824635042d18790786cd2bcc45ea10e9ff97b55214bedb8d8ca4273f775b2d70e6a5bf30fc2dd98e6fbb4ea25f936b40f354543022ebb8bf89fc2f97230967d9d05fb1831f86480212cc46b7c67495c8c9ac1270b5324a8d12810ab8cc24ef69b6f8c6b34414f20f297424982e8470d0d39c5167186f339e84a0212102a94db044f0f9a7f752687a51ebaf117f6ad66c4adc3125b1e12960eefe3933eea3c75cb70cc07c512a5375020a0dc26d5afd2d445f7658709d0841024f8e755b1aa72af44c4ce6e65cc766e0e5c6995abe1cd3801847040195c8cce6f046b403da3f1cb5babef6f701ae2061c843f99f64543c19cddd59771f83b07fb146e5ca372e1082fffb982254c42f62dfcebe7c83a952eb4e622bbdac3826221a196cc3e0e8eac5e8483ccfcc99147719281e695d893e4a199f7139614b4ee039efaad5f3734a74cd46c474d017c412eb88e6c2eb4187d7c84a177cc3a72dc142e1204ba5881069013e7f8db579fdef2a71bf5b1ed83fd20747bd70a6a05fe8d3537e89d88d80376327715c769d3f08180a8566e59c03fdd4a29d733fff7d856d5e8a1a1e01b5f2dffaf3be06eeea33408b2e3cfc202821b5e8aa3ededfedbea6c97526ac035fc68d6033623cca43901d07ac2d1cfa214c0230d50e6c6b18e9fc7a42c972d166a88ce5c888246fdf6ba4c75db720e9f590840a877aedda5a525eb13e500d535185a98ef241f7c0e75b9229d8bb12ef2dab162f4287cd1d8d75d5e09e51ef39da7dae0318172277f05b635027ad39443bef0dfdec7b6f5413e263851ed30a93c4dc22f9ebb9603e6d3910736cd208b134c9221d760e3e477332da7c1930a49c1503fca2d37cd529f472dae218b4cf6e7096b94610ebe3fef0d4a10b8609b284860c7c6dff48dcea8757312920641a93a13806c476356e73499ec87a553793806f0816b4d9695cb4b1a119eabb4309c484cba9bddf55d83d3d6bfe745930c17de4fccd9483a496671c2ab3f784d472a60d5e69e3a78e22cc4f51e3b57ada02217440b6064afb8271a663bb8ae8f985c676a535d4ba55d6269ffd25f898c3e8533613a70f684eac4b2284937634fef8af9e541b21bc085064f83d2166b900462d5ae9c886af9cb2b9c27721d40faba3994319e08a9f87d95d63143c7e70818bd85d1dcc1bb60faefd227c41bbd76318183e1a8955e1bc4c74fafecdce66506be2800be9291a3090a657bd26acb5a2f25e0bffd655006b97fbbffaec262da2bd74d44d1442b39f5cfe0f857630bc34875d856e868b94b595b04d22863f368b55b7b449e090255e8eaabd78b0b6f96ba59ada4a74b0b67acd4a43bd8c66293b719d48a1379f0de60db34dbdbb3525183c67c310f6e5057e56efc34820a71c317ef3cebfb9a73e54a87333d469abd710c0465d0bf85f5d637ffa507e2fb4b7d0559cc02dd80368c7a2828d447e71a9251d1d708e6c700d80202c610424686546613de8bb6edd0e5512c9399627ff4528a1e5bad7a38224923792e3b8cd562f71b879f6c8bbff0407f5c24a1124cc73b64ec76c4a6d829573ea3252911d87963bf24e6cff4708bebe03f0fe8bfd693b1d9e49d3e99aab572316ddf1ea18e44f3798c86550eeaf5e9f69e4fbf0dfad55a967110f024d1b86749169389bbf6bb4ee2e2f1556a0fecbbff41a5460a731571005b35bd519ae33fbd417a451c50f1e8750a5ec0f0002853cfa566ebaede67479186cb3a99164ea34b8e7c5861b5e4675eb1f240d9fdf421c318664b1f2c20d39f7ab71a9afbfb6f94806693c2ab96f98ae6c12d4f1e1707eb5f785d9d98d91a156cd9cc39359a98d80f253b2c5ee4b43448735c0f2d564fefac89804a22d153c9323da948bb27bc2107e5cb9e1f4051453911eac2e8bdb698095447ed6e3dd3520962f20eaff5045409d3d1e14bbd9c3b7dfff12a329f10e49792c9db4dd33c55ebac6c36645430da4f83e8f1220aec47b0bb1648dda66e4dc1ed83b104ba2215567890da099e204a90cf50a14437af515c75c20cded7e2c667bdc47055ec1d598d3d5cf2e2e5e1458e918c699087eadebe3333e3df6b71976e0f7e8b0adf8580d4925b613a35b289a9e2b85e5f75d2d1ba063526d99bf2249eb32f2dd598326295091a0898f2a9a46470a153e7e72f493c67bfb12270d1020550cfa35cecbd8b4bb407c198b1037aac98d10f0d3f0b86d027732879296381efe135b17e4fc8d246f4e5f85439ac7bc5902aa6c3e308c97fe053803c2f8ad1eac5e5829daf9e74ab79b087226ecda3cf3b0d96ce02cccdd418548a876d7700f5dd64a012287e982e9b29eaa81dbe3f6677c03b9356a36db718ff8a8214ce8c97f87790ad1844730f17d38de56fad5c20ffe84fd17ad4872155e5b73022f563f08adf00905152d3306a4156cbeb1bb9c393c28c6ae229f81834555bd4ee0e7e1db98c665258a98a94248ae60b2ada83dcd26124d8e0bbeb7930a32c0d56bc27ec632e152270e625f9865d4d4054fae795ed78a40451f9d0d2dfa8fb00ceb23adb441a77e1a7aa831c1bbd2463c735d64e3556f99b371c1c47c68b1280fc42dd64fdb6bab457af3526c19254495edce6b78b06fd3b72db77cce222c7b456dafb7223b5b45c2f617c45897e5f72c007c0582c6671992cdf9fdf0987e54375ea955868fbd20def0d7c51b2bcf79796a0ee879b9398f6f2970c5e7e6c4ae950c8e736dabb34466d69a03d615da58c3f0bc4265953cba8d11ef1b7e4d08a286d1d96ce1e37b0901dc9a925c5dfef6842389b40c44fad37bfd6dfbd11df90884d3895d77ef732408464fb80a2c930f16473f20e69403bc58f2f76cf5fa40326d431e1f35d381d70d504c06562f3da6e072ff74f12df21b054c9745bf3bdc51cf209560365d6349330c3cf7c43b1f08535011b946d5b13d43f2b02f45d59029158178fec8883341754dd5a3c83f69a177e7067aa0f6ca3bd75e7b60b9a3f740e747d054d02e9e51f1e1a5cea9f3547b301d4d9062c4cd18bdae9c5c06fddbcbf6b4b4432f73fe7ec648ced0402d87631d1de9db6b231fd47c8ed2763b2e03ccceee1e2f5c7a8ac13ab41b0bea3c40ac1de0463f2544d22adece7027d7b3d3d4e83b78b859294e184d8eec29c52f3db87721fc4c39e606eda705c57898f4894733fef30b3e2c2ebaccf24978fbe0ba89580e3c2d6daa77dacffad34e071fdc40f0385d57b11c037199028525c19d240558f111a4581341e317a6f06bf11475294c66d3e0fd8ac920808f8b0467cdc878ba80637e6d80215dd219cd0b7906b727be157581835062fcabe09fb73eda0d53d08a75fe08dd6479315890c311073740ac0b17c67b42553fdce01fdddbef6e421228af231319f42f38decb4dce1bc1276a3e6c7c620d27470cd71239d72e08b0455866577ceb9e2117cea743f7d16b4fa2942de71e8f479acd224de422c2cc2722c2a97f41a678bac0e49e8e082053fc7520139b858e1de45419297237b892a4b2e629e944fc157c62f32322b023cbea599379c2454691e752786785c332aea94cfa5cb3f65f15e142607a03c7ca495f9465d3901d8adccff2896827ab689f06e14831dd4bca902af636bbd01cbf8815712171b733af890127371f6a80f647cf16ec09a15fad10e5690f4e863ffa9e5f4b84c5745250716227d36c77235ef2ba40739e47e7af980db0a1b24dea635a75a2b88aa790b24131217085cb7c942c2186a20ac14317ae8d11a8435878d1085514a4056731f20e24e6d8e6234a79b0aa7b0d5b1935fd61ec5649103037e86fbdf3c16e5effc09e5eedde5707b99e98534bc20d0ffb6a673504d105ce8ea8afb55b82dc707d2240fecc402cf39270cebff2d65668f8c7a7e5a3618a0423c551d2c58e66841f0f66648db7964388da2ca2ade8585538a1361651b4e6df569efd2a07b706dd1138938932d6995e3d3b16747878dfbb040e7ca673444026d1f7408dcd7bdffd1ef3afda832f769b23594e4187822a2ead654b2becf6723b8155bf01361cc3586e2dfa2efd377b81400844c64569e073cd3879b990228626e3c0bea4a8ac502aa2a2ee5b69e03162d3ecfa2dbb47df7f9e2ccfb23c891ca9286d3be363c7c2a91eee99763a089d35f5da3b74bd5e8c743d95810adf1685ca3d7435fe8f767918e4fcb47c5e0ef511787a649ef0e49e1e06618de9ba150292b502de927acd611f24bd860032da83e6bc6f9b250b451c8a0aab9c89dbcc9c853fbd5cb411421fcc543f918612396ad4059c14e32bfb023192ba1d39f1625cb80ea8c93f689813183b68366a528480c2c33dcf04c87d477fa92361a2dd85eeeb4439136330faa5780dcd37f41d379809a2a537b2b157ab6ddb85a1e8ad730d33cfe81f70cd2241ca3088b7cf2a31af9339032068f599a12800874dc586e454221fa54e36b4d62c57c8e02a66219a850687854dfaaef2e56df4dbceb44993a669c4917abcf886e4b1f2d14669665fb1c3254cb41cc07ef9acb88c3639cda17ec39c5a9480d725297fa7f018c66c6cf7e86a7cfb684d1312cbe93bf07802557af2d3626cfb858a1d01fa95f7eb5eb0458ad38125a3d449b14fa82ce51ed76a687a0a8df8067ce8bc5979fe2aef8f44d16ddee3a798d072039a05489889eab86ae3590a59ac960893a2a9866b802749e6ae4ee382268f7bb94a7b8a9f2ba319f8f56d9fa9b81d7533908621e1aab9d5f776b8bae62db6518877200e9a8b1cccd120ce893e0b5d5ff1600992b9460bc6dac7510a9d8c9ad7054412cf387c96c76adf484c80c6b14166b23263e4fae534ff00a3830ed5c55432c97f33ca9edece247fd3992f82659ed291332fdfbfa2e0cb256021641fe639c816e989241ebf3704ac7d65299681209052658dd61d5614b62e159be05e1f943575040501545b4aa6099d03f262a91c0f467bf6165d5ffbcddfb8a37fecc296ead5dc7621841b6c8fe08a6db2f3be7ae7c4ee0b71c8c19a04cca2b409405b9cdfa427c5550bcba84c576b2ef7da3a28983858aaf7a7d49c6bfb40fe0f529a1503560ed924510073bf08a2061215caa09a817491f8a2295ba3918bc2a9812d2948e5cd5996919cfa35946f75c7b3e857e26213429c2c4f77b98705a3ae4c826ac7ac402bec0be441545a1db3701a2c6344ed2e3bdf753049245b6c10635d1b26a6f70a46baaebd1b2905ccf52112955b18cb6253e3824df40ea8c655639c0355b54cac2097fa184afa2c71617729a120c7b0fa2d666e35cfd221ee4d90708acc7296b8982d0fc6d0f682146b36f5510632009db2a9a21c276c1e236b8fa33573a8b3feb2bd1d93268844b6f765f2045b71f0e101d95ac350eb45a604931b26103456cf9e61ec30784157a81e119bc49042834ebc76c6006296b82b098d237da4c1e09fd6647f5e585a1d8a2ef64134588ea527001d30c2450cb63b7f7eedd007faaa535232b9e4e57e043c46a53efc6a194a3fd51bb89a56a547eca382fc36b6fee1455765830d65991b10039622a3068f9053c8bd23fef66f86da436b59b9d195ac5b04e909a018ac37ec96f3aeac3540a1e5cd6d51e72301b13a0c9f59faa058e6d377430c199f55ba0975194a0ae5040ab9a5f15e5aecb3a4efac0571e9961d80a990029ce271bb5703944210dadffaae150383716165dc662575a3d58515be0e0a2026aeadcff17655a37fd718103e8e33907f4df86c9cd7d4f3aec7944b8c778ea42021f8122b5c37fa04be96a5be8ee9d31bd437d3bb01ccbccfc054f021b8c702cee5ee3c75e6950de8e07a145b7b626da63b9562b597abde935386f4e513d9db55fe3df46ab003aababab7739cdecb1ba59bd758877918dade7216498477b2afd5ed533f4908b7b3042cac1d7d0574347e2c0fae41a63d582d621964cf46462f898dbb64b27b498289c692f1a484ae8fd10906173ee70db205882a4c9d44a9eb33c3095d3938277490c48573a399513d572f744188dec209bde1cf81688d3c2230be015c8cb70ed9f59cd1514994a7225d0fc9f3d8767d19d6abf83750ee5535bd45811b161a2c4d2e9d23c67bbcf01bb629759416e493700ce78040b1b1426dad80708e3558c7dbdcf26754c29cc25a998a20719366e3828d66262ac68df474971c61d121f9fb6c419b124799a81b4e0c278b409a35a5d58a54dcc29a43df027e76e402be84ab57cfc782f05c75695c5a28af93fc2d2772b6c5ba206bb55cf3304169e21f0eb1b73e80830fbe207aacfd3eade1b32d5634565dd895659c1fa7c63cb364cf7c7c7571b25f558c698577bfa0e552ed177400acae99ba041ebb2bc2979a0cc0a13f6e601717a54fba53c3cb7440f5c6391aaacd2387b445138bd49a22dccd5f74017d9513bc3d61ab13c7ac9049b7079b4d1e47c54f893ec62cf08c6c56d08448f6f5f01ecb0cb81c02be7bcef30b84d571af76599a23c9cbf35656ed4a3f126e5642eae073f1e3e4eef2f1d2f7973503bbfe0f04a53c5b6f4b17830e9a11e0f52b955512b2cb3fe6589fa585dbf326d478a6fe70b252a933a5ec95ca322154fdda894932043412a38029f4e26beb08c80f5bc5437760b0665b53c059722f3276c589963545b7b4f078900d76ccc8468634275f4d8e3d9294d2989f1739c886dc0a9afd96373c189a4b476da85744ee7122c5a2811347604fe38c2af835950b3e3b266bfcbb373bf045ad91c5385bcd29eeca34af7741e243c4435e6f1efa510bc90f94dade55143cf85ccfb8a34a6fb4610fb7a5654a7d6addbc9d423e48d9d7bea1f7ee04153469fbbc4d2f19418790234e7c5406c184b8c682670ad972371bd293f24d36bcd7011035ca7ad6d25e8266a88097b7a28a084d639798d784a7d21c8d613bc583d4c68b6312a12ea38260f0f152d0235900d97550b3446aa2cb56f63a7f3588ae7e206cdffaf6f4cf362de995d5ffe47b170d4cbf8aea97b5ad6b1a5b7d05ab2343c5bb65749a72e530dbcc7072bf7703c491f260e54cf230c48bd4e60daea9f490fc814324b6106210b9a6bfb5fac7ab75b36b6e232b62f6149dfbe9ea8f4d3df5b3a4c8a44ae423b1951039f30c648c06d9dac01fa34a4658be32a828f10b25769b85474756789bed189e8b84b8c0eec1063413a9719a87945631df3f30dc4935ff468e01e4d142738231f69c806c688fbb777249c40e996f988cbd1607efd34007d066255d48ea3379ea97ffd187efe9df29853feb988c3ebea1501a2fac074af1fee25077057a6a1e032865d5c693a603938ba7f3f8493802fb6b1604f22d9c4aac6a2f3efa0d643fa7e3ba2b1fded5ef2523d9180fb092809cd8ffe05fde189de1bf16ecc754c89f3778207c4cb9a50d99497b118ee850fdd4dcf985975fe14c59f2b4ec8c5c9e49c79b1662cf488ad9a0568922943b818e539866781275553db239c95760822b977ad22ba2774dbc2986fb2040bf0946a48bf8a5db4f8e287b1ebf95e71a3b28cdb17db3aac1abf08bc5e1fe818486aa9f73b5775434e9e668d9345ae433dfe2568457f2627d3a6f383fbf8eb52d6604730f0a05e9b9c85c18e1b45ea68d2d29c14d72b07631947ccfaf4a2a67817b9fac687abb8fe591856a8ab94c08ab1f921e465f7e77d67cca367f0e26ecbecc98c759c73be4f33bcd554936345f9c6651684743f91c77860cc3b91e9b679d5ede7f689c2e636c3f47270e2c725b791bb7535eda9bcd40efa7dd76b313ef0a0ac62b817a4656c85019de77d7094ebd3ec7741d4aec2d6d120bb859507f932d75deaf98d5cf63b3b57b7871486a9aabe8bc61d2a4cb8928248395a69545445f8564624ed13f6f8373c4aeae6dd0db4a8934f48c665cb5f21597a946c1f6d64c23c381fb05d620e671326441ef25b5e1701cc322bc17776af18a92390289c00194b317f3562d3356df8df79b71a2265f5aea5194d792e1cad413b47b887043822a5a3e0d9eb572a9c8eceae1b62e99fc5f1041828d5eb8ce2d4b447c22ac6fbed5e67aff2495cf84f7ec00eebfa02af6f76d9f667d9dd9199dc6ba600c1efef0ab0ae444aec9fba4e3445a673287acd5f5bf0f9134cfcdd49778fb8b094895902dcfceb3d7711b8b9a70603c7233c780effd4e052574e46d8d5eeccf373f3e287601a4c990d7eb25b8b8f21fbe0ae9ded9177d1b9ce8e1ee4426b4d20f68eef3f85b0a47797c1f59246487709294ae07b3217f0bd588ee464342c760fce035271580d5161d6b79ff40f6c82520bbdaa74ada9ce404e41072fc6c45ffbcc884d631caf08db1a36a52942be0bfc7ede9eef1830fed807a99370af6a48e303a3afdc11da5ce047b0555b47c982a9a4ee58cc6e5812d9d6e4089d0e7ca6e5454095da0a9cc018427c8938b033e00711e6a8711354620c307670b12da0a1dae8d7d0767c9ff4af1a87595775e584ba38dfaf6e9e408ba30393e30a218c7424271823ef9d7edb7dff38f2e629d6e815163cb53ddc7b71c8f3238fb31fd2fa1717d0018f58327d32eb17f52c7fc54676e223a4805832a153a9a8fba53948767325b7a1fdfc1b5ad78d4465fbd6a1300db14b5498ecc436791505ca9f598cde06f67133116d3b1324c967f80df77200c087ff1ec231addecff135cef7d07488313e6f479ace75f26c27e0bc7edbe6c94a619f9a6f3fca221cb6f7a2d8ce66f3205f0dcd66b5b424d409dacab25d1b9c16d2efd2c93dfa703e9fd1ee09edc2fcc23a5f5eb3c0ff43e89db481baf6a93e3cc59f11b771f9cbeb6bff9f18276d2a0d15f9bc28b49f2dad43293021e38b66bc4f4df03a57f5a36f956559256c91d8e7b90e426793d944598eedbc67976d789512225d4b0202db5d2e66f768927f41c558ef7cf4368f706e5f08a282b84fa5cd0992d9ac1323299caca1a6d63eab3f26dda2479a76b89a73d7909543df8844d1b7b8ec08cdae1efc7d4a08e199e8f789a939e7dd4607ad64f69ef866eedced619834c8bd212f1fc9654d034353d3187a1deaeaf743034a11e87e36a480b6cfc209f54aa4bbaf604cf84a315798a8511387b67c355d595577c9e3dca46b8ce72e00b5b3651ffcbb13367d4cc556872d04a2b7e0d89351dcd5018db1f164ee865e17f4e4eee28cd664b7cee20c507ffa8f161a17dd0f42da54a976fbd17cbf6e493f1095ba5834b4c4cf4f80f5a9b50dec6319f1e9dd5ec9adf01c917beeb32229973d7d5729ed3fec04c6ed4d49108b29df280cfcc8f823b8f63a0f02de1edb4db6158b1972882ed7807a8ebe6905e00df935b185d0c1ba9e22c69df1861eacc35a9e1349115217043eb8edda0051b0997a06b09cb0680d0cce6ca0c24187a4c9fe2f872fa4209c4cd46ba9046e0c8c9c6f77191a278d4441d471985558b04c152a1cea43dd45b1199468381d2947306faec2261385165e3bbe26b168d202c637679ef11e71b6bb93de8a5d7e24f8eee96401411192061bbbaf709558401e2311b7dd6ea19e71a600f26ba3fbed752457a966374ab0892b35bfc902f5f8c208a6f21fa171f6224e76e0441001f075f4d915f0c86eaee563443be894af16d3eb5972adf2c7c48460afd36c01019f914b080f8d359d3c87eb1bbbd5f81c2499591d118d462e9088e36cd860fa19f8e3619406b8421e503dfa794869a98c7b896404fdb620c71450615f4217d357c46c947058f756d9e250209f1f6bfc8565178caa766c323a65cead0bb995e35f03f87b3a2787ea6201c12924839fbc207b5e5c118cf7b56fce9101400581e4430db92cfb62a041a95fed054c388c9e017a0ebda59c5f4895f5ab694d562629d13942c61e328939199e86d50268b13430fc55e65331863270e8a381796aaa0a5fd139732957813ab4b3096dd1a5fe3dde9e23afa3f94ddd4ca944d3b26aa9bfa52acd72d8b0167e5aaca014f1093db84d8e5afa18ca43deba116c8e534c99628ef9ddde014293a84b385448076bd9ca756b1da4781b376cad713447805d697c290d0fd20e770bd1fc6a3fcf32fb5706503fad571bcfd34ee1f95fd4af627896db090e86bace3aa62ca7028097a368d95661b625ea63742db7c90730d01a3ea9a53e09e98391387af337613e421db1ae5c937ebe8a3041e6f266ea05625add50433195d293d678805940aa4b25e9d6bfec2058ed5429af79eb53773e812e6942608d44e3a4283c369d64fec8f8d431ac9f2807db471e8bae71dc10d41daf32d222c4a68d486107f7a777a29daf510823f65e5db6cc168cf63537da55ed5c2600c486b8366e9722ea0b56375c0b8806961b8d19a86d9c1ede3bc94b4baaea9bd71a481e77f79dd01c141251c33849","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"3b65e88fb4aad2a4dfb95b4861d2091a"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
