<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"65edca2a96685e0a8e83212bc39d77cc1c02bcc5f9add1b76e655ca435c22c92d92c7d917eabcc750c2cc7fdef3152c015be9b65f9b118911414098f5da435d2e53a5ee7d5bec089f832a0fc4b581a7dd7eace45f4b1453ba559e28ffb761a3b883825a7c56015d765e932b20f1caf816841b73f965318efa884dfd32898107a1936212592832e4c6be967c1fdbfcac1593a0ac7108d3c13044f3b10e50dc5448b9d58719f03860e120ca80faf4cfa79b01a0369d0855cc42c31c6e8593e9c2642e65882c5a5d6a971f1dae3fae792ef264d5c6f70bca2958c46bf931c9f438d5c357716649663cd66a60a58b29eaa171d6a6f62fa8b667bddc659e8793c3978d84fb40ff7b58465f710922ecf109602b6002c96ac34579573390abd26aa4f9971359a52eb5aa7774e3d16d8edc7b44fb112dd55f1ae9876a96456f73a964ab92f6e840ba4ce57f801fe667f44ec6ad1beb602045bc171d6fb553d6a35cf738bd4a7c38872bb18811f07ee160f7ae369af46818aae342b4b341eaaa85d85596557b8109e3c1bca2c53fef62b767a4f3f574d6ccadc37bff2a4a3ee054e8e3d708e5f1b9b3fcfb9d9695aaf7f355a6e0c012cbbe943b83c0433efd3afa23ef43a9cd03ab88f8c2154e8c86a5ec759274893c57d6290097f8b5c28e90bb5819d04660a4d7eb72233cdf2474a57703f7c937a97dab38eff9cb8874d3167e7f26a9096804bccd0bab7bf850a95cf92936f943d3399ae2a735f1690df3cb38bab8bfd7a8014247c1da2c33dada9dee4d8f18fa2c3ebaa915140aa3f9055c9361a72e7188d53b5d0c109e140f0fa430d87749ac533e3d6e321ac40858e8b85cb82597c5794d0c929cb44913ad088b8b213bf86b0086934166ff7b3c80e4fc919ae63465f2af43d388c5f17716541510fb682a85ebc5970482549744c4ea3801da02ef7ebbf21b84ba24c0c0307324a78887e07f9e43f3171dcafa124be35947b5a3f1992d17cd74b3a87b0a3a4f3b3adadc730a3c69bcde102b56c9d429350e9577c5ab9931519eb2a1365568a8db4442ba9bbaa60b908f64f1e6205d26194a5afd6f15055380868f4ea8c9b01a357139668379a76ca2d08f81b6d2d7442337487a7645cf36cab5780b60f2b7c82840b233c49bba656413b5c394f6abeffc1b9079206b340f9d4b251d0d4f670d81382e0f5265abcd41b20475065bb4cd45bfccd9e64c6f48b0f3ef00b1c607bfccc2d92f1dbe91d2c340063d832894afb365c9ce64307f5f1139bcc3b90a280883eccf15c1340407dcd7a6dcb58a94d92446aaa10797da72c165e34c3cb153c90b460c99352214508a3b20ec19b80240cba44cc307eeb07163da7cb45fd101f28af1d312a0dbcb6b3d626722fd667c2b5e4b8d4c2f9b87049ca1c435d3883ee2e3bfca9ec171cca5932c349464c6f05a76958a3b74393cddd14030b92f74578805a94766901745f73858bf98fe87cfad7212d415384a8fe7affa33cc95a8284b3400c82035858816eb9b57cefcbaf3283c4e4d2d49cf3d52534d61b0cfd7923eaaa218eb3dbc3d968e18250f9aac88cad906046cc4cea70cf27a9bac946dad47712a05c8c5172e933c0c0d0b09d6828569cb5f727189415f169e23c63d1cb9b5dfaa63e88e85d5e085749b67bf03561f611a7b443a7e747fccddca43f7b70e739acec540f591ba6c76a61c4c6162189c033b308ad60e48c1d4dee8643a53be658d278c3590b0cfffc0b2e0da46774487402a126fa610de504b9a069c6646f731ad7c82d6823252e25479ab9967ec7bde89fbe796c4f107ddaa1e4d7e897d9c0a69e769d30705098ab4df64392e9c958a079da448958fea6897137a0d61120797672772ceda0879786259e1bb6093d584930bd8ba558ab191ca3055245c18252a40dac51dc34c5993aad6113bff649ad6d385669abefbeed0fbeb650c848cc391288e2cba5873669768647053df69f7553ba414eb4dd2441be3619d7a2667120d895b94e937f7f87f2ba239559e0dce0fafac0b35b8d12bcdfc77f6b777be110a2b265fa0bc92f9f02d30c522bc19cee959084cff1f9752b0bbe643025b37636d7dae187cd29cabbaf2536f427385e214995caae55b9ba26460063f9e80818fecb19e657735a5e4d60644bec9d2179dce259970faa78a817094a606b784438b754a9d6557fe03d3ada1edb358a673a7be9abba52c881e02413bb60c24741a19bb2532bdaf1e9180a606d85fe9de1cf34d63e1323e304fd032e81ab54e69b3531ac02c1a15060d85c08bc4309eb979e2834ec428ee165b74972b298fef564d54f625f5556642279ec661c5e976c0c54673baebff664e83271ae54038d75af4ce94c93f6092b82dabead23ffa58dd2720cca5f2e220c2dae40c5d6ff34c84ab28fa16a72c54d9d59cc4cf945a5ca2bfa371761ee2da2ccf1847cb751acf03f0b0afd603dfeac393893f3bb390206ff897a3a626fd67994ebdc55b6f93b45dd45bea080bf558a35b9dbfe43fa248754ed37fcc54fdc86406c4d1b8c8773a0f5fa47f92252543638dbd7ec3c667c3815af66e4cbaa1db8e301da57e5385111b715228f2d312b3037f55db4fb9e876fa990e69c42ed897745097c3b9a7f107227c9133b3124fa94e257519211373939c26ae3c343100218284f6fa580679c6f8e40b9e601fad7f898e39653e45e261c37d9227b406391939b6296fadba234310432b4c9faed997a805797bb70b18cd813b23342d947bbc598e8d6c4d42da87edc1f2cdbf7c41d7be2be133c53095005a25ac4adc679086697e99769098d5e227595d0a9f82fe306f3f8c750bd45b92ce9cc0b5dc594d0896bbac7f05e6833e4efb6adfea94d102a5c9ccd5238305fa7a98e1c40d57fc7975f7b18a396909e040b33733e2668d688fd55c7c1d9de2900b621898b407fe1ca94cd211958f99bd1dd86d472f270b0fdf69d0b2f45735ff58088638f7ff5fb4af533105a1f45ec34ea1cbfd37e8f452c58f78b14ea2de8a9a3e94c8262f710ac38aae657a5c43d58d66350262c44b696b5703d32be33725cb4845c99d18ef5fd4e798c2a474983047003bcb7ff3f31686f19c716a0baa03768451bafa8319b106f8ce3ebb6dc21bfb5ea2a1acb346e662cceafecc10ddb67f79583eadcbf73d9df017a0af800ba15965eb32390b78f164bc810724585020fa97746f65a2e64fb3b46ecab362e9817a2354385990726b248ebf72414c88b3de1600ea0b6c3405377bde75e6dd1c2031bbea3e56d485efb1d16b986aef22dae54fc1648d634500ed0bfed5b9ec3a8fcb60140f39518c8d80aff508dae2ea897202d56cde36832c5232a2b1fc2cff0f7ddb7948fd80637988a2e3ac485e33fe2e904f0bf3cbc378b9e2262d699654448b970f51e5aadf9e79345279ee73057091d140142408a394e95023f3e396273c258c4c0572e68e8baec80ee1954ae383920c8c6fdbedc2596697d95f62380277871ba742904f289701e4cdb9d1fad9e171a56e6f9b25e418b05a58ee1ebb649d5d8e30bb6df8d84c630329dad315ae15c303a1a53eee13b2e6c7afa7742112040cff979bcfed3da0d1d6b0b6e56b032c99fc166ae814c4860e9b3cf6e9429c2b32b1c4ca207b35b3e4d376b46a60d5c9c1a024d88d2a4d3925dd2e08895c3c4845c7bf0bed535e81e23a24b90c04647f502c2cb5af15a496f756b0c3bc019cf296bae99325462678e8c5cc33f313fdb08b7acc0477780ba217d0a9ece541b8c2d0aec281c9945f36cae32a69d9b3620c4b54626c2ab94ad335030add3f9d9890306af2bce9b88b5c7fe235f157f6416e7e7fbc88815c2b6b0337e86750be2384317a28c8f878cf60c3f99c5a2598a89e44cc521a790c49e153bcb0be38a5248bc6521d084b6d981dd2e880cd5d31a2fa0bf056bec011d968325b59c2548064090fe55fe75e475a7c5b20ea477f6a93465ca10eb45937250205fbcf4c52fe5bd1cfe1fbbafb1e1ae887832c93aada84a346843a5a3ae6edcc47b8aeee4986afcd378c1cddca0fbae75175e4352bec1486103144bbe69823c013740c2b6fad21986ddc27bd2088bbdf99ae13c1a7c2ab8fa2023da097c38acaa67d9c71b560902f7c012c0fa01d753a324ad78c5e0978985b4d6b5661741f223ab26aeeca9bd89d7bc18f008103cb29ab36c0b821f5d9f31f4ae6d16414b83b6ed6034099e27c5885a97dc5a2846c9100d17b5a20001786b52f6f45e92b62bf0abb10ba0de8a05929c0ce7193c7af46211e974134215340db7dfd6309e570dd0f392370214c6e07f39b7a7de012e8a51d69297c01bebb4e0151c56539de7c14940fecd7c84dc32c9058c2cbb531e122446abe8be6cd2b172d0a92e08d1d675cd888b79a3ef066e93efc46dc34ec6f60553f6a6256afbbe982aeb1c0ab1e323321cdf93589d83a083c2d2e7bb031ac08da947ed2f67757c81773bfde44e6baa357ca976a0db19716bb1f9d80fa1a17893d05224e03964accd6dacea0c0a3fe90c5179891c9b332dc185fe747e2402ed6d179f32ba0b3d9597457a9495ef01ff1a09780aea466981d84a471fc0f34f4dc7efaa5d5c04117507fb37174f31234553a5aa4b22c8af82b9f9bcb9a6b0757a79d9b3f3f08b4597260d3f44c3c5a3844b9dda008b3152588098130b1805519d3cb859ecaa9c4f31cd64c5b2f46ffe45426e45b4a020b9719d4997b4dccbbd4fb390e606b0ccc498903e188c93c2305c718be926d3c975f0d4194379998f94fdda63d96e47e6c76ddbdeb85c3f2dbcbbf118aa359b53a7f29d57d913a640d278ea69baf7dbc4b286474377b7925c96abc21c3b36ec64cc14a141642d0deb6ae43561e1a9249482b5f04ef4be692f7e62f34069b949e50195c5aea4f94f37261e892a539c2b7dad1a2617f04308a7e42158b32fd987bf68551e6177195e85c2b7b7ea51d8d080349dcc623baa932002ef63998d81bc58f9e04af69daadc1b7979604946179e2b58cbd86bb373d5c4b52a9346a10fdce1db10b24657858018aae0298bb8b3943aa42ec166e206a6746015c043b2807a1a60262566171a70248c7cb7c3897a47d23dd7d5cad72db72eab36eabff00a2da2b840b349d4c2cd90290eac32af463ddf8fec16194650b63a82e3766c4158fda1e763f57d1fb39be2caf3bb7e9f094509c2c7aeab21acfc43587ebad26b70ee1289dc5f9f65f7e1e0f7f6dcdad18e486cb9d1a5d78d6233fcb0a67b3c6cd93b04e4b96ee683039923e6b96d5e22f0f1c22dc7f768c7c98ac98453a1b450913d9a6810efbc72649ffe2316374291bea1dc71817fa8b92c50213e74389dc822ad10f1c9b765614fea1ea553a780be865aeda17daf5edc3eaf7d038af02ebe5050c578015810b96eb95bee83e9743b50158464a67a9365a464888faab82782a4ac476390476f6a3f5f76610ffbb6a19f0acf88f9715d356ba67fe881fa69b15580e9597a17bf3865c059d8fe8f54c1a26e438025ab3a67db1056c462f3616e83b7bda0fe379195b2990015074db9c3f1cb4f2a683753cc90dd731af7ca8e1fe339fa1924780fe0ef3baf7d1e2d050934d83cb037cdebc0a7709181f412b035556aa3d111923cc19af9d73d6e851af9c915769b2df134292d67aa795a270ab6bc4afec322dda1bf9b7c1144f428d4a30570ac58900f4324daadd9a20032c9811e24f9edcc573e29f41e9c4906cae557a57f709608cf883abfe63ecf89737a9e8931c63215da77dc85552bb74d237cd056d44a0fe7ed4a78239eb6a47483e8bdda8c1b89a1ec577a2527893f4d92e58653688416eb4cca8319a62500a2708543504b6d372e9d74df5dfc04ad8a47263b2f6ca11446be3614f38348654dea6369375ba9ee95454d2bc4d789f395ac4ae7d29e554ea203975817c7833f65036bae39d1fa22df8eac3eff50356cfb058420b001c37c24acc8c67ddffca5dd5c6d252a1c79f4c8f28cd2a3e64f7324ef8bb5f26e4a2db19aad35e51456015143d6c35733fd9ec751f94452d912e55be1c83c588da0046492868fcc65fcab1df268b9886f86ad95da2a82ed316dbc160d2acc7496bf5edde08622201a97cafb778d8168339eda3fdd0041c9db25ccee37fc227cec2a51949106f6cc3fd920a6356315b54e2bddaf6a2cdd479456a44de79ea8f1f5aca510c4d19afe9bc0f5d0667ffb65b7c2d657fd61490c8093cd3dea4689f44f6362f6c79991c6bdc901299796f88bbff7c5e3286027189f4a462d44c2266c72a31eae62cd7c01d579dc63612a4dd86f994425731b9e79b956c7a39918332d32ca42a7aaeb0b91fda7e23c05ac110306f410093db23c26dbac6361300dbf25259d2325d3c9f6c8bd199b59a91b31273fcfb8f031b65e61192e53cad793b17c6289b54c386ae2d849130ac92a0b07abc5347067a0c2f9524cb54105c552b42475cba8a72f31e63f07bec4e48daf8d4a6ca452ebee7cf262e7e20e4c17220f905bbafb50e87859d3c621889eaec9d845315790e910cc63b8bc5400e1252f733bd7e803242f17ec673e91c3a4ac7e4a00c530f92994497661a982d7ed55df2164a7821b0c52d2424505a2dcb3e0ba3238c695d77563e62db9802f4d2496d3eeb3b45b58e312d2ec73fb33ee22372c0dba28e7240615f70d7590cf980a0ae55fdc4fb129cf559f5eae620299df16bda0c7f9ac4e7d1e644fbbde710f3a23ad01b7018fcfeceee1a016a405d35157ae3dd56305b59c0133569a28ea76e3a845d486d349dd33045ca3c58145e8bb4bf6f125c3ffacf27ed4b4eca29a1103056fd9454487e002853e17e6c77c6ef8d5ceef0176a40ed37c062d8288b96e70acf5db4bab0f56c8add748c5bd1c9905a117d376e694e885b17650fe25d4b98b1337db1f8d31fd7ea6d0a5a2908b698955ecdb807b3fe757ddb3ea21113c0e5cffb5d7df54adcd2bfebd2b02b74acba2563e83398b3da9c93e804b0d771d0e44e6e0c8e9f3fef023ed15d34dbe1befed4dd5f608be500b2ebe4613f38afa298cfc3e668b4d1e4b4740463c2735c36baad759f28cd689440bfae20422da45e765986f8488eb752f9c15728befba91c1ac43bbf27efff7a73d6863ceb0fc854df71af31d2c18ddca7a12a666fcb48e848ffb597778a4188bdd40bf001c84a935d033a8282d34ccf849b8c9ba9136cf858f4c356e6320b28a27a9446cd2d4b92724eb3209992e3264a8ddbf409c60ce4d228cd084fd4c591f4f54c3d1305c24d1f73d200d286b581c3cc7005bbaa12602f11e513f43f87440acff20745ed8a0d2cca829d6af3c12523d8749d2f87f707ec6752d965e5fd237f2625bf5b77eb6a8e071e4ff2ea4be0176801bef202cd2d36ce1526e0a0ea5e33b19293d88a980c103e311256acb31d86210d9763a53b13bde7bf7bf186799ddfb120ce1535a259a4506a51bfe53f7676257a94d36ca1f503cb944a1ac5bb22f6e79a06f6b701f54fbecbafc60ba935efdd98a70e7975c230583e77b75e7f85251a1fe4ceaae6899138288cfb4754da0f5b7c48a0c786b1a9f5f09703a8538ecaf21d0f2bbaca142cfb2df5ce9c86c1f200abfaa367b8fb8cfd69a3c3df22618a694d7bb495c36952a0659f5b2055471a936cb6f7d55d3367f8e012a48f2e4a4b6e4b9b40e10746b322973b7f4dd17fa3d2dd7e85d2207633b5ac4bf49ac18f0f139bede71bdc88f1fd3b59ad971ef689211951ccb40ac9c97cdab6d622322bd28cd9098e6823a9100a5613793f0ca9c74ce4f528e2e3d45d9a43d3af563108b3e14745b5b4c229e8946978ca500fe39a4d26033f0a50a8c89830eeb4fd1eb4ede0fda58ed41e2802d87735076d81941755ce59da7a8cdaf334675982f6b192652d90fb4bacc30daa3bb680fbe552350cd244628d7f001cf74165fd35cd659593a31988acbdc5f7f3e8d26ba1daa011b5eca97a6a8c8d4f346e50674ac7197ed5f5a58b0ffdb36f687bce757684fc02c1a2921d041614f1dc059592144429d6ad0c0609fb0543c2499cbb89cae4b61d7eefab3b32f346c12904d6b3b0cf76105b28e0e452c033fcdc472f003315ea1a27ecec85a164a05aa3a2f895af379073cad07921672e81b326364c0d81a9a94c00f44c3c905c82ca22ebc1c411eb2bc405a8633f83bba158f163495fda8fc20f0c05a5631379a912b70ab9c92b20f2247dce1a13852b37555df35fc6635c2b3d8a019ac38223053c09a88680f8bdd553613920707c13889e64275ce719ca2cf2ebaa1004031068ed67f78d3a8a8285d7edaccbad6db643c033f3908aa69320d6112d66bb3e78942e64a8b3e661001a0d1d6be550eed654c3c5d2af731a7f899b14f516a3173beb2d264da750858a4ada0647d210550d7e0d168679d56949b12024af62a44ecc49d5092dd084a9efe4d4a33244dcb1456a7813dfea423eef4d7bca8508ed5fa77a418b35b52baac7778ffe1fb80975b51d9574a954037c7f4ba58253fbafb4a00dbe01a49e9aefa88f99da838d79571bf12f75552593a3876138c3d62c45fd9f6d5cab86442cab1e3ac3667c21651c0a5b64ce3ee8a424b4707e620070e7ceb9f8fd794b71e6422ed3e5ebc83fb1fcddcd587b15803af70fe115e41c734a1e9c45aba51c539f0543c9cd6c8aa2ee6a32a6263a1f4921f50b77a89efd9d49733f4c3be01beece6260d876c52270b56683a5889b23624d8c696e0fb4867d0be8d70e7764d1f6e93dfb7de044061f968cd6cc394c2dc95119e5c11a006ec617714e43541ca5a0d005f2d2dee4749cc12dd67ee9e73faeb81a9dfff6f092c484bd92d5944e05e7dfd7018cdbc41526b7216c0439ed9e338d6ef426fe95d23e7f4a5548e72dff05758cd026254d11b5c979f62310c5a311cc76104a9dbadade6d4b15ff7461c09c964c74dc9d81de2ae0b54181803d26e7d817d2278c59811fb0a4a4f3ffcc1ea2c657f5a2720d08ca42f2da2f870759e1e771bcad1d690a4c59a407ab9f73b2a5037600b811617b12f0cbf411bc2652287f6c1a9ab0936ad47a0b466f142ab3233de47b740d85a139c5ec63847e8824fdd27e72bb08982dfaf4014b430cd5fb294ec08154efa0ea020645598cd67543363233c0dcfe95d96763afe7c791b2523327f2835ee50dfe7761e492222d0c19046e1b7613c334c3616a39cf5ce221e74b6ef8a95ad9308550c9ce72a5893c0f7aa47163e9ce7bdc58f20370d9940967a7832865be9719bb97a9c7a0ee534603addffa063841f92960bcc130d4b40596b9f2282bb67693baa4c1d4c7dd3d8e1e197464733c8766151c71547180c9346f6dbdd5ff476314a5c36d6fe7898ce62560013cadb17fe3802cacec196b08973b213249758fe061fb4f4a70e953b9b6562382fc1ee3511400d909f0d451bbe56c418853ae32d2e5ba71df740f5e3cdd5e3ae4643ecad247562eea201049d32ad57f26f55a17e0b2a5c1833ad40ccc24344a3e04ed560d06a4ea709851d0f98243566814e2ff61832ebb8fc45102c63805c6aab16b20122493c51c9327c13d4c840ec3267d5f8dce55d84e06c51a315d3410e1ffc51462338d9cb3baafea98a3be804414429f3147e2e310448985245eda4ee8f472340bbed7c2aab15b8016a1c8c2d8b59849211134b3006e26926f6e4759112d83eaa37910b82e2e4b3259a848a96e847a7697918f1625ef8c130d7070baed88ae167295570d58b67ebe8a2e009a3d60fcbff92391e364aff4ea386e31f075d35e095ea478ebc2d3893c432e3df0bcfb9a30c98b1744acbd5e1a0c13ea9f615d75d170d296a1d85476f0841f768ab4e36690dd69e2c73f527643643e0507577335143a9a65159f78118856b5d1da68c5185058dc92293f913e76f771b72dbffc226000f02f0708ccc9eabb1e69daff306fcb75e73308a9d3ec1cb9a53dbc8876f51f88e61b72b64a84746ea5436e2234bb3af2018c8378effb6c8589019f7e13d78da6629aac90526fe2f4258e8e285f51f7f5864962a653624880eea2805886be5b6b52c2f917813ff8a310662f1291594330a1bfca487bf4f5ffa9709750256949306d206cb6a9e65cbd2610009fd8860ccc1be632b92bceeae4c9d2fb262c86aab5b29876d8bb5aea242c5db59c7964f0e7b40ea7dc733b5f33d05e674d6a5cec28e4bb44c46365ce69ff110e2a753cf89720e929ea74f1a59ea6cf40cb8d416c3c7c0dfb118159e495a9f5e8a9440869b8e9d7e57b550162ba8711c16dcbdbdd94b0700dda4168c24b043582cf1aed2bed775ce29271211685b500246b20b7b6ee863f2a3f01a853d9d8327dcbc7629d7a37015115a1c35a52440af14d6f96103cc528c7adce49c8bb47ef9b1e1a3a3cbe1a75addad6d197f70f1cc8fbe66f0df6a2e88ff444537e3c867b1bac68aca3c54ee7b8ba1d1fd44e2c86338fbeca586a1f2c21a87555cf53974d4d4430ff2dad387ea3bb06e65c50ad86d2d6acec628e5ba5d1121ca56d95f6fe4cf80c6e26fdb31ea907f46624e2ce30dfb5d40519ba76a893009e613f2387bb70e54a14c81776990999250a85ea8aff534342aa12962c0c1af6e2a381f40520ec1a20a8b9ec2084aceb54b6a1d34df8faa08d7b46736526c52f29f6f96c3acab35a68fdf65177b1028e0802222eb433012ae19a6098b05200497297c81611c9ce3825687f906b61cdc39f4795ccfec50107ad4e4b6b7c5dbd009187e077812446f46c2a2cc42de049b16ca658dff06233172e94588100696cbdef3857a010384b9b0de2789603b8e32735c39750005590bb02e5cddca7988d2ee5bdfee974f624cc1b9c6c0a60c3ff6025115e1d70c8eebe5cbba0b1a741a646f4bae54730bcaf865afa9df1d44c35b013412608fdd18d151184bbf7c3044ef6c7d14834861d892df634c9ec7769de428e148ee8b27293b6d0e7ab0b85250cd8e7084cd171bdbb257ef2d79f93243ad7ad6f2136a93b6a92e5318987303b5d2afac7e0d92921f6ae5ed60df59478aba5f39f516df50f35f4a3737929a34a93c80c024cf1f74bf4a1b1a3627ae0aed9ad857c5b71f01013c296d7a53ebc16bd839d1bfdd2b1867dd8057187b1ed0aa9205c175a1c267ab2aff3fbeb03b8a12fa468098d74947f3678431bbc5fff242f555aefb3d877e19eae47fb5ddb7cf7e1f5186a989a26e208e2f7554eb48bea3f2cad33052d65ed95c54f3d6c6a8cec671a7924f7a40ae79500899ef86c45105644a3fd98a193b096fccd887829de338dc2682e65be926abf3059c57c6917b792d2b83626e4be85d65deca952d7eed5517a2ecb58fae1023cce07a87e1c6f868e5e4789b662237841418e4d3b1c0ed8be723942e81acd40085095a086c2f110457e703635344cd123767bfdc143c22f483eae000dc99d091565f378dbbf79bc31378443a75ef3b1bf9db7583745452317d394cf282778a2dfb313e30ac5c32e71ea5742c19c3776aca32cb000563e1cc7b57c22200a7efd0b5ce98cf7df2e082a6cd39b2c818464108047597d9c77676e3ac08445144e5bbe0af8a19efb40dcef52e6c6ddddf68308767a9796d1ff80983116334434c6a79ee4520fdcee28eb15b956245092f129259c8f072f16de8a523ef34cbb49afbb18c7d248f3bbb383f170107acbf159a7454f2497ad6ecfcf30229d24249c651e9b805928cc8dc397eb5376a619fe6b709881312541690f945f06da0671fe1aea8ad1d93bd400493a075717884275e0b7da3f76c83462aa2bea8ce64072d3ec9df678ca012059834974788e15b3cf5960f3e502f11cd718a90dc21e56f7049271701869c8103622a4d230a5bfbf9b327be25108b39a0d92bea1d786ad11a9d6f7d857b2eb5ae958c69c6533f3a6c2d14dfd3e844cc9185c7761ce3fa460671b238cb50d489116220ccbf53b92ab95cfad69d83a2d6994f46a5fe8c3eed5525a0ba398ef8f58415a9abd4917757cb15e1fd0f945c3f9f5ac397db5fc6f8f80ca1606d7458d80679251c1d33865fc772cc6f2d626de98c859b3683b1413bce7b4d5a504708767173a7ece5736bc74fe87d0424af993887a3ba47b1281596bc87322e83f92c6f49ec6d0f8296fc8271798ea403b4f49a7bfee74b8c4d0a188482e3c059aec01f0ae2cab9871ca3ab112f8af519a3bd971456413e4b19df464efab7d27906786410154a3fbd149dfe0adb85d9b938bc1f40bb15afc8a18f2fae206d03b89863f445a0e1c96271addce8a0cdcf848320a04c2b98e5f17fbbae9fcb2bef6e82689945afd0363a6c55462cd162389250b12f68233a183b78b0ab8557bd506fffd6eb251f5289974762dfc953298cce2fa33e1d063f93b7e84609a521b016a9d2b3b7487a2719a31aaf4e116b11e0634291f12c1f244d94913728e3b9df0048c0952b77233bad860a2f674769a0e9270f2829298330d32c8a4b3ab4cb59afbb7c5141b9b7ee0e0f448aafcba84587f119bc2ab945b04c73f037d3a44fa95dcf07d2f670d6d600925ac437cdc1650f35f06a8c0960957e2382aeb5e13b572840537ca96edc1fba14e4d83e611cc2337dfca98a2dd716b240b683fb869fe93448ad502bf45220ced3b10c500716b45856a1849355e487b2436cb36a244f7a4ff944e81cfadf542b9b9961699ca717e12a69eaf0c3019382ccd72251e32401d432eeb2808f13af68c661f6764191deedc96ddc10a8be39f19a633354802b16404cf63544e5b212bdd0a10fb3c874795079d878d53f9e45b59937e6c7861bbe2d38f65983c75d83092f85a5b6f3e24316331f94f02b96960b589edf72c32516e7772fc8618465a6b3456922f09d02e8b3a377cb4c89e8bfb34757fc623a7e3e5dbec77765c57919939ec25def633fb7c3d87aceb086c4abdf61464d513ccb74f4dc34a4ad2a368bb7289608a08b143df19abd31b2dbdc2f7fc8b511aa0af1efe7b0ab5edd4706e313798bd97d2cdcb406072394861462af2beace587e14e7bc513b4886aba3ca181f7ea0886786f0fc01a166e12b9c40e9d68f2fef285d2808e1d282968bb65c76bd42847d1025b38a9169366b1204cb3f6e54a3ee7c9573137b9e7799f174e7086d6d67a5f4f3f95f6ca4846b94cc56b6e60a8acccb3c4a6277b317515268ff004127f603d2940a2fdc0b82ae42d9e6d4469ac6cd23bcbfb0d5be9e05fdfe58732b08a46ffb8257e1487281dfa596c88962a3a30d4262c08e6a847b3bf3844602ce48ff1b8192b093320b5489f3ec7428d1f8b45376556ab2fc4b0329751ca647090e80c790ef93e42a69da46e381b88071a80713c746f035bca43e7a1f41d60ae5ad5ab7c498b7a3e994be6bd5f6f58320967e04e1778561ebd133110a67b8b8221ed642f6860c2aacfaee98741ac5d7d8bd695c242b47af763671377b4ae461e72521fdb886c7b0e9a01953cf017ce9652e35a58ad2e4724580db725983f2409e10e2b4e4215a3c1f15ed3c1c2a04b73beb314509b2f03e59d21570882e97133bd250e1a3d0d95fdbe4d60beb642b8778797e21dc632508018f2cd3aa1216a56cad8c290d88d8d6ff9f11cc9394987a54374ce79153951217d6a14138582c42fe764a1f26d013fb88286a34b92d7135d3f6cfdc1ec856928605696174adcb1da8e9cbd471ecb5ee5adf61ae3fe581937c867842b0a3542ac0d61637a6560bcd41adfc41b10129cf8c317d6c8950c8af78da9e22b35ed455bd272a1ddfcbe152eb7e8f6977a2c9fad92d1137a71e7b85942e0216930c597595fdb5e1ccce2a5d5c8373db5a09ae89eb58681b5e9b01c647b832f24c1d91f3b34795d4e06680f8eff5b647d39473a1cd422699ab8a321af7d1ec0b7512ae5be24cf11c3b5c46ae65048a1cbce5ace3e2487b63bd8f0da5cb82ad7f82d23431a3fa85c2fb590fd80cdcc541277a1126c4e7","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"db2470865aa068691185dcd60d0115ec"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
